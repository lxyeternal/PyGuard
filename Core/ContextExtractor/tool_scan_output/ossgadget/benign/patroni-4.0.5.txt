[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m289 | [0m[35m        assert result.exit_code == 1[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m        result = self.runner.invoke(ctl, ['query', 'alpha', '--command', 'SELECT 1', '--username', '[0m
[30;1m292 | [0m[35m                                          '--password', '--dbname', 'postgres'], input='ab\nab')[0m
[30;1m293 | [0m[35m        assert 'mock column' in result.output[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m    def test_query_member(self):[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m697 | [0m[35m                  b"foo:\n  bar: \xc3\xbc\xc3\xbc\n".decode('utf-8'))[0m
[30;1m698 | [0m[35m[0m
[30;1m699 | [0m[35m    @patch('subprocess.Popen')[0m
[30;1m700 | [0m[35m    @patch('os.environ.get', Mock(return_value='cat'))[0m
[30;1m701 | [0m[35m    @patch('sys.stdout.isatty', Mock(return_value=True))[0m
[30;1m702 | [0m[35m    @patch('shutil.which', Mock(return_value='cat'))[0m
[30;1m703 | [0m[35m    def test_show_diff_pager(self, mock_popen):[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m678 | [0m[35m            'No pager could be found. Either set PAGER environment variable with '[0m
[30;1m679 | [0m[35m            'your pager or install either "less" or "more" in the host.'[0m
[30;1m680 | [0m[35m        )[0m
[30;1m681 | [0m[35m        mock_env_get.assert_called_once_with('PAGER')[0m
[30;1m682 | [0m[35m        mock_which.assert_has_calls([[0m
[30;1m683 | [0m[35m            mock.call('random'),[0m
[30;1m684 | [0m[35m            mock.call('less'),[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m669 | [0m[35m[0m
[30;1m670 | [0m[35m        # TTY with PAGER set but invalid[0m
[30;1m671 | [0m[35m        mock_env_get.reset_mock()[0m
[30;1m672 | [0m[35m        mock_env_get.return_value = 'random'[0m
[30;1m673 | [0m[35m        mock_which.reset_mock()[0m
[30;1m674 | [0m[35m        with self.assertRaises(PatroniCtlException) as e:[0m
[30;1m675 | [0m[35m            show_diff("foo:\n  bar: 1\n", "foo:\n  bar: 2\n")[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m668 | [0m[35m        mock_markup_to_pager.assert_not_called()[0m
[30;1m669 | [0m[35m[0m
[30;1m670 | [0m[35m        # TTY with PAGER set but invalid[0m
[30;1m671 | [0m[35m        mock_env_get.reset_mock()[0m
[30;1m672 | [0m[35m        mock_env_get.return_value = 'random'[0m
[30;1m673 | [0m[35m        mock_which.reset_mock()[0m
[30;1m674 | [0m[35m        with self.assertRaises(PatroniCtlException) as e:[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m660 | [0m[35m            'No pager could be found. Either set PAGER environment variable with '[0m
[30;1m661 | [0m[35m            'your pager or install either "less" or "more" in the host.'[0m
[30;1m662 | [0m[35m        )[0m
[30;1m663 | [0m[35m        mock_env_get.assert_called_once_with('PAGER')[0m
[30;1m664 | [0m[35m        mock_which.assert_has_calls([[0m
[30;1m665 | [0m[35m            mock.call('less'),[0m
[30;1m666 | [0m[35m            mock.call('more'),[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m646 | [0m[35m    @patch('patroni.ctl.markup_to_pager')[0m
[30;1m647 | [0m[35m    @patch('os.environ.get', return_value=None)[0m
[30;1m648 | [0m[35m    @patch('shutil.which', return_value=None)[0m
[30;1m649 | [0m[35m    def test_show_diff(self, mock_which, mock_env_get, mock_markup_to_pager, mock_isatty):[0m
[30;1m650 | [0m[35m        # no TTY[0m
[30;1m651 | [0m[35m        show_diff("foo:\n  bar: 1\n", "foo:\n  bar: 2\n")[0m
[30;1m652 | [0m[35m        mock_markup_to_pager.assert_not_called()[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m644 | [0m[35m[0m
[30;1m645 | [0m[35m    @patch('sys.stdout.isatty', return_value=False)[0m
[30;1m646 | [0m[35m    @patch('patroni.ctl.markup_to_pager')[0m
[30;1m647 | [0m[35m    @patch('os.environ.get', return_value=None)[0m
[30;1m648 | [0m[35m    @patch('shutil.which', return_value=None)[0m
[30;1m649 | [0m[35m    def test_show_diff(self, mock_which, mock_env_get, mock_markup_to_pager, mock_isatty):[0m
[30;1m650 | [0m[35m        # no TTY[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m127 | [0m[35m  data_dir: data/postgresql0[0m
[30;1m128 | [0m[35m  pg_rewind:[0m
[30;1m129 | [0m[35m    username: postgres[0m
[30;1m130 | [0m[35m    password: postgres[0m
[30;1m131 | [0m[35mwatchdog:[0m
[30;1m132 | [0m[35m  mode: off[0m
[30;1m133 | [0m[35mzookeeper:[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1793 | [0m[35m        if self.__listen != config['listen'] or self.__ssl_options != ssl_options or self._received_[0m
[30;1m1794 | [0m[35m            self.__initialize(config['listen'], ssl_options)[0m
[30;1m1795 | [0m[35m[0m
[30;1m1796 | [0m[35m        self.__auth_key = base64.b64encode(config['auth'].encode('utf-8')) if 'auth' in config else [0m
[30;1m1797 | [0m[35m        # pyright -- ``__listen`` is initially created as ``None``, but right after that it is repla[0m
[30;1m1798 | [0m[35m        # through :func:`__initialize`.[0m
[30;1m1799 | [0m[35m        if TYPE_CHECKING:  # pragma: no cover[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m6 | [0m[35mutilises the API to perform these functions.[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport base64[0m
[30;1m10 | [0m[35mimport datetime[0m
[30;1m11 | [0m[35mimport hmac[0m
[30;1m12 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1781 | [0m[35m        self.__allowlist = tuple(self._build_allowlist(config.get('allowlist')))[0m
[30;1m1782 | [0m[35m        self.__allowlist_include_members = config.get('allowlist_include_members')[0m
[30;1m1783 | [0m[35m[0m
[30;1m1784 | [0m[35m        ssl_options = {n: config[n] for n in ('certfile', 'keyfile', 'keyfile_password',[0m
[30;1m1785 | [0m[35m                                              'cafile', 'ciphers') if n in config}[0m
[30;1m1786 | [0m[35m[0m
[30;1m1787 | [0m[35m        self.http_extra_headers = config.get('http_extra_headers') or {}[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1670 | [0m[35m            if ssl_options.get('ciphers'):[0m
[30;1m1671 | [0m[35m                ctx.set_ciphers(ssl_options['ciphers'])[0m
[30;1m1672 | [0m[35m            ctx.load_cert_chain(certfile=ssl_options['certfile'], keyfile=ssl_options.get('keyfile')[0m
[30;1m1673 | [0m[35m                                password=ssl_options.get('keyfile_password'))[0m
[30;1m1674 | [0m[35m            verify_client = ssl_options.get('verify_client')[0m
[30;1m1675 | [0m[35m            if verify_client:[0m
[30;1m1676 | [0m[35m                modes = {'none': ssl.CERT_NONE, 'optional': ssl.CERT_OPTIONAL, 'required': ssl.CERT_[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1670 | [0m[35m            if ssl_options.get('ciphers'):[0m
[30;1m1671 | [0m[35m                ctx.set_ciphers(ssl_options['ciphers'])[0m
[30;1m1672 | [0m[35m            ctx.load_cert_chain(certfile=ssl_options['certfile'], keyfile=ssl_options.get('keyfile')[0m
[30;1m1673 | [0m[35m                                password=ssl_options.get('keyfile_password'))[0m
[30;1m1674 | [0m[35m            verify_client = ssl_options.get('verify_client')[0m
[30;1m1675 | [0m[35m            if verify_client:[0m
[30;1m1676 | [0m[35m                modes = {'none': ssl.CERT_NONE, 'optional': ssl.CERT_OPTIONAL, 'required': ssl.CERT_[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1629 | [0m[35m[0m
[30;1m1630 | [0m[35m            * ``certfile``: path to PEM certificate. If given, will start in HTTPS mode;[0m
[30;1m1631 | [0m[35m            * ``keyfile``: path to key of ``certfile``;[0m
[30;1m1632 | [0m[35m            * ``keyfile_password``: password for decrypting ``keyfile``;[0m
[30;1m1633 | [0m[35m            * ``cafile``: path to CA file to validate client certificates;[0m
[30;1m1634 | [0m[35m            * ``ciphers``: permitted cipher suites;[0m
[30;1m1635 | [0m[35m            * ``verify_client``: value can be one among:[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1629 | [0m[35m[0m
[30;1m1630 | [0m[35m            * ``certfile``: path to PEM certificate. If given, will start in HTTPS mode;[0m
[30;1m1631 | [0m[35m            * ``keyfile``: path to key of ``certfile``;[0m
[30;1m1632 | [0m[35m            * ``keyfile_password``: password for decrypting ``keyfile``;[0m
[30;1m1633 | [0m[35m            * ``cafile``: path to CA file to validate client certificates;[0m
[30;1m1634 | [0m[35m            * ``ciphers``: permitted cipher suites;[0m
[30;1m1635 | [0m[35m            * ``verify_client``: value can be one among:[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1536 | [0m[35m[0m
[30;1m1537 | [0m[35m        Write a response back to the client if any issue is observed, and the HTTP status may be:[0m
[30;1m1538 | [0m[35m[0m
[30;1m1539 | [0m[35m            * ``401``: if ``Authorization`` header is missing or contain an invalid password;[0m
[30;1m1540 | [0m[35m            * ``403``: if:[0m
[30;1m1541 | [0m[35m[0m
[30;1m1542 | [0m[35m                * ``restapi.allowlist`` was configured, but client IP is not in the allowed list; or[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1474 | [0m[35m[0m
[30;1m1475 | [0m[35m        :param key: the password received through the Basic authorization header of an HTTP request.[0m
[30;1m1476 | [0m[35m[0m
[30;1m1477 | [0m[35m        :returns: ``True`` if *key* matches the password configured for the REST API.[0m
[30;1m1478 | [0m[35m        """[0m
[30;1m1479 | [0m[35m        # pyright -- ``__auth_key`` was already checked through the caller method (:func:`check_auth[0m
[30;1m1480 | [0m[35m        if TYPE_CHECKING:  # pragma: no cover[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1472 | [0m[35m    def check_basic_auth_key(self, key: str) -> bool:[0m
[30;1m1473 | [0m[35m        """Check if *key* matches the password configured for the REST API.[0m
[30;1m1474 | [0m[35m[0m
[30;1m1475 | [0m[35m        :param key: the password received through the Basic authorization header of an HTTP request.[0m
[30;1m1476 | [0m[35m[0m
[30;1m1477 | [0m[35m        :returns: ``True`` if *key* matches the password configured for the REST API.[0m
[30;1m1478 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1470 | [0m[35m            fcntl.fcntl(fd, fcntl.F_SETFD, flags | fcntl.FD_CLOEXEC)[0m
[30;1m1471 | [0m[35m[0m
[30;1m1472 | [0m[35m    def check_basic_auth_key(self, key: str) -> bool:[0m
[30;1m1473 | [0m[35m        """Check if *key* matches the password configured for the REST API.[0m
[30;1m1474 | [0m[35m[0m
[30;1m1475 | [0m[35m        :param key: the password received through the Basic authorization header of an HTTP request.[0m
[30;1m1476 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m129 | [0m[35m    def _pool_config_from_file_or_data(self, config: Dict[str, str], file_key_name: str, pool_key_na[0m
[30;1m130 | [0m[35m        data_key_name = file_key_name + '-data'[0m
[30;1m131 | [0m[35m        if data_key_name in config:[0m
[30;1m132 | [0m[35m            self.pool_config[pool_key_name] = _create_temp_file(base64.b64decode(config[data_key_nam[0m
[30;1m133 | [0m[35m        elif file_key_name in config:[0m
[30;1m134 | [0m[35m            self.pool_config[pool_key_name] = config[file_key_name][0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport atexit[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport datetime[0m
[30;1m4 | [0m[35mimport functools[0m
[30;1m5 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m159 | [0m[35m        if user.get('token'):[0m
[30;1m160 | [0m[35m            self._make_headers(token=user['token'])[0m
[30;1m161 | [0m[35m        elif 'username' in user and 'password' in user:[0m
[30;1m162 | [0m[35m            self._make_headers(basic_auth=':'.join((user['username'], user['password'])))[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    @property[0m
[30;1m165 | [0m[35m    def server(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m158 | [0m[35m            self.pool_config['cert_reqs'] = 'CERT_NONE' if cluster.get('insecure-skip-tls-verify') e[0m
[30;1m159 | [0m[35m        if user.get('token'):[0m
[30;1m160 | [0m[35m            self._make_headers(token=user['token'])[0m
[30;1m161 | [0m[35m        elif 'username' in user and 'password' in user:[0m
[30;1m162 | [0m[35m            self._make_headers(basic_auth=':'.join((user['username'], user['password'])))[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m
[30;1m761 | [0m[35m        self._standby_leader_label_value = config.get('standby_leader_label_value', 'primary')[0m
[30;1m762 | [0m[35m        self._tmp_role_label = config.get('tmp_role_label')[0m
[30;1m763 | [0m[35m        self._ca_certs = os.environ.get('PATRONI_KUBERNETES_CACERT', config.get('cacert')) or SERVIC[0m
[30;1m764 | [0m[35m        super(Kubernetes, self).__init__({**config, 'namespace': ''}, mpp)[0m
[30;1m765 | [0m[35m        if self._mpp.is_enabled():[0m
[30;1m766 | [0m[35m            self._labels[self._mpp.k8s_group_label] = str(self._mpp.group)[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mKUBE_CONFIG_DEFAULT_LOCATION = os.environ.get('KUBECONFIG', '~/.kube/config')[0m
[30;1m37 | [0m[35mSERVICE_HOST_ENV_NAME = 'KUBERNETES_SERVICE_HOST'[0m
[30;1m38 | [0m[35mSERVICE_PORT_ENV_NAME = 'KUBERNETES_SERVICE_PORT'[0m
[30;1m39 | [0m[35mSERVICE_TOKEN_FILENAME = '/var/run/secrets/kubernetes.io/serviceaccount/token'[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m480 | [0m[35m                        else:[0m
[30;1m481 | [0m[35m                            postgresql.reload()[0m
[30;1m482 | [0m[35m                            time.sleep(1)  # give a time to postgres to "reload" configuration files[0m
[30;1m483 | [0m[35m                            postgresql.connection().close()  # close connection to reconnect with a [0m
[30;1m484 | [0m[35m                else:  # initdb[0m
[30;1m485 | [0m[35m                    # We may want create database and extension for some MPP clusters[0m
[30;1m486 | [0m[35m                    self._postgresql.mpp_handler.bootstrap()[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m457 | [0m[35m                                 'Please use "bootstrap.post_bootstrap" script to create users.')[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m                # We were doing a custom bootstrap instead of running initdb, therefore we opened tr[0m
[30;1m460 | [0m[35m                # access from certain addresses to be able to reach cluster and change password[0m
[30;1m461 | [0m[35m                if self._running_custom_bootstrap:[0m
[30;1m462 | [0m[35m                    self._running_custom_bootstrap = False[0m
[30;1m463 | [0m[35m                    # If we don't have custom configuration for pg_hba.conf we need to restore origi[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m                rewind = postgresql.config.rewind_credentials[0m
[30;1m444 | [0m[35m                if not deep_compare(rewind, superuser):[0m
[30;1m445 | [0m[35m                    self.create_or_update_role(rewind['username'], rewind.get('password'), [])[0m
[30;1m446 | [0m[35m                    for f in ('pg_ls_dir(text, boolean, boolean)', 'pg_stat_file(text, boolean)',[0m
[30;1m447 | [0m[35m                              'pg_read_binary_file(text)', 'pg_read_binary_file(text, bigint, bigint[0m
[30;1m448 | [0m[35m                        sql = """DO $$[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m438 | [0m[35m            task.complete(self.call_post_bootstrap(config))[0m
[30;1m439 | [0m[35m            if task.result:[0m
[30;1m440 | [0m[35m                replication = postgresql.config.replication[0m
[30;1m441 | [0m[35m                self.create_or_update_role(replication['username'], replication.get('password'), ['R[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m                rewind = postgresql.config.rewind_credentials[0m
[30;1m444 | [0m[35m                if not deep_compare(rewind, superuser):[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m433 | [0m[35m            postgresql = self._postgresql[0m
[30;1m434 | [0m[35m            superuser = postgresql.config.superuser[0m
[30;1m435 | [0m[35m            if 'username' in superuser and 'password' in superuser:[0m
[30;1m436 | [0m[35m                self.create_or_update_role(superuser['username'], superuser['password'], ['SUPERUSER[0m
[30;1m437 | [0m[35m[0m
[30;1m438 | [0m[35m            task.complete(self.call_post_bootstrap(config))[0m
[30;1m439 | [0m[35m            if task.result:[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m432 | [0m[35m        try:[0m
[30;1m433 | [0m[35m            postgresql = self._postgresql[0m
[30;1m434 | [0m[35m            superuser = postgresql.config.superuser[0m
[30;1m435 | [0m[35m            if 'username' in superuser and 'password' in superuser:[0m
[30;1m436 | [0m[35m                self.create_or_update_role(superuser['username'], superuser['password'], ['SUPERUSER[0m
[30;1m437 | [0m[35m[0m
[30;1m438 | [0m[35m            task.complete(self.call_post_bootstrap(config))[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m402 | [0m[35m            options.append('LOGIN')[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m        if password:[0m
[30;1m405 | [0m[35m            options.extend(['PASSWORD', quote_literal(password)])[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        sql = """DO $$[0m
[30;1m408 | [0m[35mBEGIN[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m402 | [0m[35m            options.append('LOGIN')[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m        if password:[0m
[30;1m405 | [0m[35m            options.extend(['PASSWORD', quote_literal(password)])[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        sql = """DO $$[0m
[30;1m408 | [0m[35mBEGIN[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m401 | [0m[35m        if 'NOLOGIN' not in options and 'LOGIN' not in options:[0m
[30;1m402 | [0m[35m            options.append('LOGIN')[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m        if password:[0m
[30;1m405 | [0m[35m            options.extend(['PASSWORD', quote_literal(password)])[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        sql = """DO $$[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m396 | [0m[35m        return do_initialize(config.get(method)) and self._postgresql.config.append_pg_hba(pg_hba) \[0m
[30;1m397 | [0m[35m            and self._postgresql.config.save_configuration_files() and bool(self._postgresql.start()[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m    def create_or_update_role(self, name: str, password: Optional[str], options: List[str]) -> None:[0m
[30;1m400 | [0m[35m        options = list(map(str.upper, options))[0m
[30;1m401 | [0m[35m        if 'NOLOGIN' not in options and 'LOGIN' not in options:[0m
[30;1m402 | [0m[35m            options.append('LOGIN')[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m334 | [0m[35m        maxfailures = 2[0m
[30;1m335 | [0m[35m        ret = 1[0m
[30;1m336 | [0m[35m        not_allowed_options = ('pgdata', 'format', 'wal-method', 'xlog-method', 'gzip',[0m
[30;1m337 | [0m[35m                               'version', 'compress', 'dbname', 'host', 'port', 'username', 'passwor[0m
[30;1m338 | [0m[35m        user_options = self.process_user_options('basebackup', options, not_allowed_options, logger.[0m
[30;1m339 | [0m[35m        cmd = [[0m
[30;1m340 | [0m[35m            self._postgresql.pgcommand("pg_basebackup"),[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m256 | [0m[35m            r = clone_member.conn_kwargs(self._postgresql.config.replication)[0m
[30;1m257 | [0m[35m            # add the credentials to connect to the replica origin to pgpass.[0m
[30;1m258 | [0m[35m            env = self._postgresql.config.write_pgpass(r)[0m
[30;1m259 | [0m[35m            connstring = self._postgresql.config.format_dsn({**r, 'password': None})[0m
[30;1m260 | [0m[35m        else:[0m
[30;1m261 | [0m[35m            connstring = ''[0m
[30;1m262 | [0m[35m            env = os.environ.copy()[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m222 | [0m[35m            # (pghost empty or the default socket directory) connections coming from the local machi[0m
[30;1m223 | [0m[35m            env = self._postgresql.config.write_pgpass({'host': 'localhost', **r})[0m
[30;1m224 | [0m[35m            env['PGOPTIONS'] = '-c synchronous_commit=local -c statement_timeout=0'[0m
[30;1m225 | [0m[35m            connstring = self._postgresql.config.format_dsn({**r, 'password': None})[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m            try:[0m
[30;1m228 | [0m[35m                ret = self._postgresql.cancellable.call(shlex.split(cmd) + [connstring], env=env)[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m128 | [0m[35m                options.append('--username={0}'.format(self._postgresql.config.superuser['username'][0m
[30;1m129 | [0m[35m            if 'password' in self._postgresql.config.superuser:[0m
[30;1m130 | [0m[35m                (fd, pwfile) = tempfile.mkstemp()[0m
[30;1m131 | [0m[35m                os.write(fd, self._postgresql.config.superuser['password'].encode('utf-8'))[0m
[30;1m132 | [0m[35m                os.close(fd)[0m
[30;1m133 | [0m[35m                options.append('--pwfile={0}'.format(pwfile))[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m        if self._postgresql.config.superuser:[0m
[30;1m127 | [0m[35m            if 'username' in self._postgresql.config.superuser:[0m
[30;1m128 | [0m[35m                options.append('--username={0}'.format(self._postgresql.config.superuser['username'][0m
[30;1m129 | [0m[35m            if 'password' in self._postgresql.config.superuser:[0m
[30;1m130 | [0m[35m                (fd, pwfile) = tempfile.mkstemp()[0m
[30;1m131 | [0m[35m                os.write(fd, self._postgresql.config.superuser['password'].encode('utf-8'))[0m
[30;1m132 | [0m[35m                os.close(fd)[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m255 | [0m[35m        if clone_member and clone_member.conn_url:[0m
[30;1m256 | [0m[35m            r = clone_member.conn_kwargs(self._postgresql.config.replication)[0m
[30;1m257 | [0m[35m            # add the credentials to connect to the replica origin to pgpass.[0m
[30;1m258 | [0m[35m            env = self._postgresql.config.write_pgpass(r)[0m
[30;1m259 | [0m[35m            connstring = self._postgresql.config.format_dsn({**r, 'password': None})[0m
[30;1m260 | [0m[35m        else:[0m
[30;1m261 | [0m[35m            connstring = ''[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m221 | [0m[35m            # A host name of localhost matches both TCP (host name localhost) and Unix domain socket[0m
[30;1m222 | [0m[35m            # (pghost empty or the default socket directory) connections coming from the local machi[0m
[30;1m223 | [0m[35m            env = self._postgresql.config.write_pgpass({'host': 'localhost', **r})[0m
[30;1m224 | [0m[35m            env['PGOPTIONS'] = '-c synchronous_commit=local -c statement_timeout=0'[0m
[30;1m225 | [0m[35m            connstring = self._postgresql.config.format_dsn({**r, 'password': None})[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m220 | [0m[35m            # https://www.postgresql.org/docs/current/static/libpq-pgpass.html[0m
[30;1m221 | [0m[35m            # A host name of localhost matches both TCP (host name localhost) and Unix domain socket[0m
[30;1m222 | [0m[35m            # (pghost empty or the default socket directory) connections coming from the local machi[0m
[30;1m223 | [0m[35m            env = self._postgresql.config.write_pgpass({'host': 'localhost', **r})[0m
[30;1m224 | [0m[35m            env['PGOPTIONS'] = '-c synchronous_commit=local -c statement_timeout=0'[0m
[30;1m225 | [0m[35m            connstring = self._postgresql.config.format_dsn({**r, 'password': None})[0m
[30;1m226 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35mdef base64_decode(v: str) -> str:[0m
[30;1m193 | [0m[35m    return base64.b64decode(v).decode('utf-8')[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35mdef build_range_request(key: str, range_end: Union[bytes, str, None] = None) -> Dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35mdef base64_encode(v: Union[str, bytes]) -> str:[0m
[30;1m189 | [0m[35m    return base64.b64encode(to_bytes(v)).decode('utf-8')[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35mdef base64_decode(v: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mfrom __future__ import absolute_import[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m335 | [0m[35m                                                 'supported on version lower than 3.3.0. Cluster ver[0m
[30;1m336 | [0m[35m                                                 '{0}'.format('.'.join(map(str, self._cluster_versio[0m
[30;1m337 | [0m[35m                exc = e[0m
[30;1m338 | [0m[35m            except InvalidAuthToken as e:[0m
[30;1m339 | [0m[35m                logger.error('Invalid auth token: %s', self._token)[0m
[30;1m340 | [0m[35m                exc = e[0m
[30;1m341 | [0m[35m            except AuthOldRevision as e:[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m320 | [0m[35m                    self.authenticate(retry=retry)[0m
[30;1m321 | [0m[35m                    self._reauthenticate = False[0m
[30;1m322 | [0m[35m                else:[0m
[30;1m323 | [0m[35m                    msg = 'Username or password not set, authentication is not possible'[0m
[30;1m324 | [0m[35m                    logger.fatal(msg)[0m
[30;1m325 | [0m[35m                    raise exc or Etcd3Exception(msg)[0m
[30;1m326 | [0m[35m                reauthenticated = True[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m316 | [0m[35m        exc = None[0m
[30;1m317 | [0m[35m        while True:[0m
[30;1m318 | [0m[35m            if self._reauthenticate:[0m
[30;1m319 | [0m[35m                if self.username and self.password:[0m
[30;1m320 | [0m[35m                    self.authenticate(retry=retry)[0m
[30;1m321 | [0m[35m                    self._reauthenticate = False[0m
[30;1m322 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m299 | [0m[35m        logger.info('Trying to authenticate on Etcd...')[0m
[30;1m300 | [0m[35m        old_token, self._token = self._token, None[0m
[30;1m301 | [0m[35m        try:[0m
[30;1m302 | [0m[35m            response = self.call_rpc('/auth/authenticate', {'name': self.username, 'password': self.[0m
[30;1m303 | [0m[35m        except AuthNotEnabled:[0m
[30;1m304 | [0m[35m            logger.info('Etcd authentication is not enabled')[0m
[30;1m305 | [0m[35m            self._token = None[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m299 | [0m[35m        logger.info('Trying to authenticate on Etcd...')[0m
[30;1m300 | [0m[35m        old_token, self._token = self._token, None[0m
[30;1m301 | [0m[35m        try:[0m
[30;1m302 | [0m[35m            response = self.call_rpc('/auth/authenticate', {'name': self.username, 'password': self.[0m
[30;1m303 | [0m[35m        except AuthNotEnabled:[0m
[30;1m304 | [0m[35m            logger.info('Etcd authentication is not enabled')[0m
[30;1m305 | [0m[35m            self._token = None[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m294 | [0m[35m        if self._use_proxies and not self._cluster_version:[0m
[30;1m295 | [0m[35m            kwargs = self._prepare_common_parameters(1)[0m
[30;1m296 | [0m[35m            self._ensure_version_prefix(self._base_uri, **kwargs)[0m
[30;1m297 | [0m[35m        if not (self._cluster_version >= (3, 3) and self.username and self.password):[0m
[30;1m298 | [0m[35m            return False[0m
[30;1m299 | [0m[35m        logger.info('Trying to authenticate on Etcd...')[0m
[30;1m300 | [0m[35m        old_token, self._token = self._token, None[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m266 | [0m[35m                    if self._cluster_version < (3, 1):[0m
[30;1m267 | [0m[35m                        logger.warning('Detected Etcd version %s is lower than 3.1.0, watches are no[0m
[30;1m268 | [0m[35m                                       cluster_version_str)[0m
[30;1m269 | [0m[35m                    if self.username and self.password:[0m
[30;1m270 | [0m[35m                        logger.warning('Detected Etcd version %s is lower than 3.3.0, authentication[0m
[30;1m271 | [0m[35m                                       cluster_version_str)[0m
[30;1m272 | [0m[35m                    self.version_prefix = '/v3alpha'[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m141 | [0m[35m    error = "etcdserver: authentication is not enabled"[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35mclass InvalidAuthToken(Etcd3ClientError):[0m
[30;1m145 | [0m[35m    code = GRPCCode.Unauthenticated[0m
[30;1m146 | [0m[35m    error = "etcdserver: invalid auth token"[0m
[30;1m147 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35mclass AuthFailed(InvalidArgument):[0m
[30;1m128 | [0m[35m    error = "etcdserver: authentication failed, invalid user ID or password"[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mclass AuthOldRevision(InvalidArgument):[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/available_parameters/0_postgres.yml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1823 | [0m[35m  - type: Enum[0m
[30;1m1824 | [0m[35m    version_from: 90300[0m
[30;1m1825 | [0m[35m    possible_values:[0m
[30;1m1826 | [0m[35m    - base64[0m
[30;1m1827 | [0m[35m    - hex[0m
[30;1m1828 | [0m[35m  xmloption:[0m
[30;1m1829 | [0m[35m  - type: Enum[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/available_parameters/0_postgres.yml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1163 | [0m[35m    version_from: 90600[0m
[30;1m1164 | [0m[35m    min_val: 0[0m
[30;1m1165 | [0m[35m    max_val: 1.79769e+308[0m
[30;1m1166 | [0m[35m  password_encryption:[0m
[30;1m1167 | [0m[35m  - type: Bool[0m
[30;1m1168 | [0m[35m    version_from: 90300[0m
[30;1m1169 | [0m[35m    version_till: 100000[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_patroni.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m120 | [0m[35m                self.assertRaises(SleepException, _main)[0m
[30;1m121 | [0m[35m            with patch.object(Patroni, 'run', Mock(side_effect=KeyboardInterrupt())):[0m
[30;1m122 | [0m[35m                with patch('patroni.ha.Ha.is_paused', Mock(return_value=True)):[0m
[30;1m123 | [0m[35m                    os.environ['PATRONI_POSTGRESQL_DATA_DIR'] = 'data/test0'[0m
[30;1m124 | [0m[35m                    _main()[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    @patch('os.getpid')[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_patroni.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m116 | [0m[35m    def test_patroni_patroni_main(self):[0m
[30;1m117 | [0m[35m        with patch('subprocess.call', Mock(return_value=1)):[0m
[30;1m118 | [0m[35m            with patch.object(Patroni, 'run', Mock(side_effect=SleepException)):[0m
[30;1m119 | [0m[35m                os.environ['PATRONI_POSTGRESQL_DATA_DIR'] = 'data/test0'[0m
[30;1m120 | [0m[35m                self.assertRaises(SleepException, _main)[0m
[30;1m121 | [0m[35m            with patch.object(Patroni, 'run', Mock(side_effect=KeyboardInterrupt())):[0m
[30;1m122 | [0m[35m                with patch('patroni.ha.Ha.is_paused', Mock(return_value=True)):[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_patroni.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m84 | [0m[35m        RestApiServer._BaseServer__is_shut_down = Mock()[0m
[30;1m85 | [0m[35m        RestApiServer._BaseServer__shutdown_request = True[0m
[30;1m86 | [0m[35m        RestApiServer.socket = 0[0m
[30;1m87 | [0m[35m        os.environ['PATRONI_POSTGRESQL_DATA_DIR'] = 'data/test0'[0m
[30;1m88 | [0m[35m        conf = config.Config('postgres0.yml')[0m
[30;1m89 | [0m[35m        self.p = Patroni(conf)[0m
[30;1m90 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m722 | [0m[35m                cur.execute('CREATE EXTENSION IF NOT EXISTS citus')[0m
[30;1m723 | [0m[35m[0m
[30;1m724 | [0m[35m                superuser = self._postgresql.config.superuser[0m
[30;1m725 | [0m[35m                params = {k: superuser[k] for k in ('password', 'sslcert', 'sslkey') if k in superus[0m
[30;1m726 | [0m[35m                if params:[0m
[30;1m727 | [0m[35m                    cur.execute("INSERT INTO pg_catalog.pg_dist_authinfo VALUES"[0m
[30;1m728 | [0m[35m                                "(0, pg_catalog.current_user(), %s)",[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m            'PATRONI_SUPERUSER_PASSWORD': 'patroni',[0m
[30;1m78 | [0m[35m            'PATRONI_REPLICATION_USERNAME': 'replicator',[0m
[30;1m79 | [0m[35m            'PATRONI_REPLICATION_PASSWORD': 'rep-pass',[0m
[30;1m80 | [0m[35m            'PATRONI_admin_PASSWORD': 'admin',[0m
[30;1m81 | [0m[35m            'PATRONI_admin_OPTIONS': 'createrole,createdb',[0m
[30;1m82 | [0m[35m            'PATRONI_POSTGRESQL_BIN_POSTGRES': 'sergtsop'[0m
[30;1m83 | [0m[35m        })[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m            'PATRONI_SUPERUSER_USERNAME': 'postgres',[0m
[30;1m77 | [0m[35m            'PATRONI_SUPERUSER_PASSWORD': 'patroni',[0m
[30;1m78 | [0m[35m            'PATRONI_REPLICATION_USERNAME': 'replicator',[0m
[30;1m79 | [0m[35m            'PATRONI_REPLICATION_PASSWORD': 'rep-pass',[0m
[30;1m80 | [0m[35m            'PATRONI_admin_PASSWORD': 'admin',[0m
[30;1m81 | [0m[35m            'PATRONI_admin_OPTIONS': 'createrole,createdb',[0m
[30;1m82 | [0m[35m            'PATRONI_POSTGRESQL_BIN_POSTGRES': 'sergtsop'[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m74 | [0m[35m            'PATRONI_RAFT_PARTNER_ADDRS': "'host1:1234','host2:1234'",[0m
[30;1m75 | [0m[35m            'PATRONI_foo_HOSTS': '[host1,host2',  # Exception in parse_list[0m
[30;1m76 | [0m[35m            'PATRONI_SUPERUSER_USERNAME': 'postgres',[0m
[30;1m77 | [0m[35m            'PATRONI_SUPERUSER_PASSWORD': 'patroni',[0m
[30;1m78 | [0m[35m            'PATRONI_REPLICATION_USERNAME': 'replicator',[0m
[30;1m79 | [0m[35m            'PATRONI_REPLICATION_PASSWORD': 'rep-pass',[0m
[30;1m80 | [0m[35m            'PATRONI_admin_PASSWORD': 'admin',[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35m            'PATRONI_CITUS_GROUP': '0',[0m
[30;1m44 | [0m[35m            'PATRONI_CITUS_HOST': '0',[0m
[30;1m45 | [0m[35m            'PATRONI_RESTAPI_USERNAME': 'username',[0m
[30;1m46 | [0m[35m            'PATRONI_RESTAPI_PASSWORD': 'password',[0m
[30;1m47 | [0m[35m            'PATRONI_RESTAPI_LISTEN': '0.0.0.0:8008',[0m
[30;1m48 | [0m[35m            'PATRONI_RESTAPI_CONNECT_ADDRESS': '127.0.0.1:8008',[0m
[30;1m49 | [0m[35m            'PATRONI_RESTAPI_CERTFILE': '/certfile',[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35m            'PATRONI_CITUS_GROUP': '0',[0m
[30;1m44 | [0m[35m            'PATRONI_CITUS_HOST': '0',[0m
[30;1m45 | [0m[35m            'PATRONI_RESTAPI_USERNAME': 'username',[0m
[30;1m46 | [0m[35m            'PATRONI_RESTAPI_PASSWORD': 'password',[0m
[30;1m47 | [0m[35m            'PATRONI_RESTAPI_LISTEN': '0.0.0.0:8008',[0m
[30;1m48 | [0m[35m            'PATRONI_RESTAPI_CONNECT_ADDRESS': '127.0.0.1:8008',[0m
[30;1m49 | [0m[35m            'PATRONI_RESTAPI_CERTFILE': '/certfile',[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m173 | [0m[35m            self.client.username = None[0m
[30;1m174 | [0m[35m            self.client._reauthenticate = False[0m
[30;1m175 | [0m[35m            retry = self.etcd3._retry.copy()[0m
[30;1m176 | [0m[35m            self.assertRaises(InvalidAuthToken, retry, self.client.deleteprefix, 'foo', retry=retry)[0m
[30;1m177 | [0m[35m            mock_urlopen.return_value.content = '{"code":3,"error":"etcdserver: revision of auth sto[0m
[30;1m178 | [0m[35m            self.client._reauthenticate = False[0m
[30;1m179 | [0m[35m            self.assertRaises(AuthOldRevision, retry, self.client.deleteprefix, 'foo', retry=retry)[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m169 | [0m[35m            with patch('time.time', Mock(side_effect=[0, 10, 20, 30, 40])):[0m
[30;1m170 | [0m[35m                self.assertRaises(InvalidAuthToken, retry, self.client.deleteprefix, 'foo', retry=re[0m
[30;1m171 | [0m[35m            with patch('time.time', Mock(side_effect=[0, 10])):[0m
[30;1m172 | [0m[35m                self.assertRaises(InvalidAuthToken, self.client.deleteprefix, 'foo')[0m
[30;1m173 | [0m[35m            self.client.username = None[0m
[30;1m174 | [0m[35m            self.client._reauthenticate = False[0m
[30;1m175 | [0m[35m            retry = self.etcd3._retry.copy()[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m167 | [0m[35m        with patch.object(PatroniEtcd3Client, 'authenticate', Mock(return_value=True)):[0m
[30;1m168 | [0m[35m            retry = self.etcd3._retry.copy()[0m
[30;1m169 | [0m[35m            with patch('time.time', Mock(side_effect=[0, 10, 20, 30, 40])):[0m
[30;1m170 | [0m[35m                self.assertRaises(InvalidAuthToken, retry, self.client.deleteprefix, 'foo', retry=re[0m
[30;1m171 | [0m[35m            with patch('time.time', Mock(side_effect=[0, 10])):[0m
[30;1m172 | [0m[35m                self.assertRaises(InvalidAuthToken, self.client.deleteprefix, 'foo')[0m
[30;1m173 | [0m[35m            self.client.username = None[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m163 | [0m[35m        self.client._cluster_version = (3, 3, 13)[0m
[30;1m164 | [0m[35m        self.assertRaises(UserEmpty, self.client.deleteprefix, 'foo')[0m
[30;1m165 | [0m[35m        mock_urlopen.return_value.content = '{"code":16,"error":"etcdserver: invalid auth token"}'[0m
[30;1m166 | [0m[35m        self.assertRaises(InvalidAuthToken, self.client.deleteprefix, 'foo')[0m
[30;1m167 | [0m[35m        with patch.object(PatroniEtcd3Client, 'authenticate', Mock(return_value=True)):[0m
[30;1m168 | [0m[35m            retry = self.etcd3._retry.copy()[0m
[30;1m169 | [0m[35m            with patch('time.time', Mock(side_effect=[0, 10, 20, 30, 40])):[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m    @patch.object(urllib3.PoolManager, 'urlopen', mock_urlopen)[0m
[30;1m86 | [0m[35m    def setUp(self):[0m
[30;1m87 | [0m[35m        self.etcd3 = get_dcs({'namespace': '/patroni/', 'ttl': 30, 'retry_timeout': 10, 'name': 'foo[0m
[30;1m88 | [0m[35m                              'etcd3': {'host': 'localhost:2378', 'username': 'etcduser', 'password'[0m
[30;1m89 | [0m[35m        self.assertIsInstance(self.etcd3, Etcd3)[0m
[30;1m90 | [0m[35m        self.client = self.etcd3._client[0m
[30;1m91 | [0m[35m        self.kv_cache = self.client._kv_cache[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m    @patch.object(urllib3.PoolManager, 'urlopen', mock_urlopen)[0m
[30;1m86 | [0m[35m    def setUp(self):[0m
[30;1m87 | [0m[35m        self.etcd3 = get_dcs({'namespace': '/patroni/', 'ttl': 30, 'retry_timeout': 10, 'name': 'foo[0m
[30;1m88 | [0m[35m                              'etcd3': {'host': 'localhost:2378', 'username': 'etcduser', 'password'[0m
[30;1m89 | [0m[35m        self.assertIsInstance(self.etcd3, Etcd3)[0m
[30;1m90 | [0m[35m        self.client = self.etcd3._client[0m
[30;1m91 | [0m[35m        self.kv_cache = self.client._kv_cache[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m    elif url.endswith('/cluster/member/list'):[0m
[30;1m27 | [0m[35m        ret.content = '{"members":[{"clientURLs":["http://localhost:2379", "http://localhost:4001"]}[0m
[30;1m28 | [0m[35m    elif url.endswith('/auth/authenticate'):[0m
[30;1m29 | [0m[35m        ret.content = '{"token":"authtoken"}'[0m
[30;1m30 | [0m[35m    elif url.endswith('/lease/grant'):[0m
[30;1m31 | [0m[35m        ret.content = '{"ID": "123"}'[0m
[30;1m32 | [0m[35m    elif url.endswith('/lease/keepalive'):[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35mfrom patroni.dcs import get_dcs[0m
[30;1m11 | [0m[35mfrom patroni.dcs.etcd import DnsCachingResolver[0m
[30;1m12 | [0m[35mfrom patroni.dcs.etcd3 import AuthFailed, AuthOldRevision, base64_encode, Cluster, Etcd3, \[0m
[30;1m13 | [0m[35m    Etcd3Client, Etcd3ClientError, Etcd3Error, InvalidAuthToken, PatroniEtcd3Client, \[0m
[30;1m14 | [0m[35m    RetryFailedError, Unavailable, Unknown, UnsupportedEtcdVersion, UserEmpty[0m
[30;1m15 | [0m[35mfrom patroni.postgresql.mpp import get_mpp[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/recover.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35m        application. Refer to :class:`ExitCode`.[0m
[30;1m119 | [0m[35m    """[0m
[30;1m120 | [0m[35m    return _restore_backup(api, args.barman_server, args.backup_id,[0m
[30;1m121 | [0m[35m                           args.ssh_command, args.data_directory,[0m
[30;1m122 | [0m[35m                           args.loop_wait)[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m        "bind_addr": "0.0.0.0:2222",[0m
[30;1m63 | [0m[35m        "partner_addrs": ["127.0.0.1:2223", "127.0.0.1:2224"],[0m
[30;1m64 | [0m[35m        "data_dir": "/",[0m
[30;1m65 | [0m[35m        "password": "12345"[0m
[30;1m66 | [0m[35m    },[0m
[30;1m67 | [0m[35m    "zookeeper": {[0m
[30;1m68 | [0m[35m        "hosts": "127.0.0.1:3379,127.0.0.1:3380"[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1203 | [0m[35m                         'channel_binding=prefer target_session_attrs=read-write')[0m
[30;1m1204 | [0m[35m        self.p._major_version = 170000[0m
[30;1m1205 | [0m[35m        self.assertEqual(self.p.config.format_dsn(params),[0m
[30;1m1206 | [0m[35m                         'host=1 port=2 sslpassword=pwd sslcrldir=/ gssencmode=prefer channel_bindin[0m
[30;1m1207 | [0m[35m                         'target_session_attrs=read-write sslnegotiation=postgres')[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1199 | [0m[35m                         'channel_binding=prefer target_session_attrs=read-write')[0m
[30;1m1200 | [0m[35m        self.p._major_version = 140000[0m
[30;1m1201 | [0m[35m        self.assertEqual(self.p.config.format_dsn(params),[0m
[30;1m1202 | [0m[35m                         'host=1 port=2 sslpassword=pwd sslcrldir=/ gssencmode=prefer '[0m
[30;1m1203 | [0m[35m                         'channel_binding=prefer target_session_attrs=read-write')[0m
[30;1m1204 | [0m[35m        self.p._major_version = 170000[0m
[30;1m1205 | [0m[35m        self.assertEqual(self.p.config.format_dsn(params),[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1195 | [0m[35m                         'host=1 port=2 gssencmode=prefer target_session_attrs=read-write')[0m
[30;1m1196 | [0m[35m        self.p._major_version = 130000[0m
[30;1m1197 | [0m[35m        self.assertEqual(self.p.config.format_dsn(params),[0m
[30;1m1198 | [0m[35m                         'host=1 port=2 sslpassword=pwd gssencmode=prefer '[0m
[30;1m1199 | [0m[35m                         'channel_binding=prefer target_session_attrs=read-write')[0m
[30;1m1200 | [0m[35m        self.p._major_version = 140000[0m
[30;1m1201 | [0m[35m        self.assertEqual(self.p.config.format_dsn(params),[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1185 | [0m[35m[0m
[30;1m1186 | [0m[35m    def test_format_dsn(self):[0m
[30;1m1187 | [0m[35m        params = {'host': '1', 'port': 2, 'target_session_attrs': 'read-write', 'gssencmode': 'prefe[0m
[30;1m1188 | [0m[35m                  'channel_binding': 'prefer', 'sslpassword': 'pwd', 'sslcrldir': '/', 'sslnegotiati[0m
[30;1m1189 | [0m[35m        self.p._major_version = 90600[0m
[30;1m1190 | [0m[35m        self.assertEqual(self.p.config.format_dsn(params), 'host=1 port=2')[0m
[30;1m1191 | [0m[35m        self.p._major_version = 100000[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m722 | [0m[35m        self.assertEqual(self.p.connection_pool.conn_kwargs, {'connect_timeout': 3, 'dbname': 'postg[0m
[30;1m723 | [0m[35m                                                              'fallback_application_name': 'Patroni'[0m
[30;1m724 | [0m[35m                                                              'options': '-c statement_timeout=2000'[0m
[30;1m725 | [0m[35m                                                              'password': 'test', 'port': '5432', 'u[0m
[30;1m726 | [0m[35m[0m
[30;1m727 | [0m[35m    @patch.object(Postgresql, '_version_file_exists', Mock(return_value=True))[0m
[30;1m728 | [0m[35m    def test_get_major_version(self):[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m342 | [0m[35m    @patch.object(Postgresql, 'major_version', PropertyMock(return_value=100000))[0m
[30;1m343 | [0m[35m    @patch.object(Postgresql, 'primary_conninfo', Mock(return_value='host=1'))[0m
[30;1m344 | [0m[35m    def test__read_recovery_params_pre_v12(self):[0m
[30;1m345 | [0m[35m        self.p.config.write_recovery_conf({'standby_mode': 'off', 'primary_conninfo': {'password': '[0m
[30;1m346 | [0m[35m        self.assertEqual(self.p.config.check_recovery_conf(None), (True, True))[0m
[30;1m347 | [0m[35m        self.assertEqual(self.p.config.check_recovery_conf(None), (True, True))[0m
[30;1m348 | [0m[35m        self.p.config.write_recovery_conf({'restore_command': '\n'})[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m318 | [0m[35m        self.p.call_nowait(CallbackAction.ON_START)[0m
[30;1m319 | [0m[35m        mock_get_pg_settings.return_value = {'primary_conninfo': ['primary_conninfo', '', None, 'str[0m
[30;1m320 | [0m[35m                                                                  'postmaster', self.p.config._postg[0m
[30;1m321 | [0m[35m        self.p.config.write_recovery_conf({'standby_mode': 'on', 'primary_conninfo': {'password': 'f[0m
[30;1m322 | [0m[35m        self.p.config.write_postgresql_conf()[0m
[30;1m323 | [0m[35m        self.assertEqual(self.p.config.check_recovery_conf(None), (False, False))[0m
[30;1m324 | [0m[35m        self.assertEqual(self.p.config.check_recovery_conf(None), (False, False))[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m294 | [0m[35m        self.assertEqual(self.p.config.check_recovery_conf(None), (True, False))[0m
[30;1m295 | [0m[35m        mock_get_pg_settings.return_value['recovery_min_apply_delay'][1] = '0'[0m
[30;1m296 | [0m[35m        self.assertEqual(self.p.config.check_recovery_conf(None), (False, False))[0m
[30;1m297 | [0m[35m        conninfo = {'host': '1', 'password': 'bar'}[0m
[30;1m298 | [0m[35m        with patch('patroni.postgresql.config.ConfigHandler.primary_conninfo_params', Mock(return_va[0m
[30;1m299 | [0m[35m            mock_get_pg_settings.return_value['recovery_min_apply_delay'][1] = '1'[0m
[30;1m300 | [0m[35m            self.assertEqual(self.p.config.check_recovery_conf(None), (True, True))[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m266 | [0m[35m        self.p.config.write_pgpass({'host': 'localhost', 'port': '5432', 'user': 'foo', 'password': [0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m    def test__pgpass_content(self):[0m
[30;1m269 | [0m[35m        pgpass = self.p.config._pgpass_content({'host': '/tmp', 'port': '5432', 'user': 'foo', 'pass[0m
[30;1m270 | [0m[35m        self.assertEqual(pgpass, "/tmp:5432:*:foo:bar\nlocalhost:5432:*:foo:bar\n")[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    def test_checkpoint(self):[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m263 | [0m[35m    @patch('builtins.open', MagicMock())[0m
[30;1m264 | [0m[35m    def test_write_pgpass(self):[0m
[30;1m265 | [0m[35m        self.p.config.write_pgpass({'host': 'localhost', 'port': '5432', 'user': 'foo'})[0m
[30;1m266 | [0m[35m        self.p.config.write_pgpass({'host': 'localhost', 'port': '5432', 'user': 'foo', 'password': [0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m    def test__pgpass_content(self):[0m
[30;1m269 | [0m[35m        pgpass = self.p.config._pgpass_content({'host': '/tmp', 'port': '5432', 'user': 'foo', 'pass[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m849 | [0m[35m    if username:[0m
[30;1m850 | [0m[35m        connect_parameters['username'] = username[0m
[30;1m851 | [0m[35m    if password:[0m
[30;1m852 | [0m[35m        connect_parameters['password'] = click.prompt('Password', hide_input=True, type=str)[0m
[30;1m853 | [0m[35m    if dbname:[0m
[30;1m854 | [0m[35m        connect_parameters['dbname'] = dbname[0m
[30;1m855 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m849 | [0m[35m    if username:[0m
[30;1m850 | [0m[35m        connect_parameters['username'] = username[0m
[30;1m851 | [0m[35m    if password:[0m
[30;1m852 | [0m[35m        connect_parameters['password'] = click.prompt('Password', hide_input=True, type=str)[0m
[30;1m853 | [0m[35m    if dbname:[0m
[30;1m854 | [0m[35m        connect_parameters['dbname'] = dbname[0m
[30;1m855 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m848 | [0m[35m    connect_parameters: Dict[str, str] = {}[0m
[30;1m849 | [0m[35m    if username:[0m
[30;1m850 | [0m[35m        connect_parameters['username'] = username[0m
[30;1m851 | [0m[35m    if password:[0m
[30;1m852 | [0m[35m        connect_parameters['password'] = click.prompt('Password', hide_input=True, type=str)[0m
[30;1m853 | [0m[35m    if dbname:[0m
[30;1m854 | [0m[35m        connect_parameters['dbname'] = dbname[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m825 | [0m[35m    :param delimiter: column delimiter when *fmt* is ``tsv``.[0m
[30;1m826 | [0m[35m    :param command: SQL query to execute.[0m
[30;1m827 | [0m[35m    :param p_file: path to file containing SQL query to execute.[0m
[30;1m828 | [0m[35m    :param password: if ``True`` then prompt for password.[0m
[30;1m829 | [0m[35m    :param username: name of the database user.[0m
[30;1m830 | [0m[35m    :param dbname: name of the database.[0m
[30;1m831 | [0m[35m    :param fmt: the output table printing format. See :func:`print_output` for available options.[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m825 | [0m[35m    :param delimiter: column delimiter when *fmt* is ``tsv``.[0m
[30;1m826 | [0m[35m    :param command: SQL query to execute.[0m
[30;1m827 | [0m[35m    :param p_file: path to file containing SQL query to execute.[0m
[30;1m828 | [0m[35m    :param password: if ``True`` then prompt for password.[0m
[30;1m829 | [0m[35m    :param username: name of the database user.[0m
[30;1m830 | [0m[35m    :param dbname: name of the database.[0m
[30;1m831 | [0m[35m    :param fmt: the output table printing format. See :func:`print_output` for available options.[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m805 | [0m[35m    delimiter: str,[0m
[30;1m806 | [0m[35m    command: Optional[str],[0m
[30;1m807 | [0m[35m    p_file: Optional[io.BufferedReader],[0m
[30;1m808 | [0m[35m    password: Optional[bool],[0m
[30;1m809 | [0m[35m    username: Optional[str],[0m
[30;1m810 | [0m[35m    dbname: Optional[str],[0m
[30;1m811 | [0m[35m    fmt: str = 'tsv'[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m786 | [0m[35m@option_citus_group[0m
[30;1m787 | [0m[35m@click.option('--format', 'fmt', help='Output format (pretty, tsv, json, yaml)', default='tsv')[0m
[30;1m788 | [0m[35m@click.option('--file', '-f', 'p_file', help='Execute the SQL commands from this file', type=click.F[0m
[30;1m789 | [0m[35m@click.option('--password', help='force password prompt', is_flag=True)[0m
[30;1m790 | [0m[35m@click.option('-U', '--username', help='database user name', type=str)[0m
[30;1m791 | [0m[35m@option_watch[0m
[30;1m792 | [0m[35m@option_watchrefresh[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m786 | [0m[35m@option_citus_group[0m
[30;1m787 | [0m[35m@click.option('--format', 'fmt', help='Output format (pretty, tsv, json, yaml)', default='tsv')[0m
[30;1m788 | [0m[35m@click.option('--file', '-f', 'p_file', help='Execute the SQL commands from this file', type=click.F[0m
[30;1m789 | [0m[35m@click.option('--password', help='force password prompt', is_flag=True)[0m
[30;1m790 | [0m[35m@click.option('-U', '--username', help='database user name', type=str)[0m
[30;1m791 | [0m[35m@option_watch[0m
[30;1m792 | [0m[35m@option_watchrefresh[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m2055 | [0m[35m            * No suitable editor can be found; or[0m
[30;1m2056 | [0m[35m            * Editor call exits with unexpected return code.[0m
[30;1m2057 | [0m[35m    """[0m
[30;1m2058 | [0m[35m    editor_cmd = os.environ.get('EDITOR')[0m
[30;1m2059 | [0m[35m    if not editor_cmd:[0m
[30;1m2060 | [0m[35m        for editor in ('editor', 'vi'):[0m
[30;1m2061 | [0m[35m            editor_cmd = shutil.which(editor)[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1920 | [0m[35m            pager = next([0m
[30;1m1921 | [0m[35m                ([0m
[30;1m1922 | [0m[35m                    os.path.basename(p)[0m
[30;1m1923 | [0m[35m                    for p in (os.environ.get('PAGER'), "less", "more")[0m
[30;1m1924 | [0m[35m                    if p is not None and bool(shutil.which(p))[0m
[30;1m1925 | [0m[35m                ),[0m
[30;1m1926 | [0m[35m                None,[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m322 | [0m[35m    """[0m
[30;1m323 | [0m[35m    level = 'WARNING'[0m
[30;1m324 | [0m[35m    for name in ('LOGLEVEL', 'PATRONI_LOGLEVEL', 'PATRONI_LOG_LEVEL'):[0m
[30;1m325 | [0m[35m        level = os.environ.get(name, level)[0m
[30;1m326 | [0m[35m    logging.basicConfig(format='%(asctime)s - %(levelname)s - %(message)s', level=level)[0m
[30;1m327 | [0m[35m    logging.captureWarnings(True)  # Capture eventual SSL warning[0m
[30;1m328 | [0m[35m    config = load_config(config_file, dcs_url)[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m160 | [0m[35m        These two keys in data are always written to the DCS, but care is taken to maintain consiste[0m
[30;1m161 | [0m[35m        from data that is read:[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        ``conn_url``: connection string containing host, user and password which could be used to ac[0m
[30;1m164 | [0m[35m        ``api_url``: REST API url of patroni instance[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    Consists of the following fields:[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m        in DCS along with PostgreSQL connection string. In order to not introduce new keys and be co[0m
[30;1m66 | [0m[35m        original Governor we decided to extend original connection string in a following way:[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m            postgres://{username}:{password}@{connect_address}/postgres?application_name={api_url}[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        This way original Governor could use such connection string as it is, because of feature of [0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m    .. note::[0m
[30;1m60 | [0m[35m        Original Governor stores connection strings for each cluster members in a following format:[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m            postgres://{username}:{password}@{connect_address}/postgres[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        Since each of our patroni instances provides their own REST API endpoint, it's good to store[0m
[30;1m65 | [0m[35m        in DCS along with PostgreSQL connection string. In order to not introduce new keys and be co[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m966 | [0m[35m            if any(host.startswith('/') for host in hosts) and 'localhost' not in hosts:[0m
[30;1m967 | [0m[35m                hosts.append('localhost')[0m
[30;1m968 | [0m[35m            record = {n: escape(record.get(n) or '*') for n in ('port', 'user', 'password')}[0m
[30;1m969 | [0m[35m            return ''.join('{host}:{port}:*:{user}:{password}\n'.format(**record, host=host) for hos[0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m    def write_pgpass(self, record: Dict[str, Any]) -> Dict[str, str]:[0m
[30;1m972 | [0m[35m        """Maybe creates :attr:`_passfile` based on connection parameters.[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m965 | [0m[35m                     (record.get('host', '') or '*').split(',')))]  # pyright: ignore [reportUnknown[0m
[30;1m966 | [0m[35m            if any(host.startswith('/') for host in hosts) and 'localhost' not in hosts:[0m
[30;1m967 | [0m[35m                hosts.append('localhost')[0m
[30;1m968 | [0m[35m            record = {n: escape(record.get(n) or '*') for n in ('port', 'user', 'password')}[0m
[30;1m969 | [0m[35m            return ''.join('{host}:{port}:*:{user}:{password}\n'.format(**record, host=host) for hos[0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m    def write_pgpass(self, record: Dict[str, Any]) -> Dict[str, str]:[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m956 | [0m[35m        :param record: :class:`dict` object with connection parameters.[0m
[30;1m957 | [0m[35m        :returns: a string with generated content of pgpassfile or ``None`` if there is no ``passwor[0m
[30;1m958 | [0m[35m        """[0m
[30;1m959 | [0m[35m        if 'password' in record:[0m
[30;1m960 | [0m[35m            def escape(value: Any) -> str:[0m
[30;1m961 | [0m[35m                return re.sub(r'([:\\])', r'\\\1', str(value))[0m
[30;1m962 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m954 | [0m[35m            In case if ``host`` is a comma separated string we generate one line per host.[0m
[30;1m955 | [0m[35m[0m
[30;1m956 | [0m[35m        :param record: :class:`dict` object with connection parameters.[0m
[30;1m957 | [0m[35m        :returns: a string with generated content of pgpassfile or ``None`` if there is no ``passwor[0m
[30;1m958 | [0m[35m        """[0m
[30;1m959 | [0m[35m        if 'password' in record:[0m
[30;1m960 | [0m[35m            def escape(value: Any) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m862 | [0m[35m        if 'passfile' in primary_conninfo and 'password' not in primary_conninfo \[0m
[30;1m863 | [0m[35m                and 'password' in wanted_primary_conninfo:[0m
[30;1m864 | [0m[35m            if self._check_passfile(primary_conninfo['passfile'], wanted_primary_conninfo):[0m
[30;1m865 | [0m[35m                primary_conninfo['password'] = wanted_primary_conninfo['password'][0m
[30;1m866 | [0m[35m            else:[0m
[30;1m867 | [0m[35m                return False[0m
[30;1m868 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m862 | [0m[35m        if 'passfile' in primary_conninfo and 'password' not in primary_conninfo \[0m
[30;1m863 | [0m[35m                and 'password' in wanted_primary_conninfo:[0m
[30;1m864 | [0m[35m            if self._check_passfile(primary_conninfo['passfile'], wanted_primary_conninfo):[0m
[30;1m865 | [0m[35m                primary_conninfo['password'] = wanted_primary_conninfo['password'][0m
[30;1m866 | [0m[35m            else:[0m
[30;1m867 | [0m[35m                return False[0m
[30;1m868 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m860 | [0m[35m                        primary_conninfo['password'] = wanted_primary_conninfo['password'][0m
[30;1m861 | [0m[35m[0m
[30;1m862 | [0m[35m        if 'passfile' in primary_conninfo and 'password' not in primary_conninfo \[0m
[30;1m863 | [0m[35m                and 'password' in wanted_primary_conninfo:[0m
[30;1m864 | [0m[35m            if self._check_passfile(primary_conninfo['passfile'], wanted_primary_conninfo):[0m
[30;1m865 | [0m[35m                primary_conninfo['password'] = wanted_primary_conninfo['password'][0m
[30;1m866 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m859 | [0m[35m                    if 'password' in wanted_primary_conninfo:[0m
[30;1m860 | [0m[35m                        primary_conninfo['password'] = wanted_primary_conninfo['password'][0m
[30;1m861 | [0m[35m[0m
[30;1m862 | [0m[35m        if 'passfile' in primary_conninfo and 'password' not in primary_conninfo \[0m
[30;1m863 | [0m[35m                and 'password' in wanted_primary_conninfo:[0m
[30;1m864 | [0m[35m            if self._check_passfile(primary_conninfo['passfile'], wanted_primary_conninfo):[0m
[30;1m865 | [0m[35m                primary_conninfo['password'] = wanted_primary_conninfo['password'][0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m857 | [0m[35m                    # There could be no password in the primary_conninfo or it is masked.[0m
[30;1m858 | [0m[35m                    # Just copy the "desired" value in order to make comparison succeed.[0m
[30;1m859 | [0m[35m                    if 'password' in wanted_primary_conninfo:[0m
[30;1m860 | [0m[35m                        primary_conninfo['password'] = wanted_primary_conninfo['password'][0m
[30;1m861 | [0m[35m[0m
[30;1m862 | [0m[35m        if 'passfile' in primary_conninfo and 'password' not in primary_conninfo \[0m
[30;1m863 | [0m[35m                and 'password' in wanted_primary_conninfo:[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m857 | [0m[35m                    # There could be no password in the primary_conninfo or it is masked.[0m
[30;1m858 | [0m[35m                    # Just copy the "desired" value in order to make comparison succeed.[0m
[30;1m859 | [0m[35m                    if 'password' in wanted_primary_conninfo:[0m
[30;1m860 | [0m[35m                        primary_conninfo['password'] = wanted_primary_conninfo['password'][0m
[30;1m861 | [0m[35m[0m
[30;1m862 | [0m[35m        if 'passfile' in primary_conninfo and 'password' not in primary_conninfo \[0m
[30;1m863 | [0m[35m                and 'password' in wanted_primary_conninfo:[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m856 | [0m[35m                    primary_conninfo = wal_receiver_primary_conninfo[0m
[30;1m857 | [0m[35m                    # There could be no password in the primary_conninfo or it is masked.[0m
[30;1m858 | [0m[35m                    # Just copy the "desired" value in order to make comparison succeed.[0m
[30;1m859 | [0m[35m                    if 'password' in wanted_primary_conninfo:[0m
[30;1m860 | [0m[35m                        primary_conninfo['password'] = wanted_primary_conninfo['password'][0m
[30;1m861 | [0m[35m[0m
[30;1m862 | [0m[35m        if 'passfile' in primary_conninfo and 'password' not in primary_conninfo \[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m854 | [0m[35m                    if dbname:[0m
[30;1m855 | [0m[35m                        wal_receiver_primary_conninfo['dbname'] = dbname[0m
[30;1m856 | [0m[35m                    primary_conninfo = wal_receiver_primary_conninfo[0m
[30;1m857 | [0m[35m                    # There could be no password in the primary_conninfo or it is masked.[0m
[30;1m858 | [0m[35m                    # Just copy the "desired" value in order to make comparison succeed.[0m
[30;1m859 | [0m[35m                    if 'password' in wanted_primary_conninfo:[0m
[30;1m860 | [0m[35m                        primary_conninfo['password'] = wanted_primary_conninfo['password'][0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m658 | [0m[35m            return re.sub(r'([\'\\ ])', r'\\\1', str(value))[0m
[30;1m659 | [0m[35m[0m
[30;1m660 | [0m[35m        key_ver = {'target_session_attrs': 100000, 'gssencmode': 120000, 'channel_binding': 130000,[0m
[30;1m661 | [0m[35m                   'sslpassword': 130000, 'sslcrldir': 140000, 'sslnegotiation': 170000}[0m
[30;1m662 | [0m[35m        return ' '.join('{0}={1}'.format(kw, escape(params[kw])) for kw in keywords[0m
[30;1m663 | [0m[35m                        if params.get(kw) is not None and self._postgresql.major_version >= key_ver.[0m
[30;1m664 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m650 | [0m[35m        """[0m
[30;1m651 | [0m[35m        # A list of keywords that can be found in a conninfo string. Follows what is acceptable by l[0m
[30;1m652 | [0m[35m        keywords = ('dbname', 'user', 'passfile' if params.get('passfile') else 'password', 'host', [0m
[30;1m653 | [0m[35m                    'sslmode', 'sslcompression', 'sslcert', 'sslkey', 'sslpassword', 'sslrootcert', [0m
[30;1m654 | [0m[35m                    'sslcrldir', 'application_name', 'krbsrvname', 'gssencmode', 'channel_binding',[0m
[30;1m655 | [0m[35m                    'target_session_attrs', 'sslnegotiation')[0m
[30;1m656 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m649 | [0m[35m        :returns: a connection string in a format "key1=value2 key2=value2"[0m
[30;1m650 | [0m[35m        """[0m
[30;1m651 | [0m[35m        # A list of keywords that can be found in a conninfo string. Follows what is acceptable by l[0m
[30;1m652 | [0m[35m        keywords = ('dbname', 'user', 'passfile' if params.get('passfile') else 'password', 'host', [0m
[30;1m653 | [0m[35m                    'sslmode', 'sslcompression', 'sslcert', 'sslkey', 'sslpassword', 'sslrootcert', [0m
[30;1m654 | [0m[35m                    'sslcrldir', 'application_name', 'krbsrvname', 'gssencmode', 'channel_binding',[0m
[30;1m655 | [0m[35m                    'target_session_attrs', 'sslnegotiation')[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m586 | [0m[35m        :returns: True if pg_hba.conf was rewritten.[0m
[30;1m587 | [0m[35m        """[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35m        # when we are doing custom bootstrap we assume that we don't know superuser password[0m
[30;1m590 | [0m[35m        # and in order to be able to change it, we are opening trust access from a certain address[0m
[30;1m591 | [0m[35m        if self._postgresql.bootstrap.running_custom_bootstrap:[0m
[30;1m592 | [0m[35m            addresses = {} if os.name == 'nt' else {'': 'local'}  # windows doesn't yet support unix[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m557 | [0m[35m            # when we are doing custom bootstrap we assume that we don't know superuser password[0m
[30;1m558 | [0m[35m            # and in order to be able to change it, we are opening trust access from a certain addre[0m
[30;1m559 | [0m[35m            # therefore we need to make sure that hba_file is not overridden[0m
[30;1m560 | [0m[35m            # after changing superuser password we will "revert" all these "changes"[0m
[30;1m561 | [0m[35m            if self._postgresql.bootstrap.running_custom_bootstrap or 'hba_file' not in self._server[0m
[30;1m562 | [0m[35m                f.write_param('hba_file', self._pg_hba_conf)[0m
[30;1m563 | [0m[35m            if 'ident_file' not in self._server_parameters:[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m554 | [0m[35m                if value is not None and\[0m
[30;1m555 | [0m[35m                        (name != 'hba_file' or not self._postgresql.bootstrap.running_custom_bootstr[0m
[30;1m556 | [0m[35m                    f.write_param(name, value)[0m
[30;1m557 | [0m[35m            # when we are doing custom bootstrap we assume that we don't know superuser password[0m
[30;1m558 | [0m[35m            # and in order to be able to change it, we are opening trust access from a certain addre[0m
[30;1m559 | [0m[35m            # therefore we need to make sure that hba_file is not overridden[0m
[30;1m560 | [0m[35m            # after changing superuser password we will "revert" all these "changes"[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m    if r.username:[0m
[30;1m48 | [0m[35m        ret['user'] = r.username[0m
[30;1m49 | [0m[35m    if r.password:[0m
[30;1m50 | [0m[35m        ret['password'] = r.password[0m
[30;1m51 | [0m[35m    if r.path[1:]:[0m
[30;1m52 | [0m[35m        ret['dbname'] = r.path[1:][0m
[30;1m53 | [0m[35m    hosts: List[str] = [][0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m    if r.username:[0m
[30;1m48 | [0m[35m        ret['user'] = r.username[0m
[30;1m49 | [0m[35m    if r.password:[0m
[30;1m50 | [0m[35m        ret['password'] = r.password[0m
[30;1m51 | [0m[35m    if r.path[1:]:[0m
[30;1m52 | [0m[35m        ret['dbname'] = r.path[1:][0m
[30;1m53 | [0m[35m    hosts: List[str] = [][0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m    r = urlparse(dsn)[0m
[30;1m47 | [0m[35m    if r.username:[0m
[30;1m48 | [0m[35m        ret['user'] = r.username[0m
[30;1m49 | [0m[35m    if r.password:[0m
[30;1m50 | [0m[35m        ret['password'] = r.password[0m
[30;1m51 | [0m[35m    if r.path[1:]:[0m
[30;1m52 | [0m[35m        ret['dbname'] = r.path[1:][0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m    True[0m
[30;1m40 | [0m[35m    >>> r = _conninfo_uri_parse('postgresql://u%2Fse:pass@[::1]/db%2Fsdf?application_name=mya%2Fpp&s[0m
[30;1m41 | [0m[35m    >>> r == {'application_name': 'mya/pp', 'dbname': 'db/sdf', 'host': '::1', 'sslmode': 'require',[0m
[30;1m42 | [0m[35m              'password': 'pass', 'user': 'u/se'}[0m
[30;1m43 | [0m[35m    True[0m
[30;1m44 | [0m[35m    """[0m
[30;1m45 | [0m[35m    ret: Dict[str, str] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35m    """[0m
[30;1m36 | [0m[35m    >>> r = _conninfo_uri_parse('postgresql://u%2Fse:pass@:%2f123/db%2Fsdf?application_name=mya%2Fpp[0m
[30;1m37 | [0m[35m    >>> r == {'application_name': 'mya/pp', 'dbname': 'db/sdf', 'sslmode': 'require',\[0m
[30;1m38 | [0m[35m              'password': 'pass', 'port': '/123', 'user': 'u/se'}[0m
[30;1m39 | [0m[35m    True[0m
[30;1m40 | [0m[35m    >>> r = _conninfo_uri_parse('postgresql://u%2Fse:pass@[::1]/db%2Fsdf?application_name=mya%2Fpp&s[0m
[30;1m41 | [0m[35m    >>> r == {'application_name': 'mya/pp', 'dbname': 'db/sdf', 'host': '::1', 'sslmode': 'require',[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m973 | [0m[35m[0m
[30;1m974 | [0m[35m        :param record: :class:`dict` object with connection parameters.[0m
[30;1m975 | [0m[35m[0m
[30;1m976 | [0m[35m        :returns: a copy of environment variables, that will include ``PGPASSFILE`` in case if the f[0m
[30;1m977 | [0m[35m        """[0m
[30;1m978 | [0m[35m        content = self._pgpass_content(record)[0m
[30;1m979 | [0m[35m        if not content:[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m553 | [0m[35m        if 'url' in config and isinstance(config['url'], str):[0m
[30;1m554 | [0m[35m            r = urlparse(config['url'])[0m
[30;1m555 | [0m[35m            config.update({'protocol': r.scheme, 'host': r.hostname, 'port': r.port or 2379,[0m
[30;1m556 | [0m[35m                           'username': r.username, 'password': r.password})[0m
[30;1m557 | [0m[35m        elif 'hosts' in config:[0m
[30;1m558 | [0m[35m            hosts = config.pop('hosts')[0m
[30;1m559 | [0m[35m            default_port = config.pop('port', 2379)[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m553 | [0m[35m        if 'url' in config and isinstance(config['url'], str):[0m
[30;1m554 | [0m[35m            r = urlparse(config['url'])[0m
[30;1m555 | [0m[35m            config.update({'protocol': r.scheme, 'host': r.hostname, 'port': r.port or 2379,[0m
[30;1m556 | [0m[35m                           'username': r.username, 'password': r.password})[0m
[30;1m557 | [0m[35m        elif 'hosts' in config:[0m
[30;1m558 | [0m[35m            hosts = config.pop('hosts')[0m
[30;1m559 | [0m[35m            default_port = config.pop('port', 2379)[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m151 | [0m[35m        self.password = config.get('password')[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def _get_headers(self) -> Dict[str, str]:[0m
[30;1m154 | [0m[35m        basic_auth = ':'.join((self.username, self.password)) if self.username and self.password els[0m
[30;1m155 | [0m[35m        return urllib3.make_headers(basic_auth=basic_auth, user_agent=USER_AGENT)[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    def _prepare_common_parameters(self, etcd_nodes: int, timeout: Optional[float] = None) -> Dict[s[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m151 | [0m[35m        self.password = config.get('password')[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def _get_headers(self) -> Dict[str, str]:[0m
[30;1m154 | [0m[35m        basic_auth = ':'.join((self.username, self.password)) if self.username and self.password els[0m
[30;1m155 | [0m[35m        return urllib3.make_headers(basic_auth=basic_auth, user_agent=USER_AGENT)[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    def _prepare_common_parameters(self, etcd_nodes: int, timeout: Optional[float] = None) -> Dict[s[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m
[30;1m150 | [0m[35m        self.username = config.get('username')[0m
[30;1m151 | [0m[35m        self.password = config.get('password')[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def _get_headers(self) -> Dict[str, str]:[0m
[30;1m154 | [0m[35m        basic_auth = ':'.join((self.username, self.password)) if self.username and self.password els[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m
[30;1m150 | [0m[35m        self.username = config.get('username')[0m
[30;1m151 | [0m[35m        self.password = config.get('password')[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def _get_headers(self) -> Dict[str, str]:[0m
[30;1m154 | [0m[35m        basic_auth = ':'.join((self.username, self.password)) if self.username and self.password els[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m        self.set_machines_cache_ttl(cache_ttl)[0m
[30;1m107 | [0m[35m        self._machines_cache_updated = 0[0m
[30;1m108 | [0m[35m        kwargs = {p: config.get(p) for p in ('host', 'port', 'protocol', 'use_proxies', 'version_pre[0m
[30;1m109 | [0m[35m                                             'username', 'password', 'cert', 'ca_cert') if config.ge[0m
[30;1m110 | [0m[35m        super(AbstractEtcdClientWithFailover, self).__init__(read_timeout=config['retry_timeout'], *[0m
[30;1m111 | [0m[35m        # For some reason python3-etcd on debian and ubuntu are not based on the latest version[0m
[30;1m112 | [0m[35m        # Workaround for the case when https://github.com/jplana/python-etcd/pull/196 is not applied[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.get\(.*(fromhex|decode)[0m
[30;1m686 | [0m[35m            if not retry.ensure_deadline(0.5):[0m
[30;1m687 | [0m[35m                return False[0m
[30;1m688 | [0m[35m            _, ret = self.retry(self._client.kv.get, self.sync_path, consistency='consistent')[0m
[30;1m689 | [0m[35m            if ret and (ret.get('Value') or b'').decode('utf-8') == value:[0m
[30;1m690 | [0m[35m                return ret['ModifyIndex'][0m
[30;1m691 | [0m[35m        return False[0m
[30;1m692 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m236 | [0m[35m                # to start, because it thinks that postmaster.pid is already locked.[0m
[30;1m237 | [0m[35m                # Important!!! Unlink of postmaster.pid isn't an option, because it has a lot of nas[0m
[30;1m238 | [0m[35m                # Luckily there is a workaround to this problem, we can pass the pid from postmaster[0m
[30;1m239 | [0m[35m                # in the `PG_GRANDPARENT_PID` environment variable and postmaster will ignore it.[0m
[30;1m240 | [0m[35m                logger.info("Telling pg_ctl that it is safe to ignore postmaster.pid for process %s"[0m
[30;1m241 | [0m[35m                env['PG_GRANDPARENT_PID'] = str(proc.pid)[0m
[30;1m242 | [0m[35m        except psutil.NoSuchProcess:[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m224 | [0m[35m        # of init process to take care about postmaster.[0m
[30;1m225 | [0m[35m        # In order to make everything portable we can't use fork&exec approach here, so  we will cal[0m
[30;1m226 | [0m[35m        # ourselves and pass list of arguments which must be used to start postgres.[0m
[30;1m227 | [0m[35m        # On Windows, in order to run a side-by-side assembly the specified env must include a valid[0m
[30;1m228 | [0m[35m        env = {p: os.environ[p] for p in os.environ if not p.startswith([0m
[30;1m229 | [0m[35m            PATRONI_ENV_PREFIX) and not p.startswith(KUBERNETES_ENV_PREFIX)}[0m
[30;1m230 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m429 | [0m[35m            getpass('Please enter the user password:')[0m
[30;1m430 | [0m[35m        self.config['postgresql']['authentication'] = {[0m
[30;1m431 | [0m[35m            'superuser': su_params,[0m
[30;1m432 | [0m[35m            'replication': {'username': NO_VALUE_MSG, 'password': NO_VALUE_MSG}[0m
[30;1m433 | [0m[35m        }[0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35m    def _set_conf_files(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m
[30;1m428 | [0m[35m        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \[0m
[30;1m429 | [0m[35m            getpass('Please enter the user password:')[0m
[30;1m430 | [0m[35m        self.config['postgresql']['authentication'] = {[0m
[30;1m431 | [0m[35m            'superuser': su_params,[0m
[30;1m432 | [0m[35m            'replication': {'username': NO_VALUE_MSG, 'password': NO_VALUE_MSG}[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m
[30;1m428 | [0m[35m        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \[0m
[30;1m429 | [0m[35m            getpass('Please enter the user password:')[0m
[30;1m430 | [0m[35m        self.config['postgresql']['authentication'] = {[0m
[30;1m431 | [0m[35m            'superuser': su_params,[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m
[30;1m428 | [0m[35m        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \[0m
[30;1m429 | [0m[35m            getpass('Please enter the user password:')[0m
[30;1m430 | [0m[35m        self.config['postgresql']['authentication'] = {[0m
[30;1m431 | [0m[35m            'superuser': su_params,[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m
[30;1m428 | [0m[35m        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m359 | [0m[35m        """[0m
[30;1m360 | [0m[35m        try:[0m
[30;1m361 | [0m[35m            conn = psycopg.connect(dsn=self.dsn,[0m
[30;1m362 | [0m[35m                                   password=self.config['postgresql']['authentication']['superuser'][0m
[30;1m363 | [0m[35m            with conn.cursor() as cur:[0m
[30;1m364 | [0m[35m                yield cur[0m
[30;1m365 | [0m[35m            conn.close()[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m359 | [0m[35m        """[0m
[30;1m360 | [0m[35m        try:[0m
[30;1m361 | [0m[35m            conn = psycopg.connect(dsn=self.dsn,[0m
[30;1m362 | [0m[35m                                   password=self.config['postgresql']['authentication']['superuser'][0m
[30;1m363 | [0m[35m            with conn.cursor() as cur:[0m
[30;1m364 | [0m[35m                yield cur[0m
[30;1m365 | [0m[35m            conn.close()[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m276 | [0m[35m            parse_bool(self.config['bootstrap']['dcs']['postgresql']['parameters']['wal_log_hints'])[0m
[30;1m277 | [0m[35m        if self.pg_major >= 110000:[0m
[30;1m278 | [0m[35m            self.config['postgresql']['authentication'].setdefault([0m
[30;1m279 | [0m[35m                'rewind', {'username': 'rewind_user'}).setdefault('password', NO_VALUE_MSG)[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35mclass RunningClusterConfigGenerator(AbstractConfigGenerator):[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m257 | [0m[35m        """Generate sample config using some sane defaults and update :attr:`~AbstractConfigGenerato[0m
[30;1m258 | [0m[35m        self.pg_major = self._get_int_major_version()[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        self.config['postgresql']['parameters'] = {'password_encryption': self.get_auth_method}[0m
[30;1m261 | [0m[35m        username = self.config["postgresql"]["authentication"]["replication"]["username"][0m
[30;1m262 | [0m[35m        self.config['postgresql']['pg_hba'] = [[0m
[30;1m263 | [0m[35m            f'host all all all {self.get_auth_method}',[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m                    },[0m
[30;1m123 | [0m[35m                    'replication': {[0m
[30;1m124 | [0m[35m                        'username': 'replicator',[0m
[30;1m125 | [0m[35m                        'password': NO_VALUE_MSG[0m
[30;1m126 | [0m[35m                    }[0m
[30;1m127 | [0m[35m                }[0m
[30;1m128 | [0m[35m            },[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35m                'authentication': {[0m
[30;1m119 | [0m[35m                    'superuser': {[0m
[30;1m120 | [0m[35m                        'username': 'postgres',[0m
[30;1m121 | [0m[35m                        'password': NO_VALUE_MSG[0m
[30;1m122 | [0m[35m                    },[0m
[30;1m123 | [0m[35m                    'replication': {[0m
[30;1m124 | [0m[35m                        'username': 'replicator',[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m    'sslmode': 'PGSSLMODE',[0m
[30;1m35 | [0m[35m    'sslcert': 'PGSSLCERT',[0m
[30;1m36 | [0m[35m    'sslkey': 'PGSSLKEY',[0m
[30;1m37 | [0m[35m    'sslpassword': '',[0m
[30;1m38 | [0m[35m    'sslrootcert': 'PGSSLROOTCERT',[0m
[30;1m39 | [0m[35m    'sslcrl': 'PGSSLCRL',[0m
[30;1m40 | [0m[35m    'sslcrldir': 'PGSSLCRLDIR',[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m# (we use "username" in the Patroni config for some reason, other parameter names are the same).[0m
[30;1m31 | [0m[35m_AUTH_ALLOWED_PARAMETERS_MAPPING = {[0m
[30;1m32 | [0m[35m    'user': 'PGUSER',[0m
[30;1m33 | [0m[35m    'password': 'PGPASSWORD',[0m
[30;1m34 | [0m[35m    'sslmode': 'PGSSLMODE',[0m
[30;1m35 | [0m[35m    'sslcert': 'PGSSLCERT',[0m
[30;1m36 | [0m[35m    'sslkey': 'PGSSLKEY',[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m# (we use "username" in the Patroni config for some reason, other parameter names are the same).[0m
[30;1m31 | [0m[35m_AUTH_ALLOWED_PARAMETERS_MAPPING = {[0m
[30;1m32 | [0m[35m    'user': 'PGUSER',[0m
[30;1m33 | [0m[35m    'password': 'PGPASSWORD',[0m
[30;1m34 | [0m[35m    'sslmode': 'PGSSLMODE',[0m
[30;1m35 | [0m[35m    'sslcert': 'PGSSLCERT',[0m
[30;1m36 | [0m[35m    'sslkey': 'PGSSLKEY',[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m
[30;1m428 | [0m[35m        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \[0m
[30;1m429 | [0m[35m            getpass('Please enter the user password:')[0m
[30;1m430 | [0m[35m        self.config['postgresql']['authentication'] = {[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m421 | [0m[35m                su_params[conn_param] = val[0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m419 | [0m[35m            val = self.parsed_dsn.get(conn_param, os.getenv(env_var))[0m
[30;1m420 | [0m[35m            if val:[0m
[30;1m421 | [0m[35m                su_params[conn_param] = val[0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m428 | [0m[35m        # prepare pg_rewind connection string[0m
[30;1m429 | [0m[35m        env = self._postgresql.config.write_pgpass(conn_kwargs)[0m
[30;1m430 | [0m[35m        env.update(LANG='C', LC_ALL='C', PGOPTIONS='-c statement_timeout=0')[0m
[30;1m431 | [0m[35m        dsn = self._postgresql.config.format_dsn({**conn_kwargs, 'password': None})[0m
[30;1m432 | [0m[35m        logger.info('running pg_rewind from %s', dsn)[0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m        restore_command = (self._postgresql.config.get('recovery_conf') or EMPTY_DICT).get('restore_[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m426 | [0m[35m        :returns: ``True`` if ``pg_rewind`` finished successfully, ``False`` otherwise.[0m
[30;1m427 | [0m[35m        """[0m
[30;1m428 | [0m[35m        # prepare pg_rewind connection string[0m
[30;1m429 | [0m[35m        env = self._postgresql.config.write_pgpass(conn_kwargs)[0m
[30;1m430 | [0m[35m        env.update(LANG='C', LC_ALL='C', PGOPTIONS='-c statement_timeout=0')[0m
[30;1m431 | [0m[35m        dsn = self._postgresql.config.format_dsn({**conn_kwargs, 'password': None})[0m
[30;1m432 | [0m[35m        logger.info('running pg_rewind from %s', dsn)[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m714 | [0m[35m        # restapi server expects to get restapi.auth = 'username:password' and similarly for `ctl`[0m
[30;1m715 | [0m[35m        for section in ('ctl', 'restapi'):[0m
[30;1m716 | [0m[35m            if section in config and 'authentication' in config[section]:[0m
[30;1m717 | [0m[35m                config[section]['auth'] = '{username}:{password}'.format(**config[section]['authenti[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m        # special treatment for old config[0m
[30;1m720 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m711 | [0m[35m            elif name not in config or name in ['watchdog']:[0m
[30;1m712 | [0m[35m                config[name] = deepcopy(value) if value else {}[0m
[30;1m713 | [0m[35m[0m
[30;1m714 | [0m[35m        # restapi server expects to get restapi.auth = 'username:password' and similarly for `ctl`[0m
[30;1m715 | [0m[35m        for section in ('ctl', 'restapi'):[0m
[30;1m716 | [0m[35m            if section in config and 'authentication' in config[section]:[0m
[30;1m717 | [0m[35m                config[section]['auth'] = '{username}:{password}'.format(**config[section]['authenti[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m660 | [0m[35mSTER_SERVICE', 'SERVICE_CHECK_INTERVAL', 'SERVICE_CHECK_TLS_SERVER_NAME',[0m
[30;1m661 | [0m[35m                              'SERVICE_TAGS', 'NAMESPACE', 'CONTEXT', 'USE_ENDPOINTS', 'SCOPE_LABEL'[0m
[30;1m662 | [0m[35m                              'POD_IP', 'PORTS', 'LABELS', 'BYPASS_API_SERVICE', 'RETRIABLE_HTTP_COD[0m
[30;1m663 | [0m[35m                              'USE_SSL', 'SET_ACLS', 'GROUP', 'DATABASE', 'LEADER_LABEL_VALUE', 'FOL[0m
[30;1m664 | [0m[35m                              'STANDBY_LEADER_LABEL_VALUE', 'TMP_ROLE_LABEL', 'AUTH_DATA') and name:[0m
[30;1m665 | [0m[35m                    value = os.environ.pop(param)[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m542 | [0m[35m                                           'config_dir', 'data_dir', 'pgpass', 'bin_dir'])[0m
[30;1m543 | [0m[35m        _set_section_values('log', ['type', 'level', 'traceback_level', 'format', 'dateformat', 'sta[0m
[30;1m544 | [0m[35m                                    'max_queue_size', 'dir', 'mode', 'file_size', 'file_num', 'logge[0m
[30;1m545 | [0m[35m        _set_section_values('raft', ['data_dir', 'self_addr', 'partner_addrs', 'password', 'bind_add[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m        for binary in ('pg_ctl', 'initdb', 'pg_controldata', 'pg_basebackup', 'postgres', 'pg_isread[0m
[30;1m548 | [0m[35m            value = _popenv('POSTGRESQL_BIN_' + binary)[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m537 | [0m[35m', 'verify_client', 'http_extra_headers',[0m
[30;1m538 | [0m[35m                                        'https_extra_headers', 'allowlist', 'allowlist_include_membe[0m
[30;1m539 | [0m[35m                                        'request_queue_size'])[0m
[30;1m540 | [0m[35m        _set_section_values('ctl', ['insecure', 'cacert', 'certfile', 'keyfile', 'keyfile_password'][0m
[30;1m541 | [0m[35m        _set_section_values('postgresql', ['listen', 'connect_address', 'proxy_address',[0m
[30;1m542 | [0m[35m                                           'config_dir', 'data_dir', 'pgpass', 'bin_dir'])[0m
[30;1m543 | [0m[35m        _set_section_values('log', ['type', 'level', 'traceback_level', 'format', 'dateformat', 'sta[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m533 | [0m[35m                if value:[0m
[30;1m534 | [0m[35m                    ret[section][param] = value[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m        _set_section_values('restapi', ['listen', 'connect_address', 'certfile', 'keyfile', 'keyfile[0m
[30;1m537 | [0m[35m                                        'cafile', 'ciphers', 'verify_client', 'http_extra_headers',[0m
[30;1m538 | [0m[35m                                        'https_extra_headers', 'allowlist', 'allowlist_include_membe[0m
[30;1m539 | [0m[35m                                        'request_queue_size'])[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m29 | [0m[35m    'sslmode',[0m
[30;1m30 | [0m[35m    'sslcert',[0m
[30;1m31 | [0m[35m    'sslkey',[0m
[30;1m32 | [0m[35m    'sslpassword',[0m
[30;1m33 | [0m[35m    'sslrootcert',[0m
[30;1m34 | [0m[35m    'sslcrl',[0m
[30;1m35 | [0m[35m    'sslcrldir',[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m_AUTH_ALLOWED_PARAMETERS = ([0m
[30;1m27 | [0m[35m    'username',[0m
[30;1m28 | [0m[35m    'password',[0m
[30;1m29 | [0m[35m    'sslmode',[0m
[30;1m30 | [0m[35m    'sslcert',[0m
[30;1m31 | [0m[35m    'sslkey',[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m545 | [0m[35m        _set_section_values('raft', ['data_dir', 'self_addr', 'partner_addrs', 'password', 'bind_add[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m        for binary in ('pg_ctl', 'initdb', 'pg_controldata', 'pg_basebackup', 'postgres', 'pg_isread[0m
[30;1m548 | [0m[35m            value = _popenv('POSTGRESQL_BIN_' + binary)[0m
[30;1m549 | [0m[35m            if value:[0m
[30;1m550 | [0m[35m                ret['postgresql'].setdefault('bin_name', {})[binary] = value[0m
[30;1m551 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m                *oldname* is prefixed with :data:`~patroni.PATRONI_ENV_PREFIX` when searching in the[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m                If both *name* and *oldname* are set in the environment, *name* takes precedence.[0m
[30;1m508 | [0m[35m[0m
[30;1m509 | [0m[35m            :param name: new name of a log related environment variable.[0m
[30;1m510 | [0m[35m            :param oldname: original name of a log related environment variable.[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m            .. note::[0m
[30;1m499 | [0m[35m                Patroni used to support different names for log related environment variables in the[0m
[30;1m500 | [0m[35m                environment variables were renamed, this function takes care of mapping and normaliz[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35m                *name* is prefixed with :data:`~patroni.PATRONI_ENV_PREFIX` and ``LOG`` when searchi[0m
[30;1m503 | [0m[35m                environment.[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m260 | [0m[35m                          {'hosts': 'foo:4001,bar', 'retry_timeout': 10}, EtcdClient)[0m
[30;1m261 | [0m[35m        with patch.object(EtcdClient, '_get_machines_list', Mock(return_value=[])):[0m
[30;1m262 | [0m[35m            self.assertRaises(SleepException, self.etcd.get_etcd_client,[0m
[30;1m263 | [0m[35m                              {'proxy': 'https://user:password@test:2379', 'retry_timeout': 10}, Etc[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def test_get_cluster(self):[0m
[30;1m266 | [0m[35m        cluster = self.etcd.get_cluster()[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_barman.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m443 | [0m[35m        )[0m
[30;1m444 | [0m[35m[0m
[30;1m445 | [0m[35m        mock_rb.assert_called_once_with(api, args.barman_server, args.backup_id,[0m
[30;1m446 | [0m[35m                                        args.ssh_command, args.data_directory,[0m
[30;1m447 | [0m[35m                                        args.loop_wait)[0m
[30;1m448 | [0m[35m[0m
[30;1m449 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_barman.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m429 | [0m[35m        )[0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m        mock_rb.assert_called_once_with(api, args.barman_server, args.backup_id,[0m
[30;1m432 | [0m[35m                                        args.ssh_command, args.data_directory,[0m
[30;1m433 | [0m[35m                                        args.loop_wait)[0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35m        # failed execution[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            self._apply_ssl_file_param(config, 'key')[0m
[30;1m127 | [0m[35m            password = self._get_ctl_value(config, 'keyfile_password')[0m
[30;1m128 | [0m[35m            self._apply_pool_param('key_password', password)[0m
[30;1m129 | [0m[35m        else:[0m
[30;1m130 | [0m[35m            if insecure:  # Disable server certificate validation if requested[0m
[30;1m131 | [0m[35m                self._pool.connection_pool_kw['cert_reqs'] = 'CERT_NONE'[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            self._apply_ssl_file_param(config, 'key')[0m
[30;1m127 | [0m[35m            password = self._get_ctl_value(config, 'keyfile_password')[0m
[30;1m128 | [0m[35m            self._apply_pool_param('key_password', password)[0m
[30;1m129 | [0m[35m        else:[0m
[30;1m130 | [0m[35m            if insecure:  # Disable server certificate validation if requested[0m
[30;1m131 | [0m[35m                self._pool.connection_pool_kw['cert_reqs'] = 'CERT_NONE'[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m                self._pool.connection_pool_kw['assert_hostname'] = False[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            self._apply_ssl_file_param(config, 'key')[0m
[30;1m127 | [0m[35m            password = self._get_ctl_value(config, 'keyfile_password')[0m
[30;1m128 | [0m[35m            self._apply_pool_param('key_password', password)[0m
[30;1m129 | [0m[35m        else:[0m
[30;1m130 | [0m[35m            if insecure:  # Disable server certificate validation if requested[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m                self._pool.connection_pool_kw['assert_hostname'] = False[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            self._apply_ssl_file_param(config, 'key')[0m
[30;1m127 | [0m[35m            password = self._get_ctl_value(config, 'keyfile_password')[0m
[30;1m128 | [0m[35m            self._apply_pool_param('key_password', password)[0m
[30;1m129 | [0m[35m        else:[0m
[30;1m130 | [0m[35m            if insecure:  # Disable server certificate validation if requested[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m111 | [0m[35m        :param config: Patroni YAML configuration.[0m
[30;1m112 | [0m[35m        """[0m
[30;1m113 | [0m[35m        # ``ctl -> auth`` is equivalent to ``ctl -> authentication -> username`` + ``:`` +[0m
[30;1m114 | [0m[35m        # ``ctl -> authentication -> password``. And the same for ``restapi -> auth``[0m
[30;1m115 | [0m[35m        basic_auth = self._get_ctl_value(config, 'auth') or self._get_restapi_value(config, 'auth')[0m
[30;1m116 | [0m[35m        self._pool.headers = urllib3.make_headers(basic_auth=basic_auth, user_agent=USER_AGENT)[0m
[30;1m117 | [0m[35m        self._pool.connection_pool_kw['cert_reqs'] = 'CERT_REQUIRED'[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m        Also configure SSL related settings for requests:[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m            * ``ca_certs`` is configured if ``ctl.cacert`` or ``restapi.cafile`` is available;[0m
[30;1m109 | [0m[35m            * ``cert``, ``key`` and ``key_password`` are configured if ``ctl.certfile`` is available[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        :param config: Patroni YAML configuration.[0m
[30;1m112 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m128 | [0m[35m:[0m
[30;1m129 | [0m[35m            validate_directory(raft_data_dir)[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        file_template = (self_addr or '')[0m
[30;1m132 | [0m[35m        file_template = file_template.replace(':', '_') if os.name == 'nt' else file_template[0m
[30;1m133 | [0m[35m        file_template = os.path.join(raft_data_dir, file_template)[0m
[30;1m134 | [0m[35m        conf = SyncObjConf(password=config.get('password'), autoTick=False, appendEntriesUseBatch=Fa[0m
[30;1m135 | [0m[35m                           bindAddress=config.get('bind_addr'), dnsFailCacheTime=(config.get('loop_w[0m
[30;1m136 | [0m[35m                           dnsCacheTime=(config.get('ttl') or 30), commandsWaitLeader=config.get('co[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m128 | [0m[35mf raft_data_dir != '':[0m
[30;1m129 | [0m[35m            validate_directory(raft_data_dir)[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        file_template = (self_addr or '')[0m
[30;1m132 | [0m[35m        file_template = file_template.replace(':', '_') if os.name == 'nt' else file_template[0m
[30;1m133 | [0m[35m        file_template = os.path.join(raft_data_dir, file_template)[0m
[30;1m134 | [0m[35m        conf = SyncObjConf(password=config.get('password'), autoTick=False, appendEntriesUseBatch=Fa[0m
[30;1m135 | [0m[35m                           bindAddress=config.get('bind_addr'), dnsFailCacheTime=(config.get('loop_w[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def __init__(self, otherNodes: Collection[Union[str, TCPNode]], conf: SyncObjConf, retry_timeout[0m
[30;1m56 | [0m[35m        self._nodes = otherNodes[0m
[30;1m57 | [0m[35m        self._utility = TcpUtility(conf.password, retry_timeout / max(1, len(otherNodes)))[0m
[30;1m58 | [0m[35m        self.__node = next(iter(otherNodes), None)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    def executeCommand(self, command: List[Any]) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        # 2. User is not a superuser[0m
[30;1m285 | [0m[35m        with patch('sys.argv', ['patroni.py',[0m
[30;1m286 | [0m[35m                                '--generate-config', '--dsn', 'host=foo port=bar user=foobar passwor[0m
[30;1m287 | [0m[35m             patch.object(MockCursor, 'rowcount', PropertyMock(return_value=0), create=True), \[0m
[30;1m288 | [0m[35m             patch.object(MockConnect, 'get_parameter_status', Mock(return_value='off')), \[0m
[30;1m289 | [0m[35m             self.assertRaises(SystemExit) as e:[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m257 | [0m[35m                'authentication': {[0m
[30;1m258 | [0m[35m                    'superuser': {[0m
[30;1m259 | [0m[35m                        'username': self.environ['PGUSER'],[0m
[30;1m260 | [0m[35m                        'password': self.environ['PGPASSWORD'],[0m
[30;1m261 | [0m[35m                        'gssencmode': None,[0m
[30;1m262 | [0m[35m                        'sslmode': None[0m
[30;1m263 | [0m[35m                    },[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m257 | [0m[35m                'authentication': {[0m
[30;1m258 | [0m[35m                    'superuser': {[0m
[30;1m259 | [0m[35m                        'username': self.environ['PGUSER'],[0m
[30;1m260 | [0m[35m                        'password': self.environ['PGPASSWORD'],[0m
[30;1m261 | [0m[35m                        'gssencmode': None,[0m
[30;1m262 | [0m[35m                        'sslmode': None[0m
[30;1m263 | [0m[35m                    },[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m        with patch('builtins.open', Mock(side_effect=self._get_running_instance_open_res())), \[0m
[30;1m221 | [0m[35m             patch('sys.argv', ['patroni.py', '--generate-config',[0m
[30;1m222 | [0m[35m                                '--dsn', 'host=foo port=bar user=foobar password=qwerty']), \[0m
[30;1m223 | [0m[35m                self.assertRaises(SystemExit) as e:[0m
[30;1m224 | [0m[35m            _main()[0m
[30;1m225 | [0m[35m        self.assertEqual(e.exception.code, 0)[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m199 | [0m[35m                'authentication': {[0m
[30;1m200 | [0m[35m                    'rewind': {[0m
[30;1m201 | [0m[35m                        'username': self.environ['PATRONI_REWIND_USERNAME'],[0m
[30;1m202 | [0m[35m                        'password': NO_VALUE_MSG}[0m
[30;1m203 | [0m[35m                },[0m
[30;1m204 | [0m[35m            }[0m
[30;1m205 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m192 | [0m[35m            },[0m
[30;1m193 | [0m[35m            'postgresql': {[0m
[30;1m194 | [0m[35m                'parameters': {[0m
[30;1m195 | [0m[35m                    'password_encryption': 'scram-sha-256'[0m
[30;1m196 | [0m[35m                },[0m
[30;1m197 | [0m[35m                'pg_hba': ['host all all all scram-sha-256',[0m
[30;1m198 | [0m[35m                           f'host replication {self.environ["PATRONI_REPLICATION_USERNAME"]} all scr[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m133 | [0m[35m                    },[0m
[30;1m134 | [0m[35m                    'replication': {[0m
[30;1m135 | [0m[35m                        'username': NO_VALUE_MSG,[0m
[30;1m136 | [0m[35m                        'password': NO_VALUE_MSG[0m
[30;1m137 | [0m[35m                    },[0m
[30;1m138 | [0m[35m                    'rewind': None[0m
[30;1m139 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m                'authentication': {[0m
[30;1m126 | [0m[35m                    'superuser': {[0m
[30;1m127 | [0m[35m                        'username': 'foobar',[0m
[30;1m128 | [0m[35m                        'password': 'qwerty',[0m
[30;1m129 | [0m[35m                        'channel_binding': 'prefer',[0m
[30;1m130 | [0m[35m                        'gssencmode': 'prefer',[0m
[30;1m131 | [0m[35m                        'sslmode': 'prefer',[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m                    'archive_command': 'my archive command',[0m
[30;1m121 | [0m[35m                    'hba_file': os.path.join('data', 'pg_hba.conf'),[0m
[30;1m122 | [0m[35m                    'ident_file': os.path.join('data', 'pg_ident.conf'),[0m
[30;1m123 | [0m[35m                    'password_encryption': None[0m
[30;1m124 | [0m[35m                },[0m
[30;1m125 | [0m[35m                'authentication': {[0m
[30;1m126 | [0m[35m                    'superuser': {[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m88 | [0m[35m                                   'rewind': {'username': self.environ['PATRONI_REWIND_USERNAME']}},[0m
[30;1m89 | [0m[35m                'bin_dir': self.environ['PATRONI_POSTGRESQL_BIN_DIR'],[0m
[30;1m90 | [0m[35m                'bin_name': {'postgres': self.environ['PATRONI_POSTGRESQL_BIN_POSTGRES']},[0m
[30;1m91 | [0m[35m                'parameters': {'password_encryption': 'md5'}[0m
[30;1m92 | [0m[35m            }[0m
[30;1m93 | [0m[35m        }[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m                                     'password': self.environ['PATRONI_SUPERUSER_PASSWORD']},[0m
[30;1m86 | [0m[35m                                   'replication': {'username': self.environ['PATRONI_REPLICATION_USE[0m
[30;1m87 | [0m[35m                                                   'password': self.environ['PATRONI_REPLICATION_PAS[0m
[30;1m88 | [0m[35m                                   'rewind': {'username': self.environ['PATRONI_REWIND_USERNAME']}},[0m
[30;1m89 | [0m[35m                'bin_dir': self.environ['PATRONI_POSTGRESQL_BIN_DIR'],[0m
[30;1m90 | [0m[35m                'bin_name': {'postgres': self.environ['PATRONI_POSTGRESQL_BIN_POSTGRES']},[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35mn['PATRONI_SUPERUSER_USERNAME'],[0m
[30;1m85 | [0m[35m                                                 'password': self.environ['PATRONI_SUPERUSER_PASSWOR[0m
[30;1m86 | [0m[35m                                   'replication': {'username': self.environ['PATRONI_REPLICATION_USE[0m
[30;1m87 | [0m[35m                                                   'password': self.environ['PATRONI_REPLICATION_PAS[0m
[30;1m88 | [0m[35m                                   'rewind': {'username': self.environ['PATRONI_REWIND_USERNAME']}},[0m
[30;1m89 | [0m[35m                'bin_dir': self.environ['PATRONI_POSTGRESQL_BIN_DIR'],[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m                         f'host replication {self.environ["PATRONI_REPLICATION_USERNAME"]} all md5'][0m
[30;1m84 | [0m[35m                'authentication': {'superuser': {'username': self.environ['PATRONI_SUPERUSER_USERNAM[0m
[30;1m85 | [0m[35m                                                 'password': self.environ['PATRONI_SUPERUSER_PASSWOR[0m
[30;1m86 | [0m[35m                                   'replication': {'username': self.environ['PATRONI_REPLICATION_USE[0m
[30;1m87 | [0m[35m                                                   'password': self.environ['PATRONI_REPLICATION_PAS[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m82 | [0m[35m      'pg_hba': ['host all all all md5',[0m
[30;1m83 | [0m[35m                           f'host replication {self.environ["PATRONI_REPLICATION_USERNAME"]} all md5[0m
[30;1m84 | [0m[35m                'authentication': {'superuser': {'username': self.environ['PATRONI_SUPERUSER_USERNAM[0m
[30;1m85 | [0m[35m                                                 'password': self.environ['PATRONI_SUPERUSER_PASSWOR[0m
[30;1m86 | [0m[35m                                   'replication': {'username': self.environ['PATRONI_REPLICATION_USE[0m
[30;1m87 | [0m[35m                                                   'password': self.environ['PATRONI_REPLICATION_PAS[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m        os.environ['PATRONI_REPLICATION_PASSWORD'] = 'repl_pwd_from_env'[0m
[30;1m45 | [0m[35m        os.environ['PATRONI_REWIND_USERNAME'] = 'rewind_user_from_env'[0m
[30;1m46 | [0m[35m        os.environ['PGUSER'] = 'pguser_from_env'[0m
[30;1m47 | [0m[35m        os.environ['PGPASSWORD'] = 'pguser_pwd_from_env'[0m
[30;1m48 | [0m[35m        os.environ['PATRONI_RESTAPI_CONNECT_ADDRESS'] = 'localhost:8080'[0m
[30;1m49 | [0m[35m        os.environ['PATRONI_RESTAPI_LISTEN'] = 'localhost:8080'[0m
[30;1m50 | [0m[35m        os.environ['PATRONI_POSTGRESQL_BIN_POSTGRES'] = 'custom_postgres_bin_from_env'[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35m        os.environ['PATRONI_SUPERUSER_USERNAME'] = 'su_user_from_env'[0m
[30;1m42 | [0m[35m        os.environ['PATRONI_SUPERUSER_PASSWORD'] = 'su_pwd_from_env'[0m
[30;1m43 | [0m[35m        os.environ['PATRONI_REPLICATION_USERNAME'] = 'repl_user_from_env'[0m
[30;1m44 | [0m[35m        os.environ['PATRONI_REPLICATION_PASSWORD'] = 'repl_pwd_from_env'[0m
[30;1m45 | [0m[35m        os.environ['PATRONI_REWIND_USERNAME'] = 'rewind_user_from_env'[0m
[30;1m46 | [0m[35m        os.environ['PGUSER'] = 'pguser_from_env'[0m
[30;1m47 | [0m[35m        os.environ['PGPASSWORD'] = 'pguser_pwd_from_env'[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m        os.environ['PATRONI_SCOPE'] = 'scope_from_env'[0m
[30;1m40 | [0m[35m        os.environ['PATRONI_POSTGRESQL_BIN_DIR'] = '/bin/from/env'[0m
[30;1m41 | [0m[35m        os.environ['PATRONI_SUPERUSER_USERNAME'] = 'su_user_from_env'[0m
[30;1m42 | [0m[35m        os.environ['PATRONI_SUPERUSER_PASSWORD'] = 'su_pwd_from_env'[0m
[30;1m43 | [0m[35m        os.environ['PATRONI_REPLICATION_USERNAME'] = 'repl_user_from_env'[0m
[30;1m44 | [0m[35m        os.environ['PATRONI_REPLICATION_PASSWORD'] = 'repl_pwd_from_env'[0m
[30;1m45 | [0m[35m        os.environ['PATRONI_REWIND_USERNAME'] = 'rewind_user_from_env'[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m174 | [0m[35m        self.assertEqual(e.exception.code, 0)[0m
[30;1m175 | [0m[35m        mock_makedir.assert_called_once()[0m
[30;1m176 | [0m[35m        pg_bin_mock.assert_called_once_with([os.path.join(self.environ['PATRONI_POSTGRESQL_BIN_DIR'][0m
[30;1m177 | [0m[35m                                                          self.environ['PATRONI_POSTGRESQL_BIN_POSTG[0m
[30;1m178 | [0m[35m                                             '--version'])[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m    @patch('os.makedirs', Mock())[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m173 | [0m[35m            self.assertEqual(self.config, yaml.safe_load(mocked_file().write.call_args_list[0][0][0][0m
[30;1m174 | [0m[35m        self.assertEqual(e.exception.code, 0)[0m
[30;1m175 | [0m[35m        mock_makedir.assert_called_once()[0m
[30;1m176 | [0m[35m        pg_bin_mock.assert_called_once_with([os.path.join(self.environ['PATRONI_POSTGRESQL_BIN_DIR'][0m
[30;1m177 | [0m[35m                                                          self.environ['PATRONI_POSTGRESQL_BIN_POSTG[0m
[30;1m178 | [0m[35m                                             '--version'])[0m
[30;1m179 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m87 | [0m[35m                                                   'password': self.environ['PATRONI_REPLICATION_PAS[0m
[30;1m88 | [0m[35m                                   'rewind': {'username': self.environ['PATRONI_REWIND_USERNAME']}},[0m
[30;1m89 | [0m[35m                'bin_dir': self.environ['PATRONI_POSTGRESQL_BIN_DIR'],[0m
[30;1m90 | [0m[35m                'bin_name': {'postgres': self.environ['PATRONI_POSTGRESQL_BIN_POSTGRES']},[0m
[30;1m91 | [0m[35m                'parameters': {'password_encryption': 'md5'}[0m
[30;1m92 | [0m[35m            }[0m
[30;1m93 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m86 | [0m[35m                                   'replication': {'username': self.environ['PATRONI_REPLICATION_USE[0m
[30;1m87 | [0m[35m                                                   'password': self.environ['PATRONI_REPLICATION_PAS[0m
[30;1m88 | [0m[35m                                   'rewind': {'username': self.environ['PATRONI_REWIND_USERNAME']}},[0m
[30;1m89 | [0m[35m                'bin_dir': self.environ['PATRONI_POSTGRESQL_BIN_DIR'],[0m
[30;1m90 | [0m[35m                'bin_name': {'postgres': self.environ['PATRONI_POSTGRESQL_BIN_POSTGRES']},[0m
[30;1m91 | [0m[35m                'parameters': {'password_encryption': 'md5'}[0m
[30;1m92 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m47 | [0m[35m        os.environ['PGPASSWORD'] = 'pguser_pwd_from_env'[0m
[30;1m48 | [0m[35m        os.environ['PATRONI_RESTAPI_CONNECT_ADDRESS'] = 'localhost:8080'[0m
[30;1m49 | [0m[35m        os.environ['PATRONI_RESTAPI_LISTEN'] = 'localhost:8080'[0m
[30;1m50 | [0m[35m        os.environ['PATRONI_POSTGRESQL_BIN_POSTGRES'] = 'custom_postgres_bin_from_env'[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        self.environ = deepcopy(os.environ)[0m
[30;1m53 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    def setUp(self):[0m
[30;1m39 | [0m[35m        os.environ['PATRONI_SCOPE'] = 'scope_from_env'[0m
[30;1m40 | [0m[35m        os.environ['PATRONI_POSTGRESQL_BIN_DIR'] = '/bin/from/env'[0m
[30;1m41 | [0m[35m        os.environ['PATRONI_SUPERUSER_USERNAME'] = 'su_user_from_env'[0m
[30;1m42 | [0m[35m        os.environ['PATRONI_SUPERUSER_PASSWORD'] = 'su_pwd_from_env'[0m
[30;1m43 | [0m[35m        os.environ['PATRONI_REPLICATION_USERNAME'] = 'repl_user_from_env'[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m            hosts = ','.join(hosts)[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        mapping = {'use_ssl': 'use_ssl', 'verify': 'verify_certs', 'cacert': 'ca',[0m
[30;1m100 | [0m[35m                   'cert': 'certfile', 'key': 'keyfile', 'key_password': 'keyfile_password'}[0m
[30;1m101 | [0m[35m        kwargs = {v: config[k] for k, v in mapping.items() if k in config}[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        if 'set_acls' in config:[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m            hosts = ','.join(hosts)[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        mapping = {'use_ssl': 'use_ssl', 'verify': 'verify_certs', 'cacert': 'ca',[0m
[30;1m100 | [0m[35m                   'cert': 'certfile', 'key': 'keyfile', 'key_password': 'keyfile_password'}[0m
[30;1m101 | [0m[35m        kwargs = {v: config[k] for k, v in mapping.items() if k in config}[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        if 'set_acls' in config:[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m64 | [0m[35m        self.assertFalse(self.r.can_rewind)[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def test_pg_rewind(self):[0m
[30;1m67 | [0m[35m        r = {'user': '', 'host': '', 'port': '', 'database': '', 'password': ''}[0m
[30;1m68 | [0m[35m        with patch.object(Postgresql, 'major_version', PropertyMock(return_value=150000)), \[0m
[30;1m69 | [0m[35m                patch.object(CancellableSubprocess, 'call', Mock(return_value=None)):[0m
[30;1m70 | [0m[35m            with patch('subprocess.check_output', Mock(return_value=b'boo')):[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m149 | [0m[35mthe GUC across postgres versions. If a GUC validation has never changed over time, then it will[0m
[30;1m150 | [0m[35m#          have a single object in the tuple. For example, `password_encryption` used to be a boolea[0m
[30;1m151 | [0m[35m#          10, at which point it started being an enum. In that case the value of `password_encrypti[0m
[30;1m152 | [0m[35m#          of 2 `_Transformable` objects (`Bool` and `Enum`, respectively), each one reprensenting a[0m
[30;1m153 | [0m[35m#          validation rule.[0m
[30;1m154 | [0m[35mparameters = CaseInsensitiveDict()[0m
[30;1m155 | [0m[35mrecovery_parameters = CaseInsensitiveDict()[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35mclass ValidatorFactoryNoType(PatroniException):[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m147 | [0m[35mter name[0m
[30;1m148 | [0m[35m#  value - variable length tuple of `_Transformable` objects. Each object in the tuple represents a [0m
[30;1m149 | [0m[35m#          validation of the GUC across postgres versions. If a GUC validation has never changed ove[0m
[30;1m150 | [0m[35m#          have a single object in the tuple. For example, `password_encryption` used to be a boolea[0m
[30;1m151 | [0m[35m#          10, at which point it started being an enum. In that case the value of `password_encrypti[0m
[30;1m152 | [0m[35m#          of 2 `_Transformable` objects (`Bool` and `Enum`, respectively), each one reprensenting a[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m146 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer token')[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        config["users"][0]["user"]["client-key-data"] = base64.b64encode(b'foobar').decode('utf-8')[0m
[30;1m149 | [0m[35m        config["clusters"][0]["cluster"]["certificate-authority-data"] = base64.b64encode(b'foobar')[0m
[30;1m150 | [0m[35m        with patch('builtins.open', mock_open(read_data=json.dumps(config))), \[0m
[30;1m151 | [0m[35m                patch('os.write', Mock()), patch('os.close', Mock()), \[0m
[30;1m152 | [0m[35m                patch('os.remove') as mock_remove, \[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m145 | [0m[35m            k8s_config.load_kube_config()[0m
[30;1m146 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer token')[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        config["users"][0]["user"]["client-key-data"] = base64.b64encode(b'foobar').decode('utf-8')[0m
[30;1m149 | [0m[35m        config["clusters"][0]["cluster"]["certificate-authority-data"] = base64.b64encode(b'foobar')[0m
[30;1m150 | [0m[35m        with patch('builtins.open', mock_open(read_data=json.dumps(config))), \[0m
[30;1m151 | [0m[35m                patch('os.write', Mock()), patch('os.close', Mock()), \[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport datetime[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport socket[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m132 | [0m[35m            "current-context": "local",[0m
[30;1m133 | [0m[35m            "contexts": [{"name": "local", "context": {"user": "local", "cluster": "local"}}],[0m
[30;1m134 | [0m[35m            "clusters": [{"name": "local", "cluster": {"server": "https://a:1/", "certificate-author[0m
[30;1m135 | [0m[35m            "users": [{"name": "local", "user": {"username": "a", "password": "b", "client-certifica[0m
[30;1m136 | [0m[35m        }[0m
[30;1m137 | [0m[35m        with patch('builtins.open', mock_open(read_data=json.dumps(config))):[0m
[30;1m138 | [0m[35m            k8s_config.load_kube_config()[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1118 | [0m[35m            Optional("cacert"): str,[0m
[30;1m1119 | [0m[35m            Optional("cert"): str,[0m
[30;1m1120 | [0m[35m            Optional("key"): str,[0m
[30;1m1121 | [0m[35m            Optional("key_password"): str,[0m
[30;1m1122 | [0m[35m            Optional("verify"): bool,[0m
[30;1m1123 | [0m[35m            Optional("set_acls"): dict,[0m
[30;1m1124 | [0m[35m            Optional("auth_data"): dict,[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1110 | [0m[35m            Optional("bind_addr"): validate_host_port_listen,[0m
[30;1m1111 | [0m[35m            "partner_addrs": validate_host_port_list,[0m
[30;1m1112 | [0m[35m            Optional("data_dir"): str,[0m
[30;1m1113 | [0m[35m            Optional("password"): str[0m
[30;1m1114 | [0m[35m        },[0m
[30;1m1115 | [0m[35m        "zookeeper": {[0m
[30;1m1116 | [0m[35m            "hosts": Or(comma_separated_host_port, [validate_host_port]),[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1022 | [0m[35m        },[0m
[30;1m1023 | [0m[35m        Optional("certfile"): str,[0m
[30;1m1024 | [0m[35m        Optional("keyfile"): str,[0m
[30;1m1025 | [0m[35m        Optional("keyfile_password"): str,[0m
[30;1m1026 | [0m[35m        Optional("cafile"): str,[0m
[30;1m1027 | [0m[35m        Optional("ciphers"): str,[0m
[30;1m1028 | [0m[35m        Optional("verify_client"): EnumValidator(("none", "optional", "required"),[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1018 | [0m[35m        "connect_address": validate_connect_address,[0m
[30;1m1019 | [0m[35m        Optional("authentication"): {[0m
[30;1m1020 | [0m[35m            "username": str,[0m
[30;1m1021 | [0m[35m            "password": str[0m
[30;1m1022 | [0m[35m        },[0m
[30;1m1023 | [0m[35m        Optional("certfile"): str,[0m
[30;1m1024 | [0m[35m        Optional("keyfile"): str,[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1011 | [0m[35m        Optional("cacert"): str,[0m
[30;1m1012 | [0m[35m        Optional("certfile"): str,[0m
[30;1m1013 | [0m[35m        Optional("keyfile"): str,[0m
[30;1m1014 | [0m[35m        Optional("keyfile_password"): str[0m
[30;1m1015 | [0m[35m    },[0m
[30;1m1016 | [0m[35m    "restapi": {[0m
[30;1m1017 | [0m[35m        "listen": validate_host_port_listen,[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m982 | [0m[35m    }),[0m
[30;1m983 | [0m[35m    Optional("protocol"): str,[0m
[30;1m984 | [0m[35m    Optional("username"): str,[0m
[30;1m985 | [0m[35m    Optional("password"): str,[0m
[30;1m986 | [0m[35m    Optional("cacert"): str,[0m
[30;1m987 | [0m[35m    Optional("cert"): str,[0m
[30;1m988 | [0m[35m    Optional("key"): str[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m962 | [0m[35m    assert_(value in (False, "off", "automatic", "required"))[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m[0m
[30;1m965 | [0m[35muserattributes = {"username": "", Optional("password"): ""}[0m
[30;1m966 | [0m[35mavailable_dcs = [m.split(".")[-1] for m in dcs_modules()][0m
[30;1m967 | [0m[35msetattr(validate_host_port_list, 'expected_type', list)[0m
[30;1m968 | [0m[35msetattr(comma_separated_host_port, 'expected_type', str)[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m272 | [0m[35m        self.p.set_state('stopped')[0m
[30;1m273 | [0m[35m        self.p.reload_config({'authentication': {'superuser': {'username': 'p', 'password': 'p'},[0m
[30;1m274 | [0m[35m                                                 'replication': {'username': 'r', 'password': 'r'},[0m
[30;1m275 | [0m[35m                                                 'rewind': {'username': 'rw', 'password': 'rw'}},[0m
[30;1m276 | [0m[35m                              'listen': '*', 'retry_timeout': 10,[0m
[30;1m277 | [0m[35m                              'parameters': {'wal_level': '', 'hba_file': 'foo', 'max_prepared_trans[0m
[30;1m278 | [0m[35m        with patch.object(Postgresql, 'major_version', PropertyMock(return_value=110000)), \[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m271 | [0m[35m        self.b.bootstrap(config)[0m
[30;1m272 | [0m[35m        self.p.set_state('stopped')[0m
[30;1m273 | [0m[35m        self.p.reload_config({'authentication': {'superuser': {'username': 'p', 'password': 'p'},[0m
[30;1m274 | [0m[35m                                                 'replication': {'username': 'r', 'password': 'r'},[0m
[30;1m275 | [0m[35m                                                 'rewind': {'username': 'rw', 'password': 'rw'}},[0m
[30;1m276 | [0m[35m                              'listen': '*', 'retry_timeout': 10,[0m
[30;1m277 | [0m[35m                              'parameters': {'wal_level': '', 'hba_file': 'foo', 'max_prepared_trans[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/patroni-4.0.5/tests/test_bootstrap.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m        self.b.bootstrap(config)[0m
[30;1m272 | [0m[35m        self.p.set_state('stopped')[0m
[30;1m273 | [0m[35m        self.p.reload_config({'authentication': {'superuser': {'username': 'p', 'password': 'p'},[0m
[30;1m274 | [0m[35m                                                 'replication': {'username': 'r', 'password': 'r'},[0m
[30;1m275 | [0m[35m                                                 'rewind': {'username': 'rw', 'password': 'rw'}},[0m
[30;1m276 | [0m[35m                              'listen': '*', 'retry_timeout': 10,[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m498 | [0m[35m        cluster.members[1].data['pending_restart'] = True[0m
[30;1m499 | [0m[35m        cluster.members[1].data['pending_restart_reason'] = {'param': get_param_diff('', 'very l' + [0m
[30;1m500 | [0m[35m        with patch('patroni.dcs.AbstractDCS.get_cluster', Mock(return_value=cluster)):[0m
[30;1m501 | [0m[35m            for cmd in ('list', 'topology'):[0m
[30;1m502 | [0m[35m                result = self.runner.invoke(ctl, [cmd, 'dummy'])[0m
[30;1m503 | [0m[35m                self.assertIn('param: [hidden - too long]', result.output)[0m
[30;1m504 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m            mock_post.side_effect = Exception[0m
[30;1m613 | [0m[35m            result = self.runner.invoke(ctl, ['resume', 'dummy'])[0m
[30;1m614 | [0m[35m            assert 'Can not find accessible cluster member' in result.output[0m
[30;1m615 | [0m[35m[0m
[30;1m616 | [0m[35m    def test_apply_config_changes(self):[0m
[30;1m617 | [0m[35m        config = {"postgresql": {"parameters": {"work_mem": "4MB"}, "use_pg_rewind": True}, "ttl": 3[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m570 | [0m[35m            with patch('patroni.ctl.request_patroni', side_effect=[MockResponse(409), Exception]), \[0m
[30;1m571 | [0m[35m                    patch('patroni.dcs.AbstractDCS.manual_failover', Mock()):[0m
[30;1m572 | [0m[35m                result = self.runner.invoke(ctl, ['flush', 'dummy', 'switchover'])[0m
[30;1m573 | [0m[35m                assert 'Could not find any accessible member of cluster' in result.output[0m
[30;1m574 | [0m[35m[0m
[30;1m575 | [0m[35m    @patch('patroni.ctl.polling_loop', Mock(return_value=[1]))[0m
[30;1m576 | [0m[35m    def test_pause_cluster(self):[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m372 | [0m[35m        result = self.runner.invoke(ctl, ['restart', 'alpha', 'dummy', '--any'], input='now\ny')[0m
[30;1m373 | [0m[35m        assert result.exit_code == 1[0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35m        # Wrong pg version[0m
[30;1m376 | [0m[35m        result = self.runner.invoke(ctl, ['restart', 'alpha', '--any', '--pg-version', '9.1'], input[0m
[30;1m377 | [0m[35m        assert 'Error: Invalid PostgreSQL version format' in result.output[0m
[30;1m378 | [0m[35m        assert result.exit_code == 1[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m            # Failover to an async member in sync mode (confirm)[0m
[30;1m246 | [0m[35m            result = self.runner.invoke(ctl,[0m
[30;1m247 | [0m[35m                                        ['failover', 'dummy', '--group', '0', '--candidate', 'async'[0m
[30;1m248 | [0m[35m            self.assertIn('Are you sure you want to failover to the asynchronous node async', result[0m
[30;1m249 | [0m[35m            self.assertEqual(result.exit_code, 0)[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m            # Failover to an async member in sync mode (abort)[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m            scheduled_at = datetime.now(tzutc) + timedelta(seconds=600)[0m
[30;1m124 | [0m[35m            cluster = get_cluster_initialized_with_leader(Failover(1, 'foo', 'bar', scheduled_at))[0m
[30;1m125 | [0m[35m            del cluster.members[1].data['conn_url'][0m
[30;1m126 | [0m[35m            for fmt in ('pretty', 'json', 'yaml', 'topology'):[0m
[30;1m127 | [0m[35m                self.assertIsNone(output_members(cluster, name='abc', fmt=fmt))[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m            with patch('click.echo') as mock_echo:[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1242 | [0m[35m        self.p.name = 'leader'[0m
[30;1m1243 | [0m[35m        self.ha.cluster = get_cluster_initialized_with_leader()[0m
[30;1m1244 | [0m[35m        self.assertEqual(self.ha.run_cycle(),[0m
[30;1m1245 | [0m[35m                         'PAUSE: continue to run as primary after failing to update leader lock in D[0m
[30;1m1246 | [0m[35m[0m
[30;1m1247 | [0m[35m    def test_postgres_unhealthy_in_pause(self):[0m
[30;1m1248 | [0m[35m        self.ha.is_paused = true[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m825 | [0m[35m            scheduled = scheduled + datetime.timedelta(seconds=30)[0m
[30;1m826 | [0m[35m            self.ha.cluster = get_cluster_initialized_with_leader(Failover(0, self.p.name, 'blabla',[0m
[30;1m827 | [0m[35m            self.assertEqual('no action. I am (postgresql0), the leader with the lock', self.ha.run_[0m
[30;1m828 | [0m[35m            self.assertIn('Awaiting %s at %s (in %.0f seconds)', mock_info.call_args_list[0][0])[0m
[30;1m829 | [0m[35m[0m
[30;1m830 | [0m[35m        # stale value[0m
[30;1m831 | [0m[35m        with patch('patroni.ha.logger.warning') as mock_warning:[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m470 | [0m[35m        with patch.object(Ha, '_get_node_to_follow', Mock(side_effect=DCSError('foo'))):[0m
[30;1m471 | [0m[35m            self.assertEqual(self.ha.run_cycle(), 'demoted self because failed to update leader lock[0m
[30;1m472 | [0m[35m        self.p.is_primary = false[0m
[30;1m473 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'not promoting because failed to update leader lock in[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m    def test_get_node_to_follow_nostream(self):[0m
[30;1m476 | [0m[35m        self.ha.patroni.nostream = True[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m470 | [0m[35m        self.ha.update_lock = false[0m
[30;1m471 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'demoted self because failed to update leader lock in [0m
[30;1m472 | [0m[35m        with patch.object(Ha, '_get_node_to_follow', Mock(side_effect=DCSError('foo'))):[0m
[30;1m473 | [0m[35m            self.assertEqual(self.ha.run_cycle(), 'demoted self because failed to update leader lock[0m
[30;1m474 | [0m[35m        self.p.is_primary = false[0m
[30;1m475 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'not promoting because failed to update leader lock in[0m
[30;1m476 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m466 | [0m[35m    def test_demote_because_update_lock_failed(self):[0m
[30;1m467 | [0m[35m        self.ha.has_lock = true[0m
[30;1m468 | [0m[35m        self.ha.update_lock = false[0m
[30;1m469 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'demoted self because failed to update leader lock in [0m
[30;1m470 | [0m[35m        with patch.object(Ha, '_get_node_to_follow', Mock(side_effect=DCSError('foo'))):[0m
[30;1m471 | [0m[35m            self.assertEqual(self.ha.run_cycle(), 'demoted self because failed to update leader lock[0m
[30;1m472 | [0m[35m        self.p.is_primary = false[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1811 | [0m[35m                                                                         CaseInsensitiveSet(['foo'])[0m
[30;1m1812 | [0m[35m        mock_write_sync = self.ha.dcs.write_sync_state = Mock(return_value=SyncState(1, 'leader', 'f[0m
[30;1m1813 | [0m[35m        self.ha.cluster = get_cluster_initialized_with_leader(sync=('leader', 'foo'))[0m
[30;1m1814 | [0m[35m        # Test the sync node is removed from voters, added to ssn[0m
[30;1m1815 | [0m[35m        with patch.object(Postgresql, 'synchronous_standby_names', Mock(return_value='other')), \[0m
[30;1m1816 | [0m[35m                patch('time.sleep', Mock()):[0m
[30;1m1817 | [0m[35m            self.ha.run_cycle()[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1769 | [0m[35m        self.p.set_role('replica')[0m
[30;1m1770 | [0m[35m        self.p.name = 'nonsync'[0m
[30;1m1771 | [0m[35m        self.ha.fetch_node_status = get_node_status()[0m
[30;1m1772 | [0m[35m        # Postgres 15, with quorum commit. Non-sync node promoted we avoid updating /sync key and pu[0m
[30;1m1773 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'promoted self to leader by acquiring session lock')[0m
[30;1m1774 | [0m[35m        self.assertEqual(mock_write_sync.call_count, 0)[0m
[30;1m1775 | [0m[35m        self.assertEqual(mock_set_sync.call_count, 1)[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1360 | [0m[35m[0m
[30;1m1361 | [0m[35m        self.ha.is_synchronous_mode = true[0m
[30;1m1362 | [0m[35m[0m
[30;1m1363 | [0m[35m        # Test sync standby not touched when picking the same node[0m
[30;1m1364 | [0m[35m        self.p.sync_handler.current_state = Mock(return_value=_SyncState('priority', 1, 1,[0m
[30;1m1365 | [0m[35m                                                                         CaseInsensitiveSet(['other'[0m
[30;1m1366 | [0m[35m                                                                         CaseInsensitiveSet(['other'[0m
[30;1m1367 | [0m[35m        self.ha.cluster = get_cluster_initialized_with_leader(sync=('leader', 'other'))[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1071 | [0m[35mter.members))[0m
[30;1m1072 | [0m[35m        self.ha.fetch_node_status = get_node_status(failover_priority=2)  # accessible, in_recovery,[0m
[30;1m1073 | [0m[35m        self.assertFalse(self.ha._is_healthiest_node(self.ha.old_cluster.members))[0m
[30;1m1074 | [0m[35m        # if there is a higher-priority node but it has a lower WAL position then this node should r[0m
[30;1m1075 | [0m[35m        self.ha.fetch_node_status = get_node_status(failover_priority=6, wal_position=9)[0m
[30;1m1076 | [0m[35m        self.assertTrue(self.ha._is_healthiest_node(self.ha.old_cluster.members))[0m
[30;1m1077 | [0m[35m        self.ha.fetch_node_status = get_node_status(wal_position=11)  # accessible, in_recovery, wal[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1071 | [0m[35mse(self.ha._is_healthiest_node(self.ha.old_cluster.members))[0m
[30;1m1072 | [0m[35m        self.ha.fetch_node_status = get_node_status(failover_priority=2)  # accessible, in_recovery,[0m
[30;1m1073 | [0m[35m        self.assertFalse(self.ha._is_healthiest_node(self.ha.old_cluster.members))[0m
[30;1m1074 | [0m[35m        # if there is a higher-priority node but it has a lower WAL position then this node should r[0m
[30;1m1075 | [0m[35m        self.ha.fetch_node_status = get_node_status(failover_priority=6, wal_position=9)[0m
[30;1m1076 | [0m[35m        self.assertTrue(self.ha._is_healthiest_node(self.ha.old_cluster.members))[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1010 | [0m[35m                                                                 sync=('leader', 'blabla'))[0m
[30;1m1011 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'following a different leader because i am not the hea[0m
[30;1m1012 | [0m[35m[0m
[30;1m1013 | [0m[35m        # switchover from a specific leader, but the only sync node (us, postgresql0) has nofailover[0m
[30;1m1014 | [0m[35m        self.ha.cluster = get_cluster_initialized_without_leader(failover=Failover(0, 'leader', '', [0m
[30;1m1015 | [0m[35m                                                                 sync=('postgresql0'))[0m
[30;1m1016 | [0m[35m        self.ha.patroni.nofailover = True[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m999 | [0m[35mc node, which name doesn't match our name (postgresql0)[0m
[30;1m1000 | [0m[35m        self.ha.cluster = get_cluster_initialized_without_leader(failover=Failover(0, 'leader', 'oth[0m
[30;1m1001 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'following a different leader because i am not the hea[0m
[30;1m1002 | [0m[35m[0m
[30;1m1003 | [0m[35m        # to our node (postgresql0), which name is not in sync nodes list[0m
[30;1m1004 | [0m[35m        self.ha.cluster = get_cluster_initialized_without_leader(failover=Failover(0, 'leader', 'pos[0m
[30;1m1005 | [0m[35m                                                                 sync=('leader1', 'blabla'))[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m983 | [0m[35m            self.assertEqual(mock_warning.call_args_list[0][0],[0m
[30;1m984 | [0m[35m                             ('%s: member %s is %s', 'manual failover', 'other', 'not allowed to pro[0m
[30;1m985 | [0m[35m[0m
[30;1m986 | [0m[35m        # manual failover to our node (postgresql0),[0m
[30;1m987 | [0m[35m        # which name is not in sync nodes list (some sync nodes are available)[0m
[30;1m988 | [0m[35m        self.p.set_role('replica')[0m
[30;1m989 | [0m[35m        self.ha.cluster = get_cluster_initialized_without_leader(failover=Failover(0, '', 'postgresq[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m973 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'following a different leader because i am not the hea[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m        # manual failover when the candidate node isn't available but our name is in the /sync key[0m
[30;1m976 | [0m[35m        # while other sync node is nofailover[0m
[30;1m977 | [0m[35m        with patch('patroni.ha.logger.warning') as mock_warning:[0m
[30;1m978 | [0m[35m            self.ha.cluster = get_cluster_initialized_without_leader(failover=Failover(0, '', 'other[0m
[30;1m979 | [0m[35m                                                                     sync=('leader1', 'postgresql0')[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m972 | [0m[35m                                                                 sync=('leader1', 'blabla'))[0m
[30;1m973 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'following a different leader because i am not the hea[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m        # manual failover when the candidate node isn't available but our name is in the /sync key[0m
[30;1m976 | [0m[35m        # while other sync node is nofailover[0m
[30;1m977 | [0m[35m        with patch('patroni.ha.logger.warning') as mock_warning:[0m
[30;1m978 | [0m[35m            self.ha.cluster = get_cluster_initialized_without_leader(failover=Failover(0, '', 'other[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m967 | [0m[35m        self.p.is_primary = false[0m
[30;1m968 | [0m[35m        self.ha.fetch_node_status = get_node_status(nofailover=True)  # other nodes are not healthy[0m
[30;1m969 | [0m[35m[0m
[30;1m970 | [0m[35m        # manual failover when our name (postgresql0) isn't in the /sync key and the candidate node [0m
[30;1m971 | [0m[35m        self.ha.cluster = get_cluster_initialized_without_leader(failover=Failover(0, '', 'other', N[0m
[30;1m972 | [0m[35m                                                                 sync=('leader1', 'blabla'))[0m
[30;1m973 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'following a different leader because i am not the hea[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m807 | [0m[35m[0m
[30;1m808 | [0m[35m        self.ha.fetch_node_status = get_node_status()[0m
[30;1m809 | [0m[35m[0m
[30;1m810 | [0m[35m        # switchover scheduled time must include timezone[0m
[30;1m811 | [0m[35m        with patch('patroni.ha.logger.warning') as mock_warning:[0m
[30;1m812 | [0m[35m            scheduled = datetime.datetime.now()[0m
[30;1m813 | [0m[35m            self.ha.cluster = get_cluster_initialized_with_leader(Failover(0, self.p.name, 'blabla',[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m398 | [0m[35m        self.p._pre_promote = false[0m
[30;1m399 | [0m[35m        self.ha._is_healthiest_node = true[0m
[30;1m400 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'promoted self to leader by acquiring session lock')[0m
[30;1m401 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'Promotion cancelled because the pre-promote script fa[0m
[30;1m402 | [0m[35m        self.assertEqual(self.ha.run_cycle(), 'following a different leader because i am not the hea[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m    def test_lost_leader_lock_during_promote(self):[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1798 | [0m[35m        # through :func:`__initialize`.[0m
[30;1m1799 | [0m[35m        if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m1800 | [0m[35m            assert isinstance(self.__listen, str)[0m
[30;1m1801 | [0m[35m        self.connection_string = uri(self.__protocol, config.get('connect_address') or self.__listen[0m
[30;1m1802 | [0m[35m[0m
[30;1m1803 | [0m[35m    def handle_error(self, request: Union[socket.socket, Tuple[bytes, socket.socket]],[0m
[30;1m1804 | [0m[35m                     client_address: Tuple[str, int]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1787 | [0m[35m        self.http_extra_headers = config.get('http_extra_headers') or {}[0m
[30;1m1788 | [0m[35m        self.http_extra_headers.update((config.get('https_extra_headers') or {}) if ssl_options.get([0m
[30;1m1789 | [0m[35m[0m
[30;1m1790 | [0m[35m        if isinstance(config.get('verify_client'), str):[0m
[30;1m1791 | [0m[35m            ssl_options['verify_client'] = config['verify_client'].lower()[0m
[30;1m1792 | [0m[35m[0m
[30;1m1793 | [0m[35m        if self.__listen != config['listen'] or self.__ssl_options != ssl_options or self._received_[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1785 | [0m[35m                                              'cafile', 'ciphers') if n in config}[0m
[30;1m1786 | [0m[35m[0m
[30;1m1787 | [0m[35m        self.http_extra_headers = config.get('http_extra_headers') or {}[0m
[30;1m1788 | [0m[35m        self.http_extra_headers.update((config.get('https_extra_headers') or {}) if ssl_options.get([0m
[30;1m1789 | [0m[35m[0m
[30;1m1790 | [0m[35m        if isinstance(config.get('verify_client'), str):[0m
[30;1m1791 | [0m[35m            ssl_options['verify_client'] = config['verify_client'].lower()[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1785 | [0m[35m                                              'cafile', 'ciphers') if n in config}[0m
[30;1m1786 | [0m[35m[0m
[30;1m1787 | [0m[35m        self.http_extra_headers = config.get('http_extra_headers') or {}[0m
[30;1m1788 | [0m[35m        self.http_extra_headers.update((config.get('https_extra_headers') or {}) if ssl_options.get([0m
[30;1m1789 | [0m[35m[0m
[30;1m1790 | [0m[35m        if isinstance(config.get('verify_client'), str):[0m
[30;1m1791 | [0m[35m            ssl_options['verify_client'] = config['verify_client'].lower()[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1784 | [0m[35m        ssl_options = {n: config[n] for n in ('certfile', 'keyfile', 'keyfile_password',[0m
[30;1m1785 | [0m[35m                                              'cafile', 'ciphers') if n in config}[0m
[30;1m1786 | [0m[35m[0m
[30;1m1787 | [0m[35m        self.http_extra_headers = config.get('http_extra_headers') or {}[0m
[30;1m1788 | [0m[35m        self.http_extra_headers.update((config.get('https_extra_headers') or {}) if ssl_options.get([0m
[30;1m1789 | [0m[35m[0m
[30;1m1790 | [0m[35m        if isinstance(config.get('verify_client'), str):[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1779 | [0m[35m            raise ValueError('Can not find "restapi.listen" config')[0m
[30;1m1780 | [0m[35m[0m
[30;1m1781 | [0m[35m        self.__allowlist = tuple(self._build_allowlist(config.get('allowlist')))[0m
[30;1m1782 | [0m[35m        self.__allowlist_include_members = config.get('allowlist_include_members')[0m
[30;1m1783 | [0m[35m[0m
[30;1m1784 | [0m[35m        ssl_options = {n: config[n] for n in ('certfile', 'keyfile', 'keyfile_password',[0m
[30;1m1785 | [0m[35m                                              'cafile', 'ciphers') if n in config}[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1778 | [0m[35m        if 'listen' not in config:  # changing config in runtime[0m
[30;1m1779 | [0m[35m            raise ValueError('Can not find "restapi.listen" config')[0m
[30;1m1780 | [0m[35m[0m
[30;1m1781 | [0m[35m        self.__allowlist = tuple(self._build_allowlist(config.get('allowlist')))[0m
[30;1m1782 | [0m[35m        self.__allowlist_include_members = config.get('allowlist_include_members')[0m
[30;1m1783 | [0m[35m[0m
[30;1m1784 | [0m[35m        ssl_options = {n: config[n] for n in ('certfile', 'keyfile', 'keyfile_password',[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1731 | [0m[35m            import ssl[0m
[30;1m1732 | [0m[35m            try:[0m
[30;1m1733 | [0m[35m                crt = cast(Dict[str, Any], ssl._ssl._test_decode_cert(certfile))  # pyright: ignore[0m
[30;1m1734 | [0m[35m                return crt.get('serialNumber')[0m
[30;1m1735 | [0m[35m            except ssl.SSLError as e:[0m
[30;1m1736 | [0m[35m                logger.error('Failed to get serial number from certificate %s: %r', self.__ssl_optio[0m
[30;1m1737 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1726 | [0m[35m[0m
[30;1m1727 | [0m[35m        :returns: serial number of the certificate configured through ``restapi.certfile`` setting.[0m
[30;1m1728 | [0m[35m        """[0m
[30;1m1729 | [0m[35m        certfile: Optional[str] = self.__ssl_options.get('certfile')[0m
[30;1m1730 | [0m[35m        if certfile:[0m
[30;1m1731 | [0m[35m            import ssl[0m
[30;1m1732 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1671 | [0m[35m                ctx.set_ciphers(ssl_options['ciphers'])[0m
[30;1m1672 | [0m[35m            ctx.load_cert_chain(certfile=ssl_options['certfile'], keyfile=ssl_options.get('keyfile')[0m
[30;1m1673 | [0m[35m                                password=ssl_options.get('keyfile_password'))[0m
[30;1m1674 | [0m[35m            verify_client = ssl_options.get('verify_client')[0m
[30;1m1675 | [0m[35m            if verify_client:[0m
[30;1m1676 | [0m[35m                modes = {'none': ssl.CERT_NONE, 'optional': ssl.CERT_OPTIONAL, 'required': ssl.CERT_[0m
[30;1m1677 | [0m[35m                if verify_client in modes:[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1670 | [0m[35m            if ssl_options.get('ciphers'):[0m
[30;1m1671 | [0m[35m                ctx.set_ciphers(ssl_options['ciphers'])[0m
[30;1m1672 | [0m[35m            ctx.load_cert_chain(certfile=ssl_options['certfile'], keyfile=ssl_options.get('keyfile')[0m
[30;1m1673 | [0m[35m                                password=ssl_options.get('keyfile_password'))[0m
[30;1m1674 | [0m[35m            verify_client = ssl_options.get('verify_client')[0m
[30;1m1675 | [0m[35m            if verify_client:[0m
[30;1m1676 | [0m[35m                modes = {'none': ssl.CERT_NONE, 'optional': ssl.CERT_OPTIONAL, 'required': ssl.CERT_[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1669 | [0m[35m            ctx = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH, cafile=ssl_options.get('cafile[0m
[30;1m1670 | [0m[35m            if ssl_options.get('ciphers'):[0m
[30;1m1671 | [0m[35m                ctx.set_ciphers(ssl_options['ciphers'])[0m
[30;1m1672 | [0m[35m            ctx.load_cert_chain(certfile=ssl_options['certfile'], keyfile=ssl_options.get('keyfile')[0m
[30;1m1673 | [0m[35m                                password=ssl_options.get('keyfile_password'))[0m
[30;1m1674 | [0m[35m            verify_client = ssl_options.get('verify_client')[0m
[30;1m1675 | [0m[35m            if verify_client:[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1667 | [0m[35m        if self.__protocol == 'https':[0m
[30;1m1668 | [0m[35m            import ssl[0m
[30;1m1669 | [0m[35m            ctx = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH, cafile=ssl_options.get('cafile[0m
[30;1m1670 | [0m[35m            if ssl_options.get('ciphers'):[0m
[30;1m1671 | [0m[35m                ctx.set_ciphers(ssl_options['ciphers'])[0m
[30;1m1672 | [0m[35m            ctx.load_cert_chain(certfile=ssl_options['certfile'], keyfile=ssl_options.get('keyfile')[0m
[30;1m1673 | [0m[35m                                password=ssl_options.get('keyfile_password'))[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1666 | [0m[35m        self.__protocol = 'https' if ssl_options.get('certfile') else 'http'[0m
[30;1m1667 | [0m[35m        if self.__protocol == 'https':[0m
[30;1m1668 | [0m[35m            import ssl[0m
[30;1m1669 | [0m[35m            ctx = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH, cafile=ssl_options.get('cafile[0m
[30;1m1670 | [0m[35m            if ssl_options.get('ciphers'):[0m
[30;1m1671 | [0m[35m                ctx.set_ciphers(ssl_options['ciphers'])[0m
[30;1m1672 | [0m[35m            ctx.load_cert_chain(certfile=ssl_options['certfile'], keyfile=ssl_options.get('keyfile')[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1663 | [0m[35m[0m
[30;1m1664 | [0m[35m        # wrap socket with ssl if 'certfile' is defined in a config.yaml[0m
[30;1m1665 | [0m[35m        # Sometime it's also needed to pass reference to a 'keyfile'.[0m
[30;1m1666 | [0m[35m        self.__protocol = 'https' if ssl_options.get('certfile') else 'http'[0m
[30;1m1667 | [0m[35m        if self.__protocol == 'https':[0m
[30;1m1668 | [0m[35m            import ssl[0m
[30;1m1669 | [0m[35m            ctx = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH, cafile=ssl_options.get('cafile[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1561 | [0m[35m            if self.__protocol == 'https' and self.__ssl_options.get('verify_client') in ('required'[0m
[30;1m1562 | [0m[35m                return rh.write_response(403, 'client certificate required')[0m
[30;1m1563 | [0m[35m[0m
[30;1m1564 | [0m[35m        reason = self.check_auth_header(rh.headers.get('Authorization'))[0m
[30;1m1565 | [0m[35m        if reason:[0m
[30;1m1566 | [0m[35m            headers = {'WWW-Authenticate': 'Basic realm="' + self.patroni.__class__.__name__ + '"'}[0m
[30;1m1567 | [0m[35m            return rh.write_response(401, reason, headers=headers)[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1558 | [0m[35m                return rh.write_response(403, 'Access is denied')[0m
[30;1m1559 | [0m[35m[0m
[30;1m1560 | [0m[35m        if not hasattr(rh.request, 'getpeercert') or not rh.request.getpeercert():  # valid client c[0m
[30;1m1561 | [0m[35m            if self.__protocol == 'https' and self.__ssl_options.get('verify_client') in ('required'[0m
[30;1m1562 | [0m[35m                return rh.write_response(403, 'client certificate required')[0m
[30;1m1563 | [0m[35m[0m
[30;1m1564 | [0m[35m        reason = self.check_auth_header(rh.headers.get('Authorization'))[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1446 | [0m[35m[0m
[30;1m1447 | [0m[35m        try:[0m
[30;1m1448 | [0m[35m            connection = self.patroni.postgresql.connection_pool.get('restapi')[0m
[30;1m1449 | [0m[35m            connection.get()  # try to open psycopg connection to postgres[0m
[30;1m1450 | [0m[35m        except psycopg.Error:[0m
[30;1m1451 | [0m[35m            logger.debug('restapi connection to postgres is not available')[0m
[30;1m1452 | [0m[35m            connection = heartbeat_connection[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1445 | [0m[35m            raise PostgresConnectionException('connection problems') from exc[0m
[30;1m1446 | [0m[35m[0m
[30;1m1447 | [0m[35m        try:[0m
[30;1m1448 | [0m[35m            connection = self.patroni.postgresql.connection_pool.get('restapi')[0m
[30;1m1449 | [0m[35m            connection.get()  # try to open psycopg connection to postgres[0m
[30;1m1450 | [0m[35m        except psycopg.Error:[0m
[30;1m1451 | [0m[35m            logger.debug('restapi connection to postgres is not available')[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1440 | [0m[35m        # We first try to get a heartbeat connection because it is always required for the main thre[0m
[30;1m1441 | [0m[35m        try:[0m
[30;1m1442 | [0m[35m            heartbeat_connection = self.patroni.postgresql.connection_pool.get('heartbeat')[0m
[30;1m1443 | [0m[35m            heartbeat_connection.get()  # try to open psycopg connection to postgres[0m
[30;1m1444 | [0m[35m        except psycopg.Error as exc:[0m
[30;1m1445 | [0m[35m            raise PostgresConnectionException('connection problems') from exc[0m
[30;1m1446 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1439 | [0m[35m        """[0m
[30;1m1440 | [0m[35m        # We first try to get a heartbeat connection because it is always required for the main thre[0m
[30;1m1441 | [0m[35m        try:[0m
[30;1m1442 | [0m[35m            heartbeat_connection = self.patroni.postgresql.connection_pool.get('heartbeat')[0m
[30;1m1443 | [0m[35m            heartbeat_connection.get()  # try to open psycopg connection to postgres[0m
[30;1m1444 | [0m[35m        except psycopg.Error as exc:[0m
[30;1m1445 | [0m[35m            raise PostgresConnectionException('connection problems') from exc[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1415 | [0m[35m        self.http_extra_headers: Dict[str, str] = {}[0m
[30;1m1416 | [0m[35m        self.patroni = patroni[0m
[30;1m1417 | [0m[35m        self.__listen = None[0m
[30;1m1418 | [0m[35m        self.request_queue_size = int(config.get('request_queue_size', 5))[0m
[30;1m1419 | [0m[35m        self.__ssl_options: Dict[str, Any] = {}[0m
[30;1m1420 | [0m[35m        self.__ssl_serial_number = None[0m
[30;1m1421 | [0m[35m        self._received_new_cert = False[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1122 | [0m[35m[0m
[30;1m1123 | [0m[35m        leader = request.get('leader')[0m
[30;1m1124 | [0m[35m        candidate = request.get('candidate') or request.get('member')[0m
[30;1m1125 | [0m[35m        scheduled_at = request.get('scheduled_at')[0m
[30;1m1126 | [0m[35m        cluster = self.server.patroni.dcs.get_cluster()[0m
[30;1m1127 | [0m[35m        config = global_config.from_cluster(cluster)[0m
[30;1m1128 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1121 | [0m[35m            return[0m
[30;1m1122 | [0m[35m[0m
[30;1m1123 | [0m[35m        leader = request.get('leader')[0m
[30;1m1124 | [0m[35m        candidate = request.get('candidate') or request.get('member')[0m
[30;1m1125 | [0m[35m        scheduled_at = request.get('scheduled_at')[0m
[30;1m1126 | [0m[35m        cluster = self.server.patroni.dcs.get_cluster()[0m
[30;1m1127 | [0m[35m        config = global_config.from_cluster(cluster)[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1121 | [0m[35m            return[0m
[30;1m1122 | [0m[35m[0m
[30;1m1123 | [0m[35m        leader = request.get('leader')[0m
[30;1m1124 | [0m[35m        candidate = request.get('candidate') or request.get('member')[0m
[30;1m1125 | [0m[35m        scheduled_at = request.get('scheduled_at')[0m
[30;1m1126 | [0m[35m        cluster = self.server.patroni.dcs.get_cluster()[0m
[30;1m1127 | [0m[35m        config = global_config.from_cluster(cluster)[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1120 | [0m[35m        if not request:[0m
[30;1m1121 | [0m[35m            return[0m
[30;1m1122 | [0m[35m[0m
[30;1m1123 | [0m[35m        leader = request.get('leader')[0m
[30;1m1124 | [0m[35m        candidate = request.get('candidate') or request.get('member')[0m
[30;1m1125 | [0m[35m        scheduled_at = request.get('scheduled_at')[0m
[30;1m1126 | [0m[35m        cluster = self.server.patroni.dcs.get_cluster()[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1010 | [0m[35m        if request:[0m
[30;1m1011 | [0m[35m            logger.debug('received reinitialize request: %s', request)[0m
[30;1m1012 | [0m[35m[0m
[30;1m1013 | [0m[35m        force = isinstance(request, dict) and parse_bool(request.get('force')) or False[0m
[30;1m1014 | [0m[35m[0m
[30;1m1015 | [0m[35m        data = self.server.patroni.ha.reinitialize(force)[0m
[30;1m1016 | [0m[35m        if data is None:[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m695 | [0m[35m        if 'content-length' not in self.headers:[0m
[30;1m696 | [0m[35m            return self.send_error(411) if not body_is_optional else {}[0m
[30;1m697 | [0m[35m        try:[0m
[30;1m698 | [0m[35m            content_length = int(self.headers.get('content-length') or 0)[0m
[30;1m699 | [0m[35m            if content_length == 0 and body_is_optional:[0m
[30;1m700 | [0m[35m                return {}[0m
[30;1m701 | [0m[35m            request = json.loads(self.rfile.read(content_length).decode('utf-8'))[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m669 | [0m[35m[0m
[30;1m670 | [0m[35m        metrics.append("# HELP patroni_is_paused Value is 1 if auto failover is disabled, 0 otherwis[0m
[30;1m671 | [0m[35m        metrics.append("# TYPE patroni_is_paused gauge")[0m
[30;1m672 | [0m[35m        metrics.append("patroni_is_paused{0} {1}".format(labels, int(postgres.get('pause', 0))))[0m
[30;1m673 | [0m[35m[0m
[30;1m674 | [0m[35m        self.write_response(200, '\n'.join(metrics) + '\n', content_type='text/plain')[0m
[30;1m675 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m660 | [0m[35m        metrics.append("# HELP patroni_dcs_last_seen Epoch timestamp when DCS was last contacted suc[0m
[30;1m661 | [0m[35m                       " by Patroni.")[0m
[30;1m662 | [0m[35m        metrics.append("# TYPE patroni_dcs_last_seen gauge")[0m
[30;1m663 | [0m[35m        metrics.append("patroni_dcs_last_seen{0} {1}".format(labels, postgres.get('dcs_last_seen', 0[0m
[30;1m664 | [0m[35m[0m
[30;1m665 | [0m[35m        metrics.append("# HELP patroni_pending_restart Value is 1 if the node needs a restart, 0 oth[0m
[30;1m666 | [0m[35m        metrics.append("# TYPE patroni_pending_restart gauge")[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m655 | [0m[35m[0m
[30;1m656 | [0m[35m        metrics.append("# HELP patroni_postgres_timeline Postgres timeline of this node (if running)[0m
[30;1m657 | [0m[35m        metrics.append("# TYPE patroni_postgres_timeline counter")[0m
[30;1m658 | [0m[35m        metrics.append("patroni_postgres_timeline{0} {1}".format(labels, postgres.get('timeline') or[0m
[30;1m659 | [0m[35m[0m
[30;1m660 | [0m[35m        metrics.append("# HELP patroni_dcs_last_seen Epoch timestamp when DCS was last contacted suc[0m
[30;1m661 | [0m[35m                       " by Patroni.")[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m651 | [0m[35m        metrics.append("# HELP patroni_failsafe_mode_is_active Value is 1 if failsafe mode is active[0m
[30;1m652 | [0m[35m        metrics.append("# TYPE patroni_failsafe_mode_is_active gauge")[0m
[30;1m653 | [0m[35m        metrics.append("patroni_failsafe_mode_is_active{0} {1}"[0m
[30;1m654 | [0m[35m                       .format(labels, int(postgres.get('failsafe_mode_is_active', 0))))[0m
[30;1m655 | [0m[35m[0m
[30;1m656 | [0m[35m        metrics.append("# HELP patroni_postgres_timeline Postgres timeline of this node (if running)[0m
[30;1m657 | [0m[35m        metrics.append("# TYPE patroni_postgres_timeline counter")[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m646 | [0m[35m[0m
[30;1m647 | [0m[35m        metrics.append("# HELP patroni_cluster_unlocked Value is 1 if the cluster is unlocked, 0 if [0m
[30;1m648 | [0m[35m        metrics.append("# TYPE patroni_cluster_unlocked gauge")[0m
[30;1m649 | [0m[35m        metrics.append("patroni_cluster_unlocked{0} {1}".format(labels, int(postgres.get('cluster_un[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m        metrics.append("# HELP patroni_failsafe_mode_is_active Value is 1 if failsafe mode is active[0m
[30;1m652 | [0m[35m        metrics.append("# TYPE patroni_failsafe_mode_is_active gauge")[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m642 | [0m[35m[0m
[30;1m643 | [0m[35m        metrics.append("# HELP patroni_postgres_server_version Version of Postgres (if running), 0 o[0m
[30;1m644 | [0m[35m        metrics.append("# TYPE patroni_postgres_server_version gauge")[0m
[30;1m645 | [0m[35m        metrics.append("patroni_postgres_server_version {0} {1}".format(labels, postgres.get('server[0m
[30;1m646 | [0m[35m[0m
[30;1m647 | [0m[35m        metrics.append("# HELP patroni_cluster_unlocked Value is 1 if the cluster is unlocked, 0 if [0m
[30;1m648 | [0m[35m        metrics.append("# TYPE patroni_cluster_unlocked gauge")[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m638 | [0m[35m                           " if Postgres is replicating from archive, 0 otherwise.")[0m
[30;1m639 | [0m[35m            metrics.append("# TYPE patroni_postgres_in_archive_recovery gauge")[0m
[30;1m640 | [0m[35m            metrics.append("patroni_postgres_in_archive_recovery{0} {1}"[0m
[30;1m641 | [0m[35m                           .format(labels, int(postgres.get('replication_state') == 'in archive reco[0m
[30;1m642 | [0m[35m[0m
[30;1m643 | [0m[35m        metrics.append("# HELP patroni_postgres_server_version Version of Postgres (if running), 0 o[0m
[30;1m644 | [0m[35m        metrics.append("# TYPE patroni_postgres_server_version gauge")[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m632 | [0m[35m            metrics.append("# HELP patroni_postgres_streaming Value is 1 if Postgres is streaming, 0[0m
[30;1m633 | [0m[35m            metrics.append("# TYPE patroni_postgres_streaming gauge")[0m
[30;1m634 | [0m[35m            metrics.append("patroni_postgres_streaming{0} {1}"[0m
[30;1m635 | [0m[35m                           .format(labels, int(postgres.get('replication_state') == 'streaming')))[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m            metrics.append("# HELP patroni_postgres_in_archive_recovery Value is 1"[0m
[30;1m638 | [0m[35m                           " if Postgres is replicating from archive, 0 otherwise.")[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m628 | [0m[35m        metrics.append("patroni_xlog_paused{0} {1}"[0m
[30;1m629 | [0m[35m                       .format(labels, int(postgres.get('xlog', {}).get('paused', False) is True)))[0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m        if postgres.get('server_version', 0) >= 90600:[0m
[30;1m632 | [0m[35m            metrics.append("# HELP patroni_postgres_streaming Value is 1 if Postgres is streaming, 0[0m
[30;1m633 | [0m[35m            metrics.append("# TYPE patroni_postgres_streaming gauge")[0m
[30;1m634 | [0m[35m            metrics.append("patroni_postgres_streaming{0} {1}"[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m626 | [0m[35m        metrics.append("# HELP patroni_xlog_paused Value is 1 if the Postgres xlog is paused, 0 othe[0m
[30;1m627 | [0m[35m        metrics.append("# TYPE patroni_xlog_paused gauge")[0m
[30;1m628 | [0m[35m        metrics.append("patroni_xlog_paused{0} {1}"[0m
[30;1m629 | [0m[35m                       .format(labels, int(postgres.get('xlog', {}).get('paused', False) is True)))[0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m        if postgres.get('server_version', 0) >= 90600:[0m
[30;1m632 | [0m[35m            metrics.append("# HELP patroni_postgres_streaming Value is 1 if Postgres is streaming, 0[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m626 | [0m[35m        metrics.append("# HELP patroni_xlog_paused Value is 1 if the Postgres xlog is paused, 0 othe[0m
[30;1m627 | [0m[35m        metrics.append("# TYPE patroni_xlog_paused gauge")[0m
[30;1m628 | [0m[35m        metrics.append("patroni_xlog_paused{0} {1}"[0m
[30;1m629 | [0m[35m                       .format(labels, int(postgres.get('xlog', {}).get('paused', False) is True)))[0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m        if postgres.get('server_version', 0) >= 90600:[0m
[30;1m632 | [0m[35m            metrics.append("# HELP patroni_postgres_streaming Value is 1 if Postgres is streaming, 0[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m619 | [0m[35m        metrics.append("# HELP patroni_xlog_replayed_timestamp Current timestamp of the replayed"[0m
[30;1m620 | [0m[35m                       " Postgres transaction log, 0 if null.")[0m
[30;1m621 | [0m[35m        metrics.append("# TYPE patroni_xlog_replayed_timestamp gauge")[0m
[30;1m622 | [0m[35m        replayed_timestamp = postgres.get('xlog', {}).get('replayed_timestamp')[0m
[30;1m623 | [0m[35m        replayed_timestamp = (replayed_timestamp - epoch).total_seconds() if replayed_timestamp else[0m
[30;1m624 | [0m[35m        metrics.append("patroni_xlog_replayed_timestamp{0} {1}".format(labels, replayed_timestamp))[0m
[30;1m625 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m619 | [0m[35m        metrics.append("# HELP patroni_xlog_replayed_timestamp Current timestamp of the replayed"[0m
[30;1m620 | [0m[35m                       " Postgres transaction log, 0 if null.")[0m
[30;1m621 | [0m[35m        metrics.append("# TYPE patroni_xlog_replayed_timestamp gauge")[0m
[30;1m622 | [0m[35m        replayed_timestamp = postgres.get('xlog', {}).get('replayed_timestamp')[0m
[30;1m623 | [0m[35m        replayed_timestamp = (replayed_timestamp - epoch).total_seconds() if replayed_timestamp else[0m
[30;1m624 | [0m[35m        metrics.append("patroni_xlog_replayed_timestamp{0} {1}".format(labels, replayed_timestamp))[0m
[30;1m625 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m614 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m
[30;1m615 | [0m[35m        metrics.append("# TYPE patroni_xlog_replayed_location counter")[0m
[30;1m616 | [0m[35m        metrics.append("patroni_xlog_replayed_location{0} {1}"[0m
[30;1m617 | [0m[35m                       .format(labels, postgres.get('xlog', {}).get('replayed_location', 0)))[0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m        metrics.append("# HELP patroni_xlog_replayed_timestamp Current timestamp of the replayed"[0m
[30;1m620 | [0m[35m                       " Postgres transaction log, 0 if null.")[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m614 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m
[30;1m615 | [0m[35m        metrics.append("# TYPE patroni_xlog_replayed_location counter")[0m
[30;1m616 | [0m[35m        metrics.append("patroni_xlog_replayed_location{0} {1}"[0m
[30;1m617 | [0m[35m                       .format(labels, postgres.get('xlog', {}).get('replayed_location', 0)))[0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m        metrics.append("# HELP patroni_xlog_replayed_timestamp Current timestamp of the replayed"[0m
[30;1m620 | [0m[35m                       " Postgres transaction log, 0 if null.")[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m608 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m
[30;1m609 | [0m[35m        metrics.append("# TYPE patroni_xlog_received_location counter")[0m
[30;1m610 | [0m[35m        metrics.append("patroni_xlog_received_location{0} {1}"[0m
[30;1m611 | [0m[35m                       .format(labels, postgres.get('xlog', {}).get('received_location', 0)))[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m        metrics.append("# HELP patroni_xlog_replayed_location Current location of the replayed"[0m
[30;1m614 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m608 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m
[30;1m609 | [0m[35m        metrics.append("# TYPE patroni_xlog_received_location counter")[0m
[30;1m610 | [0m[35m        metrics.append("patroni_xlog_received_location{0} {1}"[0m
[30;1m611 | [0m[35m                       .format(labels, postgres.get('xlog', {}).get('received_location', 0)))[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m        metrics.append("# HELP patroni_xlog_replayed_location Current location of the replayed"[0m
[30;1m614 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m        metrics.append("# HELP patroni_quorum_standby Value is 1 if this node is a quorum standby, 0[0m
[30;1m604 | [0m[35m        metrics.append("# TYPE patroni_quorum_standby gauge")[0m
[30;1m605 | [0m[35m        metrics.append("patroni_quorum_standby{0} {1}".format(labels, int(postgres.get('quorum_stand[0m
[30;1m606 | [0m[35m[0m
[30;1m607 | [0m[35m        metrics.append("# HELP patroni_xlog_received_location Current location of the received"[0m
[30;1m608 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35m        metrics.append("# HELP patroni_sync_standby Value is 1 if this node is a sync standby, 0 oth[0m
[30;1m600 | [0m[35m        metrics.append("# TYPE patroni_sync_standby gauge")[0m
[30;1m601 | [0m[35m        metrics.append("patroni_sync_standby{0} {1}".format(labels, int(postgres.get('sync_standby',[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m        metrics.append("# HELP patroni_quorum_standby Value is 1 if this node is a quorum standby, 0[0m
[30;1m604 | [0m[35m        metrics.append("# TYPE patroni_quorum_standby gauge")[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m586 | [0m[35m        metrics.append("# HELP patroni_xlog_location Current location of the Postgres"[0m
[30;1m587 | [0m[35m                       " transaction log, 0 if this node is not the leader.")[0m
[30;1m588 | [0m[35m        metrics.append("# TYPE patroni_xlog_location counter")[0m
[30;1m589 | [0m[35m        metrics.append("patroni_xlog_location{0} {1}".format(labels, postgres.get('xlog', {}).get('l[0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m        metrics.append("# HELP patroni_standby_leader Value is 1 if this node is the standby_leader,[0m
[30;1m592 | [0m[35m        metrics.append("# TYPE patroni_standby_leader gauge")[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m586 | [0m[35m        metrics.append("# HELP patroni_xlog_location Current location of the Postgres"[0m
[30;1m587 | [0m[35m                       " transaction log, 0 if this node is not the leader.")[0m
[30;1m588 | [0m[35m        metrics.append("# TYPE patroni_xlog_location counter")[0m
[30;1m589 | [0m[35m        metrics.append("patroni_xlog_location{0} {1}".format(labels, postgres.get('xlog', {}).get('l[0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m        metrics.append("# HELP patroni_standby_leader Value is 1 if this node is the standby_leader,[0m
[30;1m592 | [0m[35m        metrics.append("# TYPE patroni_standby_leader gauge")[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m575 | [0m[35m[0m
[30;1m576 | [0m[35m        metrics.append("# HELP patroni_postmaster_start_time Epoch seconds since Postgres started.")[0m
[30;1m577 | [0m[35m        metrics.append("# TYPE patroni_postmaster_start_time gauge")[0m
[30;1m578 | [0m[35m        postmaster_start_time = postgres.get('postmaster_start_time')[0m
[30;1m579 | [0m[35m        postmaster_start_time = (postmaster_start_time - epoch).total_seconds() if postmaster_start_[0m
[30;1m580 | [0m[35m        metrics.append("patroni_postmaster_start_time{0} {1}".format(labels, postmaster_start_time))[0m
[30;1m581 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m                    continue[0m
[30;1m387 | [0m[35m                qs_key = qs_key[len(qs_tag_prefix):][0m
[30;1m388 | [0m[35m                qs_value = qs_value[0][0m
[30;1m389 | [0m[35m                instance_tag_value = patroni.tags.get(qs_key)[0m
[30;1m390 | [0m[35m                # tag not registered for instance[0m
[30;1m391 | [0m[35m                if instance_tag_value is None:[0m
[30;1m392 | [0m[35m                    status_code = 503[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m            status_code = 200 if response.get('state') == 'running' else 503[0m
[30;1m361 | [0m[35m        elif cluster:  # dcs is available[0m
[30;1m362 | [0m[35m            is_quorum = response.get('quorum_standby')[0m
[30;1m363 | [0m[35m            is_synchronous = response.get('sync_standby')[0m
[30;1m364 | [0m[35m            if path in ('/sync', '/synchronous') and is_synchronous:[0m
[30;1m365 | [0m[35m                status_code = replica_status_code[0m
[30;1m366 | [0m[35m            elif path == '/quorum' and is_quorum:[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35m        elif 'health' in path:[0m
[30;1m360 | [0m[35m            status_code = 200 if response.get('state') == 'running' else 503[0m
[30;1m361 | [0m[35m        elif cluster:  # dcs is available[0m
[30;1m362 | [0m[35m            is_quorum = response.get('quorum_standby')[0m
[30;1m363 | [0m[35m            is_synchronous = response.get('sync_standby')[0m
[30;1m364 | [0m[35m            if path in ('/sync', '/synchronous') and is_synchronous:[0m
[30;1m365 | [0m[35m                status_code = replica_status_code[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m        elif 'read-only' in path and 'sync' not in path and 'quorum' not in path:[0m
[30;1m358 | [0m[35m            status_code = 200 if 200 in (primary_status_code, standby_leader_status_code) else repli[0m
[30;1m359 | [0m[35m        elif 'health' in path:[0m
[30;1m360 | [0m[35m            status_code = 200 if response.get('state') == 'running' else 503[0m
[30;1m361 | [0m[35m        elif cluster:  # dcs is available[0m
[30;1m362 | [0m[35m            is_quorum = response.get('quorum_standby')[0m
[30;1m363 | [0m[35m            is_synchronous = response.get('sync_standby')[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m            leader_status_code = 200[0m
[30;1m334 | [0m[35m            if config.is_standby_cluster:[0m
[30;1m335 | [0m[35m                primary_status_code = replica_status_code = 503[0m
[30;1m336 | [0m[35m                standby_leader_status_code = 200 if response.get('role') in ('replica', 'standby_lea[0m
[30;1m337 | [0m[35m            else:[0m
[30;1m338 | [0m[35m                primary_status_code = 200[0m
[30;1m339 | [0m[35m                standby_leader_status_code = 503[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m        if not cluster and response.get('pause'):[0m
[30;1m329 | [0m[35m            leader_status_code = 200 if response.get('role') in ('primary', 'standby_leader') else 5[0m
[30;1m330 | [0m[35m            primary_status_code = 200 if response.get('role') == 'primary' else 503[0m
[30;1m331 | [0m[35m            standby_leader_status_code = 200 if response.get('role') == 'standby_leader' else 503[0m
[30;1m332 | [0m[35m        elif patroni.ha.is_leader():[0m
[30;1m333 | [0m[35m            leader_status_code = 200[0m
[30;1m334 | [0m[35m            if config.is_standby_cluster:[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        if not cluster and response.get('pause'):[0m
[30;1m329 | [0m[35m            leader_status_code = 200 if response.get('role') in ('primary', 'standby_leader') else 5[0m
[30;1m330 | [0m[35m            primary_status_code = 200 if response.get('role') == 'primary' else 503[0m
[30;1m331 | [0m[35m            standby_leader_status_code = 200 if response.get('role') == 'standby_leader' else 503[0m
[30;1m332 | [0m[35m        elif patroni.ha.is_leader():[0m
[30;1m333 | [0m[35m            leader_status_code = 200[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35m            response.get('role') == 'replica' and response.get('state') == 'running' else 503[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        if not cluster and response.get('pause'):[0m
[30;1m329 | [0m[35m            leader_status_code = 200 if response.get('role') in ('primary', 'standby_leader') else 5[0m
[30;1m330 | [0m[35m            primary_status_code = 200 if response.get('role') == 'primary' else 503[0m
[30;1m331 | [0m[35m            standby_leader_status_code = 200 if response.get('role') == 'standby_leader' else 503[0m
[30;1m332 | [0m[35m        elif patroni.ha.is_leader():[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m        replica_status_code = 200 if not patroni.noloadbalance and not is_lagging and \[0m
[30;1m326 | [0m[35m            response.get('role') == 'replica' and response.get('state') == 'running' else 503[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        if not cluster and response.get('pause'):[0m
[30;1m329 | [0m[35m            leader_status_code = 200 if response.get('role') in ('primary', 'standby_leader') else 5[0m
[30;1m330 | [0m[35m            primary_status_code = 200 if response.get('role') == 'primary' else 503[0m
[30;1m331 | [0m[35m            standby_leader_status_code = 200 if response.get('role') == 'standby_leader' else 503[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m323 | [0m[35m        is_lagging = leader_optime and leader_optime > replayed_location + max_replica_lag[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        replica_status_code = 200 if not patroni.noloadbalance and not is_lagging and \[0m
[30;1m326 | [0m[35m            response.get('role') == 'replica' and response.get('state') == 'running' else 503[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        if not cluster and response.get('pause'):[0m
[30;1m329 | [0m[35m            leader_status_code = 200 if response.get('role') in ('primary', 'standby_leader') else 5[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m323 | [0m[35m        is_lagging = leader_optime and leader_optime > replayed_location + max_replica_lag[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        replica_status_code = 200 if not patroni.noloadbalance and not is_lagging and \[0m
[30;1m326 | [0m[35m            response.get('role') == 'replica' and response.get('state') == 'running' else 503[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        if not cluster and response.get('pause'):[0m
[30;1m329 | [0m[35m            leader_status_code = 200 if response.get('role') in ('primary', 'standby_leader') else 5[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        leader_optime = cluster and cluster.status.last_lsn[0m
[30;1m319 | [0m[35m        replayed_location = response.get('xlog', {}).get('replayed_location', 0)[0m
[30;1m320 | [0m[35m        max_replica_lag = parse_int(self.path_query.get('lag', [sys.maxsize])[0], 'B')[0m
[30;1m321 | [0m[35m        if max_replica_lag is None:[0m
[30;1m322 | [0m[35m            max_replica_lag = sys.maxsize[0m
[30;1m323 | [0m[35m        is_lagging = leader_optime and leader_optime > replayed_location + max_replica_lag[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m        config = global_config.from_cluster(cluster)[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        leader_optime = cluster and cluster.status.last_lsn[0m
[30;1m319 | [0m[35m        replayed_location = response.get('xlog', {}).get('replayed_location', 0)[0m
[30;1m320 | [0m[35m        max_replica_lag = parse_int(self.path_query.get('lag', [sys.maxsize])[0], 'B')[0m
[30;1m321 | [0m[35m        if max_replica_lag is None:[0m
[30;1m322 | [0m[35m            max_replica_lag = sys.maxsize[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m        config = global_config.from_cluster(cluster)[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        leader_optime = cluster and cluster.status.last_lsn[0m
[30;1m319 | [0m[35m        replayed_location = response.get('xlog', {}).get('replayed_location', 0)[0m
[30;1m320 | [0m[35m        max_replica_lag = parse_int(self.path_query.get('lag', [sys.maxsize])[0], 'B')[0m
[30;1m321 | [0m[35m        if max_replica_lag is None:[0m
[30;1m322 | [0m[35m            max_replica_lag = sys.maxsize[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m        In FooServer: Foo[0m
[30;1m70 | [0m[35m        In do_PUT_foo[0m
[30;1m71 | [0m[35m    """[0m
[30;1m72 | [0m[35m    allowlist_check_members = kwargs.get('allowlist_check_members', True)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    def inner_decorator(func: Callable[..., Any]) -> Callable[..., Any]:[0m
[30;1m75 | [0m[35m        def wrapper(self: 'RestApiHandler', *args: Any, **kwargs: Any) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1763 | [0m[35m                        yield ip_network(v, False)[0m
[30;1m1764 | [0m[35m                    except Exception as e:[0m
[30;1m1765 | [0m[35m                        logger.error('Invalid value "%s" in the allowlist: %r', v, e)[0m
[30;1m1766 | [0m[35m                else:  # ip or hostname, try to resolve it[0m
[30;1m1767 | [0m[35m                    for ip in self.__resolve_ips(v, 8080):[0m
[30;1m1768 | [0m[35m                        yield ip[0m
[30;1m1769 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1623 | [0m[35m            Patroni, it restarts the HTTP server thread.[0m
[30;1m1624 | [0m[35m[0m
[30;1m1625 | [0m[35m        :param listen: IP and port to bind REST API to. It should be a string in the format ``host:p[0m
[30;1m1626 | [0m[35m            ``host`` can be a hostname or IP address. It is the value of ``restapi.listen`` setting.[0m
[30;1m1627 | [0m[35m        :param ssl_options: dictionary that may contain the following keys, depending on what has be[0m
[30;1m1628 | [0m[35m            ``restapi`` section:[0m
[30;1m1629 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1612 | [0m[35m            HTTPServer.__init__(self, (info[0][1], info[0][2]), RestApiHandler)[0m
[30;1m1613 | [0m[35m        except socket.error:[0m
[30;1m1614 | [0m[35m            logger.error([0m
[30;1m1615 | [0m[35m                "Couldn't start a service on '%s:%s', please check your `restapi.listen` configurati[0m
[30;1m1616 | [0m[35m            raise[0m
[30;1m1617 | [0m[35m[0m
[30;1m1618 | [0m[35m    def __initialize(self, listen: str, ssl_options: Dict[str, Any]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1602 | [0m[35m[0m
[30;1m1603 | [0m[35m        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on I[0m
[30;1m1604 | [0m[35m        info = [(a[0], a[4][0], a[4][1])[0m
[30;1m1605 | [0m[35m                for a in socket.getaddrinfo(hostname, port, socket.AF_UNSPEC, socket.SOCK_STREAM, 0,[0m
[30;1m1606 | [0m[35m                if isinstance(a[4][0], str) and isinstance(a[4][1], int)][0m
[30;1m1607 | [0m[35m        # in case dual stack is not supported we want IPv4 to be preferred over IPv6[0m
[30;1m1608 | [0m[35m        info.sort(key=lambda x: x[0] == socket.AF_INET, reverse=not dual_stack)[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1598 | [0m[35m        dual_stack = self.__has_dual_stack()[0m
[30;1m1599 | [0m[35m        hostname = host[0m
[30;1m1600 | [0m[35m        if hostname in ('', '*'):[0m
[30;1m1601 | [0m[35m            hostname = None[0m
[30;1m1602 | [0m[35m[0m
[30;1m1603 | [0m[35m        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on I[0m
[30;1m1604 | [0m[35m        info = [(a[0], a[4][0], a[4][1])[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1597 | [0m[35m        """[0m
[30;1m1598 | [0m[35m        dual_stack = self.__has_dual_stack()[0m
[30;1m1599 | [0m[35m        hostname = host[0m
[30;1m1600 | [0m[35m        if hostname in ('', '*'):[0m
[30;1m1601 | [0m[35m            hostname = None[0m
[30;1m1602 | [0m[35m[0m
[30;1m1603 | [0m[35m        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on I[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1596 | [0m[35m        :param port: port to bind REST API to.[0m
[30;1m1597 | [0m[35m        """[0m
[30;1m1598 | [0m[35m        dual_stack = self.__has_dual_stack()[0m
[30;1m1599 | [0m[35m        hostname = host[0m
[30;1m1600 | [0m[35m        if hostname in ('', '*'):[0m
[30;1m1601 | [0m[35m            hostname = None[0m
[30;1m1602 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1526 | [0m[35m                            r = urlparse(member.api_url)[0m
[30;1m1527 | [0m[35m                            if r.hostname:[0m
[30;1m1528 | [0m[35m                                port = r.port or (443 if r.scheme == 'https' else 80)[0m
[30;1m1529 | [0m[35m                                for ip in self.__resolve_ips(r.hostname, port):[0m
[30;1m1530 | [0m[35m                                    yield ip[0m
[30;1m1531 | [0m[35m                        except Exception as e:[0m
[30;1m1532 | [0m[35m                            logger.debug('Failed to parse url %s: %r', member.api_url, e)[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1524 | [0m[35m                    if member.api_url:[0m
[30;1m1525 | [0m[35m                        try:[0m
[30;1m1526 | [0m[35m                            r = urlparse(member.api_url)[0m
[30;1m1527 | [0m[35m                            if r.hostname:[0m
[30;1m1528 | [0m[35m                                port = r.port or (443 if r.scheme == 'https' else 80)[0m
[30;1m1529 | [0m[35m                                for ip in self.__resolve_ips(r.hostname, port):[0m
[30;1m1530 | [0m[35m                                    yield ip[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m.hostname[0m
[30;1m1498 | [0m[35m    def __resolve_ips(host: str, port: int) -> Iterator[Union[IPv4Network, IPv6Network]]:[0m
[30;1m1499 | [0m[35m        """Resolve *host* + *port* to one or more IP networks.[0m
[30;1m1500 | [0m[35m[0m
[30;1m1501 | [0m[35m        :param host: hostname to be checked.[0m
[30;1m1502 | [0m[35m        :param port: port to be checked.[0m
[30;1m1503 | [0m[35m[0m
[30;1m1504 | [0m[35m        :yields: *host* + *port* resolved to IP networks.[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1397 | [0m[35m    An asynchronous thread-based HTTP server.[0m
[30;1m1398 | [0m[35m    """[0m
[30;1m1399 | [0m[35m[0m
[30;1m1400 | [0m[35m    # On 3.7+ the `ThreadingMixIn` gathers all non-daemon worker threads in order to join on them at[0m
[30;1m1401 | [0m[35m    daemon_threads = True  # Make worker threads "fire and forget" to prevent a memory leak.[0m
[30;1m1402 | [0m[35m[0m
[30;1m1403 | [0m[35m    def __init__(self, patroni: Patroni, config: Dict[str, Any]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1217 | [0m[35m        Original class can only invoke :func:`do_GET`, :func:`do_POST`, :func:`do_PUT`, etc method i[0m
[30;1m1218 | [0m[35m        they are defined.[0m
[30;1m1219 | [0m[35m[0m
[30;1m1220 | [0m[35m        But we would like to have at least some simple routing mechanism, i.e.:[0m
[30;1m1221 | [0m[35m[0m
[30;1m1222 | [0m[35m            * ``GET /uri1/part2`` request should invoke :func:`do_GET_uri1()`[0m
[30;1m1223 | [0m[35m            * ``POST /other`` should invoke :func:`do_POST_other()`[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m978 | [0m[35m[0m
[30;1m979 | [0m[35m            * ``200``: if a scheduled switchover was removed; or[0m
[30;1m980 | [0m[35m            * ``404``: if no scheduled switchover could be found; or[0m
[30;1m981 | [0m[35m            * ``409``: if not able to update the switchover info in the DCS.[0m
[30;1m982 | [0m[35m        """[0m
[30;1m983 | [0m[35m        failover = self.server.patroni.dcs.get_cluster().failover[0m
[30;1m984 | [0m[35m        if failover and failover.scheduled_at:[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m855 | [0m[35m[0m
[30;1m856 | [0m[35m        The request body should be a JSON dictionary, and it can contain the following keys:[0m
[30;1m857 | [0m[35m[0m
[30;1m858 | [0m[35m            * ``schedule``: timestamp at which the restart should occur;[0m
[30;1m859 | [0m[35m            * ``role``: restart only nodes which role is ``role``. Can be either:[0m
[30;1m860 | [0m[35m[0m
[30;1m861 | [0m[35m                * ``primary`; or[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m762 | [0m[35m    def do_GET_failsafe(self) -> None:[0m
[30;1m763 | [0m[35m        """Handle a ``GET`` request to ``/failsafe`` path.[0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35m        Writes a response with a JSON string body containing all nodes that are known to Patroni at [0m
[30;1m766 | [0m[35m        in time, with HTTP status ``200``. The JSON contains a dictionary, each key is the name of t[0m
[30;1m767 | [0m[35m        and the corresponding value is the URI to access `/patroni` path of its REST API.[0m
[30;1m768 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m498 | [0m[35m        following items:[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m            * Timeline when the event occurred (class:`int`);[0m
[30;1m501 | [0m[35m            * LSN at which the event occurred (class:`int`);[0m
[30;1m502 | [0m[35m            * The reason for the event (class:`str`);[0m
[30;1m503 | [0m[35m            * Timestamp when the new timeline was created (class:`str`);[0m
[30;1m504 | [0m[35m            * Name of the involved Patroni node (class:`str`).[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1807 | [0m[35m        Logs ``WARNING`` messages with the client information, and the stack trace of the faced exce[0m
[30;1m1808 | [0m[35m[0m
[30;1m1809 | [0m[35m        :param request: the request that faced an exception.[0m
[30;1m1810 | [0m[35m        :param client_address: a tuple composed of the IP and port of the client connection.[0m
[30;1m1811 | [0m[35m        """[0m
[30;1m1812 | [0m[35m        logger.warning('Exception happened during processing of request from %s:%s',[0m
[30;1m1813 | [0m[35m                       client_address[0], client_address[1])[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1776 | [0m[35m            :class:`ValueError`: if ``listen`` key is not present in *config*.[0m
[30;1m1777 | [0m[35m        """[0m
[30;1m1778 | [0m[35m        if 'listen' not in config:  # changing config in runtime[0m
[30;1m1779 | [0m[35m            raise ValueError('Can not find "restapi.listen" config')[0m
[30;1m1780 | [0m[35m[0m
[30;1m1781 | [0m[35m        self.__allowlist = tuple(self._build_allowlist(config.get('allowlist')))[0m
[30;1m1782 | [0m[35m        self.__allowlist_include_members = config.get('allowlist_include_members')[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1765 | [0m[35m                        logger.error('Invalid value "%s" in the allowlist: %r', v, e)[0m
[30;1m1766 | [0m[35m                else:  # ip or hostname, try to resolve it[0m
[30;1m1767 | [0m[35m                    for ip in self.__resolve_ips(v, 8080):[0m
[30;1m1768 | [0m[35m                        yield ip[0m
[30;1m1769 | [0m[35m[0m
[30;1m1770 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m
[30;1m1771 | [0m[35m        """Reload REST API configuration.[0m
[30;1m1772 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1764 | [0m[35m                    except Exception as e:[0m
[30;1m1765 | [0m[35m                        logger.error('Invalid value "%s" in the allowlist: %r', v, e)[0m
[30;1m1766 | [0m[35m                else:  # ip or hostname, try to resolve it[0m
[30;1m1767 | [0m[35m                    for ip in self.__resolve_ips(v, 8080):[0m
[30;1m1768 | [0m[35m                        yield ip[0m
[30;1m1769 | [0m[35m[0m
[30;1m1770 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1763 | [0m[35m                        yield ip_network(v, False)[0m
[30;1m1764 | [0m[35m                    except Exception as e:[0m
[30;1m1765 | [0m[35m                        logger.error('Invalid value "%s" in the allowlist: %r', v, e)[0m
[30;1m1766 | [0m[35m                else:  # ip or hostname, try to resolve it[0m
[30;1m1767 | [0m[35m                    for ip in self.__resolve_ips(v, 8080):[0m
[30;1m1768 | [0m[35m                        yield ip[0m
[30;1m1769 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1754 | [0m[35m        :param value: list of IPs and/or networks contained in ``restapi.allowlist`` setting. Each i[0m
[30;1m1755 | [0m[35m            an IP, or a network in CIDR format.[0m
[30;1m1756 | [0m[35m[0m
[30;1m1757 | [0m[35m        :yields: *host* + *port* resolved to IP networks.[0m
[30;1m1758 | [0m[35m        """[0m
[30;1m1759 | [0m[35m        if isinstance(value, list):[0m
[30;1m1760 | [0m[35m            for v in value:[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1749 | [0m[35m                return True[0m
[30;1m1750 | [0m[35m[0m
[30;1m1751 | [0m[35m    def _build_allowlist(self, value: Optional[List[str]]) -> Iterator[Union[IPv4Network, IPv6Networ[0m
[30;1m1752 | [0m[35m        """Resolve each entry in *value* to an IP network object.[0m
[30;1m1753 | [0m[35m[0m
[30;1m1754 | [0m[35m        :param value: list of IPs and/or networks contained in ``restapi.allowlist`` setting. Each i[0m
[30;1m1755 | [0m[35m            an IP, or a network in CIDR format.[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1693 | [0m[35m            * Perform SSL handshake (if an SSL socket).[0m
[30;1m1694 | [0m[35m[0m
[30;1m1695 | [0m[35m        :param request: socket to handle the client request.[0m
[30;1m1696 | [0m[35m        :param client_address: tuple containing the client IP and port.[0m
[30;1m1697 | [0m[35m        """[0m
[30;1m1698 | [0m[35m        if isinstance(request, socket.socket):[0m
[30;1m1699 | [0m[35m            enable_keepalive(request, 10, 3)[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1623 | [0m[35m            Patroni, it restarts the HTTP server thread.[0m
[30;1m1624 | [0m[35m[0m
[30;1m1625 | [0m[35m        :param listen: IP and port to bind REST API to. It should be a string in the format ``host:p[0m
[30;1m1626 | [0m[35m            ``host`` can be a hostname or IP address. It is the value of ``restapi.listen`` setting.[0m
[30;1m1627 | [0m[35m        :param ssl_options: dictionary that may contain the following keys, depending on what has be[0m
[30;1m1628 | [0m[35m            ``restapi`` section:[0m
[30;1m1629 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1622 | [0m[35m            This method can be called upon first initialization, and also when reloading Patroni. Wh[0m
[30;1m1623 | [0m[35m            Patroni, it restarts the HTTP server thread.[0m
[30;1m1624 | [0m[35m[0m
[30;1m1625 | [0m[35m        :param listen: IP and port to bind REST API to. It should be a string in the format ``host:p[0m
[30;1m1626 | [0m[35m            ``host`` can be a hostname or IP address. It is the value of ``restapi.listen`` setting.[0m
[30;1m1627 | [0m[35m        :param ssl_options: dictionary that may contain the following keys, depending on what has be[0m
[30;1m1628 | [0m[35m            ``restapi`` section:[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1612 | [0m[35m            HTTPServer.__init__(self, (info[0][1], info[0][2]), RestApiHandler)[0m
[30;1m1613 | [0m[35m        except socket.error:[0m
[30;1m1614 | [0m[35m            logger.error([0m
[30;1m1615 | [0m[35m                "Couldn't start a service on '%s:%s', please check your `restapi.listen` configurati[0m
[30;1m1616 | [0m[35m            raise[0m
[30;1m1617 | [0m[35m[0m
[30;1m1618 | [0m[35m    def __initialize(self, listen: str, ssl_options: Dict[str, Any]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1544 | [0m[35m                * a client certificate is expected by the server, but is missing in the request.[0m
[30;1m1545 | [0m[35m[0m
[30;1m1546 | [0m[35m        :param rh: the request which access should be checked.[0m
[30;1m1547 | [0m[35m        :param allowlist_check_members: whether we should check the source ip against existing clust[0m
[30;1m1548 | [0m[35m[0m
[30;1m1549 | [0m[35m        :returns: ``True`` if client access verification succeeded, otherwise ``None``.[0m
[30;1m1550 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1540 | [0m[35m            * ``403``: if:[0m
[30;1m1541 | [0m[35m[0m
[30;1m1542 | [0m[35m                * ``restapi.allowlist`` was configured, but client IP is not in the allowed list; or[0m
[30;1m1543 | [0m[35m                * ``restapi.allowlist_include_members`` is enabled, but client IP is not in the memb[0m
[30;1m1544 | [0m[35m                * a client certificate is expected by the server, but is missing in the request.[0m
[30;1m1545 | [0m[35m[0m
[30;1m1546 | [0m[35m        :param rh: the request which access should be checked.[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1539 | [0m[35m            * ``401``: if ``Authorization`` header is missing or contain an invalid password;[0m
[30;1m1540 | [0m[35m            * ``403``: if:[0m
[30;1m1541 | [0m[35m[0m
[30;1m1542 | [0m[35m                * ``restapi.allowlist`` was configured, but client IP is not in the allowed list; or[0m
[30;1m1543 | [0m[35m                * ``restapi.allowlist_include_members`` is enabled, but client IP is not in the memb[0m
[30;1m1544 | [0m[35m                * a client certificate is expected by the server, but is missing in the request.[0m
[30;1m1545 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1527 | [0m[35m                            if r.hostname:[0m
[30;1m1528 | [0m[35m                                port = r.port or (443 if r.scheme == 'https' else 80)[0m
[30;1m1529 | [0m[35m                                for ip in self.__resolve_ips(r.hostname, port):[0m
[30;1m1530 | [0m[35m                                    yield ip[0m
[30;1m1531 | [0m[35m                        except Exception as e:[0m
[30;1m1532 | [0m[35m                            logger.debug('Failed to parse url %s: %r', member.api_url, e)[0m
[30;1m1533 | [0m[35m[0m
[30;1m1534 | [0m[35m    def check_access(self, rh: RestApiHandler, allowlist_check_members: bool = True) -> Optional[boo[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1526 | [0m[35m                            r = urlparse(member.api_url)[0m
[30;1m1527 | [0m[35m                            if r.hostname:[0m
[30;1m1528 | [0m[35m                                port = r.port or (443 if r.scheme == 'https' else 80)[0m
[30;1m1529 | [0m[35m                                for ip in self.__resolve_ips(r.hostname, port):[0m
[30;1m1530 | [0m[35m                                    yield ip[0m
[30;1m1531 | [0m[35m                        except Exception as e:[0m
[30;1m1532 | [0m[35m                            logger.debug('Failed to parse url %s: %r', member.api_url, e)[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1515 | [0m[35m        .. note::[0m
[30;1m1516 | [0m[35m            Only yields object if ``restapi.allowlist_include_members`` setting is enabled.[0m
[30;1m1517 | [0m[35m[0m
[30;1m1518 | [0m[35m        :yields: each node ``restapi.connect_address`` resolved to an IP network.[0m
[30;1m1519 | [0m[35m        """[0m
[30;1m1520 | [0m[35m        cluster = self.patroni.dcs.cluster[0m
[30;1m1521 | [0m[35m        if self.__allowlist_include_members and cluster:[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1515 | [0m[35m        .. note::[0m
[30;1m1516 | [0m[35m            Only yields object if ``restapi.allowlist_include_members`` setting is enabled.[0m
[30;1m1517 | [0m[35m[0m
[30;1m1518 | [0m[35m        :yields: each node ``restapi.connect_address`` resolved to an IP network.[0m
[30;1m1519 | [0m[35m        """[0m
[30;1m1520 | [0m[35m        cluster = self.patroni.dcs.cluster[0m
[30;1m1521 | [0m[35m        if self.__allowlist_include_members and cluster:[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1510 | [0m[35m            logger.error('Failed to resolve %s: %r', host, e)[0m
[30;1m1511 | [0m[35m[0m
[30;1m1512 | [0m[35m    def __members_ips(self) -> Iterator[Union[IPv4Network, IPv6Network]]:[0m
[30;1m1513 | [0m[35m        """Resolve each Patroni node ``restapi.connect_address`` to IP networks.[0m
[30;1m1514 | [0m[35m[0m
[30;1m1515 | [0m[35m        .. note::[0m
[30;1m1516 | [0m[35m            Only yields object if ``restapi.allowlist_include_members`` setting is enabled.[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1510 | [0m[35m            logger.error('Failed to resolve %s: %r', host, e)[0m
[30;1m1511 | [0m[35m[0m
[30;1m1512 | [0m[35m    def __members_ips(self) -> Iterator[Union[IPv4Network, IPv6Network]]:[0m
[30;1m1513 | [0m[35m        """Resolve each Patroni node ``restapi.connect_address`` to IP networks.[0m
[30;1m1514 | [0m[35m[0m
[30;1m1515 | [0m[35m        .. note::[0m
[30;1m1516 | [0m[35m            Only yields object if ``restapi.allowlist_include_members`` setting is enabled.[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1501 | [0m[35m        :param host: hostname to be checked.[0m
[30;1m1502 | [0m[35m        :param port: port to be checked.[0m
[30;1m1503 | [0m[35m[0m
[30;1m1504 | [0m[35m        :yields: *host* + *port* resolved to IP networks.[0m
[30;1m1505 | [0m[35m        """[0m
[30;1m1506 | [0m[35m        try:[0m
[30;1m1507 | [0m[35m            for _, _, _, _, sa in socket.getaddrinfo(host, port, 0, socket.SOCK_STREAM, socket.IPPRO[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1496 | [0m[35m[0m
[30;1m1497 | [0m[35m    @staticmethod[0m
[30;1m1498 | [0m[35m    def __resolve_ips(host: str, port: int) -> Iterator[Union[IPv4Network, IPv6Network]]:[0m
[30;1m1499 | [0m[35m        """Resolve *host* + *port* to one or more IP networks.[0m
[30;1m1500 | [0m[35m[0m
[30;1m1501 | [0m[35m        :param host: hostname to be checked.[0m
[30;1m1502 | [0m[35m        :param port: port to be checked.[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1382 | [0m[35m    def log_message(self, format: str, *args: Any) -> None:[0m
[30;1m1383 | [0m[35m        """Log a custom ``debug`` message.[0m
[30;1m1384 | [0m[35m[0m
[30;1m1385 | [0m[35m        Additionally, to *format*, the log entry contains the client IP address and the current late[0m
[30;1m1386 | [0m[35m[0m
[30;1m1387 | [0m[35m        :param format: printf-style format string message to be logged.[0m
[30;1m1388 | [0m[35m        :param args: arguments to be applied as inputs to *format*.[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1295 | [0m[35m                * ``usename``: ``pg_stat_activity.usename``.[0m
[30;1m1296 | [0m[35m[0m
[30;1m1297 | [0m[35m            * ``pause``: ``True`` if cluster is in maintenance mode;[0m
[30;1m1298 | [0m[35m            * ``cluster_unlocked``: ``True`` if cluster has no node holding the leader lock;[0m
[30;1m1299 | [0m[35m            * ``failsafe_mode_is_active``: ``True`` if DCS failsafe mode is currently active;[0m
[30;1m1300 | [0m[35m            * ``dcs_last_seen``: epoch timestamp DCS was last reached by Patroni.[0m
[30;1m1301 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1283 | [0m[35m[0m
[30;1m1284 | [0m[35m            * ``sync_standby``: ``True`` if replication mode is synchronous and this is a sync stand[0m
[30;1m1285 | [0m[35m            * ``quorum_standby``: ``True`` if replication mode is quorum and this is a quorum standb[0m
[30;1m1286 | [0m[35m            * ``timeline``: PostgreSQL primary node timeline;[0m
[30;1m1287 | [0m[35m            * ``replication``: :class:`list` of :class:`dict` entries, one for each replication conn[0m
[30;1m1288 | [0m[35m                contains the following keys:[0m
[30;1m1289 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1097 | [0m[35m        The request body should be a JSON dictionary, and it can contain the following keys:[0m
[30;1m1098 | [0m[35m[0m
[30;1m1099 | [0m[35m            * ``leader``: name of the current leader in the cluster;[0m
[30;1m1100 | [0m[35m            * ``candidate``: name of the Patroni node to be promoted;[0m
[30;1m1101 | [0m[35m            * ``scheduled_at``: a string representing the timestamp when to execute the switchover/f[0m
[30;1m1102 | [0m[35m                ``2023-04-14T20:27:00+00:00``.[0m
[30;1m1103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1078 | [0m[35m        elif config.is_synchronous_mode and not config.is_quorum_commit_mode:[0m
[30;1m1079 | [0m[35m            members = [m for m in cluster.members if cluster.sync.matches(m.name)][0m
[30;1m1080 | [0m[35m            if not members:[0m
[30;1m1081 | [0m[35m                return action + ' is not possible: can not find sync_standby'[0m
[30;1m1082 | [0m[35m        else:[0m
[30;1m1083 | [0m[35m            members = [m for m in cluster.members if not cluster.leader or m.name != cluster.leader.[0m
[30;1m1084 | [0m[35m            if not members:[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1060 | [0m[35m[0m
[30;1m1061 | [0m[35m        :param cluster: the Patroni cluster.[0m
[30;1m1062 | [0m[35m        :param leader: name of the current Patroni leader.[0m
[30;1m1063 | [0m[35m        :param candidate: name of the Patroni node to be promoted.[0m
[30;1m1064 | [0m[35m        :param action: the action to be performed (``switchover`` or ``failover``).[0m
[30;1m1065 | [0m[35m[0m
[30;1m1066 | [0m[35m        :returns: a string with the error message or ``None`` if good nodes are found.[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1038 | [0m[35m[0m
[30;1m1039 | [0m[35m        """[0m
[30;1m1040 | [0m[35m        timeout = max(10, self.server.patroni.dcs.loop_wait)[0m
[30;1m1041 | [0m[35m        for _ in range(0, timeout * 2):[0m
[30;1m1042 | [0m[35m            time.sleep(1)[0m
[30;1m1043 | [0m[35m            try:[0m
[30;1m1044 | [0m[35m                cluster = self.server.patroni.dcs.get_cluster()[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1037 | [0m[35m            * A status message about the operation.[0m
[30;1m1038 | [0m[35m[0m
[30;1m1039 | [0m[35m        """[0m
[30;1m1040 | [0m[35m        timeout = max(10, self.server.patroni.dcs.loop_wait)[0m
[30;1m1041 | [0m[35m        for _ in range(0, timeout * 2):[0m
[30;1m1042 | [0m[35m            time.sleep(1)[0m
[30;1m1043 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1024 | [0m[35m        """Poll failover/switchover operation until it finishes or times out.[0m
[30;1m1025 | [0m[35m[0m
[30;1m1026 | [0m[35m        :param leader: name of the current Patroni leader.[0m
[30;1m1027 | [0m[35m        :param candidate: name of the Patroni node to be promoted.[0m
[30;1m1028 | [0m[35m        :param action: the action that is ongoing (``switchover`` or ``failover``).[0m
[30;1m1029 | [0m[35m[0m
[30;1m1030 | [0m[35m        :returns: a tuple composed of 2 items:[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m779 | [0m[35m    def do_POST_failsafe(self) -> None:[0m
[30;1m780 | [0m[35m        """Handle a ``POST`` request to ``/failsafe`` path.[0m
[30;1m781 | [0m[35m[0m
[30;1m782 | [0m[35m        Writes a response with HTTP status ``200`` if this node is a Standby, or with HTTP status ``[0m
[30;1m783 | [0m[35m        the primary. In addition to that it returns absolute value of received/replayed LSN in the `[0m
[30;1m784 | [0m[35m[0m
[30;1m785 | [0m[35m        .. note::[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m662 | [0m[35m        metrics.append("# TYPE patroni_dcs_last_seen gauge")[0m
[30;1m663 | [0m[35m        metrics.append("patroni_dcs_last_seen{0} {1}".format(labels, postgres.get('dcs_last_seen', 0[0m
[30;1m664 | [0m[35m[0m
[30;1m665 | [0m[35m        metrics.append("# HELP patroni_pending_restart Value is 1 if the node needs a restart, 0 oth[0m
[30;1m666 | [0m[35m        metrics.append("# TYPE patroni_pending_restart gauge")[0m
[30;1m667 | [0m[35m        metrics.append("patroni_pending_restart{0} {1}"[0m
[30;1m668 | [0m[35m                       .format(labels, int(bool(patroni.postgresql.pending_restart_reason))))[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m653 | [0m[35m        metrics.append("patroni_failsafe_mode_is_active{0} {1}"[0m
[30;1m654 | [0m[35m                       .format(labels, int(postgres.get('failsafe_mode_is_active', 0))))[0m
[30;1m655 | [0m[35m[0m
[30;1m656 | [0m[35m        metrics.append("# HELP patroni_postgres_timeline Postgres timeline of this node (if running)[0m
[30;1m657 | [0m[35m        metrics.append("# TYPE patroni_postgres_timeline counter")[0m
[30;1m658 | [0m[35m        metrics.append("patroni_postgres_timeline{0} {1}".format(labels, postgres.get('timeline') or[0m
[30;1m659 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m611 | [0m[35m                       .format(labels, postgres.get('xlog', {}).get('received_location', 0)))[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m        metrics.append("# HELP patroni_xlog_replayed_location Current location of the replayed"[0m
[30;1m614 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m
[30;1m615 | [0m[35m        metrics.append("# TYPE patroni_xlog_replayed_location counter")[0m
[30;1m616 | [0m[35m        metrics.append("patroni_xlog_replayed_location{0} {1}"[0m
[30;1m617 | [0m[35m                       .format(labels, postgres.get('xlog', {}).get('replayed_location', 0)))[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m605 | [0m[35m        metrics.append("patroni_quorum_standby{0} {1}".format(labels, int(postgres.get('quorum_stand[0m
[30;1m606 | [0m[35m[0m
[30;1m607 | [0m[35m        metrics.append("# HELP patroni_xlog_received_location Current location of the received"[0m
[30;1m608 | [0m[35m                       " Postgres transaction log, 0 if this node is not a replica.")[0m
[30;1m609 | [0m[35m        metrics.append("# TYPE patroni_xlog_received_location counter")[0m
[30;1m610 | [0m[35m        metrics.append("patroni_xlog_received_location{0} {1}"[0m
[30;1m611 | [0m[35m                       .format(labels, postgres.get('xlog', {}).get('received_location', 0)))[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m600 | [0m[35m        metrics.append("# TYPE patroni_sync_standby gauge")[0m
[30;1m601 | [0m[35m        metrics.append("patroni_sync_standby{0} {1}".format(labels, int(postgres.get('sync_standby',[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m        metrics.append("# HELP patroni_quorum_standby Value is 1 if this node is a quorum standby, 0[0m
[30;1m604 | [0m[35m        metrics.append("# TYPE patroni_quorum_standby gauge")[0m
[30;1m605 | [0m[35m        metrics.append("patroni_quorum_standby{0} {1}".format(labels, int(postgres.get('quorum_stand[0m
[30;1m606 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m596 | [0m[35m        metrics.append("# TYPE patroni_replica gauge")[0m
[30;1m597 | [0m[35m        metrics.append("patroni_replica{0} {1}".format(labels, int(postgres['role'] == 'replica')))[0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35m        metrics.append("# HELP patroni_sync_standby Value is 1 if this node is a sync standby, 0 oth[0m
[30;1m600 | [0m[35m        metrics.append("# TYPE patroni_sync_standby gauge")[0m
[30;1m601 | [0m[35m        metrics.append("patroni_sync_standby{0} {1}".format(labels, int(postgres.get('sync_standby',[0m
[30;1m602 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m592 | [0m[35m        metrics.append("# TYPE patroni_standby_leader gauge")[0m
[30;1m593 | [0m[35m        metrics.append("patroni_standby_leader{0} {1}".format(labels, int(postgres['role'] == 'stand[0m
[30;1m594 | [0m[35m[0m
[30;1m595 | [0m[35m        metrics.append("# HELP patroni_replica Value is 1 if this node is a replica, 0 otherwise.")[0m
[30;1m596 | [0m[35m        metrics.append("# TYPE patroni_replica gauge")[0m
[30;1m597 | [0m[35m        metrics.append("patroni_replica{0} {1}".format(labels, int(postgres['role'] == 'replica')))[0m
[30;1m598 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m588 | [0m[35m        metrics.append("# TYPE patroni_xlog_location counter")[0m
[30;1m589 | [0m[35m        metrics.append("patroni_xlog_location{0} {1}".format(labels, postgres.get('xlog', {}).get('l[0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m        metrics.append("# HELP patroni_standby_leader Value is 1 if this node is the standby_leader,[0m
[30;1m592 | [0m[35m        metrics.append("# TYPE patroni_standby_leader gauge")[0m
[30;1m593 | [0m[35m        metrics.append("patroni_standby_leader{0} {1}".format(labels, int(postgres['role'] == 'stand[0m
[30;1m594 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m584 | [0m[35m        metrics.append("patroni_primary{0} {1}".format(labels, int(postgres['role'] == 'primary')))[0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m        metrics.append("# HELP patroni_xlog_location Current location of the Postgres"[0m
[30;1m587 | [0m[35m                       " transaction log, 0 if this node is not the leader.")[0m
[30;1m588 | [0m[35m        metrics.append("# TYPE patroni_xlog_location counter")[0m
[30;1m589 | [0m[35m        metrics.append("patroni_xlog_location{0} {1}".format(labels, postgres.get('xlog', {}).get('l[0m
[30;1m590 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m579 | [0m[35m        postmaster_start_time = (postmaster_start_time - epoch).total_seconds() if postmaster_start_[0m
[30;1m580 | [0m[35m        metrics.append("patroni_postmaster_start_time{0} {1}".format(labels, postmaster_start_time))[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m        metrics.append("# HELP patroni_primary Value is 1 if this node is the leader, 0 otherwise.")[0m
[30;1m583 | [0m[35m        metrics.append("# TYPE patroni_primary gauge")[0m
[30;1m584 | [0m[35m        metrics.append("patroni_primary{0} {1}".format(labels, int(postgres['role'] == 'primary')))[0m
[30;1m585 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m548 | [0m[35m            * ``patroni_failsafe_mode_is_active``: ``1`` if ``failsafe_mode`` is currently active, e[0m
[30;1m549 | [0m[35m            * ``patroni_postgres_timeline``: PostgreSQL timeline based on current WAL file name;[0m
[30;1m550 | [0m[35m            * ``patroni_dcs_last_seen``: epoch timestamp when DCS was last contacted successfully;[0m
[30;1m551 | [0m[35m            * ``patroni_pending_restart``: ``1`` if this PostgreSQL node is pending a restart, else [0m
[30;1m552 | [0m[35m            * ``patroni_is_paused``: ``1`` if Patroni is in maintenance node, else ``0``.[0m
[30;1m553 | [0m[35m[0m
[30;1m554 | [0m[35m        For PostgreSQL v9.6+ the response will also have the following:[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m532 | [0m[35mroni version without periods, e.g. ``030002`` for Patroni ``3.0.2``;[0m
[30;1m533 | [0m[35m            * ``patroni_postgres_running``: ``1`` if PostgreSQL is running, else ``0``;[0m
[30;1m534 | [0m[35m            * ``patroni_postmaster_start_time``: epoch timestamp since Postmaster was started;[0m
[30;1m535 | [0m[35m            * ``patroni_primary``: ``1`` if this node holds the leader lock, else ``0``;[0m
[30;1m536 | [0m[35m            * ``patroni_xlog_location``: ``pg_wal_lsn_diff(pg_current_wal_flush_lsn(), '0/0')`` if l[0m
[30;1m537 | [0m[35m            * ``patroni_standby_leader``: ``1`` if standby leader node, else ``0``;[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m501 | [0m[35m            * LSN at which the event occurred (class:`int`);[0m
[30;1m502 | [0m[35m            * The reason for the event (class:`str`);[0m
[30;1m503 | [0m[35m            * Timestamp when the new timeline was created (class:`str`);[0m
[30;1m504 | [0m[35m            * Name of the involved Patroni node (class:`str`).[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m        """[0m
[30;1m507 | [0m[35m        cluster = self.server.patroni.dcs.cluster or self.server.patroni.dcs.get_cluster()[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m            * ``200``:[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m                * If this Patroni node holds the DCS leader lock; or[0m
[30;1m456 | [0m[35m                * If this PostgreSQL instance is up and running;[0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m            * ``503``: if none of the previous conditions apply.[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m414 | [0m[35m        """Handle a ``HEAD`` request.[0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m        Write a simple HTTP response that represents the current PostgreSQL status. Send only ``200 [0m
[30;1m417 | [0m[35m        ``503 Service Unavailable`` as a response and nothing more, particularly no headers.[0m
[30;1m418 | [0m[35m        """[0m
[30;1m419 | [0m[35m        self.do_GET(write_status_code_only=True)[0m
[30;1m420 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m406 | [0m[35m        """Handle an ``OPTIONS`` request.[0m
[30;1m407 | [0m[35m[0m
[30;1m408 | [0m[35m        Write a simple HTTP response that represents the current PostgreSQL status. Send only ``200 [0m
[30;1m409 | [0m[35m        ``503 Service Unavailable`` as a response and nothing more, particularly no headers.[0m
[30;1m410 | [0m[35m        """[0m
[30;1m411 | [0m[35m        self.do_GET(write_status_code_only=True)[0m
[30;1m412 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m        .. note::[0m
[30;1m304 | [0m[35m            Independently of the requested path, if *write_status_code_only* is ``False``, then it a[0m
[30;1m305 | [0m[35m            response through :func:`_write_status_response`, with the node status.[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        :param write_status_code_only: indicates that instead of a normal HTTP response we should[0m
[30;1m308 | [0m[35m                                       send only the HTTP Status Code and close the connection.[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m258 | [0m[35m                    * ``lag``: only accept replication lag up to ``lag``. Accepts either an :class:`[0m
[30;1m259 | [0m[35m                        represents lag in bytes, or a :class:`str` representing lag in human-readabl[0m
[30;1m260 | [0m[35m                        ``10MB``).[0m
[30;1m261 | [0m[35m                    * Any custom parameter: will attempt to match them against node tags.[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m                * HTTP status ``200``: if up and running as a standby and without ``noloadbalance`` [0m
[30;1m264 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    .. note::[0m
[30;1m44 | [0m[35m        The actual logic to check access is implemented through :func:`RestApiServer.check_access`.[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        Optionally it is possible to skip source ip check by specifying ``allowlist_check_members=Fa[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    :returns: a decorator that executes *func* only if :func:`RestApiServer.check_access` returns ``[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mimport os[0m
[30;1m15 | [0m[35mimport socket[0m
[30;1m16 | [0m[35mimport sys[0m
[30;1m17 | [0m[35mimport time[0m
[30;1m18 | [0m[35mimport traceback[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mfrom http.server import BaseHTTPRequestHandler, HTTPServer[0m
[30;1m21 | [0m[35mfrom ipaddress import ip_address, ip_network, IPv4Network, IPv6Network[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mutilises the API to perform these functions.[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport base64[0m
[30;1m10 | [0m[35mimport datetime[0m
[30;1m11 | [0m[35mimport hmac[0m
[30;1m12 | [0m[35mimport json[0m
[30;1m13 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1359 | [0m[35m    def delete_leader(self, leader: Optional[Leader], last_lsn: Optional[int] = None) -> bool:[0m
[30;1m1360 | [0m[35m        ret = False[0m
[30;1m1361 | [0m[35m        kind = self._kinds.get(self.leader_path)[0m
[30;1m1362 | [0m[35m        if kind and (kind.metadata.annotations or EMPTY_DICT).get(self._LEADER) == self._name:[0m
[30;1m1363 | [0m[35m            annotations: Dict[str, Optional[str]] = {self._LEADER: None}[0m
[30;1m1364 | [0m[35m            if last_lsn:[0m
[30;1m1365 | [0m[35m                annotations[self._OPTIME] = str(last_lsn)[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1358 | [0m[35m[0m
[30;1m1359 | [0m[35m    def delete_leader(self, leader: Optional[Leader], last_lsn: Optional[int] = None) -> bool:[0m
[30;1m1360 | [0m[35m        ret = False[0m
[30;1m1361 | [0m[35m        kind = self._kinds.get(self.leader_path)[0m
[30;1m1362 | [0m[35m        if kind and (kind.metadata.annotations or EMPTY_DICT).get(self._LEADER) == self._name:[0m
[30;1m1363 | [0m[35m            annotations: Dict[str, Optional[str]] = {self._LEADER: None}[0m
[30;1m1364 | [0m[35m            if last_lsn:[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1332 | [0m[35m        member = cluster and cluster.get_member(self._name, fallback_to_leader=False)[0m
[30;1m1333 | [0m[35m        pod_labels = member and member.data.pop('pod_labels', None)[0m
[30;1m1334 | [0m[35m        ret = member and pod_labels is not None\[0m
[30;1m1335 | [0m[35m            and all(pod_labels.get(k) == v for k, v in role_labels.items())\[0m
[30;1m1336 | [0m[35m            and deep_compare(data, member.data)[0m
[30;1m1337 | [0m[35m[0m
[30;1m1338 | [0m[35m        if not ret:[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1319 | [0m[35m            role = self._standby_leader_label_value if data['role'] == 'standby_leader' else self._l[0m
[30;1m1320 | [0m[35m            tmp_role = 'primary'[0m
[30;1m1321 | [0m[35m        elif data['state'] == 'running' and data['role'] != 'primary':[0m
[30;1m1322 | [0m[35m            role = {'replica': self._follower_label_value}.get(data['role'], data['role'])[0m
[30;1m1323 | [0m[35m            tmp_role = data['role'][0m
[30;1m1324 | [0m[35m        else:[0m
[30;1m1325 | [0m[35m            role = None[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1306 | [0m[35m[0m
[30;1m1307 | [0m[35m    @property[0m
[30;1m1308 | [0m[35m    def _config_resource_version(self) -> Optional[str]:[0m
[30;1m1309 | [0m[35m        config = self._kinds.get(self.config_path)[0m
[30;1m1310 | [0m[35m        return config and config.metadata.resource_version[0m
[30;1m1311 | [0m[35m[0m
[30;1m1312 | [0m[35m    def set_config_value(self, value: str, version: Optional[str] = None) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1271 | [0m[35m            if self._leader_observed_record.get(self._LEADER) != self._name:[0m
[30;1m1272 | [0m[35m                transitions += 1[0m
[30;1m1273 | [0m[35m            else:[0m
[30;1m1274 | [0m[35m                annotations['acquireTime'] = self._leader_observed_record.get('acquireTime') or now[0m
[30;1m1275 | [0m[35m            annotations['transitions'] = str(transitions)[0m
[30;1m1276 | [0m[35m[0m
[30;1m1277 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1268 | [0m[35m            except (TypeError, ValueError):[0m
[30;1m1269 | [0m[35m                transitions = 0[0m
[30;1m1270 | [0m[35m[0m
[30;1m1271 | [0m[35m            if self._leader_observed_record.get(self._LEADER) != self._name:[0m
[30;1m1272 | [0m[35m                transitions += 1[0m
[30;1m1273 | [0m[35m            else:[0m
[30;1m1274 | [0m[35m                annotations['acquireTime'] = self._leader_observed_record.get('acquireTime') or now[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1264 | [0m[35m                       'renewTime': now, 'acquireTime': now, 'transitions': '0'}[0m
[30;1m1265 | [0m[35m        if self._leader_observed_record:[0m
[30;1m1266 | [0m[35m            try:[0m
[30;1m1267 | [0m[35m                transitions = int(self._leader_observed_record.get('transitions', ''))[0m
[30;1m1268 | [0m[35m            except (TypeError, ValueError):[0m
[30;1m1269 | [0m[35m                transitions = 0[0m
[30;1m1270 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1245 | [0m[35m        leader_observed_record = kind_annotations or self._leader_observed_record[0m
[30;1m1246 | [0m[35m        annotations = {self._LEADER: self._name, 'ttl': str(self._ttl), 'renewTime': now,[0m
[30;1m1247 | [0m[35m                       'acquireTime': leader_observed_record.get('acquireTime') or now,[0m
[30;1m1248 | [0m[35m                       'transitions': leader_observed_record.get('transitions') or '0'}[0m
[30;1m1249 | [0m[35m        if last_lsn:[0m
[30;1m1250 | [0m[35m            annotations[self._OPTIME] = str(last_lsn)[0m
[30;1m1251 | [0m[35m            annotations['slots'] = json.dumps(slots, separators=(',', ':')) if slots else None[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1244 | [0m[35m        now = datetime.datetime.now(tzutc).isoformat()[0m
[30;1m1245 | [0m[35m        leader_observed_record = kind_annotations or self._leader_observed_record[0m
[30;1m1246 | [0m[35m        annotations = {self._LEADER: self._name, 'ttl': str(self._ttl), 'renewTime': now,[0m
[30;1m1247 | [0m[35m                       'acquireTime': leader_observed_record.get('acquireTime') or now,[0m
[30;1m1248 | [0m[35m                       'transitions': leader_observed_record.get('transitions') or '0'}[0m
[30;1m1249 | [0m[35m        if last_lsn:[0m
[30;1m1250 | [0m[35m            annotations[self._OPTIME] = str(last_lsn)[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1238 | [0m[35m        kind = self._kinds.get(self.leader_path)[0m
[30;1m1239 | [0m[35m        kind_annotations = kind and kind.metadata.annotations or EMPTY_DICT[0m
[30;1m1240 | [0m[35m[0m
[30;1m1241 | [0m[35m        if kind and kind_annotations.get(self._LEADER) != self._name:[0m
[30;1m1242 | [0m[35m            return False[0m
[30;1m1243 | [0m[35m[0m
[30;1m1244 | [0m[35m        now = datetime.datetime.now(tzutc).isoformat()[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1235 | [0m[35m[0m
[30;1m1236 | [0m[35m    def update_leader(self, cluster: Cluster, last_lsn: Optional[int],[0m
[30;1m1237 | [0m[35m                      slots: Optional[Dict[str, int]] = None, failsafe: Optional[Dict[str, str]] = N[0m
[30;1m1238 | [0m[35m        kind = self._kinds.get(self.leader_path)[0m
[30;1m1239 | [0m[35m        kind_annotations = kind and kind.metadata.annotations or EMPTY_DICT[0m
[30;1m1240 | [0m[35m[0m
[30;1m1241 | [0m[35m        if kind and kind_annotations.get(self._LEADER) != self._name:[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1224 | [0m[35m[0m
[30;1m1225 | [0m[35m        # We can get 409 because we do at least one retry, and the first update might have succeeded[0m
[30;1m1226 | [0m[35m        # therefore we will check if annotations on the read object match expectations.[0m
[30;1m1227 | [0m[35m        if all(kind_annotations.get(k) == v for k, v in annotations.items()):[0m
[30;1m1228 | [0m[35m            return True[0m
[30;1m1229 | [0m[35m[0m
[30;1m1230 | [0m[35m        if not retry.ensure_deadline(0.5):[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1219 | [0m[35m        kind_resource_version = kind and kind.metadata.resource_version[0m
[30;1m1220 | [0m[35m[0m
[30;1m1221 | [0m[35m        # There is different leader or resource_version in cache didn't change[0m
[30;1m1222 | [0m[35m        if kind and (kind_annotations.get(self._LEADER) != self._name or kind_resource_version == re[0m
[30;1m1223 | [0m[35m            return False[0m
[30;1m1224 | [0m[35m[0m
[30;1m1225 | [0m[35m        # We can get 409 because we do at least one retry, and the first update might have succeeded[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1069 | [0m[35m                endpoints['subsets'] = [][0m
[30;1m1070 | [0m[35m            return[0m
[30;1m1071 | [0m[35m[0m
[30;1m1072 | [0m[35m        pod = self._pods.get(self._name)[0m
[30;1m1073 | [0m[35m        leader_ip = ips[0] or pod and pod.status.pod_ip[0m
[30;1m1074 | [0m[35m        # don't touch subsets if our (leader) ip is unknown or subsets is valid[0m
[30;1m1075 | [0m[35m        if leader_ip and self.subsets_changed(latest_subsets, leader_ip, self.__ports):[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1060 | [0m[35m                                            name=self._name, resource_version=pod.metadata.resource_[0m
[30;1m1061 | [0m[35m[0m
[30;1m1062 | [0m[35m    def _map_subsets(self, endpoints: Dict[str, Any], ips: List[str]) -> None:[0m
[30;1m1063 | [0m[35m        leader = self._kinds.get(self.leader_path)[0m
[30;1m1064 | [0m[35m        empty_addresses: List[K8sObject] = [][0m
[30;1m1065 | [0m[35m        latest_subsets = leader and leader.subsets or empty_addresses[0m
[30;1m1066 | [0m[35m        if not ips:[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m981 | [0m[35m                pods = {name: pod for name, pod in self._pods.copy().items()[0m
[30;1m982 | [0m[35m                        if not group or pod.metadata.labels.get(self._mpp.k8s_group_label) == group}[0m
[30;1m983 | [0m[35m                nodes = {name: kind for name, kind in self._kinds.copy().items()[0m
[30;1m984 | [0m[35m                         if not group or kind.metadata.labels.get(self._mpp.k8s_group_label) == grou[0m
[30;1m985 | [0m[35m            return loader({'group': group, 'pods': pods, 'nodes': nodes})[0m
[30;1m986 | [0m[35m        except Exception:[0m
[30;1m987 | [0m[35m            logger.exception('get_cluster')[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m979 | [0m[35m            with self._condition:[0m
[30;1m980 | [0m[35m                self._wait_caches(stop_time)[0m
[30;1m981 | [0m[35m                pods = {name: pod for name, pod in self._pods.copy().items()[0m
[30;1m982 | [0m[35m                        if not group or pod.metadata.labels.get(self._mpp.k8s_group_label) == group}[0m
[30;1m983 | [0m[35m                nodes = {name: kind for name, kind in self._kinds.copy().items()[0m
[30;1m984 | [0m[35m                         if not group or kind.metadata.labels.get(self._mpp.k8s_group_label) == grou[0m
[30;1m985 | [0m[35m            return loader({'group': group, 'pods': pods, 'nodes': nodes})[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m962 | [0m[35m                clusters[group]['pods'][name] = pod[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m        for name, kind in path['nodes'].items():[0m
[30;1m965 | [0m[35m            group = kind.metadata.labels.get(self._mpp.k8s_group_label)[0m
[30;1m966 | [0m[35m            if group and self._mpp.group_re.match(group):[0m
[30;1m967 | [0m[35m                clusters[group]['nodes'][name] = kind[0m
[30;1m968 | [0m[35m        return {int(group): self._cluster_from_nodes(group, value['nodes'], value['pods'].values())[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m957 | [0m[35m        clusters: Dict[str, Dict[str, Dict[str, K8sObject]]] = defaultdict(lambda: defaultdict(dict)[0m
[30;1m958 | [0m[35m[0m
[30;1m959 | [0m[35m        for name, pod in path['pods'].items():[0m
[30;1m960 | [0m[35m            group = pod.metadata.labels.get(self._mpp.k8s_group_label)[0m
[30;1m961 | [0m[35m            if group and self._mpp.group_re.match(group):[0m
[30;1m962 | [0m[35m                clusters[group]['pods'][name] = pod[0m
[30;1m963 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m932 | [0m[35m                                                   (metadata.annotations or EMPTY_DICT).copy())[0m
[30;1m933 | [0m[35m[0m
[30;1m934 | [0m[35m        # get synchronization state[0m
[30;1m935 | [0m[35m        sync = nodes.get(path + self._SYNC)[0m
[30;1m936 | [0m[35m        metadata = sync and sync.metadata[0m
[30;1m937 | [0m[35m        sync = SyncState.from_node(metadata and metadata.resource_version, metadata and metadata.ann[0m
[30;1m938 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m926 | [0m[35m            leader = None[0m
[30;1m927 | [0m[35m[0m
[30;1m928 | [0m[35m        # failover key[0m
[30;1m929 | [0m[35m        failover = nodes.get(path + self._FAILOVER)[0m
[30;1m930 | [0m[35m        metadata = failover and failover.metadata[0m
[30;1m931 | [0m[35m        failover = metadata and Failover.from_node(metadata.resource_version,[0m
[30;1m932 | [0m[35m                                                   (metadata.annotations or EMPTY_DICT).copy())[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m909 | [0m[35m[0m
[30;1m910 | [0m[35m        leader = leader_record.get(self._LEADER)[0m
[30;1m911 | [0m[35m        try:[0m
[30;1m912 | [0m[35m            ttl = int(leader_record.get('ttl', self._ttl)) or self._ttl[0m
[30;1m913 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m914 | [0m[35m            ttl = self._ttl[0m
[30;1m915 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m907 | [0m[35m            self._leader_observed_record = leader_record[0m
[30;1m908 | [0m[35m            self._leader_observed_time = time.time()[0m
[30;1m909 | [0m[35m[0m
[30;1m910 | [0m[35m        leader = leader_record.get(self._LEADER)[0m
[30;1m911 | [0m[35m        try:[0m
[30;1m912 | [0m[35m            ttl = int(leader_record.get('ttl', self._ttl)) or self._ttl[0m
[30;1m913 | [0m[35m        except (TypeError, ValueError):[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m894 | [0m[35m[0m
[30;1m895 | [0m[35m        # get failsafe topology[0m
[30;1m896 | [0m[35m        try:[0m
[30;1m897 | [0m[35m            failsafe = json.loads(annotations.get(self._FAILSAFE, ''))[0m
[30;1m898 | [0m[35m        except Exception:[0m
[30;1m899 | [0m[35m            failsafe = None[0m
[30;1m900 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m883 | [0m[35m                                                         annotations.get(self._HISTORY) or '[]')[0m
[30;1m884 | [0m[35m[0m
[30;1m885 | [0m[35m        leader_path = path[:-1] if self._api.use_endpoints else path + self._LEADER[0m
[30;1m886 | [0m[35m        leader = nodes.get(leader_path)[0m
[30;1m887 | [0m[35m        metadata = leader and leader.metadata[0m
[30;1m888 | [0m[35m        if leader_path == self.leader_path:  # We want to memorize leader_resource_version only for [0m
[30;1m889 | [0m[35m            self._leader_resource_version = metadata.resource_version if metadata else None[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m880 | [0m[35m[0m
[30;1m881 | [0m[35m        # get timeline history[0m
[30;1m882 | [0m[35m        history = metadata and TimelineHistory.from_node(metadata.resource_version,[0m
[30;1m883 | [0m[35m                                                         annotations.get(self._HISTORY) or '[]')[0m
[30;1m884 | [0m[35m[0m
[30;1m885 | [0m[35m        leader_path = path[:-1] if self._api.use_endpoints else path + self._LEADER[0m
[30;1m886 | [0m[35m        leader = nodes.get(leader_path)[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m875 | [0m[35m[0m
[30;1m876 | [0m[35m        # get global dynamic configuration[0m
[30;1m877 | [0m[35m        config = metadata and ClusterConfig.from_node(metadata.resource_version,[0m
[30;1m878 | [0m[35m                                                      annotations.get(self._CONFIG) or '{}',[0m
[30;1m879 | [0m[35m                                                      metadata.resource_version if self._CONFIG in a[0m
[30;1m880 | [0m[35m[0m
[30;1m881 | [0m[35m        # get timeline history[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m871 | [0m[35m        annotations = metadata and metadata.annotations or {}[0m
[30;1m872 | [0m[35m[0m
[30;1m873 | [0m[35m        # get initialize flag[0m
[30;1m874 | [0m[35m        initialize = annotations.get(self._INITIALIZE)[0m
[30;1m875 | [0m[35m[0m
[30;1m876 | [0m[35m        # get global dynamic configuration[0m
[30;1m877 | [0m[35m        config = metadata and ClusterConfig.from_node(metadata.resource_version,[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m866 | [0m[35m        if group:[0m
[30;1m867 | [0m[35m            path += group + '-'[0m
[30;1m868 | [0m[35m[0m
[30;1m869 | [0m[35m        config = nodes.get(path + self._CONFIG)[0m
[30;1m870 | [0m[35m        metadata = config and config.metadata[0m
[30;1m871 | [0m[35m        annotations = metadata and metadata.annotations or {}[0m
[30;1m872 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m849 | [0m[35m    @staticmethod[0m
[30;1m850 | [0m[35m    def member(pod: K8sObject) -> Member:[0m
[30;1m851 | [0m[35m        annotations = pod.metadata.annotations or EMPTY_DICT[0m
[30;1m852 | [0m[35m        member = Member.from_node(pod.metadata.resource_version, pod.metadata.name, None, annotation[0m
[30;1m853 | [0m[35m        member.data['pod_labels'] = pod.metadata.labels[0m
[30;1m854 | [0m[35m        return member[0m
[30;1m855 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m837 | [0m[35m        self._api.configure_timeouts(self.loop_wait, self._retry.deadline, self.ttl)[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m        # retriable_http_codes supposed to be either int, list of integers or comma-separated string[0m
[30;1m840 | [0m[35m        retriable_http_codes: Union[str, List[Union[str, int]]] = config.get('retriable_http_codes',[0m
[30;1m841 | [0m[35m        if not isinstance(retriable_http_codes, list):[0m
[30;1m842 | [0m[35m            retriable_http_codes = [c.strip() for c in str(retriable_http_codes).split(',')][0m
[30;1m843 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m782 | [0m[35m            self.__ports.append(k8s_client.V1EndpointPort(**port))[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m        bypass_api_service = not self._ctl and config.get('bypass_api_service')[0m
[30;1m785 | [0m[35m        self._api = CoreV1ApiProxy(config.get('use_endpoints'), bypass_api_service)[0m
[30;1m786 | [0m[35m        self._should_create_config_service = self._api.use_endpoints[0m
[30;1m787 | [0m[35m        self.reload_config(config)[0m
[30;1m788 | [0m[35m        # leader_observed_record, leader_resource_version, and leader_observed_time are used only fo[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m781 | [0m[35m            port.update({n: p[n] for n in ('name', 'protocol') if p.get(n)})[0m
[30;1m782 | [0m[35m            self.__ports.append(k8s_client.V1EndpointPort(**port))[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m        bypass_api_service = not self._ctl and config.get('bypass_api_service')[0m
[30;1m785 | [0m[35m        self._api = CoreV1ApiProxy(config.get('use_endpoints'), bypass_api_service)[0m
[30;1m786 | [0m[35m        self._should_create_config_service = self._api.use_endpoints[0m
[30;1m787 | [0m[35m        self.reload_config(config)[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m778 | [0m[35m        ports: List[Dict[str, Any]] = config.get('ports', [{}])[0m
[30;1m779 | [0m[35m        for p in ports:[0m
[30;1m780 | [0m[35m            port: Dict[str, Any] = {'port': int(p.get('port', '5432'))}[0m
[30;1m781 | [0m[35m            port.update({n: p[n] for n in ('name', 'protocol') if p.get(n)})[0m
[30;1m782 | [0m[35m            self.__ports.append(k8s_client.V1EndpointPort(**port))[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m        bypass_api_service = not self._ctl and config.get('bypass_api_service')[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m777 | [0m[35m        self.__ports: List[K8sObject] = [][0m
[30;1m778 | [0m[35m        ports: List[Dict[str, Any]] = config.get('ports', [{}])[0m
[30;1m779 | [0m[35m        for p in ports:[0m
[30;1m780 | [0m[35m            port: Dict[str, Any] = {'port': int(p.get('port', '5432'))}[0m
[30;1m781 | [0m[35m            port.update({n: p[n] for n in ('name', 'protocol') if p.get(n)})[0m
[30;1m782 | [0m[35m            self.__ports.append(k8s_client.V1EndpointPort(**port))[0m
[30;1m783 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m        self.__ips: List[str] = [] if self._ctl else [config.get('pod_ip', '')][0m
[30;1m777 | [0m[35m        self.__ports: List[K8sObject] = [][0m
[30;1m778 | [0m[35m        ports: List[Dict[str, Any]] = config.get('ports', [{}])[0m
[30;1m779 | [0m[35m        for p in ports:[0m
[30;1m780 | [0m[35m            port: Dict[str, Any] = {'port': int(p.get('port', '5432'))}[0m
[30;1m781 | [0m[35m            port.update({n: p[n] for n in ('name', 'protocol') if p.get(n)})[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m773 | [0m[35m        except k8s_config.ConfigException:[0m
[30;1m774 | [0m[35m            k8s_config.load_kube_config(context=config.get('context', 'kind-kind'))[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m        self.__ips: List[str] = [] if self._ctl else [config.get('pod_ip', '')][0m
[30;1m777 | [0m[35m        self.__ports: List[K8sObject] = [][0m
[30;1m778 | [0m[35m        ports: List[Dict[str, Any]] = config.get('ports', [{}])[0m
[30;1m779 | [0m[35m        for p in ports:[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m771 | [0m[35m        try:[0m
[30;1m772 | [0m[35m            k8s_config.load_incluster_config(ca_certs=self._ca_certs)[0m
[30;1m773 | [0m[35m        except k8s_config.ConfigException:[0m
[30;1m774 | [0m[35m            k8s_config.load_kube_config(context=config.get('context', 'kind-kind'))[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m        self.__ips: List[str] = [] if self._ctl else [config.get('pod_ip', '')][0m
[30;1m777 | [0m[35m        self.__ports: List[K8sObject] = [][0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m767 | [0m[35m[0m
[30;1m768 | [0m[35m        self._retry = Retry(deadline=config['retry_timeout'], max_delay=1, max_tries=-1,[0m
[30;1m769 | [0m[35m                            retry_exceptions=KubernetesRetriableException)[0m
[30;1m770 | [0m[35m        self._ttl = int(config.get('ttl') or 30)[0m
[30;1m771 | [0m[35m        try:[0m
[30;1m772 | [0m[35m            k8s_config.load_incluster_config(ca_certs=self._ca_certs)[0m
[30;1m773 | [0m[35m        except k8s_config.ConfigException:[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m
[30;1m761 | [0m[35m        self._standby_leader_label_value = config.get('standby_leader_label_value', 'primary')[0m
[30;1m762 | [0m[35m        self._tmp_role_label = config.get('tmp_role_label')[0m
[30;1m763 | [0m[35m        self._ca_certs = os.environ.get('PATRONI_KUBERNETES_CACERT', config.get('cacert')) or SERVIC[0m
[30;1m764 | [0m[35m        super(Kubernetes, self).__init__({**config, 'namespace': ''}, mpp)[0m
[30;1m765 | [0m[35m        if self._mpp.is_enabled():[0m
[30;1m766 | [0m[35m            self._labels[self._mpp.k8s_group_label] = str(self._mpp.group)[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m
[30;1m761 | [0m[35m        self._standby_leader_label_value = config.get('standby_leader_label_value', 'primary')[0m
[30;1m762 | [0m[35m        self._tmp_role_label = config.get('tmp_role_label')[0m
[30;1m763 | [0m[35m        self._ca_certs = os.environ.get('PATRONI_KUBERNETES_CACERT', config.get('cacert')) or SERVIC[0m
[30;1m764 | [0m[35m        super(Kubernetes, self).__init__({**config, 'namespace': ''}, mpp)[0m
[30;1m765 | [0m[35m        if self._mpp.is_enabled():[0m
[30;1m766 | [0m[35m            self._labels[self._mpp.k8s_group_label] = str(self._mpp.group)[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m759 | [0m[35m        self._leader_label_value = config.get('leader_label_value', 'primary')[0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m
[30;1m761 | [0m[35m        self._standby_leader_label_value = config.get('standby_leader_label_value', 'primary')[0m
[30;1m762 | [0m[35m        self._tmp_role_label = config.get('tmp_role_label')[0m
[30;1m763 | [0m[35m        self._ca_certs = os.environ.get('PATRONI_KUBERNETES_CACERT', config.get('cacert')) or SERVIC[0m
[30;1m764 | [0m[35m        super(Kubernetes, self).__init__({**config, 'namespace': ''}, mpp)[0m
[30;1m765 | [0m[35m        if self._mpp.is_enabled():[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m758 | [0m[35m        self._role_label = config.get('role_label', 'role')[0m
[30;1m759 | [0m[35m        self._leader_label_value = config.get('leader_label_value', 'primary')[0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m
[30;1m761 | [0m[35m        self._standby_leader_label_value = config.get('standby_leader_label_value', 'primary')[0m
[30;1m762 | [0m[35m        self._tmp_role_label = config.get('tmp_role_label')[0m
[30;1m763 | [0m[35m        self._ca_certs = os.environ.get('PATRONI_KUBERNETES_CACERT', config.get('cacert')) or SERVIC[0m
[30;1m764 | [0m[35m        super(Kubernetes, self).__init__({**config, 'namespace': ''}, mpp)[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m757 | [0m[35m        self._namespace = config.get('namespace') or 'default'[0m
[30;1m758 | [0m[35m        self._role_label = config.get('role_label', 'role')[0m
[30;1m759 | [0m[35m        self._leader_label_value = config.get('leader_label_value', 'primary')[0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m
[30;1m761 | [0m[35m        self._standby_leader_label_value = config.get('standby_leader_label_value', 'primary')[0m
[30;1m762 | [0m[35m        self._tmp_role_label = config.get('tmp_role_label')[0m
[30;1m763 | [0m[35m        self._ca_certs = os.environ.get('PATRONI_KUBERNETES_CACERT', config.get('cacert')) or SERVIC[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m756 | [0m[35m        self._label_selector = ','.join('{0}={1}'.format(k, v) for k, v in self._labels.items())[0m
[30;1m757 | [0m[35m        self._namespace = config.get('namespace') or 'default'[0m
[30;1m758 | [0m[35m        self._role_label = config.get('role_label', 'role')[0m
[30;1m759 | [0m[35m        self._leader_label_value = config.get('leader_label_value', 'primary')[0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m
[30;1m761 | [0m[35m        self._standby_leader_label_value = config.get('standby_leader_label_value', 'primary')[0m
[30;1m762 | [0m[35m        self._tmp_role_label = config.get('tmp_role_label')[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m755 | [0m[35m        self._labels[config.get('scope_label', 'cluster-name')] = config['scope'][0m
[30;1m756 | [0m[35m        self._label_selector = ','.join('{0}={1}'.format(k, v) for k, v in self._labels.items())[0m
[30;1m757 | [0m[35m        self._namespace = config.get('namespace') or 'default'[0m
[30;1m758 | [0m[35m        self._role_label = config.get('role_label', 'role')[0m
[30;1m759 | [0m[35m        self._leader_label_value = config.get('leader_label_value', 'primary')[0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m
[30;1m761 | [0m[35m        self._standby_leader_label_value = config.get('standby_leader_label_value', 'primary')[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m754 | [0m[35m        self._labels = deepcopy(config['labels'])[0m
[30;1m755 | [0m[35m        self._labels[config.get('scope_label', 'cluster-name')] = config['scope'][0m
[30;1m756 | [0m[35m        self._label_selector = ','.join('{0}={1}'.format(k, v) for k, v in self._labels.items())[0m
[30;1m757 | [0m[35m        self._namespace = config.get('namespace') or 'default'[0m
[30;1m758 | [0m[35m        self._role_label = config.get('role_label', 'role')[0m
[30;1m759 | [0m[35m        self._leader_label_value = config.get('leader_label_value', 'primary')[0m
[30;1m760 | [0m[35m        self._follower_label_value = config.get('follower_label_value', 'replica')[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m752 | [0m[35m[0m
[30;1m753 | [0m[35m    def __init__(self, config: Dict[str, Any], mpp: AbstractMPP) -> None:[0m
[30;1m754 | [0m[35m        self._labels = deepcopy(config['labels'])[0m
[30;1m755 | [0m[35m        self._labels[config.get('scope_label', 'cluster-name')] = config['scope'][0m
[30;1m756 | [0m[35m        self._label_selector = ','.join('{0}={1}'.format(k, v) for k, v in self._labels.items())[0m
[30;1m757 | [0m[35m        self._namespace = config.get('namespace') or 'default'[0m
[30;1m758 | [0m[35m        self._role_label = config.get('role_label', 'role')[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m697 | [0m[35m            return self._finish_response(response)[0m
[30;1m698 | [0m[35m[0m
[30;1m699 | [0m[35m        for event in iter_response_objects(response):[0m
[30;1m700 | [0m[35m            if event['object'].get('code') == 410:[0m
[30;1m701 | [0m[35m                break[0m
[30;1m702 | [0m[35m            self._process_event(event)[0m
[30;1m703 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m666 | [0m[35m[0m
[30;1m667 | [0m[35m        if success and obj.get('kind') != 'Pod':[0m
[30;1m668 | [0m[35m            if old_value:[0m
[30;1m669 | [0m[35m                old_value = (old_value.metadata.annotations or EMPTY_DICT).get(self._annotations_map[0m
[30;1m670 | [0m[35m[0m
[30;1m671 | [0m[35m            value_changed = old_value != new_value and \[0m
[30;1m672 | [0m[35m                (name != self._dcs.config_path or old_value is not None and new_value is not None)[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m666 | [0m[35m[0m
[30;1m667 | [0m[35m        if success and obj.get('kind') != 'Pod':[0m
[30;1m668 | [0m[35m            if old_value:[0m
[30;1m669 | [0m[35m                old_value = (old_value.metadata.annotations or EMPTY_DICT).get(self._annotations_map[0m
[30;1m670 | [0m[35m[0m
[30;1m671 | [0m[35m            value_changed = old_value != new_value and \[0m
[30;1m672 | [0m[35m                (name != self._dcs.config_path or old_value is not None and new_value is not None)[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m664 | [0m[35m        else:[0m
[30;1m665 | [0m[35m            return logger.warning('Unexpected event type: %s', ev_type)[0m
[30;1m666 | [0m[35m[0m
[30;1m667 | [0m[35m        if success and obj.get('kind') != 'Pod':[0m
[30;1m668 | [0m[35m            if old_value:[0m
[30;1m669 | [0m[35m                old_value = (old_value.metadata.annotations or EMPTY_DICT).get(self._annotations_map[0m
[30;1m670 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m658 | [0m[35m            obj = K8sObject(obj)[0m
[30;1m659 | [0m[35m            success, old_value = self.set(name, obj)[0m
[30;1m660 | [0m[35m            if success:[0m
[30;1m661 | [0m[35m                new_value = (obj.metadata.annotations or EMPTY_DICT).get(self._annotations_map.get(n[0m
[30;1m662 | [0m[35m        elif ev_type == 'DELETED':[0m
[30;1m663 | [0m[35m            success, old_value = self.delete(name, obj['metadata']['resourceVersion'])[0m
[30;1m664 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m658 | [0m[35m            obj = K8sObject(obj)[0m
[30;1m659 | [0m[35m            success, old_value = self.set(name, obj)[0m
[30;1m660 | [0m[35m            if success:[0m
[30;1m661 | [0m[35m                new_value = (obj.metadata.annotations or EMPTY_DICT).get(self._annotations_map.get(n[0m
[30;1m662 | [0m[35m        elif ev_type == 'DELETED':[0m
[30;1m663 | [0m[35m            success, old_value = self.delete(name, obj['metadata']['resourceVersion'])[0m
[30;1m664 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m646 | [0m[35m[0m
[30;1m647 | [0m[35m    def get(self, name: str) -> Optional[K8sObject]:[0m
[30;1m648 | [0m[35m        with self._object_cache_lock:[0m
[30;1m649 | [0m[35m            return self._object_cache.get(name)[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m    def _process_event(self, event: Dict[str, Any]) -> None:[0m
[30;1m652 | [0m[35m        ev_type = event['type'][0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m[0m
[30;1m635 | [0m[35m    def delete(self, name: str, resource_version: str) -> Tuple[bool, Optional[K8sObject]]:[0m
[30;1m636 | [0m[35m        with self._object_cache_lock:[0m
[30;1m637 | [0m[35m            old_value = self._object_cache.get(name)[0m
[30;1m638 | [0m[35m            ret = old_value and int(old_value.metadata.resource_version) < int(resource_version)[0m
[30;1m639 | [0m[35m            if ret:[0m
[30;1m640 | [0m[35m                del self._object_cache[name][0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m    def set(self, name: str, value: K8sObject) -> Tuple[bool, Optional[K8sObject]]:[0m
[30;1m628 | [0m[35m        with self._object_cache_lock:[0m
[30;1m629 | [0m[35m            old_value = self._object_cache.get(name)[0m
[30;1m630 | [0m[35m            ret = not old_value or int(old_value.metadata.resource_version) < int(value.metadata.res[0m
[30;1m631 | [0m[35m            if ret:[0m
[30;1m632 | [0m[35m                self._object_cache[name] = value[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m513 | [0m[35m    @property[0m
[30;1m514 | [0m[35m    def sleeptime(self) -> Optional[int]:[0m
[30;1m515 | [0m[35m        try:[0m
[30;1m516 | [0m[35m            return int((self.headers or EMPTY_DICT).get('retry-after', ''))[0m
[30;1m517 | [0m[35m        except Exception:[0m
[30;1m518 | [0m[35m            return None[0m
[30;1m519 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m            def wrapper(*args: Any, **kwargs: Any) -> Union[urllib3.HTTPResponse, K8sObject]:[0m
[30;1m464 | [0m[35m                method = {'read': 'GET', 'list': 'GET', 'create': 'POST',[0m
[30;1m465 | [0m[35m                          'replace': 'PUT'}.get(action, action.split('_')[0]).upper()[0m
[30;1m466 | [0m[35m[0m
[30;1m467 | [0m[35m                if action == 'create' or len(args) == 1:  # namespace is a first argument and name i[0m
[30;1m468 | [0m[35m                    path = '/'.join([args[0], kind])[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m445 | [0m[35m            fields = {to_camel_case(k): v for k, v in kwargs.items()}  # resource_version => resourc[0m
[30;1m446 | [0m[35m            body = json.dumps(body, default=lambda o: o.to_dict()) if body is not None else None[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m            response = self.request(_retry, method, self._API_URL_PREFIX + path, headers=headers, fi[0m
[30;1m449 | [0m[35m                                    body=body, preload_content=_preload_content, timeout=_request_ti[0m
[30;1m450 | [0m[35m[0m
[30;1m451 | [0m[35m            return self._handle_server_response(response, _preload_content)[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m                if i > 0:[0m
[30;1m375 | [0m[35m                    logger.info('Retrying on %s', base_uri)[0m
[30;1m376 | [0m[35m                try:[0m
[30;1m377 | [0m[35m                    response = self.pool_manager.request(method, base_uri + path, **kwargs)[0m
[30;1m378 | [0m[35m                    if some_request_failed:[0m
[30;1m379 | [0m[35m                        self.set_base_uri(base_uri)[0m
[30;1m380 | [0m[35m                        self._refresh_api_servers_cache()[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m289 | [0m[35m            path = self._API_URL_PREFIX + 'default/endpoints/kubernetes'[0m
[30;1m290 | [0m[35m            for base_uri in api_servers_cache:[0m
[30;1m291 | [0m[35m                try:[0m
[30;1m292 | [0m[35m                    response = self.pool_manager.request('GET', base_uri + path, headers=headers, **[0m
[30;1m293 | [0m[35m                    endpoint = self._handle_server_response(response, True)[0m
[30;1m294 | [0m[35m                    if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m295 | [0m[35m                        assert isinstance(endpoint, K8sObject)[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        return self._dict.get(name, default)[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    def __getattr__(self, name: str) -> Any:[0m
[30;1m187 | [0m[35m        return self.get(to_camel_case(name))[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    @classmethod[0m
[30;1m190 | [0m[35m    def _wrap(cls, parent: Optional[str], value: Any) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m        self._dict = {k: self._wrap(k, v) for k, v in kwargs.items()}[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    def get(self, name: str, default: Optional[Any] = None) -> Optional[Any]:[0m
[30;1m184 | [0m[35m        return self._dict.get(name, default)[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    def __getattr__(self, name: str) -> Any:[0m
[30;1m187 | [0m[35m        return self.get(to_camel_case(name))[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m            self._pool_config_from_file_or_data(user, 'client-key', 'key_file')[0m
[30;1m157 | [0m[35m            self._pool_config_from_file_or_data(cluster, 'certificate-authority', 'ca_certs')[0m
[30;1m158 | [0m[35m            self.pool_config['cert_reqs'] = 'CERT_NONE' if cluster.get('insecure-skip-tls-verify') e[0m
[30;1m159 | [0m[35m        if user.get('token'):[0m
[30;1m160 | [0m[35m            self._make_headers(token=user['token'])[0m
[30;1m161 | [0m[35m        elif 'username' in user and 'password' in user:[0m
[30;1m162 | [0m[35m            self._make_headers(basic_auth=':'.join((user['username'], user['password'])))[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m            self._pool_config_from_file_or_data(user, 'client-certificate', 'cert_file')[0m
[30;1m156 | [0m[35m            self._pool_config_from_file_or_data(user, 'client-key', 'key_file')[0m
[30;1m157 | [0m[35m            self._pool_config_from_file_or_data(cluster, 'certificate-authority', 'ca_certs')[0m
[30;1m158 | [0m[35m            self.pool_config['cert_reqs'] = 'CERT_NONE' if cluster.get('insecure-skip-tls-verify') e[0m
[30;1m159 | [0m[35m        if user.get('token'):[0m
[30;1m160 | [0m[35m            self._make_headers(token=user['token'])[0m
[30;1m161 | [0m[35m        elif 'username' in user and 'password' in user:[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mKUBE_CONFIG_DEFAULT_LOCATION = os.environ.get('KUBECONFIG', '~/.kube/config')[0m
[30;1m37 | [0m[35mSERVICE_HOST_ENV_NAME = 'KUBERNETES_SERVICE_HOST'[0m
[30;1m38 | [0m[35mSERVICE_PORT_ENV_NAME = 'KUBERNETES_SERVICE_PORT'[0m
[30;1m39 | [0m[35mSERVICE_TOKEN_FILENAME = '/var/run/secrets/kubernetes.io/serviceaccount/token'[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1403 | [0m[35m        """Patch annotations of $SCOPE-sync Endpoint or ConfigMap with empty values.[0m
[30;1m1404 | [0m[35m[0m
[30;1m1405 | [0m[35m        Effectively it removes "leader" and "sync_standby" annotations from the object.[0m
[30;1m1406 | [0m[35m        :param version: last known `resource_version` for conditional update of the object[0m
[30;1m1407 | [0m[35m        :returns: `True` if "delete" was successful[0m
[30;1m1408 | [0m[35m        """[0m
[30;1m1409 | [0m[35m        return self.write_sync_state(None, None, None, version=version) is not None[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1390 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names[0m
[30;1m1391 | [0m[35m        :param quorum: if the node from sync_standby list is doing a leader race it should[0m
[30;1m1392 | [0m[35m                       see at least quorum other nodes from the sync_standby + leader list[0m
[30;1m1393 | [0m[35m        :param version: last known `resource_version` for conditional update of the object[0m
[30;1m1394 | [0m[35m        :returns: the new :class:`SyncState` object or None[0m
[30;1m1395 | [0m[35m        """[0m
[30;1m1396 | [0m[35m        sync_state = self.sync_state(leader, sync_standby, quorum)[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1389 | [0m[35m        :param leader: name of the leader node that manages /sync key[0m
[30;1m1390 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names[0m
[30;1m1391 | [0m[35m        :param quorum: if the node from sync_standby list is doing a leader race it should[0m
[30;1m1392 | [0m[35m                       see at least quorum other nodes from the sync_standby + leader list[0m
[30;1m1393 | [0m[35m        :param version: last known `resource_version` for conditional update of the object[0m
[30;1m1394 | [0m[35m        :returns: the new :class:`SyncState` object or None[0m
[30;1m1395 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1222 | [0m[35m        if kind and (kind_annotations.get(self._LEADER) != self._name or kind_resource_version == re[0m
[30;1m1223 | [0m[35m            return False[0m
[30;1m1224 | [0m[35m[0m
[30;1m1225 | [0m[35m        # We can get 409 because we do at least one retry, and the first update might have succeeded[0m
[30;1m1226 | [0m[35m        # therefore we will check if annotations on the read object match expectations.[0m
[30;1m1227 | [0m[35m        if all(kind_annotations.get(k) == v for k, v in annotations.items()):[0m
[30;1m1228 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1222 | [0m[35m        if kind and (kind_annotations.get(self._LEADER) != self._name or kind_resource_version == re[0m
[30;1m1223 | [0m[35m            return False[0m
[30;1m1224 | [0m[35m[0m
[30;1m1225 | [0m[35m        # We can get 409 because we do at least one retry, and the first update might have succeeded[0m
[30;1m1226 | [0m[35m        # therefore we will check if annotations on the read object match expectations.[0m
[30;1m1227 | [0m[35m        if all(kind_annotations.get(k) == v for k, v in annotations.items()):[0m
[30;1m1228 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1200 | [0m[35m        except (RetryFailedError, K8sException) as e:[0m
[30;1m1201 | [0m[35m            raise KubernetesError(e)[0m
[30;1m1202 | [0m[35m[0m
[30;1m1203 | [0m[35m        # if we are here, that means update failed with 409[0m
[30;1m1204 | [0m[35m        if not retry.ensure_deadline(1):[0m
[30;1m1205 | [0m[35m            return False  # No time for retry. Tell ha.py that we have to demote due to failed updat[0m
[30;1m1206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1193 | [0m[35m            return bool(self._patch_or_create(self.leader_path, annotations, resource_version, ips=i[0m
[30;1m1194 | [0m[35m        except k8s_client.rest.ApiException as e:[0m
[30;1m1195 | [0m[35m            if e.status == 409:[0m
[30;1m1196 | [0m[35m                logger.warning('Concurrent update of %s', self.leader_path)[0m
[30;1m1197 | [0m[35m            else:[0m
[30;1m1198 | [0m[35m                logger.exception('Permission denied' if e.status == 403 else 'Unexpected error from [0m
[30;1m1199 | [0m[35m                return False[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m901 | [0m[35m        # get leader[0m
[30;1m902 | [0m[35m        leader_record: Dict[str, str] = {n: annotations[n] for n in (self._LEADER, 'acquireTime',[0m
[30;1m903 | [0m[35m                                         'ttl', 'renewTime', 'transitions') if n in annotations}[0m
[30;1m904 | [0m[35m        # We want to memorize leader_observed_record and update leader_observed_time only for our cl[0m
[30;1m905 | [0m[35m        if leader_path == self.leader_path and (leader_record or self._leader_observed_record)\[0m
[30;1m906 | [0m[35m                and leader_record != self._leader_observed_record:[0m
[30;1m907 | [0m[35m            self._leader_observed_record = leader_record[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m674 | [0m[35m            if value_changed:[0m
[30;1m675 | [0m[35m                logger.debug('%s changed from %s to %s', name, old_value, new_value)[0m
[30;1m676 | [0m[35m[0m
[30;1m677 | [0m[35m            # Do not wake up HA loop if we run as leader and received leader object update event[0m
[30;1m678 | [0m[35m            if value_changed or name == self._dcs.leader_path and self._name != new_value:[0m
[30;1m679 | [0m[35m                self._dcs.event.set()[0m
[30;1m680 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m421 | [0m[35m                        api_servers_cache = self.api_servers_cache[0m
[30;1m422 | [0m[35m                        api_servers = len(api_servers_cache)[0m
[30;1m423 | [0m[35m                    except Exception as e:[0m
[30;1m424 | [0m[35m                        logger.debug('Failed to update list of K8s master nodes: %r', e)[0m
[30;1m425 | [0m[35m[0m
[30;1m426 | [0m[35m                    if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m427 | [0m[35m                        assert isinstance(retry, Retry)  # K8sConnectionFailed is raised only if ret[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m.hostname[0m
[30;1m1073 | [0m[35m        leader_ip = ips[0] or pod and pod.status.pod_ip[0m
[30;1m1074 | [0m[35m        # don't touch subsets if our (leader) ip is unknown or subsets is valid[0m
[30;1m1075 | [0m[35m        if leader_ip and self.subsets_changed(latest_subsets, leader_ip, self.__ports):[0m
[30;1m1076 | [0m[35m            kwargs = {'hostname': pod.spec.hostname, 'node_name': pod.spec.node_name,[0m
[30;1m1077 | [0m[35m                      'target_ref': self.__target_ref(leader_ip, latest_subsets, pod)} if pod else {[0m
[30;1m1078 | [0m[35m            address = k8s_client.V1EndpointAddress(ip=leader_ip, **kwargs)[0m
[30;1m1079 | [0m[35m            endpoints['subsets'] = [k8s_client.V1EndpointSubset(addresses=[address], ports=self.__po[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m.hostname[0m
[30;1m1073 | [0m[35m        leader_ip = ips[0] or pod and pod.status.pod_ip[0m
[30;1m1074 | [0m[35m        # don't touch subsets if our (leader) ip is unknown or subsets is valid[0m
[30;1m1075 | [0m[35m        if leader_ip and self.subsets_changed(latest_subsets, leader_ip, self.__ports):[0m
[30;1m1076 | [0m[35m            kwargs = {'hostname': pod.spec.hostname, 'node_name': pod.spec.node_name,[0m
[30;1m1077 | [0m[35m                      'target_ref': self.__target_ref(leader_ip, latest_subsets, pod)} if pod else {[0m
[30;1m1078 | [0m[35m            address = k8s_client.V1EndpointAddress(ip=leader_ip, **kwargs)[0m
[30;1m1079 | [0m[35m            endpoints['subsets'] = [k8s_client.V1EndpointSubset(addresses=[address], ports=self.__po[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m.hostname[0m
[30;1m260 | [0m[35m        def set_base_uri(self, value: str) -> None:[0m
[30;1m261 | [0m[35m            logger.info('Selected new K8s API server endpoint %s', value)[0m
[30;1m262 | [0m[35m            # We will connect by IP of the K8s master node which is not listed as alternative name[0m
[30;1m263 | [0m[35m            self.pool_manager.connection_pool_kw['assert_hostname'] = False[0m
[30;1m264 | [0m[35m            self._base_uri = value[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1415 | [0m[35m[0m
[30;1m1416 | [0m[35m        # We want to give a bit more time to non-leader nodes to synchronize HA loops[0m
[30;1m1417 | [0m[35m        if leader_version:[0m
[30;1m1418 | [0m[35m            timeout += 0.5[0m
[30;1m1419 | [0m[35m[0m
[30;1m1420 | [0m[35m        try:[0m
[30;1m1421 | [0m[35m            return super(Kubernetes, self).watch(None, timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1413 | [0m[35m            self.__do_not_watch = False[0m
[30;1m1414 | [0m[35m            return True[0m
[30;1m1415 | [0m[35m[0m
[30;1m1416 | [0m[35m        # We want to give a bit more time to non-leader nodes to synchronize HA loops[0m
[30;1m1417 | [0m[35m        if leader_version:[0m
[30;1m1418 | [0m[35m            timeout += 0.5[0m
[30;1m1419 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1388 | [0m[35m[0m
[30;1m1389 | [0m[35m        :param leader: name of the leader node that manages /sync key[0m
[30;1m1390 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names[0m
[30;1m1391 | [0m[35m        :param quorum: if the node from sync_standby list is doing a leader race it should[0m
[30;1m1392 | [0m[35m                       see at least quorum other nodes from the sync_standby + leader list[0m
[30;1m1393 | [0m[35m        :param version: last known `resource_version` for conditional update of the object[0m
[30;1m1394 | [0m[35m        :returns: the new :class:`SyncState` object or None[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1387 | [0m[35m        """Prepare and write annotations to $SCOPE-sync Endpoint or ConfigMap.[0m
[30;1m1388 | [0m[35m[0m
[30;1m1389 | [0m[35m        :param leader: name of the leader node that manages /sync key[0m
[30;1m1390 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names[0m
[30;1m1391 | [0m[35m        :param quorum: if the node from sync_standby list is doing a leader race it should[0m
[30;1m1392 | [0m[35m                       see at least quorum other nodes from the sync_standby + leader list[0m
[30;1m1393 | [0m[35m        :param version: last known `resource_version` for conditional update of the object[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1386 | [0m[35m                         quorum: Optional[int], version: Optional[str] = None) -> Optional[SyncState[0m
[30;1m1387 | [0m[35m        """Prepare and write annotations to $SCOPE-sync Endpoint or ConfigMap.[0m
[30;1m1388 | [0m[35m[0m
[30;1m1389 | [0m[35m        :param leader: name of the leader node that manages /sync key[0m
[30;1m1390 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names[0m
[30;1m1391 | [0m[35m        :param quorum: if the node from sync_standby list is doing a leader race it should[0m
[30;1m1392 | [0m[35m                       see at least quorum other nodes from the sync_standby + leader list[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1202 | [0m[35m[0m
[30;1m1203 | [0m[35m        # if we are here, that means update failed with 409[0m
[30;1m1204 | [0m[35m        if not retry.ensure_deadline(1):[0m
[30;1m1205 | [0m[35m            return False  # No time for retry. Tell ha.py that we have to demote due to failed updat[0m
[30;1m1206 | [0m[35m[0m
[30;1m1207 | [0m[35m        # Try to get the latest version directly from K8s API instead of relying on async cache[0m
[30;1m1208 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1153 | [0m[35m            if not self._api.create_namespaced_service(self._namespace, body):[0m
[30;1m1154 | [0m[35m                return[0m
[30;1m1155 | [0m[35m        except Exception as e:[0m
[30;1m1156 | [0m[35m            # 409 - service already exists, 403 - creation forbidden[0m
[30;1m1157 | [0m[35m            if not isinstance(e, k8s_client.rest.ApiException) or e.status not in (409, 403):[0m
[30;1m1158 | [0m[35m                return logger.exception('create_config_service failed')[0m
[30;1m1159 | [0m[35m        self._should_create_config_service = False[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1140 | [0m[35m[0m
[30;1m1141 | [0m[35m    def patch_or_create_config(self, annotations: Dict[str, Any],[0m
[30;1m1142 | [0m[35m                               resource_version: Optional[str] = None, patch: bool = False, retry: b[0m
[30;1m1143 | [0m[35m        # SCOPE-config endpoint requires corresponding service otherwise it might be "cleaned" by k8[0m
[30;1m1144 | [0m[35m        if self._api.use_endpoints and not patch and not resource_version:[0m
[30;1m1145 | [0m[35m            self._should_create_config_service = True[0m
[30;1m1146 | [0m[35m            self._create_config_service()[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1098 | [0m[35m[0m
[30;1m1099 | [0m[35m                    * ``['']`` - when we want to make sure that the subsets of the leader endpoint c[0m
[30;1m1100 | [0m[35m                      address of the leader, but ``kubernetes.pod_ip`` configuration is missing. In [0m
[30;1m1101 | [0m[35m                      try to take the IP address of the Pod which name matches ``name`` from the con[0m
[30;1m1102 | [0m[35m[0m
[30;1m1103 | [0m[35m        :returns: the new :class:`V1Endpoints` or :class:`V1ConfigMap` object, that was created or u[0m
[30;1m1104 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1096 | [0m[35m.add.re.ss']`` - when we want to make sure that the subsets of the leader endpoint[0m
[30;1m1097 | [0m[35m                      contains the IP address of the leader, that we get from the ``kubernetes.pod_i[0m
[30;1m1098 | [0m[35m[0m
[30;1m1099 | [0m[35m                    * ``['']`` - when we want to make sure that the subsets of the leader endpoint c[0m
[30;1m1100 | [0m[35m                      address of the leader, but ``kubernetes.pod_ip`` configuration is missing. In [0m
[30;1m1101 | [0m[35m                      try to take the IP address of the Pod which name matches ``name`` from the con[0m
[30;1m1102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1094 | [0m[35m                    * ``[]`` - to set subsets to the empty list, when :meth:`delete_leader` method i[0m
[30;1m1095 | [0m[35m[0m
[30;1m1096 | [0m[35m                    * ``['ip.add.re.ss']`` - when we want to make sure that the subsets of the leade[0m
[30;1m1097 | [0m[35m                      contains the IP address of the leader, that we get from the ``kubernetes.pod_i[0m
[30;1m1098 | [0m[35m[0m
[30;1m1099 | [0m[35m                    * ``['']`` - when we want to make sure that the subsets of the leader endpoint c[0m
[30;1m1100 | [0m[35m                      address of the leader, but ``kubernetes.pod_ip`` configuration is missing. In [0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1088 | [0m[35m        :param resource_version: object should be updated only if the ``resource_version`` matches p[0m
[30;1m1089 | [0m[35m        :param patch: ``True`` if we know in advance that the object already exists and we should pa[0m
[30;1m1090 | [0m[35m        :param retry: a callable that will take care of retries[0m
[30;1m1091 | [0m[35m        :param ips: IP address that we want to put to the subsets of the endpoint. Could have follow[0m
[30;1m1092 | [0m[35m[0m
[30;1m1093 | [0m[35m                    * ``None`` - when we don't need to touch subset;[0m
[30;1m1094 | [0m[35m                    * ``[]`` - to set subsets to the empty list, when :meth:`delete_leader` method i[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1071 | [0m[35m[0m
[30;1m1072 | [0m[35m        pod = self._pods.get(self._name)[0m
[30;1m1073 | [0m[35m        leader_ip = ips[0] or pod and pod.status.pod_ip[0m
[30;1m1074 | [0m[35m        # don't touch subsets if our (leader) ip is unknown or subsets is valid[0m
[30;1m1075 | [0m[35m        if leader_ip and self.subsets_changed(latest_subsets, leader_ip, self.__ports):[0m
[30;1m1076 | [0m[35m            kwargs = {'hostname': pod.spec.hostname, 'node_name': pod.spec.node_name,[0m
[30;1m1077 | [0m[35m                      'target_ref': self.__target_ref(leader_ip, latest_subsets, pod)} if pod else {[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1038 | [0m[35m        if len(last_observed_subsets) != 1:[0m
[30;1m1039 | [0m[35m            return True[0m
[30;1m1040 | [0m[35m        if len(last_observed_subsets[0].addresses or []) != 1 or \[0m
[30;1m1041 | [0m[35m                last_observed_subsets[0].addresses[0].ip != ip or \[0m
[30;1m1042 | [0m[35m                len(last_observed_subsets[0].ports) != len(ports):[0m
[30;1m1043 | [0m[35m            return True[0m
[30;1m1044 | [0m[35m        if len(ports) == 1:[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1016 | [0m[35m    @staticmethod[0m
[30;1m1017 | [0m[35m    def subsets_changed(last_observed_subsets: List[K8sObject], ip: str, ports: List[K8sObject]) -> [0m
[30;1m1018 | [0m[35m        """[0m
[30;1m1019 | [0m[35m        >>> ip = '1.2.3.4'[0m
[30;1m1020 | [0m[35m        >>> a = [k8s_client.V1EndpointAddress(ip=ip)][0m
[30;1m1021 | [0m[35m        >>> s = [k8s_client.V1EndpointSubset(addresses=a)][0m
[30;1m1022 | [0m[35m        >>> Kubernetes.subsets_changed(s, '1.2.3.5', [])[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m997 | [0m[35m        """Load the PostgreSQL cluster for the MPP Coordinator.[0m
[30;1m998 | [0m[35m[0m
[30;1m999 | [0m[35m        .. note::[0m
[30;1m1000 | [0m[35m            This method is only executed on the worker nodes to find the coordinator.[0m
[30;1m1001 | [0m[35m[0m
[30;1m1002 | [0m[35m        :returns: Select :class:`Cluster` instance associated with the MPP Coordinator group ID.[0m
[30;1m1003 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m856 | [0m[35m    def _wait_caches(self, stop_time: float) -> None:[0m
[30;1m857 | [0m[35m        while not (self._pods.is_ready() and self._kinds.is_ready()):[0m
[30;1m858 | [0m[35m            timeout = stop_time - time.time()[0m
[30;1m859 | [0m[35m            if timeout <= 0:[0m
[30;1m860 | [0m[35m                raise RetryFailedError('Exceeded retry deadline')[0m
[30;1m861 | [0m[35m            self._condition.wait(timeout)[0m
[30;1m862 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m855 | [0m[35m[0m
[30;1m856 | [0m[35m    def _wait_caches(self, stop_time: float) -> None:[0m
[30;1m857 | [0m[35m        while not (self._pods.is_ready() and self._kinds.is_ready()):[0m
[30;1m858 | [0m[35m            timeout = stop_time - time.time()[0m
[30;1m859 | [0m[35m            if timeout <= 0:[0m
[30;1m860 | [0m[35m                raise RetryFailedError('Exceeded retry deadline')[0m
[30;1m861 | [0m[35m            self._condition.wait(timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m530 | [0m[35mTRIABLE_HTTP_CODES)[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m    def configure_timeouts(self, loop_wait: int, retry_timeout: Union[int, float], ttl: int) -> None[0m
[30;1m533 | [0m[35m        # Normally every loop_wait seconds we should have receive something from the socket.[0m
[30;1m534 | [0m[35m        # If we didn't received anything after the loop_wait + retry_timeout it is a time[0m
[30;1m535 | [0m[35m        # to start worrying (send keepalive messages). Finally, the connection should be[0m
[30;1m536 | [0m[35m        # considered as dead if we received nothing from the socket after the ttl seconds.[0m
[30;1m537 | [0m[35m        self._api_client.pool_manager.connection_pool_kw['socket_options'] = \[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m434 | [0m[35m                    retry.sleep_func(sleeptime)[0m
[30;1m435 | [0m[35m                    retry.update_delay()[0m
[30;1m436 | [0m[35m                    # We still have some time left. Partially reduce `api_servers_cache` and retry r[0m
[30;1m437 | [0m[35m                    kwargs.update(timeout=urllib3.Timeout(connect=max(1.0, timeout / 2.0), total=tim[0m
[30;1m438 | [0m[35m                                  retries=retries)[0m
[30;1m439 | [0m[35m                    api_servers_cache = api_servers_cache[:nodes][0m
[30;1m440 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m433 | [0m[35m                        raise ex[0m
[30;1m434 | [0m[35m                    retry.sleep_func(sleeptime)[0m
[30;1m435 | [0m[35m                    retry.update_delay()[0m
[30;1m436 | [0m[35m                    # We still have some time left. Partially reduce `api_servers_cache` and retry r[0m
[30;1m437 | [0m[35m                    kwargs.update(timeout=urllib3.Timeout(connect=max(1.0, timeout / 2.0), total=tim[0m
[30;1m438 | [0m[35m                                  retries=retries)[0m
[30;1m439 | [0m[35m                    api_servers_cache = api_servers_cache[:nodes][0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m409 | [0m[35m                retries = 0[0m
[30;1m410 | [0m[35m            else:[0m
[30;1m411 | [0m[35m                _, timeout, retries = self._calculate_timeouts(api_servers)[0m
[30;1m412 | [0m[35m                timeout = urllib3.Timeout(connect=max(1.0, timeout / 2.0), total=timeout)[0m
[30;1m413 | [0m[35m            kwargs.update(retries=retries, timeout=timeout)[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m            while True:[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m409 | [0m[35m                retries = 0[0m
[30;1m410 | [0m[35m            else:[0m
[30;1m411 | [0m[35m                _, timeout, retries = self._calculate_timeouts(api_servers)[0m
[30;1m412 | [0m[35m                timeout = urllib3.Timeout(connect=max(1.0, timeout / 2.0), total=timeout)[0m
[30;1m413 | [0m[35m            kwargs.update(retries=retries, timeout=timeout)[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m            while True:[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m405 | [0m[35m                if isinstance(timeout, (int, float)):[0m
[30;1m406 | [0m[35m                    timeout = urllib3.Timeout(total=timeout)[0m
[30;1m407 | [0m[35m                elif isinstance(timeout, tuple) and len(timeout) == 2:[0m
[30;1m408 | [0m[35m                    timeout = urllib3.Timeout(connect=timeout[0], read=timeout[1])[0m
[30;1m409 | [0m[35m                retries = 0[0m
[30;1m410 | [0m[35m            else:[0m
[30;1m411 | [0m[35m                _, timeout, retries = self._calculate_timeouts(api_servers)[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m            if timeout:[0m
[30;1m405 | [0m[35m                if isinstance(timeout, (int, float)):[0m
[30;1m406 | [0m[35m                    timeout = urllib3.Timeout(total=timeout)[0m
[30;1m407 | [0m[35m                elif isinstance(timeout, tuple) and len(timeout) == 2:[0m
[30;1m408 | [0m[35m                    timeout = urllib3.Timeout(connect=timeout[0], read=timeout[1])[0m
[30;1m409 | [0m[35m                retries = 0[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m382 | [0m[35m                except (HTTPError, HTTPException, socket.error, socket.timeout) as e:[0m
[30;1m383 | [0m[35m                    self.pool_manager.clear()[0m
[30;1m384 | [0m[35m                    if not retry:[0m
[30;1m385 | [0m[35m                        # switch to the next node if request failed and retry is not allowed[0m
[30;1m386 | [0m[35m                        if i + 1 < len(api_servers_cache):[0m
[30;1m387 | [0m[35m                            self.set_base_uri(api_servers_cache[i + 1])[0m
[30;1m388 | [0m[35m                        raise K8sException('{0} {1} request failed'.format(method, path))[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m361 | [0m[35m                        per_node_retries += 1[0m
[30;1m362 | [0m[35m                    per_node_timeout /= per_node_retries[0m
[30;1m363 | [0m[35m                    break[0m
[30;1m364 | [0m[35m                # if the timeout per one node is to small try to reduce number of nodes[0m
[30;1m365 | [0m[35m                api_servers -= 1[0m
[30;1m366 | [0m[35m                max_retries = 1[0m
[30;1m367 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m361 | [0m[35m                        per_node_retries += 1[0m
[30;1m362 | [0m[35m                    per_node_timeout /= per_node_retries[0m
[30;1m363 | [0m[35m                    break[0m
[30;1m364 | [0m[35m                # if the timeout per one node is to small try to reduce number of nodes[0m
[30;1m365 | [0m[35m                api_servers -= 1[0m
[30;1m366 | [0m[35m                max_retries = 1[0m
[30;1m367 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m356 | [0m[35m            while api_servers > 0:[0m
[30;1m357 | [0m[35m                per_node_timeout = float(timeout) / api_servers[0m
[30;1m358 | [0m[35m                if per_node_timeout >= min_timeout:[0m
[30;1m359 | [0m[35m                    # for small clusters we will try to do more than one try on every node[0m
[30;1m360 | [0m[35m                    while per_node_retries < max_retries and per_node_timeout / (per_node_retries + [0m
[30;1m361 | [0m[35m                        per_node_retries += 1[0m
[30;1m362 | [0m[35m                    per_node_timeout /= per_node_retries[0m
[30;1m363 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m347 | [0m[35m            For the cluster with only one API server node we will try to do 1 retry.[0m
[30;1m348 | [0m[35m            No retries for clusters with 2 or more API server nodes. We better rely on switching to [0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m            per_node_timeout = timeout = float(timeout or self._read_timeout)[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m            max_retries = 3 - min(api_servers, 2)[0m
[30;1m353 | [0m[35m            per_node_retries = 1[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m344 | [0m[35m= None) -> Tuple[int, float, int]:[0m
[30;1m345 | [0m[35m            """Calculate a request timeout and number of retries per single K8s API server node.[0m
[30;1m346 | [0m[35m            In case if the timeout per node is too small (less than one second) we will reduce the n[0m
[30;1m347 | [0m[35m            For the cluster with only one API server node we will try to do 1 retry.[0m
[30;1m348 | [0m[35m            No retries for clusters with 2 or more API server nodes. We better rely on switching to [0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m            per_node_timeout = timeout = float(timeout or self._read_timeout)[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m            max_retries = 3 - min(api_servers, 2)[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        def _calculate_timeouts(self, api_servers: int, timeout: Optional[float] = None) -> Tuple[in[0m
[30;1m345 | [0m[35m            """Calculate a request timeout and number of retries per single K8s API server node.[0m
[30;1m346 | [0m[35m            In case if the timeout per node is too small (less than one second) we will reduce the n[0m
[30;1m347 | [0m[35m            For the cluster with only one API server node we will try to do 1 retry.[0m
[30;1m348 | [0m[35m            No retries for clusters with 2 or more API server nodes. We better rely on switching to [0m
[30;1m349 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        def _calculate_timeouts(self, api_servers: int, timeout: Optional[float] = None) -> Tuple[in[0m
[30;1m345 | [0m[35m            """Calculate a request timeout and number of retries per single K8s API server node.[0m
[30;1m346 | [0m[35m            In case if the timeout per node is too small (less than one second) we will reduce the n[0m
[30;1m347 | [0m[35m            For the cluster with only one API server node we will try to do 1 retry.[0m
[30;1m348 | [0m[35m            No retries for clusters with 2 or more API server nodes. We better rely on switching to [0m
[30;1m349 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m            self._update_api_servers_cache = False[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        def _calculate_timeouts(self, api_servers: int, timeout: Optional[float] = None) -> Tuple[in[0m
[30;1m345 | [0m[35m            """Calculate a request timeout and number of retries per single K8s API server node.[0m
[30;1m346 | [0m[35m            In case if the timeout per node is too small (less than one second) we will reduce the n[0m
[30;1m347 | [0m[35m            For the cluster with only one API server node we will try to do 1 retry.[0m
[30;1m348 | [0m[35m            No retries for clusters with 2 or more API server nodes. We better rely on switching to [0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        def set_base_uri(self, value: str) -> None:[0m
[30;1m261 | [0m[35m            logger.info('Selected new K8s API server endpoint %s', value)[0m
[30;1m262 | [0m[35m            # We will connect by IP of the K8s master node which is not listed as alternative name[0m
[30;1m263 | [0m[35m            self.pool_manager.connection_pool_kw['assert_hostname'] = False[0m
[30;1m264 | [0m[35m            self._base_uri = value[0m
[30;1m265 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        def set_base_uri(self, value: str) -> None:[0m
[30;1m261 | [0m[35m            logger.info('Selected new K8s API server endpoint %s', value)[0m
[30;1m262 | [0m[35m            # We will connect by IP of the K8s master node which is not listed as alternative name[0m
[30;1m263 | [0m[35m            self.pool_manager.connection_pool_kw['assert_hostname'] = False[0m
[30;1m264 | [0m[35m            self._base_uri = value[0m
[30;1m265 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m                pass[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        def set_read_timeout(self, timeout: Union[int, float]) -> None:[0m
[30;1m255 | [0m[35m            self._read_timeout = timeout[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m        def set_api_servers_cache_ttl(self, ttl: int) -> None:[0m
[30;1m258 | [0m[35m            self._api_servers_cache_ttl = ttl - 0.5[0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m            try:[0m
[30;1m172 | [0m[35m                self._set_token(self._read_token_file())[0m
[30;1m173 | [0m[35m            except Exception as e:[0m
[30;1m174 | [0m[35m                logger.error('Failed to refresh service account token: %r', e)[0m
[30;1m175 | [0m[35m        return self._headers.copy()[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport random[0m
[30;1m9 | [0m[35mimport socket[0m
[30;1m10 | [0m[35mimport tempfile[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom collections import defaultdict[0m
[30;1m14 | [0m[35mfrom copy import deepcopy[0m
[30;1m15 | [0m[35mfrom http.client import HTTPException[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport atexit[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport datetime[0m
[30;1m4 | [0m[35mimport functools[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m                if self._running_custom_bootstrap:[0m
[30;1m462 | [0m[35m                    self._running_custom_bootstrap = False[0m
[30;1m463 | [0m[35m                    # If we don't have custom configuration for pg_hba.conf we need to restore origi[0m
[30;1m464 | [0m[35m                    if not postgresql.config.get('pg_hba'):[0m
[30;1m465 | [0m[35m                        if os.path.exists(postgresql.config.pg_hba_conf):[0m
[30;1m466 | [0m[35m                            os.unlink(postgresql.config.pg_hba_conf)[0m
[30;1m467 | [0m[35m                        postgresql.config.restore_configuration_files()[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m452 | [0m[35mEND;$$""".format(f, quote_ident(rewind['username'], postgresql.connection()))[0m
[30;1m453 | [0m[35m                        postgresql.query(sql)[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m                if config.get('users'):[0m
[30;1m456 | [0m[35m                    logger.error('User creation is not be supported starting from v4.0.0. '[0m
[30;1m457 | [0m[35m                                 'Please use "bootstrap.post_bootstrap" script to create users.')[0m
[30;1m458 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m                rewind = postgresql.config.rewind_credentials[0m
[30;1m444 | [0m[35m                if not deep_compare(rewind, superuser):[0m
[30;1m445 | [0m[35m                    self.create_or_update_role(rewind['username'], rewind.get('password'), [])[0m
[30;1m446 | [0m[35m                    for f in ('pg_ls_dir(text, boolean, boolean)', 'pg_stat_file(text, boolean)',[0m
[30;1m447 | [0m[35m                              'pg_read_binary_file(text)', 'pg_read_binary_file(text, bigint, bigint[0m
[30;1m448 | [0m[35m                        sql = """DO $$[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m438 | [0m[35m            task.complete(self.call_post_bootstrap(config))[0m
[30;1m439 | [0m[35m            if task.result:[0m
[30;1m440 | [0m[35m                replication = postgresql.config.replication[0m
[30;1m441 | [0m[35m                self.create_or_update_role(replication['username'], replication.get('password'), ['R[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m                rewind = postgresql.config.rewind_credentials[0m
[30;1m444 | [0m[35m                if not deep_compare(rewind, superuser):[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m        else:[0m
[30;1m394 | [0m[35m            method = 'initdb'[0m
[30;1m395 | [0m[35m            do_initialize = self._initdb[0m
[30;1m396 | [0m[35m        return do_initialize(config.get(method)) and self._postgresql.config.append_pg_hba(pg_hba) \[0m
[30;1m397 | [0m[35m            and self._postgresql.config.save_configuration_files() and bool(self._postgresql.start()[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m    def create_or_update_role(self, name: str, password: Optional[str], options: List[str]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m        pg_hba = config.get('pg_hba', [])[0m
[30;1m388 | [0m[35m        method = config.get('method') or 'initdb'[0m
[30;1m389 | [0m[35m        if method != 'initdb' and method in config and 'command' in config[method]:[0m
[30;1m390 | [0m[35m            self._keep_existing_recovery_conf = config[method].get('keep_existing_recovery_conf')[0m
[30;1m391 | [0m[35m            self._running_custom_bootstrap = True[0m
[30;1m392 | [0m[35m            do_initialize = self._custom_bootstrap[0m
[30;1m393 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m    def bootstrap(self, config: Dict[str, Any]) -> bool:[0m
[30;1m386 | [0m[35m        """ Initialize a new node from scratch and start it. """[0m
[30;1m387 | [0m[35m        pg_hba = config.get('pg_hba', [])[0m
[30;1m388 | [0m[35m        method = config.get('method') or 'initdb'[0m
[30;1m389 | [0m[35m        if method != 'initdb' and method in config and 'command' in config[method]:[0m
[30;1m390 | [0m[35m            self._keep_existing_recovery_conf = config[method].get('keep_existing_recovery_conf')[0m
[30;1m391 | [0m[35m            self._running_custom_bootstrap = True[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35m    def bootstrap(self, config: Dict[str, Any]) -> bool:[0m
[30;1m386 | [0m[35m        """ Initialize a new node from scratch and start it. """[0m
[30;1m387 | [0m[35m        pg_hba = config.get('pg_hba', [])[0m
[30;1m388 | [0m[35m        method = config.get('method') or 'initdb'[0m
[30;1m389 | [0m[35m        if method != 'initdb' and method in config and 'command' in config[method]:[0m
[30;1m390 | [0m[35m            self._keep_existing_recovery_conf = config[method].get('keep_existing_recovery_conf')[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m                    ret = 1[0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m                # replica creation method failed, clean up data directory if configuration allows[0m
[30;1m322 | [0m[35m                if not method_config.get('keep_data', False) and not self._postgresql.data_directory[0m
[30;1m323 | [0m[35m                    self._postgresql.remove_data_directory()[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        self._postgresql.set_state('stopped')[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m                    cmd = method_config.pop('command', cmd)[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m                # add the default parameters[0m
[30;1m298 | [0m[35m                if not method_config.get('no_params', False):[0m
[30;1m299 | [0m[35m                    method_config.update({"scope": self._postgresql.scope,[0m
[30;1m300 | [0m[35m                                          "role": "replica",[0m
[30;1m301 | [0m[35m                                          "datadir": self._postgresql.data_dir,[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m281 | [0m[35m                    break[0m
[30;1m282 | [0m[35m            else:[0m
[30;1m283 | [0m[35m                if not self._postgresql.data_directory_empty():[0m
[30;1m284 | [0m[35m                    if method_config.get('keep_data', False):[0m
[30;1m285 | [0m[35m                        logger.info('Leaving data directory uncleaned')[0m
[30;1m286 | [0m[35m                    else:[0m
[30;1m287 | [0m[35m                        self._postgresql.remove_data_directory()[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        """[0m
[30;1m214 | [0m[35m        runs a script after initdb or custom bootstrap script is called and waits until completion.[0m
[30;1m215 | [0m[35m        """[0m
[30;1m216 | [0m[35m        cmd = config.get('post_bootstrap') or config.get('post_init')[0m
[30;1m217 | [0m[35m        if cmd:[0m
[30;1m218 | [0m[35m            r = self._postgresql.connection_pool.conn_kwargs[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        """[0m
[30;1m214 | [0m[35m        runs a script after initdb or custom bootstrap script is called and waits until completion.[0m
[30;1m215 | [0m[35m        """[0m
[30;1m216 | [0m[35m        cmd = config.get('post_bootstrap') or config.get('post_init')[0m
[30;1m217 | [0m[35m        if cmd:[0m
[30;1m218 | [0m[35m            r = self._postgresql.connection_pool.conn_kwargs[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m            exited with code ``0``, ``False`` otherwise.[0m
[30;1m188 | [0m[35m        """[0m
[30;1m189 | [0m[35m        self._postgresql.set_state('running custom bootstrap script')[0m
[30;1m190 | [0m[35m        params = [] if config.get('no_params') else ['--scope=' + self._postgresql.scope,[0m
[30;1m191 | [0m[35m                                                     '--datadir=' + self._postgresql.data_dir][0m
[30;1m192 | [0m[35m        # Add custom parameters specified by the user[0m
[30;1m193 | [0m[35m        reserved_args = {'command', 'no_params', 'keep_existing_recovery_conf', 'recovery_conf', 'sc[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        # make sure there is no trigger file or postgres will be automatically promoted[0m
[30;1m149 | [0m[35m        trigger_file = self._postgresql.config.triggerfile_good_name[0m
[30;1m150 | [0m[35m        trigger_file = (self._postgresql.config.get('recovery_conf') or EMPTY_DICT).get(trigger_file[0m
[30;1m151 | [0m[35m        trigger_file = os.path.abspath(os.path.join(self._postgresql.data_dir, trigger_file))[0m
[30;1m152 | [0m[35m        if os.path.exists(trigger_file):[0m
[30;1m153 | [0m[35m            os.unlink(trigger_file)[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        # make sure there is no trigger file or postgres will be automatically promoted[0m
[30;1m149 | [0m[35m        trigger_file = self._postgresql.config.triggerfile_good_name[0m
[30;1m150 | [0m[35m        trigger_file = (self._postgresql.config.get('recovery_conf') or EMPTY_DICT).get(trigger_file[0m
[30;1m151 | [0m[35m        trigger_file = os.path.abspath(os.path.join(self._postgresql.data_dir, trigger_file))[0m
[30;1m152 | [0m[35m        if os.path.exists(trigger_file):[0m
[30;1m153 | [0m[35m            os.unlink(trigger_file)[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m468 | [0m[35m                    postgresql.config.write_postgresql_conf()[0m
[30;1m469 | [0m[35m                    postgresql.config.replace_pg_ident()[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m                    # at this point there should be no recovery.conf[0m
[30;1m472 | [0m[35m                    postgresql.config.remove_recovery_conf()[0m
[30;1m473 | [0m[35m[0m
[30;1m474 | [0m[35m                    if postgresql.config.hba_file:[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m336 | [0m[35m        not_allowed_options = ('pgdata', 'format', 'wal-method', 'xlog-method', 'gzip',[0m
[30;1m337 | [0m[35m                               'version', 'compress', 'dbname', 'host', 'port', 'username', 'passwor[0m
[30;1m338 | [0m[35m        user_options = self.process_user_options('basebackup', options, not_allowed_options, logger.[0m
[30;1m339 | [0m[35m        cmd = [[0m
[30;1m340 | [0m[35m            self._postgresql.pgcommand("pg_basebackup"),[0m
[30;1m341 | [0m[35m            "--pgdata=" + self._postgresql.data_dir,[0m
[30;1m342 | [0m[35m            "-X",[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m292 | [0m[35m                if method_config:[0m
[30;1m293 | [0m[35m                    # look to see if the user has supplied a full command path[0m
[30;1m294 | [0m[35m                    # if not, use the method name as the command[0m
[30;1m295 | [0m[35m                    cmd = method_config.pop('command', cmd)[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m                # add the default parameters[0m
[30;1m298 | [0m[35m                if not method_config.get('no_params', False):[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m286 | [0m[35m                    else:[0m
[30;1m287 | [0m[35m                        self._postgresql.remove_data_directory()[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m                cmd = replica_method[0m
[30;1m290 | [0m[35m                # user-defined method; check for configuration[0m
[30;1m291 | [0m[35m                # not required, actually[0m
[30;1m292 | [0m[35m                if method_config:[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m213 | [0m[35m        """[0m
[30;1m214 | [0m[35m        runs a script after initdb or custom bootstrap script is called and waits until completion.[0m
[30;1m215 | [0m[35m        """[0m
[30;1m216 | [0m[35m        cmd = config.get('post_bootstrap') or config.get('post_init')[0m
[30;1m217 | [0m[35m        if cmd:[0m
[30;1m218 | [0m[35m            r = self._postgresql.connection_pool.conn_kwargs[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m479 | [0m[35m                            postgresql.restart()[0m
[30;1m480 | [0m[35m                        else:[0m
[30;1m481 | [0m[35m                            postgresql.reload()[0m
[30;1m482 | [0m[35m                            time.sleep(1)  # give a time to postgres to "reload" configuration files[0m
[30;1m483 | [0m[35m                            postgresql.connection().close()  # close connection to reconnect with a [0m
[30;1m484 | [0m[35m                else:  # initdb[0m
[30;1m485 | [0m[35m                    # We may want create database and extension for some MPP clusters[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m                if config.get('users'):[0m
[30;1m456 | [0m[35m                    logger.error('User creation is not be supported starting from v4.0.0. '[0m
[30;1m457 | [0m[35m                                 'Please use "bootstrap.post_bootstrap" script to create users.')[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m                # We were doing a custom bootstrap instead of running initdb, therefore we opened tr[0m
[30;1m460 | [0m[35m                # access from certain addresses to be able to reach cluster and change password[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m383 | [0m[35m        return ret[0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35m    def bootstrap(self, config: Dict[str, Any]) -> bool:[0m
[30;1m386 | [0m[35m        """ Initialize a new node from scratch and start it. """[0m
[30;1m387 | [0m[35m        pg_hba = config.get('pg_hba', [])[0m
[30;1m388 | [0m[35m        method = config.get('method') or 'initdb'[0m
[30;1m389 | [0m[35m        if method != 'initdb' and method in config and 'command' in config[method]:[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m305 | [0m[35m                        method_config.pop(param, None)[0m
[30;1m306 | [0m[35m                params = ["--{0}={1}".format(arg, val) for arg, val in method_config.items()][0m
[30;1m307 | [0m[35m                try:[0m
[30;1m308 | [0m[35m                    # call script with the full set of parameters[0m
[30;1m309 | [0m[35m                    ret = self._postgresql.cancellable.call(shlex.split(cmd) + params, env=env)[0m
[30;1m310 | [0m[35m                    # if we succeeded, stop[0m
[30;1m311 | [0m[35m                    if ret == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m            connstring = self._postgresql.config.format_dsn({**r, 'password': None})[0m
[30;1m260 | [0m[35m        else:[0m
[30;1m261 | [0m[35m            connstring = ''[0m
[30;1m262 | [0m[35m            env = os.environ.copy()[0m
[30;1m263 | [0m[35m            # if we don't have any source, leave only replica methods that work without it[0m
[30;1m264 | [0m[35m            replica_methods = [r for r in replica_methods[0m
[30;1m265 | [0m[35m                               if self._postgresql.replica_method_can_work_without_replication_conne[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m        if clone_member and clone_member.conn_url:[0m
[30;1m256 | [0m[35m            r = clone_member.conn_kwargs(self._postgresql.config.replication)[0m
[30;1m257 | [0m[35m            # add the credentials to connect to the replica origin to pgpass.[0m
[30;1m258 | [0m[35m            env = self._postgresql.config.write_pgpass(r)[0m
[30;1m259 | [0m[35m            connstring = self._postgresql.config.format_dsn({**r, 'password': None})[0m
[30;1m260 | [0m[35m        else:[0m
[30;1m261 | [0m[35m            connstring = ''[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m                logger.error('post_init script %s failed', cmd)[0m
[30;1m231 | [0m[35m                return False[0m
[30;1m232 | [0m[35m            if ret != 0:[0m
[30;1m233 | [0m[35m                logger.error('post_init script %s returned non-zero code %d', cmd, ret)[0m
[30;1m234 | [0m[35m                return False[0m
[30;1m235 | [0m[35m        return True[0m
[30;1m236 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m            try:[0m
[30;1m228 | [0m[35m                ret = self._postgresql.cancellable.call(shlex.split(cmd) + [connstring], env=env)[0m
[30;1m229 | [0m[35m            except OSError:[0m
[30;1m230 | [0m[35m                logger.error('post_init script %s failed', cmd)[0m
[30;1m231 | [0m[35m                return False[0m
[30;1m232 | [0m[35m            if ret != 0:[0m
[30;1m233 | [0m[35m                logger.error('post_init script %s returned non-zero code %d', cmd, ret)[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m            # https://www.postgresql.org/docs/current/static/libpq-pgpass.html[0m
[30;1m221 | [0m[35m            # A host name of localhost matches both TCP (host name localhost) and Unix domain socket[0m
[30;1m222 | [0m[35m            # (pghost empty or the default socket directory) connections coming from the local machi[0m
[30;1m223 | [0m[35m            env = self._postgresql.config.write_pgpass({'host': 'localhost', **r})[0m
[30;1m224 | [0m[35m            env['PGOPTIONS'] = '-c synchronous_commit=local -c statement_timeout=0'[0m
[30;1m225 | [0m[35m            connstring = self._postgresql.config.format_dsn({**r, 'password': None})[0m
[30;1m226 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    def call_post_bootstrap(self, config: Dict[str, Any]) -> bool:[0m
[30;1m213 | [0m[35m        """[0m
[30;1m214 | [0m[35m        runs a script after initdb or custom bootstrap script is called and waits until completion.[0m
[30;1m215 | [0m[35m        """[0m
[30;1m216 | [0m[35m        cmd = config.get('post_bootstrap') or config.get('post_init')[0m
[30;1m217 | [0m[35m        if cmd:[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    def call_post_bootstrap(self, config: Dict[str, Any]) -> bool:[0m
[30;1m213 | [0m[35m        """[0m
[30;1m214 | [0m[35m        runs a script after initdb or custom bootstrap script is called and waits until completion.[0m
[30;1m215 | [0m[35m        """[0m
[30;1m216 | [0m[35m        cmd = config.get('post_bootstrap') or config.get('post_init')[0m
[30;1m217 | [0m[35m        if cmd:[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m159 | [0m[35m            so it is expected to be a :class:`dict`.[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        .. note::[0m
[30;1m162 | [0m[35m            *config* must contain a ``command`` key, which value is the command or script to perform[0m
[30;1m163 | [0m[35m            bootstrap procedure. The exit code of the ``command`` dictates if the bootstrap succeede[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m            When calling ``command``, Patroni will pass the following arguments to the ``command`` c[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport shlex[0m
[30;1m4 | [0m[35mimport tempfile[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom typing import Any, Callable, cast, Dict, List, Optional, Tuple, TYPE_CHECKING, Union[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom ..async_executor import CriticalTask[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m954 | [0m[35m    @catch_etcd_errors[0m
[30;1m955 | [0m[35m    def set_sync_state_value(self, value: str, version: Optional[str] = None) -> Union[str, bool]:[0m
[30;1m956 | [0m[35m        return self.retry(self._client.put, self.sync_path, value, mod_revision=version)\[0m
[30;1m957 | [0m[35m            .get('header', {}).get('revision', False)[0m
[30;1m958 | [0m[35m[0m
[30;1m959 | [0m[35m    @catch_etcd_errors[0m
[30;1m960 | [0m[35m    def delete_sync_state(self, version: Optional[str] = None) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m954 | [0m[35m    @catch_etcd_errors[0m
[30;1m955 | [0m[35m    def set_sync_state_value(self, value: str, version: Optional[str] = None) -> Union[str, bool]:[0m
[30;1m956 | [0m[35m        return self.retry(self._client.put, self.sync_path, value, mod_revision=version)\[0m
[30;1m957 | [0m[35m            .get('header', {}).get('revision', False)[0m
[30;1m958 | [0m[35m[0m
[30;1m959 | [0m[35m    @catch_etcd_errors[0m
[30;1m960 | [0m[35m    def delete_sync_state(self, version: Optional[str] = None) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m926 | [0m[35m            request_txn = {'request_txn': {'compare': [compare2], 'success': [request_put]}}[0m
[30;1m927 | [0m[35m            ret = self._run_and_handle_exceptions(self._client.txn, compare1, request_put, request_t[0m
[30;1m928 | [0m[35m            return ret.get('succeeded', False)\[0m
[30;1m929 | [0m[35m                or ret.get('responses', [{}])[0].get('response_txn', {}).get('succeeded', False)[0m
[30;1m930 | [0m[35m        return bool(self._lease)[0m
[30;1m931 | [0m[35m[0m
[30;1m932 | [0m[35m    @catch_etcd_errors[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m926 | [0m[35m            request_txn = {'request_txn': {'compare': [compare2], 'success': [request_put]}}[0m
[30;1m927 | [0m[35m            ret = self._run_and_handle_exceptions(self._client.txn, compare1, request_put, request_t[0m
[30;1m928 | [0m[35m            return ret.get('succeeded', False)\[0m
[30;1m929 | [0m[35m                or ret.get('responses', [{}])[0].get('response_txn', {}).get('succeeded', False)[0m
[30;1m930 | [0m[35m        return bool(self._lease)[0m
[30;1m931 | [0m[35m[0m
[30;1m932 | [0m[35m    @catch_etcd_errors[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m926 | [0m[35m            request_txn = {'request_txn': {'compare': [compare2], 'success': [request_put]}}[0m
[30;1m927 | [0m[35m            ret = self._run_and_handle_exceptions(self._client.txn, compare1, request_put, request_t[0m
[30;1m928 | [0m[35m            return ret.get('succeeded', False)\[0m
[30;1m929 | [0m[35m                or ret.get('responses', [{}])[0].get('response_txn', {}).get('succeeded', False)[0m
[30;1m930 | [0m[35m        return bool(self._lease)[0m
[30;1m931 | [0m[35m[0m
[30;1m932 | [0m[35m    @catch_etcd_errors[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m925 | [0m[35m            compare2 = {'key': fields['key'], 'target': 'CREATE', 'create_revision': '0'}[0m
[30;1m926 | [0m[35m            request_txn = {'request_txn': {'compare': [compare2], 'success': [request_put]}}[0m
[30;1m927 | [0m[35m            ret = self._run_and_handle_exceptions(self._client.txn, compare1, request_put, request_t[0m
[30;1m928 | [0m[35m            return ret.get('succeeded', False)\[0m
[30;1m929 | [0m[35m                or ret.get('responses', [{}])[0].get('response_txn', {}).get('succeeded', False)[0m
[30;1m930 | [0m[35m        return bool(self._lease)[0m
[30;1m931 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m772 | [0m[35m        sync = SyncState.from_node(sync and sync['mod_revision'], sync and sync['value'])[0m
[30;1m773 | [0m[35m[0m
[30;1m774 | [0m[35m        # get failsafe topology[0m
[30;1m775 | [0m[35m        failsafe = nodes.get(self._FAILSAFE)[0m
[30;1m776 | [0m[35m        try:[0m
[30;1m777 | [0m[35m            failsafe = json.loads(failsafe['value']) if failsafe else None[0m
[30;1m778 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m768 | [0m[35m            failover = Failover.from_node(failover['mod_revision'], failover['value'])[0m
[30;1m769 | [0m[35m[0m
[30;1m770 | [0m[35m        # get synchronization state[0m
[30;1m771 | [0m[35m        sync = nodes.get(self._SYNC)[0m
[30;1m772 | [0m[35m        sync = SyncState.from_node(sync and sync['mod_revision'], sync and sync['value'])[0m
[30;1m773 | [0m[35m[0m
[30;1m774 | [0m[35m        # get failsafe topology[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m763 | [0m[35m            leader = Leader(leader['mod_revision'], leader['lease'], member)[0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35m        # failover key[0m
[30;1m766 | [0m[35m        failover = nodes.get(self._FAILOVER)[0m
[30;1m767 | [0m[35m        if failover:[0m
[30;1m768 | [0m[35m            failover = Failover.from_node(failover['mod_revision'], failover['value'])[0m
[30;1m769 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m754 | [0m[35m[0m
[30;1m755 | [0m[35m        # get leader[0m
[30;1m756 | [0m[35m        leader = nodes.get(self._LEADER)[0m
[30;1m757 | [0m[35m        if not self._ctl and leader and leader['value'] == self._name and self._lease != leader.get([0m
[30;1m758 | [0m[35m            logger.warning('I am the leader but not owner of the lease')[0m
[30;1m759 | [0m[35m[0m
[30;1m760 | [0m[35m        if leader:[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m753 | [0m[35m        members = [self.member(n) for k, n in nodes.items() if k.startswith(self._MEMBERS) and k.cou[0m
[30;1m754 | [0m[35m[0m
[30;1m755 | [0m[35m        # get leader[0m
[30;1m756 | [0m[35m        leader = nodes.get(self._LEADER)[0m
[30;1m757 | [0m[35m        if not self._ctl and leader and leader['value'] == self._name and self._lease != leader.get([0m
[30;1m758 | [0m[35m            logger.warning('I am the leader but not owner of the lease')[0m
[30;1m759 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m746 | [0m[35m        history = history and TimelineHistory.from_node(history['mod_revision'], history['value'])[0m
[30;1m747 | [0m[35m[0m
[30;1m748 | [0m[35m        # get last know leader lsn and slots[0m
[30;1m749 | [0m[35m        status = nodes.get(self._STATUS) or nodes.get(self._LEADER_OPTIME)[0m
[30;1m750 | [0m[35m        status = Status.from_node(status and status['value'])[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m        # get list of members[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m746 | [0m[35m        history = history and TimelineHistory.from_node(history['mod_revision'], history['value'])[0m
[30;1m747 | [0m[35m[0m
[30;1m748 | [0m[35m        # get last know leader lsn and slots[0m
[30;1m749 | [0m[35m        status = nodes.get(self._STATUS) or nodes.get(self._LEADER_OPTIME)[0m
[30;1m750 | [0m[35m        status = Status.from_node(status and status['value'])[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m        # get list of members[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m742 | [0m[35m        config = config and ClusterConfig.from_node(config['mod_revision'], config['value'])[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m        # get timeline history[0m
[30;1m745 | [0m[35m        history = nodes.get(self._HISTORY)[0m
[30;1m746 | [0m[35m        history = history and TimelineHistory.from_node(history['mod_revision'], history['value'])[0m
[30;1m747 | [0m[35m[0m
[30;1m748 | [0m[35m        # get last know leader lsn and slots[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m738 | [0m[35m        initialize = initialize and initialize['value'][0m
[30;1m739 | [0m[35m[0m
[30;1m740 | [0m[35m        # get global dynamic configuration[0m
[30;1m741 | [0m[35m        config = nodes.get(self._CONFIG)[0m
[30;1m742 | [0m[35m        config = config and ClusterConfig.from_node(config['mod_revision'], config['value'])[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m        # get timeline history[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m    def _cluster_from_nodes(self, nodes: Dict[str, Any]) -> Cluster:[0m
[30;1m736 | [0m[35m        # get initialize flag[0m
[30;1m737 | [0m[35m        initialize = nodes.get(self._INITIALIZE)[0m
[30;1m738 | [0m[35m        initialize = initialize and initialize['value'][0m
[30;1m739 | [0m[35m[0m
[30;1m740 | [0m[35m        # get global dynamic configuration[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m                         .get('response_txn', {}).get('succeeded')):[0m
[30;1m635 | [0m[35m                on_success = fields['success'][0][0m
[30;1m636 | [0m[35m                value = on_success.get('request_put')[0m
[30;1m637 | [0m[35m                delete = on_success.get('request_delete_range')[0m
[30;1m638 | [0m[35m            elif method == '/kv/put' and ret:[0m
[30;1m639 | [0m[35m                value = fields[0m
[30;1m640 | [0m[35m            elif method == '/kv/deleterange' and ret:[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m                         and ret.get('responses', [{'response_txn': {'succeeded': False}}])[0][0m
[30;1m634 | [0m[35m                         .get('response_txn', {}).get('succeeded')):[0m
[30;1m635 | [0m[35m                on_success = fields['success'][0][0m
[30;1m636 | [0m[35m                value = on_success.get('request_put')[0m
[30;1m637 | [0m[35m                delete = on_success.get('request_delete_range')[0m
[30;1m638 | [0m[35m            elif method == '/kv/put' and ret:[0m
[30;1m639 | [0m[35m                value = fields[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m            if method == '/kv/txn'\[0m
[30;1m632 | [0m[35m                    and (ret.get('succeeded') or 'failure' in fields and 'request_txn' in fields['fa[0m
[30;1m633 | [0m[35m                         and ret.get('responses', [{'response_txn': {'succeeded': False}}])[0][0m
[30;1m634 | [0m[35m                         .get('response_txn', {}).get('succeeded')):[0m
[30;1m635 | [0m[35m                on_success = fields['success'][0][0m
[30;1m636 | [0m[35m                value = on_success.get('request_put')[0m
[30;1m637 | [0m[35m                delete = on_success.get('request_delete_range')[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m            if method == '/kv/txn'\[0m
[30;1m632 | [0m[35m                    and (ret.get('succeeded') or 'failure' in fields and 'request_txn' in fields['fa[0m
[30;1m633 | [0m[35m                         and ret.get('responses', [{'response_txn': {'succeeded': False}}])[0][0m
[30;1m634 | [0m[35m                         .get('response_txn', {}).get('succeeded')):[0m
[30;1m635 | [0m[35m                on_success = fields['success'][0][0m
[30;1m636 | [0m[35m                value = on_success.get('request_put')[0m
[30;1m637 | [0m[35m                delete = on_success.get('request_delete_range')[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m630 | [0m[35m            # make sense to write a universal response analyzer and we can just check expected JSON [0m
[30;1m631 | [0m[35m            if method == '/kv/txn'\[0m
[30;1m632 | [0m[35m                    and (ret.get('succeeded') or 'failure' in fields and 'request_txn' in fields['fa[0m
[30;1m633 | [0m[35m                         and ret.get('responses', [{'response_txn': {'succeeded': False}}])[0][0m
[30;1m634 | [0m[35m                         .get('response_txn', {}).get('succeeded')):[0m
[30;1m635 | [0m[35m                on_success = fields['success'][0][0m
[30;1m636 | [0m[35m                value = on_success.get('request_put')[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m629 | [0m[35m            # update/delete the same keys. Anything more complex than that we don't need and therefo[0m
[30;1m630 | [0m[35m            # make sense to write a universal response analyzer and we can just check expected JSON [0m
[30;1m631 | [0m[35m            if method == '/kv/txn'\[0m
[30;1m632 | [0m[35m                    and (ret.get('succeeded') or 'failure' in fields and 'request_txn' in fields['fa[0m
[30;1m633 | [0m[35m                         and ret.get('responses', [{'response_txn': {'succeeded': False}}])[0][0m
[30;1m634 | [0m[35m                         .get('response_txn', {}).get('succeeded')):[0m
[30;1m635 | [0m[35m                on_success = fields['success'][0][0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m617 | [0m[35m        for node in ret:[0m
[30;1m618 | [0m[35m            node.update({'key': base64_decode(node['key']),[0m
[30;1m619 | [0m[35m                         'value': base64_decode(node.get('value', '')),[0m
[30;1m620 | [0m[35m                         'lease': node.get('lease')})[0m
[30;1m621 | [0m[35m        return ret[0m
[30;1m622 | [0m[35m[0m
[30;1m623 | [0m[35m    def call_rpc(self, method: str, fields: Dict[str, Any], retry: Optional[Retry] = None) -> Dict[s[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m616 | [0m[35m            ret = self._etcd3.retry(self.prefix, path, serializable).get('kvs', [])[0m
[30;1m617 | [0m[35m        for node in ret:[0m
[30;1m618 | [0m[35m            node.update({'key': base64_decode(node['key']),[0m
[30;1m619 | [0m[35m                         'value': base64_decode(node.get('value', '')),[0m
[30;1m620 | [0m[35m                         'lease': node.get('lease')})[0m
[30;1m621 | [0m[35m        return ret[0m
[30;1m622 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m613 | [0m[35m                ret = self._kv_cache.copy()[0m
[30;1m614 | [0m[35m        else:[0m
[30;1m615 | [0m[35m            serializable = not getattr(self._etcd3, '_ctl')  # use linearizable for patronictl[0m
[30;1m616 | [0m[35m            ret = self._etcd3.retry(self.prefix, path, serializable).get('kvs', [])[0m
[30;1m617 | [0m[35m        for node in ret:[0m
[30;1m618 | [0m[35m            node.update({'key': base64_decode(node['key']),[0m
[30;1m619 | [0m[35m                         'value': base64_decode(node.get('value', '')),[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m528 | [0m[35m    def _build_cache(self) -> None:[0m
[30;1m529 | [0m[35m        result = self._dcs.retry(self._client.prefix, self._dcs.cluster_prefix)[0m
[30;1m530 | [0m[35m        with self._object_cache_lock:[0m
[30;1m531 | [0m[35m            self._object_cache = {node['key']: node for node in result.get('kvs', [])}[0m
[30;1m532 | [0m[35m        with self.condition:[0m
[30;1m533 | [0m[35m            self._is_ready = True[0m
[30;1m534 | [0m[35m            self.condition.notify()[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m493 | [0m[35m        logger.debug('Received message: %s', message)[0m
[30;1m494 | [0m[35m        if 'error' in message:[0m
[30;1m495 | [0m[35m            raise _raise_for_data(message)[0m
[30;1m496 | [0m[35m        events: List[Dict[str, Any]] = message.get('result', {}).get('events', [])[0m
[30;1m497 | [0m[35m        for event in events:[0m
[30;1m498 | [0m[35m            self._process_event(event)[0m
[30;1m499 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m493 | [0m[35m        logger.debug('Received message: %s', message)[0m
[30;1m494 | [0m[35m        if 'error' in message:[0m
[30;1m495 | [0m[35m            raise _raise_for_data(message)[0m
[30;1m496 | [0m[35m        events: List[Dict[str, Any]] = message.get('result', {}).get('events', [])[0m
[30;1m497 | [0m[35m        for event in events:[0m
[30;1m498 | [0m[35m            self._process_event(event)[0m
[30;1m499 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m[0m
[30;1m487 | [0m[35m            # We also want to wake up HA loop on replicas if leader optime (or status key) was updat[0m
[30;1m488 | [0m[35m            if value_changed and (key not in (self._optime_key, self._status_key)[0m
[30;1m489 | [0m[35m                                  or (self.get(self._leader_key) or {}).get('value') != self._name):[0m
[30;1m490 | [0m[35m                self._dcs.event.set()[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m    def _process_message(self, message: Dict[str, Any]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m[0m
[30;1m487 | [0m[35m            # We also want to wake up HA loop on replicas if leader optime (or status key) was updat[0m
[30;1m488 | [0m[35m            if value_changed and (key not in (self._optime_key, self._status_key)[0m
[30;1m489 | [0m[35m                                  or (self.get(self._leader_key) or {}).get('value') != self._name):[0m
[30;1m490 | [0m[35m                self._dcs.event.set()[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m    def _process_message(self, message: Dict[str, Any]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m        if success:[0m
[30;1m477 | [0m[35m            old_value = old_value and old_value.get('value')[0m
[30;1m478 | [0m[35m            new_value = kv.get('value')[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m            value_changed = old_value != new_value and \[0m
[30;1m481 | [0m[35m                (key == self._leader_key or key in (self._optime_key, self._status_key) and new_valu[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m474 | [0m[35m            success, old_value = self.set(kv, True)[0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m        if success:[0m
[30;1m477 | [0m[35m            old_value = old_value and old_value.get('value')[0m
[30;1m478 | [0m[35m            new_value = kv.get('value')[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m            value_changed = old_value != new_value and \[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m468 | [0m[35m    def _process_event(self, event: Dict[str, Any]) -> None:[0m
[30;1m469 | [0m[35m        kv = event['kv'][0m
[30;1m470 | [0m[35m        key = kv['key'][0m
[30;1m471 | [0m[35m        if event.get('type') == 'DELETE':[0m
[30;1m472 | [0m[35m            success, old_value = self.delete(key, kv['mod_revision'])[0m
[30;1m473 | [0m[35m        else:[0m
[30;1m474 | [0m[35m            success, old_value = self.set(kv, True)[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35m    def get(self, name: str) -> Optional[Dict[str, Any]]:[0m
[30;1m465 | [0m[35m        with self._object_cache_lock:[0m
[30;1m466 | [0m[35m            return self._object_cache.get(name)[0m
[30;1m467 | [0m[35m[0m
[30;1m468 | [0m[35m    def _process_event(self, event: Dict[str, Any]) -> None:[0m
[30;1m469 | [0m[35m        kv = event['kv'][0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m451 | [0m[35m[0m
[30;1m452 | [0m[35m    def delete(self, name: str, mod_revision: str) -> Tuple[bool, Optional[Dict[str, Any]]]:[0m
[30;1m453 | [0m[35m        with self._object_cache_lock:[0m
[30;1m454 | [0m[35m            old_value = self._object_cache.get(name)[0m
[30;1m455 | [0m[35m            ret = old_value and int(old_value['mod_revision']) < int(mod_revision)[0m
[30;1m456 | [0m[35m            if ret:[0m
[30;1m457 | [0m[35m                del self._object_cache[name][0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m443 | [0m[35m    def set(self, value: Dict[str, Any], overwrite: bool = False) -> Tuple[bool, Optional[Dict[str, [0m
[30;1m444 | [0m[35m        with self._object_cache_lock:[0m
[30;1m445 | [0m[35m            name = value['key'][0m
[30;1m446 | [0m[35m            old_value = self._object_cache.get(name)[0m
[30;1m447 | [0m[35m            ret = not old_value or int(old_value['mod_revision']) < int(value['mod_revision'])[0m
[30;1m448 | [0m[35m            if ret or overwrite and old_value and old_value['mod_revision'] == value['mod_revision'][0m
[30;1m449 | [0m[35m                self._object_cache[name] = value[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m        if failure:[0m
[30;1m373 | [0m[35m            fields['failure'] = [failure][0m
[30;1m374 | [0m[35m        ret = self.call_rpc('/kv/txn', fields, retry)[0m
[30;1m375 | [0m[35m        return ret if failure or ret.get('succeeded') else {}[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    @_handle_auth_errors[0m
[30;1m378 | [0m[35m    def put(self, key: str, value: str, lease: Optional[str] = None, create_revision: Optional[str] [0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m363 | [0m[35m        return self.call_rpc('/lease/grant', {'TTL': ttl}, retry)['ID'][0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m    def lease_keepalive(self, ID: str, *, retry: Optional[Retry] = None) -> Optional[str]:[0m
[30;1m366 | [0m[35m        return self.call_rpc('/lease/keepalive', {'ID': ID}, retry).get('result', {}).get('TTL')[0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m    @_handle_auth_errors[0m
[30;1m369 | [0m[35m    def txn(self, compare: Dict[str, Any], success: Dict[str, Any],[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m363 | [0m[35m        return self.call_rpc('/lease/grant', {'TTL': ttl}, retry)['ID'][0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m    def lease_keepalive(self, ID: str, *, retry: Optional[Retry] = None) -> Optional[str]:[0m
[30;1m366 | [0m[35m        return self.call_rpc('/lease/keepalive', {'ID': ID}, retry).get('result', {}).get('TTL')[0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m    @_handle_auth_errors[0m
[30;1m369 | [0m[35m    def txn(self, compare: Dict[str, Any], success: Dict[str, Any],[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m            self._token = old_token[0m
[30;1m308 | [0m[35m            raise[0m
[30;1m309 | [0m[35m        else:[0m
[30;1m310 | [0m[35m            self._token = response.get('token')[0m
[30;1m311 | [0m[35m        return old_token != self._token[0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m    def handle_auth_errors(self: 'Etcd3Client', func: Callable[..., Any], *args: Any,[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m        self._ensure_version_prefix(base_uri, **kwargs)[0m
[30;1m285 | [0m[35m        resp = self.http.urlopen(self._MPOST, base_uri + self.version_prefix + '/cluster/member/list[0m
[30;1m286 | [0m[35m        members = self._handle_server_response(resp)['members'][0m
[30;1m287 | [0m[35m        return [url for member in members for url in member.get('clientURLs', [])][0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m    def call_rpc(self, method: str, fields: Dict[str, Any], retry: Optional[Retry] = None) -> Dict[s[0m
[30;1m290 | [0m[35m        fields['retry'] = retry[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m    except Exception:[0m
[30;1m169 | [0m[35m        error = str(data)[0m
[30;1m170 | [0m[35m        code = GRPCCode.Unknown[0m
[30;1m171 | [0m[35m    err = errStringToClientError.get(error) or errCodeToClientError.get(code) or Unknown[0m
[30;1m172 | [0m[35m    return err(code, error, status_code)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m    except Exception:[0m
[30;1m169 | [0m[35m        error = str(data)[0m
[30;1m170 | [0m[35m        code = GRPCCode.Unknown[0m
[30;1m171 | [0m[35m    err = errStringToClientError.get(error) or errCodeToClientError.get(code) or Unknown[0m
[30;1m172 | [0m[35m    return err(code, error, status_code)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m            code: Optional[int] = data_error['grpc_code'][0m
[30;1m161 | [0m[35m            error: str = data_error['message'][0m
[30;1m162 | [0m[35m        else:[0m
[30;1m163 | [0m[35m            data_code = data.get('code') or data.get('Code')[0m
[30;1m164 | [0m[35m            if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m165 | [0m[35m                assert not isinstance(data_code, dict)[0m
[30;1m166 | [0m[35m            code = data_code[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m            code: Optional[int] = data_error['grpc_code'][0m
[30;1m161 | [0m[35m            error: str = data_error['message'][0m
[30;1m162 | [0m[35m        else:[0m
[30;1m163 | [0m[35m            data_code = data.get('code') or data.get('Code')[0m
[30;1m164 | [0m[35m            if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m165 | [0m[35m                assert not isinstance(data_code, dict)[0m
[30;1m166 | [0m[35m            code = data_code[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m            assert isinstance(data, dict)[0m
[30;1m157 | [0m[35m        data_error: Optional[Dict[str, Any]] = data.get('error') or data.get('Error')[0m
[30;1m158 | [0m[35m        if isinstance(data_error, dict):  # streaming response[0m
[30;1m159 | [0m[35m            status_code = data_error.get('http_code')[0m
[30;1m160 | [0m[35m            code: Optional[int] = data_error['grpc_code'][0m
[30;1m161 | [0m[35m            error: str = data_error['message'][0m
[30;1m162 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m    try:[0m
[30;1m155 | [0m[35m        if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m156 | [0m[35m            assert isinstance(data, dict)[0m
[30;1m157 | [0m[35m        data_error: Optional[Dict[str, Any]] = data.get('error') or data.get('Error')[0m
[30;1m158 | [0m[35m        if isinstance(data_error, dict):  # streaming response[0m
[30;1m159 | [0m[35m            status_code = data_error.get('http_code')[0m
[30;1m160 | [0m[35m            code: Optional[int] = data_error['grpc_code'][0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m    try:[0m
[30;1m155 | [0m[35m        if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m156 | [0m[35m            assert isinstance(data, dict)[0m
[30;1m157 | [0m[35m        data_error: Optional[Dict[str, Any]] = data.get('error') or data.get('Error')[0m
[30;1m158 | [0m[35m        if isinstance(data_error, dict):  # streaming response[0m
[30;1m159 | [0m[35m            status_code = data_error.get('http_code')[0m
[30;1m160 | [0m[35m            code: Optional[int] = data_error['grpc_code'][0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    def __init__(self, code: Optional[int] = None, error: Optional[str] = None, status: Optional[int[0m
[30;1m70 | [0m[35m        if not hasattr(self, 'error'):[0m
[30;1m71 | [0m[35m            self.error = error and error.strip()[0m
[30;1m72 | [0m[35m        self.codeText = GRPCcodeToText.get(code) if code is not None else None[0m
[30;1m73 | [0m[35m        self.status = status[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    def __repr__(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m918 | [0m[35m            retry.ensure_deadline(1, Etcd3Error('update_leader timeout'))[0m
[30;1m919 | [0m[35m[0m
[30;1m920 | [0m[35m            fields = {'key': base64_encode(self.leader_path), 'value': base64_encode(self._name), 'l[0m
[30;1m921 | [0m[35m            # First we try to update lease on existing leader key "hoping" that we still owning it[0m
[30;1m922 | [0m[35m            compare1 = {'key': fields['key'], 'target': 'VALUE', 'value': fields['value']}[0m
[30;1m923 | [0m[35m            request_put = {'request_put': fields}[0m
[30;1m924 | [0m[35m            # If the first comparison failed we will try to create the new leader key in a transacti[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m967 | [0m[35m[0m
[30;1m968 | [0m[35m        # We want to give a bit more time to non-leader nodes to synchronize HA loops[0m
[30;1m969 | [0m[35m        if leader_version:[0m
[30;1m970 | [0m[35m            timeout += 0.5[0m
[30;1m971 | [0m[35m[0m
[30;1m972 | [0m[35m        try:[0m
[30;1m973 | [0m[35m            return super(Etcd3, self).watch(None, timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m965 | [0m[35m            self.__do_not_watch = False[0m
[30;1m966 | [0m[35m            return True[0m
[30;1m967 | [0m[35m[0m
[30;1m968 | [0m[35m        # We want to give a bit more time to non-leader nodes to synchronize HA loops[0m
[30;1m969 | [0m[35m        if leader_version:[0m
[30;1m970 | [0m[35m            timeout += 0.5[0m
[30;1m971 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m804 | [0m[35m        for node in self._client.get_cluster(path):[0m
[30;1m805 | [0m[35m            key = node['key'][len(path):].split('/', 1)[0m
[30;1m806 | [0m[35m            if len(key) == 2 and self._mpp.group_re.match(key[0]):[0m
[30;1m807 | [0m[35m                clusters[int(key[0])][key[1]] = node[0m
[30;1m808 | [0m[35m        return {group: self._cluster_from_nodes(nodes) for group, nodes in clusters.items()}[0m
[30;1m809 | [0m[35m[0m
[30;1m810 | [0m[35m    def _load_cluster([0m
[30;1m811 | [0m[35m            self, path: str, loader: Callable[[str], Union[Cluster, Dict[int, Cluster]]][0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m801 | [0m[35m        """[0m
[30;1m802 | [0m[35m        clusters: Dict[int, Dict[str, Dict[str, Any]]] = defaultdict(dict)[0m
[30;1m803 | [0m[35m        path = self._base_path + '/'[0m
[30;1m804 | [0m[35m        for node in self._client.get_cluster(path):[0m
[30;1m805 | [0m[35m            key = node['key'][len(path):].split('/', 1)[0m
[30;1m806 | [0m[35m            if len(key) == 2 and self._mpp.group_re.match(key[0]):[0m
[30;1m807 | [0m[35m                clusters[int(key[0])][key[1]] = node[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m788 | [0m[35m        :returns: :class:`Cluster` instance.[0m
[30;1m789 | [0m[35m        """[0m
[30;1m790 | [0m[35m        nodes = {node['key'][len(path):]: node[0m
[30;1m791 | [0m[35m                 for node in self._client.get_cluster(path)[0m
[30;1m792 | [0m[35m                 if node['key'].startswith(path)}[0m
[30;1m793 | [0m[35m        return self._cluster_from_nodes(nodes)[0m
[30;1m794 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m        :returns: :class:`Cluster` instance.[0m
[30;1m789 | [0m[35m        """[0m
[30;1m790 | [0m[35m        nodes = {node['key'][len(path):]: node[0m
[30;1m791 | [0m[35m                 for node in self._client.get_cluster(path)[0m
[30;1m792 | [0m[35m                 if node['key'].startswith(path)}[0m
[30;1m793 | [0m[35m        return self._cluster_from_nodes(nodes)[0m
[30;1m794 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m614 | [0m[35m        else:[0m
[30;1m615 | [0m[35m            serializable = not getattr(self._etcd3, '_ctl')  # use linearizable for patronictl[0m
[30;1m616 | [0m[35m            ret = self._etcd3.retry(self.prefix, path, serializable).get('kvs', [])[0m
[30;1m617 | [0m[35m        for node in ret:[0m
[30;1m618 | [0m[35m            node.update({'key': base64_decode(node['key']),[0m
[30;1m619 | [0m[35m                         'value': base64_decode(node.get('value', '')),[0m
[30;1m620 | [0m[35m                         'lease': node.get('lease')})[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m602 | [0m[35m        stop_time = time.time() + timeout[0m
[30;1m603 | [0m[35m        while self._kv_cache and not self._kv_cache.is_ready():[0m
[30;1m604 | [0m[35m            timeout = stop_time - time.time()[0m
[30;1m605 | [0m[35m            if timeout <= 0:[0m
[30;1m606 | [0m[35m                raise RetryFailedError('Exceeded retry deadline')[0m
[30;1m607 | [0m[35m            self._kv_cache.condition.wait(timeout)[0m
[30;1m608 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m601 | [0m[35m    def _wait_cache(self, timeout: float) -> None:[0m
[30;1m602 | [0m[35m        stop_time = time.time() + timeout[0m
[30;1m603 | [0m[35m        while self._kv_cache and not self._kv_cache.is_ready():[0m
[30;1m604 | [0m[35m            timeout = stop_time - time.time()[0m
[30;1m605 | [0m[35m            if timeout <= 0:[0m
[30;1m606 | [0m[35m                raise RetryFailedError('Exceeded retry deadline')[0m
[30;1m607 | [0m[35m            self._kv_cache.condition.wait(timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m599 | [0m[35m        self._restart_watcher()[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m    def _wait_cache(self, timeout: float) -> None:[0m
[30;1m602 | [0m[35m        stop_time = time.time() + timeout[0m
[30;1m603 | [0m[35m        while self._kv_cache and not self._kv_cache.is_ready():[0m
[30;1m604 | [0m[35m            timeout = stop_time - time.time()[0m
[30;1m605 | [0m[35m            if timeout <= 0:[0m
[30;1m606 | [0m[35m                raise RetryFailedError('Exceeded retry deadline')[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m528 | [0m[35m    def _build_cache(self) -> None:[0m
[30;1m529 | [0m[35m        result = self._dcs.retry(self._client.prefix, self._dcs.cluster_prefix)[0m
[30;1m530 | [0m[35m        with self._object_cache_lock:[0m
[30;1m531 | [0m[35m            self._object_cache = {node['key']: node for node in result.get('kvs', [])}[0m
[30;1m532 | [0m[35m        with self.condition:[0m
[30;1m533 | [0m[35m            self._is_ready = True[0m
[30;1m534 | [0m[35m            self.condition.notify()[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m528 | [0m[35m    def _build_cache(self) -> None:[0m
[30;1m529 | [0m[35m        result = self._dcs.retry(self._client.prefix, self._dcs.cluster_prefix)[0m
[30;1m530 | [0m[35m        with self._object_cache_lock:[0m
[30;1m531 | [0m[35m            self._object_cache = {node['key']: node for node in result.get('kvs', [])}[0m
[30;1m532 | [0m[35m        with self.condition:[0m
[30;1m533 | [0m[35m            self._is_ready = True[0m
[30;1m534 | [0m[35m            self.condition.notify()[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m511 | [0m[35m        # In order to interrupt the /watch request we do socket.shutdown() from the main thread,[0m
[30;1m512 | [0m[35m        # which doesn't work on Windows. Therefore we want to use the last resort, `read_timeout`.[0m
[30;1m513 | [0m[35m        # Setting it to TTL will help to partially mitigate the problem.[0m
[30;1m514 | [0m[35m        # Setting it to lower value is not nice because for idling clusters it will increase[0m
[30;1m515 | [0m[35m        # the numbers of interrupts and reconnects.[0m
[30;1m516 | [0m[35m        read_timeout = self._dcs.ttl if os.name == 'nt' else None[0m
[30;1m517 | [0m[35m        response = self._client.watchprefix(self._dcs.cluster_prefix, revision, read_timeout=read_ti[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport socket[0m
[30;1m8 | [0m[35mimport sys[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom collections import defaultdict[0m
[30;1m12 | [0m[35mfrom enum import IntEnum[0m
[30;1m13 | [0m[35mfrom threading import Condition, Lock, Thread[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import absolute_import[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport socket[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1857 | [0m[35m[0m
[30;1m1858 | [0m[35m        # Now that restart is scheduled we can set timeout for startup, it will get reset[0m
[30;1m1859 | [0m[35m        # once async executor runs and main loop notices PostgreSQL as up.[0m
[30;1m1860 | [0m[35m        timeout = restart_data.get('timeout', global_config.primary_start_timeout)[0m
[30;1m1861 | [0m[35m        self.set_start_timeout(timeout)[0m
[30;1m1862 | [0m[35m[0m
[30;1m1863 | [0m[35m        def before_shutdown() -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1841 | [0m[35m        assert isinstance(restart_data, dict)[0m
[30;1m1842 | [0m[35m[0m
[30;1m1843 | [0m[35m        if (not self.restart_matches(restart_data.get('role'),[0m
[30;1m1844 | [0m[35m                                     restart_data.get('postgres_version'),[0m
[30;1m1845 | [0m[35m                                     ('restart_pending' in restart_data))):[0m
[30;1m1846 | [0m[35m            return (False, "restart conditions are not satisfied")[0m
[30;1m1847 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1840 | [0m[35m        """ conditional and unconditional restart """[0m
[30;1m1841 | [0m[35m        assert isinstance(restart_data, dict)[0m
[30;1m1842 | [0m[35m[0m
[30;1m1843 | [0m[35m        if (not self.restart_matches(restart_data.get('role'),[0m
[30;1m1844 | [0m[35m                                     restart_data.get('postgres_version'),[0m
[30;1m1845 | [0m[35m                                     ('restart_pending' in restart_data))):[0m
[30;1m1846 | [0m[35m            return (False, "restart conditions are not satisfied")[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1180 | [0m[35m            logger.info('Got response from %s %s: %s', member.name, url, response_data)[0m
[30;1m1181 | [0m[35m            accepted = response.status == 200 and response_data == 'Accepted'[0m
[30;1m1182 | [0m[35m            # member may return its current received/replayed LSN in the "lsn" header.[0m
[30;1m1183 | [0m[35m            return _FailsafeResponse(member.name, accepted, parse_int(response.headers.get('lsn')))[0m
[30;1m1184 | [0m[35m        except Exception as e:[0m
[30;1m1185 | [0m[35m            logger.warning("Request failed to %s: POST %s (%s)", member.name, url, e)[0m
[30;1m1186 | [0m[35m        return _FailsafeResponse(member.name, False, None)[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1175 | [0m[35m        endpoint = 'failsafe'[0m
[30;1m1176 | [0m[35m        url = member.get_endpoint_url(endpoint)[0m
[30;1m1177 | [0m[35m        try:[0m
[30;1m1178 | [0m[35m            response = self.patroni.request(member, 'post', endpoint, data, timeout=2, retries=1)[0m
[30;1m1179 | [0m[35m            response_data = response.data.decode('utf-8')[0m
[30;1m1180 | [0m[35m            logger.info('Got response from %s %s: %s', member.name, url, response_data)[0m
[30;1m1181 | [0m[35m            accepted = response.status == 200 and response_data == 'Accepted'[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1133 | [0m[35m        :returns: :class:`_MemberStatus` object[0m
[30;1m1134 | [0m[35m        """[0m
[30;1m1135 | [0m[35m        try:[0m
[30;1m1136 | [0m[35m            response = self.patroni.request(member, timeout=2, retries=0)[0m
[30;1m1137 | [0m[35m            data = response.data.decode('utf-8')[0m
[30;1m1138 | [0m[35m            logger.info('Got response from %s %s: %s', member.name, member.api_url, data)[0m
[30;1m1139 | [0m[35m            return _MemberStatus.from_api_response(member, json.loads(data))[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1058 | [0m[35m                history = history[-global_config.max_timelines_history:][0m
[30;1m1059 | [0m[35m            for line in history:[0m
[30;1m1060 | [0m[35m                # enrich current history with promotion timestamps stored in DCS[0m
[30;1m1061 | [0m[35m                cluster_history_line = cluster_history_dict.get(line[0], [])[0m
[30;1m1062 | [0m[35m                if len(line) == 3 and len(cluster_history_line) >= 4 and cluster_history_line[1] == [0m
[30;1m1063 | [0m[35m                    line.append(cluster_history_line[3])[0m
[30;1m1064 | [0m[35m                    if len(cluster_history_line) == 5:[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m717 | [0m[35m                node_to_follow.data.pop(param, None)  # when above-mentioned params came from outsid[0m
[30;1m718 | [0m[35m            if self.is_standby_cluster():[0m
[30;1m719 | [0m[35m                standby_config = global_config.get_standby_cluster_config()[0m
[30;1m720 | [0m[35m                node_to_follow.data.update({p: standby_config[p] for p in params if standby_config.g[0m
[30;1m721 | [0m[35m[0m
[30;1m722 | [0m[35m        return node_to_follow[0m
[30;1m723 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m648 | [0m[35m        # Postgres is not running, and we will restart in standby mode. Watchdog is not needed until[0m
[30;1m649 | [0m[35m        self.watchdog.disable()[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m        if data.get('Database cluster state') in ('in production', 'shutting down', 'in crash recove[0m
[30;1m652 | [0m[35m            msg = self._handle_crash_recovery()[0m
[30;1m653 | [0m[35m            if msg:[0m
[30;1m654 | [0m[35m                return msg[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m[0m
[30;1m634 | [0m[35m        # timeout > 0 indicates that we still have the leader lock, and it was just updated[0m
[30;1m635 | [0m[35m        if timeout\[0m
[30;1m636 | [0m[35m                and data.get('Database cluster state') in ('in production', 'in crash recovery',[0m
[30;1m637 | [0m[35m                                                           'shutting down', 'shut down')\[0m
[30;1m638 | [0m[35m                and self.state_handler.state == 'crashed'\[0m
[30;1m639 | [0m[35m                and self.state_handler.role == 'primary'\[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m579 | [0m[35m        if self._rewind.can_rewind:[0m
[30;1m580 | [0m[35m            # rewind is required, but postgres wasn't shut down cleanly.[0m
[30;1m581 | [0m[35m            if not self.state_handler.is_running() and \[0m
[30;1m582 | [0m[35m                    self.state_handler.controldata().get('Database cluster state') == 'in archive re[0m
[30;1m583 | [0m[35m                msg = self._handle_crash_recovery()[0m
[30;1m584 | [0m[35m                if msg:[0m
[30;1m585 | [0m[35m                    return msg[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m541 | [0m[35m            return ret or 'trying to bootstrap {0}'.format(msg)[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m        # no leader, but configuration may allowed replica creation using backup tools[0m
[30;1m544 | [0m[35m        create_replica_methods = global_config.get_standby_cluster_config().get('create_replica_meth[0m
[30;1m545 | [0m[35m            if self.is_standby_cluster() else None[0m
[30;1m546 | [0m[35m        can_bootstrap = self.state_handler.can_create_replica_without_replication_connection(create_[0m
[30;1m547 | [0m[35m        concurrent_bootstrap = self.cluster.initialize == ""[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m429 | [0m[35m                            'cooldown': self.patroni.config['retry_timeout']}[0m
[30;1m430 | [0m[35m                    timeout = self.dcs.ttl if event == 'before_demote' else 2[0m
[30;1m431 | [0m[35m                    endpoint = 'citus' if mpp_handler.type == 'Citus' else 'mpp'[0m
[30;1m432 | [0m[35m                    self.patroni.request(coordinator.leader.member, 'post', endpoint, data, timeout=[0m
[30;1m433 | [0m[35m                except Exception as e:[0m
[30;1m434 | [0m[35m                    logger.warning('Request to %s coordinator leader %s %s failed: %r', mpp_handler.[0m
[30;1m435 | [0m[35m                                   coordinator.leader.name, coordinator.leader.member.api_url, e)[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m            self._name = data['name'][0m
[30;1m142 | [0m[35m            self._conn_url = data['conn_url'][0m
[30;1m143 | [0m[35m            self._api_url = data['api_url'][0m
[30;1m144 | [0m[35m            self._slots = data.get('slots')[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    def _reset_state(self) -> None:[0m
[30;1m147 | [0m[35m        """Reset state of the :class:`Failsafe` object."""[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m    @property[0m
[30;1m72 | [0m[35m    def watchdog_failed(self) -> bool:[0m
[30;1m73 | [0m[35m        """Indicates that watchdog is required by configuration but not available or failed."""[0m
[30;1m74 | [0m[35m        return self.data.get('watchdog_failed', False)[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    @classmethod[0m
[30;1m77 | [0m[35m    def unknown(cls, member: Member) -> '_MemberStatus':[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    @property[0m
[30;1m67 | [0m[35m    def timeline(self) -> int:[0m
[30;1m68 | [0m[35m        """Timeline value from JSON."""[0m
[30;1m69 | [0m[35m        return self.data.get('timeline', 0)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    @property[0m
[30;1m72 | [0m[35m    def watchdog_failed(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    @property[0m
[30;1m62 | [0m[35m    def tags(self) -> Dict[str, Any]:[0m
[30;1m63 | [0m[35m        """Dictionary with values of different tags (i.e. nofailover)."""[0m
[30;1m64 | [0m[35m        return self.data.get('tags', {})[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    @property[0m
[30;1m67 | [0m[35m    def timeline(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        wal: Dict[str, Any] = json.get('wal') or json['xlog'][0m
[30;1m56 | [0m[35m        # abuse difference in primary/replica response format[0m
[30;1m57 | [0m[35m        in_recovery = not (bool(wal.get('location')) or json.get('role') in ('master', 'primary'))[0m
[30;1m58 | [0m[35m        lsn = int(in_recovery and max(wal.get('received_location', 0), wal.get('replayed_location', [0m
[30;1m59 | [0m[35m        return cls(member, True, in_recovery, lsn, json)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        wal: Dict[str, Any] = json.get('wal') or json['xlog'][0m
[30;1m56 | [0m[35m        # abuse difference in primary/replica response format[0m
[30;1m57 | [0m[35m        in_recovery = not (bool(wal.get('location')) or json.get('role') in ('master', 'primary'))[0m
[30;1m58 | [0m[35m        lsn = int(in_recovery and max(wal.get('received_location', 0), wal.get('replayed_location', [0m
[30;1m59 | [0m[35m        return cls(member, True, in_recovery, lsn, json)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        # If one of those is not in a response we want to count the node as not healthy/reachable[0m
[30;1m55 | [0m[35m        wal: Dict[str, Any] = json.get('wal') or json['xlog'][0m
[30;1m56 | [0m[35m        # abuse difference in primary/replica response format[0m
[30;1m57 | [0m[35m        in_recovery = not (bool(wal.get('location')) or json.get('role') in ('master', 'primary'))[0m
[30;1m58 | [0m[35m        lsn = int(in_recovery and max(wal.get('received_location', 0), wal.get('replayed_location', [0m
[30;1m59 | [0m[35m        return cls(member, True, in_recovery, lsn, json)[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        # If one of those is not in a response we want to count the node as not healthy/reachable[0m
[30;1m55 | [0m[35m        wal: Dict[str, Any] = json.get('wal') or json['xlog'][0m
[30;1m56 | [0m[35m        # abuse difference in primary/replica response format[0m
[30;1m57 | [0m[35m        in_recovery = not (bool(wal.get('location')) or json.get('role') in ('master', 'primary'))[0m
[30;1m58 | [0m[35m        lsn = int(in_recovery and max(wal.get('received_location', 0), wal.get('replayed_location', [0m
[30;1m59 | [0m[35m        return cls(member, True, in_recovery, lsn, json)[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m        :returns: _MemberStatus object[0m
[30;1m53 | [0m[35m        """[0m
[30;1m54 | [0m[35m        # If one of those is not in a response we want to count the node as not healthy/reachable[0m
[30;1m55 | [0m[35m        wal: Dict[str, Any] = json.get('wal') or json['xlog'][0m
[30;1m56 | [0m[35m        # abuse difference in primary/replica response format[0m
[30;1m57 | [0m[35m        in_recovery = not (bool(wal.get('location')) or json.get('role') in ('master', 'primary'))[0m
[30;1m58 | [0m[35m        lsn = int(in_recovery and max(wal.get('received_location', 0), wal.get('replayed_location', [0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1778 | [0m[35m            request_time = restart_data['postmaster_start_time'][0m
[30;1m1779 | [0m[35m            # check if postmaster start time has changed since the last restart[0m
[30;1m1780 | [0m[35m            if recent_time and request_time and recent_time != request_time:[0m
[30;1m1781 | [0m[35m                logger.info("Cancelling scheduled restart: postgres restart has already happened at [0m
[30;1m1782 | [0m[35m                self.delete_future_restart()[0m
[30;1m1783 | [0m[35m                return None[0m
[30;1m1784 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1755 | [0m[35m                    self.demote('immediate-nolock')[0m
[30;1m1756 | [0m[35m                    return 'demoted self because failed to update leader lock in DCS'[0m
[30;1m1757 | [0m[35m                else:[0m
[30;1m1758 | [0m[35m                    return 'not promoting because failed to update leader lock in DCS'[0m
[30;1m1759 | [0m[35m        else:[0m
[30;1m1760 | [0m[35m            logger.debug('does not have lock')[0m
[30;1m1761 | [0m[35m        lock_owner = self.cluster.leader and self.cluster.leader.name[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1753 | [0m[35m                    if self.is_paused():[0m
[30;1m1754 | [0m[35m                        return 'continue to run as primary after failing to update leader lock in DC[0m
[30;1m1755 | [0m[35m                    self.demote('immediate-nolock')[0m
[30;1m1756 | [0m[35m                    return 'demoted self because failed to update leader lock in DCS'[0m
[30;1m1757 | [0m[35m                else:[0m
[30;1m1758 | [0m[35m                    return 'not promoting because failed to update leader lock in DCS'[0m
[30;1m1759 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1751 | [0m[35m                logger.error('failed to update leader lock')[0m
[30;1m1752 | [0m[35m                if self.state_handler.is_primary():[0m
[30;1m1753 | [0m[35m                    if self.is_paused():[0m
[30;1m1754 | [0m[35m                        return 'continue to run as primary after failing to update leader lock in DC[0m
[30;1m1755 | [0m[35m                    self.demote('immediate-nolock')[0m
[30;1m1756 | [0m[35m                    return 'demoted self because failed to update leader lock in DCS'[0m
[30;1m1757 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1748 | [0m[35m                    )[0m
[30;1m1749 | [0m[35m            else:[0m
[30;1m1750 | [0m[35m                # Either there is no connection to DCS or someone else acquired the lock[0m
[30;1m1751 | [0m[35m                logger.error('failed to update leader lock')[0m
[30;1m1752 | [0m[35m                if self.state_handler.is_primary():[0m
[30;1m1753 | [0m[35m                    if self.is_paused():[0m
[30;1m1754 | [0m[35m                        return 'continue to run as primary after failing to update leader lock in DC[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1724 | [0m[35m                    self._delete_leader()[0m
[30;1m1725 | [0m[35m                    return 'removed leader lock because postgres is not running as primary'[0m
[30;1m1726 | [0m[35m[0m
[30;1m1727 | [0m[35m            # update lock to avoid split-brain[0m
[30;1m1728 | [0m[35m            if self.update_lock(True):[0m
[30;1m1729 | [0m[35m                msg = self.process_manual_failover_from_leader()[0m
[30;1m1730 | [0m[35m                if msg is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1625 | [0m[35m[0m
[30;1m1626 | [0m[35m                # The value is very close to now[0m
[30;1m1627 | [0m[35m                time.sleep(max(delta, 0))[0m
[30;1m1628 | [0m[35m                logger.info('Manual scheduled {0} at %s'.format(action_name), scheduled_at.isoformat[0m
[30;1m1629 | [0m[35m                return True[0m
[30;1m1630 | [0m[35m            except TypeError:[0m
[30;1m1631 | [0m[35m                logger.warning('Incorrect value of scheduled_at: %s', scheduled_at)[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1611 | [0m[35m                delta = (scheduled_at - now).total_seconds()[0m
[30;1m1612 | [0m[35m[0m
[30;1m1613 | [0m[35m                if delta > self.dcs.loop_wait:[0m
[30;1m1614 | [0m[35m                    logger.info('Awaiting %s at %s (in %.0f seconds)',[0m
[30;1m1615 | [0m[35m                                action_name, scheduled_at.isoformat(), delta)[0m
[30;1m1616 | [0m[35m                    return False[0m
[30;1m1617 | [0m[35m                elif delta < - int(self.dcs.loop_wait * 1.5):[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1422 | [0m[35m                else:  # I was the leader and it looks like currently I am the only healthy member[0m
[30;1m1423 | [0m[35m                    return True[0m
[30;1m1424 | [0m[35m[0m
[30;1m1425 | [0m[35m            # at this point we assume that our node is a candidate for a failover among all nodes ex[0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m        # exclude former leader from the list (failover.leader can be None)[0m
[30;1m1428 | [0m[35m        members = [m for m in self.cluster.members if m.name != failover.leader][0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1408 | [0m[35m                # we wanted to failover/switchover to specific member but it is not healthy[0m
[30;1m1409 | [0m[35m                logger.warning('%s: member %s is %s', action, st.member.name, not_allowed_reason)[0m
[30;1m1410 | [0m[35m[0m
[30;1m1411 | [0m[35m            # at this point we should consider all members as a candidates for failover/switchover[0m
[30;1m1412 | [0m[35m            # i.e. we assume that failover.candidate is None[0m
[30;1m1413 | [0m[35m        elif self.is_paused():[0m
[30;1m1414 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1287 | [0m[35m        members = [m for m in members if m.name != self.state_handler.name[0m
[30;1m1288 | [0m[35m                   and m.api_url and (not m.nofailover or m.name in voting_set)][0m
[30;1m1289 | [0m[35m[0m
[30;1m1290 | [0m[35m        # If there is a quorum active then at least one of the quorum contains latest commit. A quor[0m
[30;1m1291 | [0m[35m        # their WAL position is not ahead counts as a vote saying we may become new leader. Note tha[0m
[30;1m1292 | [0m[35m        # have to be a member of the voting set to gather the necessary votes.[0m
[30;1m1293 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m967 | [0m[35m        we can promote immediately and let normal quorum resolver process handle any membership chan[0m
[30;1m968 | [0m[35m        Otherwise, we will just reset DCS state to ourselves and add replicas as they connect.[0m
[30;1m969 | [0m[35m[0m
[30;1m970 | [0m[35m        :returns: ``True`` if on success or ``False`` if failed to update /sync key in DCS.[0m
[30;1m971 | [0m[35m        """[0m
[30;1m972 | [0m[35m        if not self.is_synchronous_mode():[0m
[30;1m973 | [0m[35m            self.disable_synchronous_replication()[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m927 | [0m[35m            picked = CaseInsensitiveSet('*')[0m
[30;1m928 | [0m[35m            logger.warning("No standbys available!")[0m
[30;1m929 | [0m[35m[0m
[30;1m930 | [0m[35m        # Update postgresql.conf and wait 2 secs for changes to become active[0m
[30;1m931 | [0m[35m        logger.info("Assigning synchronous standby status to %s", list(picked))[0m
[30;1m932 | [0m[35m        self.state_handler.sync_handler.set_synchronous_standby_names(picked)[0m
[30;1m933 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m913 | [0m[35m        if picked == voters:[0m
[30;1m914 | [0m[35m            return[0m
[30;1m915 | [0m[35m[0m
[30;1m916 | [0m[35m        # update synchronous standby list in dcs temporarily to point to common nodes in current and[0m
[30;1m917 | [0m[35m        sync_common = voters & allow_promote[0m
[30;1m918 | [0m[35m        if sync_common != voters:[0m
[30;1m919 | [0m[35m            logger.info("Updating synchronous privilege temporarily from %s to %s",[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m880 | [0m[35m                return[0m
[30;1m881 | [0m[35m            # synchronous_standby_names was transitioned from empty to non-empty and it may take[0m
[30;1m882 | [0m[35m            # some time for nodes to become synchronous. In this case we want to restart state machi[0m
[30;1m883 | [0m[35m            # hoping that we can update /sync key earlier than in loop_wait seconds.[0m
[30;1m884 | [0m[35m            time.sleep(1)[0m
[30;1m885 | [0m[35m            self.state_handler.reset_cluster_info_state(None)[0m
[30;1m886 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m812 | [0m[35m        .. note::[0m
[30;1m813 | [0m[35m            We fall back to using the value configured by the user for ``synchronous_standby_names``[0m
[30;1m814 | [0m[35m        """[0m
[30;1m815 | [0m[35m        # If synchronous_mode was turned off, we need to update synchronous_standby_names in Postgre[0m
[30;1m816 | [0m[35m        if not self.cluster.sync.is_empty and self.dcs.delete_sync_state(version=self.cluster.sync.v[0m
[30;1m817 | [0m[35m            logger.info("Disabled synchronous replication")[0m
[30;1m818 | [0m[35m            self.state_handler.sync_handler.set_synchronous_standby_names(CaseInsensitiveSet())[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m374 | [0m[35m            Last, but not least, this method calls a :meth:`Watchdog.keepalive` method after the lea[0m
[30;1m375 | [0m[35m            was successfully updated.[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m        :param update_status: ``True`` if we also need to update the ``/status`` key in DCS, otherwi[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m        :returns: ``True`` if the leader key was successfully updated and we can continue to run pos[0m
[30;1m380 | [0m[35m                  as a ``primary`` or as a ``standby_leader``, otherwise ``False``.[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m366 | [0m[35m[0m
[30;1m367 | [0m[35m        .. note::[0m
[30;1m368 | [0m[35m            After successful update of the leader key the :meth:`AbstractDCS.update_leader` method c[0m
[30;1m369 | [0m[35m            optionally update the ``/status`` and ``/failsafe`` keys.[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m            The ``/status`` key contains the last known LSN on the leader node and the last known st[0m
[30;1m372 | [0m[35m            of permanent replication slots including permanent physical replication slot for the lea[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m365 | [0m[35m        """Update the leader lock in DCS.[0m
[30;1m366 | [0m[35m[0m
[30;1m367 | [0m[35m        .. note::[0m
[30;1m368 | [0m[35m            After successful update of the leader key the :meth:`AbstractDCS.update_leader` method c[0m
[30;1m369 | [0m[35m            optionally update the ``/status`` and ``/failsafe`` keys.[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m            The ``/status`` key contains the last known LSN on the leader node and the last known st[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m291 | [0m[35m    def set_is_leader(self, value: bool) -> None:[0m
[30;1m292 | [0m[35m        """Update the current node's view of it's own leadership status.[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        Will update the expiry timestamp to match the dcs ttl if setting leadership to true,[0m
[30;1m295 | [0m[35m        otherwise will set the expiry to the past to immediately invalidate.[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m        :param value: is the current node the leader.[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m246 | [0m[35m        self._member_state_lock = RLock()[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m        # The last know value of current receive/flush/replay LSN.[0m
[30;1m249 | [0m[35m        # We update this value from update_lock() and touch_member() methods, because they fetch it [0m
[30;1m250 | [0m[35m        # This value is used to notify the leader when the failsafe_mode is active without performin[0m
[30;1m251 | [0m[35m        self._last_wal_lsn = None[0m
[30;1m252 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m191 | [0m[35m            On primary the :attr:`_last_update` is updated from the :func:`set_is_active` method and[0m
[30;1m192 | [0m[35m            returns the correct value.[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m            On replicas the :attr:`_last_update` is updated at the moment when the primary performs[0m
[30;1m195 | [0m[35m            ``POST /failsafe`` REST API calls.[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m            The side-effect - it is possible that replicas will show ``failsafe_is_active``[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m176 | [0m[35m            status = Status(cluster.status[0], leader.member.data['slots'], *cluster.status[2:])[0m
[30;1m177 | [0m[35m            cluster = Cluster(*cluster[0:2], leader, status, *cluster[4:])[0m
[30;1m178 | [0m[35m            # To advance LSN of replication slots on the primary for nodes that are doing cascading[0m
[30;1m179 | [0m[35m            # replication from other nodes we need to update `xlog_location` on respective members.[0m
[30;1m180 | [0m[35m            for member in cluster.members:[0m
[30;1m181 | [0m[35m                if member.replicatefrom and status.slots and member.name in status.slots:[0m
[30;1m182 | [0m[35m                    member.data['xlog_location'] = status.slots[member.name][0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m        """Update and return provided :class:`Cluster` object with fresh values.[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m        .. note::[0m
[30;1m167 | [0m[35m            This method is called when failsafe mode is active and is used to update cluster state[0m
[30;1m168 | [0m[35m            with fresh values of replication ``slots`` status and ``xlog_location`` on member nodes.[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m        :returns: :class:`Cluster` object, either unchanged or updated.[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m129 | [0m[35m    def update(self, data: Dict[str, Any]) -> None:[0m
[30;1m130 | [0m[35m        """Update the :class:`Failsafe` object state.[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        The last update time is stored and object will be invalidated after ``ttl`` seconds.[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        .. note::[0m
[30;1m135 | [0m[35m            This method is only called as a result of `POST /failsafe` REST API call.[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2402 | [0m[35m            if self.sync_mode_is_active() and not self.cluster.sync.matches(node.name)\[0m
[30;1m2403 | [0m[35m                    and not (failover and not failover.leader):[0m
[30;1m2404 | [0m[35m                return False[0m
[30;1m2405 | [0m[35m            # Don't spend time on "nofailover" nodes checking.[0m
[30;1m2406 | [0m[35m            # We also don't need nodes which we can't query with the api in the list.[0m
[30;1m2407 | [0m[35m            return node.name not in exclude and \[0m
[30;1m2408 | [0m[35m                not node.nofailover and bool(node.api_url) and \[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2398 | [0m[35m        exclude = [self.state_handler.name] + ([failover.candidate] if failover and exclude_failover[0m
[30;1m2399 | [0m[35m[0m
[30;1m2400 | [0m[35m        def is_eligible(node: Member) -> bool:[0m
[30;1m2401 | [0m[35m            # in synchronous mode we allow failover (not switchover!) to async node[0m
[30;1m2402 | [0m[35m            if self.sync_mode_is_active() and not self.cluster.sync.matches(node.name)\[0m
[30;1m2403 | [0m[35m                    and not (failover and not failover.leader):[0m
[30;1m2404 | [0m[35m                return False[0m
[30;1m2405 | [0m[35m            # Don't spend time on "nofailover" nodes checking.[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2384 | [0m[35m    def get_failover_candidates(self, exclude_failover_candidate: bool) -> List[Member]:[0m
[30;1m2385 | [0m[35m        """Return a list of candidates for either manual or automatic failover.[0m
[30;1m2386 | [0m[35m[0m
[30;1m2387 | [0m[35m        Exclude non-sync members when in synchronous mode, the current node (its checks are always p[0m
[30;1m2388 | [0m[35m        and the candidate if required. If failover candidate exclusion is not requested and a candid[0m
[30;1m2389 | [0m[35m        in the /failover key, return the candidate only.[0m
[30;1m2390 | [0m[35m        The result is further evaluated in the caller :func:`Ha.is_failover_possible` to check if an[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2362 | [0m[35m        self.dcs.event.set()[0m
[30;1m2363 | [0m[35m[0m
[30;1m2364 | [0m[35m    def get_remote_member(self, member: Union[Leader, Member, None] = None) -> RemoteMember:[0m
[30;1m2365 | [0m[35m        """Get remote member node to stream from.[0m
[30;1m2366 | [0m[35m[0m
[30;1m2367 | [0m[35m        In case of standby cluster this will tell us from which remote member to stream. Config can [0m
[30;1m2368 | [0m[35m        config or cluster.config.data.[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2358 | [0m[35m    def wakeup(self) -> None:[0m
[30;1m2359 | [0m[35m        """Trigger the next run of HA loop if there is no "active" leader watch request in progress.[0m
[30;1m2360 | [0m[35m[0m
[30;1m2361 | [0m[35m        This usually happens on the leader or if the node is running async action"""[0m
[30;1m2362 | [0m[35m        self.dcs.event.set()[0m
[30;1m2363 | [0m[35m[0m
[30;1m2364 | [0m[35m    def get_remote_member(self, member: Union[Leader, Member, None] = None) -> RemoteMember:[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2356 | [0m[35m        return self.dcs.watch(leader_version, timeout)[0m
[30;1m2357 | [0m[35m[0m
[30;1m2358 | [0m[35m    def wakeup(self) -> None:[0m
[30;1m2359 | [0m[35m        """Trigger the next run of HA loop if there is no "active" leader watch request in progress.[0m
[30;1m2360 | [0m[35m[0m
[30;1m2361 | [0m[35m        This usually happens on the leader or if the node is running async action"""[0m
[30;1m2362 | [0m[35m        self.dcs.event.set()[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2347 | [0m[35m                             (" Leaving watchdog running." if self.watchdog.is_running else ""))[0m
[30;1m2348 | [0m[35m[0m
[30;1m2349 | [0m[35m    def watch(self, timeout: float) -> bool:[0m
[30;1m2350 | [0m[35m        # watch on leader key changes if the postgres is running and leader is known and current nod[0m
[30;1m2351 | [0m[35m        if self._async_executor.busy or not self.cluster or self.cluster.is_unlocked() or self.has_l[0m
[30;1m2352 | [0m[35m            leader_version = None[0m
[30;1m2353 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2347 | [0m[35m                             (" Leaving watchdog running." if self.watchdog.is_running else ""))[0m
[30;1m2348 | [0m[35m[0m
[30;1m2349 | [0m[35m    def watch(self, timeout: float) -> bool:[0m
[30;1m2350 | [0m[35m        # watch on leader key changes if the postgres is running and leader is known and current nod[0m
[30;1m2351 | [0m[35m        if self._async_executor.busy or not self.cluster or self.cluster.is_unlocked() or self.has_l[0m
[30;1m2352 | [0m[35m            leader_version = None[0m
[30;1m2353 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2341 | [0m[35m                self.touch_member()[0m
[30;1m2342 | [0m[35m            else:[0m
[30;1m2343 | [0m[35m                # XXX: what about when Patroni is started as the wrong user that has access to the w[0m
[30;1m2344 | [0m[35m                # but cannot shut down PostgreSQL. Root would be the obvious example. Would be nice [0m
[30;1m2345 | [0m[35m                # system due to a bad config.[0m
[30;1m2346 | [0m[35m                logger.error("PostgreSQL shutdown failed, leader key not removed.%s",[0m
[30;1m2347 | [0m[35m                             (" Leaving watchdog running." if self.watchdog.is_running else ""))[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2318 | [0m[35m                    # It could happen if Postgres is still archiving the backlog of WAL files.[0m
[30;1m2319 | [0m[35m                    # If we know that there are replicas that received the shutdown checkpoint[0m
[30;1m2320 | [0m[35m                    # location, we can remove the leader key and allow them to start leader race.[0m
[30;1m2321 | [0m[35m                    time.sleep(1)  # give replicas some more time to catch up[0m
[30;1m2322 | [0m[35m                    if self.is_failover_possible(cluster_lsn=checkpoint_location):[0m
[30;1m2323 | [0m[35m                        self.dcs.delete_leader(self.cluster.leader, prev_location)[0m
[30;1m2324 | [0m[35m                        status['deleted'] = True[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2180 | [0m[35m                    if self.state_handler.is_running() and not self.state_handler.is_primary():[0m
[30;1m2181 | [0m[35m                        self._join_aborted = True[0m
[30;1m2182 | [0m[35m                        logger.error('No initialize key in DCS and PostgreSQL is running as replica,[0m
[30;1m2183 | [0m[35m                        logger.error('Please first start Patroni on the node running as primary')[0m
[30;1m2184 | [0m[35m                        sys.exit(1)[0m
[30;1m2185 | [0m[35m                    self.dcs.initialize(create_new=(self.cluster.initialize is None), sysid=data_sys[0m
[30;1m2186 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2172 | [0m[35m                                self.release_leader_key_voluntarily()[0m
[30;1m2173 | [0m[35m                                return 'released leader key voluntarily due to the system ID mismatc[0m
[30;1m2174 | [0m[35m                        else:[0m
[30;1m2175 | [0m[35m                            logger.fatal('system ID mismatch, node %s belongs to a different cluster[0m
[30;1m2176 | [0m[35m                                         self.state_handler.name, self.cluster.initialize, data_sysi[0m
[30;1m2177 | [0m[35m                            sys.exit(1)[0m
[30;1m2178 | [0m[35m                elif self.cluster.is_unlocked() and not self.is_paused() and not self.state_handler.[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2154 | [0m[35m                    return 'data directory is not accessible: {0}'.format(data_directory_error)[0m
[30;1m2155 | [0m[35m                if self.is_paused():[0m
[30;1m2156 | [0m[35m                    return 'running with empty data directory'[0m
[30;1m2157 | [0m[35m                return self.bootstrap()  # new node[0m
[30;1m2158 | [0m[35m            else:[0m
[30;1m2159 | [0m[35m                # check if we are allowed to join[0m
[30;1m2160 | [0m[35m                data_sysid = self.state_handler.sysid[0m
[30;1m2161 | [0m[35m                if not self.sysid_valid(data_sysid):[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2123 | [0m[35m                if self._rewind.executed and not self._rewind.failed:[0m
[30;1m2124 | [0m[35m                    self._rewind.reset_state()[0m
[30;1m2125 | [0m[35m[0m
[30;1m2126 | [0m[35m                # The Raft cluster without a quorum takes a bit of time to stabilize.[0m
[30;1m2127 | [0m[35m                # Therefore we want to postpone the leader race if we just started up.[0m
[30;1m2128 | [0m[35m                if self.cluster.is_unlocked() and self.dcs.__class__.__name__ == 'Raft':[0m
[30;1m2129 | [0m[35m                    return 'started as a secondary'[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2052 | [0m[35m            return None[0m
[30;1m2053 | [0m[35m[0m
[30;1m2054 | [0m[35m    def set_start_timeout(self, value: Optional[int]) -> None:[0m
[30;1m2055 | [0m[35m        """Sets timeout for starting as primary before eligible for failover.[0m
[30;1m2056 | [0m[35m[0m
[30;1m2057 | [0m[35m        Must be called when async_executor is busy or in the main thread.[0m
[30;1m2058 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2031 | [0m[35m                return 'stopped PostgreSQL while starting up because leader key was lost'[0m
[30;1m2032 | [0m[35m[0m
[30;1m2033 | [0m[35m            timeout = self._start_timeout or global_config.primary_start_timeout[0m
[30;1m2034 | [0m[35m            time_left = timeout - self.state_handler.time_in_state()[0m
[30;1m2035 | [0m[35m[0m
[30;1m2036 | [0m[35m            if time_left <= 0:[0m
[30;1m2037 | [0m[35m                if self.is_failover_possible():[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2030 | [0m[35m                self.demote('immediate-nolock')[0m
[30;1m2031 | [0m[35m                return 'stopped PostgreSQL while starting up because leader key was lost'[0m
[30;1m2032 | [0m[35m[0m
[30;1m2033 | [0m[35m            timeout = self._start_timeout or global_config.primary_start_timeout[0m
[30;1m2034 | [0m[35m            time_left = timeout - self.state_handler.time_in_state()[0m
[30;1m2035 | [0m[35m[0m
[30;1m2036 | [0m[35m            if time_left <= 0:[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1866 | [0m[35m        def after_start() -> None:[0m
[30;1m1867 | [0m[35m            self.notify_mpp_coordinator('after_promote')[0m
[30;1m1868 | [0m[35m[0m
[30;1m1869 | [0m[35m        # For non async cases we want to wait for restart to complete or timeout before returning.[0m
[30;1m1870 | [0m[35m        do_restart = functools.partial(self.state_handler.restart, timeout, self._async_executor.cri[0m
[30;1m1871 | [0m[35m                                       before_shutdown=before_shutdown if self.has_lock() else None,[0m
[30;1m1872 | [0m[35m                                       after_start=after_start if self.has_lock() else None)[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1857 | [0m[35m[0m
[30;1m1858 | [0m[35m        # Now that restart is scheduled we can set timeout for startup, it will get reset[0m
[30;1m1859 | [0m[35m        # once async executor runs and main loop notices PostgreSQL as up.[0m
[30;1m1860 | [0m[35m        timeout = restart_data.get('timeout', global_config.primary_start_timeout)[0m
[30;1m1861 | [0m[35m        self.set_start_timeout(timeout)[0m
[30;1m1862 | [0m[35m[0m
[30;1m1863 | [0m[35m        def before_shutdown() -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1855 | [0m[35m            # leader key (if it belong to us) rather than trying to start postgres once again.[0m
[30;1m1856 | [0m[35m            self.recovering = True[0m
[30;1m1857 | [0m[35m[0m
[30;1m1858 | [0m[35m        # Now that restart is scheduled we can set timeout for startup, it will get reset[0m
[30;1m1859 | [0m[35m        # once async executor runs and main loop notices PostgreSQL as up.[0m
[30;1m1860 | [0m[35m        timeout = restart_data.get('timeout', global_config.primary_start_timeout)[0m
[30;1m1861 | [0m[35m        self.set_start_timeout(timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1851 | [0m[35m                return (False, prev + ' already in progress')[0m
[30;1m1852 | [0m[35m[0m
[30;1m1853 | [0m[35m            # Make the main loop to think that we were recovering dead postgres. If we fail[0m
[30;1m1854 | [0m[35m            # to start postgres after a specified timeout (see below), we need to remove[0m
[30;1m1855 | [0m[35m            # leader key (if it belong to us) rather than trying to start postgres once again.[0m
[30;1m1856 | [0m[35m            self.recovering = True[0m
[30;1m1857 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1776 | [0m[35m        if restart_data:[0m
[30;1m1777 | [0m[35m            recent_time = self.state_handler.postmaster_start_time()[0m
[30;1m1778 | [0m[35m            request_time = restart_data['postmaster_start_time'][0m
[30;1m1779 | [0m[35m            # check if postmaster start time has changed since the last restart[0m
[30;1m1780 | [0m[35m            if recent_time and request_time and recent_time != request_time:[0m
[30;1m1781 | [0m[35m                logger.info("Cancelling scheduled restart: postgres restart has already happened at [0m
[30;1m1782 | [0m[35m                self.delete_future_restart()[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1730 | [0m[35m                if msg is not None:[0m
[30;1m1731 | [0m[35m                    return msg[0m
[30;1m1732 | [0m[35m[0m
[30;1m1733 | [0m[35m                # check if the node is ready to be used by pg_rewind[0m
[30;1m1734 | [0m[35m                self._rewind.ensure_checkpoint_after_promote(self.wakeup)[0m
[30;1m1735 | [0m[35m[0m
[30;1m1736 | [0m[35m                if self.is_standby_cluster():[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1706 | [0m[35m            # node tagged as nofailover can be ahead of the new leader either, but it is always excl[0m
[30;1m1707 | [0m[35m            if bool(self.cluster.failover) or self.patroni.nofailover:[0m
[30;1m1708 | [0m[35m                self._rewind.trigger_check_diverged_lsn()[0m
[30;1m1709 | [0m[35m                time.sleep(2)  # Give a time to somebody to take the leader lock[0m
[30;1m1710 | [0m[35m[0m
[30;1m1711 | [0m[35m            if self.patroni.nofailover:[0m
[30;1m1712 | [0m[35m                return self.follow('demoting self because I am not allowed to become primary',[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1703 | [0m[35m                                   'following new leader after trying and failing to obtain lock')[0m
[30;1m1704 | [0m[35m        else:[0m
[30;1m1705 | [0m[35m            # when we are doing manual failover there is no guaranty that new leader is ahead of any[0m
[30;1m1706 | [0m[35m            # node tagged as nofailover can be ahead of the new leader either, but it is always excl[0m
[30;1m1707 | [0m[35m            if bool(self.cluster.failover) or self.patroni.nofailover:[0m
[30;1m1708 | [0m[35m                self._rewind.trigger_check_diverged_lsn()[0m
[30;1m1709 | [0m[35m                time.sleep(2)  # Give a time to somebody to take the leader lock[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1702 | [0m[35m      return self.follow('demoted self after trying and failing to obtain lock',[0m
[30;1m1703 | [0m[35m                                   'following new leader after trying and failing to obtain lock')[0m
[30;1m1704 | [0m[35m        else:[0m
[30;1m1705 | [0m[35m            # when we are doing manual failover there is no guaranty that new leader is ahead of any[0m
[30;1m1706 | [0m[35m            # node tagged as nofailover can be ahead of the new leader either, but it is always excl[0m
[30;1m1707 | [0m[35m            if bool(self.cluster.failover) or self.patroni.nofailover:[0m
[30;1m1708 | [0m[35m                self._rewind.trigger_check_diverged_lsn()[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1648 | [0m[35m        action = self._get_failover_action_name()[0m
[30;1m1649 | [0m[35m        bare_action = action.replace('manual ', '')[0m
[30;1m1650 | [0m[35m[0m
[30;1m1651 | [0m[35m        # it is not the time for the scheduled switchover yet, do nothing[0m
[30;1m1652 | [0m[35m        if (failover.scheduled_at and not[0m
[30;1m1653 | [0m[35m            self.should_run_scheduled_action(bare_action, failover.scheduled_at, lambda:[0m
[30;1m1654 | [0m[35m                                             self.dcs.manual_failover('', '', version=failover.versi[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1574 | [0m[35m                checkpoint_location = self.state_handler.latest_checkpoint_location() if mode == 'gr[0m
[30;1m1575 | [0m[35m                with self._async_executor:[0m
[30;1m1576 | [0m[35m                    self.release_leader_key_voluntarily(checkpoint_location)[0m
[30;1m1577 | [0m[35m            time.sleep(2)  # Give a time to somebody to take the leader lock[0m
[30;1m1578 | [0m[35m        if mode_control['offline']:[0m
[30;1m1579 | [0m[35m            node_to_follow, leader = None, None[0m
[30;1m1580 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1548 | [0m[35m            # It could happen if Postgres is still archiving the backlog of WAL files.[0m
[30;1m1549 | [0m[35m            # If we know that there are replicas that received the shutdown checkpoint[0m
[30;1m1550 | [0m[35m            # location, we can remove the leader key and allow them to start leader race.[0m
[30;1m1551 | [0m[35m            time.sleep(1)  # give replicas some more time to catch up[0m
[30;1m1552 | [0m[35m            if self.is_failover_possible(cluster_lsn=checkpoint_location):[0m
[30;1m1553 | [0m[35m                self.state_handler.set_role('demoted')[0m
[30;1m1554 | [0m[35m                with self._async_executor:[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1525 | [0m[35m                     running async.[0m
[30;1m1526 | [0m[35m                     ``immediate`` is used when we determine that we are not suitable for primary an[0m
[30;1m1527 | [0m[35m                     quickly without regard for data durability. May only be called synchronously.[0m
[30;1m1528 | [0m[35m                     ``immediate-nolock`` is used when find out that we have lost the lock to be pri[0m
[30;1m1529 | [0m[35m                     down PostgreSQL as quickly as possible without regard for data durability. May [0m
[30;1m1530 | [0m[35m                     synchronously.[0m
[30;1m1531 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1521 | [0m[35m[0m
[30;1m1522 | [0m[35m        :param mode: One of offline, graceful, immediate or immediate-nolock.[0m
[30;1m1523 | [0m[35m                     ``offline`` is used when connection to DCS is not available.[0m
[30;1m1524 | [0m[35m                     ``graceful`` is used when failing over to another node due to user request. May[0m
[30;1m1525 | [0m[35m                     running async.[0m
[30;1m1526 | [0m[35m                     ``immediate`` is used when we determine that we are not suitable for primary an[0m
[30;1m1527 | [0m[35m                     quickly without regard for data durability. May only be called synchronously.[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1485 | [0m[35m            failsafe_members = self.dcs.failsafe[0m
[30;1m1486 | [0m[35m            # We want to discard failsafe_mode if the /failsafe key contains garbage or empty.[0m
[30;1m1487 | [0m[35m            if isinstance(failsafe_members, dict):[0m
[30;1m1488 | [0m[35m                # If current node is missing in the /failsafe key we immediately disqualify it from [0m
[30;1m1489 | [0m[35m                if failsafe_members and self.state_handler.name not in failsafe_members:[0m
[30;1m1490 | [0m[35m                    return False[0m
[30;1m1491 | [0m[35m                # Race among not only existing cluster members, but also all known members from the [0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1466 | [0m[35m        if self.is_paused():[0m
[30;1m1467 | [0m[35m            return False[0m
[30;1m1468 | [0m[35m[0m
[30;1m1469 | [0m[35m        if self.patroni.nofailover:  # nofailover tag makes node always unhealthy[0m
[30;1m1470 | [0m[35m            return False[0m
[30;1m1471 | [0m[35m[0m
[30;1m1472 | [0m[35m        if self.cluster.failover:[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1436 | [0m[35m        :returns: `True` if the current node is among the best candidates to become the new leader.[0m
[30;1m1437 | [0m[35m        """[0m
[30;1m1438 | [0m[35m        if time.time() - self._released_leader_key_timestamp < self.dcs.ttl:[0m
[30;1m1439 | [0m[35m            logger.info('backoff: skip leader race after pre_promote script failure and releasing th[0m
[30;1m1440 | [0m[35m            return False[0m
[30;1m1441 | [0m[35m[0m
[30;1m1442 | [0m[35m        if self.is_paused() and not self.patroni.nofailover and \[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1433 | [0m[35m[0m
[30;1m1434 | [0m[35m        In case if manual failover/switchover is requested it calls :func:`manual_failover_process_n[0m
[30;1m1435 | [0m[35m[0m
[30;1m1436 | [0m[35m        :returns: `True` if the current node is among the best candidates to become the new leader.[0m
[30;1m1437 | [0m[35m        """[0m
[30;1m1438 | [0m[35m        if time.time() - self._released_leader_key_timestamp < self.dcs.ttl:[0m
[30;1m1439 | [0m[35m            logger.info('backoff: skip leader race after pre_promote script failure and releasing th[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1429 | [0m[35m        return self._is_healthiest_node(members, check_replication_lag=False)[0m
[30;1m1430 | [0m[35m[0m
[30;1m1431 | [0m[35m    def is_healthiest_node(self) -> bool:[0m
[30;1m1432 | [0m[35m        """Performs a series of checks to determine that the current node is the best candidate.[0m
[30;1m1433 | [0m[35m[0m
[30;1m1434 | [0m[35m        In case if manual failover/switchover is requested it calls :func:`manual_failover_process_n[0m
[30;1m1435 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1422 | [0m[35m                else:  # I was the leader and it looks like currently I am the only healthy member[0m
[30;1m1423 | [0m[35m                    return True[0m
[30;1m1424 | [0m[35m[0m
[30;1m1425 | [0m[35m            # at this point we assume that our node is a candidate for a failover among all nodes ex[0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m        # exclude former leader from the list (failover.leader can be None)[0m
[30;1m1428 | [0m[35m        members = [m for m in self.cluster.members if m.name != failover.leader][0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1402 | [0m[35m            if isinstance(member, Member):[0m
[30;1m1403 | [0m[35m                st = self.fetch_node_status(member)[0m
[30;1m1404 | [0m[35m                not_allowed_reason = st.failover_limitation()[0m
[30;1m1405 | [0m[35m                if not_allowed_reason is None:  # node is healthy[0m
[30;1m1406 | [0m[35m                    logger.info('%s: to %s, i am %s', action, st.member.name, self.state_handler.nam[0m
[30;1m1407 | [0m[35m                    return False[0m
[30;1m1408 | [0m[35m                # we wanted to failover/switchover to specific member but it is not healthy[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1397 | [0m[35m                    and not self.cluster.sync.matches(self.state_handler.name, True):[0m
[30;1m1398 | [0m[35m                return False[0m
[30;1m1399 | [0m[35m[0m
[30;1m1400 | [0m[35m            # find specific node and check that it is healthy[0m
[30;1m1401 | [0m[35m            member = self.cluster.get_member(failover.candidate, fallback_to_leader=False)[0m
[30;1m1402 | [0m[35m            if isinstance(member, Member):[0m
[30;1m1403 | [0m[35m                st = self.fetch_node_status(member)[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1397 | [0m[35m                    and not self.cluster.sync.matches(self.state_handler.name, True):[0m
[30;1m1398 | [0m[35m                return False[0m
[30;1m1399 | [0m[35m[0m
[30;1m1400 | [0m[35m            # find specific node and check that it is healthy[0m
[30;1m1401 | [0m[35m            member = self.cluster.get_member(failover.candidate, fallback_to_leader=False)[0m
[30;1m1402 | [0m[35m            if isinstance(member, Member):[0m
[30;1m1403 | [0m[35m                st = self.fetch_node_status(member)[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1382 | [0m[35m            if failover.candidate == self.state_handler.name:  # manual failover/switchover to me[0m
[30;1m1383 | [0m[35m                return True[0m
[30;1m1384 | [0m[35m            elif self.is_paused():[0m
[30;1m1385 | [0m[35m                # Remove failover key if the node to failover has terminated to avoid waiting for it[0m
[30;1m1386 | [0m[35m                # In order to avoid attempts to delete this key from all nodes only the primary is a[0m
[30;1m1387 | [0m[35m                if not self.cluster.get_member(failover.candidate, fallback_to_leader=False)\[0m
[30;1m1388 | [0m[35m                        and self.state_handler.is_primary():[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1370 | [0m[35m        """Handles manual failover/switchover when the old leader already stepped down.[0m
[30;1m1371 | [0m[35m[0m
[30;1m1372 | [0m[35m        :returns: - `True` if the current node is the best candidate to become the new leader[0m
[30;1m1373 | [0m[35m                  - `None` if the current node is running as a primary and requested candidate doesn[0m
[30;1m1374 | [0m[35m        """[0m
[30;1m1375 | [0m[35m        failover = self.cluster.failover[0m
[30;1m1376 | [0m[35m        if TYPE_CHECKING:  # pragma: no cover[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1369 | [0m[35m    def manual_failover_process_no_leader(self) -> Optional[bool]:[0m
[30;1m1370 | [0m[35m        """Handles manual failover/switchover when the old leader already stepped down.[0m
[30;1m1371 | [0m[35m[0m
[30;1m1372 | [0m[35m        :returns: - `True` if the current node is the best candidate to become the new leader[0m
[30;1m1373 | [0m[35m                  - `None` if the current node is running as a primary and requested candidate doesn[0m
[30;1m1374 | [0m[35m        """[0m
[30;1m1375 | [0m[35m        failover = self.cluster.failover[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1317 | [0m[35m                    if low_priority and (not self.sync_mode_is_active() or quorum_vote):[0m
[30;1m1318 | [0m[35m                        # There's a higher priority non-lagging replica[0m
[30;1m1319 | [0m[35m                        logger.info([0m
[30;1m1320 | [0m[35m                            '%s has equally tolerable WAL position and priority %s, while this node [0m
[30;1m1321 | [0m[35m                            st.member.name, st.failover_priority, self.patroni.failover_priority)[0m
[30;1m1322 | [0m[35m                        return False[0m
[30;1m1323 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1291 | [0m[35m        # their WAL position is not ahead counts as a vote saying we may become new leader. Note tha[0m
[30;1m1292 | [0m[35m        # have to be a member of the voting set to gather the necessary votes.[0m
[30;1m1293 | [0m[35m[0m
[30;1m1294 | [0m[35m        # Regardless of voting, if we observe a node that can become a leader and is ahead, we defer[0m
[30;1m1295 | [0m[35m        # This can lead to failure to act on quorum if there is asymmetric connectivity.[0m
[30;1m1296 | [0m[35m        quorum_votes = 0 if self.state_handler.name in voting_set else -1[0m
[30;1m1297 | [0m[35m        nodes_ahead = 0[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1288 | [0m[35m                   and m.api_url and (not m.nofailover or m.name in voting_set)][0m
[30;1m1289 | [0m[35m[0m
[30;1m1290 | [0m[35m        # If there is a quorum active then at least one of the quorum contains latest commit. A quor[0m
[30;1m1291 | [0m[35m        # their WAL position is not ahead counts as a vote saying we may become new leader. Note tha[0m
[30;1m1292 | [0m[35m        # have to be a member of the voting set to gather the necessary votes.[0m
[30;1m1293 | [0m[35m[0m
[30;1m1294 | [0m[35m        # Regardless of voting, if we observe a node that can become a leader and is ahead, we defer[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1255 | [0m[35m        :param members: the list of nodes to check against[0m
[30;1m1256 | [0m[35m        :param check_replication_lag: whether to take the replication lag into account.[0m
[30;1m1257 | [0m[35m                                      If the lag exceeds configured threshold the node disqualifies [0m
[30;1m1258 | [0m[35m        :returns: ``True`` if the node is eligible to become the new leader. Since this method is ex[0m
[30;1m1259 | [0m[35m                  on multiple nodes independently it is possible that multiple nodes could count[0m
[30;1m1260 | [0m[35m                  themselves as the healthiest because they received/replayed up to the same LSN,[0m
[30;1m1261 | [0m[35m                  but this is totally fine.[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1254 | [0m[35m[0m
[30;1m1255 | [0m[35m        :param members: the list of nodes to check against[0m
[30;1m1256 | [0m[35m        :param check_replication_lag: whether to take the replication lag into account.[0m
[30;1m1257 | [0m[35m                                      If the lag exceeds configured threshold the node disqualifies [0m
[30;1m1258 | [0m[35m        :returns: ``True`` if the node is eligible to become the new leader. Since this method is ex[0m
[30;1m1259 | [0m[35m                  on multiple nodes independently it is possible that multiple nodes could count[0m
[30;1m1260 | [0m[35m                  themselves as the healthiest because they received/replayed up to the same LSN,[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1250 | [0m[35m        return lag > global_config.maximum_lag_on_failover[0m
[30;1m1251 | [0m[35m[0m
[30;1m1252 | [0m[35m    def _is_healthiest_node(self, members: Collection[Member], check_replication_lag: bool = True) -[0m
[30;1m1253 | [0m[35m        """Determine whether the current node is healthy enough to become a new leader candidate.[0m
[30;1m1254 | [0m[35m[0m
[30;1m1255 | [0m[35m        :param members: the list of nodes to check against[0m
[30;1m1256 | [0m[35m        :param check_replication_lag: whether to take the replication lag into account.[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1244 | [0m[35m[0m
[30;1m1245 | [0m[35m        :param wal_position: Current wal position.[0m
[30;1m1246 | [0m[35m[0m
[30;1m1247 | [0m[35m        :returns: ``True`` when node is lagging[0m
[30;1m1248 | [0m[35m        """[0m
[30;1m1249 | [0m[35m        lag = self.cluster.status.last_lsn - wal_position[0m
[30;1m1250 | [0m[35m        return lag > global_config.maximum_lag_on_failover[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1240 | [0m[35m        return ret[0m
[30;1m1241 | [0m[35m[0m
[30;1m1242 | [0m[35m    def is_lagging(self, wal_position: int) -> bool:[0m
[30;1m1243 | [0m[35m        """Check if node should consider itself unhealthy to be promoted due to replication lag.[0m
[30;1m1244 | [0m[35m[0m
[30;1m1245 | [0m[35m        :param wal_position: Current wal position.[0m
[30;1m1246 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1225 | [0m[35m[0m
[30;1m1226 | [0m[35m        members = [RemoteMember(name, {'api_url': url})[0m
[30;1m1227 | [0m[35m                   for name, url in failsafe.items() if name != self.state_handler.name][0m
[30;1m1228 | [0m[35m        if not members:  # A single node cluster[0m
[30;1m1229 | [0m[35m            return True[0m
[30;1m1230 | [0m[35m        pool = ThreadPool(len(members))[0m
[30;1m1231 | [0m[35m        call_failsafe_member = functools.partial(self.call_failsafe_member, data)[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1207 | [0m[35m            used by the primary to advance position of replication slots that for nodes that are doi[0m
[30;1m1208 | [0m[35m            replication from other nodes. It is required to avoid indefinite growth of ``pg_wal``.[0m
[30;1m1209 | [0m[35m[0m
[30;1m1210 | [0m[35m        :returns: ``True`` if all members from the ``/failsafe`` topology agree that this node could[0m
[30;1m1211 | [0m[35m                  run as a ``primary``, or ``False`` if some of standby nodes are not accessible or [0m
[30;1m1212 | [0m[35m        """[0m
[30;1m1213 | [0m[35m        failsafe = self.dcs.failsafe[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1196 | [0m[35m[0m
[30;1m1197 | [0m[35m            * ``name`` - the name of our node;[0m
[30;1m1198 | [0m[35m            * ``conn_url`` - connection URL to the postgres, which is reachable from other nodes;[0m
[30;1m1199 | [0m[35m            * ``api_url`` - connection URL to Patroni REST API on this node reachable from other nod[0m
[30;1m1200 | [0m[35m            * ``slots`` - a :class:`dict` with replication slots that exist on the leader node, incl[0m
[30;1m1201 | [0m[35m              itself with the last known LSN, because there could be a permanent physical slot on st[0m
[30;1m1202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1189 | [0m[35m        """Check whether we could continue to run as a primary by calling all members from the fails[0m
[30;1m1190 | [0m[35m[0m
[30;1m1191 | [0m[35m        .. note::[0m
[30;1m1192 | [0m[35m            If the ``/failsafe`` key contains invalid data or if the ``name`` of our node is missing[0m
[30;1m1193 | [0m[35m            the ``/failsafe`` key, we immediately give up and return ``False``.[0m
[30;1m1194 | [0m[35m[0m
[30;1m1195 | [0m[35m            We send the JSON document in the POST request with the following fields:[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1128 | [0m[35m[0m
[30;1m1129 | [0m[35m        Usually this happens during the leader race and we can't afford to wait an indefinite time[0m
[30;1m1130 | [0m[35m        for a response, therefore the request timeout is hardcoded to 2 seconds, which seems to be a[0m
[30;1m1131 | [0m[35m        good compromise. The node which is slow to respond is most likely unhealthy.[0m
[30;1m1132 | [0m[35m[0m
[30;1m1133 | [0m[35m        :returns: :class:`_MemberStatus` object[0m
[30;1m1134 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1127 | [0m[35m        """Perform http get request on member.api_url to fetch its status.[0m
[30;1m1128 | [0m[35m[0m
[30;1m1129 | [0m[35m        Usually this happens during the leader race and we can't afford to wait an indefinite time[0m
[30;1m1130 | [0m[35m        for a response, therefore the request timeout is hardcoded to 2 seconds, which seems to be a[0m
[30;1m1131 | [0m[35m        good compromise. The node which is slow to respond is most likely unhealthy.[0m
[30;1m1132 | [0m[35m[0m
[30;1m1133 | [0m[35m        :returns: :class:`_MemberStatus` object[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1126 | [0m[35m    def fetch_node_status(self, member: Member) -> _MemberStatus:[0m
[30;1m1127 | [0m[35m        """Perform http get request on member.api_url to fetch its status.[0m
[30;1m1128 | [0m[35m[0m
[30;1m1129 | [0m[35m        Usually this happens during the leader race and we can't afford to wait an indefinite time[0m
[30;1m1130 | [0m[35m        for a response, therefore the request timeout is hardcoded to 2 seconds, which seems to be a[0m
[30;1m1131 | [0m[35m        good compromise. The node which is slow to respond is most likely unhealthy.[0m
[30;1m1132 | [0m[35m[0m
[30;1m1133 | [0m[35m        :returns: :class:`_MemberStatus` object[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1091 | [0m[35m                    self.release_leader_key_voluntarily()[0m
[30;1m1092 | [0m[35m                    # discard the result of the failed pre-promote script to be able to re-try promo[0m
[30;1m1093 | [0m[35m                    self._async_response.reset()[0m
[30;1m1094 | [0m[35m                    return 'Promotion cancelled because the pre-promote script failed'[0m
[30;1m1095 | [0m[35m[0m
[30;1m1096 | [0m[35m        if self.state_handler.is_primary():[0m
[30;1m1097 | [0m[35m            # Inform the state handler about its primary role.[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1089 | [0m[35m                    logger.warning("Releasing the leader key voluntarily because the pre-promote scr[0m
[30;1m1090 | [0m[35m                    self._released_leader_key_timestamp = time.time()[0m
[30;1m1091 | [0m[35m                    self.release_leader_key_voluntarily()[0m
[30;1m1092 | [0m[35m                    # discard the result of the failed pre-promote script to be able to re-try promo[0m
[30;1m1093 | [0m[35m                    self._async_response.reset()[0m
[30;1m1094 | [0m[35m                    return 'Promotion cancelled because the pre-promote script failed'[0m
[30;1m1095 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1086 | [0m[35m[0m
[30;1m1087 | [0m[35m            with self._async_response:[0m
[30;1m1088 | [0m[35m                if self._async_response.result is False:[0m
[30;1m1089 | [0m[35m                    logger.warning("Releasing the leader key voluntarily because the pre-promote scr[0m
[30;1m1090 | [0m[35m                    self._released_leader_key_timestamp = time.time()[0m
[30;1m1091 | [0m[35m                    self.release_leader_key_voluntarily()[0m
[30;1m1092 | [0m[35m                    # discard the result of the failed pre-promote script to be able to re-try promo[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1073 | [0m[35m    def enforce_primary_role(self, message: str, promote_message: str) -> str:[0m
[30;1m1074 | [0m[35m        """[0m
[30;1m1075 | [0m[35m        Ensure the node that has won the race for the leader key meets criteria[0m
[30;1m1076 | [0m[35m        for promoting its PG server to the 'primary' role.[0m
[30;1m1077 | [0m[35m        """[0m
[30;1m1078 | [0m[35m        if not self.is_paused():[0m
[30;1m1079 | [0m[35m            if not self.watchdog.is_running and not self.watchdog.activate():[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1072 | [0m[35m[0m
[30;1m1073 | [0m[35m    def enforce_primary_role(self, message: str, promote_message: str) -> str:[0m
[30;1m1074 | [0m[35m        """[0m
[30;1m1075 | [0m[35m        Ensure the node that has won the race for the leader key meets criteria[0m
[30;1m1076 | [0m[35m        for promoting its PG server to the 'primary' role.[0m
[30;1m1077 | [0m[35m        """[0m
[30;1m1078 | [0m[35m        if not self.is_paused():[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1007 | [0m[35m        When running in ``synchronous_mode`` with ``synchronous_node_count = 2``, shutdown or restar[0m
[30;1m1008 | [0m[35m        synchronous standby may cause a write downtime. Therefore we need to signal a primary that w[0m
[30;1m1009 | [0m[35m        to by synchronous anymore and wait until it will replace our name from ``synchronous_standby[0m
[30;1m1010 | [0m[35m        and ``/sync`` key in DCS with some other node. Once current node is not synchronous we will [0m
[30;1m1011 | [0m[35m[0m
[30;1m1012 | [0m[35m        .. note::[0m
[30;1m1013 | [0m[35m            If the connection to DCS fails we run the *func* anyway, as this is only a hint.[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1002 | [0m[35m            and cluster.sync.matches(self.state_handler.name)[0m
[30;1m1003 | [0m[35m[0m
[30;1m1004 | [0m[35m    def while_not_sync_standby(self, func: Callable[..., Any]) -> Any:[0m
[30;1m1005 | [0m[35m        """Runs specified action while trying to make sure that the node is not assigned synchronous[0m
[30;1m1006 | [0m[35m[0m
[30;1m1007 | [0m[35m        When running in ``synchronous_mode`` with ``synchronous_node_count = 2``, shutdown or restar[0m
[30;1m1008 | [0m[35m        synchronous standby may cause a write downtime. Therefore we need to signal a primary that w[0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m997 | [0m[35m        return True[0m
[30;1m998 | [0m[35m[0m
[30;1m999 | [0m[35m    def is_sync_standby(self, cluster: Cluster) -> bool:[0m
[30;1m1000 | [0m[35m        """:returns: `True` if the current node is a synchronous standby."""[0m
[30;1m1001 | [0m[35m        return bool(cluster.leader) and cluster.sync.leader_matches(cluster.leader.name) \[0m
[30;1m1002 | [0m[35m            and cluster.sync.matches(self.state_handler.name)[0m
[30;1m1003 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m976 | [0m[35m        if self.quorum_commit_mode_is_active():[0m
[30;1m977 | [0m[35m            sync = CaseInsensitiveSet(self.cluster.sync.members)[0m
[30;1m978 | [0m[35m            numsync = len(sync) - self.cluster.sync.quorum - 1[0m
[30;1m979 | [0m[35m            if self.state_handler.name not in sync:  # Node outside voters achieved quorum and got l[0m
[30;1m980 | [0m[35m                numsync += 1[0m
[30;1m981 | [0m[35m            else:[0m
[30;1m982 | [0m[35m                sync.discard(self.state_handler.name)[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m889 | [0m[35m[0m
[30;1m890 | [0m[35m        Synchronous standbys are registered in two places postgresql.conf and DCS. The order of upda[0m
[30;1m891 | [0m[35m        be right. The invariant that should be kept is that if a node is primary and sync_standby is[0m
[30;1m892 | [0m[35m        then that node must have synchronous_standby set to that value. Or more simple, first set in[0m
[30;1m893 | [0m[35m        and then in DCS. When removing, first remove in DCS, then in postgresql.conf. This is so we [0m
[30;1m894 | [0m[35m        promoting standbys that were guaranteed to be replicating synchronously.[0m
[30;1m895 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m887 | [0m[35ms_multisync_replication(self) -> None:[0m
[30;1m888 | [0m[35m        """Process synchronous replication state with one or more sync standbys.[0m
[30;1m889 | [0m[35m[0m
[30;1m890 | [0m[35m        Synchronous standbys are registered in two places postgresql.conf and DCS. The order of upda[0m
[30;1m891 | [0m[35m        be right. The invariant that should be kept is that if a node is primary and sync_standby is[0m
[30;1m892 | [0m[35m        then that node must have synchronous_standby set to that value. Or more simple, first set in[0m
[30;1m893 | [0m[35m        and then in DCS. When removing, first remove in DCS, then in postgresql.conf. This is so we [0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m879 | [0m[35m            if transition != 'restart' or _check_timeout(1):[0m
[30;1m880 | [0m[35m                return[0m
[30;1m881 | [0m[35m            # synchronous_standby_names was transitioned from empty to non-empty and it may take[0m
[30;1m882 | [0m[35m            # some time for nodes to become synchronous. In this case we want to restart state machi[0m
[30;1m883 | [0m[35m            # hoping that we can update /sync key earlier than in loop_wait seconds.[0m
[30;1m884 | [0m[35m            time.sleep(1)[0m
[30;1m885 | [0m[35m            self.state_handler.reset_cluster_info_state(None)[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m702 | [0m[35m                and (cluster.leader and cluster.leader.name and cluster.leader.name == self.state_ha[0m
[30;1m703 | [0m[35m                     or cluster.is_unlocked() and not self.is_paused()):[0m
[30;1m704 | [0m[35m            node_to_follow = self.get_remote_member()[0m
[30;1m705 | [0m[35m        # If replicatefrom tag is set, try to follow the node mentioned there, otherwise, follow the[0m
[30;1m706 | [0m[35m        elif self.patroni.replicatefrom and self.patroni.replicatefrom != self.state_handler.name:[0m
[30;1m707 | [0m[35m            node_to_follow = cluster.get_member(self.patroni.replicatefrom)[0m
[30;1m708 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m693 | [0m[35m[0m
[30;1m694 | [0m[35m        :returns: the node which we should be replicating from.[0m
[30;1m695 | [0m[35m        """[0m
[30;1m696 | [0m[35m        # nostream is set, the node must not use WAL streaming[0m
[30;1m697 | [0m[35m        if self.patroni.nostream:[0m
[30;1m698 | [0m[35m            return None[0m
[30;1m699 | [0m[35m        # The standby leader or when there is no standby leader we want to follow[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m691 | [0m[35m[0m
[30;1m692 | [0m[35m        :param cluster: the currently known cluster state from DCS.[0m
[30;1m693 | [0m[35m[0m
[30;1m694 | [0m[35m        :returns: the node which we should be replicating from.[0m
[30;1m695 | [0m[35m        """[0m
[30;1m696 | [0m[35m        # nostream is set, the node must not use WAL streaming[0m
[30;1m697 | [0m[35m        if self.patroni.nostream:[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m687 | [0m[35m        return msg[0m
[30;1m688 | [0m[35m[0m
[30;1m689 | [0m[35m    def _get_node_to_follow(self, cluster: Cluster) -> Union[Leader, Member, None]:[0m
[30;1m690 | [0m[35m        """Determine the node to follow.[0m
[30;1m691 | [0m[35m[0m
[30;1m692 | [0m[35m        :param cluster: the currently known cluster state from DCS.[0m
[30;1m693 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m631 | [0m[35m        data = self.state_handler.controldata()[0m
[30;1m632 | [0m[35m        logger.info('pg_controldata:\n%s\n', '\n'.join('  {0}: {1}'.format(k, v) for k, v in data.it[0m
[30;1m633 | [0m[35m[0m
[30;1m634 | [0m[35m        # timeout > 0 indicates that we still have the leader lock, and it was just updated[0m
[30;1m635 | [0m[35m        if timeout\[0m
[30;1m636 | [0m[35m                and data.get('Database cluster state') in ('in production', 'in crash recovery',[0m
[30;1m637 | [0m[35m                                                           'shutting down', 'shut down')\[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m626 | [0m[35m                    self.demote('immediate')[0m
[30;1m627 | [0m[35m                    return 'stopped PostgreSQL to fail over after a crash'[0m
[30;1m628 | [0m[35m        else:[0m
[30;1m629 | [0m[35m            timeout = None[0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m        data = self.state_handler.controldata()[0m
[30;1m632 | [0m[35m        logger.info('pg_controldata:\n%s\n', '\n'.join('  {0}: {1}'.format(k, v) for k, v in data.it[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m617 | [0m[35m        """[0m
[30;1m618 | [0m[35m        if self.has_lock() and self.update_lock():[0m
[30;1m619 | [0m[35m            timeout = global_config.primary_start_timeout[0m
[30;1m620 | [0m[35m            if timeout == 0:[0m
[30;1m621 | [0m[35m                # We are requested to prefer failing over to restarting primary. But see first if th[0m
[30;1m622 | [0m[35m                # is anyone to fail over to.[0m
[30;1m623 | [0m[35m                if self.is_failover_possible():[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m616 | [0m[35m        :returns: action message, describing what was performed.[0m
[30;1m617 | [0m[35m        """[0m
[30;1m618 | [0m[35m        if self.has_lock() and self.update_lock():[0m
[30;1m619 | [0m[35m            timeout = global_config.primary_start_timeout[0m
[30;1m620 | [0m[35m            if timeout == 0:[0m
[30;1m621 | [0m[35m                # We are requested to prefer failing over to restarting primary. But see first if th[0m
[30;1m622 | [0m[35m                # is anyone to fail over to.[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m599 | [0m[35m          - if ``primary_start_timeout`` is 0 and this node owns the leader lock, the lock[0m
[30;1m600 | [0m[35m            will be voluntarily released if there are healthy replicas to take it over.[0m
[30;1m601 | [0m[35m[0m
[30;1m602 | [0m[35m          - if postgres was running as a ``primary`` and this node owns the leader lock, postgres is[0m
[30;1m603 | [0m[35m[0m
[30;1m604 | [0m[35m          - crash recover in a single-user mode is executed in the following cases:[0m
[30;1m605 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m596 | [0m[35m[0m
[30;1m597 | [0m[35m        Depending on the state of Patroni, DCS cluster view, and pg_controldata the following could [0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35m          - if ``primary_start_timeout`` is 0 and this node owns the leader lock, the lock[0m
[30;1m600 | [0m[35m            will be voluntarily released if there are healthy replicas to take it over.[0m
[30;1m601 | [0m[35m[0m
[30;1m602 | [0m[35m          - if postgres was running as a ``primary`` and this node owns the leader lock, postgres is[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m514 | [0m[35m            self.state_handler.remove_data_directory()[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m    def bootstrap(self) -> str:[0m
[30;1m517 | [0m[35m        # no initialize key and node is allowed to be primary and has 'bootstrap' section in a confi[0m
[30;1m518 | [0m[35m        if self.cluster.is_unlocked() and self.cluster.initialize is None\[0m
[30;1m519 | [0m[35m                and not self.patroni.nofailover and 'bootstrap' in self.patroni.config:[0m
[30;1m520 | [0m[35m            if self.dcs.initialize(create_new=True):  # race for initialization[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m427 | [0m[35m                            'leader': self.state_handler.name,[0m
[30;1m428 | [0m[35m                            'timeout': self.dcs.ttl,[0m
[30;1m429 | [0m[35m                            'cooldown': self.patroni.config['retry_timeout']}[0m
[30;1m430 | [0m[35m                    timeout = self.dcs.ttl if event == 'before_demote' else 2[0m
[30;1m431 | [0m[35m                    endpoint = 'citus' if mpp_handler.type == 'Citus' else 'mpp'[0m
[30;1m432 | [0m[35m                    self.patroni.request(coordinator.leader.member, 'post', endpoint, data, timeout=[0m
[30;1m433 | [0m[35m                except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m368 | [0m[35m            After successful update of the leader key the :meth:`AbstractDCS.update_leader` method c[0m
[30;1m369 | [0m[35m            optionally update the ``/status`` and ``/failsafe`` keys.[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m            The ``/status`` key contains the last known LSN on the leader node and the last known st[0m
[30;1m372 | [0m[35m            of permanent replication slots including permanent physical replication slot for the lea[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m            Last, but not least, this method calls a :meth:`Watchdog.keepalive` method after the lea[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m294 | [0m[35m        Will update the expiry timestamp to match the dcs ttl if setting leadership to true,[0m
[30;1m295 | [0m[35m        otherwise will set the expiry to the past to immediately invalidate.[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m        :param value: is the current node the leader.[0m
[30;1m298 | [0m[35m        """[0m
[30;1m299 | [0m[35m        with self._leader_expiry_lock:[0m
[30;1m300 | [0m[35m            self._leader_expiry = time.time() + self.dcs.ttl if value else 0[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m284 | [0m[35m        return global_config.is_standby_cluster[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m    def is_leader(self) -> bool:[0m
[30;1m287 | [0m[35m        """:returns: `True` if the current node is the leader, based on expiration set when it last [0m
[30;1m288 | [0m[35m        with self._leader_expiry_lock:[0m
[30;1m289 | [0m[35m            return self._leader_expiry > time.time()[0m
[30;1m290 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m260 | [0m[35m        # already running as replica was aborted due to cluster not being initialized in DCS.[0m
[30;1m261 | [0m[35m        self._join_aborted = False[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        # used only in backoff after failing a pre_promote script[0m
[30;1m264 | [0m[35m        self._released_leader_key_timestamp = 0[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        # Initialize global config[0m
[30;1m267 | [0m[35m        global_config.update(None, self.patroni.config.dynamic_configuration)[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m            Effectively it sets expiration time of failsafe mode.[0m
[30;1m212 | [0m[35m            If the provided value is ``0``, it disables failsafe mode.[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        :param value: time of the last update.[0m
[30;1m215 | [0m[35m        """[0m
[30;1m216 | [0m[35m        with self._lock:[0m
[30;1m217 | [0m[35m            self._last_update = value[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m        .. note::[0m
[30;1m210 | [0m[35m            This method is only called on the primary.[0m
[30;1m211 | [0m[35m            Effectively it sets expiration time of failsafe mode.[0m
[30;1m212 | [0m[35m            If the provided value is ``0``, it disables failsafe mode.[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        :param value: time of the last update.[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m    def update(self, data: Dict[str, Any]) -> None:[0m
[30;1m130 | [0m[35m        """Update the :class:`Failsafe` object state.[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        The last update time is stored and object will be invalidated after ``ttl`` seconds.[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        .. note::[0m
[30;1m135 | [0m[35m            This method is only called as a result of `POST /failsafe` REST API call.[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m        return cls(member, False, None, 0, {})[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def failover_limitation(self) -> Optional[str]:[0m
[30;1m82 | [0m[35m        """Returns reason why this node can't promote or None if everything is ok."""[0m
[30;1m83 | [0m[35m        if not self.reachable:[0m
[30;1m84 | [0m[35m            return 'not reachable'[0m
[30;1m85 | [0m[35m        if self.nofailover:[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m        :param json: RestApiHandler.get_postgresql_status() result[0m
[30;1m52 | [0m[35m        :returns: _MemberStatus object[0m
[30;1m53 | [0m[35m        """[0m
[30;1m54 | [0m[35m        # If one of those is not in a response we want to count the node as not healthy/reachable[0m
[30;1m55 | [0m[35m        wal: Dict[str, Any] = json.get('wal') or json['xlog'][0m
[30;1m56 | [0m[35m        # abuse difference in primary/replica response format[0m
[30;1m57 | [0m[35m        in_recovery = not (bool(wal.get('location')) or json.get('role') in ('master', 'primary'))[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    :ivar member: :class:`~patroni.dcs.Member` object of the node.[0m
[30;1m41 | [0m[35m    :ivar reachable: ``False`` if the node is not reachable or is not responding with correct JSON.[0m
[30;1m42 | [0m[35m    :ivar in_recovery: ``False`` if the node is running as a primary (`if pg_is_in_recovery() == tru[0m
[30;1m43 | [0m[35m    :ivar wal_position: maximum value of ``replayed_location`` or ``received_location`` from JSON.[0m
[30;1m44 | [0m[35m    :ivar data: the whole JSON response for future usage.[0m
[30;1m45 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    Consists of the following fields:[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    :ivar member: :class:`~patroni.dcs.Member` object of the node.[0m
[30;1m41 | [0m[35m    :ivar reachable: ``False`` if the node is not reachable or is not responding with correct JSON.[0m
[30;1m42 | [0m[35m    :ivar in_recovery: ``False`` if the node is running as a primary (`if pg_is_in_recovery() == tru[0m
[30;1m43 | [0m[35m    :ivar wal_position: maximum value of ``replayed_location`` or ``received_location`` from JSON.[0m
[30;1m44 | [0m[35m    :ivar data: the whole JSON response for future usage.[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ha.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport sys[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mimport uuid[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom multiprocessing.pool import ThreadPool[0m
[30;1m10 | [0m[35mfrom threading import RLock[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/available_parameters/0_postgres.yml[0m
   Pattern: [32m.hostname[0m
[30;1m781 | [0m[35m  logging_collector:[0m
[30;1m782 | [0m[35m  - type: Bool[0m
[30;1m783 | [0m[35m    version_from: 90300[0m
[30;1m784 | [0m[35m  log_hostname:[0m
[30;1m785 | [0m[35m  - type: Bool[0m
[30;1m786 | [0m[35m    version_from: 90300[0m
[30;1m787 | [0m[35m  logical_decoding_work_mem:[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/available_parameters/0_postgres.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1823 | [0m[35m  - type: Enum[0m
[30;1m1824 | [0m[35m    version_from: 90300[0m
[30;1m1825 | [0m[35m    possible_values:[0m
[30;1m1826 | [0m[35m    - base64[0m
[30;1m1827 | [0m[35m    - hex[0m
[30;1m1828 | [0m[35m  xmloption:[0m
[30;1m1829 | [0m[35m  - type: Enum[0m
[30;1m1830 | [0m[35m    version_from: 90300[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m665 | [0m[35m        for name in list(self._logical_slots_processing_queue):[0m
[30;1m666 | [0m[35m            primary_logical_catalog_xmin = self._logical_slots_processing_queue[name][0m
[30;1m667 | [0m[35m            standby_logical_slot = self._replication_slots.get(name, {})[0m
[30;1m668 | [0m[35m            standby_logical_catalog_xmin = standby_logical_slot.get('catalog_xmin', 0)[0m
[30;1m669 | [0m[35m            if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m670 | [0m[35m                assert primary_logical_catalog_xmin is not None[0m
[30;1m671 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m664 | [0m[35m        # Make a copy of processing queue keys as a list as the queue dictionary is modified inside [0m
[30;1m665 | [0m[35m        for name in list(self._logical_slots_processing_queue):[0m
[30;1m666 | [0m[35m            primary_logical_catalog_xmin = self._logical_slots_processing_queue[name][0m
[30;1m667 | [0m[35m            standby_logical_slot = self._replication_slots.get(name, {})[0m
[30;1m668 | [0m[35m            standby_logical_catalog_xmin = standby_logical_slot.get('catalog_xmin', 0)[0m
[30;1m669 | [0m[35m            if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m670 | [0m[35m                assert primary_logical_catalog_xmin is not None[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m453 | [0m[35m        logical_slots: Dict[str, Dict[str, Dict[str, Any]]] = defaultdict(dict)[0m
[30;1m454 | [0m[35m        for name, value in slots.items():[0m
[30;1m455 | [0m[35m            if value['type'] == 'logical':[0m
[30;1m456 | [0m[35m                if self._replication_slots.get(name, {}).get('datoid'):[0m
[30;1m457 | [0m[35m                    self._copy_items(self._replication_slots[name], value)[0m
[30;1m458 | [0m[35m                else:[0m
[30;1m459 | [0m[35m                    logical_slots[value['database']][name] = value[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m453 | [0m[35m        logical_slots: Dict[str, Dict[str, Dict[str, Any]]] = defaultdict(dict)[0m
[30;1m454 | [0m[35m        for name, value in slots.items():[0m
[30;1m455 | [0m[35m            if value['type'] == 'logical':[0m
[30;1m456 | [0m[35m                if self._replication_slots.get(name, {}).get('datoid'):[0m
[30;1m457 | [0m[35m                    self._copy_items(self._replication_slots[name], value)[0m
[30;1m458 | [0m[35m                else:[0m
[30;1m459 | [0m[35m                    logical_slots[value['database']][name] = value[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m414 | [0m[35m            # And advance restart_lsn on physical replication slots that are not expected to be acti[0m
[30;1m415 | [0m[35m            elif self._postgresql.can_advance_slots and self._replication_slots[name]['type'] == 'ph[0m
[30;1m416 | [0m[35m                    value.get('expected_active') is not True and not value['xmin']:[0m
[30;1m417 | [0m[35m                lsn = value.get('lsn')[0m
[30;1m418 | [0m[35m                if lsn and lsn > value['restart_lsn']:  # The slot has feedback in DCS and needs to [0m
[30;1m419 | [0m[35m                    try:[0m
[30;1m420 | [0m[35m                        lsn = format_lsn(lsn)[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m413 | [0m[35m                self._schedule_load_slots = True[0m
[30;1m414 | [0m[35m            # And advance restart_lsn on physical replication slots that are not expected to be acti[0m
[30;1m415 | [0m[35m            elif self._postgresql.can_advance_slots and self._replication_slots[name]['type'] == 'ph[0m
[30;1m416 | [0m[35m                    value.get('expected_active') is not True and not value['xmin']:[0m
[30;1m417 | [0m[35m                lsn = value.get('lsn')[0m
[30;1m418 | [0m[35m                if lsn and lsn > value['restart_lsn']:  # The slot has feedback in DCS and needs to [0m
[30;1m419 | [0m[35m                    try:[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m            if self._postgresql.can_advance_slots and name in self._replication_slots and\[0m
[30;1m389 | [0m[35m                    self._replication_slots[name]['type'] == 'physical':[0m
[30;1m390 | [0m[35m                self._copy_items(self._replication_slots[name], value, ('restart_lsn', 'xmin'))[0m
[30;1m391 | [0m[35m                if clean_inactive_physical_slots and value.get('expected_active') is False and value[0m
[30;1m392 | [0m[35m                    logger.warning('Dropping physical replication slot %s because of its xmin value [0m
[30;1m393 | [0m[35m                                   name, value['xmin'])[0m
[30;1m394 | [0m[35m                    active, dropped = self.drop_replication_slot(name)[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m306 | [0m[35m            for matcher in global_config.ignore_slots_matchers:[0m
[30;1m307 | [0m[35m                if ([0m
[30;1m308 | [0m[35m                        (matcher.get("name") is None or matcher["name"] == name)[0m
[30;1m309 | [0m[35m                        and all(not matcher.get(a) or matcher[a] == slot.get(a)[0m
[30;1m310 | [0m[35m                                for a in ('database', 'plugin', 'type'))[0m
[30;1m311 | [0m[35m                ):[0m
[30;1m312 | [0m[35m                    return True[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m306 | [0m[35m            for matcher in global_config.ignore_slots_matchers:[0m
[30;1m307 | [0m[35m                if ([0m
[30;1m308 | [0m[35m                        (matcher.get("name") is None or matcher["name"] == name)[0m
[30;1m309 | [0m[35m                        and all(not matcher.get(a) or matcher[a] == slot.get(a)[0m
[30;1m310 | [0m[35m                                for a in ('database', 'plugin', 'type'))[0m
[30;1m311 | [0m[35m                ):[0m
[30;1m312 | [0m[35m                    return True[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m305 | [0m[35m        if cluster.config:[0m
[30;1m306 | [0m[35m            for matcher in global_config.ignore_slots_matchers:[0m
[30;1m307 | [0m[35m                if ([0m
[30;1m308 | [0m[35m                        (matcher.get("name") is None or matcher["name"] == name)[0m
[30;1m309 | [0m[35m                        and all(not matcher.get(a) or matcher[a] == slot.get(a)[0m
[30;1m310 | [0m[35m                                for a in ('database', 'plugin', 'type'))[0m
[30;1m311 | [0m[35m                ):[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m            databases = list(self._scheduled.keys())[0m
[30;1m123 | [0m[35m        for database in databases:[0m
[30;1m124 | [0m[35m            with self._condition:[0m
[30;1m125 | [0m[35m                slots = list(self._scheduled.get(database, {}).keys())[0m
[30;1m126 | [0m[35m            if slots:[0m
[30;1m127 | [0m[35m                try:[0m
[30;1m128 | [0m[35m                    self.sync_slots_in_database(database, slots)[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        with self._slots_handler.get_local_connection_cursor(dbname=database, options='-c statement_[0m
[30;1m113 | [0m[35m            for slot in slots:[0m
[30;1m114 | [0m[35m                with self._condition:[0m
[30;1m115 | [0m[35m                    lsn = self._scheduled.get(database, {}).get(slot, 0)[0m
[30;1m116 | [0m[35m                if lsn:[0m
[30;1m117 | [0m[35m                    self.sync_slot(cur, database, slot, lsn)[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        with self._slots_handler.get_local_connection_cursor(dbname=database, options='-c statement_[0m
[30;1m113 | [0m[35m            for slot in slots:[0m
[30;1m114 | [0m[35m                with self._condition:[0m
[30;1m115 | [0m[35m                    lsn = self._scheduled.get(database, {}).get(slot, 0)[0m
[30;1m116 | [0m[35m                if lsn:[0m
[30;1m117 | [0m[35m                    self.sync_slot(cur, database, slot, lsn)[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m                    self._copy_slots.append(slot)[0m
[30;1m97 | [0m[35m                self._failed = True[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m            new_lsn = self._scheduled.get(database, {}).get(slot, 0)[0m
[30;1m100 | [0m[35m            # remove slot from the self._scheduled structure if it is to be copied or if it wasn't c[0m
[30;1m101 | [0m[35m            if copy or (new_lsn == lsn and database in self._scheduled):[0m
[30;1m102 | [0m[35m                self._scheduled[database].pop(slot)[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m                    self._copy_slots.append(slot)[0m
[30;1m97 | [0m[35m                self._failed = True[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m            new_lsn = self._scheduled.get(database, {}).get(slot, 0)[0m
[30;1m100 | [0m[35m            # remove slot from the self._scheduled structure if it is to be copied or if it wasn't c[0m
[30;1m101 | [0m[35m            if copy or (new_lsn == lsn and database in self._scheduled):[0m
[30;1m102 | [0m[35m                self._scheduled[database].pop(slot)[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    """[0m
[30;1m47 | [0m[35m    return (s1['type'] == s2['type'][0m
[30;1m48 | [0m[35m            and (s1['type'] == 'physical'[0m
[30;1m49 | [0m[35m                 or s1.get(dbid) == s2.get(dbid)[0m
[30;1m50 | [0m[35m                 and s1['plugin'] == s2['plugin']))[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    """[0m
[30;1m47 | [0m[35m    return (s1['type'] == s2['type'][0m
[30;1m48 | [0m[35m            and (s1['type'] == 'physical'[0m
[30;1m49 | [0m[35m                 or s1.get(dbid) == s2.get(dbid)[0m
[30;1m50 | [0m[35m                 and s1['plugin'] == s2['plugin']))[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m228 | [0m[35m            1. For the primary we want to expose to DCS permanent logical slots, therefore build (an[0m
[30;1m229 | [0m[35m               that maps permanent logical slot names to ``confirmed_flush_lsn``.[0m
[30;1m230 | [0m[35m            2. detect if one of the previously known permanent slots is missing and schedule resync.[0m
[30;1m231 | [0m[35m            3. Update the local cache with the fresh ``catalog_xmin`` and ``confirmed_flush_lsn`` fo[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m           This info is used when performing the check of logical slot readiness on standbys.[0m
[30;1m234 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    @staticmethod[0m
[30;1m208 | [0m[35m    def _copy_items(src: Dict[str, Any], dst: Dict[str, Any], keys: Optional[Collection[str]] = None[0m
[30;1m209 | [0m[35m        """Select values from *src* dictionary to update in *dst* dictionary for optional supplied *[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        :param src: source dictionary that *keys* will be looked up from.[0m
[30;1m212 | [0m[35m        :param dst: destination dictionary to be updated.[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m750 | [0m[35m        self._schedule_load_slots = self._force_readiness_check = value[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m    def on_promote(self) -> None:[0m
[30;1m753 | [0m[35m        """Entry point from HA cycle used when a standby node is to be promoted to primary.[0m
[30;1m754 | [0m[35m[0m
[30;1m755 | [0m[35m        .. note::[0m
[30;1m756 | [0m[35m            If logical replication slot synchronisation is enabled then slot advancement will be tri[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m743 | [0m[35m        """Schedule the loading of slot information from the database.[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m        :param value: the optional value can be used to unschedule if set to ``False`` or force it t[0m
[30;1m746 | [0m[35m                      If it is omitted the value will be ``True`` if this PostgreSQL node supports s[0m
[30;1m747 | [0m[35m        """[0m
[30;1m748 | [0m[35m        if value is None:[0m
[30;1m749 | [0m[35m            value = self._postgresql.major_version >= 90400[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m                # We don't want to clean physical replication slots with xmin feedback if:[0m
[30;1m554 | [0m[35m                # - cluster has no leader[0m
[30;1m555 | [0m[35m                # - current node is a leader, but still running as a standby[0m
[30;1m556 | [0m[35m                clean_inactive_physical_slots = not cluster.is_unlocked() and \[0m
[30;1m557 | [0m[35m                    (cluster.leader and cluster.leader.name != self._postgresql.name or self._postgr[0m
[30;1m558 | [0m[35m                self._ensure_physical_slots(slots, clean_inactive_physical_slots)[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m427 | [0m[35m        """Create a new database connection to local server.[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m        Create a non-blocking connection cursor to avoid the situation where an execution of the que[0m
[30;1m430 | [0m[35m        ``pg_replication_slot_advance`` takes longer than the timeout on a HA loop, which could caus[0m
[30;1m431 | [0m[35m        failure state.[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m        :param kwargs: Any keyword arguments to pass to :func:`psycopg.connect`.[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_patroni.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m311 | [0m[35m        # If the api of the running node cannot be reached, this implies unique name[0m
[30;1m312 | [0m[35m        with patch('urllib3.PoolManager.request', Mock(side_effect=ConnectionError)):[0m
[30;1m313 | [0m[35m            self.assertIsNone(self.p.ensure_unique_name(bad_cluster))[0m
[30;1m314 | [0m[35m        # Only if the api of the running node is reachable do we throw an error[0m
[30;1m315 | [0m[35m        with patch('urllib3.PoolManager.request', Mock()):[0m
[30;1m316 | [0m[35m            self.assertRaises(SystemExit, self.p.ensure_unique_name, bad_cluster)[0m
[30;1m317 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_patroni.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m            })],[0m
[30;1m309 | [0m[35m            **without_members[0m
[30;1m310 | [0m[35m        )[0m
[30;1m311 | [0m[35m        # If the api of the running node cannot be reached, this implies unique name[0m
[30;1m312 | [0m[35m        with patch('urllib3.PoolManager.request', Mock(side_effect=ConnectionError)):[0m
[30;1m313 | [0m[35m            self.assertIsNone(self.p.ensure_unique_name(bad_cluster))[0m
[30;1m314 | [0m[35m        # Only if the api of the running node is reachable do we throw an error[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_patroni.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport signal[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport unittest[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom http.server import HTTPServer[0m
[30;1m8 | [0m[35mfrom threading import Thread[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m771 | [0m[35m        """[0m
[30;1m772 | [0m[35m        if self._postgresql.is_primary() and slot['type'] == 'logical' and slot['database'] == self.[0m
[30;1m773 | [0m[35m            m = CITUS_SLOT_NAME_RE.match(slot['name'])[0m
[30;1m774 | [0m[35m            return bool(m and {'move': 'pgoutput', 'split': 'citus'}.get(m.group(1)) == slot['plugin[0m
[30;1m775 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m755 | [0m[35m        parameters['wal_level'] = 'logical'[0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m        # Sometimes Citus needs to connect to the local postgres. We will do it the same way as Patr[0m
[30;1m758 | [0m[35m        parameters['citus.local_hostname'] = self._postgresql.connection_pool.conn_kwargs.get('host'[0m
[30;1m759 | [0m[35m[0m
[30;1m760 | [0m[35m    def ignore_replication_slot(self, slot: Dict[str, str]) -> bool:[0m
[30;1m761 | [0m[35m        """Check whether provided replication *slot* existing in the database should not be removed.[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m743 | [0m[35m        # citus extension must be on the first place in shared_preload_libraries[0m
[30;1m744 | [0m[35m        shared_preload_libraries = list(filter([0m
[30;1m745 | [0m[35m            lambda el: el and el != 'citus',[0m
[30;1m746 | [0m[35m            map(str.strip, parameters.get('shared_preload_libraries', '').split(',')))[0m
[30;1m747 | [0m[35m        )  # pyright: ignore [reportUnknownArgumentType][0m
[30;1m748 | [0m[35m        parameters['shared_preload_libraries'] = ','.join(['citus'] + shared_preload_libraries)[0m
[30;1m749 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m684 | [0m[35m        if not self.is_alive():[0m
[30;1m685 | [0m[35m            return[0m
[30;1m686 | [0m[35m[0m
[30;1m687 | [0m[35m        worker = cluster.workers.get(event['group'])[0m
[30;1m688 | [0m[35m        if not (worker and worker.leader and worker.leader.name == event['leader'] and worker.leader[0m
[30;1m689 | [0m[35m            return logger.info('Discarding event %s', event)[0m
[30;1m690 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m648 | [0m[35m                    self._condition.notify()[0m
[30;1m649 | [0m[35m                    return True[0m
[30;1m650 | [0m[35m            # Add the task to the list if Worker node state is different from the cached `pg_dist_gr[0m
[30;1m651 | [0m[35m            elif self._schedule_load_pg_dist_group or task != self._pg_dist_group.get(task.groupid)\[0m
[30;1m652 | [0m[35m                    or self._in_flight and task.groupid == self._in_flight.groupid:[0m
[30;1m653 | [0m[35m                logger.debug('Adding the new task: %s', task)[0m
[30;1m654 | [0m[35m                self._tasks.append(task)[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m    def update_group(self, task: PgDistTask, transaction: bool) -> None:[0m
[30;1m531 | [0m[35m        current_state = self._in_flight\[0m
[30;1m532 | [0m[35m            or self._pg_dist_group.get(task.groupid)\[0m
[30;1m533 | [0m[35m            or PgDistTask(task.groupid, set(), 'after_promote')[0m
[30;1m534 | [0m[35m        transitions = list(task.transition(current_state))[0m
[30;1m535 | [0m[35m        if transitions:[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m                    if i is None:[0m
[30;1m509 | [0m[35m                        break[0m
[30;1m510 | [0m[35m                    task = self._tasks[i][0m
[30;1m511 | [0m[35m                    if task == self._pg_dist_group.get(task.groupid):[0m
[30;1m512 | [0m[35m                        self._tasks.pop(i)  # nothing to do because cached version of pg_dist_group [0m
[30;1m513 | [0m[35m                    else:[0m
[30;1m514 | [0m[35m                        break[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m477 | [0m[35m        for groupid, worker in cluster.workers.items():[0m
[30;1m478 | [0m[35m            leader = worker.leader[0m
[30;1m479 | [0m[35m            if leader and leader.conn_url\[0m
[30;1m480 | [0m[35m                    and leader.data.get('role') in ('master', 'primary') and leader.data.get('state'[0m
[30;1m481 | [0m[35m                self.add_task('after_promote', groupid, worker, leader.name, leader.conn_url)[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m    def find_task_by_groupid(self, groupid: int) -> Optional[int]:[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m477 | [0m[35m        for groupid, worker in cluster.workers.items():[0m
[30;1m478 | [0m[35m            leader = worker.leader[0m
[30;1m479 | [0m[35m            if leader and leader.conn_url\[0m
[30;1m480 | [0m[35m                    and leader.data.get('role') in ('master', 'primary') and leader.data.get('state'[0m
[30;1m481 | [0m[35m                self.add_task('after_promote', groupid, worker, leader.name, leader.conn_url)[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m    def find_task_by_groupid(self, groupid: int) -> Optional[int]:[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m        AbstractMPPHandler.__init__(self, postgresql, config)[0m
[30;1m395 | [0m[35m        self.daemon = True[0m
[30;1m396 | [0m[35m        if config:[0m
[30;1m397 | [0m[35m            self._connection = postgresql.connection_pool.get([0m
[30;1m398 | [0m[35m                'citus', {'dbname': config['database'],[0m
[30;1m399 | [0m[35m                          'options': '-c statement_timeout=0 -c idle_in_transaction_session_timeout=[0m
[30;1m400 | [0m[35m        self._pg_dist_group: Dict[int, PgDistTask] = {}  # Cache of pg_dist_node: {groupid: PgDistTa[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m        """[0m
[30;1m369 | [0m[35m        return isinstance(config, dict) \[0m
[30;1m370 | [0m[35m            and isinstance(cast(Dict[str, Any], config).get('database'), str) \[0m
[30;1m371 | [0m[35m            and parse_int(cast(Dict[str, Any], config).get('group')) is not None[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    @property[0m
[30;1m374 | [0m[35m    def group(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m        :returns: ``True`` is config passes validation, otherwise ``False``.[0m
[30;1m368 | [0m[35m        """[0m
[30;1m369 | [0m[35m        return isinstance(config, dict) \[0m
[30;1m370 | [0m[35m            and isinstance(cast(Dict[str, Any], config).get('database'), str) \[0m
[30;1m371 | [0m[35m            and parse_int(cast(Dict[str, Any], config).get('group')) is not None[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m            self.failover = True[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m            new_primary_old_node = old.get(new_primary)[0m
[30;1m214 | [0m[35m            old_primary_new_node = self.get(old_primary)[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m            # The new primary was registered as a secondary before failover[0m
[30;1m217 | [0m[35m            if new_primary_old_node:[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m        elif old_primary != new_primary:[0m
[30;1m211 | [0m[35m            self.failover = True[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m            new_primary_old_node = old.get(new_primary)[0m
[30;1m214 | [0m[35m            old_primary_new_node = self.get(old_primary)[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m            # The new primary was registered as a secondary before failover[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m.hostname[0m
[30;1m755 | [0m[35m        parameters['wal_level'] = 'logical'[0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m        # Sometimes Citus needs to connect to the local postgres. We will do it the same way as Patr[0m
[30;1m758 | [0m[35m        parameters['citus.local_hostname'] = self._postgresql.connection_pool.conn_kwargs.get('host'[0m
[30;1m759 | [0m[35m[0m
[30;1m760 | [0m[35m    def ignore_replication_slot(self, slot: Dict[str, str]) -> bool:[0m
[30;1m761 | [0m[35m        """Check whether provided replication *slot* existing in the database should not be removed.[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m.hostname[0m
[30;1m731 | [0m[35m                if self.is_coordinator():[0m
[30;1m732 | [0m[35m                    r = urlparse(self._postgresql.connection_string)[0m
[30;1m733 | [0m[35m                    cur.execute("SELECT pg_catalog.citus_set_coordinator_host(%s, %s, 'primary', 'de[0m
[30;1m734 | [0m[35m                                (r.hostname, r.port or 5432))[0m
[30;1m735 | [0m[35m        finally:[0m
[30;1m736 | [0m[35m            conn.close()[0m
[30;1m737 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m.hostname[0m
[30;1m661 | [0m[35m        try:[0m
[30;1m662 | [0m[35m            r = urlparse(conn_url)[0m
[30;1m663 | [0m[35m            if r.hostname:[0m
[30;1m664 | [0m[35m                return PgDistNode(r.hostname, r.port or 5432, role)[0m
[30;1m665 | [0m[35m        except Exception as e:[0m
[30;1m666 | [0m[35m            logger.error('Failed to parse connection url %s: %r', conn_url, e)[0m
[30;1m667 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m.hostname[0m
[30;1m660 | [0m[35m    def _pg_dist_node(role: str, conn_url: str) -> Optional[PgDistNode]:[0m
[30;1m661 | [0m[35m        try:[0m
[30;1m662 | [0m[35m            r = urlparse(conn_url)[0m
[30;1m663 | [0m[35m            if r.hostname:[0m
[30;1m664 | [0m[35m                return PgDistNode(r.hostname, r.port or 5432, role)[0m
[30;1m665 | [0m[35m        except Exception as e:[0m
[30;1m666 | [0m[35m            logger.error('Failed to parse connection url %s: %r', conn_url, e)[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m.hostname[0m
[30;1m203 | [0m[35m        elif old_primary == new_primary:[0m
[30;1m204 | [0m[35m            new_primary.nodeid = old_primary.nodeid[0m
[30;1m205 | [0m[35m            # Controlled switchover with pausing client connections.[0m
[30;1m206 | [0m[35m            # Achieved by updating the primary row and putting hostname = '${host}-demoted' in a tra[0m
[30;1m207 | [0m[35m            if old_primary.role != new_primary.role:[0m
[30;1m208 | [0m[35m                self.failover = True[0m
[30;1m209 | [0m[35m                yield new_primary[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m459 | [0m[35m        """Maintain the ``pg_dist_node`` from the coordinator leader every heartbeat loop.[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m        We can't always rely on REST API calls from worker nodes in order[0m
[30;1m462 | [0m[35m        to maintain `pg_dist_node`, therefore at least once per heartbeat[0m
[30;1m463 | [0m[35m        loop we make sure that works registered in `self._pg_dist_group`[0m
[30;1m464 | [0m[35m        cache are matching the cluster view from DCS by creating tasks[0m
[30;1m465 | [0m[35m        the same way as it is done from the REST API."""[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m243 | [0m[35m                    old_primary_new_node.nodeid = new_primary_old_node.nodeid[0m
[30;1m244 | [0m[35m                    yield old_primary_new_node[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m            # update the primary record with the new information[0m
[30;1m247 | [0m[35m            new_primary.nodeid = old_primary.nodeid[0m
[30;1m248 | [0m[35m            yield new_primary[0m
[30;1m249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m        * replace gone secondaries with added secondaries[0m
[30;1m102 | [0m[35m        * failover and switchover[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    Typically there will be at least one :class:`PgDistNode` object registered (``primary``).[0m
[30;1m105 | [0m[35m    In addition to that there could be one or more ``secondary`` nodes.[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    :ivar failover: whether the ``primary`` row should be updated as a result of :func:`transition` [0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m647 | [0m[35m                    self._tasks[i] = task[0m
[30;1m648 | [0m[35m                    self._condition.notify()[0m
[30;1m649 | [0m[35m                    return True[0m
[30;1m650 | [0m[35m            # Add the task to the list if Worker node state is different from the cached `pg_dist_gr[0m
[30;1m651 | [0m[35m            elif self._schedule_load_pg_dist_group or task != self._pg_dist_group.get(task.groupid)\[0m
[30;1m652 | [0m[35m                    or self._in_flight and task.groupid == self._in_flight.groupid:[0m
[30;1m653 | [0m[35m                logger.debug('Adding the new task: %s', task)[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m635 | [0m[35m the call made "before" the member[0m
[30;1m636 | [0m[35m                # key is updated in DCS. Therefore it is possible that :func:`sync_meta_data` will t[0m
[30;1m637 | [0m[35m                # based on the outdated values of "state"/"role". To solve it we introduce an artifi[0m
[30;1m638 | [0m[35m                # Only when the timeout is reached new tasks could be scheduled from sync_meta_data([0m
[30;1m639 | [0m[35m                if self._in_flight and self._in_flight.groupid == task.groupid and self._in_flight.t[0m
[30;1m640 | [0m[35m                        and self._in_flight.deadline > time.time():[0m
[30;1m641 | [0m[35m                    return False[0m
[30;1m642 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m612 | [0m[35m                    else:[0m
[30;1m613 | [0m[35m                        timeout = -1 if self._tasks else None[0m
[30;1m614 | [0m[35m[0m
[30;1m615 | [0m[35m                    if timeout is None or timeout > 0:[0m
[30;1m616 | [0m[35m                        self._condition.wait(timeout)[0m
[30;1m617 | [0m[35m                    elif self._in_flight:[0m
[30;1m618 | [0m[35m                        logger.warning('Rolling back transaction. Last known status: %s', self._in_f[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m612 | [0m[35m                    else:[0m
[30;1m613 | [0m[35m                        timeout = -1 if self._tasks else None[0m
[30;1m614 | [0m[35m[0m
[30;1m615 | [0m[35m                    if timeout is None or timeout > 0:[0m
[30;1m616 | [0m[35m                        self._condition.wait(timeout)[0m
[30;1m617 | [0m[35m                    elif self._in_flight:[0m
[30;1m618 | [0m[35m                        logger.warning('Rolling back transaction. Last known status: %s', self._in_f[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m610 | [0m[35m                    elif self._in_flight:[0m
[30;1m611 | [0m[35m                        timeout = self._in_flight.deadline - time.time() if self._tasks else None[0m
[30;1m612 | [0m[35m                    else:[0m
[30;1m613 | [0m[35m                        timeout = -1 if self._tasks else None[0m
[30;1m614 | [0m[35m[0m
[30;1m615 | [0m[35m                    if timeout is None or timeout > 0:[0m
[30;1m616 | [0m[35m                        self._condition.wait(timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m608 | [0m[35m                    if self._schedule_load_pg_dist_group:[0m
[30;1m609 | [0m[35m                        timeout = -1[0m
[30;1m610 | [0m[35m                    elif self._in_flight:[0m
[30;1m611 | [0m[35m                        timeout = self._in_flight.deadline - time.time() if self._tasks else None[0m
[30;1m612 | [0m[35m                    else:[0m
[30;1m613 | [0m[35m                        timeout = -1 if self._tasks else None[0m
[30;1m614 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m606 | [0m[35m            try:[0m
[30;1m607 | [0m[35m                with self._condition:[0m
[30;1m608 | [0m[35m                    if self._schedule_load_pg_dist_group:[0m
[30;1m609 | [0m[35m                        timeout = -1[0m
[30;1m610 | [0m[35m                    elif self._in_flight:[0m
[30;1m611 | [0m[35m                        timeout = self._in_flight.deadline - time.time() if self._tasks else None[0m
[30;1m612 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m544 | [0m[35m    def process_task(self, task: PgDistTask) -> bool:[0m
[30;1m545 | [0m[35m        """Updates a single row in `pg_dist_group` table, optionally in a transaction.[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m        The transaction is started if we do a demote of the worker node or before promoting the othe[0m
[30;1m548 | [0m[35m        there is no transaction in progress. And, the transaction is committed when the switchover/f[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m        .. note:[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m535 | [0m[35m        if transitions:[0m
[30;1m536 | [0m[35m            if not transaction and len(transitions) > 1:[0m
[30;1m537 | [0m[35m                self.query('BEGIN')[0m
[30;1m538 | [0m[35m            for node in transitions:[0m
[30;1m539 | [0m[35m                self.update_node(task.groupid, node, task.cooldown)[0m
[30;1m540 | [0m[35m            if not transaction and len(transitions) > 1:[0m
[30;1m541 | [0m[35m                task.failover = False[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m        self.event = event[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m        # If transaction was started, we need to COMMIT/ROLLBACK before the deadline[0m
[30;1m330 | [0m[35m        self.timeout = timeout[0m
[30;1m331 | [0m[35m        self.cooldown = cooldown or 10000  # 10s by default[0m
[30;1m332 | [0m[35m        self.deadline: float = 0[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m        # All changes in the pg_dist_node are serialized on the Patroni[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m317 | [0m[35m        :param groupid: the groupid from "pg_dist_node".[0m
[30;1m318 | [0m[35m        :param nodes: a collection of :class:`PgDistNode` objects that belong to a *groupid*.[0m
[30;1m319 | [0m[35m        :param event: an "event" that resulted in creating this task.[0m
[30;1m320 | [0m[35m        :param timeout: a transaction timeout if the task resulted in starting a transaction.[0m
[30;1m321 | [0m[35m        :param cooldown: the cooldown value for ``citus_update_node()`` UDF call.[0m
[30;1m322 | [0m[35m        """[0m
[30;1m323 | [0m[35m        super(PgDistTask, self).__init__(groupid, nodes)[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m                 possible values: "before_demote", "before_promote", "after_promote".[0m
[30;1m308 | [0m[35m    :ivar timeout: a transaction timeout if the task resulted in starting a transaction.[0m
[30;1m309 | [0m[35m    :ivar cooldown: the cooldown value for ``citus_update_node()`` UDF call.[0m
[30;1m310 | [0m[35m    :ivar deadline: the time in unix seconds when the transaction is allowed to be rolled back.[0m
[30;1m311 | [0m[35m    """[0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m    def __init__(self, groupid: int, nodes: Optional[Collection[PgDistNode]], event: str,[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m305 | [0m[35m    :ivar group: the "groupid" in "pg_dist_node".[0m
[30;1m306 | [0m[35m    :ivar event: an "event" that resulted in creating this task.[0m
[30;1m307 | [0m[35m                 possible values: "before_demote", "before_promote", "after_promote".[0m
[30;1m308 | [0m[35m    :ivar timeout: a transaction timeout if the task resulted in starting a transaction.[0m
[30;1m309 | [0m[35m    :ivar cooldown: the cooldown value for ``citus_update_node()`` UDF call.[0m
[30;1m310 | [0m[35m    :ivar deadline: the time in unix seconds when the transaction is allowed to be rolled back.[0m
[30;1m311 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m        # Add new nodes to the metadata, but only in case if metadata is in sync (self.failover is F[0m
[30;1m293 | [0m[35m        for a in added_nodes:[0m
[30;1m294 | [0m[35m            if not self.failover:[0m
[30;1m295 | [0m[35m                # Add the node if we expect metadata to be in sync[0m
[30;1m296 | [0m[35m                yield a[0m
[30;1m297 | [0m[35m            else:[0m
[30;1m298 | [0m[35m                # Otherwise remove them from the new topology[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m        # Add new nodes to the metadata, but only in case if metadata is in sync (self.failover is F[0m
[30;1m293 | [0m[35m        for a in added_nodes:[0m
[30;1m294 | [0m[35m            if not self.failover:[0m
[30;1m295 | [0m[35m                # Add the node if we expect metadata to be in sync[0m
[30;1m296 | [0m[35m                yield a[0m
[30;1m297 | [0m[35m            else:[0m
[30;1m298 | [0m[35m                # Otherwise remove them from the new topology[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m283 | [0m[35m        # Remove remaining nodes that are gone, but only in case if metadata is in sync (self.failov[0m
[30;1m284 | [0m[35m        for g in gone_nodes:[0m
[30;1m285 | [0m[35m            if not self.failover:[0m
[30;1m286 | [0m[35m                # Remove the node if we expect metadata to be in sync[0m
[30;1m287 | [0m[35m                yield PgDistNode(g.host, g.port, '')[0m
[30;1m288 | [0m[35m            else:[0m
[30;1m289 | [0m[35m                # Otherwise add these nodes to the new topology[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m283 | [0m[35m        # Remove remaining nodes that are gone, but only in case if metadata is in sync (self.failov[0m
[30;1m284 | [0m[35m        for g in gone_nodes:[0m
[30;1m285 | [0m[35m            if not self.failover:[0m
[30;1m286 | [0m[35m                # Remove the node if we expect metadata to be in sync[0m
[30;1m287 | [0m[35m                yield PgDistNode(g.host, g.port, '')[0m
[30;1m288 | [0m[35m            else:[0m
[30;1m289 | [0m[35m                # Otherwise add these nodes to the new topology[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m              removed, but it is not supported by Patroni).[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m            - "nodename", "nodeport" must be unique across all rows in the "pg_dist_node". This mean[0m
[30;1m171 | [0m[35m              every time we want to change the nodeid of an existing node (i.e. to change it from se[0m
[30;1m172 | [0m[35m              to primary), we should first write some other "nodename"/"nodeport" to the row it's cu[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m            - updating "broken" nodes always works and metadata is synced asynchnonously after the c[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m              removed, but it is not supported by Patroni).[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m            - "nodename", "nodeport" must be unique across all rows in the "pg_dist_node". This mean[0m
[30;1m171 | [0m[35m              every time we want to change the nodeid of an existing node (i.e. to change it from se[0m
[30;1m172 | [0m[35m              to primary), we should first write some other "nodename"/"nodeport" to the row it's cu[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m            - updating "broken" nodes always works and metadata is synced asynchnonously after the c[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport re[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom threading import Condition, Event, Thread[0m
[30;1m6 | [0m[35mfrom typing import Any, cast, Collection, Dict, Iterator, List, Optional, Set, Tuple, TYPE_CHECKING,[0m
[30;1m7 | [0m[35mfrom urllib.parse import urlparse[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/async_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m        self.result = None[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    def reset(self) -> None:[0m
[30;1m39 | [0m[35m        """Must be called every time the background task is finished.[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        .. note::[0m
[30;1m42 | [0m[35m            Must be called from async thread. Caller must hold lock on async executor when calling.[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/async_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m        """Request cancellation of a scheduled async task, if any.[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m        .. note::[0m
[30;1m208 | [0m[35m            Wait until task is cancelled before returning control to caller.[0m
[30;1m209 | [0m[35m        """[0m
[30;1m210 | [0m[35m        with self:[0m
[30;1m211 | [0m[35m            with self._scheduled_action_lock:[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/async_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m147 | [0m[35m        .. note::[0m
[30;1m148 | [0m[35m            Expected to be executed through a thread.[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m        :param func: function to be run. If it returns anything other than ``None``, HA loop will be[0m
[30;1m151 | [0m[35m            of :func:`run` execution.[0m
[30;1m152 | [0m[35m        :param args: arguments to be passed to *func*.[0m
[30;1m153 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/async_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m85 | [0m[35m    def __init__(self, cancellable: CancellableSubprocess, ha_wakeup: Callable[..., None]) -> None:[0m
[30;1m86 | [0m[35m        """Create a new instance of :class:`AsyncExecutor`.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        Configure the given *cancellable* and *ha_wakeup*, initializes the control attributes, and i[0m
[30;1m89 | [0m[35m        and event objects that are used to access attributes and manage communication between thread[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        :param cancellable: a subprocess that supports being cancelled.[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/async_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m    def __init__(self) -> None:[0m
[30;1m30 | [0m[35m        """Create a new instance of :class:`CriticalTask`.[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        Instantiate the lock and the task control attributes.[0m
[30;1m33 | [0m[35m        """[0m
[30;1m34 | [0m[35m        self._lock = Lock()[0m
[30;1m35 | [0m[35m        self.is_cancelled = False[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m            {'pid': 100, 'application_name': self.leadermem.name, 'sync_state': 'quorum', 'flush_lsn[0m
[30;1m83 | [0m[35m            {'pid': 101, 'application_name': self.other.name, 'sync_state': 'quorum', 'flush_lsn': 2[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        # sync node is a bit behind of async, but we prefer it anyway[0m
[30;1m86 | [0m[35m        with patch.object(Postgresql, "_cluster_info_state_get",[0m
[30;1m87 | [0m[35m                          side_effect=['ANY 1 ({0},"{1}")'.format(self.leadermem.name, self.other.na[0m
[30;1m88 | [0m[35m                                       'on', pg_stat_replication]):[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m            self.assertEqual(self.s.current_state(self.cluster), ('off', 0, 0, CaseInsensitiveSet(),[0m
[30;1m61 | [0m[35m                                                                  CaseInsensitiveSet([self.me.name])[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # unknown sync node is ignored[0m
[30;1m64 | [0m[35m        missing.update(application_name='missing', sync_state='sync')[0m
[30;1m65 | [0m[35m        pg_stat_replication.insert(0, missing)[0m
[30;1m66 | [0m[35m        with patch.object(Postgresql, "_cluster_info_state_get", side_effect=['', 'remote_apply', pg[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m                                                                  CaseInsensitiveSet([self.leadermem[0m
[30;1m45 | [0m[35m                                                                  CaseInsensitiveSet([self.leadermem[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        # prefer node with sync_state='potential', even if it is slightly behind of async[0m
[30;1m48 | [0m[35m        pg_stat_replication[0]['sync_state'] = 'potential'[0m
[30;1m49 | [0m[35m        for r in pg_stat_replication:[0m
[30;1m50 | [0m[35m            r['write_lsn'] = r.pop('flush_lsn')[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m            {'pid': 101, 'application_name': self.me.name, 'sync_state': 'async', 'flush_lsn': 2},[0m
[30;1m38 | [0m[35m            {'pid': 102, 'application_name': self.other.name, 'sync_state': 'async', 'flush_lsn': 2}[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        # sync node is a bit behind of async, but we prefer it anyway[0m
[30;1m41 | [0m[35m        with patch.object(Postgresql, "_cluster_info_state_get", side_effect=[self.leadermem.name,[0m
[30;1m42 | [0m[35m                                                                              'on', pg_stat_replicat[0m
[30;1m43 | [0m[35m            self.assertEqual(self.s.current_state(self.cluster), ('priority', 1, 1,[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m        self.so.set('foo', 'bar', ttl=0.001)[0m
[30;1m103 | [0m[35m        time.sleep(1)[0m
[30;1m104 | [0m[35m        self.assertIsNone(self.so.get('foo'))[0m
[30;1m105 | [0m[35m        self.assertEqual(self.so.get('foo', recursive=True), {})[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    @patch('time.sleep', Mock())[0m
[30;1m108 | [0m[35m    def test_retry(self):[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m    def test_expire(self):[0m
[30;1m102 | [0m[35m        self.so.set('foo', 'bar', ttl=0.001)[0m
[30;1m103 | [0m[35m        time.sleep(1)[0m
[30;1m104 | [0m[35m        self.assertIsNone(self.so.get('foo'))[0m
[30;1m105 | [0m[35m        self.assertEqual(self.so.get('foo', recursive=True), {})[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    @patch('time.sleep', Mock())[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport tempfile[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport unittest[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom unittest.mock import Mock, patch, PropertyMock[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/recover.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m    :param barman_server: name of the Barman server which backup is to be[0m
[30;1m56 | [0m[35m        restored.[0m
[30;1m57 | [0m[35m    :param backup_id: ID of the backup from the Barman server.[0m
[30;1m58 | [0m[35m    :param ssh_command: SSH command to connect from the Barman host to the[0m
[30;1m59 | [0m[35m        target host.[0m
[30;1m60 | [0m[35m    :param data_directory: path to the Postgres data directory where to restore[0m
[30;1m61 | [0m[35m        the backup in.[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/recover.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mRefer to :class:`ExitCode` for possible exit codes of this sub-command.[0m
[30;1m16 | [0m[35m"""[0m
[30;1m17 | [0m[35mimport logging[0m
[30;1m18 | [0m[35mimport time[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mfrom argparse import Namespace[0m
[30;1m21 | [0m[35mfrom enum import IntEnum[0m
[30;1m22 | [0m[35mfrom typing import TYPE_CHECKING[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/recover.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m"""Implements ``patroni_barman recover`` sub-command.[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mRestore a Barman backup to the local node through ``pg-backup-api``.[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mThis sub-command can be used both as a custom bootstrap method, and as a custom[0m
[30;1m8 | [0m[35mcreate replica method. Check the output of ``--help`` to understand the[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        """Dictionary of permanent slots information from the global configuration."""[0m
[30;1m231 | [0m[35m        return deepcopy(self.get('permanent_replication_slots')[0m
[30;1m232 | [0m[35m                        or self.get('permanent_slots')[0m
[30;1m233 | [0m[35m                        or self.get('slots')[0m
[30;1m234 | [0m[35m                        or EMPTY_DICT.copy())[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m    def permanent_slots(self) -> Dict[str, Any]:[0m
[30;1m230 | [0m[35m        """Dictionary of permanent slots information from the global configuration."""[0m
[30;1m231 | [0m[35m        return deepcopy(self.get('permanent_replication_slots')[0m
[30;1m232 | [0m[35m                        or self.get('permanent_slots')[0m
[30;1m233 | [0m[35m                        or self.get('slots')[0m
[30;1m234 | [0m[35m                        or EMPTY_DICT.copy())[0m
[30;1m235 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m    @property[0m
[30;1m229 | [0m[35m    def permanent_slots(self) -> Dict[str, Any]:[0m
[30;1m230 | [0m[35m        """Dictionary of permanent slots information from the global configuration."""[0m
[30;1m231 | [0m[35m        return deepcopy(self.get('permanent_replication_slots')[0m
[30;1m232 | [0m[35m                        or self.get('permanent_slots')[0m
[30;1m233 | [0m[35m                        or self.get('slots')[0m
[30;1m234 | [0m[35m                        or EMPTY_DICT.copy())[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m    @property[0m
[30;1m224 | [0m[35m    def use_slots(self) -> bool:[0m
[30;1m225 | [0m[35m        """``True`` if cluster is configured to use replication slots."""[0m
[30;1m226 | [0m[35m        return bool(parse_bool((self.get('postgresql') or EMPTY_DICT).get('use_slots', True)))[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m    @property[0m
[30;1m229 | [0m[35m    def permanent_slots(self) -> Dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m    @property[0m
[30;1m224 | [0m[35m    def use_slots(self) -> bool:[0m
[30;1m225 | [0m[35m        """``True`` if cluster is configured to use replication slots."""[0m
[30;1m226 | [0m[35m        return bool(parse_bool((self.get('postgresql') or EMPTY_DICT).get('use_slots', True)))[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m    @property[0m
[30;1m229 | [0m[35m    def permanent_slots(self) -> Dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        Assume an empty :class:`list` if not set.[0m
[30;1m212 | [0m[35m        """[0m
[30;1m213 | [0m[35m        return self.get('ignore_slots') or [][0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m    @property[0m
[30;1m216 | [0m[35m    def max_timelines_history(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m        :returns: currently configured value of *name* from the global configuration or *default* if[0m
[30;1m147 | [0m[35m            invalid.[0m
[30;1m148 | [0m[35m        """[0m
[30;1m149 | [0m[35m        ret = parse_int(self.get(name), base_unit)[0m
[30;1m150 | [0m[35m        return default if ret is None else ret[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m        """``True`` if global configuration has a valid ``standby_cluster`` section."""[0m
[30;1m134 | [0m[35m        config = self.get_standby_cluster_config()[0m
[30;1m135 | [0m[35m        return isinstance(config, dict) and\[0m
[30;1m136 | [0m[35m            any(cast(Dict[str, Any], config).get(p) for p in ('host', 'port', 'restore_command'))[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    def get_int(self, name: str, default: int = 0, base_unit: Optional[str] = None) -> int:[0m
[30;1m139 | [0m[35m        """Gets current value of *name* from the global configuration and try to return it as :class[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        :returns: a copy of ``standby_cluster`` configuration.[0m
[30;1m128 | [0m[35m        """[0m
[30;1m129 | [0m[35m        return deepcopy(self.get('standby_cluster'))[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    @property[0m
[30;1m132 | [0m[35m    def is_standby_cluster(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m    @property[0m
[30;1m109 | [0m[35m    def is_quorum_commit_mode(self) -> bool:[0m
[30;1m110 | [0m[35m        """:returns: ``True`` if quorum commit replication is requested"""[0m
[30;1m111 | [0m[35m        return str(self.get('synchronous_mode')).lower() == 'quorum'[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    @property[0m
[30;1m114 | [0m[35m    def is_synchronous_mode(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        :returns: ``True`` if parameter *mode* is enabled in the global configuration.[0m
[30;1m100 | [0m[35m        """[0m
[30;1m101 | [0m[35m        return bool(parse_bool(self.__config.get(mode)))[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    @property[0m
[30;1m104 | [0m[35m    def is_paused(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m        :returns: configuration value or ``None`` if it is missing.[0m
[30;1m90 | [0m[35m        """[0m
[30;1m91 | [0m[35m        return self.__config.get(name)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    def check_mode(self, mode: str) -> bool:[0m
[30;1m94 | [0m[35m        """Checks whether the certain parameter is enabled.[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    @property[0m
[30;1m120 | [0m[35m    def is_synchronous_mode_strict(self) -> bool:[0m
[30;1m121 | [0m[35m        """``True`` if at least one synchronous node is required."""[0m
[30;1m122 | [0m[35m        return self.check_mode('synchronous_mode_strict')[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def get_standby_cluster_config(self) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    @property[0m
[30;1m120 | [0m[35m    def is_synchronous_mode_strict(self) -> bool:[0m
[30;1m121 | [0m[35m        """``True`` if at least one synchronous node is required."""[0m
[30;1m122 | [0m[35m        return self.check_mode('synchronous_mode_strict')[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def get_standby_cluster_config(self) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m68 | [0m[35m            the last known valid state of the :class:`GlobalConfig` object.[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m            This method is used when we need to have the most up-to-date values in the global config[0m
[30;1m71 | [0m[35m            but we don't want to update the global object.[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        :param cluster: the currently known cluster state from DCS.[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/global_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35m        """Update with the new global configuration from the :class:`Cluster` object view.[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        .. note::[0m
[30;1m52 | [0m[35m            Update happens in-place and is executed only from the main heartbeat thread.[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        :param cluster: the currently known cluster state from DCS.[0m
[30;1m55 | [0m[35m        :param default: default configuration, which will be used if there is no valid *cluster.conf[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35m        c["log"]["format"] = [][0m
[30;1m386 | [0m[35m        errors = schema(c)[0m
[30;1m387 | [0m[35m        self.assertIn("log.format [] didn't pass validation: should contain at least one item", erro[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m        c["log"]["format"] = [{"levelname": []}][0m
[30;1m390 | [0m[35m        errors = schema(c)[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        members = CaseInsensitiveDict({m.name: m for m in cluster.members if m.name.lower() != postg[0m
[30;1m231 | [0m[35m        for row in postgresql.pg_stat_replication():[0m
[30;1m232 | [0m[35m            member = members.get(row['application_name'])[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m            # We want to consider only rows from ``pg_stat_replication` that:[0m
[30;1m235 | [0m[35m            # 1. are known to be streaming (write/flush/replay LSN are not NULL).[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m        sort_col = {[0m
[30;1m226 | [0m[35m            'remote_apply': 'replay',[0m
[30;1m227 | [0m[35m            'remote_write': 'write'[0m
[30;1m228 | [0m[35m        }.get(postgresql.synchronous_commit(), 'flush') + '_lsn'[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        members = CaseInsensitiveDict({m.name: m for m in cluster.members if m.name.lower() != postg[0m
[30;1m231 | [0m[35m        for row in postgresql.pg_stat_replication():[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m358 | [0m[35m                if global_config.is_quorum_commit_mode:[0m
[30;1m359 | [0m[35m                    # We do not add nodes with `nofailover` enabled because that reduces availabilit[0m
[30;1m360 | [0m[35m                    # We need to check LSN quorum only among nodes that are promotable because[0m
[30;1m361 | [0m[35m                    # there is a chance that a non-promotable node is ahead of a promotable one.[0m
[30;1m362 | [0m[35m                    if not replica.nofailover or len(active) < sync_node_count:[0m
[30;1m363 | [0m[35m                        if replica.application_name in self._ready_replicas:[0m
[30;1m364 | [0m[35m                            numsync_confirmed += 1[0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m    That is, first there will be replicas that have ``sync_state`` == ``sync``, even if they are not[0m
[30;1m206 | [0m[35m    the most up-to-date in term of write/flush/replay LSN. It helps to keep the result of choosing n[0m
[30;1m207 | [0m[35m    synchronous nodes consistent in case if a synchronous standby member is slowed down OR async nod[0m
[30;1m208 | [0m[35m    is receiving changes faster than the sync member. Such cases would trigger sync standby member[0m
[30;1m209 | [0m[35m    swapping, but only if lag on this member is exceeding a threshold (``maximum_lag_on_syncnode``).[0m
[30;1m210 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m    :ivar sync: collection of synchronous node names. In case of quorum commit all nodes listed[0m
[30;1m172 | [0m[35m                in ``synchronous_standby_names``, otherwise nodes that are confirmed to be synchrono[0m
[30;1m173 | [0m[35m                to the ``pg_stat_replication`` view.[0m
[30;1m174 | [0m[35m    :ivar active: collection of node names that are streaming and have no restrictions to become syn[0m
[30;1m175 | [0m[35m    """[0m
[30;1m176 | [0m[35m    sync_type: str[0m
[30;1m177 | [0m[35m    numsync: int[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35malid or contains ``*``.[0m
[30;1m169 | [0m[35m    :ivar numsync_confirmed: how many nodes are known to be synchronous according to the ``pg_stat_r[0m
[30;1m170 | [0m[35m                             Only nodes that caught up with the :attr:`SyncHandler._primary_flush_ls[0m
[30;1m171 | [0m[35m    :ivar sync: collection of synchronous node names. In case of quorum commit all nodes listed[0m
[30;1m172 | [0m[35m                in ``synchronous_standby_names``, otherwise nodes that are confirmed to be synchrono[0m
[30;1m173 | [0m[35m                to the ``pg_stat_replication`` view.[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport re[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom copy import deepcopy[0m
[30;1m6 | [0m[35mfrom typing import Collection, List, NamedTuple, Optional, TYPE_CHECKING[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m309 | [0m[35m                    and replica.application_name in self._ssn_data.members:[0m
[30;1m310 | [0m[35m                if global_config.is_quorum_commit_mode:[0m
[30;1m311 | [0m[35m                    # When quorum commit is enabled we can't check against cluster.sync because node[0m
[30;1m312 | [0m[35m                    # are written there when at least one of them caught up with _primary_flush_lsn.[0m
[30;1m313 | [0m[35m                    if replica.lsn >= self._primary_flush_lsn\[0m
[30;1m314 | [0m[35m                            and (replica.sync_state == 'quorum'[0m
[30;1m315 | [0m[35m                                 or (not self._postgresql.supports_quorum_commit[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m261 | [0m[35m        self._synchronous_standby_names = ''  # last known value of synchronous_standby_names[0m
[30;1m262 | [0m[35m        self._ssn_data = deepcopy(_EMPTY_SSN)[0m
[30;1m263 | [0m[35m        self._primary_flush_lsn = 0[0m
[30;1m264 | [0m[35m        # "sync" replication connections, that were verified to reach self._primary_flush_lsn at som[0m
[30;1m265 | [0m[35m        self._ready_replicas = CaseInsensitiveDict({})  # keys: member names, values: connection pid[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m    def _handle_synchronous_standby_names_change(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m155 | [0m[35m        elif a_type == 'dquot':[0m
[30;1m156 | [0m[35m            members.add(a_value[1:-1].replace('""', '"'))[0m
[30;1m157 | [0m[35m        else:[0m
[30;1m158 | [0m[35m            raise ValueError("Unparsable synchronous_standby_names value %r: Unexpected token %s %r [0m
[30;1m159 | [0m[35m                             (value, a_type, a_value, a_pos))[0m
[30;1m160 | [0m[35m    return _SSN(sync_type, has_star, num, members)[0m
[30;1m161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m146 | [0m[35m                                 (value, a_type, a_value, a_pos))[0m
[30;1m147 | [0m[35m            if a_type != 'comma':[0m
[30;1m148 | [0m[35m                raise ValueError("Unparsable synchronous_standby_names value %r: ""Got token %s %r w[0m
[30;1m149 | [0m[35m                                 " expecting comma at %d" % (value, a_type, a_value, a_pos))[0m
[30;1m150 | [0m[35m        elif a_type in {'ident', 'first', 'any'}:[0m
[30;1m151 | [0m[35m            members.add(a_value)[0m
[30;1m152 | [0m[35m        elif a_type == 'star':[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/sync.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m142 | [0m[35m    for i, (a_type, a_value, a_pos) in enumerate(synclist):[0m
[30;1m143 | [0m[35m        if i % 2 == 1:  # odd elements are supposed to be commas[0m
[30;1m144 | [0m[35m            if len(synclist) == i + 1:  # except the last token[0m
[30;1m145 | [0m[35m                raise ValueError("Unparsable synchronous_standby_names value %r: Unexpected token %s[0m
[30;1m146 | [0m[35m                                 (value, a_type, a_value, a_pos))[0m
[30;1m147 | [0m[35m            if a_type != 'comma':[0m
[30;1m148 | [0m[35m                raise ValueError("Unparsable synchronous_standby_names value %r: ""Got token %s %r w[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/available_parameters/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef get_validator_files() -> Iterator[PathLikeObj]:[0m
[30;1m26 | [0m[35m    """Recursively find YAML files from the current package directory.[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    :returns: an iterator of :class:`PathLikeObj` objects representing validator files.[0m
[30;1m29 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35m    parser = ArgumentParser([0m
[30;1m55 | [0m[35m        description=([0m
[30;1m56 | [0m[35m            "Wrapper application for pg-backup-api. Communicate with the API "[0m
[30;1m57 | [0m[35m            "running at the given URL to perform remote Barman operations."[0m
[30;1m58 | [0m[35m        ),[0m
[30;1m59 | [0m[35m    )[0m
[30;1m60 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m        "role",[0m
[30;1m173 | [0m[35m        type=str,[0m
[30;1m174 | [0m[35m        choices=["primary", "promoted", "standby_leader", "replica", "demoted"],[0m
[30;1m175 | [0m[35m        help="Name of the new role of this node (automatically filled by "[0m
[30;1m176 | [0m[35m             "Patroni)",[0m
[30;1m177 | [0m[35m    )[0m
[30;1m178 | [0m[35m    config_switch_parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    Implements the parser for the application and for its sub-commands.[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    The script exit code may be one of:[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    * :attr:`ExitCode.NO_COMMAND`: if no sub-command was specified in the[0m
[30;1m43 | [0m[35m        ``patroni_barman`` call;[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m        try:[0m
[30;1m142 | [0m[35m            import pytest[0m
[30;1m143 | [0m[35m        except Exception:[0m
[30;1m144 | [0m[35m            raise RuntimeError('py.test is not installed, run: pip install pytest')[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m        logging.getLogger().setLevel(logging.WARNING)[0m
[30;1m147 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m        mock_postmaster.signal_stop.return_value = False[0m
[30;1m226 | [0m[35m        self.assertFalse(self.p.stop())[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        # Stop signal failed to find process[0m
[30;1m229 | [0m[35m        mock_postmaster.signal_stop.return_value = True[0m
[30;1m230 | [0m[35m        mock_callback.reset_mock()[0m
[30;1m231 | [0m[35m        self.assertTrue(self.p.stop(on_safepoint=mock_callback))[0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35m        mock_cancellable_call.return_value = 0[0m
[30;1m215 | [0m[35m        with patch('patroni.postgresql.logger.info') as mock_logger:[0m
[30;1m216 | [0m[35m            self.p.stop(on_safepoint=mock_callback, stop_timeout=30)[0m
[30;1m217 | [0m[35m            self.assertEqual(mock_logger.call_args[0], ('before_stop script `%s` exited with %s', ':[0m
[30;1m218 | [0m[35m        mock_postmaster.wait.side_effect = [psutil.TimeoutExpired(30), Mock()][0m
[30;1m219 | [0m[35m        mock_cancellable_call.side_effect = Exception[0m
[30;1m220 | [0m[35m        with patch('patroni.postgresql.logger.error') as mock_logger:[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m        mock_postmaster.wait.side_effect = [psutil.TimeoutExpired(30), Mock()][0m
[30;1m209 | [0m[35m        self.assertTrue(self.p.stop(on_safepoint=mock_callback, stop_timeout=30))[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        # Ensure before_stop script is called when configured to[0m
[30;1m212 | [0m[35m        self.p.config._config['before_stop'] = ':'[0m
[30;1m213 | [0m[35m        mock_postmaster.wait.side_effect = [psutil.TimeoutExpired(30), Mock()][0m
[30;1m214 | [0m[35m        mock_cancellable_call.return_value = 0[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m        mock_postmaster.is_running.return_value = True[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        # timeout[0m
[30;1m172 | [0m[35m        self.assertFalse(self.p.wait_for_port_open(mock_postmaster, 1))[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        # pg_isready failure[0m
[30;1m175 | [0m[35m        mock_pg_isready.return_value = 'garbage'[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35mLatest checkpoint's oldestMultiXid:   1[0m
[30;1m68 | [0m[35mLatest checkpoint's oldestMulti's DB: 1[0m
[30;1m69 | [0m[35mLatest checkpoint's oldestCommitTs:   0[0m
[30;1m70 | [0m[35mLatest checkpoint's newestCommitTs:   0[0m
[30;1m71 | [0m[35mTime of latest checkpoint:            Fri Oct  2 10:56:54 2015[0m
[30;1m72 | [0m[35mFake LSN counter for unlogged rels:   0/1[0m
[30;1m73 | [0m[35mMinimum recovery ending location:     0/30241F8[0m
[30;1m74 | [0m[35mMin recovery ending loc's timeline:   2[0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_postgresql.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport re[0m
[30;1m4 | [0m[35mimport subprocess[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom copy import deepcopy[0m
[30;1m8 | [0m[35mfrom pathlib import Path[0m
[30;1m9 | [0m[35mfrom threading import current_thread, Thread[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_api.py[0m
   Pattern: [32m.hostname[0m
[30;1m733 | [0m[35m        try:[0m
[30;1m734 | [0m[35m            import ssl[0m
[30;1m735 | [0m[35m            ctx = ssl.create_default_context(ssl.Purpose.SERVER_AUTH)[0m
[30;1m736 | [0m[35m            ctx.check_hostname = False[0m
[30;1m737 | [0m[35m            sock = ctx.wrap_socket(sock=sock)[0m
[30;1m738 | [0m[35m            sock.do_handshake = Mock()[0m
[30;1m739 | [0m[35m            sock.unwrap = Mock(side_effect=Exception)[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m590 | [0m[35m            MockRestApiServer(RestApiHandler, request)[0m
[30;1m591 | [0m[35m            response_mock.assert_called_with(503, 'Switchover status unknown')[0m
[30;1m592 | [0m[35m[0m
[30;1m593 | [0m[35m        # Switchover to a node different from the candidate specified[0m
[30;1m594 | [0m[35m        with patch.object(RestApiHandler, 'write_response') as response_mock:[0m
[30;1m595 | [0m[35m            cluster2 = cluster.copy()[0m
[30;1m596 | [0m[35m            cluster2.leader.name = 'postgresql0'[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m541 | [0m[35m[0m
[30;1m542 | [0m[35m        # No healthy nodes to promote in both sync and async mode[0m
[30;1m543 | [0m[35m        for is_synchronous_mode, response in ([0m
[30;1m544 | [0m[35m                (True, 'switchover is not possible: can not find sync_standby'),[0m
[30;1m545 | [0m[35m                (False, 'switchover is not possible: cluster does not have members except leader')):[0m
[30;1m546 | [0m[35m            with patch.object(global_config.__class__, 'is_synchronous_mode',[0m
[30;1m547 | [0m[35m                              PropertyMock(return_value=is_synchronous_mode)), \[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m476 | [0m[35m            MockRestApiServer(RestApiHandler, make_request(schedule='2016-08-42 12:45TZ+1', role='pr[0m
[30;1m477 | [0m[35m            # Valid timeout[0m
[30;1m478 | [0m[35m            MockRestApiServer(RestApiHandler, make_request(timeout='60s'))[0m
[30;1m479 | [0m[35m            # Invalid timeout[0m
[30;1m480 | [0m[35m            MockRestApiServer(RestApiHandler, make_request(timeout='42towels'))[0m
[30;1m481 | [0m[35m[0m
[30;1m482 | [0m[35m    def test_do_DELETE_restart(self):[0m
[30;1m483 | [0m[35m        for retval in (True, False):[0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m        with patch.object(global_config.__class__, 'is_paused', PropertyMock(return_value=True)):[0m
[30;1m476 | [0m[35m            MockRestApiServer(RestApiHandler, make_request(schedule='2016-08-42 12:45TZ+1', role='pr[0m
[30;1m477 | [0m[35m            # Valid timeout[0m
[30;1m478 | [0m[35m            MockRestApiServer(RestApiHandler, make_request(timeout='60s'))[0m
[30;1m479 | [0m[35m            # Invalid timeout[0m
[30;1m480 | [0m[35m            MockRestApiServer(RestApiHandler, make_request(timeout='42towels'))[0m
[30;1m481 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dynamic_loader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m        toc: Set[str] = set()[0m
[30;1m34 | [0m[35m        # dirname may contain a few dots, which causes pkgutil.iter_importers()[0m
[30;1m35 | [0m[35m        # to misinterpret the path as a package name. This can be avoided[0m
[30;1m36 | [0m[35m        # altogether by not passing a path at all, because PyInstaller's[0m
[30;1m37 | [0m[35m        # FrozenImporter is a singleton and registered as top-level finder.[0m
[30;1m38 | [0m[35m        for importer in pkgutil.iter_importers():[0m
[30;1m39 | [0m[35m            if hasattr(importer, 'toc'):[0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dynamic_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m        package: str, cls_type: Type[ClassType],[0m
[30;1m75 | [0m[35m        config: Optional[Union['Config', Dict[str, Any]]] = None[0m
[30;1m76 | [0m[35m) -> Iterator[Tuple[str, Type[ClassType]]]:[0m
[30;1m77 | [0m[35m    """Attempt to import modules and find implementations of *cls_type* that are present in the give[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    .. note::[0m
[30;1m80 | [0m[35m            If a module successfully imports we can assume that all its requirements are installed.[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dynamic_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35mdef find_class_in_module(module: ModuleType, cls_type: Type[ClassType]) -> Optional[Type[ClassType]][0m
[30;1m58 | [0m[35m    """Try to find the implementation of *cls_type* class interface in *module* matching the *module[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    :param module: imported module.[0m
[30;1m61 | [0m[35m    :param cls_type: a class type we are looking for.[0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dynamic_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    .. note::[0m
[30;1m22 | [0m[35m        If being packaged with PyInstaller, modules aren't discoverable dynamically by scanning sour[0m
[30;1m23 | [0m[35m        :class:`importlib.machinery.FrozenImporter` doesn't implement :func:`iter_modules`. But it i[0m
[30;1m24 | [0m[35m        find all potential modules by iterating through ``toc``, which contains list of all "frozen"[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    :param package: a package name to search modules in, e.g. ``patroni.dcs``.[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2203 | [0m[35m                    response = request_patroni(m)[0m
[30;1m2204 | [0m[35m                    data = json.loads(response.data.decode('utf-8'))[0m
[30;1m2205 | [0m[35m                    version = data.get('patroni', {}).get('version')[0m
[30;1m2206 | [0m[35m                    pg_version = data.get('server_version')[0m
[30;1m2207 | [0m[35m                    pg_version_str = " PostgreSQL {0}".format(format_pg_version(pg_version)) if pg_v[0m
[30;1m2208 | [0m[35m                    click.echo("{0}: Patroni {1}{2}".format(m.name, version, pg_version_str))[0m
[30;1m2209 | [0m[35m                except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2202 | [0m[35m                try:[0m
[30;1m2203 | [0m[35m                    response = request_patroni(m)[0m
[30;1m2204 | [0m[35m                    data = json.loads(response.data.decode('utf-8'))[0m
[30;1m2205 | [0m[35m                    version = data.get('patroni', {}).get('version')[0m
[30;1m2206 | [0m[35m                    pg_version = data.get('server_version')[0m
[30;1m2207 | [0m[35m                    pg_version_str = " PostgreSQL {0}".format(format_pg_version(pg_version)) if pg_v[0m
[30;1m2208 | [0m[35m                    click.echo("{0}: Patroni {1}{2}".format(m.name, version, pg_version_str))[0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2202 | [0m[35m                try:[0m
[30;1m2203 | [0m[35m                    response = request_patroni(m)[0m
[30;1m2204 | [0m[35m                    data = json.loads(response.data.decode('utf-8'))[0m
[30;1m2205 | [0m[35m                    version = data.get('patroni', {}).get('version')[0m
[30;1m2206 | [0m[35m                    pg_version = data.get('server_version')[0m
[30;1m2207 | [0m[35m                    pg_version_str = " PostgreSQL {0}".format(format_pg_version(pg_version)) if pg_v[0m
[30;1m2208 | [0m[35m                    click.echo("{0}: Patroni {1}{2}".format(m.name, version, pg_version_str))[0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2055 | [0m[35m            * No suitable editor can be found; or[0m
[30;1m2056 | [0m[35m            * Editor call exits with unexpected return code.[0m
[30;1m2057 | [0m[35m    """[0m
[30;1m2058 | [0m[35m    editor_cmd = os.environ.get('EDITOR')[0m
[30;1m2059 | [0m[35m    if not editor_cmd:[0m
[30;1m2060 | [0m[35m        for editor in ('editor', 'vi'):[0m
[30;1m2061 | [0m[35m            editor_cmd = shutil.which(editor)[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2000 | [0m[35m                config[key] = value[0m
[30;1m2001 | [0m[35m        # Otherwise we need to keep navigating down in the configuration structure.[0m
[30;1m2002 | [0m[35m        else:[0m
[30;1m2003 | [0m[35m            if not isinstance(config.get(key), dict):[0m
[30;1m2004 | [0m[35m                config[key] = {}[0m
[30;1m2005 | [0m[35m            set_path_value(config[key], path[1:], value, prefix + (key,))[0m
[30;1m2006 | [0m[35m            if config[key] == {}:[0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1920 | [0m[35m            pager = next([0m
[30;1m1921 | [0m[35m                ([0m
[30;1m1922 | [0m[35m                    os.path.basename(p)[0m
[30;1m1923 | [0m[35m                    for p in (os.environ.get('PAGER'), "less", "more")[0m
[30;1m1924 | [0m[35m                    if p is not None and bool(shutil.which(p))[0m
[30;1m1925 | [0m[35m                ),[0m
[30;1m1926 | [0m[35m                None,[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1781 | [0m[35m    else:[0m
[30;1m1782 | [0m[35m        if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m1783 | [0m[35m            assert cluster is not None[0m
[30;1m1784 | [0m[35m        remaining = [m.name for m in cluster.members if m.data.get('pause', False) != paused[0m
[30;1m1785 | [0m[35m                     and m.name in old and old[m.name] != m.version][0m
[30;1m1786 | [0m[35m        if remaining:[0m
[30;1m1787 | [0m[35m            return click.echo("{0} members didn't recognized pause state after {1} seconds"[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1776 | [0m[35m    cluster = None[0m
[30;1m1777 | [0m[35m    for _ in polling_loop(loop_wait + 1):[0m
[30;1m1778 | [0m[35m        cluster = dcs.get_cluster()[0m
[30;1m1779 | [0m[35m        if all(m.data.get('pause', False) == paused for m in cluster.members if m.name in old):[0m
[30;1m1780 | [0m[35m            break[0m
[30;1m1781 | [0m[35m    else:[0m
[30;1m1782 | [0m[35m        if TYPE_CHECKING:  # pragma: no cover[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1771 | [0m[35m[0m
[30;1m1772 | [0m[35m    click.echo("'{0}' request sent, waiting until it is recognized by all nodes".format(paused and '[0m
[30;1m1773 | [0m[35m    old = {m.name: m.version for m in old_cluster.members if m.api_url}[0m
[30;1m1774 | [0m[35m    loop_wait = config.get('loop_wait') or dcs.loop_wait[0m
[30;1m1775 | [0m[35m[0m
[30;1m1776 | [0m[35m    cluster = None[0m
[30;1m1777 | [0m[35m    for _ in polling_loop(loop_wait + 1):[0m

[31m--[ [0m[34mMatch #[0m[33m882[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1732 | [0m[35m[0m
[30;1m1733 | [0m[35m    if target == 'restart':[0m
[30;1m1734 | [0m[35m        for member in get_members(cluster, cluster_name, member_names, role, force, 'flush', group=g[0m
[30;1m1735 | [0m[35m            if member.data.get('scheduled_restart'):[0m
[30;1m1736 | [0m[35m                r = request_patroni(member, 'delete', 'restart')[0m
[30;1m1737 | [0m[35m                check_response(r, member.name, 'flush scheduled restart')[0m
[30;1m1738 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m883[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1610 | [0m[35m                    value += ' if version < {0}'.format(member['scheduled_restart']['postgres_versio[0m
[30;1m1611 | [0m[35m                member['scheduled_restart'] = value[0m
[30;1m1612 | [0m[35m[0m
[30;1m1613 | [0m[35m            rows.append([member.get(n.lower().replace(' ', '_'), '') for n in columns])[0m
[30;1m1614 | [0m[35m[0m
[30;1m1615 | [0m[35m    if is_citus_cluster():[0m
[30;1m1616 | [0m[35m        title = 'Citus cluster'[0m

[31m--[ [0m[34mMatch #[0m[33m884[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1601 | [0m[35m                          pending_restart='*' if member.get('pending_restart') else '',[0m
[30;1m1602 | [0m[35m                          pending_restart_reason=restart_reason)[0m
[30;1m1603 | [0m[35m[0m
[30;1m1604 | [0m[35m            if append_port and member['host'] and member.get('port'):[0m
[30;1m1605 | [0m[35m                member['host'] = ':'.join([member['host'], str(member['port'])])[0m
[30;1m1606 | [0m[35m[0m
[30;1m1607 | [0m[35m            if 'scheduled_restart' in member:[0m

[31m--[ [0m[34mMatch #[0m[33m885[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1598 | [0m[35m                          host=member.get('host', ''), tl=member.get('timeline', ''),[0m
[30;1m1599 | [0m[35m                          role=member['role'].replace('_', ' ').title(),[0m
[30;1m1600 | [0m[35m                          lag_in_mb=round(lag / 1024 / 1024) if isinstance(lag, int) else lag,[0m
[30;1m1601 | [0m[35m                          pending_restart='*' if member.get('pending_restart') else '',[0m
[30;1m1602 | [0m[35m                          pending_restart_reason=restart_reason)[0m
[30;1m1603 | [0m[35m[0m
[30;1m1604 | [0m[35m            if append_port and member['host'] and member.get('port'):[0m

[31m--[ [0m[34mMatch #[0m[33m886[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1595 | [0m[35m                                        for k, v in member.get('pending_restart_reason', {}).items()[0m
[30;1m1596 | [0m[35m[0m
[30;1m1597 | [0m[35m            member.update(cluster=name, member=member['name'], group=g,[0m
[30;1m1598 | [0m[35m                          host=member.get('host', ''), tl=member.get('timeline', ''),[0m
[30;1m1599 | [0m[35m                          role=member['role'].replace('_', ' ').title(),[0m
[30;1m1600 | [0m[35m                          lag_in_mb=round(lag / 1024 / 1024) if isinstance(lag, int) else lag,[0m
[30;1m1601 | [0m[35m                          pending_restart='*' if member.get('pending_restart') else '',[0m

[31m--[ [0m[34mMatch #[0m[33m887[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1595 | [0m[35m                                        for k, v in member.get('pending_restart_reason', {}).items()[0m
[30;1m1596 | [0m[35m[0m
[30;1m1597 | [0m[35m            member.update(cluster=name, member=member['name'], group=g,[0m
[30;1m1598 | [0m[35m                          host=member.get('host', ''), tl=member.get('timeline', ''),[0m
[30;1m1599 | [0m[35m                          role=member['role'].replace('_', ' ').title(),[0m
[30;1m1600 | [0m[35m                          lag_in_mb=round(lag / 1024 / 1024) if isinstance(lag, int) else lag,[0m
[30;1m1601 | [0m[35m                          pending_restart='*' if member.get('pending_restart') else '',[0m

[31m--[ [0m[34mMatch #[0m[33m888[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1592 | [0m[35m                full_diff = param + ': ' + values['old_value'] + '->' + values['new_value'][0m
[30;1m1593 | [0m[35m                return full_diff if not hide_long or len(full_diff) <= 50 else param + ': [hidden - [0m
[30;1m1594 | [0m[35m            restart_reason = '\n'.join([format_diff(k, v, fmt in ('pretty', 'topology'))[0m
[30;1m1595 | [0m[35m                                        for k, v in member.get('pending_restart_reason', {}).items()[0m
[30;1m1596 | [0m[35m[0m
[30;1m1597 | [0m[35m            member.update(cluster=name, member=member['name'], group=g,[0m
[30;1m1598 | [0m[35m                          host=member.get('host', ''), tl=member.get('timeline', ''),[0m

[31m--[ [0m[34mMatch #[0m[33m889[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1586 | [0m[35m        for member in sort(c['members']):[0m
[30;1m1587 | [0m[35m            logging.debug(member)[0m
[30;1m1588 | [0m[35m[0m
[30;1m1589 | [0m[35m            lag = member.get('lag', '')[0m
[30;1m1590 | [0m[35m[0m
[30;1m1591 | [0m[35m            def format_diff(param: str, values: Dict[str, str], hide_long: bool):[0m
[30;1m1592 | [0m[35m                full_diff = param + ': ' + values['old_value'] + '->' + values['new_value'][0m

[31m--[ [0m[34mMatch #[0m[33m890[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1574 | [0m[35m    all_members = [m for c in clusters.values() for m in c['members'] if 'host' in m][0m
[30;1m1575 | [0m[35m[0m
[30;1m1576 | [0m[35m    for c in ('Pending restart', 'Pending restart reason', 'Scheduled restart', 'Tags'):[0m
[30;1m1577 | [0m[35m        if extended or any(m.get(c.lower().replace(' ', '_')) for m in all_members):[0m
[30;1m1578 | [0m[35m            columns.append(c)[0m
[30;1m1579 | [0m[35m[0m
[30;1m1580 | [0m[35m    # Show Host as 'host:port' if somebody is running on non-standard port or two nodes are running [0m

[31m--[ [0m[34mMatch #[0m[33m891[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1561 | [0m[35m    rows: List[List[Any]] = [][0m
[30;1m1562 | [0m[35m    logging.debug(cluster)[0m
[30;1m1563 | [0m[35m[0m
[30;1m1564 | [0m[35m    initialize = {None: 'uninitialized', '': 'initializing'}.get(cluster.initialize, cluster.initial[0m
[30;1m1565 | [0m[35m    columns = ['Cluster', 'Member', 'Host', 'Role', 'State', 'TL', 'Lag in MB'][0m
[30;1m1566 | [0m[35m[0m
[30;1m1567 | [0m[35m    clusters = {group or 0: cluster_as_json(cluster)}[0m

[31m--[ [0m[34mMatch #[0m[33m892[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1511 | [0m[35m        * Scheduled switchovers.[0m
[30;1m1512 | [0m[35m    """[0m
[30;1m1513 | [0m[35m    service_info: List[str] = [][0m
[30;1m1514 | [0m[35m    if cluster.get('pause'):[0m
[30;1m1515 | [0m[35m        service_info.append('Maintenance mode: on')[0m
[30;1m1516 | [0m[35m[0m
[30;1m1517 | [0m[35m    if 'scheduled_switchover' in cluster:[0m

[31m--[ [0m[34mMatch #[0m[33m893[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1493 | [0m[35m    replicas = set(member['name'] for member in members if not member['role'].endswith('leader'))[0m
[30;1m1494 | [0m[35m    for member in members:[0m
[30;1m1495 | [0m[35m        if not member['role'].endswith('leader'):[0m
[30;1m1496 | [0m[35m            parent = member.get('tags', {}).get('replicatefrom')[0m
[30;1m1497 | [0m[35m            parent = parent if parent and parent != member['name'] and parent in replicas else leade[0m
[30;1m1498 | [0m[35m            topology[parent].append(member)[0m
[30;1m1499 | [0m[35m    for member in generate_topology(0, leader, topology):[0m

[31m--[ [0m[34mMatch #[0m[33m894[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1493 | [0m[35m    replicas = set(member['name'] for member in members if not member['role'].endswith('leader'))[0m
[30;1m1494 | [0m[35m    for member in members:[0m
[30;1m1495 | [0m[35m        if not member['role'].endswith('leader'):[0m
[30;1m1496 | [0m[35m            parent = member.get('tags', {}).get('replicatefrom')[0m
[30;1m1497 | [0m[35m            parent = parent if parent and parent != member['name'] and parent in replicas else leade[0m
[30;1m1498 | [0m[35m            topology[parent].append(member)[0m
[30;1m1499 | [0m[35m    for member in generate_topology(0, leader, topology):[0m

[31m--[ [0m[34mMatch #[0m[33m895[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1458 | [0m[35m[0m
[30;1m1459 | [0m[35m    :yields: the current member with its name changed. Besides that reyield values from recursive ca[0m
[30;1m1460 | [0m[35m    """[0m
[30;1m1461 | [0m[35m    members = topology.get(member['name'], [])[0m
[30;1m1462 | [0m[35m[0m
[30;1m1463 | [0m[35m    if level > 0:[0m
[30;1m1464 | [0m[35m        member['name'] = '{0}+ {1}'.format((' ' * (level - 1) * 2), member['name'])[0m

[31m--[ [0m[34mMatch #[0m[33m896[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1210 | [0m[35m        time.sleep(2)[0m
[30;1m1211 | [0m[35m        for member in wait_on_members:[0m
[30;1m1212 | [0m[35m            data = json.loads(request_patroni(member, 'get', 'patroni').data.decode('utf-8'))[0m
[30;1m1213 | [0m[35m            if data.get('state') != 'creating replica':[0m
[30;1m1214 | [0m[35m                click.echo('Reinitialize is completed on: {0}'.format(member.name))[0m
[30;1m1215 | [0m[35m                wait_on_members.remove(member)[0m
[30;1m1216 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m897[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m    for member in members:[0m
[30;1m1148 | [0m[35m        if 'schedule' in content:[0m
[30;1m1149 | [0m[35m            if force and member.data.get('scheduled_restart'):[0m
[30;1m1150 | [0m[35m                r = request_patroni(member, 'delete', 'restart')[0m
[30;1m1151 | [0m[35m                check_response(r, member.name, 'flush scheduled restart', True)[0m
[30;1m1152 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m898[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1116 | [0m[35m        # For scheduled restarts we don't filter the members now. If they really need a restart migh[0m
[30;1m1117 | [0m[35m        # until the scheduled time.[0m
[30;1m1118 | [0m[35m        if not scheduled_at:[0m
[30;1m1119 | [0m[35m            members = [m for m in members if m.data.get('pending_restart', False)][0m
[30;1m1120 | [0m[35m[0m
[30;1m1121 | [0m[35m    if p_any:[0m
[30;1m1122 | [0m[35m        random.shuffle(members)[0m

[31m--[ [0m[34mMatch #[0m[33m899[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1055 | [0m[35m        elif r.status == 202:[0m
[30;1m1056 | [0m[35m            config = global_config.from_cluster(cluster)[0m
[30;1m1057 | [0m[35m            click.echo('Reload request received for member {0} and will be processed within {1} seco[0m
[30;1m1058 | [0m[35m                member.name, config.get('loop_wait') or dcs.loop_wait)[0m
[30;1m1059 | [0m[35m            )[0m
[30;1m1060 | [0m[35m        else:[0m
[30;1m1061 | [0m[35m            click.echo('Failed: reload for member {0}, status code={1}, ({2})'.format([0m

[31m--[ [0m[34mMatch #[0m[33m900[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m519 | [0m[35m            if cluster.leader is not None and cluster.leader.name and\[0m
[30;1m520 | [0m[35m                    (role == 'leader'[0m
[30;1m521 | [0m[35m                     or cluster.leader.data.get('role') not in ('primary', 'master') and role == 'st[0m
[30;1m522 | [0m[35m                     or cluster.leader.data.get('role') != 'standby_leader' and role == 'primary'):[0m
[30;1m523 | [0m[35m                yield cluster.leader.member[0m
[30;1m524 | [0m[35m        return[0m
[30;1m525 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m901[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m518 | [0m[35m        for cluster in clusters.values():[0m
[30;1m519 | [0m[35m            if cluster.leader is not None and cluster.leader.name and\[0m
[30;1m520 | [0m[35m                    (role == 'leader'[0m
[30;1m521 | [0m[35m                     or cluster.leader.data.get('role') not in ('primary', 'master') and role == 'st[0m
[30;1m522 | [0m[35m                     or cluster.leader.data.get('role') != 'standby_leader' and role == 'primary'):[0m
[30;1m523 | [0m[35m                yield cluster.leader.member[0m
[30;1m524 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m902[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m514 | [0m[35m    if role in ('leader', 'primary', 'standby-leader'):[0m
[30;1m515 | [0m[35m        # In the DCS the members' role can be one among: ``primary``, ``master``, ``replica`` or ``s[0m
[30;1m516 | [0m[35m        # ``primary`` and ``master`` are the same thing.[0m
[30;1m517 | [0m[35m        role = {'standby-leader': 'standby_leader'}.get(role, role)[0m
[30;1m518 | [0m[35m        for cluster in clusters.values():[0m
[30;1m519 | [0m[35m            if cluster.leader is not None and cluster.leader.name and\[0m
[30;1m520 | [0m[35m                    (role == 'leader'[0m

[31m--[ [0m[34mMatch #[0m[33m903[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m    :returns: the response for the request.[0m
[30;1m387 | [0m[35m    """[0m
[30;1m388 | [0m[35m    ctx = click.get_current_context()  # the current click context[0m
[30;1m389 | [0m[35m    request_executor = ctx.obj.get('__request_patroni')[0m
[30;1m390 | [0m[35m    if not request_executor:[0m
[30;1m391 | [0m[35m        request_executor = ctx.obj['__request_patroni'] = PatroniRequest(_get_configuration())[0m
[30;1m392 | [0m[35m    return request_executor(member, method, endpoint, data)[0m

[31m--[ [0m[34mMatch #[0m[33m904[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m    logging.captureWarnings(True)  # Capture eventual SSL warning[0m
[30;1m328 | [0m[35m    config = load_config(config_file, dcs_url)[0m
[30;1m329 | [0m[35m    # backward compatibility for configuration file where ctl section is not defined[0m
[30;1m330 | [0m[35m    config.setdefault('ctl', {})['insecure'] = config.get('ctl', {}).get('insecure') or insecure[0m
[30;1m331 | [0m[35m    ctx.obj = {'__config': config, '__mpp': get_mpp(config)}[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m905[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m    logging.captureWarnings(True)  # Capture eventual SSL warning[0m
[30;1m328 | [0m[35m    config = load_config(config_file, dcs_url)[0m
[30;1m329 | [0m[35m    # backward compatibility for configuration file where ctl section is not defined[0m
[30;1m330 | [0m[35m    config.setdefault('ctl', {})['insecure'] = config.get('ctl', {}).get('insecure') or insecure[0m
[30;1m331 | [0m[35m    ctx.obj = {'__config': config, '__mpp': get_mpp(config)}[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m906[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m    """[0m
[30;1m323 | [0m[35m    level = 'WARNING'[0m
[30;1m324 | [0m[35m    for name in ('LOGLEVEL', 'PATRONI_LOGLEVEL', 'PATRONI_LOG_LEVEL'):[0m
[30;1m325 | [0m[35m        level = os.environ.get(name, level)[0m
[30;1m326 | [0m[35m    logging.basicConfig(format='%(asctime)s - %(levelname)s - %(message)s', level=level)[0m
[30;1m327 | [0m[35m    logging.captureWarnings(True)  # Capture eventual SSL warning[0m
[30;1m328 | [0m[35m    config = load_config(config_file, dcs_url)[0m

[31m--[ [0m[34mMatch #[0m[33m907[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35marg_cluster_name = click.argument('cluster_name', required=False,[0m
[30;1m288 | [0m[35m                                  default=lambda: _get_configuration().get('scope'))[0m
[30;1m289 | [0m[35moption_default_citus_group = click.option('--group', required=False, type=int, help='Citus group',[0m
[30;1m290 | [0m[35m                                          default=lambda: _get_configuration().get('citus', {}).get([0m
[30;1m291 | [0m[35moption_citus_group = click.option('--group', required=False, type=int, help='Citus group')[0m
[30;1m292 | [0m[35mrole_choice = click.Choice(['leader', 'primary', 'standby-leader', 'replica', 'standby', 'any'])[0m
[30;1m293 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m908[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35marg_cluster_name = click.argument('cluster_name', required=False,[0m
[30;1m288 | [0m[35m                                  default=lambda: _get_configuration().get('scope'))[0m
[30;1m289 | [0m[35moption_default_citus_group = click.option('--group', required=False, type=int, help='Citus group',[0m
[30;1m290 | [0m[35m                                          default=lambda: _get_configuration().get('citus', {}).get([0m
[30;1m291 | [0m[35moption_citus_group = click.option('--group', required=False, type=int, help='Citus group')[0m
[30;1m292 | [0m[35mrole_choice = click.Choice(['leader', 'primary', 'standby-leader', 'replica', 'standby', 'any'])[0m
[30;1m293 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m909[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m is_flag=True, help='Auto update the screen every 2 seconds')[0m
[30;1m286 | [0m[35moption_force = click.option('--force', is_flag=True, help='Do not ask for confirmation at any point'[0m
[30;1m287 | [0m[35marg_cluster_name = click.argument('cluster_name', required=False,[0m
[30;1m288 | [0m[35m                                  default=lambda: _get_configuration().get('scope'))[0m
[30;1m289 | [0m[35moption_default_citus_group = click.option('--group', required=False, type=int, help='Citus group',[0m
[30;1m290 | [0m[35m                                          default=lambda: _get_configuration().get('citus', {}).get([0m

[31m--[ [0m[34mMatch #[0m[33m910[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m        :returns: string representation of a header line.[0m
[30;1m136 | [0m[35m        """[0m
[30;1m137 | [0m[35m        ret = super(PatronictlPrettyTable, self)._stringify_hrule(*args, **kwargs)[0m
[30;1m138 | [0m[35m        where = args[1] if len(args) > 1 else kwargs.get('where')[0m
[30;1m139 | [0m[35m        if where == 'top_' and self.__table_header:[0m
[30;1m140 | [0m[35m            ret = self.__build_header(ret)[0m
[30;1m141 | [0m[35m            self.__hline_num += 1[0m

[31m--[ [0m[34mMatch #[0m[33m911[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m.hostname[0m
[30;1m1531 | [0m[35m[0m
[30;1m1532 | [0m[35m        * ``Cluster``: name of the Patroni cluster, as per ``scope`` configuration;[0m
[30;1m1533 | [0m[35m        * ``Member``: name of the Patroni node, as per ``name`` configuration;[0m
[30;1m1534 | [0m[35m        * ``Host``: hostname (or IP) and port, as per ``postgresql.listen`` configuration;[0m
[30;1m1535 | [0m[35m        * ``Role``: ``Leader``, ``Standby Leader``, ``Sync Standby`` or ``Replica``;[0m
[30;1m1536 | [0m[35m        * ``State``: ``stopping``, ``stopped``, ``stop failed``, ``crashed``, ``running``, ``startin[0m
[30;1m1537 | [0m[35m          ``start failed``, ``restarting``, ``restart failed``, ``initializing new cluster``, ``init[0m

[31m--[ [0m[34mMatch #[0m[33m912[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m.hostname[0m
[30;1m232 | [0m[35m        raise PatroniCtlException('Unknown dcs scheme: {}'.format(scheme))[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    default = DCS_DEFAULTS[scheme][0m
[30;1m235 | [0m[35m    ret = yaml.safe_load(default['template'].format(host=parsed.hostname or 'localhost', port=port o[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    if parsed.path and parsed.path.strip() != '/':[0m
[30;1m238 | [0m[35m        ret['namespace'] = parsed.path.strip()[0m

[31m--[ [0m[34mMatch #[0m[33m913[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2096 | [0m[35m                pgkvpairs: List[str], apply_filename: Optional[str], replace_filename: Optional[str][0m
[30;1m2097 | [0m[35m    """Process ``edit-config`` command of ``patronictl`` utility.[0m
[30;1m2098 | [0m[35m[0m
[30;1m2099 | [0m[35m    Update or replace Patroni configuration in the DCS.[0m
[30;1m2100 | [0m[35m[0m
[30;1m2101 | [0m[35m    :param cluster_name: name of the Patroni cluster.[0m
[30;1m2102 | [0m[35m    :param group: filter which Citus group configuration we should edit. Refer to the module note fo[0m

[31m--[ [0m[34mMatch #[0m[33m914[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1992 | [0m[35m[0m
[30;1m1993 | [0m[35m        key = path[0][0m
[30;1m1994 | [0m[35m        # When *path* contains a single item it means we reached a leaf node in the configuration, s[0m
[30;1m1995 | [0m[35m        # update the configuration based on what has been requested by the user.[0m
[30;1m1996 | [0m[35m        if len(path) == 1:[0m
[30;1m1997 | [0m[35m            if value is None:[0m
[30;1m1998 | [0m[35m                config.pop(key, None)[0m

[31m--[ [0m[34mMatch #[0m[33m915[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1978 | [0m[35m        """Recursively walk through *config* and update setting specified by *path* with *value*.[0m
[30;1m1979 | [0m[35m[0m
[30;1m1980 | [0m[35m        :param config: configuration data structure with all settings found under *prefix* path.[0m
[30;1m1981 | [0m[35m        :param path: dotted path split by dot as delimiter into a list. Used to control the recursiv[0m
[30;1m1982 | [0m[35m            when a leaf node is reached.[0m
[30;1m1983 | [0m[35m        :param value: value for configuration described by *path*. If ``None`` the configuration key[0m
[30;1m1984 | [0m[35m            *config*.[0m

[31m--[ [0m[34mMatch #[0m[33m916[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1975 | [0m[35m    changed_data = copy.deepcopy(data)[0m
[30;1m1976 | [0m[35m[0m
[30;1m1977 | [0m[35m    def set_path_value(config: Dict[str, Any], path: List[str], value: Any, prefix: Tuple[str, ...] [0m
[30;1m1978 | [0m[35m        """Recursively walk through *config* and update setting specified by *path* with *value*.[0m
[30;1m1979 | [0m[35m[0m
[30;1m1980 | [0m[35m        :param config: configuration data structure with all settings found under *prefix* path.[0m
[30;1m1981 | [0m[35m        :param path: dotted path split by dot as delimiter into a list. Used to control the recursiv[0m

[31m--[ [0m[34mMatch #[0m[33m917[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1765 | [0m[35m    :param dcs: DCS object from where to get fresh cluster information.[0m
[30;1m1766 | [0m[35m    :param paused: the desired state for ``pause`` in all nodes.[0m
[30;1m1767 | [0m[35m    :param old_cluster: original cluster information before pause or unpause has been requested. Use[0m
[30;1m1768 | [0m[35m        nodes are still pending to have ``pause`` equal *paused* at a given point in time.[0m
[30;1m1769 | [0m[35m    """[0m
[30;1m1770 | [0m[35m    config = global_config.from_cluster(old_cluster)[0m
[30;1m1771 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m918[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1473 | [0m[35mdef topology_sort(members: List[Dict[str, Any]]) -> Iterator[Dict[str, Any]]:[0m
[30;1m1474 | [0m[35m    """Sort *members* according to their level in the replication topology tree.[0m
[30;1m1475 | [0m[35m[0m
[30;1m1476 | [0m[35m    :param members: list of members in the cluster. Each item should contain at least these keys:[0m
[30;1m1477 | [0m[35m[0m
[30;1m1478 | [0m[35m        * ``name``: name of the node, according to ``name`` configuration;[0m
[30;1m1479 | [0m[35m        * ``role``: ``leader``, ``standby_leader`` or ``replica``.[0m

[31m--[ [0m[34mMatch #[0m[33m919[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1453 | [0m[35m        But may contain others, which although ignored by this function, will be yielded as part of [0m
[30;1m1454 | [0m[35m        object. The value of key ``name`` is changed as explained in the note.[0m
[30;1m1455 | [0m[35m[0m
[30;1m1456 | [0m[35m    :param topology: each key is the name of a node which has at least one replica attached to it. T[0m
[30;1m1457 | [0m[35m        value is a list of the attached replicas, each of them with the same structure described for[0m
[30;1m1458 | [0m[35m[0m
[30;1m1459 | [0m[35m    :yields: the current member with its name changed. Besides that reyield values from recursive ca[0m

[31m--[ [0m[34mMatch #[0m[33m920[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1446 | [0m[35m              + postgresql2[0m
[30;1m1447 | [0m[35m[0m
[30;1m1448 | [0m[35m    :param level: the current level being inspected in the *topology*.[0m
[30;1m1449 | [0m[35m    :param member: information about the current member being inspected in *level* of *topology*. Sh[0m
[30;1m1450 | [0m[35m        least this key:[0m
[30;1m1451 | [0m[35m        * ``name``: name of the node, according to ``name`` configuration;[0m
[30;1m1452 | [0m[35m[0m
[30;1m1453 | [0m[35m        But may contain others, which although ignored by this function, will be yielded as part of [0m

[31m--[ [0m[34mMatch #[0m[33m921[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1338 | [0m[35m        if scheduled_at_str:[0m
[30;1m1339 | [0m[35m            # only switchover can be scheduled[0m
[30;1m1340 | [0m[35m            if not click.confirm(f'Are you sure you want to schedule switchover of cluster '[0m
[30;1m1341 | [0m[35m                                 f'{cluster_name} at {scheduled_at_str}{demote_msg}?'):[0m
[30;1m1342 | [0m[35m                # action as a var to catch a regression in the tests[0m
[30;1m1343 | [0m[35m                raise PatroniCtlException('Aborting scheduled ' + action)[0m
[30;1m1344 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m922[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m735 | [0m[35m                                        'might be different from the ones showing pending restart ri[0m
[30;1m736 | [0m[35m                                        'Is this fine?')[0m
[30;1m737 | [0m[35m            else:[0m
[30;1m738 | [0m[35m                confirm = click.confirm('Are you sure you want to schedule {0} of members {1} at {2}[0m
[30;1m739 | [0m[35m                                        .format(action, ', '.join([m.name for m in members]), schedu[0m
[30;1m740 | [0m[35m            if not confirm:[0m
[30;1m741 | [0m[35m                raise PatroniCtlException('Aborted scheduled {0}'.format(action))[0m

[31m--[ [0m[34mMatch #[0m[33m923[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m731 | [0m[35m    if scheduled_at:[0m
[30;1m732 | [0m[35m        if not force:[0m
[30;1m733 | [0m[35m            if pending:[0m
[30;1m734 | [0m[35m                confirm = click.confirm('The nodes needing a restart will be identified at the sched[0m
[30;1m735 | [0m[35m                                        'might be different from the ones showing pending restart ri[0m
[30;1m736 | [0m[35m                                        'Is this fine?')[0m
[30;1m737 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m924[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m722 | [0m[35m        * ``restart``: restart PostgreSQL; or[0m
[30;1m723 | [0m[35m        * ``reinitialize``: reinitialize PostgreSQL data directory; or[0m
[30;1m724 | [0m[35m        * ``flush``: discard scheduled actions.[0m
[30;1m725 | [0m[35m    :param scheduled_at: timestamp at which the *action* should be scheduled to. If ``None``  *actio[0m
[30;1m726 | [0m[35m        immediately.[0m
[30;1m727 | [0m[35m[0m
[30;1m728 | [0m[35m    :raises:[0m

[31m--[ [0m[34mMatch #[0m[33m925[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m660 | [0m[35m        are applied based on names.[0m
[30;1m661 | [0m[35m    :param role: used to filter which members should take the *action* based on their role. See :fun[0m
[30;1m662 | [0m[35m        for available options.[0m
[30;1m663 | [0m[35m    :param force: if ``True``, then it won't ask for confirmations at any point nor prompt the user [0m
[30;1m664 | [0m[35m        for options that were not specified through the command-line.[0m
[30;1m665 | [0m[35m    :param action: the action that is being processed, one among:[0m
[30;1m666 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m926[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m609 | [0m[35m    from . import psycopg[0m
[30;1m610 | [0m[35m    conn = psycopg.connect(**params)[0m
[30;1m611 | [0m[35m    cursor = conn.cursor()[0m
[30;1m612 | [0m[35m    # If we want ``any`` node we are fine to return the cursor. ``None`` is similar to ``any`` at th[0m
[30;1m613 | [0m[35m    # been dealt with through :func:`get_any_member`.[0m
[30;1m614 | [0m[35m    # If we want the Patroni leader node, :func:`get_any_member` already checks that for us[0m
[30;1m615 | [0m[35m    if role in (None, 'any', 'leader'):[0m

[31m--[ [0m[34mMatch #[0m[33m927[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m462 | [0m[35m    :param w: if ``True`` and *watch* is ``None``, then *watch* assumes the value ``2``.[0m
[30;1m463 | [0m[35m    :param watch: amount of seconds to wait before yielding another value.[0m
[30;1m464 | [0m[35m    :param max_count: maximum number of yielded values. If ``None`` keep yielding values indefinitel[0m
[30;1m465 | [0m[35m    :param clear: if the screen should be cleared out at each iteration.[0m
[30;1m466 | [0m[35m[0m
[30;1m467 | [0m[35m    :yields: ``0`` each time *watch* seconds have passed.[0m
[30;1m468 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m928[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m283 | [0m[35myml']))[0m
[30;1m284 | [0m[35moption_watchrefresh = click.option('-w', '--watch', type=float, help='Auto update the screen every X[0m
[30;1m285 | [0m[35moption_watch = click.option('-W', is_flag=True, help='Auto update the screen every 2 seconds')[0m
[30;1m286 | [0m[35moption_force = click.option('--force', is_flag=True, help='Do not ask for confirmation at any point'[0m
[30;1m287 | [0m[35marg_cluster_name = click.argument('cluster_name', required=False,[0m
[30;1m288 | [0m[35m                                  default=lambda: _get_configuration().get('scope'))[0m
[30;1m289 | [0m[35moption_default_citus_group = click.option('--group', required=False, type=int, help='Citus group',[0m

[31m--[ [0m[34mMatch #[0m[33m929[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m282 | [0m[35m help='Output format', default='pretty',[0m
[30;1m283 | [0m[35m                             type=click.Choice(['pretty', 'tsv', 'json', 'yaml', 'yml']))[0m
[30;1m284 | [0m[35moption_watchrefresh = click.option('-w', '--watch', type=float, help='Auto update the screen every X[0m
[30;1m285 | [0m[35moption_watch = click.option('-W', is_flag=True, help='Auto update the screen every 2 seconds')[0m
[30;1m286 | [0m[35moption_force = click.option('--force', is_flag=True, help='Do not ask for confirmation at any point'[0m
[30;1m287 | [0m[35marg_cluster_name = click.argument('cluster_name', required=False,[0m
[30;1m288 | [0m[35m                                  default=lambda: _get_configuration().get('scope'))[0m

[31m--[ [0m[34mMatch #[0m[33m930[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35moption_format = click.option('--format', '-f', 'fmt', help='Output format', default='pretty',[0m
[30;1m283 | [0m[35m                             type=click.Choice(['pretty', 'tsv', 'json', 'yaml', 'yml']))[0m
[30;1m284 | [0m[35moption_watchrefresh = click.option('-w', '--watch', type=float, help='Auto update the screen every X[0m
[30;1m285 | [0m[35moption_watch = click.option('-W', is_flag=True, help='Auto update the screen every 2 seconds')[0m
[30;1m286 | [0m[35moption_force = click.option('--force', is_flag=True, help='Do not ask for confirmation at any point'[0m
[30;1m287 | [0m[35marg_cluster_name = click.argument('cluster_name', required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m931[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2224 | [0m[35m        * ``LSN``: Postgres LSN, in bytes, when the event occurred;[0m
[30;1m2225 | [0m[35m        * ``Reason``: the reason that motivated the event, if any;[0m
[30;1m2226 | [0m[35m        * ``Timestamp``: timestamp when the event occurred;[0m
[30;1m2227 | [0m[35m        * ``New Leader``: the Postgres node that was promoted during the event.[0m
[30;1m2228 | [0m[35m[0m
[30;1m2229 | [0m[35m    :param cluster_name: name of the Patroni cluster.[0m
[30;1m2230 | [0m[35m    :param group: filter which Citus group we should get events from. Refer to the module note for m[0m

[31m--[ [0m[34mMatch #[0m[33m932[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2101 | [0m[35m    :param cluster_name: name of the Patroni cluster.[0m
[30;1m2102 | [0m[35m    :param group: filter which Citus group configuration we should edit. Refer to the module note fo[0m
[30;1m2103 | [0m[35m    :param force: if ``True`` apply config changes without asking for confirmations.[0m
[30;1m2104 | [0m[35m    :param quiet: if ``True`` skip showing config diff in the console.[0m
[30;1m2105 | [0m[35m    :param kvpairs: list of key value general parameters to be changed.[0m
[30;1m2106 | [0m[35m    :param pgkvpairs: list of key value Postgres parameters to be changed.[0m
[30;1m2107 | [0m[35m    :param apply_filename: name of the file which contains with new configuration parameters to be a[0m

[31m--[ [0m[34mMatch #[0m[33m933[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2063 | [0m[35m                logging.debug('Setting fallback editor_cmd=%s', editor)[0m
[30;1m2064 | [0m[35m                break[0m
[30;1m2065 | [0m[35m    if not editor_cmd:[0m
[30;1m2066 | [0m[35m        raise PatroniCtlException('EDITOR environment variable is not set. editor or vi are not avai[0m
[30;1m2067 | [0m[35m[0m
[30;1m2068 | [0m[35m    safe_cluster_name = cluster_name.replace("/", "_")[0m
[30;1m2069 | [0m[35m    with temporary_file(contents=before_editing.encode('utf-8'),[0m

[31m--[ [0m[34mMatch #[0m[33m934[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1991 | [0m[35m            path = ['.'.join(path)][0m
[30;1m1992 | [0m[35m[0m
[30;1m1993 | [0m[35m        key = path[0][0m
[30;1m1994 | [0m[35m        # When *path* contains a single item it means we reached a leaf node in the configuration, s[0m
[30;1m1995 | [0m[35m        # update the configuration based on what has been requested by the user.[0m
[30;1m1996 | [0m[35m        if len(path) == 1:[0m
[30;1m1997 | [0m[35m            if value is None:[0m

[31m--[ [0m[34mMatch #[0m[33m935[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1979 | [0m[35m[0m
[30;1m1980 | [0m[35m        :param config: configuration data structure with all settings found under *prefix* path.[0m
[30;1m1981 | [0m[35m        :param path: dotted path split by dot as delimiter into a list. Used to control the recursiv[0m
[30;1m1982 | [0m[35m            when a leaf node is reached.[0m
[30;1m1983 | [0m[35m        :param value: value for configuration described by *path*. If ``None`` the configuration key[0m
[30;1m1984 | [0m[35m            *config*.[0m
[30;1m1985 | [0m[35m        :param prefix: previous parts of *path* that have already been opened by parent recursive ca[0m

[31m--[ [0m[34mMatch #[0m[33m936[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1898 | [0m[35m    :param after_editing: string to be compared with *before_editing*.[0m
[30;1m1899 | [0m[35m[0m
[30;1m1900 | [0m[35m    :raises:[0m
[30;1m1901 | [0m[35m        :class:`PatroniCtlException`: if no suitable pager can be found when printing diff output to[0m
[30;1m1902 | [0m[35m    """[0m
[30;1m1903 | [0m[35m    def listify(string: str) -> List[str]:[0m
[30;1m1904 | [0m[35m        return [line + '\n' for line in string.rstrip('\n').split('\n')][0m

[31m--[ [0m[34mMatch #[0m[33m937[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1886 | [0m[35m[0m
[30;1m1887 | [0m[35m    Inputs are expected to be unicode strings.[0m
[30;1m1888 | [0m[35m[0m
[30;1m1889 | [0m[35m    If the output is to a tty the diff will be colored.[0m
[30;1m1890 | [0m[35m[0m
[30;1m1891 | [0m[35m    .. note::[0m
[30;1m1892 | [0m[35m        If tty it requires a pager program, and uses first found among:[0m

[31m--[ [0m[34mMatch #[0m[33m938[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1882 | [0m[35m[0m
[30;1m1883 | [0m[35m[0m
[30;1m1884 | [0m[35mdef show_diff(before_editing: str, after_editing: str) -> None:[0m
[30;1m1885 | [0m[35m    """Show a diff between two strings.[0m
[30;1m1886 | [0m[35m[0m
[30;1m1887 | [0m[35m    Inputs are expected to be unicode strings.[0m
[30;1m1888 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m939[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1826 | [0m[35m                       paused and 'pause' or 'resume', r.status, r.data.decode('utf-8')))[0m
[30;1m1827 | [0m[35m        break[0m
[30;1m1828 | [0m[35m    else:[0m
[30;1m1829 | [0m[35m        raise PatroniCtlException('Can not find accessible cluster member')[0m
[30;1m1830 | [0m[35m[0m
[30;1m1831 | [0m[35m[0m
[30;1m1832 | [0m[35m@ctl.command('pause', help='Disable auto failover')[0m

[31m--[ [0m[34mMatch #[0m[33m940[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1755 | [0m[35m                logging.warning('Member %s is not accessible', member.name)[0m
[30;1m1756 | [0m[35m[0m
[30;1m1757 | [0m[35m        logging.warning('Failing over to DCS')[0m
[30;1m1758 | [0m[35m        click.echo('{0} Could not find any accessible member of cluster {1}'.format(timestamp(), clu[0m
[30;1m1759 | [0m[35m        dcs.manual_failover('', '', version=failover.version)[0m
[30;1m1760 | [0m[35m[0m
[30;1m1761 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m941[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1622 | [0m[35m    title = f' {title}: {name}{title_details} '[0m
[30;1m1623 | [0m[35m    print_output(columns, rows, {'Group': 'r', 'Lag in MB': 'r', 'TL': 'r'}, fmt, title)[0m
[30;1m1624 | [0m[35m[0m
[30;1m1625 | [0m[35m    if fmt not in ('pretty', 'topology'):  # Omit service info when using machine-readable formats[0m
[30;1m1626 | [0m[35m        return[0m
[30;1m1627 | [0m[35m[0m
[30;1m1628 | [0m[35m    for g, c in sorted(clusters.items()):[0m

[31m--[ [0m[34mMatch #[0m[33m942[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1622 | [0m[35m    title = f' {title}: {name}{title_details} '[0m
[30;1m1623 | [0m[35m    print_output(columns, rows, {'Group': 'r', 'Lag in MB': 'r', 'TL': 'r'}, fmt, title)[0m
[30;1m1624 | [0m[35m[0m
[30;1m1625 | [0m[35m    if fmt not in ('pretty', 'topology'):  # Omit service info when using machine-readable formats[0m
[30;1m1626 | [0m[35m        return[0m
[30;1m1627 | [0m[35m[0m
[30;1m1628 | [0m[35m    for g, c in sorted(clusters.items()):[0m

[31m--[ [0m[34mMatch #[0m[33m943[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1591 | [0m[35m            def format_diff(param: str, values: Dict[str, str], hide_long: bool):[0m
[30;1m1592 | [0m[35m                full_diff = param + ': ' + values['old_value'] + '->' + values['new_value'][0m
[30;1m1593 | [0m[35m                return full_diff if not hide_long or len(full_diff) <= 50 else param + ': [hidden - [0m
[30;1m1594 | [0m[35m            restart_reason = '\n'.join([format_diff(k, v, fmt in ('pretty', 'topology'))[0m
[30;1m1595 | [0m[35m                                        for k, v in member.get('pending_restart_reason', {}).items()[0m
[30;1m1596 | [0m[35m[0m
[30;1m1597 | [0m[35m            member.update(cluster=name, member=member['name'], group=g,[0m

[31m--[ [0m[34mMatch #[0m[33m944[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1581 | [0m[35m    append_port = any('port' in m and m['port'] != 5432 for m in all_members) or\[0m
[30;1m1582 | [0m[35m        len(set(m['host'] for m in all_members)) < len(all_members)[0m
[30;1m1583 | [0m[35m[0m
[30;1m1584 | [0m[35m    sort = topology_sort if fmt == 'topology' else iter[0m
[30;1m1585 | [0m[35m    for g, c in sorted(clusters.items()):[0m
[30;1m1586 | [0m[35m        for member in sort(c['members']):[0m
[30;1m1587 | [0m[35m            logging.debug(member)[0m

[31m--[ [0m[34mMatch #[0m[33m945[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1581 | [0m[35m    append_port = any('port' in m and m['port'] != 5432 for m in all_members) or\[0m
[30;1m1582 | [0m[35m        len(set(m['host'] for m in all_members)) < len(all_members)[0m
[30;1m1583 | [0m[35m[0m
[30;1m1584 | [0m[35m    sort = topology_sort if fmt == 'topology' else iter[0m
[30;1m1585 | [0m[35m    for g, c in sorted(clusters.items()):[0m
[30;1m1586 | [0m[35m        for member in sort(c['members']):[0m
[30;1m1587 | [0m[35m            logging.debug(member)[0m

[31m--[ [0m[34mMatch #[0m[33m946[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1551 | [0m[35m[0m
[30;1m1552 | [0m[35m    :param cluster: Patroni cluster.[0m
[30;1m1553 | [0m[35m    :param name: name of the Patroni cluster.[0m
[30;1m1554 | [0m[35m    :param extended: if extended information (pending restarts, scheduled restarts, node tags) shoul[0m
[30;1m1555 | [0m[35m        available.[0m
[30;1m1556 | [0m[35m    :param fmt: the output table printing format. See :func:`print_output` for available options. If[0m
[30;1m1557 | [0m[35m        ``topology`` nor ``pretty``, then complementary information gathered through :func:`get_clus[0m

[31m--[ [0m[34mMatch #[0m[33m947[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1544 | [0m[35m        * ``Group``: Citus group ID -- showed only if Citus is enabled.[0m
[30;1m1545 | [0m[35m        * ``Pending restart``: if the node is pending a restart -- showed only if *extended*;[0m
[30;1m1546 | [0m[35m        * ``Scheduled restart``: timestamp for scheduled restart, if any -- showed only if *extended[0m
[30;1m1547 | [0m[35m        * ``Tags``: node tags, if any -- showed only if *extended*.[0m
[30;1m1548 | [0m[35m[0m
[30;1m1549 | [0m[35m    The 3 extended columns are always included if *extended*, even if the member has no value for a [0m
[30;1m1550 | [0m[35m    If not *extended*, these columns may still be shown if any of the members has any information fo[0m

[31m--[ [0m[34mMatch #[0m[33m948[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1542 | [0m[35m[0m
[30;1m1543 | [0m[35m    Besides that it may also have:[0m
[30;1m1544 | [0m[35m        * ``Group``: Citus group ID -- showed only if Citus is enabled.[0m
[30;1m1545 | [0m[35m        * ``Pending restart``: if the node is pending a restart -- showed only if *extended*;[0m
[30;1m1546 | [0m[35m        * ``Scheduled restart``: timestamp for scheduled restart, if any -- showed only if *extended[0m
[30;1m1547 | [0m[35m        * ``Tags``: node tags, if any -- showed only if *extended*.[0m
[30;1m1548 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m949[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1453 | [0m[35m        But may contain others, which although ignored by this function, will be yielded as part of [0m
[30;1m1454 | [0m[35m        object. The value of key ``name`` is changed as explained in the note.[0m
[30;1m1455 | [0m[35m[0m
[30;1m1456 | [0m[35m    :param topology: each key is the name of a node which has at least one replica attached to it. T[0m
[30;1m1457 | [0m[35m        value is a list of the attached replicas, each of them with the same structure described for[0m
[30;1m1458 | [0m[35m[0m
[30;1m1459 | [0m[35m    :yields: the current member with its name changed. Besides that reyield values from recursive ca[0m

[31m--[ [0m[34mMatch #[0m[33m950[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1306 | [0m[35m            config.is_synchronous_mode,[0m
[30;1m1307 | [0m[35m            not cluster.sync.is_empty,[0m
[30;1m1308 | [0m[35m            not cluster.sync.matches(candidate, True))):[0m
[30;1m1309 | [0m[35m        if not click.confirm(f'Are you sure you want to failover to the asynchronous node {candidate[0m
[30;1m1310 | [0m[35m            raise PatroniCtlException('Aborting ' + action)[0m
[30;1m1311 | [0m[35m[0m
[30;1m1312 | [0m[35m    scheduled_at_str = None[0m

[31m--[ [0m[34mMatch #[0m[33m951[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1282 | [0m[35m[0m
[30;1m1283 | [0m[35m    # excluding members with nofailover tag[0m
[30;1m1284 | [0m[35m    candidate_names = [str(m.name) for m in cluster.members if m.name != cluster_leader and not m.no[0m
[30;1m1285 | [0m[35m    # We sort the names for consistent output to the client[0m
[30;1m1286 | [0m[35m    candidate_names.sort()[0m
[30;1m1287 | [0m[35m[0m
[30;1m1288 | [0m[35m    if not candidate_names:[0m

[31m--[ [0m[34mMatch #[0m[33m952[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1142 | [0m[35m        content['schedule'] = scheduled_at.isoformat()[0m
[30;1m1143 | [0m[35m[0m
[30;1m1144 | [0m[35m    if timeout is not None:[0m
[30;1m1145 | [0m[35m        content['timeout'] = timeout[0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m    for member in members:[0m
[30;1m1148 | [0m[35m        if 'schedule' in content:[0m
[30;1m1149 | [0m[35m            if force and member.data.get('scheduled_restart'):[0m

[31m--[ [0m[34mMatch #[0m[33m953[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1141 | [0m[35m            raise PatroniCtlException("Can't schedule restart in the paused state")[0m
[30;1m1142 | [0m[35m        content['schedule'] = scheduled_at.isoformat()[0m
[30;1m1143 | [0m[35m[0m
[30;1m1144 | [0m[35m    if timeout is not None:[0m
[30;1m1145 | [0m[35m        content['timeout'] = timeout[0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m    for member in members:[0m

[31m--[ [0m[34mMatch #[0m[33m954[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1092 | [0m[35m    :param scheduled: timestamp when the restart should be scheduled to occur. If ``now`` restart im[0m
[30;1m1093 | [0m[35m    :param version: restart only members which Postgres version is less than *version*.[0m
[30;1m1094 | [0m[35m    :param pending: restart only members that are flagged as ``pending restart``.[0m
[30;1m1095 | [0m[35m    :param timeout: timeout for the restart operation. If timeout is reached a failover may occur in[0m
[30;1m1096 | [0m[35m[0m
[30;1m1097 | [0m[35m    :raises:[0m
[30;1m1098 | [0m[35m        :class:`PatroniCtlException`: if:[0m

[31m--[ [0m[34mMatch #[0m[33m955[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1092 | [0m[35m    :param scheduled: timestamp when the restart should be scheduled to occur. If ``now`` restart im[0m
[30;1m1093 | [0m[35m    :param version: restart only members which Postgres version is less than *version*.[0m
[30;1m1094 | [0m[35m    :param pending: restart only members that are flagged as ``pending restart``.[0m
[30;1m1095 | [0m[35m    :param timeout: timeout for the restart operation. If timeout is reached a failover may occur in[0m
[30;1m1096 | [0m[35m[0m
[30;1m1097 | [0m[35m    :raises:[0m
[30;1m1098 | [0m[35m        :class:`PatroniCtlException`: if:[0m

[31m--[ [0m[34mMatch #[0m[33m956[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m775 | [0m[35m    cluster = get_dcs(cluster_name, group).get_cluster()[0m
[30;1m776 | [0m[35m    m = get_any_member(cluster, group, role=role, member=member)[0m
[30;1m777 | [0m[35m    if m is None:[0m
[30;1m778 | [0m[35m        raise PatroniCtlException('Can not find a suitable member')[0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m    params = m.conn_kwargs()[0m
[30;1m781 | [0m[35m    click.echo('host={host} port={port}'.format(**params))[0m

[31m--[ [0m[34mMatch #[0m[33m957[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m609 | [0m[35m    from . import psycopg[0m
[30;1m610 | [0m[35m    conn = psycopg.connect(**params)[0m
[30;1m611 | [0m[35m    cursor = conn.cursor()[0m
[30;1m612 | [0m[35m    # If we want ``any`` node we are fine to return the cursor. ``None`` is similar to ``any`` at th[0m
[30;1m613 | [0m[35m    # been dealt with through :func:`get_any_member`.[0m
[30;1m614 | [0m[35m    # If we want the Patroni leader node, :func:`get_any_member` already checks that for us[0m
[30;1m615 | [0m[35m    if role in (None, 'any', 'leader'):[0m

[31m--[ [0m[34mMatch #[0m[33m958[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m504 | [0m[35m        * ``replica`` or ``standby``: a standby PostgreSQL instance;[0m
[30;1m505 | [0m[35m        * ``leader``: the leader of a Patroni cluster. Can also be used to get the leader of a Patro[0m
[30;1m506 | [0m[35m        * ``standby-leader``: the leader of a Patroni standby cluster;[0m
[30;1m507 | [0m[35m        * ``any``: matches any node independent of its role.[0m
[30;1m508 | [0m[35m[0m
[30;1m509 | [0m[35m    :yields: members that have the given *role*.[0m
[30;1m510 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m959[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m485 | [0m[35m        return[0m
[30;1m486 | [0m[35m[0m
[30;1m487 | [0m[35m    counter = 1[0m
[30;1m488 | [0m[35m    while watch and counter <= (max_count or counter):[0m
[30;1m489 | [0m[35m        time.sleep(watch)[0m
[30;1m490 | [0m[35m        counter += 1[0m
[30;1m491 | [0m[35m        if clear:[0m

[31m--[ [0m[34mMatch #[0m[33m960[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m477 | [0m[35m    """[0m
[30;1m478 | [0m[35m    if w and not watch:[0m
[30;1m479 | [0m[35m        watch = 2[0m
[30;1m480 | [0m[35m    if watch and clear:[0m
[30;1m481 | [0m[35m        click.clear()[0m
[30;1m482 | [0m[35m    yield 0[0m
[30;1m483 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m961[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m476 | [0m[35m        1[0m
[30;1m477 | [0m[35m    """[0m
[30;1m478 | [0m[35m    if w and not watch:[0m
[30;1m479 | [0m[35m        watch = 2[0m
[30;1m480 | [0m[35m    if watch and clear:[0m
[30;1m481 | [0m[35m        click.clear()[0m
[30;1m482 | [0m[35m    yield 0[0m

[31m--[ [0m[34mMatch #[0m[33m962[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m464 | [0m[35m    :param max_count: maximum number of yielded values. If ``None`` keep yielding values indefinitel[0m
[30;1m465 | [0m[35m    :param clear: if the screen should be cleared out at each iteration.[0m
[30;1m466 | [0m[35m[0m
[30;1m467 | [0m[35m    :yields: ``0`` each time *watch* seconds have passed.[0m
[30;1m468 | [0m[35m[0m
[30;1m469 | [0m[35m    :Example:[0m
[30;1m470 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m963[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m    :param w: if ``True`` and *watch* is ``None``, then *watch* assumes the value ``2``.[0m
[30;1m463 | [0m[35m    :param watch: amount of seconds to wait before yielding another value.[0m
[30;1m464 | [0m[35m    :param max_count: maximum number of yielded values. If ``None`` keep yielding values indefinitel[0m
[30;1m465 | [0m[35m    :param clear: if the screen should be cleared out at each iteration.[0m
[30;1m466 | [0m[35m[0m
[30;1m467 | [0m[35m    :yields: ``0`` each time *watch* seconds have passed.[0m
[30;1m468 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m964[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m437 | [0m[35m            rows = [row[skip_cols:] for row in rows][0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m        # In ``tsv`` format print cluster name in every row as the first column[0m
[30;1m440 | [0m[35m        if fmt == 'tsv':[0m
[30;1m441 | [0m[35m            for r in ([columns] if columns else []) + rows:[0m
[30;1m442 | [0m[35m                click.echo(delimiter.join(map(str, r)))[0m
[30;1m443 | [0m[35m        # In ``pretty`` and ``topology`` formats print the cluster name only once, in the very first[0m

[31m--[ [0m[34mMatch #[0m[33m965[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m431 | [0m[35m                    # Member tags are printed in YAML block format if *fmt* is ``pretty``. If *fmt* [0m
[30;1m432 | [0m[35m                    # or ``topology``, then write in the YAML flow format, which is similar to JSON[0m
[30;1m433 | [0m[35m                    row[i] = format_config_for_editing(row[i], fmt != 'pretty').strip()[0m
[30;1m434 | [0m[35m        if list_cluster and header and fmt != 'tsv':  # skip cluster name and maybe Citus group if p[0m
[30;1m435 | [0m[35m            skip_cols = 2 if ' (group: ' in header else 1[0m
[30;1m436 | [0m[35m            columns = columns[skip_cols:] if columns else [][0m
[30;1m437 | [0m[35m            rows = [row[skip_cols:] for row in rows][0m

[31m--[ [0m[34mMatch #[0m[33m966[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m430 | [0m[35m                if row[i]:[0m
[30;1m431 | [0m[35m                    # Member tags are printed in YAML block format if *fmt* is ``pretty``. If *fmt* [0m
[30;1m432 | [0m[35m                    # or ``topology``, then write in the YAML flow format, which is similar to JSON[0m
[30;1m433 | [0m[35m                    row[i] = format_config_for_editing(row[i], fmt != 'pretty').strip()[0m
[30;1m434 | [0m[35m        if list_cluster and header and fmt != 'tsv':  # skip cluster name and maybe Citus group if p[0m
[30;1m435 | [0m[35m            skip_cols = 2 if ' (group: ' in header else 1[0m
[30;1m436 | [0m[35m            columns = columns[skip_cols:] if columns else [][0m

[31m--[ [0m[34mMatch #[0m[33m967[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m422 | [0m[35m        elements = [{k: v for k, v in zip(columns or [], r) if not header or str(v)} for r in rows][0m
[30;1m423 | [0m[35m        func = json.dumps if fmt == 'json' else format_config_for_editing[0m
[30;1m424 | [0m[35m        click.echo(func(elements))[0m
[30;1m425 | [0m[35m    elif fmt in {'pretty', 'tsv', 'topology'}:[0m
[30;1m426 | [0m[35m        list_cluster = bool(header and columns and columns[0] == 'Cluster')[0m
[30;1m427 | [0m[35m        if list_cluster and columns and 'Tags' in columns:  # we want to format member tags as YAML[0m
[30;1m428 | [0m[35m            i = columns.index('Tags')[0m

[31m--[ [0m[34mMatch #[0m[33m968[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m420 | [0m[35m    """[0m
[30;1m421 | [0m[35m    if fmt in {'json', 'yaml', 'yml'}:[0m
[30;1m422 | [0m[35m        elements = [{k: v for k, v in zip(columns or [], r) if not header or str(v)} for r in rows][0m
[30;1m423 | [0m[35m        func = json.dumps if fmt == 'json' else format_config_for_editing[0m
[30;1m424 | [0m[35m        click.echo(func(elements))[0m
[30;1m425 | [0m[35m    elif fmt in {'pretty', 'tsv', 'topology'}:[0m
[30;1m426 | [0m[35m        list_cluster = bool(header and columns and columns[0] == 'Cluster')[0m

[31m--[ [0m[34mMatch #[0m[33m969[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m418 | [0m[35m        apply when *fmt* is either ``pretty`` or ``topology``.[0m
[30;1m419 | [0m[35m    :param delimiter: the character to be used as delimiter when *fmt* is ``tsv``.[0m
[30;1m420 | [0m[35m    """[0m
[30;1m421 | [0m[35m    if fmt in {'json', 'yaml', 'yml'}:[0m
[30;1m422 | [0m[35m        elements = [{k: v for k, v in zip(columns or [], r) if not header or str(v)} for r in rows][0m
[30;1m423 | [0m[35m        func = json.dumps if fmt == 'json' else format_config_for_editing[0m
[30;1m424 | [0m[35m        click.echo(func(elements))[0m

[31m--[ [0m[34mMatch #[0m[33m970[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m282 | [0m[35mut format', default='pretty',[0m
[30;1m283 | [0m[35m                             type=click.Choice(['pretty', 'tsv', 'json', 'yaml', 'yml']))[0m
[30;1m284 | [0m[35moption_watchrefresh = click.option('-w', '--watch', type=float, help='Auto update the screen every X[0m
[30;1m285 | [0m[35moption_watch = click.option('-W', is_flag=True, help='Auto update the screen every 2 seconds')[0m
[30;1m286 | [0m[35moption_force = click.option('--force', is_flag=True, help='Do not ask for confirmation at any point'[0m
[30;1m287 | [0m[35marg_cluster_name = click.argument('cluster_name', required=False,[0m
[30;1m288 | [0m[35m                                  default=lambda: _get_configuration().get('scope'))[0m

[31m--[ [0m[34mMatch #[0m[33m971[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35moption_format = click.option('--format', '-f', 'fmt', help='Output format', default='pretty',[0m
[30;1m283 | [0m[35m                             type=click.Choice(['pretty', 'tsv', 'json', 'yaml', 'yml']))[0m
[30;1m284 | [0m[35moption_watchrefresh = click.option('-w', '--watch', type=float, help='Auto update the screen every X[0m
[30;1m285 | [0m[35moption_watch = click.option('-W', is_flag=True, help='Auto update the screen every 2 seconds')[0m
[30;1m286 | [0m[35moption_force = click.option('--force', is_flag=True, help='Do not ask for confirmation at any point'[0m
[30;1m287 | [0m[35marg_cluster_name = click.argument('cluster_name', required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m972[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m        """[0m
[30;1m169 | [0m[35m        ret = self.__hline[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        # Inject nice table header[0m
[30;1m172 | [0m[35m        if self._is_first_hline() and self.__table_header:[0m
[30;1m173 | [0m[35m            ret = self.__build_header(ret)[0m
[30;1m174 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m973[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m    + Cluster: batman --------+--------+---------+----+-----------+[0m
[30;1m97 | [0m[35m    ```[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    Instead of the default header line which would contain only dash and plus characters.[0m
[30;1m100 | [0m[35m    """[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    def __init__(self, header: str, *args: Any, **kwargs: Any) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m974[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35mimport subprocess[0m
[30;1m26 | [0m[35mimport sys[0m
[30;1m27 | [0m[35mimport tempfile[0m
[30;1m28 | [0m[35mimport time[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mfrom collections import defaultdict[0m
[30;1m31 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m32 | [0m[35mfrom typing import Any, Dict, Iterator, List, Optional, Tuple, TYPE_CHECKING, Union[0m

[31m--[ [0m[34mMatch #[0m[33m975[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1785 | [0m[35m        # This method is always called with ``optime`` key, rest of the keys are optional.[0m
[30;1m1786 | [0m[35m        # In case if we know old values (stored in self._last_status), we will copy them over.[0m
[30;1m1787 | [0m[35m        for name in ('slots', 'retain_slots'):[0m
[30;1m1788 | [0m[35m            if name not in value and self._last_status.get(name):[0m
[30;1m1789 | [0m[35m                value[name] = self._last_status[name][0m
[30;1m1790 | [0m[35m        # if the key is present, but the value is None, we will not write such pair.[0m
[30;1m1791 | [0m[35m        value = {k: v for k, v in value.items() if v is not None}[0m

[31m--[ [0m[34mMatch #[0m[33m976[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1489 | [0m[35m        self._base_path = re.sub('/+', '/', '/'.join(['', config.get('namespace', 'service'), config[0m
[30;1m1490 | [0m[35m        self._set_loop_wait(config.get('loop_wait', 10))[0m
[30;1m1491 | [0m[35m[0m
[30;1m1492 | [0m[35m        self._ctl = bool(config.get('patronictl', False))[0m
[30;1m1493 | [0m[35m        self._cluster: Optional[Cluster] = None[0m
[30;1m1494 | [0m[35m        self._cluster_valid_till: float = 0[0m
[30;1m1495 | [0m[35m        self._cluster_thread_lock = Lock()[0m

[31m--[ [0m[34mMatch #[0m[33m977[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1487 | [0m[35m        self._mpp = mpp[0m
[30;1m1488 | [0m[35m        self._name = config['name'][0m
[30;1m1489 | [0m[35m        self._base_path = re.sub('/+', '/', '/'.join(['', config.get('namespace', 'service'), config[0m
[30;1m1490 | [0m[35m        self._set_loop_wait(config.get('loop_wait', 10))[0m
[30;1m1491 | [0m[35m[0m
[30;1m1492 | [0m[35m        self._ctl = bool(config.get('patronictl', False))[0m
[30;1m1493 | [0m[35m        self._cluster: Optional[Cluster] = None[0m

[31m--[ [0m[34mMatch #[0m[33m978[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1486 | [0m[35m        """[0m
[30;1m1487 | [0m[35m        self._mpp = mpp[0m
[30;1m1488 | [0m[35m        self._name = config['name'][0m
[30;1m1489 | [0m[35m        self._base_path = re.sub('/+', '/', '/'.join(['', config.get('namespace', 'service'), config[0m
[30;1m1490 | [0m[35m        self._set_loop_wait(config.get('loop_wait', 10))[0m
[30;1m1491 | [0m[35m[0m
[30;1m1492 | [0m[35m        self._ctl = bool(config.get('patronictl', False))[0m

[31m--[ [0m[34mMatch #[0m[33m979[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1276 | [0m[35m        :returns: ``True`` if any detected replications slots are ``logical``, otherwise ``False``.[0m
[30;1m1277 | [0m[35m        """[0m
[30;1m1278 | [0m[35m        slots = self.get_replication_slots(postgresql, member, role='replica').values()[0m
[30;1m1279 | [0m[35m        return any(v for v in slots if v.get("type") == "logical")[0m
[30;1m1280 | [0m[35m[0m
[30;1m1281 | [0m[35m    def should_enforce_hot_standby_feedback(self, postgresql: 'Postgresql', member: Tags) -> bool:[0m
[30;1m1282 | [0m[35m        """Determine whether ``hot_standby_feedback`` should be enabled for the given member.[0m

[31m--[ [0m[34mMatch #[0m[33m980[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1205 | [0m[35m        ret: Dict[str, Dict[str, Any]] = {}[0m
[30;1m1206 | [0m[35m        for member in members:[0m
[30;1m1207 | [0m[35m            slot_name = slot_name_from_member_name(member.name)[0m
[30;1m1208 | [0m[35m            lsn = slots.get(slot_name, 0)[0m
[30;1m1209 | [0m[35m            if member.replicatefrom or leader_patroni_version and leader_patroni_version < (4, 0, 0)[0m
[30;1m1210 | [0m[35m                # `/status` key is maintained by the leader, but `member` may be connected to some o[0m
[30;1m1211 | [0m[35m                # In that case, the slot in the leader is inactive and doesn't advance, so we use th[0m

[31m--[ [0m[34mMatch #[0m[33m981[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1080 | [0m[35m                        # case we should have the following: A(B: active, C: inactive) <- B (C: acti[0m
[30;1m1081 | [0m[35m                        # We don't consider the same situation on node B, because if node C doesn't [0m
[30;1m1082 | [0m[35m                        # be able to know its `replicatefrom` tag value.[0m
[30;1m1083 | [0m[35m                        expected_active = not topology.get(slot_name) and role in ('primary', 'stand[0m
[30;1m1084 | [0m[35m                        slots[slot_name] = {**value, 'expected_active': expected_active}[0m
[30;1m1085 | [0m[35m                    continue[0m
[30;1m1086 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m982[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1070 | [0m[35m            if isinstance(tmp, dict):[0m
[30;1m1071 | [0m[35m                value = cast(Dict[str, Any], tmp)[0m
[30;1m1072 | [0m[35m                if 'type' not in value:[0m
[30;1m1073 | [0m[35m                    value['type'] = 'logical' if value.get('database') and value.get('plugin') else [0m
[30;1m1074 | [0m[35m[0m
[30;1m1075 | [0m[35m                if value['type'] == 'physical':[0m
[30;1m1076 | [0m[35m                    # Don't try to create permanent physical replication slot for yourself[0m

[31m--[ [0m[34mMatch #[0m[33m983[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1070 | [0m[35m            if isinstance(tmp, dict):[0m
[30;1m1071 | [0m[35m                value = cast(Dict[str, Any], tmp)[0m
[30;1m1072 | [0m[35m                if 'type' not in value:[0m
[30;1m1073 | [0m[35m                    value['type'] = 'logical' if value.get('database') and value.get('plugin') else [0m
[30;1m1074 | [0m[35m[0m
[30;1m1075 | [0m[35m                if value['type'] == 'physical':[0m
[30;1m1076 | [0m[35m                    # Don't try to create permanent physical replication slot for yourself[0m

[31m--[ [0m[34mMatch #[0m[33m984[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m987 | [0m[35m                # For permanent physical slots we want to get MAX LSN from the `Cluster.slots` and f[0m
[30;1m988 | [0m[35m                # member that does cascading replication with the matching name (see `replicatefrom`[0m
[30;1m989 | [0m[35m                # It is necessary because we may have the permanent replication slot on the primary [0m
[30;1m990 | [0m[35m                lsn = max(members.get(name, 0) if self.is_physical_slot(value) else 0, slots.get(nam[0m
[30;1m991 | [0m[35m                if lsn:[0m
[30;1m992 | [0m[35m                    value['lsn'] = lsn[0m
[30;1m993 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m985[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m987 | [0m[35m                # For permanent physical slots we want to get MAX LSN from the `Cluster.slots` and f[0m
[30;1m988 | [0m[35m                # member that does cascading replication with the matching name (see `replicatefrom`[0m
[30;1m989 | [0m[35m                # It is necessary because we may have the permanent replication slot on the primary [0m
[30;1m990 | [0m[35m                lsn = max(members.get(name, 0) if self.is_physical_slot(value) else 0, slots.get(nam[0m
[30;1m991 | [0m[35m                if lsn:[0m
[30;1m992 | [0m[35m                    value['lsn'] = lsn[0m
[30;1m993 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m986[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m970 | [0m[35m        """[0m
[30;1m971 | [0m[35m        return isinstance(value, dict) \[0m
[30;1m972 | [0m[35m            and cast(Dict[str, Any], value).get('type', 'logical') == 'logical' \[0m
[30;1m973 | [0m[35m            and bool(cast(Dict[str, Any], value).get('database') and cast(Dict[str, Any], value).get[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m    @property[0m
[30;1m976 | [0m[35m    def __permanent_slots(self) -> Dict[str, Union[Dict[str, Any], Any]]:[0m

[31m--[ [0m[34mMatch #[0m[33m987[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m970 | [0m[35m        """[0m
[30;1m971 | [0m[35m        return isinstance(value, dict) \[0m
[30;1m972 | [0m[35m            and cast(Dict[str, Any], value).get('type', 'logical') == 'logical' \[0m
[30;1m973 | [0m[35m            and bool(cast(Dict[str, Any], value).get('database') and cast(Dict[str, Any], value).get[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m    @property[0m
[30;1m976 | [0m[35m    def __permanent_slots(self) -> Dict[str, Union[Dict[str, Any], Any]]:[0m

[31m--[ [0m[34mMatch #[0m[33m988[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m969 | [0m[35m        :returns: ``True`` if *value* is a logical replication slot, otherwise ``False``.[0m
[30;1m970 | [0m[35m        """[0m
[30;1m971 | [0m[35m        return isinstance(value, dict) \[0m
[30;1m972 | [0m[35m            and cast(Dict[str, Any], value).get('type', 'logical') == 'logical' \[0m
[30;1m973 | [0m[35m            and bool(cast(Dict[str, Any], value).get('database') and cast(Dict[str, Any], value).get[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m989[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m958 | [0m[35m        """[0m
[30;1m959 | [0m[35m        return not value \[0m
[30;1m960 | [0m[35m            or (isinstance(value, dict) and not Cluster.is_logical_slot(cast(Dict[str, Any], value))[0m
[30;1m961 | [0m[35m                and cast(Dict[str, Any], value).get('type', 'physical') == 'physical')[0m
[30;1m962 | [0m[35m[0m
[30;1m963 | [0m[35m    @staticmethod[0m
[30;1m964 | [0m[35m    def is_logical_slot(value: Any) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m990[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m806 | [0m[35m        if not isinstance(slots, dict):[0m
[30;1m807 | [0m[35m            slots = None[0m
[30;1m808 | [0m[35m[0m
[30;1m809 | [0m[35m        retain_slots: Union[str, List[str], None] = value.get('retain_slots')[0m
[30;1m810 | [0m[35m        if isinstance(retain_slots, str):[0m
[30;1m811 | [0m[35m            try:[0m
[30;1m812 | [0m[35m                retain_slots = json.loads(retain_slots)[0m

[31m--[ [0m[34mMatch #[0m[33m991[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m797 | [0m[35m        except Exception:[0m
[30;1m798 | [0m[35m            last_lsn = 0[0m
[30;1m799 | [0m[35m[0m
[30;1m800 | [0m[35m        slots: Union[str, Dict[str, int], None] = value.get('slots')[0m
[30;1m801 | [0m[35m        if isinstance(slots, str):[0m
[30;1m802 | [0m[35m            try:[0m
[30;1m803 | [0m[35m                slots = json.loads(slots)[0m

[31m--[ [0m[34mMatch #[0m[33m992[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m793 | [0m[35m            return Status.empty()[0m
[30;1m794 | [0m[35m[0m
[30;1m795 | [0m[35m        try:[0m
[30;1m796 | [0m[35m            last_lsn = int(value.get('optime', ''))[0m
[30;1m797 | [0m[35m        except Exception:[0m
[30;1m798 | [0m[35m            last_lsn = 0[0m
[30;1m799 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m993[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m606 | [0m[35m            assert isinstance(value, dict)[0m
[30;1m607 | [0m[35m            leader = value.get('leader')[0m
[30;1m608 | [0m[35m            quorum = value.get('quorum')[0m
[30;1m609 | [0m[35m            return SyncState(version, leader, value.get('sync_standby'), int(quorum) if leader and q[0m
[30;1m610 | [0m[35m        except (AssertionError, TypeError, ValueError):[0m
[30;1m611 | [0m[35m            return SyncState.empty(version)[0m
[30;1m612 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m994[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m605 | [0m[35m                value = json.loads(value)[0m
[30;1m606 | [0m[35m            assert isinstance(value, dict)[0m
[30;1m607 | [0m[35m            leader = value.get('leader')[0m
[30;1m608 | [0m[35m            quorum = value.get('quorum')[0m
[30;1m609 | [0m[35m            return SyncState(version, leader, value.get('sync_standby'), int(quorum) if leader and q[0m
[30;1m610 | [0m[35m        except (AssertionError, TypeError, ValueError):[0m
[30;1m611 | [0m[35m            return SyncState.empty(version)[0m

[31m--[ [0m[34mMatch #[0m[33m995[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m604 | [0m[35m            if value and isinstance(value, str):[0m
[30;1m605 | [0m[35m                value = json.loads(value)[0m
[30;1m606 | [0m[35m            assert isinstance(value, dict)[0m
[30;1m607 | [0m[35m            leader = value.get('leader')[0m
[30;1m608 | [0m[35m            quorum = value.get('quorum')[0m
[30;1m609 | [0m[35m            return SyncState(version, leader, value.get('sync_standby'), int(quorum) if leader and q[0m
[30;1m610 | [0m[35m        except (AssertionError, TypeError, ValueError):[0m

[31m--[ [0m[34mMatch #[0m[33m996[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m        if data.get('scheduled_at'):[0m
[30;1m496 | [0m[35m            data['scheduled_at'] = dateutil.parser.parse(data['scheduled_at'])[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m        return Failover(version, data.get('leader'), data.get('member'), data.get('scheduled_at'))[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m    def __len__(self) -> int:[0m
[30;1m501 | [0m[35m        """Implement ``len`` function capability.[0m

[31m--[ [0m[34mMatch #[0m[33m997[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m        if data.get('scheduled_at'):[0m
[30;1m496 | [0m[35m            data['scheduled_at'] = dateutil.parser.parse(data['scheduled_at'])[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m        return Failover(version, data.get('leader'), data.get('member'), data.get('scheduled_at'))[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m    def __len__(self) -> int:[0m
[30;1m501 | [0m[35m        """Implement ``len`` function capability.[0m

[31m--[ [0m[34mMatch #[0m[33m998[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m        if data.get('scheduled_at'):[0m
[30;1m496 | [0m[35m            data['scheduled_at'] = dateutil.parser.parse(data['scheduled_at'])[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m        return Failover(version, data.get('leader'), data.get('member'), data.get('scheduled_at'))[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m    def __len__(self) -> int:[0m
[30;1m501 | [0m[35m        """Implement ``len`` function capability.[0m

[31m--[ [0m[34mMatch #[0m[33m999[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m492 | [0m[35m        else:[0m
[30;1m493 | [0m[35m            data = {}[0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m        if data.get('scheduled_at'):[0m
[30;1m496 | [0m[35m            data['scheduled_at'] = dateutil.parser.parse(data['scheduled_at'])[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m        return Failover(version, data.get('leader'), data.get('member'), data.get('scheduled_at'))[0m

[31m--[ [0m[34mMatch #[0m[33m1000[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m417 | [0m[35m        version = self.member.patroni_version[0m
[30;1m418 | [0m[35m        # 1.5.6 is the last version which doesn't expose checkpoint_after_promote: false[0m
[30;1m419 | [0m[35m        if version and version > (1, 5, 6):[0m
[30;1m420 | [0m[35m            return self.data.get('role') in ('master', 'primary') and 'checkpoint_after_promote' not[0m
[30;1m421 | [0m[35m        return None[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1001[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m    @property[0m
[30;1m401 | [0m[35m    def timeline(self) -> Optional[int]:[0m
[30;1m402 | [0m[35m        """Timeline value of :attr:`~Member.data`."""[0m
[30;1m403 | [0m[35m        return self.data.get('timeline')[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m    @property[0m
[30;1m406 | [0m[35m    def checkpoint_after_promote(self) -> Optional[bool]:[0m

[31m--[ [0m[34mMatch #[0m[33m1002[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m        :returns: value of *name* key in :attr:`~RemoteMember.data` if key *name* is in[0m
[30;1m357 | [0m[35m                  :cvar:`~RemoteMember.ALLOWED_KEYS`, else ``None``.[0m
[30;1m358 | [0m[35m        """[0m
[30;1m359 | [0m[35m        return self.data.get(name) if name in RemoteMember.ALLOWED_KEYS else None[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35mclass Leader(NamedTuple):[0m

[31m--[ [0m[34mMatch #[0m[33m1003[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m    @property[0m
[30;1m320 | [0m[35m    def lsn(self) -> Optional[int]:[0m
[30;1m321 | [0m[35m        """Current LSN (receive/flush/replay)."""[0m
[30;1m322 | [0m[35m        return parse_int(self.data.get('xlog_location'))[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35mclass RemoteMember(Member):[0m

[31m--[ [0m[34mMatch #[0m[33m1004[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m308 | [0m[35m            (1, 2, 3)[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m        """[0m
[30;1m311 | [0m[35m        version = self.data.get('version')[0m
[30;1m312 | [0m[35m        if version:[0m
[30;1m313 | [0m[35m            try:[0m
[30;1m314 | [0m[35m                return tuple(map(int, version.split('.')))[0m

[31m--[ [0m[34mMatch #[0m[33m1005[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m    @property[0m
[30;1m292 | [0m[35m    def state(self) -> str:[0m
[30;1m293 | [0m[35m        """The ``state`` value of :attr:`~Member.data`."""[0m
[30;1m294 | [0m[35m        return self.data.get('state', 'unknown')[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m    @property[0m
[30;1m297 | [0m[35m    def is_running(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1006[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m281 | [0m[35m    @property[0m
[30;1m282 | [0m[35m    def tags(self) -> Dict[str, Any]:[0m
[30;1m283 | [0m[35m        """The ``tags`` value from :attr:`~Member.data` if defined, otherwise an empty dictionary.""[0m
[30;1m284 | [0m[35m        return self.data.get('tags', {})[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m    @property[0m
[30;1m287 | [0m[35m    def clonefrom(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1007[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m    @property[0m
[30;1m277 | [0m[35m    def api_url(self) -> Optional[str]:[0m
[30;1m278 | [0m[35m        """The ``api_url`` value from :attr:`~Member.data` if defined."""[0m
[30;1m279 | [0m[35m        return self.data.get('api_url')[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m    @property[0m
[30;1m282 | [0m[35m    def tags(self) -> Dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m1008[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m            "port": None,[0m
[30;1m238 | [0m[35m            "dbname": None[0m
[30;1m239 | [0m[35m        }[0m
[30;1m240 | [0m[35m        ret: Optional[Dict[str, Any]] = self.data.get('conn_kwargs')[0m
[30;1m241 | [0m[35m        if ret:[0m
[30;1m242 | [0m[35m            defaults.update(ret)[0m
[30;1m243 | [0m[35m            ret = defaults[0m

[31m--[ [0m[34mMatch #[0m[33m1009[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        conn_kwargs = self.data.get('conn_kwargs')[0m
[30;1m215 | [0m[35m        if conn_kwargs:[0m
[30;1m216 | [0m[35m            conn_url = uri('postgresql', (conn_kwargs.get('host'), conn_kwargs.get('port', 5432)))[0m
[30;1m217 | [0m[35m            self.data['conn_url'] = conn_url[0m
[30;1m218 | [0m[35m            return conn_url[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1010[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        conn_kwargs = self.data.get('conn_kwargs')[0m
[30;1m215 | [0m[35m        if conn_kwargs:[0m
[30;1m216 | [0m[35m            conn_url = uri('postgresql', (conn_kwargs.get('host'), conn_kwargs.get('port', 5432)))[0m
[30;1m217 | [0m[35m            self.data['conn_url'] = conn_url[0m
[30;1m218 | [0m[35m            return conn_url[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1011[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m        if conn_url:[0m
[30;1m212 | [0m[35m            return conn_url[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        conn_kwargs = self.data.get('conn_kwargs')[0m
[30;1m215 | [0m[35m        if conn_kwargs:[0m
[30;1m216 | [0m[35m            conn_url = uri('postgresql', (conn_kwargs.get('host'), conn_kwargs.get('port', 5432)))[0m
[30;1m217 | [0m[35m            self.data['conn_url'] = conn_url[0m

[31m--[ [0m[34mMatch #[0m[33m1012[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m    @property[0m
[30;1m208 | [0m[35m    def conn_url(self) -> Optional[str]:[0m
[30;1m209 | [0m[35m        """The ``conn_url`` value from :attr:`~Member.data` if defined or constructed from ``conn_kw[0m
[30;1m210 | [0m[35m        conn_url = self.data.get('conn_url')[0m
[30;1m211 | [0m[35m        if conn_url:[0m
[30;1m212 | [0m[35m            return conn_url[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1013[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m247 | [0m[35m                return {}  # due to the invalid conn_url we don't care about authentication paramete[0m
[30;1m248 | [0m[35m            r = urlparse(conn_url)[0m
[30;1m249 | [0m[35m            ret = {[0m
[30;1m250 | [0m[35m                'host': r.hostname,[0m
[30;1m251 | [0m[35m                'port': r.port or 5432,[0m
[30;1m252 | [0m[35m                'dbname': r.path[1:][0m
[30;1m253 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m1014[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2113 | [0m[35m        """Set synchronous state in DCS.[0m
[30;1m2114 | [0m[35m[0m
[30;1m2115 | [0m[35m        :param value: the new value of ``/sync`` key.[0m
[30;1m2116 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m2117 | [0m[35m[0m
[30;1m2118 | [0m[35m        :returns: *version* of the new object or ``False`` in case of error.[0m
[30;1m2119 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1015[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2088 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2089 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m2090 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m
[30;1m2091 | [0m[35m                       see at least :attr:`~SyncState.quorum` other nodes from the[0m
[30;1m2092 | [0m[35m                       :attr:`~SyncState.sync_standby` + :attr:`~SyncState.leader` list[0m
[30;1m2093 | [0m[35m[0m
[30;1m2094 | [0m[35m        :returns: the new :class:`SyncState` object or ``None``.[0m

[31m--[ [0m[34mMatch #[0m[33m1016[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2086 | [0m[35m[0m
[30;1m2087 | [0m[35m        :param leader: name of the leader node that manages ``/sync`` key.[0m
[30;1m2088 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2089 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m2090 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m
[30;1m2091 | [0m[35m                       see at least :attr:`~SyncState.quorum` other nodes from the[0m
[30;1m2092 | [0m[35m                       :attr:`~SyncState.sync_standby` + :attr:`~SyncState.leader` list[0m

[31m--[ [0m[34mMatch #[0m[33m1017[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2069 | [0m[35m        :param leader: name of the leader node that manages ``/sync`` key.[0m
[30;1m2070 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2071 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m
[30;1m2072 | [0m[35m                       see at least :attr:`~SyncState.quorum` other nodes from the[0m
[30;1m2073 | [0m[35m                       :attr:`~SyncState.sync_standby` + :attr:`~SyncState.leader` list[0m
[30;1m2074 | [0m[35m[0m
[30;1m2075 | [0m[35m        :returns: dictionary that later could be serialized to JSON or saved directly to DCS.[0m

[31m--[ [0m[34mMatch #[0m[33m1018[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1987 | [0m[35m        """Update member key in DCS.[0m
[30;1m1988 | [0m[35m[0m
[30;1m1989 | [0m[35m        .. note::[0m
[30;1m1990 | [0m[35m            This method should create or update key with the name with ``/members/`` + :attr:`~Abstr[0m
[30;1m1991 | [0m[35m            and the value of *data* in a given DCS.[0m
[30;1m1992 | [0m[35m[0m
[30;1m1993 | [0m[35m        :param data: information about an instance (including connection strings).[0m

[31m--[ [0m[34mMatch #[0m[33m1019[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1977 | [0m[35m        """Create or update ``/config`` key in DCS.[0m
[30;1m1978 | [0m[35m[0m
[30;1m1979 | [0m[35m        :param value: new value to set in the ``config`` key.[0m
[30;1m1980 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m1981 | [0m[35m[0m
[30;1m1982 | [0m[35m        :returns: ``True`` if successfully committed to DCS.[0m
[30;1m1983 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1020[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1974 | [0m[35m[0m
[30;1m1975 | [0m[35m    @abc.abstractmethod[0m
[30;1m1976 | [0m[35m    def set_config_value(self, value: str, version: Optional[Any] = None) -> bool:[0m
[30;1m1977 | [0m[35m        """Create or update ``/config`` key in DCS.[0m
[30;1m1978 | [0m[35m[0m
[30;1m1979 | [0m[35m        :param value: new value to set in the ``config`` key.[0m
[30;1m1980 | [0m[35m        :param version: for conditional update of the key/object.[0m

[31m--[ [0m[34mMatch #[0m[33m1021[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1957 | [0m[35m        :param leader: value to set for ``leader``.[0m
[30;1m1958 | [0m[35m        :param candidate: value to set for ``member``.[0m
[30;1m1959 | [0m[35m        :param scheduled_at: value converted to ISO date format for ``scheduled_at``.[0m
[30;1m1960 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m1961 | [0m[35m[0m
[30;1m1962 | [0m[35m        :returns: ``True`` if successfully committed to DCS.[0m
[30;1m1963 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1022[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1945 | [0m[35m        """Create or update ``/failover`` key.[0m
[30;1m1946 | [0m[35m[0m
[30;1m1947 | [0m[35m        :param value: value to set.[0m
[30;1m1948 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m1949 | [0m[35m[0m
[30;1m1950 | [0m[35m        :returns: ``True`` if successfully committed to DCS.[0m
[30;1m1951 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1023[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1942 | [0m[35m[0m
[30;1m1943 | [0m[35m    @abc.abstractmethod[0m
[30;1m1944 | [0m[35m    def set_failover_value(self, value: str, version: Optional[Any] = None) -> bool:[0m
[30;1m1945 | [0m[35m        """Create or update ``/failover`` key.[0m
[30;1m1946 | [0m[35m[0m
[30;1m1947 | [0m[35m        :param value: value to set.[0m
[30;1m1948 | [0m[35m        :param version: for conditional update of the key/object.[0m

[31m--[ [0m[34mMatch #[0m[33m1024[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1872 | [0m[35m            You have to use CAS (Compare And Swap) operation in order to update leader key, for exam[0m
[30;1m1873 | [0m[35m            ``prevValue`` parameter must be used.[0m
[30;1m1874 | [0m[35m[0m
[30;1m1875 | [0m[35m            If update fails due to DCS not being accessible or because it is not able to process req[0m
[30;1m1876 | [0m[35m            temporary), the :exc:`DCSError` exception should be raised.[0m
[30;1m1877 | [0m[35m[0m
[30;1m1878 | [0m[35m        :param leader: a reference to a current :class:`leader` object.[0m

[31m--[ [0m[34mMatch #[0m[33m1025[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1869 | [0m[35m        """Update ``leader`` key (or session) ttl.[0m
[30;1m1870 | [0m[35m[0m
[30;1m1871 | [0m[35m        .. note::[0m
[30;1m1872 | [0m[35m            You have to use CAS (Compare And Swap) operation in order to update leader key, for exam[0m
[30;1m1873 | [0m[35m            ``prevValue`` parameter must be used.[0m
[30;1m1874 | [0m[35m[0m
[30;1m1875 | [0m[35m            If update fails due to DCS not being accessible or because it is not able to process req[0m

[31m--[ [0m[34mMatch #[0m[33m1026[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1704 | [0m[35m        """Retrieve a fresh view of DCS.[0m
[30;1m1705 | [0m[35m[0m
[30;1m1706 | [0m[35m        .. note::[0m
[30;1m1707 | [0m[35m            Stores copy of time, status and failsafe values for comparison in DCS update decisions.[0m
[30;1m1708 | [0m[35m            Caching is required to avoid overhead placed upon the REST API.[0m
[30;1m1709 | [0m[35m[0m
[30;1m1710 | [0m[35m            Returns either a PostgreSQL or MPP implementation of :class:`Cluster` depending on avail[0m

[31m--[ [0m[34mMatch #[0m[33m1027[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1443 | [0m[35m    retried or may result in warning log messages:[0m
[30;1m1444 | [0m[35m[0m
[30;1m1445 | [0m[35m        * :meth:`~AbstractDCS.set_failover_value`: method to create and/or update the ``failover`` k[0m
[30;1m1446 | [0m[35m        * :meth:`~AbstractDCS.set_config_value`: method to create and/or update the ``failover`` key[0m
[30;1m1447 | [0m[35m        * :meth:`~AbstractDCS.set_sync_state_value`: method to set the synchronous state ``sync`` ke[0m
[30;1m1448 | [0m[35m[0m
[30;1m1449 | [0m[35m    DCS data and key removal methods:[0m

[31m--[ [0m[34mMatch #[0m[33m1028[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1442 | [0m[35m    DCS setter methods using Compare-And-Set which although important are less critical if they fail[0m
[30;1m1443 | [0m[35m    retried or may result in warning log messages:[0m
[30;1m1444 | [0m[35m[0m
[30;1m1445 | [0m[35m        * :meth:`~AbstractDCS.set_failover_value`: method to create and/or update the ``failover`` k[0m
[30;1m1446 | [0m[35m        * :meth:`~AbstractDCS.set_config_value`: method to create and/or update the ``failover`` key[0m
[30;1m1447 | [0m[35m        * :meth:`~AbstractDCS.set_sync_state_value`: method to set the synchronous state ``sync`` ke[0m
[30;1m1448 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1029[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1436 | [0m[35m method to write WAL LSN to DCS.[0m
[30;1m1437 | [0m[35m        * :meth:`~AbstractDCS._write_status`: method to write WAL LSN for slots to the DCS.[0m
[30;1m1438 | [0m[35m        * :meth:`~AbstractDCS._write_failsafe`: method to write cluster topology to the DCS, used by[0m
[30;1m1439 | [0m[35m        * :meth:`~AbstractDCS.touch_member`: method to update individual member key in the DCS.[0m
[30;1m1440 | [0m[35m        * :meth:`~AbstractDCS.set_history_value`: method to set the ``history`` key in the DCS.[0m
[30;1m1441 | [0m[35m[0m
[30;1m1442 | [0m[35m    DCS setter methods using Compare-And-Set which although important are less critical if they fail[0m
[30;1m1443 | [0m[35m    retried or may result in warning log messages:[0m

[31m--[ [0m[34mMatch #[0m[33m1030[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1420 | [0m[35m            if it does not exist.[0m
[30;1m1421 | [0m[35m        * :meth:`~AbstractDCS._update_leader`:[0m
[30;1m1422 | [0m[35m            method to update ``leader`` key in DCS. Relies on Compare-And-Set to ensure the Primary [0m
[30;1m1423 | [0m[35m            If this fails to update within the ``retry_timeout`` window the Primary will be demoted.[0m
[30;1m1424 | [0m[35m[0m
[30;1m1425 | [0m[35m    Functional method that relies on Compare-And-Create to ensure only one member creates the releva[0m
[30;1m1426 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1031[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1419 | [0m[35m            method used in the leader race to attempt to acquire the leader lock by creating the lea[0m
[30;1m1420 | [0m[35m            if it does not exist.[0m
[30;1m1421 | [0m[35m        * :meth:`~AbstractDCS._update_leader`:[0m
[30;1m1422 | [0m[35m            method to update ``leader`` key in DCS. Relies on Compare-And-Set to ensure the Primary [0m
[30;1m1423 | [0m[35m            If this fails to update within the ``retry_timeout`` window the Primary will be demoted.[0m
[30;1m1424 | [0m[35m[0m
[30;1m1425 | [0m[35m    Functional method that relies on Compare-And-Create to ensure only one member creates the releva[0m

[31m--[ [0m[34mMatch #[0m[33m1032[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1042 | [0m[35m[0m
[30;1m1043 | [0m[35m        Perform validation of configured permanent slot name, skipping invalid names.[0m
[30;1m1044 | [0m[35m[0m
[30;1m1045 | [0m[35m        Will update *slots* in-line based on ``type`` of slot, ``physical`` or ``logical``, and name[0m
[30;1m1046 | [0m[35m        Type is assumed to be ``physical`` if there are no attributes stored as the slot value.[0m
[30;1m1047 | [0m[35m[0m
[30;1m1048 | [0m[35m        :param slots: Slot names with existing attributes if known.[0m

[31m--[ [0m[34mMatch #[0m[33m1033[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m562 | [0m[35m    :ivar leader: reference to member that was leader.[0m
[30;1m563 | [0m[35m    :ivar sync_standby: synchronous standby list (comma delimited) which are last synchronized to le[0m
[30;1m564 | [0m[35m    :ivar quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race it sh[0m
[30;1m565 | [0m[35m                  see at least :attr:`~SyncState.quorum` other nodes from the[0m
[30;1m566 | [0m[35m                  :attr:`~SyncState.sync_standby` + :attr:`~SyncState.leader` list.[0m
[30;1m567 | [0m[35m    """[0m
[30;1m568 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1034[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2131 | [0m[35m        """Sleep if the current node is a leader, otherwise, watch for changes of leader key with a [0m
[30;1m2132 | [0m[35m[0m
[30;1m2133 | [0m[35m        :param leader_version: version of a leader key.[0m
[30;1m2134 | [0m[35m        :param timeout: timeout in seconds.[0m
[30;1m2135 | [0m[35m[0m
[30;1m2136 | [0m[35m        :returns: if ``True`` this will reschedule the next run of the HA cycle.[0m
[30;1m2137 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1035[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2128 | [0m[35m        """[0m
[30;1m2129 | [0m[35m[0m
[30;1m2130 | [0m[35m    def watch(self, leader_version: Optional[Any], timeout: float) -> bool:[0m
[30;1m2131 | [0m[35m        """Sleep if the current node is a leader, otherwise, watch for changes of leader key with a [0m
[30;1m2132 | [0m[35m[0m
[30;1m2133 | [0m[35m        :param leader_version: version of a leader key.[0m
[30;1m2134 | [0m[35m        :param timeout: timeout in seconds.[0m

[31m--[ [0m[34mMatch #[0m[33m1036[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2128 | [0m[35m        """[0m
[30;1m2129 | [0m[35m[0m
[30;1m2130 | [0m[35m    def watch(self, leader_version: Optional[Any], timeout: float) -> bool:[0m
[30;1m2131 | [0m[35m        """Sleep if the current node is a leader, otherwise, watch for changes of leader key with a [0m
[30;1m2132 | [0m[35m[0m
[30;1m2133 | [0m[35m        :param leader_version: version of a leader key.[0m
[30;1m2134 | [0m[35m        :param timeout: timeout in seconds.[0m

[31m--[ [0m[34mMatch #[0m[33m1037[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2087 | [0m[35m        :param leader: name of the leader node that manages ``/sync`` key.[0m
[30;1m2088 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2089 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m2090 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m
[30;1m2091 | [0m[35m                       see at least :attr:`~SyncState.quorum` other nodes from the[0m
[30;1m2092 | [0m[35m                       :attr:`~SyncState.sync_standby` + :attr:`~SyncState.leader` list[0m
[30;1m2093 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1038[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2085 | [0m[35m        :meth:`~AbstractDCS.set_sync_state_value`.[0m
[30;1m2086 | [0m[35m[0m
[30;1m2087 | [0m[35m        :param leader: name of the leader node that manages ``/sync`` key.[0m
[30;1m2088 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2089 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m2090 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m
[30;1m2091 | [0m[35m                       see at least :attr:`~SyncState.quorum` other nodes from the[0m

[31m--[ [0m[34mMatch #[0m[33m1039[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2084 | [0m[35m        Calls :meth:`~AbstractDCS.sync_state` to build a dictionary and then calls DCS specific[0m
[30;1m2085 | [0m[35m        :meth:`~AbstractDCS.set_sync_state_value`.[0m
[30;1m2086 | [0m[35m[0m
[30;1m2087 | [0m[35m        :param leader: name of the leader node that manages ``/sync`` key.[0m
[30;1m2088 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2089 | [0m[35m        :param version: for conditional update of the key/object.[0m
[30;1m2090 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m

[31m--[ [0m[34mMatch #[0m[33m1040[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2068 | [0m[35m[0m
[30;1m2069 | [0m[35m        :param leader: name of the leader node that manages ``/sync`` key.[0m
[30;1m2070 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2071 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m
[30;1m2072 | [0m[35m                       see at least :attr:`~SyncState.quorum` other nodes from the[0m
[30;1m2073 | [0m[35m                       :attr:`~SyncState.sync_standby` + :attr:`~SyncState.leader` list[0m
[30;1m2074 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1041[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2067 | [0m[35m        """Build ``sync_state`` dictionary.[0m
[30;1m2068 | [0m[35m[0m
[30;1m2069 | [0m[35m        :param leader: name of the leader node that manages ``/sync`` key.[0m
[30;1m2070 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2071 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m
[30;1m2072 | [0m[35m                       see at least :attr:`~SyncState.quorum` other nodes from the[0m
[30;1m2073 | [0m[35m                       :attr:`~SyncState.sync_standby` + :attr:`~SyncState.leader` list[0m

[31m--[ [0m[34mMatch #[0m[33m1042[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2066 | [0m[35m                   quorum: Optional[int]) -> Dict[str, Any]:[0m
[30;1m2067 | [0m[35m        """Build ``sync_state`` dictionary.[0m
[30;1m2068 | [0m[35m[0m
[30;1m2069 | [0m[35m        :param leader: name of the leader node that manages ``/sync`` key.[0m
[30;1m2070 | [0m[35m        :param sync_standby: collection of currently known synchronous standby node names.[0m
[30;1m2071 | [0m[35m        :param quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race [0m
[30;1m2072 | [0m[35m                       see at least :attr:`~SyncState.quorum` other nodes from the[0m

[31m--[ [0m[34mMatch #[0m[33m1043[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1936 | [0m[35m        ret = self.attempt_to_acquire_leader()[0m
[30;1m1937 | [0m[35m        if ret:[0m
[30;1m1938 | [0m[35m            timestamp = time.time()[0m
[30;1m1939 | [0m[35m            # every time we promote we need to reset retention time for slots recorded in the /statu[0m
[30;1m1940 | [0m[35m            self._last_retain_slots = {name: timestamp for name in self._last_status['retain_slots'][0m
[30;1m1941 | [0m[35m        return ret[0m
[30;1m1942 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1044[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1936 | [0m[35m        ret = self.attempt_to_acquire_leader()[0m
[30;1m1937 | [0m[35m        if ret:[0m
[30;1m1938 | [0m[35m            timestamp = time.time()[0m
[30;1m1939 | [0m[35m            # every time we promote we need to reset retention time for slots recorded in the /statu[0m
[30;1m1940 | [0m[35m            self._last_retain_slots = {name: timestamp for name in self._last_status['retain_slots'][0m
[30;1m1941 | [0m[35m        return ret[0m
[30;1m1942 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1045[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1929 | [0m[35m        .. note::[0m
[30;1m1930 | [0m[35m            This method wraps :meth:`~AbstractDCS.attempt_to_acquire_leader`: and is[0m
[30;1m1931 | [0m[35m            used to reset retention time of physical replication slots that representing[0m
[30;1m1932 | [0m[35m            members of the cluster when current node is to be promoted to the leader.[0m
[30;1m1933 | [0m[35m[0m
[30;1m1934 | [0m[35m        :returns: ``True`` if the leader key has been created successfully.[0m
[30;1m1935 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1046[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1928 | [0m[35m[0m
[30;1m1929 | [0m[35m        .. note::[0m
[30;1m1930 | [0m[35m            This method wraps :meth:`~AbstractDCS.attempt_to_acquire_leader`: and is[0m
[30;1m1931 | [0m[35m            used to reset retention time of physical replication slots that representing[0m
[30;1m1932 | [0m[35m            members of the cluster when current node is to be promoted to the leader.[0m
[30;1m1933 | [0m[35m[0m
[30;1m1934 | [0m[35m        :returns: ``True`` if the leader key has been created successfully.[0m

[31m--[ [0m[34mMatch #[0m[33m1047[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1847 | [0m[35m                if not member.nostream:[0m
[30;1m1848 | [0m[35m                    members.add(slot_name_from_member_name(member.name))[0m
[30;1m1849 | [0m[35m            if not found_self:[0m
[30;1m1850 | [0m[35m                # It could be that the member key for our node is not in DCS and we can't check tags[0m
[30;1m1851 | [0m[35m                # In this case our name will falsely appear in `retain_slots`, but only temporary.[0m
[30;1m1852 | [0m[35m                members.add(slot_name_from_member_name(self._name))[0m
[30;1m1853 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1048[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1832 | [0m[35m        and removing names when they were observed longer than ``member_slots_ttl`` ago.[0m
[30;1m1833 | [0m[35m[0m
[30;1m1834 | [0m[35m        :param cluster: :class:`Cluster` object with information about the current cluster state.[0m
[30;1m1835 | [0m[35m        :param slots: slot names with LSN values that exist on the leader node and consists[0m
[30;1m1836 | [0m[35m                      of slots for cluster members and permanent replication slots.[0m
[30;1m1837 | [0m[35m[0m
[30;1m1838 | [0m[35m        :returns: the list of replication slots to be written to ``/status`` key or ``None``.[0m

[31m--[ [0m[34mMatch #[0m[33m1049[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1676 | [0m[35m        """Load the PostgreSQL cluster for the MPP Coordinator.[0m
[30;1m1677 | [0m[35m[0m
[30;1m1678 | [0m[35m        .. note::[0m
[30;1m1679 | [0m[35m            This method is only executed on the worker nodes to find the coordinator.[0m
[30;1m1680 | [0m[35m[0m
[30;1m1681 | [0m[35m        :returns: Select :class:`Cluster` instance associated with the MPP Coordinator group ID.[0m
[30;1m1682 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1050[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1668 | [0m[35m    def is_mpp_coordinator(self) -> bool:[0m
[30;1m1669 | [0m[35m        """:class:`Cluster` instance has a Coordinator group ID.[0m
[30;1m1670 | [0m[35m[0m
[30;1m1671 | [0m[35m        :returns: ``True`` if the given node is running as the MPP Coordinator.[0m
[30;1m1672 | [0m[35m        """[0m
[30;1m1673 | [0m[35m        return self._mpp.is_coordinator()[0m
[30;1m1674 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1051[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1647 | [0m[35m        :param loader: one of :meth:`~AbstractDCS._postgresql_cluster_loader` or[0m
[30;1m1648 | [0m[35m                       :meth:`~AbstractDCS._mpp_cluster_loader`.[0m
[30;1m1649 | [0m[35m[0m
[30;1m1650 | [0m[35m        :raise: :exc:`~DCSError` in case of communication problems with DCS. If the current node was[0m
[30;1m1651 | [0m[35m                primary and exception raised, instance would be demoted.[0m
[30;1m1652 | [0m[35m        """[0m
[30;1m1653 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1052[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1611 | [0m[35m[0m
[30;1m1612 | [0m[35m    @property[0m
[30;1m1613 | [0m[35m    def last_seen(self) -> int:[0m
[30;1m1614 | [0m[35m        """The time recorded when the DCS was last reachable."""[0m
[30;1m1615 | [0m[35m        return self._last_seen[0m
[30;1m1616 | [0m[35m[0m
[30;1m1617 | [0m[35m    @abc.abstractmethod[0m

[31m--[ [0m[34mMatch #[0m[33m1053[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1606 | [0m[35m[0m
[30;1m1607 | [0m[35m    @property[0m
[30;1m1608 | [0m[35m    def loop_wait(self) -> int:[0m
[30;1m1609 | [0m[35m        """The recorded value for cluster HA loop wait time in seconds."""[0m
[30;1m1610 | [0m[35m        return self._loop_wait[0m
[30;1m1611 | [0m[35m[0m
[30;1m1612 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1054[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1313 | [0m[35m            In case of cascading replication we have to check not our physical slot, but slot of the[0m
[30;1m1314 | [0m[35m            connects us to the primary.[0m
[30;1m1315 | [0m[35m[0m
[30;1m1316 | [0m[35m        :param name: name of the member node to check.[0m
[30;1m1317 | [0m[35m        :param tags: reference to an object implementing :class:`Tags` interface.[0m
[30;1m1318 | [0m[35m[0m
[30;1m1319 | [0m[35m        :returns: the slot name on the primary that is in use for physical replication on this node.[0m

[31m--[ [0m[34mMatch #[0m[33m1055[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1305 | [0m[35m        return False[0m
[30;1m1306 | [0m[35m[0m
[30;1m1307 | [0m[35m    def get_slot_name_on_primary(self, name: str, tags: Tags) -> Optional[str]:[0m
[30;1m1308 | [0m[35m        """Get the name of physical replication slot for this node on the primary.[0m
[30;1m1309 | [0m[35m[0m
[30;1m1310 | [0m[35m        .. note::[0m
[30;1m1311 | [0m[35m            P <-- I <-- L[0m

[31m--[ [0m[34mMatch #[0m[33m1056[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1288 | [0m[35m        :param member: reference to an object implementing :class:`Tags` interface for[0m
[30;1m1289 | [0m[35m                       the node that we are checking permanent logical replication slots for.[0m
[30;1m1290 | [0m[35m[0m
[30;1m1291 | [0m[35m        :returns: ``True`` if this node or any member replicating from this node has[0m
[30;1m1292 | [0m[35m                  permanent logical slots, otherwise ``False``.[0m
[30;1m1293 | [0m[35m        """[0m
[30;1m1294 | [0m[35m        if self._has_permanent_logical_slots(postgresql, member):[0m

[31m--[ [0m[34mMatch #[0m[33m1057[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1288 | [0m[35m        :param member: reference to an object implementing :class:`Tags` interface for[0m
[30;1m1289 | [0m[35m                       the node that we are checking permanent logical replication slots for.[0m
[30;1m1290 | [0m[35m[0m
[30;1m1291 | [0m[35m        :returns: ``True`` if this node or any member replicating from this node has[0m
[30;1m1292 | [0m[35m                  permanent logical slots, otherwise ``False``.[0m
[30;1m1293 | [0m[35m        """[0m
[30;1m1294 | [0m[35m        if self._has_permanent_logical_slots(postgresql, member):[0m

[31m--[ [0m[34mMatch #[0m[33m1058[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1286 | [0m[35m[0m
[30;1m1287 | [0m[35m        :param postgresql: reference to a :class:`Postgresql` object.[0m
[30;1m1288 | [0m[35m        :param member: reference to an object implementing :class:`Tags` interface for[0m
[30;1m1289 | [0m[35m                       the node that we are checking permanent logical replication slots for.[0m
[30;1m1290 | [0m[35m[0m
[30;1m1291 | [0m[35m        :returns: ``True`` if this node or any member replicating from this node has[0m
[30;1m1292 | [0m[35m                  permanent logical slots, otherwise ``False``.[0m

[31m--[ [0m[34mMatch #[0m[33m1059[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1282 | [0m[35m        """Determine whether ``hot_standby_feedback`` should be enabled for the given member.[0m
[30;1m1283 | [0m[35m[0m
[30;1m1284 | [0m[35m        The ``hot_standby_feedback`` must be enabled if the current replica has ``logical`` slots,[0m
[30;1m1285 | [0m[35m        or it is working as a cascading replica for the other node that has ``logical`` slots.[0m
[30;1m1286 | [0m[35m[0m
[30;1m1287 | [0m[35m        :param postgresql: reference to a :class:`Postgresql` object.[0m
[30;1m1288 | [0m[35m        :param member: reference to an object implementing :class:`Tags` interface for[0m

[31m--[ [0m[34mMatch #[0m[33m1060[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1271 | [0m[35m[0m
[30;1m1272 | [0m[35m        :param postgresql: reference to a :class:`Postgresql` object.[0m
[30;1m1273 | [0m[35m        :param member: reference to an object implementing :class:`Tags` interface for[0m
[30;1m1274 | [0m[35m                       the node that we are checking permanent logical replication slots for.[0m
[30;1m1275 | [0m[35m[0m
[30;1m1276 | [0m[35m        :returns: ``True`` if any detected replications slots are ``logical``, otherwise ``False``.[0m
[30;1m1277 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1061[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1267 | [0m[35m                     or self.is_logical_slot(permanent_slots[name]) and name not in members_slots)}[0m
[30;1m1268 | [0m[35m[0m
[30;1m1269 | [0m[35m    def _has_permanent_logical_slots(self, postgresql: 'Postgresql', member: Tags) -> bool:[0m
[30;1m1270 | [0m[35m        """Check if the given member node has permanent ``logical`` replication slots configured.[0m
[30;1m1271 | [0m[35m[0m
[30;1m1272 | [0m[35m        :param postgresql: reference to a :class:`Postgresql` object.[0m
[30;1m1273 | [0m[35m        :param member: reference to an object implementing :class:`Tags` interface for[0m

[31m--[ [0m[34mMatch #[0m[33m1062[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1232 | [0m[35m[0m
[30;1m1233 | [0m[35m        :param postgresql: reference to :class:`Postgresql` object.[0m
[30;1m1234 | [0m[35m        :param member: reference to an object implementing :class:`Tags` interface for[0m
[30;1m1235 | [0m[35m                       the node that we are checking permanent logical replication slots for.[0m
[30;1m1236 | [0m[35m        :returns: ``True`` if there are permanent replication slots configured, otherwise ``False``.[0m
[30;1m1237 | [0m[35m        """[0m
[30;1m1238 | [0m[35m        role = 'replica'[0m

[31m--[ [0m[34mMatch #[0m[33m1063[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1228 | [0m[35m        return ret[0m
[30;1m1229 | [0m[35m[0m
[30;1m1230 | [0m[35m    def has_permanent_slots(self, postgresql: 'Postgresql', member: Tags) -> bool:[0m
[30;1m1231 | [0m[35m        """Check if our node has permanent replication slots configured.[0m
[30;1m1232 | [0m[35m[0m
[30;1m1233 | [0m[35m        :param postgresql: reference to :class:`Postgresql` object.[0m
[30;1m1234 | [0m[35m        :param member: reference to an object implementing :class:`Tags` interface for[0m

[31m--[ [0m[34mMatch #[0m[33m1064[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1218 | [0m[35m                    if not nofailover and slot not in ret and slot != slot_name})[0m
[30;1m1219 | [0m[35m[0m
[30;1m1220 | [0m[35m        if len(ret) < len(members):[0m
[30;1m1221 | [0m[35m            # Find which names are conflicting for a nicer error message[0m
[30;1m1222 | [0m[35m            slot_conflicts: Dict[str, List[str]] = defaultdict(list)[0m
[30;1m1223 | [0m[35m            for member in members:[0m
[30;1m1224 | [0m[35m                slot_conflicts[slot_name_from_member_name(member.name)].append(member.name)[0m

[31m--[ [0m[34mMatch #[0m[33m1065[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1194 | [0m[35m        expected_active = leader_filter if role in ('primary', 'standby_leader') else replica_filter[0m
[30;1m1195 | [0m[35m[0m
[30;1m1196 | [0m[35m        if can_advance_slots and global_config.member_slots_ttl > 0:[0m
[30;1m1197 | [0m[35m            # if the node does only cascading and can't become the leader, we[0m
[30;1m1198 | [0m[35m            # want only to have slots for members that could connect to it.[0m
[30;1m1199 | [0m[35m            members = [m for m in members if not nofailover or m.replicatefrom == name][0m
[30;1m1200 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1066[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1190 | [0m[35m[0m
[30;1m1191 | [0m[35m        # In case when retention of replication slots is possible the `expected_active` function[0m
[30;1m1192 | [0m[35m        # will be used to figure out whether the replication slot is expected to be active.[0m
[30;1m1193 | [0m[35m        # Otherwise it will be used to find replication slots that should exist on a current node.[0m
[30;1m1194 | [0m[35m        expected_active = leader_filter if role in ('primary', 'standby_leader') else replica_filter[0m
[30;1m1195 | [0m[35m[0m
[30;1m1196 | [0m[35m        if can_advance_slots and global_config.member_slots_ttl > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m1067[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1177 | [0m[35m                not self.has_member(member.replicatefrom)[0m
[30;1m1178 | [0m[35m[0m
[30;1m1179 | [0m[35m        def replica_filter(member: Member) -> bool:[0m
[30;1m1180 | [0m[35m            """Check whether provided *member* should replicate from the current node when it is run[0m
[30;1m1181 | [0m[35m[0m
[30;1m1182 | [0m[35m            ..note::[0m
[30;1m1183 | [0m[35m                We only consider members with ``replicatefrom`` tag that matches our name and always[0m

[31m--[ [0m[34mMatch #[0m[33m1068[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1166 | [0m[35m        members = filter(lambda m: m.name != name and not m.nostream, self.members)[0m
[30;1m1167 | [0m[35m[0m
[30;1m1168 | [0m[35m        def leader_filter(member: Member) -> bool:[0m
[30;1m1169 | [0m[35m            """Check whether provided *member* should replicate from the current node when it is run[0m
[30;1m1170 | [0m[35m[0m
[30;1m1171 | [0m[35m            :param member: a :class:`Member` object.[0m
[30;1m1172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1069[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1152 | [0m[35m[0m
[30;1m1153 | [0m[35m        :param name: name of this node.[0m
[30;1m1154 | [0m[35m        :param role: role of this node, ``primary``, ``standby_leader``, or ``replica``.[0m
[30;1m1155 | [0m[35m        :param nofailover: ``True`` if this node is tagged to not be a failover candidate, ``False``[0m
[30;1m1156 | [0m[35m        :param can_advance_slots: ``True`` if ``pg_replication_slot_advance()`` function is availabl[0m
[30;1m1157 | [0m[35m                                  ``False`` otherwise.[0m
[30;1m1158 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1070[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1144 | [0m[35m                * On primary have replication slots for all members that don't have ``replicatefrom`[0m
[30;1m1145 | [0m[35m                  to the existing member.[0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m                * On replica node have replication slots only for members which ``replicatefrom`` ta[0m
[30;1m1148 | [0m[35m[0m
[30;1m1149 | [0m[35m        Will log an error if:[0m
[30;1m1150 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1071[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1113 | [0m[35m[0m
[30;1m1114 | [0m[35m        :param postgresql: reference to :class:`Postgresql` object.[0m
[30;1m1115 | [0m[35m        :param tags: reference to an object implementing :class:`Tags` interface.[0m
[30;1m1116 | [0m[35m        :param role: role of the node -- ``primary``, ``standby_leader`` or ``replica``.[0m
[30;1m1117 | [0m[35m[0m
[30;1m1118 | [0m[35m        :returns: dictionary of permanent slot names mapped to attributes.[0m
[30;1m1119 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1072[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1104 | [0m[35m            Permanent replication slots are only considered if ``use_slots`` configuration is enable[0m
[30;1m1105 | [0m[35m            A node that is not supposed to become a leader (*nofailover*) will not have permanent re[0m
[30;1m1106 | [0m[35m            Also node with disabled streaming (*nostream*) and its cascading followers must not have[0m
[30;1m1107 | [0m[35m            logical slots due to lack of feedback from node to primary, which makes them unsafe to u[0m
[30;1m1108 | [0m[35m[0m
[30;1m1109 | [0m[35m            In a standby cluster we only support physical replication slots.[0m
[30;1m1110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1073[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1103 | [0m[35m        .. note::[0m
[30;1m1104 | [0m[35m            Permanent replication slots are only considered if ``use_slots`` configuration is enable[0m
[30;1m1105 | [0m[35m            A node that is not supposed to become a leader (*nofailover*) will not have permanent re[0m
[30;1m1106 | [0m[35m            Also node with disabled streaming (*nostream*) and its cascading followers must not have[0m
[30;1m1107 | [0m[35m            logical slots due to lack of feedback from node to primary, which makes them unsafe to u[0m
[30;1m1108 | [0m[35m[0m
[30;1m1109 | [0m[35m            In a standby cluster we only support physical replication slots.[0m

[31m--[ [0m[34mMatch #[0m[33m1074[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1102 | [0m[35m[0m
[30;1m1103 | [0m[35m        .. note::[0m
[30;1m1104 | [0m[35m            Permanent replication slots are only considered if ``use_slots`` configuration is enable[0m
[30;1m1105 | [0m[35m            A node that is not supposed to become a leader (*nofailover*) will not have permanent re[0m
[30;1m1106 | [0m[35m            Also node with disabled streaming (*nostream*) and its cascading followers must not have[0m
[30;1m1107 | [0m[35m            logical slots due to lack of feedback from node to primary, which makes them unsafe to u[0m
[30;1m1108 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1075[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1079 | [0m[35m           # for a cascading replica. Lets consider a configuration with C being a permanent slot. I[0m
[30;1m1080 | [0m[35m                        # case we should have the following: A(B: active, C: inactive) <- B (C: acti[0m
[30;1m1081 | [0m[35m                        # We don't consider the same situation on node B, because if node C doesn't [0m
[30;1m1082 | [0m[35m                        # be able to know its `replicatefrom` tag value.[0m
[30;1m1083 | [0m[35m                        expected_active = not topology.get(slot_name) and role in ('primary', 'stand[0m

[31m--[ [0m[34mMatch #[0m[33m1076[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1078 | [0m[35m slot[0m
[30;1m1079 | [0m[35m                        # for a cascading replica. Lets consider a configuration with C being a perm[0m
[30;1m1080 | [0m[35m                        # case we should have the following: A(B: active, C: inactive) <- B (C: acti[0m
[30;1m1081 | [0m[35m                        # We don't consider the same situation on node B, because if node C doesn't [0m
[30;1m1082 | [0m[35m                        # be able to know its `replicatefrom` tag value.[0m
[30;1m1083 | [0m[35m                        expected_active = not topology.get(slot_name) and role in ('primary', 'stand[0m

[31m--[ [0m[34mMatch #[0m[33m1077[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1047 | [0m[35m[0m
[30;1m1048 | [0m[35m        :param slots: Slot names with existing attributes if known.[0m
[30;1m1049 | [0m[35m        :param name: name of this node.[0m
[30;1m1050 | [0m[35m        :param role: role of the node -- ``primary``, ``standby_leader`` or ``replica``.[0m
[30;1m1051 | [0m[35m        :param permanent_slots: dictionary containing slot name key and slot information values.[0m
[30;1m1052 | [0m[35m        :param can_advance_slots: ``True`` if ``pg_replication_slot_advance()`` function is availabl[0m
[30;1m1053 | [0m[35m                                  ``False`` otherwise.[0m

[31m--[ [0m[34mMatch #[0m[33m1078[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m845 | [0m[35m    :ivar failover: reference to :class:`Failover` object.[0m
[30;1m846 | [0m[35m    :ivar sync: reference to :class:`SyncState` object, last observed synchronous replication state.[0m
[30;1m847 | [0m[35m    :ivar history: reference to `TimelineHistory` object.[0m
[30;1m848 | [0m[35m    :ivar failsafe: failsafe topology. Node is allowed to become the leader only if its name is foun[0m
[30;1m849 | [0m[35m    :ivar workers: dictionary of workers of the MPP cluster, optional. Each key representing the gro[0m
[30;1m850 | [0m[35m                   corresponding value is a :class:`Cluster` instance.[0m
[30;1m851 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1079[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m648 | [0m[35m        return [] if not self.leader else [self.leader] + self.voters[0m
[30;1m649 | [0m[35m[0m
[30;1m650 | [0m[35m    def matches(self, name: Optional[str], check_leader: bool = False) -> bool:[0m
[30;1m651 | [0m[35m        """Checks if node is presented in the /sync state.[0m
[30;1m652 | [0m[35m[0m
[30;1m653 | [0m[35m        Since PostgreSQL does case-insensitive checks for synchronous_standby_name we do it also.[0m
[30;1m654 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1080[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m561 | [0m[35m    :ivar version: modification version of a synchronization key in a Configuration Store.[0m
[30;1m562 | [0m[35m    :ivar leader: reference to member that was leader.[0m
[30;1m563 | [0m[35m    :ivar sync_standby: synchronous standby list (comma delimited) which are last synchronized to le[0m
[30;1m564 | [0m[35m    :ivar quorum: if the node from :attr:`~SyncState.sync_standby` list is doing a leader race it sh[0m
[30;1m565 | [0m[35m                  see at least :attr:`~SyncState.quorum` other nodes from the[0m
[30;1m566 | [0m[35m                  :attr:`~SyncState.sync_standby` + :attr:`~SyncState.leader` list.[0m
[30;1m567 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1081[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m    :ivar version: version of the object.[0m
[30;1m428 | [0m[35m    :ivar leader: name of the leader. If value isn't empty we treat it as a switchover from the spec[0m
[30;1m429 | [0m[35m    :ivar candidate: the name of the member node to be considered as a failover candidate.[0m
[30;1m430 | [0m[35m    :ivar scheduled_at: in the case of a switchover the :class:`~datetime.datetime` object to perfor[0m
[30;1m431 | [0m[35m        switchover.[0m
[30;1m432 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1082[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m        return dcs_class(config[name], get_mpp(config))[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    available_implementations = ', '.join(sorted([n for n, _ in iter_dcs_classes()]))[0m
[30;1m140 | [0m[35m    raise PatroniFatalException("Can not find suitable configuration of distributed configuration st[0m
[30;1m141 | [0m[35m                                f"Available implementations: {available_implementations}")[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1083[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m    :returns: The first successfully loaded DCS module which is an implementation of :class:`Abstrac[0m
[30;1m128 | [0m[35m    """[0m
[30;1m129 | [0m[35m    for name, dcs_class in iter_dcs_classes(config):[0m
[30;1m130 | [0m[35m        # Propagate some parameters from top level of config if defined to the DCS specific config s[0m
[30;1m131 | [0m[35m        config[name].update({[0m
[30;1m132 | [0m[35m            p: config[p] for p in ('namespace', 'name', 'scope', 'loop_wait',[0m
[30;1m133 | [0m[35m                                   'patronictl', 'ttl', 'retry_timeout')[0m

[31m--[ [0m[34mMatch #[0m[33m1084[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport re[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom collections import defaultdict[0m
[30;1m10 | [0m[35mfrom copy import deepcopy[0m
[30;1m11 | [0m[35mfrom random import randint[0m

[31m--[ [0m[34mMatch #[0m[33m1085[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1422 | [0m[35m        :returns: value of ``synchronous_standby_names`` in the Patroni configuration,[0m
[30;1m1423 | [0m[35m            if any, otherwise ``None``.[0m
[30;1m1424 | [0m[35m        """[0m
[30;1m1425 | [0m[35m        return (self.get('parameters') or EMPTY_DICT).get('synchronous_standby_names')[0m

[31m--[ [0m[34mMatch #[0m[33m1086[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1422 | [0m[35m        :returns: value of ``synchronous_standby_names`` in the Patroni configuration,[0m
[30;1m1423 | [0m[35m            if any, otherwise ``None``.[0m
[30;1m1424 | [0m[35m        """[0m
[30;1m1425 | [0m[35m        return (self.get('parameters') or EMPTY_DICT).get('synchronous_standby_names')[0m

[31m--[ [0m[34mMatch #[0m[33m1087[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1413 | [0m[35m        return self._config.get(key, default)[0m
[30;1m1414 | [0m[35m[0m
[30;1m1415 | [0m[35m    def restore_command(self) -> Optional[str]:[0m
[30;1m1416 | [0m[35m        return (self.get('recovery_conf') or EMPTY_DICT).get('restore_command')[0m
[30;1m1417 | [0m[35m[0m
[30;1m1418 | [0m[35m    @property[0m
[30;1m1419 | [0m[35m    def synchronous_standby_names(self) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m1088[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1413 | [0m[35m        return self._config.get(key, default)[0m
[30;1m1414 | [0m[35m[0m
[30;1m1415 | [0m[35m    def restore_command(self) -> Optional[str]:[0m
[30;1m1416 | [0m[35m        return (self.get('recovery_conf') or EMPTY_DICT).get('restore_command')[0m
[30;1m1417 | [0m[35m[0m
[30;1m1418 | [0m[35m    @property[0m
[30;1m1419 | [0m[35m    def synchronous_standby_names(self) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m1089[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1410 | [0m[35m        return self._postgresql_conf[0m
[30;1m1411 | [0m[35m[0m
[30;1m1412 | [0m[35m    def get(self, key: str, default: Optional[Any] = None) -> Optional[Any]:[0m
[30;1m1413 | [0m[35m        return self._config.get(key, default)[0m
[30;1m1414 | [0m[35m[0m
[30;1m1415 | [0m[35m    def restore_command(self) -> Optional[str]:[0m
[30;1m1416 | [0m[35m        return (self.get('recovery_conf') or EMPTY_DICT).get('restore_command')[0m

[31m--[ [0m[34mMatch #[0m[33m1090[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1398 | [0m[35m[0m
[30;1m1399 | [0m[35m    @property[0m
[30;1m1400 | [0m[35m    def hba_file(self) -> Optional[str]:[0m
[30;1m1401 | [0m[35m        hba_file = self._server_parameters.get('hba_file')[0m
[30;1m1402 | [0m[35m        return None if hba_file == self._pg_hba_conf else hba_file[0m
[30;1m1403 | [0m[35m[0m
[30;1m1404 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1091[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1393 | [0m[35m[0m
[30;1m1394 | [0m[35m    @property[0m
[30;1m1395 | [0m[35m    def ident_file(self) -> Optional[str]:[0m
[30;1m1396 | [0m[35m        ident_file = self._server_parameters.get('ident_file')[0m
[30;1m1397 | [0m[35m        return None if ident_file == self._pg_ident_conf else ident_file[0m
[30;1m1398 | [0m[35m[0m
[30;1m1399 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1092[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1388 | [0m[35m[0m
[30;1m1389 | [0m[35m    @property[0m
[30;1m1390 | [0m[35m    def rewind_credentials(self) -> Dict[str, Any]:[0m
[30;1m1391 | [0m[35m        return self._config['authentication'].get('rewind', self._superuser) \[0m
[30;1m1392 | [0m[35m            if self._postgresql.major_version >= 110000 else self._superuser[0m
[30;1m1393 | [0m[35m[0m
[30;1m1394 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1093[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1369 | [0m[35m            # `pause_at_recovery_target` has no effect if hot_standby is not enabled, therefore we c[0m
[30;1m1370 | [0m[35m            elif self._postgresql.major_version >= 90500 and self._recovery_params:[0m
[30;1m1371 | [0m[35m                pause_at_recovery_target = parse_bool(self._recovery_params.get('pause_at_recovery_t[0m
[30;1m1372 | [0m[35m                recovery_target_action = self._recovery_params.get([0m
[30;1m1373 | [0m[35m                    'recovery_target_action', 'promote' if pause_at_recovery_target is False else 'p[0m
[30;1m1374 | [0m[35m                disable_hot_standby = recovery_target_action == 'promote'[0m
[30;1m1375 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1094[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1368 | [0m[35mt does the right thing[0m
[30;1m1369 | [0m[35m            # `pause_at_recovery_target` has no effect if hot_standby is not enabled, therefore we c[0m
[30;1m1370 | [0m[35m            elif self._postgresql.major_version >= 90500 and self._recovery_params:[0m
[30;1m1371 | [0m[35m                pause_at_recovery_target = parse_bool(self._recovery_params.get('pause_at_recovery_t[0m
[30;1m1372 | [0m[35m                recovery_target_action = self._recovery_params.get([0m
[30;1m1373 | [0m[35m                    'recovery_target_action', 'promote' if pause_at_recovery_target is False else 'p[0m
[30;1m1374 | [0m[35m                disable_hot_standby = recovery_target_action == 'promote'[0m
[30;1m1375 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1095[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1306 | [0m[35m    def set_synchronous_standby_names(self, value: Optional[str]) -> Optional[bool]:[0m
[30;1m1307 | [0m[35m        """Updates synchronous_standby_names and reloads if necessary.[0m
[30;1m1308 | [0m[35m        :returns: True if value was updated."""[0m
[30;1m1309 | [0m[35m        if value != self._server_parameters.get('synchronous_standby_names'):[0m
[30;1m1310 | [0m[35m            if value is None:[0m
[30;1m1311 | [0m[35m                self._server_parameters.pop('synchronous_standby_names', None)[0m
[30;1m1312 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1096[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1263 | [0m[35m        if not local_connection_address_changed:[0m
[30;1m1264 | [0m[35m            self.resolve_connection_addresses()[0m
[30;1m1265 | [0m[35m[0m
[30;1m1266 | [0m[35m        proxy_addr = config.get('proxy_address')[0m
[30;1m1267 | [0m[35m        self._postgresql.proxy_url = uri('postgres', proxy_addr, self._postgresql.database) if proxy[0m
[30;1m1268 | [0m[35m[0m
[30;1m1269 | [0m[35m        if conf_changed:[0m

[31m--[ [0m[34mMatch #[0m[33m1097[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1254 | [0m[35m        self._config = config[0m
[30;1m1255 | [0m[35m        self._server_parameters = server_parameters[0m
[30;1m1256 | [0m[35m        self._adjust_recovery_parameters()[0m
[30;1m1257 | [0m[35m        self._krbsrvname = config.get('krbsrvname')[0m
[30;1m1258 | [0m[35m[0m
[30;1m1259 | [0m[35m        # for not so obvious connection attempts that may happen outside of pyscopg2[0m
[30;1m1260 | [0m[35m        if self._krbsrvname:[0m

[31m--[ [0m[34mMatch #[0m[33m1098[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1249 | [0m[35m[0m
[30;1m1250 | [0m[35m            if (not server_parameters.get('ident_file') or server_parameters['ident_file'] == self._[0m
[30;1m1251 | [0m[35m                    and config.get('pg_ident'):[0m
[30;1m1252 | [0m[35m                ident_changed = self._config.get('pg_ident', []) != config['pg_ident'][0m
[30;1m1253 | [0m[35m[0m
[30;1m1254 | [0m[35m        self._config = config[0m
[30;1m1255 | [0m[35m        self._server_parameters = server_parameters[0m

[31m--[ [0m[34mMatch #[0m[33m1099[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1248 | [0m[35m                hba_changed = self._config.get('pg_hba', []) != config['pg_hba'][0m
[30;1m1249 | [0m[35m[0m
[30;1m1250 | [0m[35m            if (not server_parameters.get('ident_file') or server_parameters['ident_file'] == self._[0m
[30;1m1251 | [0m[35m                    and config.get('pg_ident'):[0m
[30;1m1252 | [0m[35m                ident_changed = self._config.get('pg_ident', []) != config['pg_ident'][0m
[30;1m1253 | [0m[35m[0m
[30;1m1254 | [0m[35m        self._config = config[0m

[31m--[ [0m[34mMatch #[0m[33m1100[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1247 | [0m[35m                    and config.get('pg_hba'):[0m
[30;1m1248 | [0m[35m                hba_changed = self._config.get('pg_hba', []) != config['pg_hba'][0m
[30;1m1249 | [0m[35m[0m
[30;1m1250 | [0m[35m            if (not server_parameters.get('ident_file') or server_parameters['ident_file'] == self._[0m
[30;1m1251 | [0m[35m                    and config.get('pg_ident'):[0m
[30;1m1252 | [0m[35m                ident_changed = self._config.get('pg_ident', []) != config['pg_ident'][0m
[30;1m1253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1101[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1245 | [0m[35m[0m
[30;1m1246 | [0m[35m            if (not server_parameters.get('hba_file') or server_parameters['hba_file'] == self._pg_h[0m
[30;1m1247 | [0m[35m                    and config.get('pg_hba'):[0m
[30;1m1248 | [0m[35m                hba_changed = self._config.get('pg_hba', []) != config['pg_hba'][0m
[30;1m1249 | [0m[35m[0m
[30;1m1250 | [0m[35m            if (not server_parameters.get('ident_file') or server_parameters['ident_file'] == self._[0m
[30;1m1251 | [0m[35m                    and config.get('pg_ident'):[0m

[31m--[ [0m[34mMatch #[0m[33m1102[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1244 | [0m[35m                        server_parameters.pop(param)[0m
[30;1m1245 | [0m[35m[0m
[30;1m1246 | [0m[35m            if (not server_parameters.get('hba_file') or server_parameters['hba_file'] == self._pg_h[0m
[30;1m1247 | [0m[35m                    and config.get('pg_hba'):[0m
[30;1m1248 | [0m[35m                hba_changed = self._config.get('pg_hba', []) != config['pg_hba'][0m
[30;1m1249 | [0m[35m[0m
[30;1m1250 | [0m[35m            if (not server_parameters.get('ident_file') or server_parameters['ident_file'] == self._[0m

[31m--[ [0m[34mMatch #[0m[33m1103[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1243 | [0m[35m                        logger.warning('Removing invalid parameter `%s` from postgresql.parameters',[0m
[30;1m1244 | [0m[35m                        server_parameters.pop(param)[0m
[30;1m1245 | [0m[35m[0m
[30;1m1246 | [0m[35m            if (not server_parameters.get('hba_file') or server_parameters['hba_file'] == self._pg_h[0m
[30;1m1247 | [0m[35m                    and config.get('pg_hba'):[0m
[30;1m1248 | [0m[35m                hba_changed = self._config.get('pg_hba', []) != config['pg_hba'][0m
[30;1m1249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1104[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1237 | [0m[35m                        if value is None or param not in self._server_parameters \[0m
[30;1m1238 | [0m[35m                                or str(value) != str(self._server_parameters[param]):[0m
[30;1m1239 | [0m[35m                            logger.info("Changed %s from '%s' to '%s'",[0m
[30;1m1240 | [0m[35m                                        param, self._server_parameters.get(param), value)[0m
[30;1m1241 | [0m[35m                            conf_changed = True[0m
[30;1m1242 | [0m[35m                    elif param in server_parameters:[0m
[30;1m1243 | [0m[35m                        logger.warning('Removing invalid parameter `%s` from postgresql.parameters',[0m

[31m--[ [0m[34mMatch #[0m[33m1105[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1219 | [0m[35m                                param_diff[r[0]] = get_param_diff(r[1], new_value, r[3], r[2])[0m
[30;1m1220 | [0m[35m                                logger.info("Changed %s from '%s' to '%s' (restart might be required[0m
[30;1m1221 | [0m[35m                                            r[0], param_diff[r[0]]['old_value'], new_value)[0m
[30;1m1222 | [0m[35m                                if config.get('use_unix_socket') and r[0] == 'unix_socket_directorie[0m
[30;1m1223 | [0m[35m                                        or r[0] in ('listen_addresses', 'port'):[0m
[30;1m1224 | [0m[35m                                    local_connection_address_changed = True[0m
[30;1m1225 | [0m[35m                            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1106[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1187 | [0m[35m            del changes['wal_buffers'][0m
[30;1m1188 | [0m[35m[0m
[30;1m1189 | [0m[35m    def reload_config(self, config: Dict[str, Any], sighup: bool = False) -> None:[0m
[30;1m1190 | [0m[35m        self._superuser = config['authentication'].get('superuser', {})[0m
[30;1m1191 | [0m[35m        server_parameters = self.get_server_parameters(config)[0m
[30;1m1192 | [0m[35m        params_skip_changes = CaseInsensitiveSet((*self._RECOVERY_PARAMETERS, 'hot_standby'))[0m
[30;1m1193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1107[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m        self._postgresql.connection_string = uri('postgres', netloc, self._postgresql.database)[0m
[30;1m1148 | [0m[35m[0m
[30;1m1149 | [0m[35m        local_address = unix_local_address if self._config.get('use_unix_socket') else tcp_local_add[0m
[30;1m1150 | [0m[35m        local_conn_kwargs = {[0m
[30;1m1151 | [0m[35m            **local_address,[0m
[30;1m1152 | [0m[35m            **self._superuser,[0m

[31m--[ [0m[34mMatch #[0m[33m1108[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1142 | [0m[35m        tcp_local_address = {'host': tcp_local_address, 'port': port}[0m
[30;1m1143 | [0m[35m[0m
[30;1m1144 | [0m[35m        self.local_replication_address = unix_local_address\[0m
[30;1m1145 | [0m[35m            if self._config.get('use_unix_socket_repl') else tcp_local_address[0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m        self._postgresql.connection_string = uri('postgres', netloc, self._postgresql.database)[0m
[30;1m1148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1109[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1134 | [0m[35m        netloc = self._config.get('connect_address') or tcp_local_address + ':' + port[0m
[30;1m1135 | [0m[35m[0m
[30;1m1136 | [0m[35m        unix_local_address = {'port': port}[0m
[30;1m1137 | [0m[35m        unix_socket_directories = self._server_parameters.get('unix_socket_directories')[0m
[30;1m1138 | [0m[35m        if unix_socket_directories is not None:[0m
[30;1m1139 | [0m[35m            # fallback to tcp if unix_socket_directories is set, but there are no suitable values[0m
[30;1m1140 | [0m[35m            unix_local_address['host'] = self._get_unix_local_address(unix_socket_directories) or tc[0m

[31m--[ [0m[34mMatch #[0m[33m1110[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1131 | [0m[35m        """[0m
[30;1m1132 | [0m[35m        port = self._server_parameters['port'][0m
[30;1m1133 | [0m[35m        tcp_local_address = self._get_tcp_local_address()[0m
[30;1m1134 | [0m[35m        netloc = self._config.get('connect_address') or tcp_local_address + ':' + port[0m
[30;1m1135 | [0m[35m[0m
[30;1m1136 | [0m[35m        unix_local_address = {'port': port}[0m
[30;1m1137 | [0m[35m        unix_socket_directories = self._server_parameters.get('unix_socket_directories')[0m

[31m--[ [0m[34mMatch #[0m[33m1111[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1083 | [0m[35m        self._postgresql.mpp_handler.adjust_postgres_gucs(parameters)[0m
[30;1m1084 | [0m[35m[0m
[30;1m1085 | [0m[35m        ret = CaseInsensitiveDict({k: v for k, v in parameters.items() if not self._postgresql.major[0m
[30;1m1086 | [0m[35m                                   or self._postgresql.major_version >= self.CMDLINE_OPTIONS.get(k, [0m
[30;1m1087 | [0m[35m        ret.update({k: os.path.join(self._config_dir, ret[k]) for k in ('hba_file', 'ident_file') if[0m
[30;1m1088 | [0m[35m        return ret[0m
[30;1m1089 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1112[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1067 | [0m[35m                parameters['synchronous_standby_names'] = synchronous_standby_names[0m
[30;1m1068 | [0m[35m[0m
[30;1m1069 | [0m[35m        # Handle hot_standby <-> replica rename[0m
[30;1m1070 | [0m[35m        if parameters.get('wal_level') == ('hot_standby' if self._postgresql.major_version >= 90600 [0m
[30;1m1071 | [0m[35m            parameters['wal_level'] = 'replica' if self._postgresql.major_version >= 90600 else 'hot[0m
[30;1m1072 | [0m[35m[0m
[30;1m1073 | [0m[35m        # Try to recalculate wal_keep_segments <-> wal_keep_size assuming that typical wal_segment_s[0m

[31m--[ [0m[34mMatch #[0m[33m1113[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1056 | [0m[35m        listen_addresses, port = split_host_port(config['listen'], 5432)[0m
[30;1m1057 | [0m[35m        parameters.update(cluster_name=self._postgresql.scope, listen_addresses=listen_addresses, po[0m
[30;1m1058 | [0m[35m        if global_config.is_synchronous_mode:[0m
[30;1m1059 | [0m[35m            synchronous_standby_names = self._server_parameters.get('synchronous_standby_names')[0m
[30;1m1060 | [0m[35m            if synchronous_standby_names is None:[0m
[30;1m1061 | [0m[35m                if global_config.is_synchronous_mode_strict\[0m
[30;1m1062 | [0m[35m                        and self._postgresql.role in ('primary', 'promoted'):[0m

[31m--[ [0m[34mMatch #[0m[33m1114[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1046 | [0m[35m        if recovery_conf:[0m
[30;1m1047 | [0m[35m            self._config['recovery_conf'] = recovery_conf[0m
[30;1m1048 | [0m[35m[0m
[30;1m1049 | [0m[35m        if self.get('recovery_conf'):[0m
[30;1m1050 | [0m[35m            value = self._config['recovery_conf'].pop(self._triggerfile_wrong_name, None)[0m
[30;1m1051 | [0m[35m            if self.triggerfile_good_name not in self._config['recovery_conf'] and value:[0m
[30;1m1052 | [0m[35m                self._config['recovery_conf'][self.triggerfile_good_name] = value[0m

[31m--[ [0m[34mMatch #[0m[33m1115[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m965 | [0m[35m                     (record.get('host', '') or '*').split(',')))]  # pyright: ignore [reportUnknown[0m
[30;1m966 | [0m[35m            if any(host.startswith('/') for host in hosts) and 'localhost' not in hosts:[0m
[30;1m967 | [0m[35m                hosts.append('localhost')[0m
[30;1m968 | [0m[35m            record = {n: escape(record.get(n) or '*') for n in ('port', 'user', 'password')}[0m
[30;1m969 | [0m[35m            return ''.join('{host}:{port}:*:{user}:{password}\n'.format(**record, host=host) for hos[0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m    def write_pgpass(self, record: Dict[str, Any]) -> Dict[str, str]:[0m

[31m--[ [0m[34mMatch #[0m[33m1116[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m962 | [0m[35m[0m
[30;1m963 | [0m[35m            # 'host' could be several comma-separated hostnames, in this case we need to write on pg[0m
[30;1m964 | [0m[35m            hosts = [escape(host) for host in filter(None, map(str.strip,[0m
[30;1m965 | [0m[35m                     (record.get('host', '') or '*').split(',')))]  # pyright: ignore [reportUnknown[0m
[30;1m966 | [0m[35m            if any(host.startswith('/') for host in hosts) and 'localhost' not in hosts:[0m
[30;1m967 | [0m[35m                hosts.append('localhost')[0m
[30;1m968 | [0m[35m            record = {n: escape(record.get(n) or '*') for n in ('port', 'user', 'password')}[0m

[31m--[ [0m[34mMatch #[0m[33m1117[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m937 | [0m[35m                if not self._check_primary_conninfo(value[0], wanted_recovery_params.get('primary_co[0m
[30;1m938 | [0m[35m                    record_mismatch(value[1])[0m
[30;1m939 | [0m[35m            elif (param != 'primary_slot_name' or wanted_recovery_params.get('primary_conninfo')) \[0m
[30;1m940 | [0m[35m                    and str(value[0]) != str(wanted_recovery_params.get(param, '')):[0m
[30;1m941 | [0m[35m                record_mismatch(value[1])[0m
[30;1m942 | [0m[35m        return required['restart'] + required['reload'] > 0, required['restart'] > 0[0m
[30;1m943 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1118[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m936 | [0m[35m            elif param == 'primary_conninfo':[0m
[30;1m937 | [0m[35m                if not self._check_primary_conninfo(value[0], wanted_recovery_params.get('primary_co[0m
[30;1m938 | [0m[35m                    record_mismatch(value[1])[0m
[30;1m939 | [0m[35m            elif (param != 'primary_slot_name' or wanted_recovery_params.get('primary_conninfo')) \[0m
[30;1m940 | [0m[35m                    and str(value[0]) != str(wanted_recovery_params.get(param, '')):[0m
[30;1m941 | [0m[35m                record_mismatch(value[1])[0m
[30;1m942 | [0m[35m        return required['restart'] + required['reload'] > 0, required['restart'] > 0[0m

[31m--[ [0m[34mMatch #[0m[33m1119[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m934 | [0m[35m                if not compare_values('bool', None, value[0], wanted_recovery_params.get(param, 'on'[0m
[30;1m935 | [0m[35m                    record_mismatch(value[1])[0m
[30;1m936 | [0m[35m            elif param == 'primary_conninfo':[0m
[30;1m937 | [0m[35m                if not self._check_primary_conninfo(value[0], wanted_recovery_params.get('primary_co[0m
[30;1m938 | [0m[35m                    record_mismatch(value[1])[0m
[30;1m939 | [0m[35m            elif (param != 'primary_slot_name' or wanted_recovery_params.get('primary_conninfo')) \[0m
[30;1m940 | [0m[35m                    and str(value[0]) != str(wanted_recovery_params.get(param, '')):[0m

[31m--[ [0m[34mMatch #[0m[33m1120[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m931 | [0m[35m                if not compare_values('integer', 'ms', value[0], wanted_recovery_params.get(param, 0[0m
[30;1m932 | [0m[35m                    record_mismatch(value[1])[0m
[30;1m933 | [0m[35m            elif param == 'standby_mode':[0m
[30;1m934 | [0m[35m                if not compare_values('bool', None, value[0], wanted_recovery_params.get(param, 'on'[0m
[30;1m935 | [0m[35m                    record_mismatch(value[1])[0m
[30;1m936 | [0m[35m            elif param == 'primary_conninfo':[0m
[30;1m937 | [0m[35m                if not self._check_primary_conninfo(value[0], wanted_recovery_params.get('primary_co[0m

[31m--[ [0m[34mMatch #[0m[33m1121[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m928 | [0m[35m                              'recovery_min_apply_delay', 'restore_command') and param not in wanted[0m
[30;1m929 | [0m[35m                continue[0m
[30;1m930 | [0m[35m            if param == 'recovery_min_apply_delay':[0m
[30;1m931 | [0m[35m                if not compare_values('integer', 'ms', value[0], wanted_recovery_params.get(param, 0[0m
[30;1m932 | [0m[35m                    record_mismatch(value[1])[0m
[30;1m933 | [0m[35m            elif param == 'standby_mode':[0m
[30;1m934 | [0m[35m                if not compare_values('bool', None, value[0], wanted_recovery_params.get(param, 'on'[0m

[31m--[ [0m[34mMatch #[0m[33m1122[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m866 | [0m[35m            else:[0m
[30;1m867 | [0m[35m                return False[0m
[30;1m868 | [0m[35m[0m
[30;1m869 | [0m[35m        return all(str(primary_conninfo.get(p)) == str(v) for p, v in wanted_primary_conninfo.items([0m
[30;1m870 | [0m[35m[0m
[30;1m871 | [0m[35m    def check_recovery_conf(self, member: Union[Leader, Member, None]) -> Tuple[bool, bool]:[0m
[30;1m872 | [0m[35m        """Returns a tuple. The first boolean element indicates that recovery params don't match[0m

[31m--[ [0m[34mMatch #[0m[33m1123[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m850 | [0m[35m                if wal_receiver_primary_conninfo:[0m
[30;1m851 | [0m[35m                    # dbname in pg_stat_wal_receiver is always `replication`, we need to use a "real[0m
[30;1m852 | [0m[35m                    wal_receiver_primary_conninfo.pop('dbname', None)[0m
[30;1m853 | [0m[35m                    dbname = primary_conninfo.get('dbname')[0m
[30;1m854 | [0m[35m                    if dbname:[0m
[30;1m855 | [0m[35m                        wal_receiver_primary_conninfo['dbname'] = dbname[0m
[30;1m856 | [0m[35m                    primary_conninfo = wal_receiver_primary_conninfo[0m

[31m--[ [0m[34mMatch #[0m[33m1124[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m712 | [0m[35m        # standby_cluster config might have different parameters, we want to override them[0m
[30;1m713 | [0m[35m        standby_cluster_params = ['restore_command', 'archive_cleanup_command']\[0m
[30;1m714 | [0m[35m            + (['recovery_min_apply_delay'] if is_remote_member else [])[0m
[30;1m715 | [0m[35m        recovery_params.update({p: member.data.get(p) for p in standby_cluster_params if member and [0m
[30;1m716 | [0m[35m        return recovery_params[0m
[30;1m717 | [0m[35m[0m
[30;1m718 | [0m[35m    def recovery_conf_exists(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1125[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m712 | [0m[35m        # standby_cluster config might have different parameters, we want to override them[0m
[30;1m713 | [0m[35m        standby_cluster_params = ['restore_command', 'archive_cleanup_command']\[0m
[30;1m714 | [0m[35m            + (['recovery_min_apply_delay'] if is_remote_member else [])[0m
[30;1m715 | [0m[35m        recovery_params.update({p: member.data.get(p) for p in standby_cluster_params if member and [0m
[30;1m716 | [0m[35m        return recovery_params[0m
[30;1m717 | [0m[35m[0m
[30;1m718 | [0m[35m    def recovery_conf_exists(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1126[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m685 | [0m[35m[0m
[30;1m686 | [0m[35m    def build_recovery_params(self, member: Union[Leader, Member, None]) -> CaseInsensitiveDict:[0m
[30;1m687 | [0m[35m        default: Dict[str, Any] = {}[0m
[30;1m688 | [0m[35m        recovery_params = CaseInsensitiveDict({p: v for p, v in (self.get('recovery_conf') or defaul[0m
[30;1m689 | [0m[35m                                               if not p.lower().startswith('recovery_target')[0m
[30;1m690 | [0m[35m                                               and p.lower() not in ('primary_conninfo', 'primary_sl[0m
[30;1m691 | [0m[35m        recovery_params.update({'standby_mode': 'on', 'recovery_target_timeline': 'latest'})[0m

[31m--[ [0m[34mMatch #[0m[33m1127[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m660 | [0m[35m        key_ver = {'target_session_attrs': 100000, 'gssencmode': 120000, 'channel_binding': 130000,[0m
[30;1m661 | [0m[35m                   'sslpassword': 130000, 'sslcrldir': 140000, 'sslnegotiation': 170000}[0m
[30;1m662 | [0m[35m        return ' '.join('{0}={1}'.format(kw, escape(params[kw])) for kw in keywords[0m
[30;1m663 | [0m[35m                        if params.get(kw) is not None and self._postgresql.major_version >= key_ver.[0m
[30;1m664 | [0m[35m[0m
[30;1m665 | [0m[35m    def _write_recovery_params(self, fd: ConfigWriter, recovery_params: CaseInsensitiveDict) -> None[0m
[30;1m666 | [0m[35m        if self._postgresql.major_version >= 90500:[0m

[31m--[ [0m[34mMatch #[0m[33m1128[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m660 | [0m[35m        key_ver = {'target_session_attrs': 100000, 'gssencmode': 120000, 'channel_binding': 130000,[0m
[30;1m661 | [0m[35m                   'sslpassword': 130000, 'sslcrldir': 140000, 'sslnegotiation': 170000}[0m
[30;1m662 | [0m[35m        return ' '.join('{0}={1}'.format(kw, escape(params[kw])) for kw in keywords[0m
[30;1m663 | [0m[35m                        if params.get(kw) is not None and self._postgresql.major_version >= key_ver.[0m
[30;1m664 | [0m[35m[0m
[30;1m665 | [0m[35m    def _write_recovery_params(self, fd: ConfigWriter, recovery_params: CaseInsensitiveDict) -> None[0m
[30;1m666 | [0m[35m        if self._postgresql.major_version >= 90500:[0m

[31m--[ [0m[34mMatch #[0m[33m1129[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m649 | [0m[35m        :returns: a connection string in a format "key1=value2 key2=value2"[0m
[30;1m650 | [0m[35m        """[0m
[30;1m651 | [0m[35m        # A list of keywords that can be found in a conninfo string. Follows what is acceptable by l[0m
[30;1m652 | [0m[35m        keywords = ('dbname', 'user', 'passfile' if params.get('passfile') else 'password', 'host', [0m
[30;1m653 | [0m[35m                    'sslmode', 'sslcompression', 'sslcert', 'sslkey', 'sslpassword', 'sslrootcert', [0m
[30;1m654 | [0m[35m                    'sslcrldir', 'application_name', 'krbsrvname', 'gssencmode', 'channel_binding',[0m
[30;1m655 | [0m[35m                    'target_session_attrs', 'sslnegotiation')[0m

[31m--[ [0m[34mMatch #[0m[33m1130[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m            ret.setdefault('sslnegotiation', 'postgres')[0m
[30;1m635 | [0m[35m        if self._krbsrvname:[0m
[30;1m636 | [0m[35m            ret['krbsrvname'] = self._krbsrvname[0m
[30;1m637 | [0m[35m        if not ret.get('dbname'):[0m
[30;1m638 | [0m[35m            ret['dbname'] = self._postgresql.database[0m
[30;1m639 | [0m[35m        return ret[0m
[30;1m640 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1131[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m615 | [0m[35m        :returns: True if pg_ident.conf was rewritten.[0m
[30;1m616 | [0m[35m        """[0m
[30;1m617 | [0m[35m[0m
[30;1m618 | [0m[35m        if not self.ident_file and self._config.get('pg_ident'):[0m
[30;1m619 | [0m[35m            with self.config_writer(self._pg_ident_conf) as f:[0m
[30;1m620 | [0m[35m                f.writelines(self._config['pg_ident'])[0m
[30;1m621 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m1132[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m                        '{0}\treplication\t{1}\t{3}\ttrust\n'[0m
[30;1m603 | [0m[35m                        '{0}\tall\t{2}\t{3}\ttrust'[0m
[30;1m604 | [0m[35m                    ).format(t, self.replication['username'], self._superuser.get('username') or 'al[0m
[30;1m605 | [0m[35m        elif not self.hba_file and self._config.get('pg_hba'):[0m
[30;1m606 | [0m[35m            with self.config_writer(self._pg_hba_conf) as f:[0m
[30;1m607 | [0m[35m                f.writelines(self._config['pg_hba'])[0m
[30;1m608 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m1133[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m                    f.writeline(([0m
[30;1m602 | [0m[35m                        '{0}\treplication\t{1}\t{3}\ttrust\n'[0m
[30;1m603 | [0m[35m                        '{0}\tall\t{2}\t{3}\ttrust'[0m
[30;1m604 | [0m[35m                    ).format(t, self.replication['username'], self._superuser.get('username') or 'al[0m
[30;1m605 | [0m[35m        elif not self.hba_file and self._config.get('pg_hba'):[0m
[30;1m606 | [0m[35m            with self.config_writer(self._pg_hba_conf) as f:[0m
[30;1m607 | [0m[35m                f.writelines(self._config['pg_hba'])[0m

[31m--[ [0m[34mMatch #[0m[33m1134[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m572 | [0m[35m                    self._sanitize_auto_conf()[0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m    def append_pg_hba(self, config: List[str]) -> bool:[0m
[30;1m575 | [0m[35m        if not self.hba_file and not self._config.get('pg_hba'):[0m
[30;1m576 | [0m[35m            with open(self._pg_hba_conf, 'a') as f:[0m
[30;1m577 | [0m[35m                f.write('\n{}\n'.format('\n'.join(config)))[0m
[30;1m578 | [0m[35m            self.set_file_permissions(self._pg_hba_conf)[0m

[31m--[ [0m[34mMatch #[0m[33m1135[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m            configuration['hot_standby_feedback'] = 'on'[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m        with self.config_writer(self._postgresql_conf) as f:[0m
[30;1m549 | [0m[35m            include = self._config.get('custom_conf') or self._postgresql_base_conf_name[0m
[30;1m550 | [0m[35m            f.writeline("include '{0}'\n".format(ConfigWriter.escape(include)))[0m
[30;1m551 | [0m[35m            version = self.pg_version[0m
[30;1m552 | [0m[35m            for name, value in sorted((configuration).items()):[0m

[31m--[ [0m[34mMatch #[0m[33m1136[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m        self._standby_signal = os.path.join(postgresql.data_dir, 'standby.signal')[0m
[30;1m389 | [0m[35m        self._auto_conf = os.path.join(postgresql.data_dir, 'postgresql.auto.conf')[0m
[30;1m390 | [0m[35m        self._auto_conf_mtime = None[0m
[30;1m391 | [0m[35m        self._pgpass = os.path.abspath(config.get('pgpass') or os.path.join(os.path.expanduser('~'),[0m
[30;1m392 | [0m[35m        if os.path.exists(self._pgpass) and not os.path.isfile(self._pgpass):[0m
[30;1m393 | [0m[35m            raise PatroniFatalException("'{0}' exists and it's not a file, check your `postgresql.pg[0m
[30;1m394 | [0m[35m                                        .format(self._pgpass))[0m

[31m--[ [0m[34mMatch #[0m[33m1137[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m    def __init__(self, postgresql: 'Postgresql', config: Dict[str, Any]) -> None:[0m
[30;1m376 | [0m[35m        self._postgresql = postgresql[0m
[30;1m377 | [0m[35m        self._config_dir = os.path.abspath(config.get('config_dir', '') or postgresql.data_dir)[0m
[30;1m378 | [0m[35m        config_base_name = config.get('config_base_name', 'postgresql')[0m
[30;1m379 | [0m[35m        self._postgresql_conf = os.path.join(self._config_dir, config_base_name + '.conf')[0m
[30;1m380 | [0m[35m        self._postgresql_conf_mtime = None[0m
[30;1m381 | [0m[35m        self._postgresql_base_conf_name = config_base_name + '.base.conf'[0m

[31m--[ [0m[34mMatch #[0m[33m1138[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35m    def __init__(self, postgresql: 'Postgresql', config: Dict[str, Any]) -> None:[0m
[30;1m376 | [0m[35m        self._postgresql = postgresql[0m
[30;1m377 | [0m[35m        self._config_dir = os.path.abspath(config.get('config_dir', '') or postgresql.data_dir)[0m
[30;1m378 | [0m[35m        config_base_name = config.get('config_base_name', 'postgresql')[0m
[30;1m379 | [0m[35m        self._postgresql_conf = os.path.join(self._config_dir, config_base_name + '.conf')[0m
[30;1m380 | [0m[35m        self._postgresql_conf_mtime = None[0m

[31m--[ [0m[34mMatch #[0m[33m1139[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m        ret['port'] = ','.join(ports)[0m
[30;1m70 | [0m[35m    ret = {name: unquote(value) for name, value in ret.items()}[0m
[30;1m71 | [0m[35m    ret.update({name: value for name, value in parse_qsl(r.query)})[0m
[30;1m72 | [0m[35m    if ret.get('ssl') == 'true':[0m
[30;1m73 | [0m[35m        del ret['ssl'][0m
[30;1m74 | [0m[35m        ret['sslmode'] = 'require'[0m
[30;1m75 | [0m[35m    return ret[0m

[31m--[ [0m[34mMatch #[0m[33m1140[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m739 | [0m[35m[0m
[30;1m740 | [0m[35m        .. note::[0m
[30;1m741 | [0m[35m            We query Postgres only if we detected that Postgresql was restarted[0m
[30;1m742 | [0m[35m            or when at least one of the following files was updated:[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m                * ``postgresql.conf``;[0m
[30;1m745 | [0m[35m                * ``postgresql.auto.conf``;[0m

[31m--[ [0m[34mMatch #[0m[33m1141[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m413 | [0m[35mserver_parameters.pop(k) for k in self._RECOVERY_PARAMETERS[0m
[30;1m414 | [0m[35m                                               if k in server_parameters})[0m
[30;1m415 | [0m[35m        # We also want to load current settings of recovery parameters, including primary_conninfo[0m
[30;1m416 | [0m[35m        # and primary_slot_name, otherwise patronictl restart will update postgresql.conf[0m
[30;1m417 | [0m[35m        # and remove them, what in the worst case will cause another restart.[0m
[30;1m418 | [0m[35m        # We are doing it only for PostgreSQL v12 onwards, because older version still have recovery[0m
[30;1m419 | [0m[35m        if not self._postgresql.is_primary() and self._postgresql.major_version >= 120000:[0m

[31m--[ [0m[34mMatch #[0m[33m1142[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m872 | [0m[35m        """Returns a tuple. The first boolean element indicates that recovery params don't match[0m
[30;1m873 | [0m[35m           and the second is set to `True` if the restart is required in order to apply new values""[0m
[30;1m874 | [0m[35m[0m
[30;1m875 | [0m[35m        # TODO: recovery.conf could be stale, would be nice to detect that.[0m
[30;1m876 | [0m[35m        if self._postgresql.major_version >= 120000:[0m
[30;1m877 | [0m[35m            if not os.path.exists(self._standby_signal):[0m
[30;1m878 | [0m[35m                return True, True[0m

[31m--[ [0m[34mMatch #[0m[33m1143[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m778 | [0m[35m                    self._auto_conf_mtime == auto_conf_mtime,[0m
[30;1m779 | [0m[35m                    self._passfile_mtime == passfile_mtime,[0m
[30;1m780 | [0m[35m                    self._postmaster_ctime != postmaster_ctime)):[0m
[30;1m781 | [0m[35m                # We detected that the connection to postgres fails, but the process creation time o[0m
[30;1m782 | [0m[35m                # doesn't match the old value. It is an indicator that Postgres crashed and either d[0m
[30;1m783 | [0m[35m                # recovery or down. In this case we return values like nothing changed in the config[0m
[30;1m784 | [0m[35m                return None, False[0m

[31m--[ [0m[34mMatch #[0m[33m1144[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35mdef get_param_diff(old_value: Any, new_value: Any,[0m
[30;1m317 | [0m[35m                   vartype: Optional[str] = None, unit: Optional[str] = None) -> Dict[str, str]:[0m
[30;1m318 | [0m[35m    """Get a dictionary representing a single PG parameter's value diff.[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    :param old_value: current :class:`str` parameter value.[0m
[30;1m321 | [0m[35m    :param new_value: :class:`str` value of the parameter after a restart.[0m

[31m--[ [0m[34mMatch #[0m[33m1145[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35mdef parse_dsn(value: str) -> Optional[Dict[str, str]]:[0m
[30;1m168 | [0m[35m    """[0m
[30;1m169 | [0m[35m    Compatibility layer on top of function from psycopg2/psycopg3, which parses connection strings.[0m
[30;1m170 | [0m[35m    In this function sets the `sslmode`, 'gssencmode', and `channel_binding` to `prefer`[0m
[30;1m171 | [0m[35m    and `sslnegotiation` to `postgres` if they are not present in the connection string.[0m
[30;1m172 | [0m[35m    This is necessary to simplify comparison of the old and the new values.[0m

[31m--[ [0m[34mMatch #[0m[33m1146[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport shutil[0m
[30;1m5 | [0m[35mimport socket[0m
[30;1m6 | [0m[35mimport stat[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m10 | [0m[35mfrom types import TracebackType[0m
[30;1m11 | [0m[35mfrom typing import Any, Callable, Collection, Dict, Iterator, List, Optional, Tuple, Type, TYPE_CHEC[0m

[31m--[ [0m[34mMatch #[0m[33m1147[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m709 | [0m[35m        sync = SyncState.from_node(sync and sync.modifiedIndex, sync and sync.value)[0m
[30;1m710 | [0m[35m[0m
[30;1m711 | [0m[35m        # get failsafe topology[0m
[30;1m712 | [0m[35m        failsafe = nodes.get(self._FAILSAFE)[0m
[30;1m713 | [0m[35m        try:[0m
[30;1m714 | [0m[35m            failsafe = json.loads(failsafe.value) if failsafe else None[0m
[30;1m715 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m1148[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m705 | [0m[35m            failover = Failover.from_node(failover.modifiedIndex, failover.value)[0m
[30;1m706 | [0m[35m[0m
[30;1m707 | [0m[35m        # get synchronization state[0m
[30;1m708 | [0m[35m        sync = nodes.get(self._SYNC)[0m
[30;1m709 | [0m[35m        sync = SyncState.from_node(sync and sync.modifiedIndex, sync and sync.value)[0m
[30;1m710 | [0m[35m[0m
[30;1m711 | [0m[35m        # get failsafe topology[0m

[31m--[ [0m[34mMatch #[0m[33m1149[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m700 | [0m[35m            leader = Leader(version, leader.ttl, member)[0m
[30;1m701 | [0m[35m[0m
[30;1m702 | [0m[35m        # failover key[0m
[30;1m703 | [0m[35m        failover = nodes.get(self._FAILOVER)[0m
[30;1m704 | [0m[35m        if failover:[0m
[30;1m705 | [0m[35m            failover = Failover.from_node(failover.modifiedIndex, failover.value)[0m
[30;1m706 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1150[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m692 | [0m[35m        members = [self.member(n) for k, n in nodes.items() if k.startswith(self._MEMBERS) and k.cou[0m
[30;1m693 | [0m[35m[0m
[30;1m694 | [0m[35m        # get leader[0m
[30;1m695 | [0m[35m        leader = nodes.get(self._LEADER)[0m
[30;1m696 | [0m[35m        if leader:[0m
[30;1m697 | [0m[35m            member = Member(-1, leader.value, None, {})[0m
[30;1m698 | [0m[35m            member = ([m for m in members if m.name == leader.value] or [member])[0][0m

[31m--[ [0m[34mMatch #[0m[33m1151[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m685 | [0m[35m        history = history and TimelineHistory.from_node(history.modifiedIndex, history.value)[0m
[30;1m686 | [0m[35m[0m
[30;1m687 | [0m[35m        # get last know leader lsn and slots[0m
[30;1m688 | [0m[35m        status = nodes.get(self._STATUS) or nodes.get(self._LEADER_OPTIME)[0m
[30;1m689 | [0m[35m        status = Status.from_node(status and status.value)[0m
[30;1m690 | [0m[35m[0m
[30;1m691 | [0m[35m        # get list of members[0m

[31m--[ [0m[34mMatch #[0m[33m1152[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m685 | [0m[35m        history = history and TimelineHistory.from_node(history.modifiedIndex, history.value)[0m
[30;1m686 | [0m[35m[0m
[30;1m687 | [0m[35m        # get last know leader lsn and slots[0m
[30;1m688 | [0m[35m        status = nodes.get(self._STATUS) or nodes.get(self._LEADER_OPTIME)[0m
[30;1m689 | [0m[35m        status = Status.from_node(status and status.value)[0m
[30;1m690 | [0m[35m[0m
[30;1m691 | [0m[35m        # get list of members[0m

[31m--[ [0m[34mMatch #[0m[33m1153[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m681 | [0m[35m        config = config and ClusterConfig.from_node(config.modifiedIndex, config.value)[0m
[30;1m682 | [0m[35m[0m
[30;1m683 | [0m[35m        # get timeline history[0m
[30;1m684 | [0m[35m        history = nodes.get(self._HISTORY)[0m
[30;1m685 | [0m[35m        history = history and TimelineHistory.from_node(history.modifiedIndex, history.value)[0m
[30;1m686 | [0m[35m[0m
[30;1m687 | [0m[35m        # get last know leader lsn and slots[0m

[31m--[ [0m[34mMatch #[0m[33m1154[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m677 | [0m[35m        initialize = initialize and initialize.value[0m
[30;1m678 | [0m[35m[0m
[30;1m679 | [0m[35m        # get global dynamic configuration[0m
[30;1m680 | [0m[35m        config = nodes.get(self._CONFIG)[0m
[30;1m681 | [0m[35m        config = config and ClusterConfig.from_node(config.modifiedIndex, config.value)[0m
[30;1m682 | [0m[35m[0m
[30;1m683 | [0m[35m        # get timeline history[0m

[31m--[ [0m[34mMatch #[0m[33m1155[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m673 | [0m[35m[0m
[30;1m674 | [0m[35m    def _cluster_from_nodes(self, etcd_index: int, nodes: Dict[str, etcd.EtcdResult]) -> Cluster:[0m
[30;1m675 | [0m[35m        # get initialize flag[0m
[30;1m676 | [0m[35m        initialize = nodes.get(self._INITIALIZE)[0m
[30;1m677 | [0m[35m        initialize = initialize and initialize.value[0m
[30;1m678 | [0m[35m[0m
[30;1m679 | [0m[35m        # get global dynamic configuration[0m

[31m--[ [0m[34mMatch #[0m[33m1156[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m576 | [0m[35m        if config.get('cacert'):[0m
[30;1m577 | [0m[35m            config['ca_cert'] = config.pop('cacert')[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m        if config.get('key') and config.get('cert'):[0m
[30;1m580 | [0m[35m            config['cert'] = (config['cert'], config['key'])[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m        for p in ('discovery_srv', 'srv_domain'):[0m

[31m--[ [0m[34mMatch #[0m[33m1157[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m576 | [0m[35m        if config.get('cacert'):[0m
[30;1m577 | [0m[35m            config['ca_cert'] = config.pop('cacert')[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m        if config.get('key') and config.get('cert'):[0m
[30;1m580 | [0m[35m            config['cert'] = (config['cert'], config['key'])[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m        for p in ('discovery_srv', 'srv_domain'):[0m

[31m--[ [0m[34mMatch #[0m[33m1158[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m573 | [0m[35m            if 'port' not in config:[0m
[30;1m574 | [0m[35m                config['port'] = int(port)[0m
[30;1m575 | [0m[35m[0m
[30;1m576 | [0m[35m        if config.get('cacert'):[0m
[30;1m577 | [0m[35m            config['ca_cert'] = config.pop('cacert')[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m        if config.get('key') and config.get('cert'):[0m

[31m--[ [0m[34mMatch #[0m[33m1159[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m557 | [0m[35m        elif 'hosts' in config:[0m
[30;1m558 | [0m[35m            hosts = config.pop('hosts')[0m
[30;1m559 | [0m[35m            default_port = config.pop('port', 2379)[0m
[30;1m560 | [0m[35m            protocol = config.get('protocol', 'http')[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m            if isinstance(hosts, str):[0m
[30;1m563 | [0m[35m                hosts = hosts.split(',')[0m

[31m--[ [0m[34mMatch #[0m[33m1160[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m    def reload_config(self, config: Union['Config', Dict[str, Any]]) -> None:[0m
[30;1m497 | [0m[35m        super(AbstractEtcd, self).reload_config(config)[0m
[30;1m498 | [0m[35m        self._client.reload_config(config.get(self.__class__.__name__.lower(), {}))[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m    def retry(self, method: Callable[..., Any], *args: Any, **kwargs: Any) -> Any:[0m
[30;1m501 | [0m[35m        retry = self._retry.copy()[0m

[31m--[ [0m[34mMatch #[0m[33m1161[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m        super(AbstractEtcd, self).__init__(config, mpp)[0m
[30;1m484 | [0m[35m        self._retry = Retry(deadline=config['retry_timeout'], max_delay=1, max_tries=-1,[0m
[30;1m485 | [0m[35m                            retry_exceptions=retry_errors_cls)[0m
[30;1m486 | [0m[35m        self._ttl = int(config.get('ttl') or 30)[0m
[30;1m487 | [0m[35m        self._abstract_client = self.get_etcd_client(config, client_cls)[0m
[30;1m488 | [0m[35m        self.__do_not_watch = False[0m
[30;1m489 | [0m[35m        self._has_failed = False[0m

[31m--[ [0m[34mMatch #[0m[33m1162[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m464 | [0m[35m        return self._prepare_common_parameters(etcd_nodes)[0m
[30;1m465 | [0m[35m[0m
[30;1m466 | [0m[35m    def _get_members(self, base_uri: str, **kwargs: Any) -> List[str]:[0m
[30;1m467 | [0m[35m        response = self.http.request(self._MGET, base_uri + self.version_prefix + '/machines', **kwa[0m
[30;1m468 | [0m[35m        data = self._handle_server_response(response).data.decode('utf-8')[0m
[30;1m469 | [0m[35m        return [m.strip() for m in data.split(',') if m.strip()][0m
[30;1m470 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1163[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m        machines_cache = [][0m
[30;1m366 | [0m[35m        if 'srv' in self._config:[0m
[30;1m367 | [0m[35m            machines_cache = self._get_machines_cache_from_srv(self._config['srv'], self._config.get[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m        if not machines_cache and 'hosts' in self._config:[0m
[30;1m370 | [0m[35m            machines_cache = list(self._config['hosts'])[0m

[31m--[ [0m[34mMatch #[0m[33m1164[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m                         request_executor: Callable[..., urllib3.response.HTTPResponse],[0m
[30;1m229 | [0m[35m                         method: str, path: str, fields: Optional[Dict[str, Any]] = None,[0m
[30;1m230 | [0m[35m                         **kwargs: Any) -> urllib3.response.HTTPResponse:[0m
[30;1m231 | [0m[35m        is_watch_request = isinstance(fields, dict) and fields.get('wait') == 'true'[0m
[30;1m232 | [0m[35m        if fields is not None:[0m
[30;1m233 | [0m[35m            kwargs['fields'] = fields[0m
[30;1m234 | [0m[35m        some_request_failed = False[0m

[31m--[ [0m[34mMatch #[0m[33m1165[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m
[30;1m150 | [0m[35m        self.username = config.get('username')[0m
[30;1m151 | [0m[35m        self.password = config.get('password')[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def _get_headers(self) -> Dict[str, str]:[0m
[30;1m154 | [0m[35m        basic_auth = ':'.join((self.username, self.password)) if self.username and self.password els[0m

[31m--[ [0m[34mMatch #[0m[33m1166[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        return etcd_nodes, per_node_timeout, per_node_retries - 1[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m
[30;1m150 | [0m[35m        self.username = config.get('username')[0m
[30;1m151 | [0m[35m        self.password = config.get('password')[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def _get_headers(self) -> Dict[str, str]:[0m

[31m--[ [0m[34mMatch #[0m[33m1167[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35mresolver[0m
[30;1m106 | [0m[35m        self.set_machines_cache_ttl(cache_ttl)[0m
[30;1m107 | [0m[35m        self._machines_cache_updated = 0[0m
[30;1m108 | [0m[35m        kwargs = {p: config.get(p) for p in ('host', 'port', 'protocol', 'use_proxies', 'version_pre[0m
[30;1m109 | [0m[35m                                             'username', 'password', 'cert', 'ca_cert') if config.ge[0m
[30;1m110 | [0m[35m        super(AbstractEtcdClientWithFailover, self).__init__(read_timeout=config['retry_timeout'], *[0m
[30;1m111 | [0m[35m        # For some reason python3-etcd on debian and ubuntu are not based on the latest version[0m

[31m--[ [0m[34mMatch #[0m[33m1168[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m        self._dns_resolver = dns_resolver[0m
[30;1m106 | [0m[35m        self.set_machines_cache_ttl(cache_ttl)[0m
[30;1m107 | [0m[35m        self._machines_cache_updated = 0[0m
[30;1m108 | [0m[35m        kwargs = {p: config.get(p) for p in ('host', 'port', 'protocol', 'use_proxies', 'version_pre[0m
[30;1m109 | [0m[35m                                             'username', 'password', 'cert', 'ca_cert') if config.ge[0m
[30;1m110 | [0m[35m        super(AbstractEtcdClientWithFailover, self).__init__(read_timeout=config['retry_timeout'], *[0m
[30;1m111 | [0m[35m        # For some reason python3-etcd on debian and ubuntu are not based on the latest version[0m

[31m--[ [0m[34mMatch #[0m[33m1169[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    def resolve(self, host: str, port: int) -> List[_AddrInfo]:[0m
[30;1m75 | [0m[35m        current_time = time.time()[0m
[30;1m76 | [0m[35m        cached_time, response = self._cache.get((host, port), (0, []))[0m
[30;1m77 | [0m[35m        time_passed = current_time - cached_time[0m
[30;1m78 | [0m[35m        if time_passed > self._cache_time or (not response and time_passed > self._cache_fail_time):[0m
[30;1m79 | [0m[35m            new_response = self._do_resolve(host, port)[0m

[31m--[ [0m[34mMatch #[0m[33m1170[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def run(self) -> None:[0m
[30;1m64 | [0m[35m        while True:[0m
[30;1m65 | [0m[35m            (host, port), attempt = self._resolve_queue.get()[0m
[30;1m66 | [0m[35m            response = self._do_resolve(host, port)[0m
[30;1m67 | [0m[35m            if response:[0m
[30;1m68 | [0m[35m                self._cache[(host, port)] = (time.time(), response)[0m

[31m--[ [0m[34mMatch #[0m[33m1171[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m.hostname[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m        if 'url' in config and isinstance(config['url'], str):[0m
[30;1m554 | [0m[35m            r = urlparse(config['url'])[0m
[30;1m555 | [0m[35m            config.update({'protocol': r.scheme, 'host': r.hostname, 'port': r.port or 2379,[0m
[30;1m556 | [0m[35m                           'username': r.username, 'password': r.password})[0m
[30;1m557 | [0m[35m        elif 'hosts' in config:[0m
[30;1m558 | [0m[35m            hosts = config.pop('hosts')[0m

[31m--[ [0m[34mMatch #[0m[33m1172[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m.hostname[0m
[30;1m379 | [0m[35m            r = urlparse(url)[0m
[30;1m380 | [0m[35m            if r.hostname:[0m
[30;1m381 | [0m[35m                port = r.port or (443 if r.scheme == 'https' else 80)[0m
[30;1m382 | [0m[35m                func(r.hostname, port)[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35m    def _load_machines_cache(self) -> bool:[0m
[30;1m385 | [0m[35m        """This method should fill up `_machines_cache` from scratch.[0m

[31m--[ [0m[34mMatch #[0m[33m1173[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m.hostname[0m
[30;1m377 | [0m[35m    def _update_dns_cache(func: Callable[[str, int], None], machines: List[str]) -> None:[0m
[30;1m378 | [0m[35m        for url in machines:[0m
[30;1m379 | [0m[35m            r = urlparse(url)[0m
[30;1m380 | [0m[35m            if r.hostname:[0m
[30;1m381 | [0m[35m                port = r.port or (443 if r.scheme == 'https' else 80)[0m
[30;1m382 | [0m[35m                func(r.hostname, port)[0m
[30;1m383 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1174[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m429 | [0m[35m        if value:[0m
[30;1m430 | [0m[35m            ret = set(self._machines_cache) != set(value)[0m
[30;1m431 | [0m[35m            self._machines_cache = value[0m
[30;1m432 | [0m[35m        elif machines_cache:  # we are just starting or all nodes were not available at some point[0m
[30;1m433 | [0m[35m            raise etcd.EtcdException("Could not get the list of servers, "[0m
[30;1m434 | [0m[35m                                     "maybe you provided the wrong "[0m
[30;1m435 | [0m[35m                                     "host(s) to connect to?")[0m

[31m--[ [0m[34mMatch #[0m[33m1175[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m295 | [0m[35m                        machines_cache = self.machines_cache[0m
[30;1m296 | [0m[35m                        etcd_nodes = len(machines_cache)[0m
[30;1m297 | [0m[35m                except Exception as e:[0m
[30;1m298 | [0m[35m                    logger.debug('Failed to update list of etcd nodes: %r', e)[0m
[30;1m299 | [0m[35m                if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m300 | [0m[35m                    assert isinstance(retry, Retry)  # etcd.EtcdConnectionFailed is raised only if r[0m
[30;1m301 | [0m[35m                sleeptime = retry.sleeptime[0m

[31m--[ [0m[34mMatch #[0m[33m1176[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m271 | [0m[35m                    timeout: Optional[float] = None) -> Any:[0m
[30;1m272 | [0m[35m        retry = params.pop('retry', None) if isinstance(params, dict) else None[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m        # Update machines_cache if previous attempt of update has failed[0m
[30;1m275 | [0m[35m        if self._update_machines_cache:[0m
[30;1m276 | [0m[35m            self._load_machines_cache()[0m
[30;1m277 | [0m[35m        elif not self._use_proxies and time.time() - self._machines_cache_updated > self._machines_c[0m

[31m--[ [0m[34mMatch #[0m[33m1177[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m271 | [0m[35m                    timeout: Optional[float] = None) -> Any:[0m
[30;1m272 | [0m[35m        retry = params.pop('retry', None) if isinstance(params, dict) else None[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m        # Update machines_cache if previous attempt of update has failed[0m
[30;1m275 | [0m[35m        if self._update_machines_cache:[0m
[30;1m276 | [0m[35m            self._load_machines_cache()[0m
[30;1m277 | [0m[35m        elif not self._use_proxies and time.time() - self._machines_cache_updated > self._machines_c[0m

[31m--[ [0m[34mMatch #[0m[33m1178[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m248 | [0m[35m                    if len(machines_cache) == 1:[0m
[30;1m249 | [0m[35m                        self.set_base_uri(self._base_uri)  # trigger Etcd3 watcher restart[0m
[30;1m250 | [0m[35m                    # switch to the next etcd node because we don't know exactly what happened,[0m
[30;1m251 | [0m[35m                    # whether the key didn't received an update or there is a network problem.[0m
[30;1m252 | [0m[35m                    elif i + 1 < len(machines_cache):[0m
[30;1m253 | [0m[35m                        self.set_base_uri(machines_cache[i + 1])[0m
[30;1m254 | [0m[35m                if is_watch_request and isinstance(e, (ReadTimeoutError, ProtocolError)):[0m

[31m--[ [0m[34mMatch #[0m[33m1179[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m212 | [0m[35m        only when request failed on one of the etcd members during `api_execute` call.[0m
[30;1m213 | [0m[35m        For us it's more important to execute original request rather then get new topology[0m
[30;1m214 | [0m[35m        of etcd cluster. So we will catch this exception and return empty list of machines.[0m
[30;1m215 | [0m[35m        Later, during next `api_execute` call we will forcefully update machines_cache.[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m        Also this method implements the same timeout-retry logic as `api_execute`, because[0m
[30;1m218 | [0m[35m        the original method was retrying 2 times with the `read_timeout` on each node.[0m

[31m--[ [0m[34mMatch #[0m[33m1180[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m868 | [0m[35m                except etcd.EtcdException as e:[0m
[30;1m869 | [0m[35m                    self._handle_exception(e, 'watch', True)[0m
[30;1m870 | [0m[35m[0m
[30;1m871 | [0m[35m                timeout = end_time - time.time()[0m
[30;1m872 | [0m[35m[0m
[30;1m873 | [0m[35m        try:[0m
[30;1m874 | [0m[35m            return super(Etcd, self).watch(None, timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m1181[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m864 | [0m[35m                    return False[0m
[30;1m865 | [0m[35m                except (etcd.EtcdEventIndexCleared, etcd.EtcdWatcherCleared):  # Watch failed[0m
[30;1m866 | [0m[35m                    self._has_failed = False[0m
[30;1m867 | [0m[35m                    return True  # leave the loop, because watch with the same parameters will fail [0m
[30;1m868 | [0m[35m                except etcd.EtcdException as e:[0m
[30;1m869 | [0m[35m                    self._handle_exception(e, 'watch', True)[0m
[30;1m870 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1182[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m862 | [0m[35m                except etcd.EtcdWatchTimedOut:[0m
[30;1m863 | [0m[35m                    self._has_failed = False[0m
[30;1m864 | [0m[35m                    return False[0m
[30;1m865 | [0m[35m                except (etcd.EtcdEventIndexCleared, etcd.EtcdWatcherCleared):  # Watch failed[0m
[30;1m866 | [0m[35m                    self._has_failed = False[0m
[30;1m867 | [0m[35m                    return True  # leave the loop, because watch with the same parameters will fail [0m
[30;1m868 | [0m[35m                except etcd.EtcdException as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1183[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m857 | [0m[35m                    if result.action == 'compareAndSwap':[0m
[30;1m858 | [0m[35m                        time.sleep(0.01)[0m
[30;1m859 | [0m[35m                    # Synchronous work of all cluster members with etcd is less expensive[0m
[30;1m860 | [0m[35m                    # than reestablishing http connection every time from every replica.[0m
[30;1m861 | [0m[35m                    return True[0m
[30;1m862 | [0m[35m                except etcd.EtcdWatchTimedOut:[0m
[30;1m863 | [0m[35m                    self._has_failed = False[0m

[31m--[ [0m[34mMatch #[0m[33m1184[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m850 | [0m[35m        if leader_version:[0m
[30;1m851 | [0m[35m            end_time = time.time() + timeout[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m            while timeout >= 1:  # when timeout is too small urllib3 doesn't have enough time to con[0m
[30;1m854 | [0m[35m                try:[0m
[30;1m855 | [0m[35m                    result = self._client.watch(self.leader_path, index=leader_version, timeout=time[0m
[30;1m856 | [0m[35m                    self._has_failed = False[0m

[31m--[ [0m[34mMatch #[0m[33m1185[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m850 | [0m[35m        if leader_version:[0m
[30;1m851 | [0m[35m            end_time = time.time() + timeout[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m            while timeout >= 1:  # when timeout is too small urllib3 doesn't have enough time to con[0m
[30;1m854 | [0m[35m                try:[0m
[30;1m855 | [0m[35m                    result = self._client.watch(self.leader_path, index=leader_version, timeout=time[0m
[30;1m856 | [0m[35m                    self._has_failed = False[0m

[31m--[ [0m[34mMatch #[0m[33m1186[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m850 | [0m[35m        if leader_version:[0m
[30;1m851 | [0m[35m            end_time = time.time() + timeout[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m            while timeout >= 1:  # when timeout is too small urllib3 doesn't have enough time to con[0m
[30;1m854 | [0m[35m                try:[0m
[30;1m855 | [0m[35m                    result = self._client.watch(self.leader_path, index=leader_version, timeout=time[0m
[30;1m856 | [0m[35m                    self._has_failed = False[0m

[31m--[ [0m[34mMatch #[0m[33m1187[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m848 | [0m[35m            return True[0m
[30;1m849 | [0m[35m[0m
[30;1m850 | [0m[35m        if leader_version:[0m
[30;1m851 | [0m[35m            end_time = time.time() + timeout[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m            while timeout >= 1:  # when timeout is too small urllib3 doesn't have enough time to con[0m
[30;1m854 | [0m[35m                try:[0m
[30;1m855 | [0m[35m                    result = self._client.watch(self.leader_path, index=leader_version, timeout=time[0m

[31m--[ [0m[34mMatch #[0m[33m1188[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m747 | [0m[35m        for node in result.leaves:[0m
[30;1m748 | [0m[35m            key = node.key[len(result.key):].lstrip('/').split('/', 1)[0m
[30;1m749 | [0m[35m            if len(key) == 2 and self._mpp.group_re.match(key[0]):[0m
[30;1m750 | [0m[35m                clusters[int(key[0])][key[1]] = node[0m
[30;1m751 | [0m[35m        return {group: self._cluster_from_nodes(result.etcd_index, nodes) for group, nodes in cluste[0m
[30;1m752 | [0m[35m[0m
[30;1m753 | [0m[35m    def _load_cluster([0m
[30;1m754 | [0m[35m            self, path: str, loader: Callable[[str], Union[Cluster, Dict[int, Cluster]]][0m

[31m--[ [0m[34mMatch #[0m[33m1189[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m744 | [0m[35m            return {}[0m
[30;1m745 | [0m[35m[0m
[30;1m746 | [0m[35m        clusters: Dict[int, Dict[str, etcd.EtcdResult]] = defaultdict(dict)[0m
[30;1m747 | [0m[35m        for node in result.leaves:[0m
[30;1m748 | [0m[35m            key = node.key[len(result.key):].lstrip('/').split('/', 1)[0m
[30;1m749 | [0m[35m            if len(key) == 2 and self._mpp.group_re.match(key[0]):[0m
[30;1m750 | [0m[35m                clusters[int(key[0])][key[1]] = node[0m

[31m--[ [0m[34mMatch #[0m[33m1190[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m728 | [0m[35m            result = self.retry(self._client.read, path, recursive=True, quorum=self._ctl)[0m
[30;1m729 | [0m[35m        except etcd.EtcdKeyNotFound:[0m
[30;1m730 | [0m[35m            return Cluster.empty()[0m
[30;1m731 | [0m[35m        nodes = {node.key[len(result.key):].lstrip('/'): node for node in result.leaves}[0m
[30;1m732 | [0m[35m        return self._cluster_from_nodes(result.etcd_index, nodes)[0m
[30;1m733 | [0m[35m[0m
[30;1m734 | [0m[35m    def _mpp_cluster_loader(self, path: str) -> Dict[int, Cluster]:[0m

[31m--[ [0m[34mMatch #[0m[33m1191[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m728 | [0m[35m            result = self.retry(self._client.read, path, recursive=True, quorum=self._ctl)[0m
[30;1m729 | [0m[35m        except etcd.EtcdKeyNotFound:[0m
[30;1m730 | [0m[35m            return Cluster.empty()[0m
[30;1m731 | [0m[35m        nodes = {node.key[len(result.key):].lstrip('/'): node for node in result.leaves}[0m
[30;1m732 | [0m[35m        return self._cluster_from_nodes(result.etcd_index, nodes)[0m
[30;1m733 | [0m[35m[0m
[30;1m734 | [0m[35m    def _mpp_cluster_loader(self, path: str) -> Dict[int, Cluster]:[0m

[31m--[ [0m[34mMatch #[0m[33m1192[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m598 | [0m[35m                try:[0m
[30;1m599 | [0m[35m                    sock = socket.socket(af, socktype, proto)[0m
[30;1m600 | [0m[35m                    self.set_socket_options(sock, socket_options)[0m
[30;1m601 | [0m[35m                    if timeout is None or isinstance(timeout, (float, int)):[0m
[30;1m602 | [0m[35m                        sock.settimeout(timeout)[0m
[30;1m603 | [0m[35m                    if source_address:[0m
[30;1m604 | [0m[35m                        sock.bind(source_address)[0m

[31m--[ [0m[34mMatch #[0m[33m1193[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m349 | [0m[35m        return list(set(ret))[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    def _get_machines_cache_from_dns(self, host: str, port: int) -> List[str]:[0m
[30;1m352 | [0m[35m        """One host might be resolved into multiple ip addresses. We will make list out of it"""[0m
[30;1m353 | [0m[35m        if self.protocol == 'http':[0m
[30;1m354 | [0m[35m            # Filter out unexpected results when python is compiled with --disable-ipv6 and running [0m
[30;1m355 | [0m[35m            ret = [uri(self.protocol, (res[4][0], res[4][1])) for res in self._dns_resolver.resolve([0m

[31m--[ [0m[34mMatch #[0m[33m1194[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m                retry.sleep_func(sleeptime)[0m
[30;1m309 | [0m[35m                retry.update_delay()[0m
[30;1m310 | [0m[35m                # We still have some time left. Partially reduce `machines_cache` and retry request[0m
[30;1m311 | [0m[35m                kwargs.update(timeout=Timeout(connect=max(1.0, timeout / 2.0), total=timeout), retri[0m
[30;1m312 | [0m[35m                machines_cache = machines_cache[:nodes][0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m1195[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m                    raise ex[0m
[30;1m308 | [0m[35m                retry.sleep_func(sleeptime)[0m
[30;1m309 | [0m[35m                retry.update_delay()[0m
[30;1m310 | [0m[35m                # We still have some time left. Partially reduce `machines_cache` and retry request[0m
[30;1m311 | [0m[35m                kwargs.update(timeout=Timeout(connect=max(1.0, timeout / 2.0), total=timeout), retri[0m
[30;1m312 | [0m[35m                machines_cache = machines_cache[:nodes][0m
[30;1m313 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1196[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m                if not retry:[0m
[30;1m248 | [0m[35m                    if len(machines_cache) == 1:[0m
[30;1m249 | [0m[35m                        self.set_base_uri(self._base_uri)  # trigger Etcd3 watcher restart[0m
[30;1m250 | [0m[35m                    # switch to the next etcd node because we don't know exactly what happened,[0m
[30;1m251 | [0m[35m                    # whether the key didn't received an update or there is a network problem.[0m
[30;1m252 | [0m[35m                    elif i + 1 < len(machines_cache):[0m
[30;1m253 | [0m[35m                        self.set_base_uri(machines_cache[i + 1])[0m

[31m--[ [0m[34mMatch #[0m[33m1197[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m        return self._get_machines_list(self.machines_cache)[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    def set_read_timeout(self, timeout: float) -> None:[0m
[30;1m225 | [0m[35m        self._read_timeout = timeout[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    def _do_http_request(self, retry: Optional[Retry], machines_cache: List[str],[0m
[30;1m228 | [0m[35m                         request_executor: Callable[..., urllib3.response.HTTPResponse],[0m
[30;1m229 | [0m[35m                         method: str, path: str, fields: Optional[Dict[str, Any]] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m1198[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m        kwargs: Dict[str, Any] = {'headers': self._get_headers(),[0m
[30;1m159 | [0m[35m                                  'redirect': self.allow_redirect, 'preload_content': False}[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        if timeout is not None:[0m
[30;1m162 | [0m[35m            kwargs.update(retries=0, timeout=timeout)[0m
[30;1m163 | [0m[35m        else:[0m
[30;1m164 | [0m[35m            _, per_node_timeout, per_node_retries = self._calculate_timeouts(etcd_nodes)[0m

[31m--[ [0m[34mMatch #[0m[33m1199[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m                    per_node_retries += 1[0m
[30;1m141 | [0m[35m                per_node_timeout /= per_node_retries[0m
[30;1m142 | [0m[35m                break[0m
[30;1m143 | [0m[35m            # if the timeout per one node is to small try to reduce number of nodes[0m
[30;1m144 | [0m[35m            etcd_nodes -= 1[0m
[30;1m145 | [0m[35m            max_retries = 1[0m
[30;1m146 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1200[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m                    per_node_retries += 1[0m
[30;1m141 | [0m[35m                per_node_timeout /= per_node_retries[0m
[30;1m142 | [0m[35m                break[0m
[30;1m143 | [0m[35m            # if the timeout per one node is to small try to reduce number of nodes[0m
[30;1m144 | [0m[35m            etcd_nodes -= 1[0m
[30;1m145 | [0m[35m            max_retries = 1[0m
[30;1m146 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1201[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m        while etcd_nodes > 0:[0m
[30;1m136 | [0m[35m            per_node_timeout = float(timeout) / etcd_nodes[0m
[30;1m137 | [0m[35m            if per_node_timeout >= min_timeout:[0m
[30;1m138 | [0m[35m                # for small clusters we will try to do more than on try on every node[0m
[30;1m139 | [0m[35m                while per_node_retries < max_retries and per_node_timeout / (per_node_retries + 1) >[0m
[30;1m140 | [0m[35m                    per_node_retries += 1[0m
[30;1m141 | [0m[35m                per_node_timeout /= per_node_retries[0m
[30;1m142 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m1202[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m        For clusters with 2 nodes we will try to do 1 retry for every node.[0m
[30;1m127 | [0m[35m        No retries for clusters with 3 or more nodes. We better rely on switching to a different nod[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        per_node_timeout = timeout = float(timeout or self.read_timeout)[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        max_retries = 4 - min(etcd_nodes, 3)[0m
[30;1m132 | [0m[35m        per_node_retries = 1[0m

[31m--[ [0m[34mMatch #[0m[33m1203[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m    def _calculate_timeouts(self, etcd_nodes: int, timeout: Optional[float] = None) -> Tuple[int, fl[0m
[30;1m123 | [0m[35m        """Calculate a request timeout and number of retries per single etcd node.[0m
[30;1m124 | [0m[35m        In case if the timeout per node is too small (less than one second) we will reduce the numbe[0m
[30;1m125 | [0m[35m        For the cluster with only one node we will try to do 2 retries.[0m
[30;1m126 | [0m[35m        For clusters with 2 nodes we will try to do 1 retry for every node.[0m
[30;1m127 | [0m[35m        No retries for clusters with 3 or more nodes. We better rely on switching to a different nod[0m
[30;1m128 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1204[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def _calculate_timeouts(self, etcd_nodes: int, timeout: Optional[float] = None) -> Tuple[int, fl[0m
[30;1m123 | [0m[35m        """Calculate a request timeout and number of retries per single etcd node.[0m
[30;1m124 | [0m[35m        In case if the timeout per node is too small (less than one second) we will reduce the numbe[0m
[30;1m125 | [0m[35m        For the cluster with only one node we will try to do 2 retries.[0m
[30;1m126 | [0m[35m        For clusters with 2 nodes we will try to do 1 retry for every node.[0m
[30;1m127 | [0m[35m        No retries for clusters with 3 or more nodes. We better rely on switching to a different nod[0m

[31m--[ [0m[34mMatch #[0m[33m1205[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def _calculate_timeouts(self, etcd_nodes: int, timeout: Optional[float] = None) -> Tuple[int, fl[0m
[30;1m123 | [0m[35m        """Calculate a request timeout and number of retries per single etcd node.[0m
[30;1m124 | [0m[35m        In case if the timeout per node is too small (less than one second) we will reduce the numbe[0m
[30;1m125 | [0m[35m        For the cluster with only one node we will try to do 2 retries.[0m
[30;1m126 | [0m[35m        For clusters with 2 nodes we will try to do 1 retry for every node.[0m
[30;1m127 | [0m[35m        No retries for clusters with 3 or more nodes. We better rely on switching to a different nod[0m

[31m--[ [0m[34mMatch #[0m[33m1206[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m        self._del_conditions.add('retry')[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def _calculate_timeouts(self, etcd_nodes: int, timeout: Optional[float] = None) -> Tuple[int, fl[0m
[30;1m123 | [0m[35m        """Calculate a request timeout and number of retries per single etcd node.[0m
[30;1m124 | [0m[35m        In case if the timeout per node is too small (less than one second) we will reduce the numbe[0m
[30;1m125 | [0m[35m        For the cluster with only one node we will try to do 2 retries.[0m
[30;1m126 | [0m[35m        For clusters with 2 nodes we will try to do 1 retry for every node.[0m

[31m--[ [0m[34mMatch #[0m[33m1207[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mfrom dns import resolver[0m
[30;1m23 | [0m[35mfrom dns.exception import DNSException[0m
[30;1m24 | [0m[35mfrom urllib3 import Timeout[0m
[30;1m25 | [0m[35mfrom urllib3.exceptions import HTTPError, ProtocolError, ReadTimeoutError[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mfrom ..exceptions import DCSError[0m
[30;1m28 | [0m[35mfrom ..postgresql.mpp import AbstractMPP[0m

[31m--[ [0m[34mMatch #[0m[33m1208[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport random[0m
[30;1m8 | [0m[35mimport socket[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom collections import defaultdict[0m
[30;1m12 | [0m[35mfrom copy import deepcopy[0m
[30;1m13 | [0m[35mfrom http.client import HTTPException[0m

[31m--[ [0m[34mMatch #[0m[33m1209[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m704 | [0m[35m            end_time = time.time() + timeout[0m
[30;1m705 | [0m[35m            while timeout >= 1:[0m
[30;1m706 | [0m[35m                try:[0m
[30;1m707 | [0m[35m                    idx, _ = self._client.kv.get(self.leader_path, index=leader_version, wait=str(ti[0m
[30;1m708 | [0m[35m                    return str(idx) != str(leader_version)[0m
[30;1m709 | [0m[35m                except (ConsulException, HTTPException, HTTPError, socket.error, socket.timeout):[0m
[30;1m710 | [0m[35m                    logger.exception('watch')[0m

[31m--[ [0m[34mMatch #[0m[33m1210[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m686 | [0m[35m            if not retry.ensure_deadline(0.5):[0m
[30;1m687 | [0m[35m                return False[0m
[30;1m688 | [0m[35m            _, ret = self.retry(self._client.kv.get, self.sync_path, consistency='consistent')[0m
[30;1m689 | [0m[35m            if ret and (ret.get('Value') or b'').decode('utf-8') == value:[0m
[30;1m690 | [0m[35m                return ret['ModifyIndex'][0m
[30;1m691 | [0m[35m        return False[0m
[30;1m692 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1211[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m566 | [0m[35m            if key not in new_data:[0m
[30;1m567 | [0m[35m                logger.warning('Could not register service: not enough params in member data')[0m
[30;1m568 | [0m[35m                return[0m
[30;1m569 | [0m[35m            if old_data.get(key) != new_data[key]:[0m
[30;1m570 | [0m[35m                update = True[0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m        if ([0m

[31m--[ [0m[34mMatch #[0m[33m1212[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m412 | [0m[35m        sync = SyncState.from_node(sync and sync['ModifyIndex'], sync and sync['Value'])[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m        # get failsafe topology[0m
[30;1m415 | [0m[35m        failsafe = nodes.get(self._FAILSAFE)[0m
[30;1m416 | [0m[35m        try:[0m
[30;1m417 | [0m[35m            failsafe = json.loads(failsafe['Value']) if failsafe else None[0m
[30;1m418 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m1213[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m            failover = Failover.from_node(failover['ModifyIndex'], failover['Value'])[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m        # get synchronization state[0m
[30;1m411 | [0m[35m        sync = nodes.get(self._SYNC)[0m
[30;1m412 | [0m[35m        sync = SyncState.from_node(sync and sync['ModifyIndex'], sync and sync['Value'])[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m        # get failsafe topology[0m

[31m--[ [0m[34mMatch #[0m[33m1214[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m403 | [0m[35m            leader = Leader(leader['ModifyIndex'], leader.get('Session'), member)[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m        # failover key[0m
[30;1m406 | [0m[35m        failover = nodes.get(self._FAILOVER)[0m
[30;1m407 | [0m[35m        if failover:[0m
[30;1m408 | [0m[35m            failover = Failover.from_node(failover['ModifyIndex'], failover['Value'])[0m
[30;1m409 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1215[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m        if leader:[0m
[30;1m401 | [0m[35m            member = Member(-1, leader['Value'], None, {})[0m
[30;1m402 | [0m[35m            member = ([m for m in members if m.name == leader['Value']] or [member])[0][0m
[30;1m403 | [0m[35m            leader = Leader(leader['ModifyIndex'], leader.get('Session'), member)[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m        # failover key[0m
[30;1m406 | [0m[35m        failover = nodes.get(self._FAILOVER)[0m

[31m--[ [0m[34mMatch #[0m[33m1216[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m395 | [0m[35m        members = [self.member(n) for k, n in nodes.items() if k.startswith(self._MEMBERS) and k.cou[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        # get leader[0m
[30;1m398 | [0m[35m        leader = nodes.get(self._LEADER)[0m
[30;1m399 | [0m[35m[0m
[30;1m400 | [0m[35m        if leader:[0m
[30;1m401 | [0m[35m            member = Member(-1, leader['Value'], None, {})[0m

[31m--[ [0m[34mMatch #[0m[33m1217[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m        history = history and TimelineHistory.from_node(history['ModifyIndex'], history['Value'])[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m        # get last known leader lsn and slots[0m
[30;1m391 | [0m[35m        status = nodes.get(self._STATUS) or nodes.get(self._LEADER_OPTIME)[0m
[30;1m392 | [0m[35m        status = Status.from_node(status and status['Value'])[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m        # get list of members[0m

[31m--[ [0m[34mMatch #[0m[33m1218[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m        history = history and TimelineHistory.from_node(history['ModifyIndex'], history['Value'])[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m        # get last known leader lsn and slots[0m
[30;1m391 | [0m[35m        status = nodes.get(self._STATUS) or nodes.get(self._LEADER_OPTIME)[0m
[30;1m392 | [0m[35m        status = Status.from_node(status and status['Value'])[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m        # get list of members[0m

[31m--[ [0m[34mMatch #[0m[33m1219[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        config = config and ClusterConfig.from_node(config['ModifyIndex'], config['Value'])[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m        # get timeline history[0m
[30;1m387 | [0m[35m        history = nodes.get(self._HISTORY)[0m
[30;1m388 | [0m[35m        history = history and TimelineHistory.from_node(history['ModifyIndex'], history['Value'])[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m        # get last known leader lsn and slots[0m

[31m--[ [0m[34mMatch #[0m[33m1220[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m380 | [0m[35m        initialize = initialize and initialize['Value'][0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m        # get global dynamic configuration[0m
[30;1m383 | [0m[35m        config = nodes.get(self._CONFIG)[0m
[30;1m384 | [0m[35m        config = config and ClusterConfig.from_node(config['ModifyIndex'], config['Value'])[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m        # get timeline history[0m

[31m--[ [0m[34mMatch #[0m[33m1221[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    def _cluster_from_nodes(self, nodes: Dict[str, Any]) -> Cluster:[0m
[30;1m378 | [0m[35m        # get initialize flag[0m
[30;1m379 | [0m[35m        initialize = nodes.get(self._INITIALIZE)[0m
[30;1m380 | [0m[35m        initialize = initialize and initialize['Value'][0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m        # get global dynamic configuration[0m

[31m--[ [0m[34mMatch #[0m[33m1222[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    @staticmethod[0m
[30;1m374 | [0m[35m    def member(node: Dict[str, str]) -> Member:[0m
[30;1m375 | [0m[35m        return Member.from_node(node['ModifyIndex'], os.path.basename(node['Key']), node.get('Sessio[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    def _cluster_from_nodes(self, nodes: Dict[str, Any]) -> Cluster:[0m
[30;1m378 | [0m[35m        # get initialize flag[0m

[31m--[ [0m[34mMatch #[0m[33m1223[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m        self._service_tags: List[str] = consul_config.get('service_tags', [])[0m
[30;1m310 | [0m[35m        self._service_tags.sort()[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m        should_register_service = consul_config.get('register_service', False)[0m
[30;1m313 | [0m[35m        if should_register_service and not self._register_service:[0m
[30;1m314 | [0m[35m            self._set_service_name()[0m
[30;1m315 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1224[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m306 | [0m[35m        consul_config = config.get('consul', {})[0m
[30;1m307 | [0m[35m        self._client.reload_config(consul_config)[0m
[30;1m308 | [0m[35m        self._previous_loop_service_tags = self._service_tags[0m
[30;1m309 | [0m[35m        self._service_tags: List[str] = consul_config.get('service_tags', [])[0m
[30;1m310 | [0m[35m        self._service_tags.sort()[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m        should_register_service = consul_config.get('register_service', False)[0m

[31m--[ [0m[34mMatch #[0m[33m1225[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m    def reload_config(self, config: Union['Config', Dict[str, Any]]) -> None:[0m
[30;1m304 | [0m[35m        super(Consul, self).reload_config(config)[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m        consul_config = config.get('consul', {})[0m
[30;1m307 | [0m[35m        self._client.reload_config(consul_config)[0m
[30;1m308 | [0m[35m        self._previous_loop_service_tags = self._service_tags[0m
[30;1m309 | [0m[35m        self._service_tags: List[str] = consul_config.get('service_tags', [])[0m

[31m--[ [0m[34mMatch #[0m[33m1226[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m        if self._register_service:[0m
[30;1m285 | [0m[35m            self._set_service_name()[0m
[30;1m286 | [0m[35m        self._service_check_interval = config.get('service_check_interval', '5s')[0m
[30;1m287 | [0m[35m        self._service_check_tls_server_name = config.get('service_check_tls_server_name', None)[0m
[30;1m288 | [0m[35m        if not self._ctl:[0m
[30;1m289 | [0m[35m            self.create_session()[0m
[30;1m290 | [0m[35m        self._previous_loop_token = self._client.token[0m

[31m--[ [0m[34mMatch #[0m[33m1227[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m        self._previous_loop_service_tags = self._service_tags[0m
[30;1m284 | [0m[35m        if self._register_service:[0m
[30;1m285 | [0m[35m            self._set_service_name()[0m
[30;1m286 | [0m[35m        self._service_check_interval = config.get('service_check_interval', '5s')[0m
[30;1m287 | [0m[35m        self._service_check_tls_server_name = config.get('service_check_tls_server_name', None)[0m
[30;1m288 | [0m[35m        if not self._ctl:[0m
[30;1m289 | [0m[35m            self.create_session()[0m

[31m--[ [0m[34mMatch #[0m[33m1228[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m        self.__session_checks = config.get('checks', [])[0m
[30;1m280 | [0m[35m        self._register_service = config.get('register_service', False)[0m
[30;1m281 | [0m[35m        self._previous_loop_register_service = self._register_service[0m
[30;1m282 | [0m[35m        self._service_tags = sorted(config.get('service_tags', []))[0m
[30;1m283 | [0m[35m        self._previous_loop_service_tags = self._service_tags[0m
[30;1m284 | [0m[35m        if self._register_service:[0m
[30;1m285 | [0m[35m            self._set_service_name()[0m

[31m--[ [0m[34mMatch #[0m[33m1229[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m        self.set_ttl(config.get('ttl') or 30)[0m
[30;1m278 | [0m[35m        self._last_session_refresh = 0[0m
[30;1m279 | [0m[35m        self.__session_checks = config.get('checks', [])[0m
[30;1m280 | [0m[35m        self._register_service = config.get('register_service', False)[0m
[30;1m281 | [0m[35m        self._previous_loop_register_service = self._register_service[0m
[30;1m282 | [0m[35m        self._service_tags = sorted(config.get('service_tags', []))[0m
[30;1m283 | [0m[35m        self._previous_loop_service_tags = self._service_tags[0m

[31m--[ [0m[34mMatch #[0m[33m1230[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m        self.set_retry_timeout(config['retry_timeout'])[0m
[30;1m277 | [0m[35m        self.set_ttl(config.get('ttl') or 30)[0m
[30;1m278 | [0m[35m        self._last_session_refresh = 0[0m
[30;1m279 | [0m[35m        self.__session_checks = config.get('checks', [])[0m
[30;1m280 | [0m[35m        self._register_service = config.get('register_service', False)[0m
[30;1m281 | [0m[35m        self._previous_loop_register_service = self._register_service[0m
[30;1m282 | [0m[35m        self._service_tags = sorted(config.get('service_tags', []))[0m

[31m--[ [0m[34mMatch #[0m[33m1231[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m        self._client = ConsulClient(**kwargs)[0m
[30;1m276 | [0m[35m        self.set_retry_timeout(config['retry_timeout'])[0m
[30;1m277 | [0m[35m        self.set_ttl(config.get('ttl') or 30)[0m
[30;1m278 | [0m[35m        self._last_session_refresh = 0[0m
[30;1m279 | [0m[35m        self.__session_checks = config.get('checks', [])[0m
[30;1m280 | [0m[35m        self._register_service = config.get('register_service', False)[0m

[31m--[ [0m[34mMatch #[0m[33m1232[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m        config_keys = ('host', 'port', 'token', 'scheme', 'cert', 'ca_cert', 'dc', 'consistency')[0m
[30;1m267 | [0m[35m        kwargs: Dict[str, Any] = {p: config.get(p) for p in config_keys if config.get(p)}[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m        verify = config.get('verify')[0m
[30;1m270 | [0m[35m        if not isinstance(verify, bool):[0m
[30;1m271 | [0m[35m            verify = parse_bool(verify)[0m
[30;1m272 | [0m[35m        if isinstance(verify, bool):[0m

[31m--[ [0m[34mMatch #[0m[33m1233[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m            config['cert'] = (config['cert'], config['key'])[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        config_keys = ('host', 'port', 'token', 'scheme', 'cert', 'ca_cert', 'dc', 'consistency')[0m
[30;1m267 | [0m[35m        kwargs: Dict[str, Any] = {p: config.get(p) for p in config_keys if config.get(p)}[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m        verify = config.get('verify')[0m
[30;1m270 | [0m[35m        if not isinstance(verify, bool):[0m

[31m--[ [0m[34mMatch #[0m[33m1234[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m            config['cert'] = (config['cert'], config['key'])[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        config_keys = ('host', 'port', 'token', 'scheme', 'cert', 'ca_cert', 'dc', 'consistency')[0m
[30;1m267 | [0m[35m        kwargs: Dict[str, Any] = {p: config.get(p) for p in config_keys if config.get(p)}[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m        verify = config.get('verify')[0m
[30;1m270 | [0m[35m        if not isinstance(verify, bool):[0m

[31m--[ [0m[34mMatch #[0m[33m1235[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m        if config.get('cacert'):[0m
[30;1m261 | [0m[35m            config['ca_cert'] = config.pop('cacert')[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        if config.get('key') and config.get('cert'):[0m
[30;1m264 | [0m[35m            config['cert'] = (config['cert'], config['key'])[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        config_keys = ('host', 'port', 'token', 'scheme', 'cert', 'ca_cert', 'dc', 'consistency')[0m

[31m--[ [0m[34mMatch #[0m[33m1236[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m        if config.get('cacert'):[0m
[30;1m261 | [0m[35m            config['ca_cert'] = config.pop('cacert')[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        if config.get('key') and config.get('cert'):[0m
[30;1m264 | [0m[35m            config['cert'] = (config['cert'], config['key'])[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        config_keys = ('host', 'port', 'token', 'scheme', 'cert', 'ca_cert', 'dc', 'consistency')[0m

[31m--[ [0m[34mMatch #[0m[33m1237[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m            if 'port' not in config:[0m
[30;1m258 | [0m[35m                config['port'] = int(port)[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        if config.get('cacert'):[0m
[30;1m261 | [0m[35m            config['ca_cert'] = config.pop('cacert')[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        if config.get('key') and config.get('cert'):[0m

[31m--[ [0m[34mMatch #[0m[33m1238[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m            r = urlparse(url)[0m
[30;1m253 | [0m[35m            config.update({'scheme': r.scheme, 'host': r.hostname, 'port': r.port or 8500})[0m
[30;1m254 | [0m[35m        elif 'host' in config:[0m
[30;1m255 | [0m[35m            host, port = split_host_port(config.get('host', '127.0.0.1:8500'), 8500)[0m
[30;1m256 | [0m[35m            config['host'] = host[0m
[30;1m257 | [0m[35m            if 'port' not in config:[0m
[30;1m258 | [0m[35m                config['port'] = int(port)[0m

[31m--[ [0m[34mMatch #[0m[33m1239[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m
[30;1m198 | [0m[35m        self.http.token = self.token = config.get('token')[0m
[30;1m199 | [0m[35m        self.consistency = config.get('consistency', 'default')[0m
[30;1m200 | [0m[35m        self.dc = config.get('dc')[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35mdef catch_consul_errors(func: Callable[..., Any]) -> Callable[..., Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m1240[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m
[30;1m198 | [0m[35m        self.http.token = self.token = config.get('token')[0m
[30;1m199 | [0m[35m        self.consistency = config.get('consistency', 'default')[0m
[30;1m200 | [0m[35m        self.dc = config.get('dc')[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1241[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m        return self.http_connect(*args, **kwargs)  # pragma: no cover[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m    def reload_config(self, config: Dict[str, Any]) -> None:[0m
[30;1m198 | [0m[35m        self.http.token = self.token = config.get('token')[0m
[30;1m199 | [0m[35m        self.consistency = config.get('consistency', 'default')[0m
[30;1m200 | [0m[35m        self.dc = config.get('dc')[0m
[30;1m201 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1242[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m        """[0m
[30;1m179 | [0m[35m        self._cert = kwargs.pop('cert', None)[0m
[30;1m180 | [0m[35m        self._ca_cert = kwargs.pop('ca_cert', None)[0m
[30;1m181 | [0m[35m        self.token = kwargs.get('token')[0m
[30;1m182 | [0m[35m        super(ConsulClient, self).__init__(*args, **kwargs)[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    def http_connect(self, *args: Any, **kwargs: Any) -> HTTPClient:[0m

[31m--[ [0m[34mMatch #[0m[33m1243[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m            token = params.pop('token', self.token) if isinstance(params, dict) else self.token[0m
[30;1m140 | [0m[35m            if token:[0m
[30;1m141 | [0m[35m                kwargs['headers']['X-Consul-Token'] = token[0m
[30;1m142 | [0m[35m            return callback(self.response(self.http.request(method.upper(), self.uri(path, params), [0m
[30;1m143 | [0m[35m        return wrapper[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1244[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m.hostname[0m
[30;1m539 | [0m[35m[0m
[30;1m540 | [0m[35m        params = {[0m
[30;1m541 | [0m[35m            'service_id': '{0}/{1}'.format(self._scope, self._name),[0m
[30;1m542 | [0m[35m            'address': conn_parts.hostname,[0m
[30;1m543 | [0m[35m            'port': conn_parts.port,[0m
[30;1m544 | [0m[35m            'check': check,[0m
[30;1m545 | [0m[35m            'tags': tags,[0m

[31m--[ [0m[34mMatch #[0m[33m1245[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m.hostname[0m
[30;1m250 | [0m[35m        if 'url' in config:[0m
[30;1m251 | [0m[35m            url: str = config['url'][0m
[30;1m252 | [0m[35m            r = urlparse(url)[0m
[30;1m253 | [0m[35m            config.update({'scheme': r.scheme, 'host': r.hostname, 'port': r.port or 8500})[0m
[30;1m254 | [0m[35m        elif 'host' in config:[0m
[30;1m255 | [0m[35m            host, port = split_host_port(config.get('host', '127.0.0.1:8500'), 8500)[0m
[30;1m256 | [0m[35m            config['host'] = host[0m

[31m--[ [0m[34mMatch #[0m[33m1246[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m570 | [0m[35m                update = True[0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m        if ([0m
[30;1m573 | [0m[35m            force or update or self._register_service != self._previous_loop_register_service[0m
[30;1m574 | [0m[35m            or self._service_tags != self._previous_loop_service_tags[0m
[30;1m575 | [0m[35m            or self._client.token != self._previous_loop_token[0m
[30;1m576 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1247[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m567 | [0m[35m                logger.warning('Could not register service: not enough params in member data')[0m
[30;1m568 | [0m[35m                return[0m
[30;1m569 | [0m[35m            if old_data.get(key) != new_data[key]:[0m
[30;1m570 | [0m[35m                update = True[0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m        if ([0m
[30;1m573 | [0m[35m            force or update or self._register_service != self._previous_loop_register_service[0m

[31m--[ [0m[34mMatch #[0m[33m1248[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m560 | [0m[35m[0m
[30;1m561 | [0m[35m    @force_if_last_failed[0m
[30;1m562 | [0m[35m    def update_service(self, old_data: Dict[str, Any], new_data: Dict[str, Any], force: bool = False[0m
[30;1m563 | [0m[35m        update = False[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m        for key in ['role', 'api_url', 'conn_url', 'state']:[0m
[30;1m566 | [0m[35m            if key not in new_data:[0m

[31m--[ [0m[34mMatch #[0m[33m1249[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m709 | [0m[35m                except (ConsulException, HTTPException, HTTPError, socket.error, socket.timeout):[0m
[30;1m710 | [0m[35m                    logger.exception('watch')[0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m                timeout = end_time - time.time()[0m
[30;1m713 | [0m[35m[0m
[30;1m714 | [0m[35m        try:[0m
[30;1m715 | [0m[35m            return super(Consul, self).watch(None, timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m1250[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m        if leader_version:[0m
[30;1m704 | [0m[35m            end_time = time.time() + timeout[0m
[30;1m705 | [0m[35m            while timeout >= 1:[0m
[30;1m706 | [0m[35m                try:[0m
[30;1m707 | [0m[35m                    idx, _ = self._client.kv.get(self.leader_path, index=leader_version, wait=str(ti[0m
[30;1m708 | [0m[35m                    return str(idx) != str(leader_version)[0m

[31m--[ [0m[34mMatch #[0m[33m1251[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m701 | [0m[35m            return True[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m        if leader_version:[0m
[30;1m704 | [0m[35m            end_time = time.time() + timeout[0m
[30;1m705 | [0m[35m            while timeout >= 1:[0m
[30;1m706 | [0m[35m                try:[0m
[30;1m707 | [0m[35m                    idx, _ = self._client.kv.get(self.leader_path, index=leader_version, wait=str(ti[0m
[30;1m708 | [0m[35m                    return str(idx) != str(leader_version)[0m

[31m--[ [0m[34mMatch #[0m[33m1252[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m    @catch_consul_errors[0m
[30;1m514 | [0m[35m    def deregister_service(self, service_id: str) -> bool:[0m
[30;1m515 | [0m[35m        logger.info('Deregister service %s', service_id)[0m
[30;1m516 | [0m[35m        # service_id can contain special characters, but is used as part of uri in deregister reques[0m
[30;1m517 | [0m[35m        service_id = quote(service_id)[0m
[30;1m518 | [0m[35m        return self._client.agent.service.deregister(service_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1253[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m    @catch_consul_errors[0m
[30;1m509 | [0m[35m    def register_service(self, service_name: str, **kwargs: Any) -> bool:[0m
[30;1m510 | [0m[35m        logger.info('Register service %s, params %s', service_name, kwargs)[0m
[30;1m511 | [0m[35m        return self._client.agent.service.register(service_name, **kwargs)[0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m    @catch_consul_errors[0m

[31m--[ [0m[34mMatch #[0m[33m1254[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m503 | [0m[35m    def _set_service_name(self) -> None:[0m
[30;1m504 | [0m[35m        self._service_name = service_name_from_scope_name(self._scope)[0m
[30;1m505 | [0m[35m        if self._scope != self._service_name:[0m
[30;1m506 | [0m[35m            logger.warning('Using %s as consul service name instead of scope name %s', self._service[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m    @catch_consul_errors[0m
[30;1m509 | [0m[35m    def register_service(self, service_name: str, **kwargs: Any) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1255[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m455 | [0m[35m            key = node['Key'][len(path):].split('/', 1)[0m
[30;1m456 | [0m[35m            if len(key) == 2 and self._mpp.group_re.match(key[0]):[0m
[30;1m457 | [0m[35m                node['Value'] = (node['Value'] or b'').decode('utf-8')[0m
[30;1m458 | [0m[35m                clusters[int(key[0])][key[1]] = node[0m
[30;1m459 | [0m[35m        return {group: self._cluster_from_nodes(nodes) for group, nodes in clusters.items()}[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m    def _load_cluster([0m
[30;1m462 | [0m[35m            self, path: str, loader: Callable[[str], Union[Cluster, Dict[int, Cluster]]][0m

[31m--[ [0m[34mMatch #[0m[33m1256[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m451 | [0m[35m        results: Optional[List[Dict[str, Any]]][0m
[30;1m452 | [0m[35m        _, results = self.retry(self._client.kv.get, path, recurse=True, consistency=self._consisten[0m
[30;1m453 | [0m[35m        clusters: Dict[int, Dict[str, Dict[str, Any]]] = defaultdict(dict)[0m
[30;1m454 | [0m[35m        for node in results or []:[0m
[30;1m455 | [0m[35m            key = node['Key'][len(path):].split('/', 1)[0m
[30;1m456 | [0m[35m            if len(key) == 2 and self._mpp.group_re.match(key[0]):[0m
[30;1m457 | [0m[35m                node['Value'] = (node['Value'] or b'').decode('utf-8')[0m

[31m--[ [0m[34mMatch #[0m[33m1257[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m437 | [0m[35m        nodes: Dict[str, Dict[str, Any]] = {}[0m
[30;1m438 | [0m[35m        for node in results:[0m
[30;1m439 | [0m[35m            node['Value'] = (node['Value'] or b'').decode('utf-8')[0m
[30;1m440 | [0m[35m            nodes[node['Key'][len(path):]] = node[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m        return self._cluster_from_nodes(nodes)[0m
[30;1m443 | [0m[35m[0m
[30;1m444 | [0m[35m    def _mpp_cluster_loader(self, path: str) -> Dict[int, Cluster]:[0m

[31m--[ [0m[34mMatch #[0m[33m1258[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m435 | [0m[35m        if results is None:[0m
[30;1m436 | [0m[35m            return Cluster.empty()[0m
[30;1m437 | [0m[35m        nodes: Dict[str, Dict[str, Any]] = {}[0m
[30;1m438 | [0m[35m        for node in results:[0m
[30;1m439 | [0m[35m            node['Value'] = (node['Value'] or b'').decode('utf-8')[0m
[30;1m440 | [0m[35m            nodes[node['Key'][len(path):]] = node[0m
[30;1m441 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1259[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35mdef service_name_from_scope_name(scope_name: str) -> str:[0m
[30;1m225 | [0m[35m    """Translate scope name to service name which can be used in dns.[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    230 = 253 - len('replica.') - len('.service.consul')[0m
[30;1m228 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1260[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m                # supplied maximum wait time to spread out the wake up time of any concurrent reques[0m
[30;1m132 | [0m[35m                # up to wait / 16 additional time to the maximum duration. Since our goal is actuall[0m
[30;1m133 | [0m[35m                # response rather read timeout we will add to the timeout a slightly bigger value.[0m
[30;1m134 | [0m[35m                kwargs['timeout'] = timeout + max(timeout / 15.0, 1)[0m
[30;1m135 | [0m[35m            else:[0m
[30;1m136 | [0m[35m                kwargs['timeout'] = self._read_timeout[0m
[30;1m137 | [0m[35m            kwargs['headers'] = (headers or {}).copy()[0m

[31m--[ [0m[34mMatch #[0m[33m1261[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m                # According to the documentation a small random amount of additional wait time is ad[0m
[30;1m131 | [0m[35m                # supplied maximum wait time to spread out the wake up time of any concurrent reques[0m
[30;1m132 | [0m[35m                # up to wait / 16 additional time to the maximum duration. Since our goal is actuall[0m
[30;1m133 | [0m[35m                # response rather read timeout we will add to the timeout a slightly bigger value.[0m
[30;1m134 | [0m[35m                kwargs['timeout'] = timeout + max(timeout / 15.0, 1)[0m
[30;1m135 | [0m[35m            else:[0m
[30;1m136 | [0m[35m                kwargs['timeout'] = self._read_timeout[0m

[31m--[ [0m[34mMatch #[0m[33m1262[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m                # According to the documentation a small random amount of additional wait time is ad[0m
[30;1m131 | [0m[35m                # supplied maximum wait time to spread out the wake up time of any concurrent reques[0m
[30;1m132 | [0m[35m                # up to wait / 16 additional time to the maximum duration. Since our goal is actuall[0m
[30;1m133 | [0m[35m                # response rather read timeout we will add to the timeout a slightly bigger value.[0m
[30;1m134 | [0m[35m                kwargs['timeout'] = timeout + max(timeout / 15.0, 1)[0m
[30;1m135 | [0m[35m            else:[0m
[30;1m136 | [0m[35m                kwargs['timeout'] = self._read_timeout[0m

[31m--[ [0m[34mMatch #[0m[33m1263[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m                timeout = float(params['wait'][:-1]) if 'wait' in params else 300[0m
[30;1m130 | [0m[35m                # According to the documentation a small random amount of additional wait time is ad[0m
[30;1m131 | [0m[35m                # supplied maximum wait time to spread out the wake up time of any concurrent reques[0m
[30;1m132 | [0m[35m                # up to wait / 16 additional time to the maximum duration. Since our goal is actuall[0m
[30;1m133 | [0m[35m                # response rather read timeout we will add to the timeout a slightly bigger value.[0m
[30;1m134 | [0m[35m                kwargs['timeout'] = timeout + max(timeout / 15.0, 1)[0m
[30;1m135 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1264[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m128 | [0m[35mparams, dict) and 'index' in params:[0m
[30;1m129 | [0m[35m                timeout = float(params['wait'][:-1]) if 'wait' in params else 300[0m
[30;1m130 | [0m[35m                # According to the documentation a small random amount of additional wait time is ad[0m
[30;1m131 | [0m[35m                # supplied maximum wait time to spread out the wake up time of any concurrent reques[0m
[30;1m132 | [0m[35m                # up to wait / 16 additional time to the maximum duration. Since our goal is actuall[0m
[30;1m133 | [0m[35m                # response rather read timeout we will add to the timeout a slightly bigger value.[0m

[31m--[ [0m[34mMatch #[0m[33m1265[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m128 | [0m[35mmethod == 'get' and isinstance(params, dict) and 'index' in params:[0m
[30;1m129 | [0m[35m                timeout = float(params['wait'][:-1]) if 'wait' in params else 300[0m
[30;1m130 | [0m[35m                # According to the documentation a small random amount of additional wait time is ad[0m
[30;1m131 | [0m[35m                # supplied maximum wait time to spread out the wake up time of any concurrent reques[0m
[30;1m132 | [0m[35m                # up to wait / 16 additional time to the maximum duration. Since our goal is actuall[0m
[30;1m133 | [0m[35m                # response rather read timeout we will add to the timeout a slightly bigger value.[0m

[31m--[ [0m[34mMatch #[0m[33m1266[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m': 0, 'preload_content': False, 'body': data}[0m
[30;1m128 | [0m[35m            if method == 'get' and isinstance(params, dict) and 'index' in params:[0m
[30;1m129 | [0m[35m                timeout = float(params['wait'][:-1]) if 'wait' in params else 300[0m
[30;1m130 | [0m[35m                # According to the documentation a small random amount of additional wait time is ad[0m
[30;1m131 | [0m[35m                # supplied maximum wait time to spread out the wake up time of any concurrent reques[0m
[30;1m132 | [0m[35m                # up to wait / 16 additional time to the maximum duration. Since our goal is actuall[0m

[31m--[ [0m[34mMatch #[0m[33m1267[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m.0 python-consul switched from `dict` to `list` for params[0m
[30;1m126 | [0m[35m                params = {k: v for k, v in params}[0m
[30;1m127 | [0m[35m            kwargs: Dict[str, Any] = {'retries': 0, 'preload_content': False, 'body': data}[0m
[30;1m128 | [0m[35m            if method == 'get' and isinstance(params, dict) and 'index' in params:[0m
[30;1m129 | [0m[35m                timeout = float(params['wait'][:-1]) if 'wait' in params else 300[0m
[30;1m130 | [0m[35m                # According to the documentation a small random amount of additional wait time is ad[0m
[30;1m131 | [0m[35m                # supplied maximum wait time to spread out the wake up time of any concurrent reques[0m

[31m--[ [0m[34mMatch #[0m[33m1268[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        self._ttl = 30[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def set_read_timeout(self, timeout: float) -> None:[0m
[30;1m79 | [0m[35m        self._read_timeout = timeout / 3.0[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    @property[0m
[30;1m82 | [0m[35m    def ttl(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m1269[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport re[0m
[30;1m7 | [0m[35mimport socket[0m
[30;1m8 | [0m[35mimport ssl[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom collections import defaultdict[0m
[30;1m12 | [0m[35mfrom http.client import HTTPException[0m
[30;1m13 | [0m[35mfrom typing import Any, Callable, Dict, List, Mapping, NamedTuple, Optional, Tuple, TYPE_CHECKING, U[0m

[31m--[ [0m[34mMatch #[0m[33m1270[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1084 | [0m[35m        'darwin': {'TCP_KEEPIDLE': 4294967, 'TCP_KEEPINTVL': 4294967, 'TCP_KEEPCNT': 2147483647},[0m
[30;1m1085 | [0m[35m    }[0m
[30;1m1086 | [0m[35m    platform = 'linux' if sys.platform.startswith('linux') else sys.platform[0m
[30;1m1087 | [0m[35m    max_possible_value = max_of_options.get(platform, {}).get(option)[0m
[30;1m1088 | [0m[35m    if max_possible_value is not None and value > max_possible_value:[0m
[30;1m1089 | [0m[35m        logger.debug('%s changed from %d to %d.', option, value, max_possible_value)[0m
[30;1m1090 | [0m[35m        value = max_possible_value[0m

[31m--[ [0m[34mMatch #[0m[33m1271[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1084 | [0m[35m        'darwin': {'TCP_KEEPIDLE': 4294967, 'TCP_KEEPINTVL': 4294967, 'TCP_KEEPCNT': 2147483647},[0m
[30;1m1085 | [0m[35m    }[0m
[30;1m1086 | [0m[35m    platform = 'linux' if sys.platform.startswith('linux') else sys.platform[0m
[30;1m1087 | [0m[35m    max_possible_value = max_of_options.get(platform, {}).get(option)[0m
[30;1m1088 | [0m[35m    if max_possible_value is not None and value > max_possible_value:[0m
[30;1m1089 | [0m[35m        logger.debug('%s changed from %d to %d.', option, value, max_possible_value)[0m
[30;1m1090 | [0m[35m        value = max_possible_value[0m

[31m--[ [0m[34mMatch #[0m[33m1272[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m963 | [0m[35m        conn_kwargs = m.conn_kwargs()[0m
[30;1m964 | [0m[35m        if conn_kwargs.get('host'):[0m
[30;1m965 | [0m[35m            member['host'] = conn_kwargs['host'][0m
[30;1m966 | [0m[35m            if conn_kwargs.get('port'):[0m
[30;1m967 | [0m[35m                member['port'] = int(conn_kwargs['port'])[0m
[30;1m968 | [0m[35m        optional_attributes = ('timeline', 'pending_restart', 'pending_restart_reason', 'scheduled_r[0m
[30;1m969 | [0m[35m        member.update({n: m.data[n] for n in optional_attributes if n in m.data})[0m

[31m--[ [0m[34mMatch #[0m[33m1273[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m961 | [0m[35m        state = (m.data.get('replication_state', '') if role != 'leader' else '') or m.data.get('sta[0m
[30;1m962 | [0m[35m        member = {'name': m.name, 'role': role, 'state': state, 'api_url': m.api_url}[0m
[30;1m963 | [0m[35m        conn_kwargs = m.conn_kwargs()[0m
[30;1m964 | [0m[35m        if conn_kwargs.get('host'):[0m
[30;1m965 | [0m[35m            member['host'] = conn_kwargs['host'][0m
[30;1m966 | [0m[35m            if conn_kwargs.get('port'):[0m
[30;1m967 | [0m[35m                member['port'] = int(conn_kwargs['port'])[0m

[31m--[ [0m[34mMatch #[0m[33m1274[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m958 | [0m[35m        else:[0m
[30;1m959 | [0m[35m            role = 'replica'[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m        state = (m.data.get('replication_state', '') if role != 'leader' else '') or m.data.get('sta[0m
[30;1m962 | [0m[35m        member = {'name': m.name, 'role': role, 'state': state, 'api_url': m.api_url}[0m
[30;1m963 | [0m[35m        conn_kwargs = m.conn_kwargs()[0m
[30;1m964 | [0m[35m        if conn_kwargs.get('host'):[0m

[31m--[ [0m[34mMatch #[0m[33m1275[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m958 | [0m[35m        else:[0m
[30;1m959 | [0m[35m            role = 'replica'[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m        state = (m.data.get('replication_state', '') if role != 'leader' else '') or m.data.get('sta[0m
[30;1m962 | [0m[35m        member = {'name': m.name, 'role': role, 'state': state, 'api_url': m.api_url}[0m
[30;1m963 | [0m[35m        conn_kwargs = m.conn_kwargs()[0m
[30;1m964 | [0m[35m        if conn_kwargs.get('host'):[0m

[31m--[ [0m[34mMatch #[0m[33m1276[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m607 | [0m[35m        'string': lambda v1, v2: str(v1)[0m
[30;1m608 | [0m[35m    }[0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35m    converter = converters.get(vartype) or converters['string'][0m
[30;1m611 | [0m[35m    old_converted = converter(settings_value, None)[0m
[30;1m612 | [0m[35m    new_converted = converter(config_value, unit)[0m
[30;1m613 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1277[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m        'real': (parse_real, convert_real_from_base_unit),[0m
[30;1m447 | [0m[35m        'default': (lambda v, _: v, lambda v, _: v)[0m
[30;1m448 | [0m[35m    }[0m
[30;1m449 | [0m[35m    parser, converter = converters.get(vartype, converters['default'])[0m
[30;1m450 | [0m[35m    parsed_value = parser(base_value, None)[0m
[30;1m451 | [0m[35m    if parsed_value:[0m
[30;1m452 | [0m[35m        return converter(parsed_value, base_unit) or base_value[0m

[31m--[ [0m[34mMatch #[0m[33m1278[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m997 | [0m[35m    """Check if the file system path *d2* is contained within *d1* after resolving symbolic links.[0m
[30;1m998 | [0m[35m[0m
[30;1m999 | [0m[35m    .. note::[0m
[30;1m1000 | [0m[35m        It will not check if the paths actually exist, it will only expand the paths and resolve any[0m
[30;1m1001 | [0m[35m        that happen to be found.[0m
[30;1m1002 | [0m[35m[0m
[30;1m1003 | [0m[35m    :param d1: path to a directory.[0m

[31m--[ [0m[34mMatch #[0m[33m1279[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m997 | [0m[35m    """Check if the file system path *d2* is contained within *d1* after resolving symbolic links.[0m
[30;1m998 | [0m[35m[0m
[30;1m999 | [0m[35m    .. note::[0m
[30;1m1000 | [0m[35m        It will not check if the paths actually exist, it will only expand the paths and resolve any[0m
[30;1m1001 | [0m[35m        that happen to be found.[0m
[30;1m1002 | [0m[35m[0m
[30;1m1003 | [0m[35m    :param d1: path to a directory.[0m

[31m--[ [0m[34mMatch #[0m[33m1280[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m979 | [0m[35m[0m
[30;1m980 | [0m[35m        ret['members'].append(member)[0m
[30;1m981 | [0m[35m[0m
[30;1m982 | [0m[35m    # sort members by name for consistency[0m
[30;1m983 | [0m[35m    cmp: Callable[[Dict[str, Any]], bool] = lambda m: m['name'][0m
[30;1m984 | [0m[35m    ret['members'].sort(key=cmp)[0m
[30;1m985 | [0m[35m    if config.is_paused:[0m

[31m--[ [0m[34mMatch #[0m[33m1281[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m792 | [0m[35m    """[0m
[30;1m793 | [0m[35m    start_time = time.time()[0m
[30;1m794 | [0m[35m    iteration = 0[0m
[30;1m795 | [0m[35m    end_time = start_time + timeout[0m
[30;1m796 | [0m[35m    while time.time() < end_time:[0m
[30;1m797 | [0m[35m        yield iteration[0m
[30;1m798 | [0m[35m        iteration += 1[0m
[30;1m799 | [0m[35m        time.sleep(float(interval))[0m

[31m--[ [0m[34mMatch #[0m[33m1282[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m783 | [0m[35m    """Return an iterator that returns values every *interval* seconds until *timeout* has passed.[0m
[30;1m784 | [0m[35m[0m
[30;1m785 | [0m[35m    .. note::[0m
[30;1m786 | [0m[35m        Timeout is measured from start of iteration.[0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m    :param timeout: for how long (in seconds) from now it should keep returning values.[0m
[30;1m789 | [0m[35m    :param interval: for how long to sleep before returning a new value.[0m

[31m--[ [0m[34mMatch #[0m[33m1283[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m743 | [0m[35m            * ``deadline`` is exceeded.[0m
[30;1m744 | [0m[35m[0m
[30;1m745 | [0m[35m        .. note::[0m
[30;1m746 | [0m[35m            * It will set loop stop time based on ``deadline`` attribute.[0m
[30;1m747 | [0m[35m            * It will adjust delay on each cycle.[0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m        :param func: function to call.[0m

[31m--[ [0m[34mMatch #[0m[33m1284[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m665 | [0m[35m        :param max_jitter: additional max jitter period to wait between retry attempts to avoid slam[0m
[30;1m666 | [0m[35m        :param max_delay: maximum delay in seconds, regardless of other backoff settings.[0m
[30;1m667 | [0m[35m        :param sleep_func: function used to introduce artificial delays.[0m
[30;1m668 | [0m[35m        :param deadline: timeout for operation retries.[0m
[30;1m669 | [0m[35m        :param retry_exceptions: single exception or tuple[0m
[30;1m670 | [0m[35m        """[0m
[30;1m671 | [0m[35m        self.max_tries = max_tries[0m

[31m--[ [0m[34mMatch #[0m[33m1285[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m648 | [0m[35m    :ivar max_jitter: additional max jitter period to wait between retry attempts to avoid slamming [0m
[30;1m649 | [0m[35m    :ivar max_delay: maximum delay in seconds, regardless of other backoff settings.[0m
[30;1m650 | [0m[35m    :ivar sleep_func: function used to introduce artificial delays.[0m
[30;1m651 | [0m[35m    :ivar deadline: timeout for operation retries.[0m
[30;1m652 | [0m[35m    :ivar retry_exceptions: single exception or tuple[0m
[30;1m653 | [0m[35m    """[0m
[30;1m654 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1286[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m368 | [0m[35m    """Convert an floating-point value in some base unit to a human-friendly unit.[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m    Same as :func:`convert_int_from_base_unit`, except we have to do the math a bit differently,[0m
[30;1m371 | [0m[35m    and there's a possibility that we don't find any exact divisor.[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    :param base_value: value to be converted from a base unit[0m
[30;1m374 | [0m[35m    :param base_unit: unit of *value*. Should be one of the base units (case sensitive):[0m

[31m--[ [0m[34mMatch #[0m[33m1287[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35mdef convert_to_base_unit(value: Union[int, float], unit: str, base_unit: Optional[str]) -> Union[int[0m
[30;1m278 | [0m[35m    """Convert *value* as a *unit* of compute information or time to *base_unit*.[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m    :param value: value to be converted to the base unit.[0m
[30;1m281 | [0m[35m    :param unit: unit of *value*. Accepts these units (case sensitive):[0m

[31m--[ [0m[34mMatch #[0m[33m1288[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m    Takes into consideration numbers represented either as hex, octal or decimal formats.[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m    :param value: any value from which we want to extract a long integer.[0m
[30;1m198 | [0m[35m    :param strict: dictates how the first item in the returning tuple is set when :func:`strtol` is [0m
[30;1m199 | [0m[35m        long integer in *value*. If *strict* is ``True``, then the first item will be ``None``, else[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m    :returns: the first item is the extracted long integer from *value*, and the second item is the [0m

[31m--[ [0m[34mMatch #[0m[33m1289[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mimport subprocess[0m
[30;1m21 | [0m[35mimport sys[0m
[30;1m22 | [0m[35mimport tempfile[0m
[30;1m23 | [0m[35mimport time[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mfrom collections import OrderedDict[0m
[30;1m26 | [0m[35mfrom json import JSONDecoder[0m
[30;1m27 | [0m[35mfrom shlex import split[0m

[31m--[ [0m[34mMatch #[0m[33m1290[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""Utilitary objects and functions that can be used throughout Patroni code.[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m:var tzutc: UTC time zone info object.[0m
[30;1m4 | [0m[35m:var logger: logger of this module.[0m
[30;1m5 | [0m[35m:var USER_AGENT: identifies the Patroni version, Python version, and the underlying platform.[0m
[30;1m6 | [0m[35m:var OCT_RE: regular expression to match octal numbers, signed or unsigned.[0m

[31m--[ [0m[34mMatch #[0m[33m1291[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m    def _from_pidfile(cls, data_dir: str) -> Optional['PostmasterProcess']:[0m
[30;1m88 | [0m[35m        postmaster_pid = PostmasterProcess._read_postmaster_pidfile(data_dir)[0m
[30;1m89 | [0m[35m        try:[0m
[30;1m90 | [0m[35m            pid = int(postmaster_pid.get('pid', 0))[0m
[30;1m91 | [0m[35m            if pid:[0m
[30;1m92 | [0m[35m                proc = cls(pid)[0m
[30;1m93 | [0m[35m                proc._postmaster_pid = postmaster_pid[0m

[31m--[ [0m[34mMatch #[0m[33m1292[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m                            'process start time %s', self.pid, start_time, self.create_time())[0m
[30;1m74 | [0m[35m                return False[0m
[30;1m75 | [0m[35m        except ValueError:[0m
[30;1m76 | [0m[35m            logger.warning('Garbage start time value in pid file: %r', self._postmaster_pid.get('sta[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        # Extra safety check. The process can't be ourselves, our parent or our direct child.[0m
[30;1m79 | [0m[35m        if self.pid == os.getpid() or self.pid == os.getppid() or self.ppid() == os.getpid():[0m

[31m--[ [0m[34mMatch #[0m[33m1293[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    def _is_postmaster_process(self) -> bool:[0m
[30;1m69 | [0m[35m        try:[0m
[30;1m70 | [0m[35m            start_time = int(self._postmaster_pid.get('start_time', 0))[0m
[30;1m71 | [0m[35m            if start_time and abs(self.create_time() - start_time) > 3:[0m
[30;1m72 | [0m[35m                logger.info('Process %s is not postmaster, too much difference between PID file star[0m
[30;1m73 | [0m[35m                            'process start time %s', self.pid, start_time, self.create_time())[0m

[31m--[ [0m[34mMatch #[0m[33m1294[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom patroni import KUBERNETES_ENV_PREFIX, PATRONI_ENV_PREFIX[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# avoid spawning the resource tracker process[0m
[30;1m17 | [0m[35mif sys.version_info >= (3, 8):  # pragma: no cover[0m
[30;1m18 | [0m[35m    import multiprocessing.resource_tracker[0m
[30;1m19 | [0m[35m    multiprocessing.resource_tracker.getfd = lambda: 0[0m

[31m--[ [0m[34mMatch #[0m[33m1295[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m        logger.info('postmaster pid=%s', pid)[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        # TODO: In an extremely unlikely case, the process could have exited and the pid reassigned.[0m
[30;1m257 | [0m[35m        # initiation time is not accurate enough to compare to create time as start time would also [0m
[30;1m258 | [0m[35m        # be relatively close. We need the subprocess extract pid+start_time in a race free manner.[0m
[30;1m259 | [0m[35m        return PostmasterProcess.from_pid(pid)[0m

[31m--[ [0m[34mMatch #[0m[33m1296[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m        logger.info('postmaster pid=%s', pid)[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        # TODO: In an extremely unlikely case, the process could have exited and the pid reassigned.[0m
[30;1m257 | [0m[35m        # initiation time is not accurate enough to compare to create time as start time would also [0m
[30;1m258 | [0m[35m        # be relatively close. We need the subprocess extract pid+start_time in a race free manner.[0m
[30;1m259 | [0m[35m        return PostmasterProcess.from_pid(pid)[0m

[31m--[ [0m[34mMatch #[0m[33m1297[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m        logger.info('postmaster pid=%s', pid)[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        # TODO: In an extremely unlikely case, the process could have exited and the pid reassigned.[0m
[30;1m257 | [0m[35m        # initiation time is not accurate enough to compare to create time as start time would also [0m
[30;1m258 | [0m[35m        # be relatively close. We need the subprocess extract pid+start_time in a race free manner.[0m
[30;1m259 | [0m[35m        return PostmasterProcess.from_pid(pid)[0m

[31m--[ [0m[34mMatch #[0m[33m1298[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m        # In order to make everything portable we can't use fork&exec approach here, so  we will cal[0m
[30;1m226 | [0m[35m        # ourselves and pass list of arguments which must be used to start postgres.[0m
[30;1m227 | [0m[35m        # On Windows, in order to run a side-by-side assembly the specified env must include a valid[0m
[30;1m228 | [0m[35m        env = {p: os.environ[p] for p in os.environ if not p.startswith([0m
[30;1m229 | [0m[35m            PATRONI_ENV_PREFIX) and not p.startswith(KUBERNETES_ENV_PREFIX)}[0m
[30;1m230 | [0m[35m        try:[0m
[30;1m231 | [0m[35m            proc = PostmasterProcess._from_pidfile(data_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m1299[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m        # of init process to take care about postmaster.[0m
[30;1m225 | [0m[35m        # In order to make everything portable we can't use fork&exec approach here, so  we will cal[0m
[30;1m226 | [0m[35m        # ourselves and pass list of arguments which must be used to start postgres.[0m
[30;1m227 | [0m[35m        # On Windows, in order to run a side-by-side assembly the specified env must include a valid[0m
[30;1m228 | [0m[35m        env = {p: os.environ[p] for p in os.environ if not p.startswith([0m
[30;1m229 | [0m[35m            PATRONI_ENV_PREFIX) and not p.startswith(KUBERNETES_ENV_PREFIX)}[0m
[30;1m230 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1300[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m                            'process start time %s', self.pid, start_time, self.create_time())[0m
[30;1m74 | [0m[35m                return False[0m
[30;1m75 | [0m[35m        except ValueError:[0m
[30;1m76 | [0m[35m            logger.warning('Garbage start time value in pid file: %r', self._postmaster_pid.get('sta[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        # Extra safety check. The process can't be ourselves, our parent or our direct child.[0m
[30;1m79 | [0m[35m        if self.pid == os.getpid() or self.pid == os.getppid() or self.ppid() == os.getpid():[0m

[31m--[ [0m[34mMatch #[0m[33m1301[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m            start_time = int(self._postmaster_pid.get('start_time', 0))[0m
[30;1m71 | [0m[35m            if start_time and abs(self.create_time() - start_time) > 3:[0m
[30;1m72 | [0m[35m                logger.info('Process %s is not postmaster, too much difference between PID file star[0m
[30;1m73 | [0m[35m                            'process start time %s', self.pid, start_time, self.create_time())[0m
[30;1m74 | [0m[35m                return False[0m
[30;1m75 | [0m[35m        except ValueError:[0m
[30;1m76 | [0m[35m            logger.warning('Garbage start time value in pid file: %r', self._postmaster_pid.get('sta[0m

[31m--[ [0m[34mMatch #[0m[33m1302[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/postmaster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m        try:[0m
[30;1m70 | [0m[35m            start_time = int(self._postmaster_pid.get('start_time', 0))[0m
[30;1m71 | [0m[35m            if start_time and abs(self.create_time() - start_time) > 3:[0m
[30;1m72 | [0m[35m                logger.info('Process %s is not postmaster, too much difference between PID file star[0m
[30;1m73 | [0m[35m                            'process start time %s', self.pid, start_time, self.create_time())[0m
[30;1m74 | [0m[35m                return False[0m
[30;1m75 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m1303[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        response = None[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        try:[0m
[30;1m209 | [0m[35m            response = self._http.request("POST",[0m
[30;1m210 | [0m[35m                                          url,[0m
[30;1m211 | [0m[35m                                          body=body,[0m
[30;1m212 | [0m[35m                                          headers={[0m

[31m--[ [0m[34mMatch #[0m[33m1304[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m        response = None[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        try:[0m
[30;1m184 | [0m[35m            response = self._http.request("GET", url)[0m
[30;1m185 | [0m[35m        except MaxRetryError as exc:[0m
[30;1m186 | [0m[35m            msg = f"Failed to perform a GET request to {url}"[0m
[30;1m187 | [0m[35m            raise RetriesExceeded(msg) from exc[0m

[31m--[ [0m[34mMatch #[0m[33m1305[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m        if response != "OK":[0m
[30;1m230 | [0m[35m            msg = ([0m
[30;1m231 | [0m[35m                "pg-backup-api is currently not up and running at "[0m
[30;1m232 | [0m[35m                f"{self.api_url}: {response}"[0m
[30;1m233 | [0m[35m            )[0m
[30;1m234 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1306[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m260 | [0m[35m        :param barman_server: name of the Barman server which backup is to be[0m
[30;1m261 | [0m[35m            restored.[0m
[30;1m262 | [0m[35m        :param backup_id: ID of the backup from the Barman server.[0m
[30;1m263 | [0m[35m        :param ssh_command: SSH command to connect from the Barman host to the[0m
[30;1m264 | [0m[35m            target host.[0m
[30;1m265 | [0m[35m        :param data_directory: path to the Postgres data directory where to[0m
[30;1m266 | [0m[35m            restore the backup at.[0m

[31m--[ [0m[34mMatch #[0m[33m1307[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom enum import IntEnum[0m
[30;1m10 | [0m[35mfrom typing import Any, Callable, Dict, Optional, Tuple, Type, Union[0m
[30;1m11 | [0m[35mfrom urllib.parse import urljoin[0m

[31m--[ [0m[34mMatch #[0m[33m1308[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        :returns: a dictionary of tags set for this node.[0m
[30;1m143 | [0m[35m        """[0m
[30;1m144 | [0m[35m        return self._filter_tags(self.config.get('tags', {}))[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    def reload_config(self, sighup: bool = False, local: Optional[bool] = False) -> None:[0m
[30;1m147 | [0m[35m        """Apply new configuration values for ``patroni`` daemon.[0m

[31m--[ [0m[34mMatch #[0m[33m1309[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m            # Silence annoying WARNING: Retrying (...) messages when Patroni is quickly restarted.[0m
[30;1m131 | [0m[35m            # At this moment we don't have custom log levels configured and hence shouldn't lose any[0m
[30;1m132 | [0m[35m            self.logger.update_loggers({'urllib3.connectionpool': 'ERROR'})[0m
[30;1m133 | [0m[35m            _ = self.request(member, endpoint="/liveness", timeout=3)[0m
[30;1m134 | [0m[35m            logger.fatal("Can't start; there is already a node named '%s' running", self.config['nam[0m
[30;1m135 | [0m[35m            sys.exit(1)[0m
[30;1m136 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m1310[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m299 | [0m[35m[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35mdef check_psycopg() -> None:[0m
[30;1m302 | [0m[35m    """Ensure at least one among :mod:`psycopg2` or :mod:`psycopg` libraries are available in the en[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m    .. note::[0m
[30;1m305 | [0m[35m        Patroni chooses :mod:`psycopg2` over :mod:`psycopg`, if possible.[0m

[31m--[ [0m[34mMatch #[0m[33m1311[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35m            return[0m
[30;1m129 | [0m[35m        try:[0m
[30;1m130 | [0m[35m            # Silence annoying WARNING: Retrying (...) messages when Patroni is quickly restarted.[0m
[30;1m131 | [0m[35m            # At this moment we don't have custom log levels configured and hence shouldn't lose any[0m
[30;1m132 | [0m[35m            self.logger.update_loggers({'urllib3.connectionpool': 'ERROR'})[0m
[30;1m133 | [0m[35m            _ = self.request(member, endpoint="/liveness", timeout=3)[0m
[30;1m134 | [0m[35m            logger.fatal("Can't start; there is already a node named '%s' running", self.config['nam[0m

[31m--[ [0m[34mMatch #[0m[33m1312[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m        ``bootstrap.dcs`` section from the configuration file.[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        .. note::[0m
[30;1m104 | [0m[35m            This method is called only once, at the time when Patroni is started.[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        :param cluster: a PostgreSQL or MPP implementation of :class:`Cluster`.[0m
[30;1m107 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1313[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m344 | [0m[35m    ``patroni`` daemon process.[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m    .. note::[0m
[30;1m347 | [0m[35m        If running through a Docker container, make the main process take care of init process dutie[0m
[30;1m348 | [0m[35m        ``patroni`` daemon as another process. In that case relevant signals received by the main pr[0m
[30;1m349 | [0m[35m        to ``patroni`` daemon process.[0m
[30;1m350 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1314[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m            # Release the GIL so we don't starve anyone waiting on async_executor lock[0m
[30;1m190 | [0m[35m            time.sleep(0.001)[0m
[30;1m191 | [0m[35m            # Warn user that Patroni is not keeping up[0m
[30;1m192 | [0m[35m            logger.warning("Loop time exceeded, rescheduling immediately.")[0m
[30;1m193 | [0m[35m        elif self.ha.watch(nap_time):[0m
[30;1m194 | [0m[35m            self.next_run = time.time()[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1315[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m            # At this moment we don't have custom log levels configured and hence shouldn't lose any[0m
[30;1m132 | [0m[35m            self.logger.update_loggers({'urllib3.connectionpool': 'ERROR'})[0m
[30;1m133 | [0m[35m            _ = self.request(member, endpoint="/liveness", timeout=3)[0m
[30;1m134 | [0m[35m            logger.fatal("Can't start; there is already a node named '%s' running", self.config['nam[0m
[30;1m135 | [0m[35m            sys.exit(1)[0m
[30;1m136 | [0m[35m        except Exception:[0m
[30;1m137 | [0m[35m            self.logger.update_loggers({})[0m

[31m--[ [0m[34mMatch #[0m[33m1316[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m        ``bootstrap.dcs`` section from the configuration file.[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        .. note::[0m
[30;1m104 | [0m[35m            This method is called only once, at the time when Patroni is started.[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        :param cluster: a PostgreSQL or MPP implementation of :class:`Cluster`.[0m
[30;1m107 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1317[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m    :ivar api: REST API server instance of this node.[0m
[30;1m34 | [0m[35m    :ivar request: wrapper for performing HTTP requests.[0m
[30;1m35 | [0m[35m    :ivar ha: HA handler.[0m
[30;1m36 | [0m[35m    :ivar next_run: time when to run the next HA loop cycle.[0m
[30;1m37 | [0m[35m    :ivar scheduled_restart: when a restart has been scheduled to occur, if any. In that case, shoul[0m
[30;1m38 | [0m[35m        * ``schedule``: timestamp when restart should occur;[0m
[30;1m39 | [0m[35m        * ``postmaster_start_time``: timestamp when Postgres was last started.[0m

[31m--[ [0m[34mMatch #[0m[33m1318[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport signal[0m
[30;1m9 | [0m[35mimport sys[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom argparse import Namespace[0m
[30;1m13 | [0m[35mfrom typing import Any, Dict, List, Optional, TYPE_CHECKING[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1319[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m                             "Error while advancing replication slot %s to position '%s': %r")[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m        # Should drop permanent physical slot on the primary for a node[0m
[30;1m317 | [0m[35m        # that is cascading from the other node if given slot has xmin set[0m
[30;1m318 | [0m[35m        with patch.object(SlotsHandler, '_query', Mock(side_effect=[[('test_1', 'physical', 1, 12345[0m
[30;1m319 | [0m[35m                                                                      None, None, None)], Exception][0m
[30;1m320 | [0m[35m            self.s.sync_replication_slots(cluster, self.tags)[0m

[31m--[ [0m[34mMatch #[0m[33m1320[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m313 | [0m[35m            self.assertEqual(mock_error.call_args[0][0],[0m
[30;1m314 | [0m[35m                             "Error while advancing replication slot %s to position '%s': %r")[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m        # Should drop permanent physical slot on the primary for a node[0m
[30;1m317 | [0m[35m        # that is cascading from the other node if given slot has xmin set[0m
[30;1m318 | [0m[35m        with patch.object(SlotsHandler, '_query', Mock(side_effect=[[('test_1', 'physical', 1, 12345[0m
[30;1m319 | [0m[35m                                                                      None, None, None)], Exception][0m
[30;1m320 | [0m[35m            self.s.sync_replication_slots(cluster, self.tags)[0m

[31m--[ [0m[34mMatch #[0m[33m1321[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m        self.other.data['xlog_location'] = 12346[0m
[30;1m304 | [0m[35m        global_config.update(cluster)[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m        # Should advance permanent physical slot on the primary for a node that is cascading from th[0m
[30;1m307 | [0m[35m        with patch.object(SlotsHandler, '_query', Mock(side_effect=[[('test_1', 'physical', None, 12[0m
[30;1m308 | [0m[35m                                                                      None, None, None)], Exception][0m
[30;1m309 | [0m[35m                patch('patroni.postgresql.slots.logger.error') as mock_error:[0m
[30;1m310 | [0m[35m            self.s.sync_replication_slots(cluster, self.tags)[0m

[31m--[ [0m[34mMatch #[0m[33m1322[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m        self.other.data['xlog_location'] = 12346[0m
[30;1m304 | [0m[35m        global_config.update(cluster)[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m        # Should advance permanent physical slot on the primary for a node that is cascading from th[0m
[30;1m307 | [0m[35m        with patch.object(SlotsHandler, '_query', Mock(side_effect=[[('test_1', 'physical', None, 12[0m
[30;1m308 | [0m[35m                                                                      None, None, None)], Exception][0m
[30;1m309 | [0m[35m                patch('patroni.postgresql.slots.logger.error') as mock_error:[0m

[31m--[ [0m[34mMatch #[0m[33m1323[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m            cluster.get_slot_name_on_primary(self.p.name, nostream_node),[0m
[30;1m165 | [0m[35m            None)[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        # check cascade member-slot existence on nostream node[0m
[30;1m168 | [0m[35m        self.assertEqual([0m
[30;1m169 | [0m[35m            cluster._get_members_slots(nostream_node.name, 'replica', False, True),[0m
[30;1m170 | [0m[35m            {'leader': {'type': 'physical', 'lsn': 99, 'expected_active': False},[0m
[30;1m171 | [0m[35m             'test_3': {'type': 'physical', 'lsn': 98, 'expected_active': True},[0m

[31m--[ [0m[34mMatch #[0m[33m1324[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # nostream node must not have slot on primary[0m
[30;1m158 | [0m[35m        self.p.name = nostream_node.name[0m
[30;1m159 | [0m[35m        # permanent logical slots are not allowed on nostream node[0m
[30;1m160 | [0m[35m        self.assertEqual([0m
[30;1m161 | [0m[35m            cluster._get_permanent_slots(self.p, nostream_node, 'replica'),[0m
[30;1m162 | [0m[35m            {'bar': {'type': 'physical'}})[0m
[30;1m163 | [0m[35m        self.assertEqual([0m

[31m--[ [0m[34mMatch #[0m[33m1325[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_slots.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m            {'test_3': {'type': 'physical', 'lsn': 98, 'expected_active': False},[0m
[30;1m155 | [0m[35m             'test_4': {'type': 'physical', 'lsn': 98, 'expected_active': True}})[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # nostream node must not have slot on primary[0m
[30;1m158 | [0m[35m        self.p.name = nostream_node.name[0m
[30;1m159 | [0m[35m        # permanent logical slots are not allowed on nostream node[0m
[30;1m160 | [0m[35m        self.assertEqual([0m

[31m--[ [0m[34mMatch #[0m[33m1326[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def test_get(self):[0m
[30;1m70 | [0m[35m        self.client.get(Mock(), '')[0m
[30;1m71 | [0m[35m        self.client.get(Mock(), '', {'wait': '1s', 'index': 1, 'token': 'foo'})[0m
[30;1m72 | [0m[35m        self.client.http.request.return_value.status = 500[0m
[30;1m73 | [0m[35m        self.client.http.request.return_value.data = b'Foo'[0m
[30;1m74 | [0m[35m        self.assertRaises(ConsulInternalError, self.client.get, Mock(), '')[0m

[31m--[ [0m[34mMatch #[0m[33m1327[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_consul.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        self.client.http.request = Mock()[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def test_get(self):[0m
[30;1m70 | [0m[35m        self.client.get(Mock(), '')[0m
[30;1m71 | [0m[35m        self.client.get(Mock(), '', {'wait': '1s', 'index': 1, 'token': 'foo'})[0m
[30;1m72 | [0m[35m        self.client.http.request.return_value.status = 500[0m
[30;1m73 | [0m[35m        self.client.http.request.return_value.data = b'Foo'[0m

[31m--[ [0m[34mMatch #[0m[33m1328[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_consul.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m            self.c.touch_member(d)[0m
[30;1m309 | [0m[35m            self.assertFalse(mock_deregister.called)[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m        # register_service staying True between reloads does calls register() if other service data [0m
[30;1m312 | [0m[35m        self.c.reload_config({'consul': {'register_service': True}, 'loop_wait': 10, 'ttl': 30, 'ret[0m
[30;1m313 | [0m[35m        with patch.object(Agent.Service, 'register') as mock_register:[0m
[30;1m314 | [0m[35m            self.c.touch_member(d)[0m

[31m--[ [0m[34mMatch #[0m[33m1329[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m247 | [0m[35m            ('sync', leader, 1, set('bc')),[0m
[30;1m248 | [0m[35m        ])[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        # Add in a new node at the same time[0m
[30;1m251 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bc'),[0m
[30;1m252 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('bcd'[0m
[30;1m253 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1330[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m221 | [0m[35m            ('quorum', leader, 1, set('bcd')),[0m
[30;1m222 | [0m[35m        ])[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Change replication factor at the same time[0m
[30;1m225 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m226 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=1, active=set('bc'[0m
[30;1m227 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1331[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35m            ('quorum', leader, 1, set('bc')),[0m
[30;1m208 | [0m[35m        ])[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        # Add in a new node at the same time, but node c didn't caught up yet[0m
[30;1m211 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m212 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=1, active=set('bcd[0m
[30;1m213 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1332[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m182 | [0m[35m            ('sync', leader, 1, set('c')),[0m
[30;1m183 | [0m[35m            ('restart', leader, 0, set()),[0m
[30;1m184 | [0m[35m        ])[0m
[30;1m185 | [0m[35m        # Update quorum when added node caught up[0m
[30;1m186 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set(),[0m
[30;1m187 | [0m[35m                                     numsync=1, sync=set('c'), numsync_confirmed=1, active=set('c'),[0m
[30;1m188 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1333[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m508 | [0m[35m            ('sync', leader, 2, set('bcde')),[0m
[30;1m509 | [0m[35m        ])[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m        # node b is also lost[0m
[30;1m512 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bcdef'),[0m
[30;1m513 | [0m[35m                                     numsync=4, sync=set('bcde'), numsync_confirmed=2, active=set('c[0m
[30;1m514 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1334[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m498 | [0m[35m            ('sync', leader, 2, set('bcdf')),[0m
[30;1m499 | [0m[35m        ])[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m        # node e returned[0m
[30;1m502 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bcdef'),[0m
[30;1m503 | [0m[35m                                     numsync=4, sync=set('bcde'), numsync_confirmed=2, active=set('b[0m
[30;1m504 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1335[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m490 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bcdef'),[0m
[30;1m491 | [0m[35m                                     numsync=4, sync=set('bcde'), numsync_confirmed=2, active=set('b[0m
[30;1m492 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m
[30;1m493 | [0m[35m            # replace node e with f in sync[0m
[30;1m494 | [0m[35m            ('sync', leader, 4, set('bcdf')),[0m
[30;1m495 | [0m[35m            # remove nodes e from voters with quorum decrease[0m
[30;1m496 | [0m[35m            ('quorum', leader, 2, set('bcdf')),[0m

[31m--[ [0m[34mMatch #[0m[33m1336[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m486 | [0m[35m            ('sync', leader, 2, set('bcdg')),[0m
[30;1m487 | [0m[35m        ])[0m
[30;1m488 | [0m[35m[0m
[30;1m489 | [0m[35m        # node f returned[0m
[30;1m490 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bcdef'),[0m
[30;1m491 | [0m[35m                                     numsync=4, sync=set('bcde'), numsync_confirmed=2, active=set('b[0m
[30;1m492 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1337[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m482 | [0m[35m            ('sync', leader, 3, set('bcd')),[0m
[30;1m483 | [0m[35m            # add node g to voters with quorum increase[0m
[30;1m484 | [0m[35m            ('quorum', leader, 2, set('bcdg')),[0m
[30;1m485 | [0m[35m            # add node g to sync and reduce replication factor[0m
[30;1m486 | [0m[35m            ('sync', leader, 2, set('bcdg')),[0m
[30;1m487 | [0m[35m        ])[0m
[30;1m488 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1338[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m480 | [0m[35m            ('quorum', leader, 1, set('bcd')),[0m
[30;1m481 | [0m[35m            # remove node e from sync and reduce replication factor[0m
[30;1m482 | [0m[35m            ('sync', leader, 3, set('bcd')),[0m
[30;1m483 | [0m[35m            # add node g to voters with quorum increase[0m
[30;1m484 | [0m[35m            ('quorum', leader, 2, set('bcdg')),[0m
[30;1m485 | [0m[35m            # add node g to sync and reduce replication factor[0m
[30;1m486 | [0m[35m            ('sync', leader, 2, set('bcdg')),[0m

[31m--[ [0m[34mMatch #[0m[33m1339[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m478 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m
[30;1m479 | [0m[35m            # remove nodes e and f from voters[0m
[30;1m480 | [0m[35m            ('quorum', leader, 1, set('bcd')),[0m
[30;1m481 | [0m[35m            # remove node e from sync and reduce replication factor[0m
[30;1m482 | [0m[35m            ('sync', leader, 3, set('bcd')),[0m
[30;1m483 | [0m[35m            # add node g to voters with quorum increase[0m
[30;1m484 | [0m[35m            ('quorum', leader, 2, set('bcdg')),[0m

[31m--[ [0m[34mMatch #[0m[33m1340[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m472 | [0m[35m            ('sync', leader, 2, set('bcd')),[0m
[30;1m473 | [0m[35m        ])[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m        # Interrupted state, and node g joined[0m
[30;1m476 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bcdef'),[0m
[30;1m477 | [0m[35m                                     numsync=4, sync=set('bcde'), numsync_confirmed=2, active=set('b[0m
[30;1m478 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1341[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m468 | [0m[35m            ('sync', leader, 4, set('bcde')),[0m
[30;1m469 | [0m[35m            # nodes e and f removed from voters with quorum decrease[0m
[30;1m470 | [0m[35m            ('quorum', leader, 1, set('bcd')),[0m
[30;1m471 | [0m[35m            # node e removed from sync with replication factor decrease[0m
[30;1m472 | [0m[35m            ('sync', leader, 2, set('bcd')),[0m
[30;1m473 | [0m[35m        ])[0m
[30;1m474 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1342[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m464 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bcdef'),[0m
[30;1m465 | [0m[35m                                     numsync=4, sync=set('bcdef'), numsync_confirmed=2, active=set('[0m
[30;1m466 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m
[30;1m467 | [0m[35m            # node f removed from sync[0m
[30;1m468 | [0m[35m            ('sync', leader, 4, set('bcde')),[0m
[30;1m469 | [0m[35m            # nodes e and f removed from voters with quorum decrease[0m
[30;1m470 | [0m[35m            ('quorum', leader, 1, set('bcd')),[0m

[31m--[ [0m[34mMatch #[0m[33m1343[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m460 | [0m[35m    def test_remove_nodes_with_decreasing_sync(self):[0m
[30;1m461 | [0m[35m        leader = 'a'[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m        # Remove node with decreasing sync[0m
[30;1m464 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bcdef'),[0m
[30;1m465 | [0m[35m                                     numsync=4, sync=set('bcdef'), numsync_confirmed=2, active=set('[0m
[30;1m466 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1344[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m385 | [0m[35m        # Beginning state: 1 of bc in sync. e.g. (a primary, ssn = ANY 1 (b c))[0m
[30;1m386 | [0m[35m        # a fails, d sees b and c, knows that it is in sync and decides to promote.[0m
[30;1m387 | [0m[35m        # We include in sync state former primary increasing replication factor[0m
[30;1m388 | [0m[35m        # and let situation resolve. Node d ssn=ANY 1 (b c)[0m
[30;1m389 | [0m[35m        leader = 'd'[0m
[30;1m390 | [0m[35m        self.check_state_transitions(leader='a', quorum=1, voters=set('bc'),[0m
[30;1m391 | [0m[35m                                     numsync=0, sync=set(), numsync_confirmed=0, active=set(),[0m

[31m--[ [0m[34mMatch #[0m[33m1345[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m331 | [0m[35m                                     sync_wanted=3, leader_wanted=leader, expected=[[0m
[30;1m332 | [0m[35m            # node e removed from sync with replication factor increase[0m
[30;1m333 | [0m[35m            ('sync', leader, 3, set('bcd')),[0m
[30;1m334 | [0m[35m            # node e removed from voters with quorum decrease[0m
[30;1m335 | [0m[35m            ('quorum', leader, 1, set('bcd')),[0m
[30;1m336 | [0m[35m        ])[0m
[30;1m337 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1346[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m329 | [0m[35m        self.check_state_transitions(leader=leader, quorum=2, voters=set('bcde'),[0m
[30;1m330 | [0m[35m                                     numsync=2, sync=set('bcde'), numsync_confirmed=2, active=set('b[0m
[30;1m331 | [0m[35m                                     sync_wanted=3, leader_wanted=leader, expected=[[0m
[30;1m332 | [0m[35m            # node e removed from sync with replication factor increase[0m
[30;1m333 | [0m[35m            ('sync', leader, 3, set('bcd')),[0m
[30;1m334 | [0m[35m            # node e removed from voters with quorum decrease[0m
[30;1m335 | [0m[35m            ('quorum', leader, 1, set('bcd')),[0m

[31m--[ [0m[34mMatch #[0m[33m1347[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m            ('sync', leader, 1, set('bcdef')),[0m
[30;1m326 | [0m[35m        ])[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        # Remove node with increasing sync and decreasing quorum[0m
[30;1m329 | [0m[35m        self.check_state_transitions(leader=leader, quorum=2, voters=set('bcde'),[0m
[30;1m330 | [0m[35m                                     numsync=2, sync=set('bcde'), numsync_confirmed=2, active=set('b[0m
[30;1m331 | [0m[35m                                     sync_wanted=3, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1348[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m319 | [0m[35m        self.check_state_transitions(leader=leader, quorum=2, voters=set('bcde'),[0m
[30;1m320 | [0m[35m                                     numsync=2, sync=set('bcde'), numsync_confirmed=2, active=set('b[0m
[30;1m321 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m
[30;1m322 | [0m[35m            # increase quorum by 2, 1 for added node and another for reduced sync[0m
[30;1m323 | [0m[35m            ('quorum', leader, 4, set('bcdef')),[0m
[30;1m324 | [0m[35m            # now reduce replication factor to requested value[0m
[30;1m325 | [0m[35m            ('sync', leader, 1, set('bcdef')),[0m

[31m--[ [0m[34mMatch #[0m[33m1349[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m315 | [0m[35m            ('quorum', leader, 1, set('bcde')),[0m
[30;1m316 | [0m[35m        ])[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        # Add node with decreasing sync and increasing quorum[0m
[30;1m319 | [0m[35m        self.check_state_transitions(leader=leader, quorum=2, voters=set('bcde'),[0m
[30;1m320 | [0m[35m                                     numsync=2, sync=set('bcde'), numsync_confirmed=2, active=set('b[0m
[30;1m321 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1350[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m            ('sync', leader, 1, set('bc')),[0m
[30;1m248 | [0m[35m        ])[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        # Add in a new node at the same time[0m
[30;1m251 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bc'),[0m
[30;1m252 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('bcd'[0m
[30;1m253 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m
[30;1m254 | [0m[35m            ('sync', leader, 1, set('bc')),[0m

[31m--[ [0m[34mMatch #[0m[33m1351[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m            ('sync', leader, 1, set('bc')),[0m
[30;1m248 | [0m[35m        ])[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        # Add in a new node at the same time[0m
[30;1m251 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bc'),[0m
[30;1m252 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('bcd'[0m
[30;1m253 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1352[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m            ('quorum', leader, 0, set('b')),[0m
[30;1m241 | [0m[35m        ])[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        # Node c is available transition to larger quorum set.[0m
[30;1m244 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bc'),[0m
[30;1m245 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('bc')[0m
[30;1m246 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1353[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m        """Interrupted transition from 2 node cluster to 3 node cluster with replication factor 2"""[0m
[30;1m234 | [0m[35m        leader = 'a'[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        # Node c went away, transition back to 2 node cluster[0m
[30;1m237 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bc'),[0m
[30;1m238 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('b'),[0m
[30;1m239 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1354[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m        """Interrupted transition from 2 node cluster to 3 node cluster with replication factor 2"""[0m
[30;1m234 | [0m[35m        leader = 'a'[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        # Node c went away, transition back to 2 node cluster[0m
[30;1m237 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bc'),[0m
[30;1m238 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('b'),[0m
[30;1m239 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1355[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m        ])[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    def test_2322(self):[0m
[30;1m233 | [0m[35m        """Interrupted transition from 2 node cluster to 3 node cluster with replication factor 2"""[0m
[30;1m234 | [0m[35m        leader = 'a'[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        # Node c went away, transition back to 2 node cluster[0m

[31m--[ [0m[34mMatch #[0m[33m1356[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m        ])[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    def test_2322(self):[0m
[30;1m233 | [0m[35m        """Interrupted transition from 2 node cluster to 3 node cluster with replication factor 2"""[0m
[30;1m234 | [0m[35m        leader = 'a'[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        # Node c went away, transition back to 2 node cluster[0m

[31m--[ [0m[34mMatch #[0m[33m1357[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35m            ('quorum', leader, 1, set('bcd')),[0m
[30;1m222 | [0m[35m        ])[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Change replication factor at the same time[0m
[30;1m225 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m226 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=1, active=set('bc'[0m
[30;1m227 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m
[30;1m228 | [0m[35m            ('quorum', leader, 1, set('bc')),[0m

[31m--[ [0m[34mMatch #[0m[33m1358[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m            ('quorum', leader, 1, set('bc')),[0m
[30;1m208 | [0m[35m        ])[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        # Add in a new node at the same time, but node c didn't caught up yet[0m
[30;1m211 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m212 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=1, active=set('bcd[0m
[30;1m213 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1359[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m            ('quorum', leader, 1, set('bc')),[0m
[30;1m208 | [0m[35m        ])[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        # Add in a new node at the same time, but node c didn't caught up yet[0m
[30;1m211 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m212 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=1, active=set('bcd[0m
[30;1m213 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1360[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m            ('sync', leader, 1, set('b')),[0m
[30;1m201 | [0m[35m        ])[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m        # Node c is available transition to larger quorum set, but not yet caught up.[0m
[30;1m204 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m205 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=1, active=set('bc'[0m
[30;1m206 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1361[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m        """Interrupted transition from 2 node cluster to 3 node fully sync cluster"""[0m
[30;1m194 | [0m[35m        leader = 'a'[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m        # Node c went away, transition back to 2 node cluster[0m
[30;1m197 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m198 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=1, active=set('b')[0m
[30;1m199 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1362[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m        """Interrupted transition from 2 node cluster to 3 node fully sync cluster"""[0m
[30;1m194 | [0m[35m        leader = 'a'[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m        # Node c went away, transition back to 2 node cluster[0m
[30;1m197 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m198 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=1, active=set('b')[0m
[30;1m199 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1363[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m        ])[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    def test_1233(self):[0m
[30;1m193 | [0m[35m        """Interrupted transition from 2 node cluster to 3 node fully sync cluster"""[0m
[30;1m194 | [0m[35m        leader = 'a'[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m        # Node c went away, transition back to 2 node cluster[0m

[31m--[ [0m[34mMatch #[0m[33m1364[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m        ])[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    def test_1233(self):[0m
[30;1m193 | [0m[35m        """Interrupted transition from 2 node cluster to 3 node fully sync cluster"""[0m
[30;1m194 | [0m[35m        leader = 'a'[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m        # Node c went away, transition back to 2 node cluster[0m

[31m--[ [0m[34mMatch #[0m[33m1365[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m182 | [0m[35m            ('sync', leader, 1, set('c')),[0m
[30;1m183 | [0m[35m            ('restart', leader, 0, set()),[0m
[30;1m184 | [0m[35m        ])[0m
[30;1m185 | [0m[35m        # Update quorum when added node caught up[0m
[30;1m186 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set(),[0m
[30;1m187 | [0m[35m                                     numsync=1, sync=set('c'), numsync_confirmed=1, active=set('c'),[0m
[30;1m188 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1366[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m            ('sync', leader, 2, set('bc')),[0m
[30;1m145 | [0m[35m            ('quorum', leader, 1, set('bc')),[0m
[30;1m146 | [0m[35m        ])[0m
[30;1m147 | [0m[35m        # Reduce quorum after added node caught up[0m
[30;1m148 | [0m[35m        self.check_state_transitions(leader=leader, quorum=1, voters=set('bc'),[0m
[30;1m149 | [0m[35m                                     numsync=2, sync=set('bc'), numsync_confirmed=2, active=set('bc'[0m
[30;1m150 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1367[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m            ('sync', leader, 1, set('bC')),[0m
[30;1m138 | [0m[35m        ])[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        # Add node by increasing sync[0m
[30;1m141 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m142 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('bc')[0m
[30;1m143 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1368[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('b'),[0m
[30;1m130 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[])[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        # Add node by increasing quorum[0m
[30;1m133 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set('b'),[0m
[30;1m134 | [0m[35m                                     numsync=1, sync=set('b'), numsync_confirmed=1, active=set('BC')[0m
[30;1m135 | [0m[35m                                     sync_wanted=1, leader_wanted=leader, expected=[[0m

[31m--[ [0m[34mMatch #[0m[33m1369[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m        ])[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def test_1222(self):[0m
[30;1m124 | [0m[35m        """2 node cluster"""[0m
[30;1m125 | [0m[35m        leader = 'a'[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        # Active set matches state[0m

[31m--[ [0m[34mMatch #[0m[33m1370[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m    def test_1111(self):[0m
[30;1m96 | [0m[35m        leader = 'a'[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        # Add node[0m
[30;1m99 | [0m[35m        self.check_state_transitions(leader=leader, quorum=0, voters=set(),[0m
[30;1m100 | [0m[35m                                     numsync=0, sync=set(), numsync_confirmed=0, active=set('b'),[0m
[30;1m101 | [0m[35m                                     sync_wanted=2, leader_wanted=leader, expected=[[0m
[30;1m102 | [0m[35m            ('sync', leader, 1, set('b')),[0m

[31m--[ [0m[34mMatch #[0m[33m1371[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35mFor additional background info, see:[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m* `Elephants on Automatic: HA Clustered PostgreSQL with Helm <https://www.youtube.com/watch?v=CftcVh[0m
[30;1m115 | [0m[35m* `PostgreSQL HA with Kubernetes and Patroni <https://www.youtube.com/watch?v=iruaCgeG7qs>`__, talk [0m
[30;1m116 | [0m[35m* `Feb. 2016 Zalando Tech blog post <https://engineering.zalando.com/posts/2016/02/zalandos-patroni-[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m==================[0m

[31m--[ [0m[34mMatch #[0m[33m1372[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35mFor additional background info, see:[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m* `Elephants on Automatic: HA Clustered PostgreSQL with Helm <https://www.youtube.com/watch?v=CftcVh[0m
[30;1m115 | [0m[35m* `PostgreSQL HA with Kubernetes and Patroni <https://www.youtube.com/watch?v=iruaCgeG7qs>`__, talk [0m
[30;1m116 | [0m[35m* `Feb. 2016 Zalando Tech blog post <https://engineering.zalando.com/posts/2016/02/zalandos-patroni-[0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1373[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35ms support page <https://github.com/patroni/patroni/blob/master/docs/citus.rst>`__ in the Patroni doc[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m**Note to Kubernetes users**: Patroni can run natively on top of Kubernetes. Take a look at the `Kub[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m.. contents::[0m
[30;1m102 | [0m[35m    :local:[0m
[30;1m103 | [0m[35m    :depth: 1[0m
[30;1m104 | [0m[35m    :backlinks: none[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m=================[0m
[30;1m107 | [0m[35mHow Patroni Works[0m
[30;1m108 | [0m[35m=================[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1374[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35mPatroni: A Template for PostgreSQL HA with ZooKeeper, etcd or Consul[0m
[30;1m84 | [0m[35m--------------------------------------------------------------------[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mYou can find a version of this documentation that is searchable and also easier to navigate at `patr[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mThere are many ways to run high availability with PostgreSQL; for a list, see the `PostgreSQL Docume[0m

[31m--[ [0m[34mMatch #[0m[33m1375[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m::[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    pip install patroni[psycopg3,etcd3,aws][0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35mNote that external tools to call in the replica creation or custom bootstrap scripts (i.e. WAL-E) sh[0m
[30;1m201 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1376[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m::[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    pip install patroni[dependencies][0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35mwhere dependencies can be either empty, or consist of one or more of the following:[0m
[30;1m170 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1377[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m156 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m**General installation for pip**[0m

[31m--[ [0m[34mMatch #[0m[33m1378[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m::[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m156 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m
[30;1m159 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1379[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m::[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m156 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m

[31m--[ [0m[34mMatch #[0m[33m1380[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35mostgres. Please check the `Citus support page <https://github.com/patroni/patroni/blob/master/docs/c[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m**Note to Kubernetes users**: Patroni can run natively on top of Kubernetes. Take a look at the `Kub[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m.. contents::[0m
[30;1m102 | [0m[35m    :local:[0m
[30;1m103 | [0m[35m    :depth: 1[0m
[30;1m104 | [0m[35m    :backlinks: none[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m=================[0m
[30;1m107 | [0m[35mHow Patroni Works[0m
[30;1m108 | [0m[35m=================[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1381[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mche.org/>`__, `etcd <https://github.com/coreos/etcd>`__, `Consul <https://github.com/hashicorp/consu[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mWe call Patroni a "template" because it is far from being a one-size-fits-all or plug-and-play repli[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mCurrently supported PostgreSQL versions: 9.3 to 17.[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1382[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35mPatroni: A Template for PostgreSQL HA with ZooKeeper, etcd or Consul[0m
[30;1m84 | [0m[35m--------------------------------------------------------------------[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mYou can find a version of this documentation that is searchable and also easier to navigate at `patr[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mThere are many ways to run high availability with PostgreSQL; for a list, see the `PostgreSQL Docume[0m

[31m--[ [0m[34mMatch #[0m[33m1383[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m        self.ttl = config['ttl'][0m
[30;1m49 | [0m[35m        self.loop_wait = config['loop_wait'][0m
[30;1m50 | [0m[35m        self.safety_margin = watchdog_config.get('safety_margin', 5)[0m
[30;1m51 | [0m[35m        self.driver = watchdog_config.get('driver', 'default')[0m
[30;1m52 | [0m[35m        self.driver_config = dict((k, v) for k, v in watchdog_config.items()[0m
[30;1m53 | [0m[35m                                  if k not in ['mode', 'safety_margin', 'driver'])[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1384[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m        self.mode = parse_mode(watchdog_config.get('mode', 'automatic'))[0m
[30;1m48 | [0m[35m        self.ttl = config['ttl'][0m
[30;1m49 | [0m[35m        self.loop_wait = config['loop_wait'][0m
[30;1m50 | [0m[35m        self.safety_margin = watchdog_config.get('safety_margin', 5)[0m
[30;1m51 | [0m[35m        self.driver = watchdog_config.get('driver', 'default')[0m
[30;1m52 | [0m[35m        self.driver_config = dict((k, v) for k, v in watchdog_config.items()[0m
[30;1m53 | [0m[35m                                  if k not in ['mode', 'safety_margin', 'driver'])[0m

[31m--[ [0m[34mMatch #[0m[33m1385[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m    def __init__(self, config: Config) -> None:[0m
[30;1m45 | [0m[35m        watchdog_config = config.get("watchdog") or {'mode': 'automatic'}[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        self.mode = parse_mode(watchdog_config.get('mode', 'automatic'))[0m
[30;1m48 | [0m[35m        self.ttl = config['ttl'][0m
[30;1m49 | [0m[35m        self.loop_wait = config['loop_wait'][0m
[30;1m50 | [0m[35m        self.safety_margin = watchdog_config.get('safety_margin', 5)[0m

[31m--[ [0m[34mMatch #[0m[33m1386[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35mclass WatchdogConfig(object):[0m
[30;1m43 | [0m[35m    """Helper to contain a snapshot of configuration"""[0m
[30;1m44 | [0m[35m    def __init__(self, config: Config) -> None:[0m
[30;1m45 | [0m[35m        watchdog_config = config.get("watchdog") or {'mode': 'automatic'}[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        self.mode = parse_mode(watchdog_config.get('mode', 'automatic'))[0m
[30;1m48 | [0m[35m        self.ttl = config['ttl'][0m

[31m--[ [0m[34mMatch #[0m[33m1387[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m        """Set the watchdog timer timeout.[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        :param timeout: watchdog timeout in seconds"""[0m
[30;1m295 | [0m[35m        raise WatchdogError("Setting timeout is not supported on {0}".format(self.describe()))[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m    def describe(self) -> str:[0m
[30;1m298 | [0m[35m        """Human readable name for this device"""[0m

[31m--[ [0m[34mMatch #[0m[33m1388[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m    def set_timeout(self, timeout: int) -> None:[0m
[30;1m292 | [0m[35m        """Set the watchdog timer timeout.[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        :param timeout: watchdog timeout in seconds"""[0m
[30;1m295 | [0m[35m        raise WatchdogError("Setting timeout is not supported on {0}".format(self.describe()))[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m    def describe(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1389[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m285 | [0m[35m        """Returns the current keepalive timeout in effect."""[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    def has_set_timeout(self) -> bool:[0m
[30;1m288 | [0m[35m        """Returns True if setting a timeout is supported."""[0m
[30;1m289 | [0m[35m        return False[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    def set_timeout(self, timeout: int) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1390[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    @abc.abstractmethod[0m
[30;1m284 | [0m[35m    def get_timeout(self) -> int:[0m
[30;1m285 | [0m[35m        """Returns the current keepalive timeout in effect."""[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    def has_set_timeout(self) -> bool:[0m
[30;1m288 | [0m[35m        """Returns True if setting a timeout is supported."""[0m

[31m--[ [0m[34mMatch #[0m[33m1391[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35mclass WatchdogBase(abc.ABC):[0m
[30;1m245 | [0m[35m    """A watchdog object when opened requires periodic calls to keepalive.[0m
[30;1m246 | [0m[35m    When keepalive is not called within a timeout the system will be terminated."""[0m
[30;1m247 | [0m[35m    is_null = False[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1392[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m196 | [0m[35m    def _disable(self) -> None:[0m
[30;1m197 | [0m[35m        try:[0m
[30;1m198 | [0m[35m            if self.impl.is_running and not self.impl.can_be_disabled:[0m
[30;1m199 | [0m[35m                # Give sysadmin some extra time to clean stuff up.[0m
[30;1m200 | [0m[35m                self.impl.keepalive()[0m
[30;1m201 | [0m[35m                logger.warning("Watchdog implementation can't be disabled. System will reboot after [0m
[30;1m202 | [0m[35m                               "{0} seconds when watchdog times out.".format(self.impl.get_timeout()[0m

[31m--[ [0m[34mMatch #[0m[33m1393[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m159 | [0m[35m                return False[0m
[30;1m160 | [0m[35m            else:[0m
[30;1m161 | [0m[35m                if not self.impl.is_null:[0m
[30;1m162 | [0m[35m                    logger.warning("Watchdog timeout {0} seconds does not ensure safe termination wi[0m
[30;1m163 | [0m[35m                                   .format(actual_timeout, self.config.timeout))[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        if self.is_running:[0m

[31m--[ [0m[34mMatch #[0m[33m1394[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m                    logger.error("Configuration requires watchdog, but watchdog could not be configu[0m
[30;1m155 | [0m[35m                else:[0m
[30;1m156 | [0m[35m                    logger.error("Configuration requires watchdog, but a safe watchdog timeout {0} c[0m
[30;1m157 | [0m[35m                                 " not be configured. Watchdog timeout is {1}.".format([0m
[30;1m158 | [0m[35m                                     self.config.timeout, actual_timeout))[0m
[30;1m159 | [0m[35m                return False[0m
[30;1m160 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1395[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m                if self.impl.is_null:[0m
[30;1m154 | [0m[35m                    logger.error("Configuration requires watchdog, but watchdog could not be configu[0m
[30;1m155 | [0m[35m                else:[0m
[30;1m156 | [0m[35m                    logger.error("Configuration requires watchdog, but a safe watchdog timeout {0} c[0m
[30;1m157 | [0m[35m                                 " not be configured. Watchdog timeout is {1}.".format([0m
[30;1m158 | [0m[35m                                     self.config.timeout, actual_timeout))[0m
[30;1m159 | [0m[35m                return False[0m

[31m--[ [0m[34mMatch #[0m[33m1396[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m    @synchronized[0m
[30;1m122 | [0m[35m    def activate(self) -> bool:[0m
[30;1m123 | [0m[35m        """Activates the watchdog device with suitable timeouts. While watchdog is active keepalive [0m
[30;1m124 | [0m[35m        to be called every time loop_wait expires.[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        :returns False if a safe watchdog could not be configured, but is required.[0m
[30;1m127 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1397[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m            self.active_config = self.config[0m
[30;1m112 | [0m[35m            self.impl = NullWatchdog()[0m
[30;1m113 | [0m[35m        # If watchdog is not active we can apply config immediately to show any warnings early. Othe[0m
[30;1m114 | [0m[35m        # delay until next time a keepalive is sent so timeout matches up with leader key update.[0m
[30;1m115 | [0m[35m        if not self.active:[0m
[30;1m116 | [0m[35m            if self.config.driver != self.active_config.driver or \[0m
[30;1m117 | [0m[35m               self.config.driver_config != self.active_config.driver_config:[0m

[31m--[ [0m[34mMatch #[0m[33m1398[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m            self.active_config = self.config[0m
[30;1m112 | [0m[35m            self.impl = NullWatchdog()[0m
[30;1m113 | [0m[35m        # If watchdog is not active we can apply config immediately to show any warnings early. Othe[0m
[30;1m114 | [0m[35m        # delay until next time a keepalive is sent so timeout matches up with leader key update.[0m
[30;1m115 | [0m[35m        if not self.active:[0m
[30;1m116 | [0m[35m            if self.config.driver != self.active_config.driver or \[0m
[30;1m117 | [0m[35m               self.config.driver_config != self.active_config.driver_config:[0m

[31m--[ [0m[34mMatch #[0m[33m1399[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35mFor additional background info, see:[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m* `Elephants on Automatic: HA Clustered PostgreSQL with Helm <https://www.youtube.com/watch?v=CftcVh[0m
[30;1m115 | [0m[35m* `PostgreSQL HA with Kubernetes and Patroni <https://www.youtube.com/watch?v=iruaCgeG7qs>`__, talk [0m
[30;1m116 | [0m[35m* `Feb. 2016 Zalando Tech blog post <https://engineering.zalando.com/posts/2016/02/zalandos-patroni-[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m==================[0m

[31m--[ [0m[34mMatch #[0m[33m1400[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35mFor additional background info, see:[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m* `Elephants on Automatic: HA Clustered PostgreSQL with Helm <https://www.youtube.com/watch?v=CftcVh[0m
[30;1m115 | [0m[35m* `PostgreSQL HA with Kubernetes and Patroni <https://www.youtube.com/watch?v=iruaCgeG7qs>`__, talk [0m
[30;1m116 | [0m[35m* `Feb. 2016 Zalando Tech blog post <https://engineering.zalando.com/posts/2016/02/zalandos-patroni-[0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1401[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35ms support page <https://github.com/patroni/patroni/blob/master/docs/citus.rst>`__ in the Patroni doc[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m**Note to Kubernetes users**: Patroni can run natively on top of Kubernetes. Take a look at the `Kub[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m.. contents::[0m
[30;1m102 | [0m[35m    :local:[0m
[30;1m103 | [0m[35m    :depth: 1[0m
[30;1m104 | [0m[35m    :backlinks: none[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m=================[0m
[30;1m107 | [0m[35mHow Patroni Works[0m
[30;1m108 | [0m[35m=================[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1402[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35mPatroni: A Template for PostgreSQL HA with ZooKeeper, etcd or Consul[0m
[30;1m84 | [0m[35m--------------------------------------------------------------------[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mYou can find a version of this documentation that is searchable and also easier to navigate at `patr[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mThere are many ways to run high availability with PostgreSQL; for a list, see the `PostgreSQL Docume[0m

[31m--[ [0m[34mMatch #[0m[33m1403[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m::[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    pip install patroni[psycopg3,etcd3,aws][0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35mNote that external tools to call in the replica creation or custom bootstrap scripts (i.e. WAL-E) sh[0m
[30;1m201 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1404[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m::[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    pip install patroni[dependencies][0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35mwhere dependencies can be either empty, or consist of one or more of the following:[0m
[30;1m170 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1405[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m156 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m**General installation for pip**[0m

[31m--[ [0m[34mMatch #[0m[33m1406[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m::[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m156 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m
[30;1m159 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1407[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m::[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m156 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m

[31m--[ [0m[34mMatch #[0m[33m1408[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35mostgres. Please check the `Citus support page <https://github.com/patroni/patroni/blob/master/docs/c[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m**Note to Kubernetes users**: Patroni can run natively on top of Kubernetes. Take a look at the `Kub[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m.. contents::[0m
[30;1m102 | [0m[35m    :local:[0m
[30;1m103 | [0m[35m    :depth: 1[0m
[30;1m104 | [0m[35m    :backlinks: none[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m=================[0m
[30;1m107 | [0m[35mHow Patroni Works[0m
[30;1m108 | [0m[35m=================[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1409[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mche.org/>`__, `etcd <https://github.com/coreos/etcd>`__, `Consul <https://github.com/hashicorp/consu[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mWe call Patroni a "template" because it is far from being a one-size-fits-all or plug-and-play repli[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mCurrently supported PostgreSQL versions: 9.3 to 17.[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1410[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35mPatroni: A Template for PostgreSQL HA with ZooKeeper, etcd or Consul[0m
[30;1m84 | [0m[35m--------------------------------------------------------------------[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mYou can find a version of this documentation that is searchable and also easier to navigate at `patr[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mThere are many ways to run high availability with PostgreSQL; for a list, see the `PostgreSQL Docume[0m

[31m--[ [0m[34mMatch #[0m[33m1411[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m32 | [0m[35mFor additional background info, see:[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m* `Elephants on Automatic: HA Clustered PostgreSQL with Helm <https://www.youtube.com/watch?v=CftcVh[0m
[30;1m35 | [0m[35m* `PostgreSQL HA with Kubernetes and Patroni <https://www.youtube.com/watch?v=iruaCgeG7qs>`__, talk [0m
[30;1m36 | [0m[35m* `Feb. 2016 Zalando Tech blog post <https://engineering.zalando.com/posts/2016/02/zalandos-patroni-[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m==================[0m

[31m--[ [0m[34mMatch #[0m[33m1412[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mFor additional background info, see:[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m* `Elephants on Automatic: HA Clustered PostgreSQL with Helm <https://www.youtube.com/watch?v=CftcVh[0m
[30;1m35 | [0m[35m* `PostgreSQL HA with Kubernetes and Patroni <https://www.youtube.com/watch?v=iruaCgeG7qs>`__, talk [0m
[30;1m36 | [0m[35m* `Feb. 2016 Zalando Tech blog post <https://engineering.zalando.com/posts/2016/02/zalandos-patroni-[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1413[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35ms support page <https://github.com/patroni/patroni/blob/master/docs/citus.rst>`__ in the Patroni doc[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m**Note to Kubernetes users**: Patroni can run natively on top of Kubernetes. Take a look at the `Kub[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m.. contents::[0m
[30;1m22 | [0m[35m    :local:[0m
[30;1m23 | [0m[35m    :depth: 1[0m
[30;1m24 | [0m[35m    :backlinks: none[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m=================[0m
[30;1m27 | [0m[35mHow Patroni Works[0m
[30;1m28 | [0m[35m=================[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1414[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35mPatroni: A Template for PostgreSQL HA with ZooKeeper, etcd or Consul[0m
[30;1m4 | [0m[35m--------------------------------------------------------------------[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mYou can find a version of this documentation that is searchable and also easier to navigate at `patr[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mThere are many ways to run high availability with PostgreSQL; for a list, see the `PostgreSQL Docume[0m

[31m--[ [0m[34mMatch #[0m[33m1415[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m::[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    pip install patroni[psycopg3,etcd3,aws][0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35mNote that external tools to call in the replica creation or custom bootstrap scripts (i.e. WAL-E) sh[0m
[30;1m121 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1416[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m::[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    pip install patroni[dependencies][0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mwhere dependencies can be either empty, or consist of one or more of the following:[0m
[30;1m90 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1417[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m76 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m**General installation for pip**[0m

[31m--[ [0m[34mMatch #[0m[33m1418[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m::[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m76 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1419[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m::[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    sudo apt-get install python3-psycopg2  # install psycopg2 module on Debian/Ubuntu[0m
[30;1m76 | [0m[35m    sudo yum install python3-psycopg2      # install psycopg2 on RedHat/Fedora/CentOS[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m2. Specify one of `psycopg`, `psycopg2`, or `psycopg2-binary` in the list of dependencies when insta[0m

[31m--[ [0m[34mMatch #[0m[33m1420[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mostgres. Please check the `Citus support page <https://github.com/patroni/patroni/blob/master/docs/c[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m**Note to Kubernetes users**: Patroni can run natively on top of Kubernetes. Take a look at the `Kub[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m.. contents::[0m
[30;1m22 | [0m[35m    :local:[0m
[30;1m23 | [0m[35m    :depth: 1[0m
[30;1m24 | [0m[35m    :backlinks: none[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m=================[0m
[30;1m27 | [0m[35mHow Patroni Works[0m
[30;1m28 | [0m[35m=================[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1421[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mche.org/>`__, `etcd <https://github.com/coreos/etcd>`__, `Consul <https://github.com/hashicorp/consu[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mWe call Patroni a "template" because it is far from being a one-size-fits-all or plug-and-play repli[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35mCurrently supported PostgreSQL versions: 9.3 to 17.[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1422[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mPatroni: A Template for PostgreSQL HA with ZooKeeper, etcd or Consul[0m
[30;1m4 | [0m[35m--------------------------------------------------------------------[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mYou can find a version of this documentation that is searchable and also easier to navigate at `patr[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mThere are many ways to run high availability with PostgreSQL; for a list, see the `PostgreSQL Docume[0m

[31m--[ [0m[34mMatch #[0m[33m1423[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m
[30;1m428 | [0m[35m        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \[0m
[30;1m429 | [0m[35m            getpass('Please enter the user password:')[0m
[30;1m430 | [0m[35m        self.config['postgresql']['authentication'] = {[0m
[30;1m431 | [0m[35m            'superuser': su_params,[0m

[31m--[ [0m[34mMatch #[0m[33m1424[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m
[30;1m428 | [0m[35m        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \[0m

[31m--[ [0m[34mMatch #[0m[33m1425[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m
[30;1m428 | [0m[35m        su_params['password'] = su_params.get('password', patroni_env_su_pwd) or \[0m

[31m--[ [0m[34mMatch #[0m[33m1426[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m421 | [0m[35m                su_params[conn_param] = val[0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m
[30;1m427 | [0m[35m        su_params['username'] = su_params.pop('user', patroni_env_su_username) or getuser()[0m

[31m--[ [0m[34mMatch #[0m[33m1427[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m            if val:[0m
[30;1m421 | [0m[35m                su_params[conn_param] = val[0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m

[31m--[ [0m[34mMatch #[0m[33m1428[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m            if val:[0m
[30;1m421 | [0m[35m                su_params[conn_param] = val[0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m
[30;1m426 | [0m[35m        # because we use "username" in the config for some reason[0m

[31m--[ [0m[34mMatch #[0m[33m1429[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m419 | [0m[35m            val = self.parsed_dsn.get(conn_param, os.getenv(env_var))[0m
[30;1m420 | [0m[35m            if val:[0m
[30;1m421 | [0m[35m                su_params[conn_param] = val[0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m
[30;1m423 | [0m[35m                                    or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('username')[0m
[30;1m424 | [0m[35m        patroni_env_su_pwd = ((self.config.get('authentication')[0m
[30;1m425 | [0m[35m                               or EMPTY_DICT).get('superuser') or EMPTY_DICT).get('password')[0m

[31m--[ [0m[34mMatch #[0m[33m1430[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m416 | [0m[35m        """[0m
[30;1m417 | [0m[35m        su_params: Dict[str, str] = {}[0m
[30;1m418 | [0m[35m        for conn_param, env_var in _AUTH_ALLOWED_PARAMETERS_MAPPING.items():[0m
[30;1m419 | [0m[35m            val = self.parsed_dsn.get(conn_param, os.getenv(env_var))[0m
[30;1m420 | [0m[35m            if val:[0m
[30;1m421 | [0m[35m                su_params[conn_param] = val[0m
[30;1m422 | [0m[35m        patroni_env_su_username = ((self.config.get('authentication')[0m

[31m--[ [0m[34mMatch #[0m[33m1431[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m                self.config['bootstrap']['dcs']['postgresql']['parameters'][param] = value[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        connect_ip = self.config['postgresql']['connect_address'].rsplit(':')[0][0m
[30;1m408 | [0m[35m        connect_port = self.parsed_dsn.get('port', os.getenv('PGPORT', helper_dict['port']))[0m
[30;1m409 | [0m[35m        self.config['postgresql']['connect_address'] = f'{connect_ip}:{connect_port}'[0m
[30;1m410 | [0m[35m        self.config['postgresql']['listen'] = f'{helper_dict["listen_addresses"]}:{helper_dict["port[0m
[30;1m411 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1432[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        postgres_bin = ((self.config.get('postgresql')[0m
[30;1m253 | [0m[35m                         or EMPTY_DICT).get('bin_name') or EMPTY_DICT).get('postgres', 'postgres')[0m
[30;1m254 | [0m[35m        return postgres_major_version_to_int(get_major_version(self.config['postgresql'].get('bin_di[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    def generate(self) -> None:[0m
[30;1m257 | [0m[35m        """Generate sample config using some sane defaults and update :attr:`~AbstractConfigGenerato[0m

[31m--[ [0m[34mMatch #[0m[33m1433[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m                  :func:`~patroni.utils.get_major_version`.[0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        postgres_bin = ((self.config.get('postgresql')[0m
[30;1m253 | [0m[35m                         or EMPTY_DICT).get('bin_name') or EMPTY_DICT).get('postgres', 'postgres')[0m
[30;1m254 | [0m[35m        return postgres_major_version_to_int(get_major_version(self.config['postgresql'].get('bin_di[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    def generate(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1434[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m                  :func:`~patroni.utils.get_major_version`.[0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        postgres_bin = ((self.config.get('postgresql')[0m
[30;1m253 | [0m[35m                         or EMPTY_DICT).get('bin_name') or EMPTY_DICT).get('postgres', 'postgres')[0m
[30;1m254 | [0m[35m        return postgres_major_version_to_int(get_major_version(self.config['postgresql'].get('bin_di[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    def generate(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1435[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m                  See :func:`~patroni.postgresql.misc.postgres_major_version_to_int` and[0m
[30;1m250 | [0m[35m                  :func:`~patroni.utils.get_major_version`.[0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        postgres_bin = ((self.config.get('postgresql')[0m
[30;1m253 | [0m[35m                         or EMPTY_DICT).get('bin_name') or EMPTY_DICT).get('postgres', 'postgres')[0m
[30;1m254 | [0m[35m        return postgres_major_version_to_int(get_major_version(self.config['postgresql'].get('bin_di[0m
[30;1m255 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1436[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m91 | [0m[35m    def get_template_config(cls) -> Dict[str, Any]:[0m
[30;1m92 | [0m[35m        """Generate a template config for further extension (e.g. in the inherited classes).[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        :returns: dictionary with the values gathered from Patroni env, hopefully defined hostname a[0m
[30;1m95 | [0m[35m                  (otherwise set to :data:`~patroni.config_generator.NO_VALUE_MSG`), and some sane d[0m
[30;1m96 | [0m[35m        """[0m
[30;1m97 | [0m[35m        _HOSTNAME, _IP = get_address()[0m

[31m--[ [0m[34mMatch #[0m[33m1437[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m62 | [0m[35m        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on I[0m
[30;1m63 | [0m[35m        addrs = [(a[0], a[4][0]) for a in socket.getaddrinfo(hostname, 0, socket.AF_UNSPEC, socket.S[0m
[30;1m64 | [0m[35m                 if isinstance(a[4][0], str)][0m
[30;1m65 | [0m[35m        return hostname, sorted(addrs, key=lambda x: x[0])[0][1][0m
[30;1m66 | [0m[35m    except Exception as err:[0m
[30;1m67 | [0m[35m        logging.warning('Failed to obtain address: %r', err)[0m
[30;1m68 | [0m[35m        return NO_VALUE_MSG, NO_VALUE_MSG[0m

[31m--[ [0m[34mMatch #[0m[33m1438[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m60 | [0m[35m    try:[0m
[30;1m61 | [0m[35m        hostname = socket.gethostname()[0m
[30;1m62 | [0m[35m        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on I[0m
[30;1m63 | [0m[35m        addrs = [(a[0], a[4][0]) for a in socket.getaddrinfo(hostname, 0, socket.AF_UNSPEC, socket.S[0m
[30;1m64 | [0m[35m                 if isinstance(a[4][0], str)][0m
[30;1m65 | [0m[35m        return hostname, sorted(addrs, key=lambda x: x[0])[0][1][0m
[30;1m66 | [0m[35m    except Exception as err:[0m

[31m--[ [0m[34mMatch #[0m[33m1439[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m58 | [0m[35m    """[0m
[30;1m59 | [0m[35m    hostname = None[0m
[30;1m60 | [0m[35m    try:[0m
[30;1m61 | [0m[35m        hostname = socket.gethostname()[0m
[30;1m62 | [0m[35m        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on I[0m
[30;1m63 | [0m[35m        addrs = [(a[0], a[4][0]) for a in socket.getaddrinfo(hostname, 0, socket.AF_UNSPEC, socket.S[0m
[30;1m64 | [0m[35m                 if isinstance(a[4][0], str)][0m

[31m--[ [0m[34mMatch #[0m[33m1440[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m56 | [0m[35m        Sorting guarantees it will prefer IPv4.[0m
[30;1m57 | [0m[35m        If an exception occurred, hostname and ip values are equal to :data:`~patroni.config_generat[0m
[30;1m58 | [0m[35m    """[0m
[30;1m59 | [0m[35m    hostname = None[0m
[30;1m60 | [0m[35m    try:[0m
[30;1m61 | [0m[35m        hostname = socket.gethostname()[0m
[30;1m62 | [0m[35m        # Filter out unexpected results when python is compiled with --disable-ipv6 and running on I[0m

[31m--[ [0m[34mMatch #[0m[33m1441[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m54 | [0m[35m    :returns: tuple consisting of the hostname returned by :func:`~socket.gethostname`[0m
[30;1m55 | [0m[35m        and the first element in the sorted list of the addresses returned by :func:`~socket.getaddr[0m
[30;1m56 | [0m[35m        Sorting guarantees it will prefer IPv4.[0m
[30;1m57 | [0m[35m        If an exception occurred, hostname and ip values are equal to :data:`~patroni.config_generat[0m
[30;1m58 | [0m[35m    """[0m
[30;1m59 | [0m[35m    hostname = None[0m
[30;1m60 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m1442[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m51 | [0m[35m    .. note::[0m
[30;1m52 | [0m[35m        Can also return local ip.[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    :returns: tuple consisting of the hostname returned by :func:`~socket.gethostname`[0m
[30;1m55 | [0m[35m        and the first element in the sorted list of the addresses returned by :func:`~socket.getaddr[0m
[30;1m56 | [0m[35m        Sorting guarantees it will prefer IPv4.[0m
[30;1m57 | [0m[35m        If an exception occurred, hostname and ip values are equal to :data:`~patroni.config_generat[0m

[31m--[ [0m[34mMatch #[0m[33m1443[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef get_address() -> Tuple[str, str]:[0m
[30;1m49 | [0m[35m    """Try to get hostname and the ip address for it returned by :func:`~socket.gethostname`.[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    .. note::[0m
[30;1m52 | [0m[35m        Can also return local ip.[0m

[31m--[ [0m[34mMatch #[0m[33m1444[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m254 | [0m[35m        return postgres_major_version_to_int(get_major_version(self.config['postgresql'].get('bin_di[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    def generate(self) -> None:[0m
[30;1m257 | [0m[35m        """Generate sample config using some sane defaults and update :attr:`~AbstractConfigGenerato[0m
[30;1m258 | [0m[35m        self.pg_major = self._get_int_major_version()[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        self.config['postgresql']['parameters'] = {'password_encryption': self.get_auth_method}[0m

[31m--[ [0m[34mMatch #[0m[33m1445[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m489 | [0m[35m        self._set_conf_files()[0m
[30;1m490 | [0m[35m[0m
[30;1m491 | [0m[35m    def generate(self) -> None:[0m
[30;1m492 | [0m[35m        """Generate config using the info gathered from the specified running PG instance.[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m        Result is written to :attr:`~RunningClusterConfigGenerator.config`.[0m
[30;1m495 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1446[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m367 | [0m[35m            raise PatroniException(f'Failed to establish PostgreSQL connection: {e}')[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m    def _set_pg_params(self, cur: Union['cursor', 'Cursor[Any]']) -> None:[0m
[30;1m370 | [0m[35m        """Extend :attr:`~RunningClusterConfigGenerator.config` with the actual PG GUCs values.[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m        THe following GUC values are set:[0m
[30;1m373 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1447[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m    @contextmanager[0m
[30;1m354 | [0m[35m    def _get_connection_cursor(self) -> Iterator[Union['cursor', 'Cursor[Any]']]:[0m
[30;1m355 | [0m[35m        """Get cursor for the PG connection established based on the stored information.[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m        :raises:[0m
[30;1m358 | [0m[35m            :exc:`~patroni.exceptions.PatroniException`: if :exc:`psycopg.Error` occurred.[0m

[31m--[ [0m[34mMatch #[0m[33m1448[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    @property[0m
[30;1m238 | [0m[35m    def get_auth_method(self) -> str:[0m
[30;1m239 | [0m[35m        """Return the preferred authentication method for a specific PG version if provided or the d[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m        :returns: :class:`str` value for the preferred authentication method.[0m
[30;1m242 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1449[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35mclass SampleConfigGenerator(AbstractConfigGenerator):[0m
[30;1m232 | [0m[35m    """Object representing the generated sample Patroni config.[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    Sane defaults are used based on the gathered PG version.[0m
[30;1m235 | [0m[35m    """[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1450[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m        dynamic_config = Config.get_default_config()[0m
[30;1m139 | [0m[35m        # to properly dump CaseInsensitiveDict as YAML later[0m
[30;1m140 | [0m[35m        dynamic_config['postgresql']['parameters'] = dict(dynamic_config['postgresql']['parameters'][0m
[30;1m141 | [0m[35m        config = Config('', None).local_configuration  # Get values from env[0m
[30;1m142 | [0m[35m        config.setdefault('bootstrap', {})['dcs'] = dynamic_config[0m
[30;1m143 | [0m[35m        config.setdefault('postgresql', {})[0m
[30;1m144 | [0m[35m        del config['bootstrap']['dcs']['standby_cluster'][0m
[30;1m145 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1451[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m    def get_template_config(cls) -> Dict[str, Any]:[0m
[30;1m92 | [0m[35m        """Generate a template config for further extension (e.g. in the inherited classes).[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        :returns: dictionary with the values gathered from Patroni env, hopefully defined hostname a[0m
[30;1m95 | [0m[35m                  (otherwise set to :data:`~patroni.config_generator.NO_VALUE_MSG`), and some sane d[0m
[30;1m96 | [0m[35m        """[0m
[30;1m97 | [0m[35m        _HOSTNAME, _IP = get_address()[0m

[31m--[ [0m[34mMatch #[0m[33m1452[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m    :returns: tuple consisting of the hostname returned by :func:`~socket.gethostname`[0m
[30;1m55 | [0m[35m        and the first element in the sorted list of the addresses returned by :func:`~socket.getaddr[0m
[30;1m56 | [0m[35m        Sorting guarantees it will prefer IPv4.[0m
[30;1m57 | [0m[35m        If an exception occurred, hostname and ip values are equal to :data:`~patroni.config_generat[0m
[30;1m58 | [0m[35m    """[0m
[30;1m59 | [0m[35m    hostname = None[0m
[30;1m60 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m1453[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef get_address() -> Tuple[str, str]:[0m
[30;1m49 | [0m[35m    """Try to get hostname and the ip address for it returned by :func:`~socket.gethostname`.[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    .. note::[0m
[30;1m52 | [0m[35m        Can also return local ip.[0m

[31m--[ [0m[34mMatch #[0m[33m1454[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    @classmethod[0m
[30;1m133 | [0m[35m    def from_config(cls, config: Dict[str, Any]) -> 'LinuxWatchdogDevice':[0m
[30;1m134 | [0m[35m        device = config.get('device', cls.DEFAULT_DEVICE)[0m
[30;1m135 | [0m[35m        return cls(device)[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1455[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m185 | [0m[35m        return self._support_cache[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    def describe(self) -> str:[0m
[30;1m188 | [0m[35m        dev_str = " at {0}".format(self.device) if self.device != self.DEFAULT_DEVICE else ""[0m
[30;1m189 | [0m[35m        ver_str = ""[0m
[30;1m190 | [0m[35m        identity = "Linux watchdog device"[0m
[30;1m191 | [0m[35m        if self._fd:[0m

[31m--[ [0m[34mMatch #[0m[33m1456[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m        buf = "Ctimeout={0}\n".format(timeout).encode('utf8')[0m
[30;1m241 | [0m[35m        while len(buf):[0m
[30;1m242 | [0m[35m            buf = buf[os.write(self._fd, buf):][0m
[30;1m243 | [0m[35m        self.timeout = timeout[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    def get_timeout(self) -> int:[0m
[30;1m246 | [0m[35m        return self.timeout[0m

[31m--[ [0m[34mMatch #[0m[33m1457[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35mclass TestingWatchdogDevice(LinuxWatchdogDevice):  # pragma: no cover[0m
[30;1m231 | [0m[35m    """Converts timeout ioctls to regular writes that can be intercepted from a named pipe."""[0m
[30;1m232 | [0m[35m    timeout = 60[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    def get_support(self) -> WatchdogInfo:[0m
[30;1m235 | [0m[35m        return WatchdogInfo(WDIOF['MAGICCLOSE'] | WDIOF['SETTIMEOUT'], 0, "Watchdog test harness")[0m

[31m--[ [0m[34mMatch #[0m[33m1458[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35mclass TestingWatchdogDevice(LinuxWatchdogDevice):  # pragma: no cover[0m
[30;1m231 | [0m[35m    """Converts timeout ioctls to regular writes that can be intercepted from a named pipe."""[0m
[30;1m232 | [0m[35m    timeout = 60[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    def get_support(self) -> WatchdogInfo:[0m

[31m--[ [0m[34mMatch #[0m[33m1459[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m        try:[0m
[30;1m224 | [0m[35m            self._ioctl(WDIOC_GETTIMEOUT, timeout)[0m
[30;1m225 | [0m[35m        except (WatchdogError, OSError, IOError) as e:[0m
[30;1m226 | [0m[35m            raise WatchdogError("Could not get timeout on watchdog device: {}".format(e))[0m
[30;1m227 | [0m[35m        return timeout.value[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1460[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m219 | [0m[35m            raise WatchdogError("Could not set timeout on watchdog device: {}".format(e))[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m    def get_timeout(self) -> int:[0m
[30;1m222 | [0m[35m        timeout = ctypes.c_int()[0m
[30;1m223 | [0m[35m        try:[0m
[30;1m224 | [0m[35m            self._ioctl(WDIOC_GETTIMEOUT, timeout)[0m
[30;1m225 | [0m[35m        except (WatchdogError, OSError, IOError) as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1461[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m        try:[0m
[30;1m217 | [0m[35m            self._ioctl(WDIOC_SETTIMEOUT, ctypes.c_int(timeout))[0m
[30;1m218 | [0m[35m        except (WatchdogError, OSError, IOError) as e:[0m
[30;1m219 | [0m[35m            raise WatchdogError("Could not set timeout on watchdog device: {}".format(e))[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m    def get_timeout(self) -> int:[0m
[30;1m222 | [0m[35m        timeout = ctypes.c_int()[0m

[31m--[ [0m[34mMatch #[0m[33m1462[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m212 | [0m[35m    def set_timeout(self, timeout: int) -> None:[0m
[30;1m213 | [0m[35m        timeout = int(timeout)[0m
[30;1m214 | [0m[35m        if not 0 < timeout < 0xFFFF:[0m
[30;1m215 | [0m[35m            raise WatchdogError("Invalid timeout {0}. Supported values are between 1 and 65535".form[0m
[30;1m216 | [0m[35m        try:[0m
[30;1m217 | [0m[35m            self._ioctl(WDIOC_SETTIMEOUT, ctypes.c_int(timeout))[0m
[30;1m218 | [0m[35m        except (WatchdogError, OSError, IOError) as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1463[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    def set_timeout(self, timeout: int) -> None:[0m
[30;1m213 | [0m[35m        timeout = int(timeout)[0m
[30;1m214 | [0m[35m        if not 0 < timeout < 0xFFFF:[0m
[30;1m215 | [0m[35m            raise WatchdogError("Invalid timeout {0}. Supported values are between 1 and 65535".form[0m
[30;1m216 | [0m[35m        try:[0m
[30;1m217 | [0m[35m            self._ioctl(WDIOC_SETTIMEOUT, ctypes.c_int(timeout))[0m

[31m--[ [0m[34mMatch #[0m[33m1464[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m        return self.get_support().has_SETTIMEOUT[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    def set_timeout(self, timeout: int) -> None:[0m
[30;1m213 | [0m[35m        timeout = int(timeout)[0m
[30;1m214 | [0m[35m        if not 0 < timeout < 0xFFFF:[0m
[30;1m215 | [0m[35m            raise WatchdogError("Invalid timeout {0}. Supported values are between 1 and 65535".form[0m
[30;1m216 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1465[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35m            raise WatchdogError("Could not send watchdog keepalive: {0}".format(e))[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    def has_set_timeout(self) -> bool:[0m
[30;1m209 | [0m[35m        """Returns True if setting a timeout is supported."""[0m
[30;1m210 | [0m[35m        return self.get_support().has_SETTIMEOUT[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    def set_timeout(self, timeout: int) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1466[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/watchdog/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m    "POWERUNDER": 0x0010,     # Power bad/power fault[0m
[30;1m92 | [0m[35m    "CARDRESET": 0x0020,      # Card previously reset the CPU[0m
[30;1m93 | [0m[35m    "POWEROVER": 0x0040,      # Power over voltage[0m
[30;1m94 | [0m[35m    "SETTIMEOUT": 0x0080,     # Set timeout (in seconds)[0m
[30;1m95 | [0m[35m    "MAGICCLOSE": 0x0100,     # Supports magic close char[0m
[30;1m96 | [0m[35m    "PRETIMEOUT": 0x0200,     # Pretimeout (in seconds), get/set[0m
[30;1m97 | [0m[35m    "ALARMONLY": 0x0400,      # Watchdog triggers a management or other external alarm not a reboot[0m

[31m--[ [0m[34mMatch #[0m[33m1467[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m            if self.failed:[0m
[30;1m517 | [0m[35m                for name in ('remove_data_directory_on_rewind_failure', 'remove_data_directory_on_di[0m
[30;1m518 | [0m[35m                    if self._postgresql.config.get(name):[0m
[30;1m519 | [0m[35m                        logger.warning('%s is set. removing...', name)[0m
[30;1m520 | [0m[35m                        self._postgresql.remove_data_directory()[0m
[30;1m521 | [0m[35m                        self._state = REWIND_STATUS.INITIAL[0m

[31m--[ [0m[34mMatch #[0m[33m1468[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m431 | [0m[35m        dsn = self._postgresql.config.format_dsn({**conn_kwargs, 'password': None})[0m
[30;1m432 | [0m[35m        logger.info('running pg_rewind from %s', dsn)[0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m        restore_command = (self._postgresql.config.get('recovery_conf') or EMPTY_DICT).get('restore_[0m
[30;1m435 | [0m[35m            if self._postgresql.major_version < 120000 else self._postgresql.get_guc_value('restore_[0m
[30;1m436 | [0m[35m[0m
[30;1m437 | [0m[35m        # Until v15 pg_rewind expected postgresql.conf to be inside $PGDATA, which is not the case o[0m

[31m--[ [0m[34mMatch #[0m[33m1469[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m431 | [0m[35m        dsn = self._postgresql.config.format_dsn({**conn_kwargs, 'password': None})[0m
[30;1m432 | [0m[35m        logger.info('running pg_rewind from %s', dsn)[0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m        restore_command = (self._postgresql.config.get('recovery_conf') or EMPTY_DICT).get('restore_[0m
[30;1m435 | [0m[35m            if self._postgresql.major_version < 120000 else self._postgresql.get_guc_value('restore_[0m
[30;1m436 | [0m[35m[0m
[30;1m437 | [0m[35m        # Until v15 pg_rewind expected postgresql.conf to be inside $PGDATA, which is not the case o[0m

[31m--[ [0m[34mMatch #[0m[33m1470[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m        if local_timeline is None or local_lsn is None:[0m
[30;1m224 | [0m[35m            return[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m        if isinstance(leader, Leader) and leader.member.data.get('role') not in ('master', 'primary'[0m
[30;1m227 | [0m[35m            return[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m        # We want to use replication credentials when connecting to the "postgres" database in case [0m

[31m--[ [0m[34mMatch #[0m[33m1471[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def _conn_kwargs(self, member: Union[Leader, RemoteMember], auth: Dict[str, Any]) -> Dict[str, A[0m
[30;1m211 | [0m[35m        ret = member.conn_kwargs(auth)[0m
[30;1m212 | [0m[35m        if not ret.get('dbname'):[0m
[30;1m213 | [0m[35m            ret['dbname'] = self._postgresql.database[0m
[30;1m214 | [0m[35m        # Add target_session_attrs to make sure we hit the primary.[0m
[30;1m215 | [0m[35m        # It is not strictly necessary for starting from PostgreSQL v14, which made it possible[0m

[31m--[ [0m[34mMatch #[0m[33m1472[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m            if data.get('Database cluster state') == 'shut down':[0m
[30;1m164 | [0m[35m                in_recovery = False[0m
[30;1m165 | [0m[35m                lsn = data.get('Latest checkpoint location')[0m
[30;1m166 | [0m[35m                timeline = int(data.get("Latest checkpoint's TimeLineID", ""))[0m
[30;1m167 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m168 | [0m[35m            logger.exception('Failed to get local timeline and lsn from pg_controldata output')[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1473[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m                    data['Database cluster state'] = 'shut down'[0m
[30;1m163 | [0m[35m            if data.get('Database cluster state') == 'shut down':[0m
[30;1m164 | [0m[35m                in_recovery = False[0m
[30;1m165 | [0m[35m                lsn = data.get('Latest checkpoint location')[0m
[30;1m166 | [0m[35m                timeline = int(data.get("Latest checkpoint's TimeLineID", ""))[0m
[30;1m167 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m168 | [0m[35m            logger.exception('Failed to get local timeline and lsn from pg_controldata output')[0m

[31m--[ [0m[34mMatch #[0m[33m1474[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m                timeline = int(data.get("Min recovery ending loc's timeline", ""))[0m
[30;1m161 | [0m[35m                if lsn == '0/0' or timeline == 0:  # it was a primary when it crashed[0m
[30;1m162 | [0m[35m                    data['Database cluster state'] = 'shut down'[0m
[30;1m163 | [0m[35m            if data.get('Database cluster state') == 'shut down':[0m
[30;1m164 | [0m[35m                in_recovery = False[0m
[30;1m165 | [0m[35m                lsn = data.get('Latest checkpoint location')[0m
[30;1m166 | [0m[35m                timeline = int(data.get("Latest checkpoint's TimeLineID", ""))[0m

[31m--[ [0m[34mMatch #[0m[33m1475[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m            if data.get('Database cluster state') in ('shut down in recovery', 'in archive recovery'[0m
[30;1m158 | [0m[35m                in_recovery = True[0m
[30;1m159 | [0m[35m                lsn = data.get('Minimum recovery ending location')[0m
[30;1m160 | [0m[35m                timeline = int(data.get("Min recovery ending loc's timeline", ""))[0m
[30;1m161 | [0m[35m                if lsn == '0/0' or timeline == 0:  # it was a primary when it crashed[0m
[30;1m162 | [0m[35m                    data['Database cluster state'] = 'shut down'[0m
[30;1m163 | [0m[35m            if data.get('Database cluster state') == 'shut down':[0m

[31m--[ [0m[34mMatch #[0m[33m1476[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        try:[0m
[30;1m157 | [0m[35m            if data.get('Database cluster state') in ('shut down in recovery', 'in archive recovery'[0m
[30;1m158 | [0m[35m                in_recovery = True[0m
[30;1m159 | [0m[35m                lsn = data.get('Minimum recovery ending location')[0m
[30;1m160 | [0m[35m                timeline = int(data.get("Min recovery ending loc's timeline", ""))[0m
[30;1m161 | [0m[35m                if lsn == '0/0' or timeline == 0:  # it was a primary when it crashed[0m
[30;1m162 | [0m[35m                    data['Database cluster state'] = 'shut down'[0m

[31m--[ [0m[34mMatch #[0m[33m1477[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m        in_recovery = timeline = lsn = None[0m
[30;1m155 | [0m[35m        data = self._postgresql.controldata()[0m
[30;1m156 | [0m[35m        try:[0m
[30;1m157 | [0m[35m            if data.get('Database cluster state') in ('shut down in recovery', 'in archive recovery'[0m
[30;1m158 | [0m[35m                in_recovery = True[0m
[30;1m159 | [0m[35m                lsn = data.get('Minimum recovery ending location')[0m
[30;1m160 | [0m[35m                timeline = int(data.get("Min recovery ending loc's timeline", ""))[0m

[31m--[ [0m[34mMatch #[0m[33m1478[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    @property[0m
[30;1m66 | [0m[35m    def should_remove_data_directory_on_diverged_timelines(self) -> bool:[0m
[30;1m67 | [0m[35m        return bool(self._postgresql.config.get('remove_data_directory_on_diverged_timelines'))[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    @property[0m
[30;1m70 | [0m[35m    def can_rewind_or_reinitialize_allowed(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1479[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    @property[0m
[30;1m44 | [0m[35m    def enabled(self) -> bool:[0m
[30;1m45 | [0m[35m        return bool(self._postgresql.config.get('use_pg_rewind'))[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    @property[0m
[30;1m48 | [0m[35m    def can_rewind(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1480[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    @staticmethod[0m
[30;1m40 | [0m[35m    def configuration_allows_rewind(data: Dict[str, str]) -> bool:[0m
[30;1m41 | [0m[35m        return data.get('wal_log_hints setting', 'off') == 'on' or data.get('Data page checksum vers[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    @property[0m
[30;1m44 | [0m[35m    def enabled(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1481[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    @staticmethod[0m
[30;1m40 | [0m[35m    def configuration_allows_rewind(data: Dict[str, str]) -> bool:[0m
[30;1m41 | [0m[35m        return data.get('wal_log_hints setting', 'off') == 'on' or data.get('Data page checksum vers[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    @property[0m
[30;1m44 | [0m[35m    def enabled(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1482[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m556 | [0m[35m    def single_user_mode(self, communicate: Optional[Dict[str, Any]] = None,[0m
[30;1m557 | [0m[35m                         options: Optional[Dict[str, str]] = None) -> Optional[int]:[0m
[30;1m558 | [0m[35m        """run a given command in a single-user mode. If the command is empty - then just start and [0m
[30;1m559 | [0m[35m        cmd = [self._postgresql.pgcommand('postgres'), '--single', '-D', self._postgresql.data_dir][0m
[30;1m560 | [0m[35m        for opt, val in sorted((options or {}).items()):[0m
[30;1m561 | [0m[35m            cmd.extend(['-c', '{0}={1}'.format(opt, val)])[0m
[30;1m562 | [0m[35m        # need a database name to connect[0m

[31m--[ [0m[34mMatch #[0m[33m1483[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m440 | [0m[35m                                                         and self._postgresql.config.config_dir[0m
[30;1m441 | [0m[35m                                                         == self._postgresql.data_dir))[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m        cmd = [self._postgresql.pgcommand('pg_rewind')][0m
[30;1m444 | [0m[35m        if pg_rewind_can_restore:[0m
[30;1m445 | [0m[35m            cmd.append('--restore-target-wal')[0m
[30;1m446 | [0m[35m            if self._postgresql.major_version >= 150000 and\[0m

[31m--[ [0m[34mMatch #[0m[33m1484[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m388 | [0m[35m            old_name = os.path.join(status_dir, wal + '.ready')[0m
[30;1m389 | [0m[35m            # wal file might have already been archived[0m
[30;1m390 | [0m[35m            if os.path.isfile(old_name) and os.path.isfile(os.path.join(self._postgresql.wal_dir, wa[0m
[30;1m391 | [0m[35m                cmd = self._build_archiver_command(archive_cmd, wal)[0m
[30;1m392 | [0m[35m                # it is the author of archive_command, who is responsible[0m
[30;1m393 | [0m[35m                # for not overriding the WALs already present in archive[0m
[30;1m394 | [0m[35m                logger.info('Trying to archive %s: %s', wal, cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1485[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m347 | [0m[35m        return cmd[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    def _fetch_missing_wal(self, restore_command: str, wal_filename: str) -> bool:[0m
[30;1m350 | [0m[35m        cmd = self._build_archiver_command(restore_command, wal_filename)[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m        logger.info('Trying to fetch the missing wal: %s', cmd)[0m
[30;1m353 | [0m[35m        return self._postgresql.cancellable.call(shlex.split(cmd)) == 0[0m

[31m--[ [0m[34mMatch #[0m[33m1486[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m344 | [0m[35m                cmd += command[i][0m
[30;1m345 | [0m[35m            i += 1[0m
[30;1m346 | [0m[35m[0m
[30;1m347 | [0m[35m        return cmd[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    def _fetch_missing_wal(self, restore_command: str, wal_filename: str) -> bool:[0m
[30;1m350 | [0m[35m        cmd = self._build_archiver_command(restore_command, wal_filename)[0m
[30;1m351 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1487[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m341 | [0m[35m                    cmd += '%'[0m
[30;1m342 | [0m[35m                    i -= 1[0m
[30;1m343 | [0m[35m            else:[0m
[30;1m344 | [0m[35m                cmd += command[i][0m
[30;1m345 | [0m[35m            i += 1[0m
[30;1m346 | [0m[35m[0m
[30;1m347 | [0m[35m        return cmd[0m

[31m--[ [0m[34mMatch #[0m[33m1488[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m340 | [0m[35m                elif command[i] == '%':[0m
[30;1m341 | [0m[35m                    cmd += '%'[0m
[30;1m342 | [0m[35m                else:[0m
[30;1m343 | [0m[35m                    cmd += '%'[0m
[30;1m344 | [0m[35m                    i -= 1[0m
[30;1m345 | [0m[35m            else:[0m
[30;1m346 | [0m[35m                cmd += command[i][0m

[31m--[ [0m[34mMatch #[0m[33m1489[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m336 | [0m[35m                elif command[i] == 'r':[0m
[30;1m337 | [0m[35m                    cmd += '000000010000000000000001'[0m
[30;1m338 | [0m[35m                elif command[i] == '%':[0m
[30;1m339 | [0m[35m                    cmd += '%'[0m
[30;1m340 | [0m[35m                else:[0m
[30;1m341 | [0m[35m                    cmd += '%'[0m
[30;1m342 | [0m[35m                    i -= 1[0m

[31m--[ [0m[34mMatch #[0m[33m1490[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m334 | [0m[35m                elif command[i] == 'f':[0m
[30;1m335 | [0m[35m                    cmd += wal_filename[0m
[30;1m336 | [0m[35m                elif command[i] == 'r':[0m
[30;1m337 | [0m[35m                    cmd += '000000010000000000000001'[0m
[30;1m338 | [0m[35m                elif command[i] == '%':[0m
[30;1m339 | [0m[35m                    cmd += '%'[0m
[30;1m340 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m1491[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m332 | [0m[35m                if command[i] == 'p':[0m
[30;1m333 | [0m[35m                    cmd += os.path.join(self._postgresql.wal_dir, wal_filename)[0m
[30;1m334 | [0m[35m                elif command[i] == 'f':[0m
[30;1m335 | [0m[35m                    cmd += wal_filename[0m
[30;1m336 | [0m[35m                elif command[i] == 'r':[0m
[30;1m337 | [0m[35m                    cmd += '000000010000000000000001'[0m
[30;1m338 | [0m[35m                elif command[i] == '%':[0m

[31m--[ [0m[34mMatch #[0m[33m1492[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m330 | [0m[35m            if command[i] == '%' and i + 1 < length:[0m
[30;1m331 | [0m[35m                i += 1[0m
[30;1m332 | [0m[35m                if command[i] == 'p':[0m
[30;1m333 | [0m[35m                    cmd += os.path.join(self._postgresql.wal_dir, wal_filename)[0m
[30;1m334 | [0m[35m                elif command[i] == 'f':[0m
[30;1m335 | [0m[35m                    cmd += wal_filename[0m
[30;1m336 | [0m[35m                elif command[i] == 'r':[0m

[31m--[ [0m[34mMatch #[0m[33m1493[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m323 | [0m[35m        Applicable for archive_command and restore_command.[0m
[30;1m324 | [0m[35m        Can also be used for archive_cleanup_command and recovery_end_command,[0m
[30;1m325 | [0m[35m        however %r value is always set to 000000010000000000000001."""[0m
[30;1m326 | [0m[35m        cmd = ''[0m
[30;1m327 | [0m[35m        length = len(command)[0m
[30;1m328 | [0m[35m        i = 0[0m
[30;1m329 | [0m[35m        while i < length:[0m

[31m--[ [0m[34mMatch #[0m[33m1494[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m137 | [0m[35m                # * wanted -- before v16[0m
[30;1m138 | [0m[35m                # * nothing (end of message) 9.5 and older[0m
[30;1m139 | [0m[35m                # We will simply check all possible combinations.[0m
[30;1m140 | [0m[35m                for pattern in (': expected at least ', ': wanted ', '\n'):[0m
[30;1m141 | [0m[35m                    j = (err[0] + '\n').find(pattern, i)[0m
[30;1m142 | [0m[35m                    if j > -1:[0m
[30;1m143 | [0m[35m                        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1495[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m133 | [0m[35m            if len(out) == 1 and len(err) == 1 and ', lsn: {0}, prev '.format(lsn8) in out[0] and pa[0m
[30;1m134 | [0m[35m                i = err[0].find(pattern) + len(pattern)[0m
[30;1m135 | [0m[35m                # Message format depends on the major version:[0m
[30;1m136 | [0m[35m                # * expected at least -- starting from v16[0m
[30;1m137 | [0m[35m                # * wanted -- before v16[0m
[30;1m138 | [0m[35m                # * nothing (end of message) 9.5 and older[0m
[30;1m139 | [0m[35m                # We will simply check all possible combinations.[0m

[31m--[ [0m[34mMatch #[0m[33m1496[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35m        if out is not None and err is not None:[0m
[30;1m129 | [0m[35m            out = out.decode('utf-8').rstrip().split('\n')[0m
[30;1m130 | [0m[35m            err = err.decode('utf-8').rstrip().split('\n')[0m
[30;1m131 | [0m[35m            pattern = 'error in WAL record at {0}: invalid record length at '.format(lsn_str)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m            if len(out) == 1 and len(err) == 1 and ', lsn: {0}, prev '.format(lsn8) in out[0] and pa[0m
[30;1m134 | [0m[35m                i = err[0].find(pattern) + len(pattern)[0m

[31m--[ [0m[34mMatch #[0m[33m1497[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35m        if out is not None and err is not None:[0m
[30;1m129 | [0m[35m            out = out.decode('utf-8').rstrip().split('\n')[0m
[30;1m130 | [0m[35m            err = err.decode('utf-8').rstrip().split('\n')[0m
[30;1m131 | [0m[35m            pattern = 'error in WAL record at {0}: invalid record length at '.format(lsn_str)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m            if len(out) == 1 and len(err) == 1 and ', lsn: {0}, prev '.format(lsn8) in out[0] and pa[0m
[30;1m134 | [0m[35m                i = err[0].find(pattern) + len(pattern)[0m

[31m--[ [0m[34mMatch #[0m[33m1498[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: wanted [0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: expecte[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m            The error message contains information about LSN of the next record, which is exactly wh[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1499[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: wanted [0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: expecte[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m            The error message contains information about LSN of the next record, which is exactly wh[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1500[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: wanted [0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: expecte[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m            The error message contains information about LSN of the next record, which is exactly wh[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1501[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m            We are trying to read two records, and expect that it will fail to read the second recor[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: wanted [0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: expecte[0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1502[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m            We are trying to read two records, and expect that it will fail to read the second recor[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: wanted [0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: expecte[0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1503[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m53 | [0m[35m        if not self.enabled:[0m
[30;1m54 | [0m[35m            return False[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        cmd = [self._postgresql.pgcommand('pg_rewind'), '--help'][0m
[30;1m57 | [0m[35m        try:[0m
[30;1m58 | [0m[35m            ret = subprocess.call(cmd, stdout=open(os.devnull, 'w'), stderr=subprocess.STDOUT)[0m
[30;1m59 | [0m[35m            if ret != 0:  # pg_rewind is not there, close up the shop and go home[0m

[31m--[ [0m[34mMatch #[0m[33m1504[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m426 | [0m[35m        :returns: ``True`` if ``pg_rewind`` finished successfully, ``False`` otherwise.[0m
[30;1m427 | [0m[35m        """[0m
[30;1m428 | [0m[35m        # prepare pg_rewind connection string[0m
[30;1m429 | [0m[35m        env = self._postgresql.config.write_pgpass(conn_kwargs)[0m
[30;1m430 | [0m[35m        env.update(LANG='C', LC_ALL='C', PGOPTIONS='-c statement_timeout=0')[0m
[30;1m431 | [0m[35m        dsn = self._postgresql.config.format_dsn({**conn_kwargs, 'password': None})[0m
[30;1m432 | [0m[35m        logger.info('running pg_rewind from %s', dsn)[0m

[31m--[ [0m[34mMatch #[0m[33m1505[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m402 | [0m[35m                    logger.info('Failed to archive WAL segment %s', wal)[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m    def _maybe_clean_pg_replslot(self) -> None:[0m
[30;1m405 | [0m[35m        """Clean pg_replslot directory if pg version is less then 11[0m
[30;1m406 | [0m[35m        (pg_rewind deletes $PGDATA/pg_replslot content only since pg11)."""[0m
[30;1m407 | [0m[35m        if self._postgresql.major_version < 110000:[0m
[30;1m408 | [0m[35m            replslot_dir = self._postgresql.slots_handler.pg_replslot_dir[0m

[31m--[ [0m[34mMatch #[0m[33m1506[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/rewind.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m            Hence, the only reliable way to figure out where it ends, is to read the record from fil[0m
[30;1m110 | [0m[35m            help of ``pg_waldump`` and parse the output.[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m            We are trying to read two records, and expect that it will fail to read the second recor[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m                fatal: error in WAL record at 0/182E220: invalid record length at 0/182E298: wanted [0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1507[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m818 | [0m[35m        if 'nofailover' not in tags:[0m
[30;1m819 | [0m[35m            return[0m
[30;1m820 | [0m[35m        nofailover_tag = tags.get('nofailover')[0m
[30;1m821 | [0m[35m        failover_priority_tag = parse_int(tags.get('failover_priority'))[0m
[30;1m822 | [0m[35m        if failover_priority_tag is not None \[0m
[30;1m823 | [0m[35m                and (bool(nofailover_tag) is True and failover_priority_tag > 0[0m
[30;1m824 | [0m[35m                     or bool(nofailover_tag) is False and failover_priority_tag <= 0):[0m

[31m--[ [0m[34mMatch #[0m[33m1508[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m817 | [0m[35m        tags = self.get('tags', {})[0m
[30;1m818 | [0m[35m        if 'nofailover' not in tags:[0m
[30;1m819 | [0m[35m            return[0m
[30;1m820 | [0m[35m        nofailover_tag = tags.get('nofailover')[0m
[30;1m821 | [0m[35m        failover_priority_tag = parse_int(tags.get('failover_priority'))[0m
[30;1m822 | [0m[35m        if failover_priority_tag is not None \[0m
[30;1m823 | [0m[35m                and (bool(nofailover_tag) is True and failover_priority_tag > 0[0m

[31m--[ [0m[34mMatch #[0m[33m1509[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m814 | [0m[35m          The behaviour is as if ``failover_priority`` were not provided (i.e ``nofailover`` is the[0m
[30;1m815 | [0m[35m          bedrock source of truth)[0m
[30;1m816 | [0m[35m        """[0m
[30;1m817 | [0m[35m        tags = self.get('tags', {})[0m
[30;1m818 | [0m[35m        if 'nofailover' not in tags:[0m
[30;1m819 | [0m[35m            return[0m
[30;1m820 | [0m[35m        nofailover_tag = tags.get('nofailover')[0m

[31m--[ [0m[34mMatch #[0m[33m1510[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m768 | [0m[35m[0m
[30;1m769 | [0m[35m        :returns: value of *key*, if present in the effective configuration, otherwise *default*.[0m
[30;1m770 | [0m[35m        """[0m
[30;1m771 | [0m[35m        return self.__effective_configuration.get(key, default)[0m
[30;1m772 | [0m[35m[0m
[30;1m773 | [0m[35m    def __contains__(self, key: str) -> bool:[0m
[30;1m774 | [0m[35m        """Check if setting *key* is present in the effective configuration.[0m

[31m--[ [0m[34mMatch #[0m[33m1511[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m700 | [0m[35m        for name, value in local_configuration.items():[0m
[30;1m701 | [0m[35m            if name == 'citus':  # remove invalid citus configuration[0m
[30;1m702 | [0m[35m                if isinstance(value, dict) and isinstance(cast(Dict[str, Any], value).get('group'), [0m
[30;1m703 | [0m[35m                        and isinstance(cast(Dict[str, Any], value).get('database'), str):[0m
[30;1m704 | [0m[35m                    config[name] = value[0m
[30;1m705 | [0m[35m            elif name == 'postgresql':[0m
[30;1m706 | [0m[35m                for name, value in (value or {}).items():[0m

[31m--[ [0m[34mMatch #[0m[33m1512[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m699 | [0m[35m        config = self._safe_copy_dynamic_configuration(dynamic_configuration)[0m
[30;1m700 | [0m[35m        for name, value in local_configuration.items():[0m
[30;1m701 | [0m[35m            if name == 'citus':  # remove invalid citus configuration[0m
[30;1m702 | [0m[35m                if isinstance(value, dict) and isinstance(cast(Dict[str, Any], value).get('group'), [0m
[30;1m703 | [0m[35m                        and isinstance(cast(Dict[str, Any], value).get('database'), str):[0m
[30;1m704 | [0m[35m                    config[name] = value[0m
[30;1m705 | [0m[35m            elif name == 'postgresql':[0m

[31m--[ [0m[34mMatch #[0m[33m1513[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35m        for first, params in dict_configs:[0m
[30;1m618 | [0m[35m            for second in params:[0m
[30;1m619 | [0m[35m                value = ret.get(first, {}).pop(second, None)[0m
[30;1m620 | [0m[35m                if value:[0m
[30;1m621 | [0m[35m                    value = _parse_dict(value)[0m
[30;1m622 | [0m[35m                    if value:[0m

[31m--[ [0m[34mMatch #[0m[33m1514[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m                if value:[0m
[30;1m589 | [0m[35m                    ret[first][second] = value[0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m        logformat = ret.get('log', {}).get('format')[0m
[30;1m592 | [0m[35m        if logformat and not re.search(r'%\(\w+\)', logformat):[0m
[30;1m593 | [0m[35m            logformat = _parse_list(logformat)[0m
[30;1m594 | [0m[35m            if logformat:[0m

[31m--[ [0m[34mMatch #[0m[33m1515[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m                if value:[0m
[30;1m589 | [0m[35m                    ret[first][second] = value[0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m        logformat = ret.get('log', {}).get('format')[0m
[30;1m592 | [0m[35m        if logformat and not re.search(r'%\(\w+\)', logformat):[0m
[30;1m593 | [0m[35m            logformat = _parse_list(logformat)[0m
[30;1m594 | [0m[35m            if logformat:[0m

[31m--[ [0m[34mMatch #[0m[33m1516[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m582 | [0m[35m                return None[0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35m        for first, second in (('raft', 'partner_addrs'), ('restapi', 'allowlist')):[0m
[30;1m585 | [0m[35m            value = ret.get(first, {}).pop(second, None)[0m
[30;1m586 | [0m[35m            if value:[0m
[30;1m587 | [0m[35m                value = _parse_list(value)[0m
[30;1m588 | [0m[35m                if value:[0m

[31m--[ [0m[34mMatch #[0m[33m1517[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m560 | [0m[35m        for first, params in (('restapi', ('request_queue_size',)),[0m
[30;1m561 | [0m[35m                              ('log', ('max_queue_size', 'file_size', 'file_num', 'mode'))):[0m
[30;1m562 | [0m[35m            for second in params:[0m
[30;1m563 | [0m[35m                value = ret.get(first, {}).pop(second, None)[0m
[30;1m564 | [0m[35m                if value:[0m
[30;1m565 | [0m[35m                    value = parse_int(value)[0m
[30;1m566 | [0m[35m                    if value is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1518[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m        # parse all values retrieved from the environment as Python objects, according to the expect[0m
[30;1m553 | [0m[35m        for first, second in (('restapi', 'allowlist_include_members'), ('ctl', 'insecure')):[0m
[30;1m554 | [0m[35m            value = ret.get(first, {}).pop(second, None)[0m
[30;1m555 | [0m[35m            if value:[0m
[30;1m556 | [0m[35m                value = parse_bool(value)[0m
[30;1m557 | [0m[35m                if value is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1519[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m        :returns: an integer value which corresponds to a provided *param*.[0m
[30;1m276 | [0m[35m        """[0m
[30;1m277 | [0m[35m        value = int(config.get(param, self.__DEFAULT_CONFIG[param]))[0m
[30;1m278 | [0m[35m        if value < min_value:[0m
[30;1m279 | [0m[35m            logger.warning("%s=%d can't be smaller than %d, adjusting...", param, value, min_value)[0m
[30;1m280 | [0m[35m            value = config[param] = min_value[0m

[31m--[ [0m[34mMatch #[0m[33m1520[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m                raise ConfigParseError("\n".join(errors))[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m        self.__effective_configuration = self._build_effective_configuration({}, self._local_configu[0m
[30;1m146 | [0m[35m        self._data_dir = self.__effective_configuration.get('postgresql', {}).get('data_dir', "")[0m
[30;1m147 | [0m[35m        self._cache_file = os.path.join(self._data_dir, self.__CACHE_FILENAME)[0m
[30;1m148 | [0m[35m        if validator:  # patronictl uses validator=None[0m
[30;1m149 | [0m[35m            self._load_cache()  # we don't want to load anything from local cache for ctl[0m

[31m--[ [0m[34mMatch #[0m[33m1521[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m                raise ConfigParseError("\n".join(errors))[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m        self.__effective_configuration = self._build_effective_configuration({}, self._local_configu[0m
[30;1m146 | [0m[35m        self._data_dir = self.__effective_configuration.get('postgresql', {}).get('data_dir', "")[0m
[30;1m147 | [0m[35m        self._cache_file = os.path.join(self._data_dir, self.__CACHE_FILENAME)[0m
[30;1m148 | [0m[35m        if validator:  # patronictl uses validator=None[0m
[30;1m149 | [0m[35m            self._load_cache()  # we don't want to load anything from local cache for ctl[0m

[31m--[ [0m[34mMatch #[0m[33m1522[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m264 | [0m[35m        """Get, validate and maybe adjust a *param* integer value from the *config* :class:`dict`.[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        .. note:[0m
[30;1m267 | [0m[35m            If the value is smaller than provided *min_value* we update the *config*.[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m            This method may raise an exception if value isn't :class:`int` or cannot be casted to :c[0m
[30;1m270 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1523[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/exhibitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35mclass Exhibitor(ZooKeeper):[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    def __init__(self, config: Dict[str, Any], mpp: AbstractMPP) -> None:[0m
[30;1m72 | [0m[35m        interval = config.get('poll_interval', 300)[0m
[30;1m73 | [0m[35m        self._ensemble_provider = ExhibitorEnsembleProvider(config['hosts'], config['port'], poll_in[0m
[30;1m74 | [0m[35m        super(Exhibitor, self).__init__({**config, 'hosts': self._ensemble_provider.zookeeper_hosts}[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1524[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/exhibitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mclass ExhibitorEnsembleProvider(object):[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    TIMEOUT = 3.1[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    def __init__(self, hosts: List[str], port: int,[0m
[30;1m22 | [0m[35m                 uri_path: str = '/exhibitor/v1/cluster/list', poll_interval: int = 300) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1525[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/exhibitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport random[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom typing import Any, Callable, cast, Dict, List, Union[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom ..postgresql.mpp import AbstractMPP[0m

[31m--[ [0m[34mMatch #[0m[33m1526[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_citus.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        transitions: List[str] = [][0m
[30;1m212 | [0m[35m        for node in new_topology.transition(old_topology):[0m
[30;1m213 | [0m[35m            self.assertTrue(node not in check_topology or (check_topology.get(node) or node).role ==[0m
[30;1m214 | [0m[35m            old_node = node.nodeid and next(iter(v for v in check_topology if v.nodeid == node.nodei[0m
[30;1m215 | [0m[35m            if old_node:[0m
[30;1m216 | [0m[35m                check_topology.discard(old_node)[0m

[31m--[ [0m[34mMatch #[0m[33m1527[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_citus.py[0m
   Pattern: [32m.hostname[0m
[30;1m272 | [0m[35m                              PgDistNode('3', 5432, 'secondary')})[0m
[30;1m273 | [0m[35m        expected = PgDistGroup(0, {PgDistNode('2', 5432, 'primary', nodeid=1),[0m
[30;1m274 | [0m[35m                                   PgDistNode('3', 5432, 'secondary', nodeid=2)})[0m
[30;1m275 | [0m[35m        # the secondary record is used to add the new standby and primary record is updated with the[0m
[30;1m276 | [0m[35m        self.check_transitions(old, new, ["citus_update_node(2, '3', 5432)", "citus_update_node(1, '[0m
[30;1m277 | [0m[35m        self.assertTrue(new.equals(expected, True))[0m
[30;1m278 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1528[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_citus.py[0m
   Pattern: [32m.hostname[0m
[30;1m261 | [0m[35m                              PgDistNode('3', 5432, 'secondary')})[0m
[30;1m262 | [0m[35m        expected = PgDistGroup(0, {PgDistNode('2', 5432, 'primary', nodeid=1),[0m
[30;1m263 | [0m[35m                                   PgDistNode('3', 5432, 'secondary', nodeid=2)})[0m
[30;1m264 | [0m[35m        # the secondary record is used to add the new standby and primary record is updated with the[0m
[30;1m265 | [0m[35m        self.check_transitions(old, new, ["citus_update_node(2, '3', 5432)", "citus_update_node(1, '[0m
[30;1m266 | [0m[35m        self.assertTrue(new.equals(expected, True))[0m
[30;1m267 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1529[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_citus.py[0m
   Pattern: [32m.hostname[0m
[30;1m154 | [0m[35m        self.assertEqual(parameters['max_prepared_transactions'], 202)[0m
[30;1m155 | [0m[35m        self.assertEqual(parameters['shared_preload_libraries'], 'citus,foo,bar')[0m
[30;1m156 | [0m[35m        self.assertEqual(parameters['wal_level'], 'logical')[0m
[30;1m157 | [0m[35m        self.assertEqual(parameters['citus.local_hostname'], '/tmp')[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    def test_ignore_replication_slot(self):[0m
[30;1m160 | [0m[35m        self.assertFalse(self.c.ignore_replication_slot({'name': 'foo', 'type': 'physical',[0m

[31m--[ [0m[34mMatch #[0m[33m1530[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_citus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m342 | [0m[35m        new = PgDistGroup(0, {PgDistNode('3', 5432, 'primary')})[0m
[30;1m343 | [0m[35m        expected = PgDistGroup(0, {PgDistNode('3', 5432, 'primary', nodeid=1),[0m
[30;1m344 | [0m[35m                                   PgDistNode('2', 5432, 'secondary', nodeid=2)})[0m
[30;1m345 | [0m[35m        # the secondary record needs to be removed before we update the primary record[0m
[30;1m346 | [0m[35m        self.check_transitions(old, new, ["citus_update_node(1, '3', 5432)"])[0m
[30;1m347 | [0m[35m        self.assertTrue(new.equals(expected, True))[0m
[30;1m348 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1531[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_citus.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31 | [0m[35m        # `before_demote` or `before_promote` REST API calls starting a[0m
[30;1m32 | [0m[35m        # transaction. We want to make sure that it finishes during[0m
[30;1m33 | [0m[35m        # certain timeout. In case if it is not, we want to roll it back[0m
[30;1m34 | [0m[35m        # in order to not block other workers that want to update[0m
[30;1m35 | [0m[35m        # `pg_dist_node`.[0m
[30;1m36 | [0m[35m        self.c._condition.wait = Mock(side_effect=[Mock(), Mock(), Mock(), SleepException])[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        self.c.handle_event(self.cluster, {'type': 'before_demote', 'group': 1,[0m

[31m--[ [0m[34mMatch #[0m[33m1532[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m        check_topology = deepcopy(old_topology)[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        transitions: List[str] = [][0m
[30;1m212 | [0m[35m        for node in new_topology.transition(old_topology):[0m
[30;1m213 | [0m[35m            self.assertTrue(node not in check_topology or (check_topology.get(node) or node).role ==[0m
[30;1m214 | [0m[35m            old_node = node.nodeid and next(iter(v for v in check_topology if v.nodeid == node.nodei[0m
[30;1m215 | [0m[35m            if old_node:[0m

[31m--[ [0m[34mMatch #[0m[33m1533[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_citus.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport unittest[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom copy import deepcopy[0m
[30;1m5 | [0m[35mfrom typing import List[0m

[31m--[ [0m[34mMatch #[0m[33m1534[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m405 | [0m[35m            if self.leader_wanted != self.leader:  # failover[0m
[30;1m406 | [0m[35m                voters = (self.voters - CaseInsensitiveSet([self.leader_wanted])) | CaseInsensitiveS[0m
[30;1m407 | [0m[35m                if not self.sync:[0m
[30;1m408 | [0m[35m                    # If sync is empty we need to update synchronous_standby_names first[0m
[30;1m409 | [0m[35m                    numsync = len(voters) - self.quorum[0m
[30;1m410 | [0m[35m                    yield from self.sync_update(numsync, CaseInsensitiveSet(voters))[0m
[30;1m411 | [0m[35m                # If leader changed we need to add the old leader to quorum (voters)[0m

[31m--[ [0m[34mMatch #[0m[33m1535[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m361 | [0m[35m                    add = CaseInsensitiveSet(sorted(to_add)[:increase_numsync_by])[0m
[30;1m362 | [0m[35m                    increase_numsync_by = len(add)[0m
[30;1m363 | [0m[35m                else:  # there is only the leader[0m
[30;1m364 | [0m[35m                    add = to_add  # and it is safe to add all nodes at once if sync is empty[0m
[30;1m365 | [0m[35m                yield from self.sync_update(self.numsync + increase_numsync_by, CaseInsensitiveSet(s[0m
[30;1m366 | [0m[35m                voters = CaseInsensitiveSet(self.voters | add)[0m
[30;1m367 | [0m[35m                yield from self.quorum_update(len(voters) - sync_wanted, voters)[0m

[31m--[ [0m[34mMatch #[0m[33m1536[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        The number of nodes needed for commit to succeed, ``numsync``, is also called the replicatio[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    To guarantee zero transaction loss on failover we need to keep the invariant that at all times a[0m
[30;1m56 | [0m[35m    nodes that can acknowledge a commit overlaps with any subset of nodes that can achieve quorum to[0m
[30;1m57 | [0m[35m    leader. Given a desired replication factor and a set of nodes able to participate in sync replic[0m
[30;1m58 | [0m[35m    is one optimal state satisfying this condition. Given the node set ``active``, the optimal state[0m

[31m--[ [0m[34mMatch #[0m[33m1537[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m18 | [0m[35m    :ivar transition_type: possible values:[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m        * ``sync`` - indicates that we needed to update ``synchronous_standby_names``.[0m
[30;1m21 | [0m[35m        * ``quorum`` - indicates that we need to update ``/sync`` key in DCS.[0m
[30;1m22 | [0m[35m        * ``restart`` - caller should stop iterating over transitions and restart :class:`QuorumStat[0m
[30;1m23 | [0m[35m    :ivar leader: the new value of the ``leader`` field in the ``/sync`` key.[0m
[30;1m24 | [0m[35m    :ivar num: the new value of the synchronous nodes count in ``synchronous_standby_names`` or valu[0m

[31m--[ [0m[34mMatch #[0m[33m1538[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    :ivar transition_type: possible values:[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m        * ``sync`` - indicates that we needed to update ``synchronous_standby_names``.[0m
[30;1m21 | [0m[35m        * ``quorum`` - indicates that we need to update ``/sync`` key in DCS.[0m
[30;1m22 | [0m[35m        * ``restart`` - caller should stop iterating over transitions and restart :class:`QuorumStat[0m
[30;1m23 | [0m[35m    :ivar leader: the new value of the ``leader`` field in the ``/sync`` key.[0m

[31m--[ [0m[34mMatch #[0m[33m1539[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m        yield from self.__handle_non_steady_cases()[0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m        # We are in a steady state point. Find if desired state is different and act accordingly.[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m        yield from self.__remove_gone_nodes()[0m
[30;1m434 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1540[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m194 | [0m[35m            voters = CaseInsensitiveSet()[0m
[30;1m195 | [0m[35m        elif adjust_quorum:[0m
[30;1m196 | [0m[35m            # It could be that the number of nodes that are known to catch up with the primary is be[0m
[30;1m197 | [0m[35m            # We want to increase quorum to guarantee that the sync node will be found during the le[0m
[30;1m198 | [0m[35m            quorum += max(self.numsync - self.numsync_confirmed, 0)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        if (self.leader, quorum, voters) == (old_leader, self.quorum, self.voters):[0m

[31m--[ [0m[34mMatch #[0m[33m1541[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m        :param sync: Set of node names listed in the ``synchronous_standby_names``.[0m
[30;1m123 | [0m[35m        :param numsync_confirmed: the number of nodes that are confirmed to reach "safe" LSN after[0m
[30;1m124 | [0m[35m                                  they were added to the ``synchronous_standby_names``.[0m
[30;1m125 | [0m[35m        :param active: set of node names that are replicating from the primary (according to ``pg_st[0m
[30;1m126 | [0m[35m                       and are eligible to be listed in ``synchronous_standby_names``.[0m
[30;1m127 | [0m[35m        :param sync_wanted: desired number of synchronous nodes[0m

[31m--[ [0m[34mMatch #[0m[33m1542[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35moing the leader race.[0m
[30;1m119 | [0m[35m        :param voters: ``sync_standby`` value from the ``/sync`` key, set of node names we will be[0m
[30;1m120 | [0m[35m                       running the leader race against.[0m
[30;1m121 | [0m[35m        :param numsync: the number of synchronous nodes from the ``synchronous_standby_names``.[0m
[30;1m122 | [0m[35m        :param sync: Set of node names listed in the ``synchronous_standby_names``.[0m
[30;1m123 | [0m[35m        :param numsync_confirmed: the number of nodes that are confirmed to reach "safe" LSN after[0m
[30;1m124 | [0m[35m                                  they were added to the ``synchronous_standby_names``.[0m

[31m--[ [0m[34mMatch #[0m[33m1543[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m        :param leader: name of the leader, according to the ``/sync`` key.[0m
[30;1m117 | [0m[35m        :param quorum: ``quorum`` value from the ``/sync`` key, the minimal number of nodes we need [0m
[30;1m118 | [0m[35m                        when doing the leader race.[0m
[30;1m119 | [0m[35m        :param voters: ``sync_standby`` value from the ``/sync`` key, set of node names we will be[0m
[30;1m120 | [0m[35m                       running the leader race against.[0m
[30;1m121 | [0m[35m        :param numsync: the number of synchronous nodes from the ``synchronous_standby_names``.[0m
[30;1m122 | [0m[35m        :param sync: Set of node names listed in the ``synchronous_standby_names``.[0m

[31m--[ [0m[34mMatch #[0m[33m1544[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m``synchronous_standby_names``.[0m
[30;1m102 | [0m[35m    :ivar sync: set of node names listed in the ``synchronous_standby_names``.[0m
[30;1m103 | [0m[35m    :ivar numsync_confirmed: the number of nodes that are confirmed to reach "safe" LSN after they w[0m
[30;1m104 | [0m[35m                  ``synchronous_standby_names``.[0m
[30;1m105 | [0m[35m    :ivar active: set of node names that are replicating from the primary (according to ``pg_stat_re[0m
[30;1m106 | [0m[35m                  and are eligible to be listed in ``synchronous_standby_names``.[0m
[30;1m107 | [0m[35m    :ivar sync_wanted: desired number of synchronous nodes (``synchronous_node_count`` from the glob[0m

[31m--[ [0m[34mMatch #[0m[33m1545[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m    :ivar voters: ``sync_standby`` value from the ``/sync`` key, set of node names we will be[0m
[30;1m100 | [0m[35m                  running the leader race against.[0m
[30;1m101 | [0m[35m    :ivar numsync: the number of synchronous nodes from the ``synchronous_standby_names``.[0m
[30;1m102 | [0m[35m    :ivar sync: set of node names listed in the ``synchronous_standby_names``.[0m
[30;1m103 | [0m[35m    :ivar numsync_confirmed: the number of nodes that are confirmed to reach "safe" LSN after they w[0m
[30;1m104 | [0m[35m                  ``synchronous_standby_names``.[0m
[30;1m105 | [0m[35m    :ivar active: set of node names that are replicating from the primary (according to ``pg_stat_re[0m

[31m--[ [0m[34mMatch #[0m[33m1546[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m    :ivar leader: name of the leader, according to the ``/sync`` key.[0m
[30;1m97 | [0m[35m    :ivar quorum: ``quorum`` value from the ``/sync`` key, the minimal number of nodes we need see[0m
[30;1m98 | [0m[35m                  when doing the leader race.[0m
[30;1m99 | [0m[35m    :ivar voters: ``sync_standby`` value from the ``/sync`` key, set of node names we will be[0m
[30;1m100 | [0m[35m                  running the leader race against.[0m
[30;1m101 | [0m[35m    :ivar numsync: the number of synchronous nodes from the ``synchronous_standby_names``.[0m
[30;1m102 | [0m[35m    :ivar sync: set of node names listed in the ``synchronous_standby_names``.[0m

[31m--[ [0m[34mMatch #[0m[33m1547[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m        quorum = len(active) - numsync[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    We need to be able to produce a series of state changes that take the system to this desired sta[0m
[30;1m67 | [0m[35m    other arbitrary state given arbitrary changes is node availability, configuration and interrupte[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    To keep the invariant the rule to follow is that when increasing ``numsync`` or ``quorum``, we n[0m
[30;1m70 | [0m[35m    increasing operation first. When decreasing either, the decreasing operation needs to be perform[0m

[31m--[ [0m[34mMatch #[0m[33m1548[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m    To guarantee zero transaction loss on failover we need to keep the invariant that at all times a[0m
[30;1m56 | [0m[35m    nodes that can acknowledge a commit overlaps with any subset of nodes that can achieve quorum to[0m
[30;1m57 | [0m[35m    leader. Given a desired replication factor and a set of nodes able to participate in sync replic[0m
[30;1m58 | [0m[35m    is one optimal state satisfying this condition. Given the node set ``active``, the optimal state[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        sync = voters = active[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1549[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/quorum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m    :ivar leader: the new value of the ``leader`` field in the ``/sync`` key.[0m
[30;1m24 | [0m[35m    :ivar num: the new value of the synchronous nodes count in ``synchronous_standby_names`` or valu[0m
[30;1m25 | [0m[35m               field in the ``/sync`` key for :attr:`transition_type` values ``sync`` and ``quorum``[0m
[30;1m26 | [0m[35m    :ivar names: the new value of node names listed in ``synchronous_standby_names`` or value of ``v[0m
[30;1m27 | [0m[35m                 field in the ``/sync`` key  for :attr:`transition_type` values ``sync`` and ``quoru[0m
[30;1m28 | [0m[35m    """[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1550[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m    if key == '/service/exists/leader':[0m
[30;1m34 | [0m[35m        raise etcd.EtcdAlreadyExist[0m
[30;1m35 | [0m[35m    if key in ['/service/test/leader', '/patroni/test/leader'] and \[0m
[30;1m36 | [0m[35m            (kwargs.get('prevValue') == 'foo' or not kwargs.get('prevExist', True)):[0m
[30;1m37 | [0m[35m        return True[0m
[30;1m38 | [0m[35m    raise etcd.EtcdException[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1551[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m    if key == '/service/exists/leader':[0m
[30;1m34 | [0m[35m        raise etcd.EtcdAlreadyExist[0m
[30;1m35 | [0m[35m    if key in ['/service/test/leader', '/patroni/test/leader'] and \[0m
[30;1m36 | [0m[35m            (kwargs.get('prevValue') == 'foo' or not kwargs.get('prevExist', True)):[0m
[30;1m37 | [0m[35m        return True[0m
[30;1m38 | [0m[35m    raise etcd.EtcdException[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1552[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m        return etcd.EtcdResult('compareAndSwap', {})[0m
[30;1m26 | [0m[35m    elif 5 < timeout <= 10.0:[0m
[30;1m27 | [0m[35m        raise etcd.EtcdException[0m
[30;1m28 | [0m[35m    elif timeout == 20.0:[0m
[30;1m29 | [0m[35m        raise etcd.EtcdEventIndexCleared[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1553[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m        raise etcd.EtcdWatchTimedOut[0m
[30;1m24 | [0m[35m    elif timeout == 5.0:[0m
[30;1m25 | [0m[35m        return etcd.EtcdResult('compareAndSwap', {})[0m
[30;1m26 | [0m[35m    elif 5 < timeout <= 10.0:[0m
[30;1m27 | [0m[35m        raise etcd.EtcdException[0m
[30;1m28 | [0m[35m    elif timeout == 20.0:[0m
[30;1m29 | [0m[35m        raise etcd.EtcdEventIndexCleared[0m

[31m--[ [0m[34mMatch #[0m[33m1554[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mdef etcd_watch(self, key, index=None, timeout=None, recursive=None):[0m
[30;1m22 | [0m[35m    if timeout == 2.0:[0m
[30;1m23 | [0m[35m        raise etcd.EtcdWatchTimedOut[0m
[30;1m24 | [0m[35m    elif timeout == 5.0:[0m
[30;1m25 | [0m[35m        return etcd.EtcdResult('compareAndSwap', {})[0m
[30;1m26 | [0m[35m    elif 5 < timeout <= 10.0:[0m
[30;1m27 | [0m[35m        raise etcd.EtcdException[0m

[31m--[ [0m[34mMatch #[0m[33m1555[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_etcd.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mdef etcd_watch(self, key, index=None, timeout=None, recursive=None):[0m
[30;1m22 | [0m[35m    if timeout == 2.0:[0m
[30;1m23 | [0m[35m        raise etcd.EtcdWatchTimedOut[0m
[30;1m24 | [0m[35m    elif timeout == 5.0:[0m
[30;1m25 | [0m[35m        return etcd.EtcdResult('compareAndSwap', {})[0m

[31m--[ [0m[34mMatch #[0m[33m1556[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_barman.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        self.assertEqual([0m
[30;1m119 | [0m[35m            str(exc.exception),[0m
[30;1m120 | [0m[35m            "pg-backup-api is currently not up and running at http://localhost:7480: random",[0m
[30;1m121 | [0m[35m        )[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    @patch("patroni.scripts.barman.utils.OperationStatus")[0m

[31m--[ [0m[34mMatch #[0m[33m1557[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m        """[0m
[30;1m71 | [0m[35m        cursor = None[0m
[30;1m72 | [0m[35m        try:[0m
[30;1m73 | [0m[35m            with self.get().cursor() as cursor:[0m
[30;1m74 | [0m[35m                cursor.execute(sql.encode('utf-8'), params or None)[0m
[30;1m75 | [0m[35m                return cursor.fetchall() if cursor.rowcount and cursor.rowcount > 0 else [][0m
[30;1m76 | [0m[35m        except psycopg.Error as exc:[0m

[31m--[ [0m[34mMatch #[0m[33m1558[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m    :returns: the response returned from the request.[0m
[30;1m180 | [0m[35m    """[0m
[30;1m181 | [0m[35m    http = PatroniRequest({}, not verify)[0m
[30;1m182 | [0m[35m    return http.request('GET', url, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m1559[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        :returns: the response returned upon request.[0m
[30;1m165 | [0m[35m        """[0m
[30;1m166 | [0m[35m        url = member.get_endpoint_url(endpoint)[0m
[30;1m167 | [0m[35m        return self.request(method, url, data, **kwargs)[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35mdef get(url: str, verify: bool = True, **kwargs: Any) -> urllib3.response.HTTPResponse:[0m

[31m--[ [0m[34mMatch #[0m[33m1560[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        """[0m
[30;1m149 | [0m[35m        if body is not None and not isinstance(body, str):[0m
[30;1m150 | [0m[35m            body = json.dumps(body)[0m
[30;1m151 | [0m[35m        return self._pool.request(method.upper(), url, body=body, **kwargs)[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def __call__(self, member: Member, method: str = 'GET', endpoint: Optional[str] = None,[0m
[30;1m154 | [0m[35m                 data: Optional[Any] = None, **kwargs: Any) -> urllib3.response.HTTPResponse:[0m

[31m--[ [0m[34mMatch #[0m[33m1561[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        :returns: value of ``restapi -> *name*`` if present, ``None`` otherwise.[0m
[30;1m66 | [0m[35m        """[0m
[30;1m67 | [0m[35m        return config.get('restapi', {}).get(name)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def _apply_pool_param(self, param: str, value: Any) -> None:[0m
[30;1m70 | [0m[35m        """Configure *param* as *value* in the request manager.[0m

[31m--[ [0m[34mMatch #[0m[33m1562[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        :returns: value of ``restapi -> *name*`` if present, ``None`` otherwise.[0m
[30;1m66 | [0m[35m        """[0m
[30;1m67 | [0m[35m        return config.get('restapi', {}).get(name)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def _apply_pool_param(self, param: str, value: Any) -> None:[0m
[30;1m70 | [0m[35m        """Configure *param* as *value* in the request manager.[0m

[31m--[ [0m[34mMatch #[0m[33m1563[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        :returns: value of ``ctl.*name*`` if present, ``None`` otherwise.[0m
[30;1m55 | [0m[35m        """[0m
[30;1m56 | [0m[35m        return config.get('ctl', {}).get(name, default)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    @staticmethod[0m
[30;1m59 | [0m[35m    def _get_restapi_value(config: Union[Config, Dict[str, Any]], name: str) -> Optional[Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m1564[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        :returns: value of ``ctl.*name*`` if present, ``None`` otherwise.[0m
[30;1m55 | [0m[35m        """[0m
[30;1m56 | [0m[35m        return config.get('ctl', {}).get(name, default)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    @staticmethod[0m
[30;1m59 | [0m[35m    def _get_restapi_value(config: Union[Config, Dict[str, Any]], name: str) -> Optional[Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m1565[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m.hostname[0m
[30;1m129 | [0m[35m        else:[0m
[30;1m130 | [0m[35m            if insecure:  # Disable server certificate validation if requested[0m
[30;1m131 | [0m[35m                self._pool.connection_pool_kw['cert_reqs'] = 'CERT_NONE'[0m
[30;1m132 | [0m[35m            self._pool.connection_pool_kw.pop('assert_hostname', None)[0m
[30;1m133 | [0m[35m            self._pool.connection_pool_kw.pop('key_file', None)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        cacert = self._get_ctl_value(config, 'cacert') or self._get_restapi_value(config, 'cafile')[0m

[31m--[ [0m[34mMatch #[0m[33m1566[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m.hostname[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        if self._apply_ssl_file_param(config, 'cert'):[0m
[30;1m123 | [0m[35m            if insecure:  # The assert_hostname = False helps to silence warnings[0m
[30;1m124 | [0m[35m                self._pool.connection_pool_kw['assert_hostname'] = False[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            self._apply_ssl_file_param(config, 'key')[0m
[30;1m127 | [0m[35m            password = self._get_ctl_value(config, 'keyfile_password')[0m

[31m--[ [0m[34mMatch #[0m[33m1567[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/request.py[0m
   Pattern: [32m.hostname[0m
[30;1m120 | [0m[35m            else self._get_ctl_value(config, 'insecure', False)[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        if self._apply_ssl_file_param(config, 'cert'):[0m
[30;1m123 | [0m[35m            if insecure:  # The assert_hostname = False helps to silence warnings[0m
[30;1m124 | [0m[35m                self._pool.connection_pool_kw['assert_hostname'] = False[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            self._apply_ssl_file_param(config, 'key')[0m

[31m--[ [0m[34mMatch #[0m[33m1568[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m    def _update_leader(self, leader: Leader) -> bool:[0m
[30;1m423 | [0m[35m        ret = self._sync_obj.set(self.leader_path, self._name, ttl=self._ttl,[0m
[30;1m424 | [0m[35m                                 handle_raft_error=False, prevValue=self._name) is not False[0m
[30;1m425 | [0m[35m        if not ret and self._sync_obj.get(self.leader_path) is None:[0m
[30;1m426 | [0m[35m            ret = self.attempt_to_acquire_leader()[0m
[30;1m427 | [0m[35m        return ret[0m
[30;1m428 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1569[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m        :returns: all MPP groups as :class:`dict`, with group IDs as keys and :class:`Cluster` objec[0m
[30;1m399 | [0m[35m        """[0m
[30;1m400 | [0m[35m        clusters: Dict[int, Dict[str, Any]] = defaultdict(dict)[0m
[30;1m401 | [0m[35m        response = self._sync_obj.get(path, recursive=True)[0m
[30;1m402 | [0m[35m        for key, value in (response or {}).items():[0m
[30;1m403 | [0m[35m            key = key[len(path):].split('/', 1)[0m
[30;1m404 | [0m[35m            if len(key) == 2 and self._mpp.group_re.match(key[0]):[0m

[31m--[ [0m[34mMatch #[0m[33m1570[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35m        :returns: :class:`Cluster` instance.[0m
[30;1m386 | [0m[35m        """[0m
[30;1m387 | [0m[35m        response = self._sync_obj.get(path, recursive=True)[0m
[30;1m388 | [0m[35m        if not response:[0m
[30;1m389 | [0m[35m            return Cluster.empty()[0m
[30;1m390 | [0m[35m        nodes = {key[len(path):]: value for key, value in response.items()}[0m

[31m--[ [0m[34mMatch #[0m[33m1571[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m369 | [0m[35m        sync = SyncState.from_node(sync and sync['index'], sync and sync['value'])[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m        # get failsafe topology[0m
[30;1m372 | [0m[35m        failsafe = nodes.get(self._FAILSAFE)[0m
[30;1m373 | [0m[35m        try:[0m
[30;1m374 | [0m[35m            failsafe = json.loads(failsafe['value']) if failsafe else None[0m
[30;1m375 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m1572[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m365 | [0m[35m            failover = Failover.from_node(failover['index'], failover['value'])[0m
[30;1m366 | [0m[35m[0m
[30;1m367 | [0m[35m        # get synchronization state[0m
[30;1m368 | [0m[35m        sync = nodes.get(self._SYNC)[0m
[30;1m369 | [0m[35m        sync = SyncState.from_node(sync and sync['index'], sync and sync['value'])[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m        # get failsafe topology[0m

[31m--[ [0m[34mMatch #[0m[33m1573[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m            leader = Leader(leader['index'], None, member)[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m        # failover key[0m
[30;1m363 | [0m[35m        failover = nodes.get(self._FAILOVER)[0m
[30;1m364 | [0m[35m        if failover:[0m
[30;1m365 | [0m[35m            failover = Failover.from_node(failover['index'], failover['value'])[0m
[30;1m366 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1574[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m        members = [self.member(k, n) for k, n in nodes.items() if k.startswith(self._MEMBERS) and k.[0m
[30;1m354 | [0m[35m[0m
[30;1m355 | [0m[35m        # get leader[0m
[30;1m356 | [0m[35m        leader = nodes.get(self._LEADER)[0m
[30;1m357 | [0m[35m        if leader:[0m
[30;1m358 | [0m[35m            member = Member(-1, leader['value'], None, {})[0m
[30;1m359 | [0m[35m            member = ([m for m in members if m.name == leader['value']] or [member])[0][0m

[31m--[ [0m[34mMatch #[0m[33m1575[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m346 | [0m[35m        history = history and TimelineHistory.from_node(history['index'], history['value'])[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # get last know leader lsn and slots[0m
[30;1m349 | [0m[35m        status = nodes.get(self._STATUS) or nodes.get(self._LEADER_OPTIME)[0m
[30;1m350 | [0m[35m        status = Status.from_node(status and status['value'])[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m        # get list of members[0m

[31m--[ [0m[34mMatch #[0m[33m1576[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m346 | [0m[35m        history = history and TimelineHistory.from_node(history['index'], history['value'])[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # get last know leader lsn and slots[0m
[30;1m349 | [0m[35m        status = nodes.get(self._STATUS) or nodes.get(self._LEADER_OPTIME)[0m
[30;1m350 | [0m[35m        status = Status.from_node(status and status['value'])[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m        # get list of members[0m

[31m--[ [0m[34mMatch #[0m[33m1577[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m342 | [0m[35m        config = config and ClusterConfig.from_node(config['index'], config['value'])[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        # get timeline history[0m
[30;1m345 | [0m[35m        history = nodes.get(self._HISTORY)[0m
[30;1m346 | [0m[35m        history = history and TimelineHistory.from_node(history['index'], history['value'])[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # get last know leader lsn and slots[0m

[31m--[ [0m[34mMatch #[0m[33m1578[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m        initialize = initialize and initialize['value'][0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m        # get global dynamic configuration[0m
[30;1m341 | [0m[35m        config = nodes.get(self._CONFIG)[0m
[30;1m342 | [0m[35m        config = config and ClusterConfig.from_node(config['index'], config['value'])[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        # get timeline history[0m

[31m--[ [0m[34mMatch #[0m[33m1579[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m    def _cluster_from_nodes(self, nodes: Dict[str, Any]) -> Cluster:[0m
[30;1m336 | [0m[35m        # get initialize flag[0m
[30;1m337 | [0m[35m        initialize = nodes.get(self._INITIALIZE)[0m
[30;1m338 | [0m[35m        initialize = initialize and initialize['value'][0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m        # get global dynamic configuration[0m

[31m--[ [0m[34mMatch #[0m[33m1580[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m                logger.info('waiting on raft')[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m    def _on_set(self, key: str, value: Dict[str, Any]) -> None:[0m
[30;1m306 | [0m[35m        leader = (self._sync_obj.get(self.leader_path) or {}).get('value')[0m
[30;1m307 | [0m[35m        if key == value['created'] == value['updated'] and \[0m
[30;1m308 | [0m[35m                (key.startswith(self.members_path) or key == self.leader_path and leader != self._na[0m
[30;1m309 | [0m[35m                key in (self.leader_optime_path, self.status_path) and leader != self._name or \[0m

[31m--[ [0m[34mMatch #[0m[33m1581[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m                logger.info('waiting on raft')[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m    def _on_set(self, key: str, value: Dict[str, Any]) -> None:[0m
[30;1m306 | [0m[35m        leader = (self._sync_obj.get(self.leader_path) or {}).get('value')[0m
[30;1m307 | [0m[35m        if key == value['created'] == value['updated'] and \[0m
[30;1m308 | [0m[35m                (key.startswith(self.members_path) or key == self.leader_path and leader != self._na[0m
[30;1m309 | [0m[35m                key in (self.leader_optime_path, self.status_path) and leader != self._name or \[0m

[31m--[ [0m[34mMatch #[0m[33m1582[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m    def __init__(self, config: Dict[str, Any], mpp: AbstractMPP) -> None:[0m
[30;1m291 | [0m[35m        super(Raft, self).__init__(config, mpp)[0m
[30;1m292 | [0m[35m        self._ttl = int(config.get('ttl') or 30)[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        ready_event = threading.Event()[0m
[30;1m295 | [0m[35m        self._sync_obj = KVStoreTTL(ready_event.set, self._on_set, self._on_delete, commandsWaitLead[0m

[31m--[ [0m[34mMatch #[0m[33m1583[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    def get(self, key: str, recursive: bool = False) -> Optional[Dict[str, Any]]:[0m
[30;1m259 | [0m[35m        if not recursive:[0m
[30;1m260 | [0m[35m            return self.__data.get(key)[0m
[30;1m261 | [0m[35m        return {k: v for k, v in self.__data.items() if k.startswith(key)}[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    def _onTick(self, timeToWait: float = 0.0) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1584[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    @replicated[0m
[30;1m242 | [0m[35m    def _expire(self, key: str, value: Dict[str, Any], callback: Optional[Callable[..., Any]] = None[0m
[30;1m243 | [0m[35m        current = self.__data.get(key)[0m
[30;1m244 | [0m[35m        if current and self.__values_match(current, value):[0m
[30;1m245 | [0m[35m            self.__pop(key)[0m
[30;1m246 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1585[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    @staticmethod[0m
[30;1m238 | [0m[35m    def __values_match(old: Dict[str, Any], new: Dict[str, Any]) -> bool:[0m
[30;1m239 | [0m[35m        return all(old.get(n) == new.get(n) for n in ('created', 'updated', 'expire', 'value'))[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    @replicated[0m
[30;1m242 | [0m[35m    def _expire(self, key: str, value: Dict[str, Any], callback: Optional[Callable[..., Any]] = None[0m

[31m--[ [0m[34mMatch #[0m[33m1586[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    @staticmethod[0m
[30;1m238 | [0m[35m    def __values_match(old: Dict[str, Any], new: Dict[str, Any]) -> bool:[0m
[30;1m239 | [0m[35m        return all(old.get(n) == new.get(n) for n in ('created', 'updated', 'expire', 'value'))[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    @replicated[0m
[30;1m242 | [0m[35m    def _expire(self, key: str, value: Dict[str, Any], callback: Optional[Callable[..., Any]] = None[0m

[31m--[ [0m[34mMatch #[0m[33m1587[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m        return True[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m    def delete(self, key: str, recursive: bool = False, **kwargs: Any) -> bool:[0m
[30;1m230 | [0m[35m        if not recursive and not self.__check_requirements(self.__data.get(key, {}), **kwargs):[0m
[30;1m231 | [0m[35m            return False[0m
[30;1m232 | [0m[35m        try:[0m
[30;1m233 | [0m[35m            return self.retry(self._delete, key, recursive=recursive, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m1588[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m            for k in list(self.__data.keys()):[0m
[30;1m221 | [0m[35m                if k.startswith(key):[0m
[30;1m222 | [0m[35m                    self.__pop(k)[0m
[30;1m223 | [0m[35m        elif not self.__check_requirements(self.__data.get(key, {}), **kwargs):[0m
[30;1m224 | [0m[35m            return False[0m
[30;1m225 | [0m[35m        else:[0m
[30;1m226 | [0m[35m            self.__pop(key)[0m

[31m--[ [0m[34mMatch #[0m[33m1589[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m            return False[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        data: Dict[str, Any] = {'value': value, 'updated': time.time()}[0m
[30;1m202 | [0m[35m        data['created'] = old_value.get('created', data['updated'])[0m
[30;1m203 | [0m[35m        if ttl:[0m
[30;1m204 | [0m[35m            data['expire'] = data['updated'] + ttl[0m
[30;1m205 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1590[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m    def set(self, key: str, value: str, ttl: Optional[int] = None,[0m
[30;1m196 | [0m[35m            handle_raft_error: bool = True, **kwargs: Any) -> Union[bool, Dict[str, Any]]:[0m
[30;1m197 | [0m[35m        old_value = self.__data.get(key, {})[0m
[30;1m198 | [0m[35m        if not self.__check_requirements(old_value, **kwargs):[0m
[30;1m199 | [0m[35m            return False[0m
[30;1m200 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1591[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m    @replicated[0m
[30;1m181 | [0m[35m    def _set(self, key: str, value: Dict[str, Any], **kwargs: Any) -> Union[bool, Dict[str, Any]]:[0m
[30;1m182 | [0m[35m        old_value = self.__data.get(key, {})[0m
[30;1m183 | [0m[35m        if not self.__check_requirements(old_value, **kwargs):[0m
[30;1m184 | [0m[35m            return False[0m
[30;1m185 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1592[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    def __check_requirements(old_value: Dict[str, Any], **kwargs: Any) -> bool:[0m
[30;1m146 | [0m[35m        return bool(('prevExist' not in kwargs or bool(kwargs['prevExist']) == bool(old_value))[0m
[30;1m147 | [0m[35m                    and ('prevValue' not in kwargs or old_value and old_value['value'] == kwargs['pr[0m
[30;1m148 | [0m[35m                    and (kwargs.get('prevIndex') is None or old_value and old_value['index'] == kwar[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def set_retry_timeout(self, retry_timeout: int) -> None:[0m
[30;1m151 | [0m[35m        self.__retry_timeout = retry_timeout[0m

[31m--[ [0m[34mMatch #[0m[33m1593[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35mf = SyncObjConf(password=config.get('password'), autoTick=False, appendEntriesUseBatch=False,[0m
[30;1m135 | [0m[35m                           bindAddress=config.get('bind_addr'), dnsFailCacheTime=(config.get('loop_w[0m
[30;1m136 | [0m[35m                           dnsCacheTime=(config.get('ttl') or 30), commandsWaitLeader=config.get('co[0m
[30;1m137 | [0m[35m                           fullDumpFile=(file_template + '.dump' if self_addr else None),[0m
[30;1m138 | [0m[35m                           journalFile=(file_template + '.journal' if self_addr else None),[0m
[30;1m139 | [0m[35m                           onReady=on_ready, dynamicMembershipChange=True)[0m
[30;1m140 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1594[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35moin(raft_data_dir, file_template)[0m
[30;1m134 | [0m[35m        conf = SyncObjConf(password=config.get('password'), autoTick=False, appendEntriesUseBatch=Fa[0m
[30;1m135 | [0m[35m                           bindAddress=config.get('bind_addr'), dnsFailCacheTime=(config.get('loop_w[0m
[30;1m136 | [0m[35m                           dnsCacheTime=(config.get('ttl') or 30), commandsWaitLeader=config.get('co[0m
[30;1m137 | [0m[35m                           fullDumpFile=(file_template + '.dump' if self_addr else None),[0m
[30;1m138 | [0m[35m                           journalFile=(file_template + '.journal' if self_addr else None),[0m

[31m--[ [0m[34mMatch #[0m[33m1595[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m) if os.name == 'nt' else file_template[0m
[30;1m133 | [0m[35m        file_template = os.path.join(raft_data_dir, file_template)[0m
[30;1m134 | [0m[35m        conf = SyncObjConf(password=config.get('password'), autoTick=False, appendEntriesUseBatch=Fa[0m
[30;1m135 | [0m[35m                           bindAddress=config.get('bind_addr'), dnsFailCacheTime=(config.get('loop_w[0m
[30;1m136 | [0m[35m                           dnsCacheTime=(config.get('ttl') or 30), commandsWaitLeader=config.get('co[0m
[30;1m137 | [0m[35m                           fullDumpFile=(file_template + '.dump' if self_addr else None),[0m

[31m--[ [0m[34mMatch #[0m[33m1596[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35me_template = file_template.replace(':', '_') if os.name == 'nt' else file_template[0m
[30;1m133 | [0m[35m        file_template = os.path.join(raft_data_dir, file_template)[0m
[30;1m134 | [0m[35m        conf = SyncObjConf(password=config.get('password'), autoTick=False, appendEntriesUseBatch=Fa[0m
[30;1m135 | [0m[35m                           bindAddress=config.get('bind_addr'), dnsFailCacheTime=(config.get('loop_w[0m
[30;1m136 | [0m[35m                           dnsCacheTime=(config.get('ttl') or 30), commandsWaitLeader=config.get('co[0m
[30;1m137 | [0m[35m                           fullDumpFile=(file_template + '.dump' if self_addr else None),[0m

[31m--[ [0m[34mMatch #[0m[33m1597[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m != '':[0m
[30;1m129 | [0m[35m            validate_directory(raft_data_dir)[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        file_template = (self_addr or '')[0m
[30;1m132 | [0m[35m        file_template = file_template.replace(':', '_') if os.name == 'nt' else file_template[0m
[30;1m133 | [0m[35m        file_template = os.path.join(raft_data_dir, file_template)[0m
[30;1m134 | [0m[35m        conf = SyncObjConf(password=config.get('password'), autoTick=False, appendEntriesUseBatch=Fa[0m
[30;1m135 | [0m[35m                           bindAddress=config.get('bind_addr'), dnsFailCacheTime=(config.get('loop_w[0m
[30;1m136 | [0m[35m                           dnsCacheTime=(config.get('ttl') or 30), commandsWaitLeader=config.get('co[0m

[31m--[ [0m[34mMatch #[0m[33m1598[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m            self_addr = None[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        # Create raft data_dir if necessary[0m
[30;1m127 | [0m[35m        raft_data_dir = config.get('data_dir', '')[0m
[30;1m128 | [0m[35m        if raft_data_dir != '':[0m
[30;1m129 | [0m[35m            validate_directory(raft_data_dir)[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1599[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        self_addr = config.get('self_addr')[0m
[30;1m120 | [0m[35m        partner_addrs: Set[str] = set(config.get('partner_addrs', []))[0m
[30;1m121 | [0m[35m        if config.get('patronictl'):[0m
[30;1m122 | [0m[35m            if self_addr:[0m
[30;1m123 | [0m[35m                partner_addrs.add(self_addr)[0m
[30;1m124 | [0m[35m            self_addr = None[0m

[31m--[ [0m[34mMatch #[0m[33m1600[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m        self.set_retry_timeout(int(config.get('retry_timeout') or 10))[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        self_addr = config.get('self_addr')[0m
[30;1m120 | [0m[35m        partner_addrs: Set[str] = set(config.get('partner_addrs', []))[0m
[30;1m121 | [0m[35m        if config.get('patronictl'):[0m
[30;1m122 | [0m[35m            if self_addr:[0m
[30;1m123 | [0m[35m                partner_addrs.add(self_addr)[0m

[31m--[ [0m[34mMatch #[0m[33m1601[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        self.__limb: Dict[str, Dict[str, Any]] = {}[0m
[30;1m117 | [0m[35m        self.set_retry_timeout(int(config.get('retry_timeout') or 10))[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        self_addr = config.get('self_addr')[0m
[30;1m120 | [0m[35m        partner_addrs: Set[str] = set(config.get('partner_addrs', []))[0m
[30;1m121 | [0m[35m        if config.get('patronictl'):[0m
[30;1m122 | [0m[35m            if self_addr:[0m

[31m--[ [0m[34mMatch #[0m[33m1602[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        self.__on_set = on_set[0m
[30;1m115 | [0m[35m        self.__on_delete = on_delete[0m
[30;1m116 | [0m[35m        self.__limb: Dict[str, Dict[str, Any]] = {}[0m
[30;1m117 | [0m[35m        self.set_retry_timeout(int(config.get('retry_timeout') or 10))[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        self_addr = config.get('self_addr')[0m
[30;1m120 | [0m[35m        partner_addrs: Set[str] = set(config.get('partner_addrs', []))[0m

[31m--[ [0m[34mMatch #[0m[33m1603[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m                break[0m
[30;1m173 | [0m[35m            elif deadline:[0m
[30;1m174 | [0m[35m                timeout = deadline - time.time()[0m
[30;1m175 | [0m[35m                if timeout <= 0:[0m
[30;1m176 | [0m[35m                    raise RaftError('timeout')[0m
[30;1m177 | [0m[35m            time.sleep(1)[0m
[30;1m178 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m1604[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m            elif ret['error'] == FAIL_REASON.REQUEST_DENIED:[0m
[30;1m172 | [0m[35m                break[0m
[30;1m173 | [0m[35m            elif deadline:[0m
[30;1m174 | [0m[35m                timeout = deadline - time.time()[0m
[30;1m175 | [0m[35m                if timeout <= 0:[0m
[30;1m176 | [0m[35m                    raise RaftError('timeout')[0m
[30;1m177 | [0m[35m            time.sleep(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1605[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        kwargs['callback'] = callback[0m
[30;1m162 | [0m[35m        timeout = kwargs.pop('timeout', None) or self.__retry_timeout[0m
[30;1m163 | [0m[35m        deadline = timeout and time.time() + timeout[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        while True:[0m
[30;1m166 | [0m[35m            event.clear()[0m
[30;1m167 | [0m[35m            func(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m1606[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        kwargs['callback'] = callback[0m
[30;1m162 | [0m[35m        timeout = kwargs.pop('timeout', None) or self.__retry_timeout[0m
[30;1m163 | [0m[35m        deadline = timeout and time.time() + timeout[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        while True:[0m
[30;1m166 | [0m[35m            event.clear()[0m

[31m--[ [0m[34mMatch #[0m[33m1607[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m159 | [0m[35m            event.set()[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        kwargs['callback'] = callback[0m
[30;1m162 | [0m[35m        timeout = kwargs.pop('timeout', None) or self.__retry_timeout[0m
[30;1m163 | [0m[35m        deadline = timeout and time.time() + timeout[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        while True:[0m

[31m--[ [0m[34mMatch #[0m[33m1608[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    def getMembers(self, args: Any, callback: Callable[[Any, Any], Any]) -> None:[0m
[30;1m95 | [0m[35m        callback([{'addr': node.id, 'leader': node == self._getLeader(), 'status': CONNECTION_STATE.[0m
[30;1m96 | [0m[35m                   if self.isNodeConnected(node) else CONNECTION_STATE.DISCONNECTED} for node in sel[0m
[30;1m97 | [0m[35m                 + [{'addr': self.selfNode.id, 'leader': self._isLeader(), 'status': CONNECTION_STAT[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    def _onTick(self, timeToWait: float = 0.0):[0m

[31m--[ [0m[34mMatch #[0m[33m1609[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m            thread.start()[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    def getMembers(self, args: Any, callback: Callable[[Any, Any], Any]) -> None:[0m
[30;1m95 | [0m[35m        callback([{'addr': node.id, 'leader': node == self._getLeader(), 'status': CONNECTION_STATE.[0m
[30;1m96 | [0m[35m                   if self.isNodeConnected(node) else CONNECTION_STATE.DISCONNECTED} for node in sel[0m
[30;1m97 | [0m[35m                 + [{'addr': self.selfNode.id, 'leader': self._isLeader(), 'status': CONNECTION_STAT[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1610[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/raft.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom collections import defaultdict[0m
[30;1m8 | [0m[35mfrom typing import Any, Callable, Collection, Dict, List, Optional, Set, TYPE_CHECKING, Union[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1611[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/callback_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m72 | [0m[35m                    self._condition.wait()[0m
[30;1m73 | [0m[35m                cmd, self._cmd = self._cmd, None[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m            if cmd is not None:[0m
[30;1m76 | [0m[35m                with self._lock:[0m
[30;1m77 | [0m[35m                    if not self._start_process(cmd, close_fds=True):[0m
[30;1m78 | [0m[35m                        continue[0m

[31m--[ [0m[34mMatch #[0m[33m1612[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/callback_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        self._kill_process()[0m
[30;1m64 | [0m[35m        with self._condition:[0m
[30;1m65 | [0m[35m            self._cmd = cmd[0m
[30;1m66 | [0m[35m            self._condition.notify()[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    def run(self) -> None:[0m
[30;1m69 | [0m[35m        while True:[0m

[31m--[ [0m[34mMatch #[0m[33m1613[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/callback_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m48 | [0m[35m        self.start()[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    def call(self, cmd: List[str]) -> None:[0m
[30;1m51 | [0m[35m        """Executes one callback at a time.[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        Already running command is killed (including child processes).[0m
[30;1m54 | [0m[35m        If it couldn't be killed we wait until it finishes.[0m

[31m--[ [0m[34mMatch #[0m[33m1614[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/callback_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35mclass OnReloadExecutor(CancellableSubprocess):[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    def call_nowait(self, cmd: List[str]) -> None:[0m
[30;1m28 | [0m[35m        """Run one `on_reload` callback at most.[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        To achieve it we always kill already running command including child processes."""[0m
[30;1m31 | [0m[35m        self.cancel(kill=True)[0m

[31m--[ [0m[34mMatch #[0m[33m1615[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m    @property[0m
[30;1m97 | [0m[35m    def nostream(self) -> bool:[0m
[30;1m98 | [0m[35m        """``True`` if ``nostream`` is ``True``, else ``False``."""[0m
[30;1m99 | [0m[35m        return parse_bool(self.tags.get('nostream')) or False[0m

[31m--[ [0m[34mMatch #[0m[33m1616[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    @property[0m
[30;1m92 | [0m[35m    def replicatefrom(self) -> Optional[str]:[0m
[30;1m93 | [0m[35m        """Value of ``replicatefrom`` tag, if any."""[0m
[30;1m94 | [0m[35m        return self.tags.get('replicatefrom')[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    @property[0m
[30;1m97 | [0m[35m    def nostream(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1617[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m    @property[0m
[30;1m87 | [0m[35m    def nosync(self) -> bool:[0m
[30;1m88 | [0m[35m        """``True`` if ``nosync`` is ``True``, else ``False``."""[0m
[30;1m89 | [0m[35m        return bool(self.tags.get('nosync', False))[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    @property[0m
[30;1m92 | [0m[35m    def replicatefrom(self) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m1618[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    @property[0m
[30;1m82 | [0m[35m    def noloadbalance(self) -> bool:[0m
[30;1m83 | [0m[35m        """``True`` if ``noloadbalance`` is ``True``, else ``False``."""[0m
[30;1m84 | [0m[35m        return bool(self.tags.get('noloadbalance', False))[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    @property[0m
[30;1m87 | [0m[35m    def nosync(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1619[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        ``failover_priority``, defaulting to ``1`` if it's not defined or invalid.[0m
[30;1m75 | [0m[35m        """[0m
[30;1m76 | [0m[35m        from_tags = self.tags.get('nofailover')[0m
[30;1m77 | [0m[35m        failover_priority = parse_int(self.tags.get('failover_priority'))[0m
[30;1m78 | [0m[35m        failover_priority = 1 if failover_priority is None else failover_priority[0m
[30;1m79 | [0m[35m        return 0 if from_tags else failover_priority[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1620[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        If ``nofailover`` is defined as ``True``, this will return ``0``. Otherwise, it will return [0m
[30;1m74 | [0m[35m        ``failover_priority``, defaulting to ``1`` if it's not defined or invalid.[0m
[30;1m75 | [0m[35m        """[0m
[30;1m76 | [0m[35m        from_tags = self.tags.get('nofailover')[0m
[30;1m77 | [0m[35m        failover_priority = parse_int(self.tags.get('failover_priority'))[0m
[30;1m78 | [0m[35m        failover_priority = 1 if failover_priority is None else failover_priority[0m
[30;1m79 | [0m[35m        return 0 if from_tags else failover_priority[0m

[31m--[ [0m[34mMatch #[0m[33m1621[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        if from_tags is not None:[0m
[30;1m64 | [0m[35m            # Value of `nofailover` takes precedence over `failover_priority`[0m
[30;1m65 | [0m[35m            return bool(from_tags)[0m
[30;1m66 | [0m[35m        failover_priority = parse_int(self.tags.get('failover_priority'))[0m
[30;1m67 | [0m[35m        return failover_priority is not None and failover_priority <= 0[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1622[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        If ``nofailover`` is not defined, this methods returns ``True`` if ``failover_priority`` is [0m
[30;1m60 | [0m[35m        ``False`` otherwise.[0m
[30;1m61 | [0m[35m        """[0m
[30;1m62 | [0m[35m        from_tags = self.tags.get('nofailover')[0m
[30;1m63 | [0m[35m        if from_tags is not None:[0m
[30;1m64 | [0m[35m            # Value of `nofailover` takes precedence over `failover_priority`[0m
[30;1m65 | [0m[35m            return bool(from_tags)[0m

[31m--[ [0m[34mMatch #[0m[33m1623[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m    @property[0m
[30;1m51 | [0m[35m    def clonefrom(self) -> bool:[0m
[30;1m52 | [0m[35m        """``True`` if ``clonefrom`` tag is ``True``, else ``False``."""[0m
[30;1m53 | [0m[35m        return self.tags.get('clonefrom', False)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    @property[0m
[30;1m56 | [0m[35m    def nofailover(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1624[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35mdef mock_open(*args, **kwargs):[0m
[30;1m23 | [0m[35m    ret = _mock_open(*args, **kwargs)[0m
[30;1m24 | [0m[35m    ret.return_value.__iter__ = lambda o: iter(o.readline, '')[0m
[30;1m25 | [0m[35m    if not kwargs.get('read_data'):[0m
[30;1m26 | [0m[35m        ret.return_value.readline = Mock(return_value=None)[0m
[30;1m27 | [0m[35m    return ret[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1625[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m.hostname[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom . import MockConnect, MockCursor, psycopg_connect[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mHOSTNAME = 'test_hostname'[0m
[30;1m19 | [0m[35mIP = '1.9.8.4'[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1626[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m                _main()[0m
[30;1m338 | [0m[35m            self.assertIn('Failed to read pg_ident.conf', e.exception.code)[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m            # 9. Failed PG connection[0m
[30;1m341 | [0m[35m            from . import psycopg[0m
[30;1m342 | [0m[35m            with patch('patroni.psycopg.connect', side_effect=psycopg.Error), \[0m
[30;1m343 | [0m[35m                 self.assertRaises(SystemExit) as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1627[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m229 | [0m[35m    @patch('sys.stdout')[0m
[30;1m230 | [0m[35m    def test_generate_config_running_instance_17_connect_from_env(self, mock_sys_stdout):[0m
[30;1m231 | [0m[35m        self._set_running_instance_config_vals()[0m
[30;1m232 | [0m[35m        # su auth params and connect host from env[0m
[30;1m233 | [0m[35m        os.environ['PGCHANNELBINDING'] = \[0m
[30;1m234 | [0m[35m            self.config['postgresql']['authentication']['superuser']['channel_binding'] = 'disable'[0m
[30;1m235 | [0m[35m        os.environ['PGSSLNEGOTIATION'] = \[0m
[30;1m236 | [0m[35m            self.config['postgresql']['authentication']['superuser']['sslnegotiation'] = 'direct'[0m

[31m--[ [0m[34mMatch #[0m[33m1628[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m            'postgresql': {[0m
[30;1m79 | [0m[35m                'connect_address': IP + ':5432',[0m
[30;1m80 | [0m[35m                'data_dir': NO_VALUE_MSG,[0m
[30;1m81 | [0m[35m                'listen': IP + ':5432',[0m
[30;1m82 | [0m[35m                'pg_hba': ['host all all all md5',[0m
[30;1m83 | [0m[35m                           f'host replication {self.environ["PATRONI_REPLICATION_USERNAME"]} all md5[0m
[30;1m84 | [0m[35m                'authentication': {'superuser': {'username': self.environ['PATRONI_SUPERUSER_USERNAM[0m

[31m--[ [0m[34mMatch #[0m[33m1629[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m                'dcs': dynamic_config[0m
[30;1m77 | [0m[35m            },[0m
[30;1m78 | [0m[35m            'postgresql': {[0m
[30;1m79 | [0m[35m                'connect_address': IP + ':5432',[0m
[30;1m80 | [0m[35m                'data_dir': NO_VALUE_MSG,[0m
[30;1m81 | [0m[35m                'listen': IP + ':5432',[0m
[30;1m82 | [0m[35m                'pg_hba': ['host all all all md5',[0m

[31m--[ [0m[34mMatch #[0m[33m1630[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_config_generator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom . import MockConnect, MockCursor, psycopg_connect[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mHOSTNAME = 'test_hostname'[0m
[30;1m19 | [0m[35mIP = '1.9.8.4'[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mdef mock_open(*args, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m1631[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m                    logger.exception('touch_member')[0m
[30;1m376 | [0m[35m                    return False[0m
[30;1m377 | [0m[35m        try:[0m
[30;1m378 | [0m[35m            self._client.set_async(self.member_path, encoded_data).get(timeout=1)[0m
[30;1m379 | [0m[35m            self.__last_member_data = data[0m
[30;1m380 | [0m[35m            return True[0m
[30;1m381 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m1632[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m                return True[0m
[30;1m368 | [0m[35m        else:[0m
[30;1m369 | [0m[35m            try:[0m
[30;1m370 | [0m[35m                self._client.create_async(self.member_path, encoded_data, makepath=True, ephemeral=T[0m
[30;1m371 | [0m[35m                self.__last_member_data = data[0m
[30;1m372 | [0m[35m                return True[0m
[30;1m373 | [0m[35m            except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1633[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m354 | [0m[35m            if self._client.client_id is not None and member.session != self._client.client_id[0]:[0m
[30;1m355 | [0m[35m                logger.warning('Recreating the member ZNode due to ownership mismatch')[0m
[30;1m356 | [0m[35m                try:[0m
[30;1m357 | [0m[35m                    self._client.delete_async(self.member_path).get(timeout=1)[0m
[30;1m358 | [0m[35m                except NoNodeError:[0m
[30;1m359 | [0m[35m                    pass[0m
[30;1m360 | [0m[35m                except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m1634[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m            if retry:[0m
[30;1m321 | [0m[35m                ret = self._client.retry(self._client.set, key, value_bytes, version=version or -1)[0m
[30;1m322 | [0m[35m            else:[0m
[30;1m323 | [0m[35m                ret = self._client.set_async(key, value_bytes, version=version or -1).get(timeout=1)[0m
[30;1m324 | [0m[35m            return ret.version[0m
[30;1m325 | [0m[35m        except NoNodeError:[0m
[30;1m326 | [0m[35m            if do_not_create_empty and not value_bytes:[0m

[31m--[ [0m[34mMatch #[0m[33m1635[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m            if retry:[0m
[30;1m295 | [0m[35m                self._client.retry(self._client.create, path, value, makepath=True, ephemeral=epheme[0m
[30;1m296 | [0m[35m            else:[0m
[30;1m297 | [0m[35m                self._client.create_async(path, value, makepath=True, ephemeral=ephemeral).get(timeo[0m
[30;1m298 | [0m[35m            return True[0m
[30;1m299 | [0m[35m        except Exception:[0m
[30;1m300 | [0m[35m            logger.exception('Failed to create %s', path)[0m

[31m--[ [0m[34mMatch #[0m[33m1636[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m            self, key: str, watch: Optional[Callable[[WatchedEvent], None]] = None[0m
[30;1m189 | [0m[35m    ) -> Optional[Tuple[str, ZnodeStat]]:[0m
[30;1m190 | [0m[35m        try:[0m
[30;1m191 | [0m[35m            ret = self._client.get(key, watch)[0m
[30;1m192 | [0m[35m            return (ret[0].decode('utf-8'), ret[1])[0m
[30;1m193 | [0m[35m        except NoNodeError:[0m
[30;1m194 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m1637[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m                                          timeout=config['ttl'], connection_retry=KazooRetry(max_del[0m
[30;1m119 | [0m[35m                                          sleep_func=time.sleep), command_retry=KazooRetry(max_delay[0m
[30;1m120 | [0m[35m                                          deadline=config['retry_timeout'], sleep_func=time.sleep),[0m
[30;1m121 | [0m[35m                                          auth_data=list(config.get('auth_data', {}).items()), **kwa[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        self.__last_member_data: Optional[Dict[str, Any]] = None[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1638[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m    def __init__(self, config: Dict[str, Any], mpp: AbstractMPP) -> None:[0m
[30;1m93 | [0m[35m        super(ZooKeeper, self).__init__(config, mpp)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m        hosts: Union[str, List[str]] = config.get('hosts', [])[0m
[30;1m96 | [0m[35m        if isinstance(hosts, list):[0m
[30;1m97 | [0m[35m            hosts = ','.join(hosts)[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1639[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        args_list: List[Any] = list(args)[0m
[30;1m52 | [0m[35m        if len(args_list) == 0:  # kazoo 2.6.0 slightly changed the way how it calls create_connecti[0m
[30;1m53 | [0m[35m            kwargs['timeout'] = max(self._connect_timeout, kwargs.get('timeout', self._connect_timeo[0m
[30;1m54 | [0m[35m        elif len(args_list) == 1:[0m
[30;1m55 | [0m[35m            args_list.append(self._connect_timeout)[0m
[30;1m56 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1640[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m331 | [0m[35m            else:[0m
[30;1m332 | [0m[35m                return False[0m
[30;1m333 | [0m[35m        except Exception:[0m
[30;1m334 | [0m[35m            logger.exception('Failed to update %s', key)[0m
[30;1m335 | [0m[35m        return False[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m    def set_failover_value(self, value: str, version: Optional[int] = None) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1641[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        # We need to reestablish connection to zookeeper if we want to change[0m
[30;1m160 | [0m[35m        # read_timeout (and Ping interval respectively), because read_timeout[0m
[30;1m161 | [0m[35m        # is calculated in `_kazoo_connect` method. If we are changing ttl at[0m
[30;1m162 | [0m[35m        # the same time, set_ttl method will reestablish connection and return[0m
[30;1m163 | [0m[35m        # `!True`, otherwise we will close existing connection and let kazoo[0m
[30;1m164 | [0m[35m        # open the new one.[0m
[30;1m165 | [0m[35m        if not self.set_ttl(config['ttl']) and loop_wait_changed:[0m

[31m--[ [0m[34mMatch #[0m[33m1642[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    def watch(self, leader_version: Optional[int], timeout: float) -> bool:[0m
[30;1m454 | [0m[35m        if leader_version:[0m
[30;1m455 | [0m[35m            timeout += 0.5[0m
[30;1m456 | [0m[35m[0m
[30;1m457 | [0m[35m        try:[0m
[30;1m458 | [0m[35m            return super(ZooKeeper, self).watch(leader_version, timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m1643[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m423 | [0m[35m        return True[0m
[30;1m424 | [0m[35m[0m
[30;1m425 | [0m[35m    def _cancel_initialization(self) -> None:[0m
[30;1m426 | [0m[35m        node = self.get_node(self.initialize_path)[0m
[30;1m427 | [0m[35m        if node:[0m
[30;1m428 | [0m[35m            self._client.delete(self.initialize_path, version=node[1].version)[0m
[30;1m429 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1644[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m277 | [0m[35m        ret: Dict[int, Cluster] = {}[0m
[30;1m278 | [0m[35m        for node in self.get_children(path):[0m
[30;1m279 | [0m[35m            if self._mpp.group_re.match(node):[0m
[30;1m280 | [0m[35m                ret[int(node)] = self._postgresql_cluster_loader(path + node + '/')[0m
[30;1m281 | [0m[35m        return ret[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    def _load_cluster([0m

[31m--[ [0m[34mMatch #[0m[33m1645[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m275 | [0m[35m        :returns: all MPP groups as :class:`dict`, with group IDs as keys and :class:`Cluster` objec[0m
[30;1m276 | [0m[35m        """[0m
[30;1m277 | [0m[35m        ret: Dict[int, Cluster] = {}[0m
[30;1m278 | [0m[35m        for node in self.get_children(path):[0m
[30;1m279 | [0m[35m            if self._mpp.group_re.match(node):[0m
[30;1m280 | [0m[35m                ret[int(node)] = self._postgresql_cluster_loader(path + node + '/')[0m
[30;1m281 | [0m[35m        return ret[0m

[31m--[ [0m[34mMatch #[0m[33m1646[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m        only small time for reconnect and retry.[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        This method is needed to return different value of read_timeout, which is not calculated[0m
[30;1m138 | [0m[35m        from negotiated session timeout but from value of `loop_wait`. And it is 2 sec smaller[0m
[30;1m139 | [0m[35m        than loop_wait, because we can spend up to 2 seconds when calling `touch_member()` and[0m
[30;1m140 | [0m[35m        `write_leader_optime()` methods, which also may hang..."""[0m
[30;1m141 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1647[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m        response on Ping after Ping interval (1/2 from read_timeout) it will consider current[0m
[30;1m133 | [0m[35m        connection dead and try to connect to another node. Without this "magic" it was taking[0m
[30;1m134 | [0m[35m        up to 2/3 from session timeout (ttl) to figure out that connection was dead and we had[0m
[30;1m135 | [0m[35m        only small time for reconnect and retry.[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        This method is needed to return different value of read_timeout, which is not calculated[0m
[30;1m138 | [0m[35m        from negotiated session timeout but from value of `loop_wait`. And it is 2 sec smaller[0m

[31m--[ [0m[34mMatch #[0m[33m1648[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m        """Kazoo is using Ping's to determine health of connection to zookeeper. If there is no[0m
[30;1m132 | [0m[35m        response on Ping after Ping interval (1/2 from read_timeout) it will consider current[0m
[30;1m133 | [0m[35m        connection dead and try to connect to another node. Without this "magic" it was taking[0m
[30;1m134 | [0m[35m        up to 2/3 from session timeout (ttl) to figure out that connection was dead and we had[0m
[30;1m135 | [0m[35m        only small time for reconnect and retry.[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        This method is needed to return different value of read_timeout, which is not calculated[0m

[31m--[ [0m[34mMatch #[0m[33m1649[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m        self.set_connect_timeout(connect_timeout)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def set_connect_timeout(self, connect_timeout: Union[int, float]) -> None:[0m
[30;1m38 | [0m[35m        self._connect_timeout = max(1.0, connect_timeout / 2.0)  # try to connect to zookeeper node [0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    def create_connection(self, *args: Any, **kwargs: Any) -> socket.socket:[0m
[30;1m41 | [0m[35m        """This method is trying to establish connection with one of the zookeeper nodes.[0m

[31m--[ [0m[34mMatch #[0m[33m1650[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/dcs/zookeeper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport select[0m
[30;1m4 | [0m[35mimport socket[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom typing import Any, Callable, cast, Dict, List, Optional, Tuple, TYPE_CHECKING, Union[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom kazoo.client import KazooClient, KazooRetry, KazooState[0m

[31m--[ [0m[34mMatch #[0m[33m1651[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m            data = self.r.read_postmaster_opts()[0m
[30;1m221 | [0m[35m            self.assertEqual(data['wal_level'], 'hot_standby')[0m
[30;1m222 | [0m[35m            self.assertEqual(int(data['max_replication_slots']), 5)[0m
[30;1m223 | [0m[35m            self.assertEqual(data.get('D'), None)[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m            m.side_effect = IOError[0m
[30;1m226 | [0m[35m            data = self.r.read_postmaster_opts()[0m

[31m--[ [0m[34mMatch #[0m[33m1652[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m            mock_popen.return_value.communicate.return_value = ([0m
[30;1m198 | [0m[35m                b'0, lsn: 0/040159C1, prev 0/\n',[0m
[30;1m199 | [0m[35m                b'pg_waldump: fatal: error in WAL record at 0/40159C1: invalid record length at 0/40[0m
[30;1m200 | [0m[35m            )[0m
[30;1m201 | [0m[35m            self.r.reset_state()[0m
[30;1m202 | [0m[35m            self.r.trigger_check_diverged_lsn()[0m

[31m--[ [0m[34mMatch #[0m[33m1653[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m            mock_popen.return_value.communicate.return_value = ([0m
[30;1m198 | [0m[35m                b'0, lsn: 0/040159C1, prev 0/\n',[0m
[30;1m199 | [0m[35m                b'pg_waldump: fatal: error in WAL record at 0/40159C1: invalid record length at 0/40[0m
[30;1m200 | [0m[35m            )[0m
[30;1m201 | [0m[35m            self.r.reset_state()[0m
[30;1m202 | [0m[35m            self.r.trigger_check_diverged_lsn()[0m

[31m--[ [0m[34mMatch #[0m[33m1654[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m188 | [0m[35m            mock_popen.return_value.communicate.return_value = ([0m
[30;1m189 | [0m[35m                b'0, lsn: 0/040159C1, prev 0/\n',[0m
[30;1m190 | [0m[35m                b'pg_waldump: fatal: error in WAL record at 0/40159C1: invalid record '[0m
[30;1m191 | [0m[35m                b'length at 0/402DD98: expected at least 24, got 0\n'[0m
[30;1m192 | [0m[35m            )[0m
[30;1m193 | [0m[35m            self.r.reset_state()[0m
[30;1m194 | [0m[35m            self.r.trigger_check_diverged_lsn()[0m

[31m--[ [0m[34mMatch #[0m[33m1655[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m188 | [0m[35m            mock_popen.return_value.communicate.return_value = ([0m
[30;1m189 | [0m[35m                b'0, lsn: 0/040159C1, prev 0/\n',[0m
[30;1m190 | [0m[35m                b'pg_waldump: fatal: error in WAL record at 0/40159C1: invalid record '[0m
[30;1m191 | [0m[35m                b'length at 0/402DD98: expected at least 24, got 0\n'[0m
[30;1m192 | [0m[35m            )[0m
[30;1m193 | [0m[35m            self.r.reset_state()[0m
[30;1m194 | [0m[35m            self.r.trigger_check_diverged_lsn()[0m

[31m--[ [0m[34mMatch #[0m[33m1656[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m            mock_popen.return_value.communicate.return_value = ([0m
[30;1m189 | [0m[35m                b'0, lsn: 0/040159C1, prev 0/\n',[0m
[30;1m190 | [0m[35m                b'pg_waldump: fatal: error in WAL record at 0/40159C1: invalid record '[0m
[30;1m191 | [0m[35m                b'length at 0/402DD98: expected at least 24, got 0\n'[0m
[30;1m192 | [0m[35m            )[0m
[30;1m193 | [0m[35m            self.r.reset_state()[0m

[31m--[ [0m[34mMatch #[0m[33m1657[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m        with patch('subprocess.Popen') as mock_popen:[0m
[30;1m179 | [0m[35m            mock_popen.return_value.communicate.return_value = ([0m
[30;1m180 | [0m[35m                b'0, lsn: 0/040159C1, prev 0/\n',[0m
[30;1m181 | [0m[35m                b'pg_waldump: fatal: error in WAL record at 0/40159C1: invalid record length at /: w[0m
[30;1m182 | [0m[35m            )[0m
[30;1m183 | [0m[35m            self.r.reset_state()[0m
[30;1m184 | [0m[35m            self.r.trigger_check_diverged_lsn()[0m

[31m--[ [0m[34mMatch #[0m[33m1658[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_rewind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m        with patch('subprocess.Popen') as mock_popen:[0m
[30;1m179 | [0m[35m            mock_popen.return_value.communicate.return_value = ([0m
[30;1m180 | [0m[35m                b'0, lsn: 0/040159C1, prev 0/\n',[0m
[30;1m181 | [0m[35m                b'pg_waldump: fatal: error in WAL record at 0/40159C1: invalid record length at /: w[0m
[30;1m182 | [0m[35m            )[0m
[30;1m183 | [0m[35m            self.r.reset_state()[0m
[30;1m184 | [0m[35m            self.r.trigger_check_diverged_lsn()[0m

[31m--[ [0m[34mMatch #[0m[33m1659[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m    def is_worker(self) -> bool:[0m
[30;1m96 | [0m[35m        """Check whether this node is running as a MPP worker PostgreSQL cluster.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        :returns: ``True`` if MPP is enabled and this node is known to be not running[0m
[30;1m99 | [0m[35m                  as the coordinator PostgreSQL cluster, otherwise ``False``.[0m
[30;1m100 | [0m[35m        """[0m
[30;1m101 | [0m[35m        return self.is_enabled() and not self.is_coordinator()[0m

[31m--[ [0m[34mMatch #[0m[33m1660[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m        return self.is_enabled() and self.group == self.coordinator_group_id[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    def is_worker(self) -> bool:[0m
[30;1m96 | [0m[35m        """Check whether this node is running as a MPP worker PostgreSQL cluster.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        :returns: ``True`` if MPP is enabled and this node is known to be not running[0m
[30;1m99 | [0m[35m                  as the coordinator PostgreSQL cluster, otherwise ``False``.[0m

[31m--[ [0m[34mMatch #[0m[33m1661[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m    def is_coordinator(self) -> bool:[0m
[30;1m88 | [0m[35m        """Check whether this node is running in the coordinator PostgreSQL cluster.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        :returns: ``True`` if MPP is enabled and the group id of this node[0m
[30;1m91 | [0m[35m                  matches with the :attr:`coordinator_group_id`, otherwise ``False``.[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        return self.is_enabled() and self.group == self.coordinator_group_id[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1662[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m        return self.type.lower() + '-group'[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    def is_coordinator(self) -> bool:[0m
[30;1m88 | [0m[35m        """Check whether this node is running in the coordinator PostgreSQL cluster.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        :returns: ``True`` if MPP is enabled and the group id of this node[0m
[30;1m91 | [0m[35m                  matches with the :attr:`coordinator_group_id`, otherwise ``False``.[0m

[31m--[ [0m[34mMatch #[0m[33m1663[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/mpp/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m        """Check if MPP is enabled for a given MPP.[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        .. note::[0m
[30;1m41 | [0m[35m            We just check that the :attr:`_config` object isn't empty and expect[0m
[30;1m42 | [0m[35m            it to be empty only in case of :class:`Null`.[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        :returns: ``True`` if MPP is enabled, otherwise ``False``.[0m
[30;1m45 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1664[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m        ]))[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m        if not are_thresholds_ok:[0m
[30;1m292 | [0m[35m            logger.info('wal-e backup size diff is over threshold, falling back '[0m
[30;1m293 | [0m[35m                        'to other means of restore: %s', human_context)[0m
[30;1m294 | [0m[35m        else:[0m
[30;1m295 | [0m[35m            logger.info('Thresholds are OK, using wal-e basebackup: %s', human_context)[0m

[31m--[ [0m[34mMatch #[0m[33m1665[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m                                    dialect='excel-tab')[0m
[30;1m171 | [0m[35m            rows = list(reader)[0m
[30;1m172 | [0m[35m            if not len(rows):[0m
[30;1m173 | [0m[35m                logger.warning('wal-e did not find any backups')[0m
[30;1m174 | [0m[35m                return False[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m            # This check might not add much, it was performed in the previous[0m

[31m--[ [0m[34mMatch #[0m[33m1666[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m    FAIL = 2  #: Don't try again unless configuration changes[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m# We need to know the current PG version in order to figure out the correct WAL directory name[0m
[30;1m53 | [0m[35mdef get_major_version(data_dir: str) -> float:[0m
[30;1m54 | [0m[35m    version_file = os.path.join(data_dir, 'PG_VERSION')[0m
[30;1m55 | [0m[35m    if os.path.isfile(version_file):  # version file exists[0m

[31m--[ [0m[34mMatch #[0m[33m1667[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35mimport os[0m
[30;1m30 | [0m[35mimport subprocess[0m
[30;1m31 | [0m[35mimport sys[0m
[30;1m32 | [0m[35mimport time[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mfrom enum import IntEnum[0m
[30;1m35 | [0m[35mfrom typing import Any, List, NamedTuple, Optional, Tuple, TYPE_CHECKING[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1668[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m# - WALE_BACKUP_THRESHOLD_MEGABYTES if WAL amount is above that - use pg_basebackup[0m
[30;1m18 | [0m[35m# - WALE_BACKUP_THRESHOLD_PERCENTAGE if WAL size exceeds a certain percentage of the[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# this script depends on an envdir defining the S3 bucket (or SWIFT dir),and login[0m
[30;1m21 | [0m[35m# credentials per WALE Documentation.[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# currently also requires that you configure the restore_command to use wal_e, example:[0m

[31m--[ [0m[34mMatch #[0m[33m1669[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m#   - cluster role[0m
[30;1m14 | [0m[35m#   - leader connection string[0m
[30;1m15 | [0m[35m#   - number of retries[0m
[30;1m16 | [0m[35m#   - envdir for the WALE env[0m
[30;1m17 | [0m[35m# - WALE_BACKUP_THRESHOLD_MEGABYTES if WAL amount is above that - use pg_basebackup[0m
[30;1m18 | [0m[35m# - WALE_BACKUP_THRESHOLD_PERCENTAGE if WAL size exceeds a certain percentage of the[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# this script depends on an envdir defining the S3 bucket (or SWIFT dir),and login[0m

[31m--[ [0m[34mMatch #[0m[33m1670[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env python[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# sample script to clone new replicas using WAL-E restore[0m
[30;1m4 | [0m[35m# falls back to pg_basebackup if WAL-E restore fails, or if[0m
[30;1m5 | [0m[35m# WAL-E backup is too far behind[0m
[30;1m6 | [0m[35m# note that pg_basebackup still expects to use restore from[0m

[31m--[ [0m[34mMatch #[0m[33m1671[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m316 | [0m[35m    def create_replica_with_s3(self) -> int:[0m
[30;1m317 | [0m[35m        # if we're set up, restore the replica using fetch latest[0m
[30;1m318 | [0m[35m        try:[0m
[30;1m319 | [0m[35m            cmd = self.wal_e.cmd + ['backup-fetch',[0m
[30;1m320 | [0m[35m                                    '{}'.format(self.data_dir),[0m
[30;1m321 | [0m[35m                                    'LATEST'][0m
[30;1m322 | [0m[35m            logger.debug('calling: %r', cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1672[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m161 | [0m[35m        threshold_percent = self.wal_e.threshold_pct[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        try:[0m
[30;1m164 | [0m[35m            cmd = self.wal_e.cmd + ['backup-list', '--detail', 'LATEST'][0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m            logger.debug('calling %r', cmd)[0m
[30;1m167 | [0m[35m            wale_output = subprocess.check_output(cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1673[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/wale_restore.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        """[0m
[30;1m140 | [0m[35m        if self.init_error:[0m
[30;1m141 | [0m[35m            logger.error('init error: %r did not exist at initialization time',[0m
[30;1m142 | [0m[35m                         self.wal_e.env_dir)[0m
[30;1m143 | [0m[35m            return ExitCode.FAIL[0m
[30;1m144 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1674[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/psycopg.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m    :returns: a connection to the database. Can be either a :class:`psycopg.Connection` if using :mo[0m
[30;1m130 | [0m[35m        :class:`psycopg2.extensions.connection` if using :mod:`psycopg2`.[0m
[30;1m131 | [0m[35m    """[0m
[30;1m132 | [0m[35m    if kwargs and 'replication' not in kwargs and kwargs.get('fallback_application_name') != 'Patron[0m
[30;1m133 | [0m[35m        options = [kwargs['options']] if 'options' in kwargs else [][0m
[30;1m134 | [0m[35m        options.append('-c search_path=pg_catalog')[0m
[30;1m135 | [0m[35m        kwargs['options'] = ' '.join(options)[0m

[31m--[ [0m[34mMatch #[0m[33m1675[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_watchdog.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    elif op == linuxwd.WDIOC_GETTIMEOUT:[0m
[30;1m44 | [0m[35m        arg.value = dev.timeout[0m
[30;1m45 | [0m[35m    elif op == linuxwd.WDIOC_SETTIMEOUT:[0m
[30;1m46 | [0m[35m        sys.stderr.write("Set timeout called with %s\n" % arg.value)[0m
[30;1m47 | [0m[35m        assert 0 < arg.value < 65535[0m
[30;1m48 | [0m[35m        dev.timeout = arg.value - 1[0m
[30;1m49 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m1676[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/raft_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m    def __init__(self, config: Config) -> None:[0m
[30;1m13 | [0m[35m        super(RaftController, self).__init__(config)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m        kvstore_config = self.config.get('raft')[0m
[30;1m16 | [0m[35m        assert 'self_addr' in kvstore_config[0m
[30;1m17 | [0m[35m        self._raft = KVStoreTTL(None, None, None, **kvstore_config)[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1677[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1192 | [0m[35m    def _before_stop(self) -> None:[0m
[30;1m1193 | [0m[35m        """Synchronously run a script prior to stopping postgres."""[0m
[30;1m1194 | [0m[35m[0m
[30;1m1195 | [0m[35m        cmd = self.config.get('before_stop')[0m
[30;1m1196 | [0m[35m        if cmd:[0m
[30;1m1197 | [0m[35m            self._do_before_stop(cmd)[0m
[30;1m1198 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1678[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1180 | [0m[35m        If the script exits with a non-zero code, promotion does not happen and the leader key is re[0m
[30;1m1181 | [0m[35m        """[0m
[30;1m1182 | [0m[35m[0m
[30;1m1183 | [0m[35m        cmd = self.config.get('pre_promote')[0m
[30;1m1184 | [0m[35m        if not cmd:[0m
[30;1m1185 | [0m[35m            return True[0m
[30;1m1186 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1679[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1170 | [0m[35m    def _wait_promote(self, wait_seconds: int) -> Optional[bool]:[0m
[30;1m1171 | [0m[35m        for _ in polling_loop(wait_seconds):[0m
[30;1m1172 | [0m[35m            data = self.controldata()[0m
[30;1m1173 | [0m[35m            if data.get('Database cluster state') == 'in production':[0m
[30;1m1174 | [0m[35m                self.set_role('primary')[0m
[30;1m1175 | [0m[35m                return True[0m
[30;1m1176 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1680[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m907 | [0m[35m                    if checkpoint_locations:[0m
[30;1m908 | [0m[35m                        on_shutdown(*checkpoint_locations)[0m
[30;1m909 | [0m[35m                    break[0m
[30;1m910 | [0m[35m                elif data.get('Database cluster state', '').startswith('shut down'):  # shut down in[0m
[30;1m911 | [0m[35m                    break[0m
[30;1m912 | [0m[35m                elif stop_timeout and i >= stop_timeout:[0m
[30;1m913 | [0m[35m                    stop_timeout = 0[0m

[31m--[ [0m[34mMatch #[0m[33m1681[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m902 | [0m[35m            # Wait for pg_controldata `Database cluster state:` to change to "shut down"[0m
[30;1m903 | [0m[35m            while postmaster.is_running():[0m
[30;1m904 | [0m[35m                data = self.controldata()[0m
[30;1m905 | [0m[35m                if data.get('Database cluster state', '') == 'shut down':[0m
[30;1m906 | [0m[35m                    checkpoint_locations = self._checkpoint_locations_from_controldata(data)[0m
[30;1m907 | [0m[35m                    if checkpoint_locations:[0m
[30;1m908 | [0m[35m                        on_shutdown(*checkpoint_locations)[0m

[31m--[ [0m[34mMatch #[0m[33m1682[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m793 | [0m[35m        start_timeout = timeout[0m
[30;1m794 | [0m[35m        if not start_timeout:[0m
[30;1m795 | [0m[35m            try:[0m
[30;1m796 | [0m[35m                start_timeout = float(self.config.get('pg_ctl_timeout', 60) or 0)[0m
[30;1m797 | [0m[35m            except ValueError:[0m
[30;1m798 | [0m[35m                start_timeout = 60[0m
[30;1m799 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1683[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m617 | [0m[35m        timeline = data.get("Latest checkpoint's TimeLineID")[0m
[30;1m618 | [0m[35m        lsn = checkpoint_lsn = data.get('Latest checkpoint location')[0m
[30;1m619 | [0m[35m        prev_lsn = None[0m
[30;1m620 | [0m[35m        if data.get('Database cluster state') == 'shut down' and lsn and timeline and checkpoint_lsn[0m
[30;1m621 | [0m[35m            try:[0m
[30;1m622 | [0m[35m                checkpoint_lsn = parse_lsn(checkpoint_lsn)[0m
[30;1m623 | [0m[35m                rm_name, lsn, prev, desc = self.parse_wal_record(timeline, lsn)[0m

[31m--[ [0m[34mMatch #[0m[33m1684[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m615 | [0m[35m                  if we know that the checkpoint was written to the new WAL file due to the archive_[0m
[30;1m616 | [0m[35m        """[0m
[30;1m617 | [0m[35m        timeline = data.get("Latest checkpoint's TimeLineID")[0m
[30;1m618 | [0m[35m        lsn = checkpoint_lsn = data.get('Latest checkpoint location')[0m
[30;1m619 | [0m[35m        prev_lsn = None[0m
[30;1m620 | [0m[35m        if data.get('Database cluster state') == 'shut down' and lsn and timeline and checkpoint_lsn[0m
[30;1m621 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m1685[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m614 | [0m[35m        :returns: a tuple of checkpoint LSN for the cleanly shut down primary, and LSN of prev wal r[0m
[30;1m615 | [0m[35m                  if we know that the checkpoint was written to the new WAL file due to the archive_[0m
[30;1m616 | [0m[35m        """[0m
[30;1m617 | [0m[35m        timeline = data.get("Latest checkpoint's TimeLineID")[0m
[30;1m618 | [0m[35m        lsn = checkpoint_lsn = data.get('Latest checkpoint location')[0m
[30;1m619 | [0m[35m        prev_lsn = None[0m
[30;1m620 | [0m[35m        if data.get('Database cluster state') == 'shut down' and lsn and timeline and checkpoint_lsn[0m

[31m--[ [0m[34mMatch #[0m[33m1686[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m591 | [0m[35m    def pg_control_timeline(self) -> Optional[int]:[0m
[30;1m592 | [0m[35m        try:[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m            return int(self.controldata().get("Latest checkpoint's TimeLineID", ""))[0m
[30;1m595 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m596 | [0m[35m            logger.exception('Failed to parse timeline from pg_controldata output')[0m
[30;1m597 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1687[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m491 | [0m[35m        if 'error' in self._cluster_info_state:[0m
[30;1m492 | [0m[35m            raise PostgresConnectionException(self._cluster_info_state['error'])[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m        return self._cluster_info_state.get(name)[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m    def replayed_location(self) -> Optional[int]:[0m
[30;1m497 | [0m[35m        return self._cluster_info_state_get('replayed_location')[0m

[31m--[ [0m[34mMatch #[0m[33m1688[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m        return deepcopy(self.config.get(method, {}) or EMPTY_DICT.copy())[0m
[30;1m424 | [0m[35m[0m
[30;1m425 | [0m[35m    def replica_method_can_work_without_replication_connection(self, method: str) -> bool:[0m
[30;1m426 | [0m[35m        return method != 'basebackup' and bool(self.replica_method_options(method).get('no_leader'))[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m    def can_create_replica_without_replication_connection(self, replica_methods: Optional[List[str]][0m
[30;1m429 | [0m[35m        """ go through the replication methods to see if there are ones[0m

[31m--[ [0m[34mMatch #[0m[33m1689[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m        return data_directory_is_empty(self._data_dir)[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m    def replica_method_options(self, method: str) -> Dict[str, Any]:[0m
[30;1m423 | [0m[35m        return deepcopy(self.config.get(method, {}) or EMPTY_DICT.copy())[0m
[30;1m424 | [0m[35m[0m
[30;1m425 | [0m[35m    def replica_method_can_work_without_replication_connection(self, method: str) -> bool:[0m
[30;1m426 | [0m[35m        return method != 'basebackup' and bool(self.replica_method_options(method).get('no_leader'))[0m

[31m--[ [0m[34mMatch #[0m[33m1690[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m        return self._connection.server_version[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m    def connection(self) -> Union['connection3', 'Connection3[Any]']:[0m
[30;1m367 | [0m[35m        return self._connection.get()[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m    def _query(self, sql: str, *params: Any) -> List[Tuple[Any, ...]]:[0m
[30;1m370 | [0m[35m        """Execute *sql* query with *params* and optionally return results.[0m

[31m--[ [0m[34mMatch #[0m[33m1691[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m    def sysid(self) -> str:[0m
[30;1m349 | [0m[35m        if not self._sysid and not self.bootstrapping:[0m
[30;1m350 | [0m[35m            data = self.controldata()[0m
[30;1m351 | [0m[35m            self._sysid = data.get('Database system identifier', '')[0m
[30;1m352 | [0m[35m        return self._sysid[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    def get_postgres_role_from_data_directory(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1692[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m                        1: STATE_REJECT,[0m
[30;1m321 | [0m[35m                        2: STATE_NO_RESPONSE,[0m
[30;1m322 | [0m[35m                        3: STATE_UNKNOWN}[0m
[30;1m323 | [0m[35m        return return_codes.get(ret, STATE_UNKNOWN)[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    def reload_config(self, config: Dict[str, Any], sighup: bool = False) -> None:[0m
[30;1m326 | [0m[35m        self.config.reload_config(config, sighup)[0m

[31m--[ [0m[34mMatch #[0m[33m1693[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m        :returns: path to Postgres binary named *cmd*.[0m
[30;1m280 | [0m[35m        """[0m
[30;1m281 | [0m[35m        return os.path.join(self._bin_dir, (self.config.get('bin_name', {}) or EMPTY_DICT).get(cmd, [0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    def pg_ctl(self, cmd: str, *args: str, **kwargs: Any) -> bool:[0m
[30;1m284 | [0m[35m        """Builds and executes pg_ctl command[0m

[31m--[ [0m[34mMatch #[0m[33m1694[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m        :returns: path to Postgres binary named *cmd*.[0m
[30;1m280 | [0m[35m        """[0m
[30;1m281 | [0m[35m        return os.path.join(self._bin_dir, (self.config.get('bin_name', {}) or EMPTY_DICT).get(cmd, [0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    def pg_ctl(self, cmd: str, *args: str, **kwargs: Any) -> bool:[0m
[30;1m284 | [0m[35m        """Builds and executes pg_ctl command[0m

[31m--[ [0m[34mMatch #[0m[33m1695[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    @property[0m
[30;1m165 | [0m[35m    def callback(self) -> Dict[str, str]:[0m
[30;1m166 | [0m[35m        return self.config.get('callbacks', {}) or {}[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    @property[0m
[30;1m169 | [0m[35m    def wal_dir(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1696[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    @property[0m
[30;1m149 | [0m[35m    def create_replica_methods(self) -> List[str]:[0m
[30;1m150 | [0m[35m        return self.config.get('create_replica_methods', []) or self.config.get('create_replica_meth[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    @property[0m
[30;1m153 | [0m[35m    def major_version(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m1697[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    @property[0m
[30;1m149 | [0m[35m    def create_replica_methods(self) -> List[str]:[0m
[30;1m150 | [0m[35m        return self.config.get('create_replica_methods', []) or self.config.get('create_replica_meth[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    @property[0m
[30;1m153 | [0m[35m    def major_version(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m1698[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        self.connection_pool = ConnectionPool()[0m
[30;1m83 | [0m[35m        self._connection = self.connection_pool.get('heartbeat')[0m
[30;1m84 | [0m[35m        self.mpp_handler = mpp.get_handler_impl(self)[0m
[30;1m85 | [0m[35m        self._bin_dir = config.get('bin_dir') or ''[0m
[30;1m86 | [0m[35m        self.config = ConfigHandler(self, config)[0m
[30;1m87 | [0m[35m        self.config.check_directories()[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1699[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        self._pending_restart_reason = CaseInsensitiveDict()[0m
[30;1m82 | [0m[35m        self.connection_pool = ConnectionPool()[0m
[30;1m83 | [0m[35m        self._connection = self.connection_pool.get('heartbeat')[0m
[30;1m84 | [0m[35m        self.mpp_handler = mpp.get_handler_impl(self)[0m
[30;1m85 | [0m[35m        self._bin_dir = config.get('bin_dir') or ''[0m
[30;1m86 | [0m[35m        self.config = ConfigHandler(self, config)[0m

[31m--[ [0m[34mMatch #[0m[33m1700[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        self.name: str = config['name'][0m
[30;1m69 | [0m[35m        self.scope: str = config['scope'][0m
[30;1m70 | [0m[35m        self._data_dir: str = config['data_dir'][0m
[30;1m71 | [0m[35m        self._database = config.get('database', 'postgres')[0m
[30;1m72 | [0m[35m        self._version_file = os.path.join(self._data_dir, 'PG_VERSION')[0m
[30;1m73 | [0m[35m        self._pg_control = os.path.join(self._data_dir, 'global', 'pg_control')[0m
[30;1m74 | [0m[35m        self.connection_string: str[0m

[31m--[ [0m[34mMatch #[0m[33m1701[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1381 | [0m[35m[0m
[30;1m1382 | [0m[35m        :returns: all available GUCs in the local Postgres server.[0m
[30;1m1383 | [0m[35m        """[0m
[30;1m1384 | [0m[35m        cmd = [self.pgcommand('postgres'), '--describe-config'][0m
[30;1m1385 | [0m[35m        return CaseInsensitiveSet({[0m
[30;1m1386 | [0m[35m            line.split('\t')[0] for line in subprocess.check_output(cmd).decode('utf-8').strip().spl[0m
[30;1m1387 | [0m[35m        })[0m

[31m--[ [0m[34mMatch #[0m[33m1702[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1192 | [0m[35m    def _before_stop(self) -> None:[0m
[30;1m1193 | [0m[35m        """Synchronously run a script prior to stopping postgres."""[0m
[30;1m1194 | [0m[35m[0m
[30;1m1195 | [0m[35m        cmd = self.config.get('before_stop')[0m
[30;1m1196 | [0m[35m        if cmd:[0m
[30;1m1197 | [0m[35m            self._do_before_stop(cmd)[0m
[30;1m1198 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1703[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1180 | [0m[35m        If the script exits with a non-zero code, promotion does not happen and the leader key is re[0m
[30;1m1181 | [0m[35m        """[0m
[30;1m1182 | [0m[35m[0m
[30;1m1183 | [0m[35m        cmd = self.config.get('pre_promote')[0m
[30;1m1184 | [0m[35m        if not cmd:[0m
[30;1m1185 | [0m[35m            return True[0m
[30;1m1186 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1704[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1064 | [0m[35m        return {}[0m
[30;1m1065 | [0m[35m[0m
[30;1m1066 | [0m[35m    def waldump(self, timeline: Union[int, str], lsn: str, limit: int) -> Tuple[Optional[bytes], Opt[0m
[30;1m1067 | [0m[35m        cmd = self.pgcommand('pg_{0}dump'.format(self.wal_name))[0m
[30;1m1068 | [0m[35m        env = {**os.environ, 'LANG': 'C', 'LC_ALL': 'C', 'PGDATA': self._data_dir}[0m
[30;1m1069 | [0m[35m        try:[0m
[30;1m1070 | [0m[35m            waldump = subprocess.Popen([cmd, '-t', str(timeline), '-s', lsn, '-n', str(limit)],[0m

[31m--[ [0m[34mMatch #[0m[33m1705[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1039 | [0m[35m        return True[0m
[30;1m1040 | [0m[35m[0m
[30;1m1041 | [0m[35m    def get_guc_value(self, name: str) -> Optional[str]:[0m
[30;1m1042 | [0m[35m        cmd = [self.pgcommand('postgres'), '-D', self._data_dir, '-C', name,[0m
[30;1m1043 | [0m[35m               '--config-file={}'.format(self.config.postgresql_conf)][0m
[30;1m1044 | [0m[35m        try:[0m
[30;1m1045 | [0m[35m            data = subprocess.check_output(cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1706[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m679 | [0m[35m            cmd = self.callback[cb_type][0m
[30;1m680 | [0m[35m            role = 'primary' if self.role == 'promoted' else self.role[0m
[30;1m681 | [0m[35m            try:[0m
[30;1m682 | [0m[35m                cmd = shlex.split(self.callback[cb_type]) + [cb_type, role, self.scope][0m
[30;1m683 | [0m[35m                self._callback_executor.call(cmd)[0m
[30;1m684 | [0m[35m            except Exception:[0m
[30;1m685 | [0m[35m                logger.exception('callback %s %r %s %s failed', cmd, cb_type, role, self.scope)[0m

[31m--[ [0m[34mMatch #[0m[33m1707[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m676 | [0m[35m            self.__cb_called = True[0m
[30;1m677 | [0m[35m[0m
[30;1m678 | [0m[35m        if self.callback and cb_type in self.callback:[0m
[30;1m679 | [0m[35m            cmd = self.callback[cb_type][0m
[30;1m680 | [0m[35m            role = 'primary' if self.role == 'promoted' else self.role[0m
[30;1m681 | [0m[35m            try:[0m
[30;1m682 | [0m[35m                cmd = shlex.split(self.callback[cb_type]) + [cb_type, role, self.scope][0m

[31m--[ [0m[34mMatch #[0m[33m1708[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m438 | [0m[35m        return self._enforce_hot_standby_feedback[0m
[30;1m439 | [0m[35m[0m
[30;1m440 | [0m[35m    def set_enforce_hot_standby_feedback(self, value: bool) -> None:[0m
[30;1m441 | [0m[35m        # If we enable or disable the hot_standby_feedback we need to update postgresql.conf and rel[0m
[30;1m442 | [0m[35m        if self._enforce_hot_standby_feedback != value:[0m
[30;1m443 | [0m[35m            self._enforce_hot_standby_feedback = value[0m
[30;1m444 | [0m[35m            if self.is_running():[0m

[31m--[ [0m[34mMatch #[0m[33m1709[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m337 | [0m[35m        return self._pending_restart_reason[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m    def set_pending_restart_reason(self, diff_dict: CaseInsensitiveDict) -> None:[0m
[30;1m340 | [0m[35m        """Set new or update current :attr:`_pending_restart_reason`.[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        :param diff_dict: :class:``CaseInsensitiveDict`` object with the parameters that are causing[0m
[30;1m343 | [0m[35m            state with the diff of their values. Used to reset/update the :attr:`_pending_restart_re[0m

[31m--[ [0m[34mMatch #[0m[33m1710[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m305 | [0m[35m        :returns: 'ok' if PostgreSQL is up, 'reject' if starting up, 'no_response' if not up."""[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        r = self.connection_pool.conn_kwargs[0m
[30;1m308 | [0m[35m        cmd = [self.pgcommand('pg_isready'), '-p', r['port'], '-d', self._database][0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m        # Host is not set if we are connecting via default unix socket[0m
[30;1m311 | [0m[35m        if 'host' in r:[0m

[31m--[ [0m[34mMatch #[0m[33m1711[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1200 | [0m[35m        try:[0m
[30;1m1201 | [0m[35m            ret = self.cancellable.call(shlex.split(cmd))[0m
[30;1m1202 | [0m[35m            if ret is not None:[0m
[30;1m1203 | [0m[35m                logger.info('before_stop script `%s` exited with %s', cmd, ret)[0m
[30;1m1204 | [0m[35m        except Exception as e:[0m
[30;1m1205 | [0m[35m            logger.error('Exception when calling `%s`: %r', cmd, e)[0m
[30;1m1206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1712[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1190 | [0m[35m        return ret == 0[0m
[30;1m1191 | [0m[35m[0m
[30;1m1192 | [0m[35m    def _before_stop(self) -> None:[0m
[30;1m1193 | [0m[35m        """Synchronously run a script prior to stopping postgres."""[0m
[30;1m1194 | [0m[35m[0m
[30;1m1195 | [0m[35m        cmd = self.config.get('before_stop')[0m
[30;1m1196 | [0m[35m        if cmd:[0m

[31m--[ [0m[34mMatch #[0m[33m1713[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1186 | [0m[35m[0m
[30;1m1187 | [0m[35m        ret = self.cancellable.call(shlex.split(cmd))[0m
[30;1m1188 | [0m[35m        if ret is not None:[0m
[30;1m1189 | [0m[35m            logger.info('pre_promote script `%s` exited with %s', cmd, ret)[0m
[30;1m1190 | [0m[35m        return ret == 0[0m
[30;1m1191 | [0m[35m[0m
[30;1m1192 | [0m[35m    def _before_stop(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1714[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1177 | [0m[35m    def _pre_promote(self) -> bool:[0m
[30;1m1178 | [0m[35m        """[0m
[30;1m1179 | [0m[35m        Runs a fencing script after the leader lock is acquired but before the replica is promoted.[0m
[30;1m1180 | [0m[35m        If the script exits with a non-zero code, promotion does not happen and the leader key is re[0m
[30;1m1181 | [0m[35m        """[0m
[30;1m1182 | [0m[35m[0m
[30;1m1183 | [0m[35m        cmd = self.config.get('pre_promote')[0m

[31m--[ [0m[34mMatch #[0m[33m1715[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1176 | [0m[35m[0m
[30;1m1177 | [0m[35m    def _pre_promote(self) -> bool:[0m
[30;1m1178 | [0m[35m        """[0m
[30;1m1179 | [0m[35m        Runs a fencing script after the leader lock is acquired but before the replica is promoted.[0m
[30;1m1180 | [0m[35m        If the script exits with a non-zero code, promotion does not happen and the leader key is re[0m
[30;1m1181 | [0m[35m        """[0m
[30;1m1182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1716[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1065 | [0m[35m[0m
[30;1m1066 | [0m[35m    def waldump(self, timeline: Union[int, str], lsn: str, limit: int) -> Tuple[Optional[bytes], Opt[0m
[30;1m1067 | [0m[35m        cmd = self.pgcommand('pg_{0}dump'.format(self.wal_name))[0m
[30;1m1068 | [0m[35m        env = {**os.environ, 'LANG': 'C', 'LC_ALL': 'C', 'PGDATA': self._data_dir}[0m
[30;1m1069 | [0m[35m        try:[0m
[30;1m1070 | [0m[35m            waldump = subprocess.Popen([cmd, '-t', str(timeline), '-s', lsn, '-n', str(limit)],[0m
[30;1m1071 | [0m[35m                                       stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)[0m

[31m--[ [0m[34mMatch #[0m[33m1717[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1053 | [0m[35m        # Don't try to call pg_controldata during backup restore[0m
[30;1m1054 | [0m[35m        if self._version_file_exists() and self.state != 'creating replica':[0m
[30;1m1055 | [0m[35m            try:[0m
[30;1m1056 | [0m[35m                env = {**os.environ, 'LANG': 'C', 'LC_ALL': 'C'}[0m
[30;1m1057 | [0m[35m                data = subprocess.check_output([self.pgcommand('pg_controldata'), self._data_dir], e[0m
[30;1m1058 | [0m[35m                if data:[0m
[30;1m1059 | [0m[35m                    data = filter(lambda e: ':' in e, data.decode('utf-8').splitlines())[0m

[31m--[ [0m[34mMatch #[0m[33m1718[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1021 | [0m[35m        When timeout parameter is set the call will block either until PostgreSQL has started, faile[0m
[30;1m1022 | [0m[35m        timeout arrives.[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m        :returns: True when restart was successful and timeout did not expire when waiting.[0m
[30;1m1025 | [0m[35m        """[0m
[30;1m1026 | [0m[35m        self.set_state('restarting')[0m
[30;1m1027 | [0m[35m        if not block_callbacks:[0m

[31m--[ [0m[34mMatch #[0m[33m1719[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1019 | [0m[35m        """Restarts PostgreSQL.[0m
[30;1m1020 | [0m[35m[0m
[30;1m1021 | [0m[35m        When timeout parameter is set the call will block either until PostgreSQL has started, faile[0m
[30;1m1022 | [0m[35m        timeout arrives.[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m        :returns: True when restart was successful and timeout did not expire when waiting.[0m
[30;1m1025 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1720[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1018 | [0m[35m                after_start: Optional[Callable[..., Any]] = None) -> Optional[bool]:[0m
[30;1m1019 | [0m[35m        """Restarts PostgreSQL.[0m
[30;1m1020 | [0m[35m[0m
[30;1m1021 | [0m[35m        When timeout parameter is set the call will block either until PostgreSQL has started, faile[0m
[30;1m1022 | [0m[35m        timeout arrives.[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m        :returns: True when restart was successful and timeout did not expire when waiting.[0m

[31m--[ [0m[34mMatch #[0m[33m1721[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1006 | [0m[35m            logger.warning("wait_for_startup() called when not in starting state")[0m
[30;1m1007 | [0m[35m[0m
[30;1m1008 | [0m[35m        while not self.check_startup_state_changed():[0m
[30;1m1009 | [0m[35m            if self.cancellable.is_cancelled or timeout and self.time_in_state() > timeout:[0m
[30;1m1010 | [0m[35m                return None[0m
[30;1m1011 | [0m[35m            time.sleep(1)[0m
[30;1m1012 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1722[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m946 | [0m[35m[0m
[30;1m947 | [0m[35m    def _wait_for_connection_close(self, postmaster: PostmasterProcess) -> None:[0m
[30;1m948 | [0m[35m        try:[0m
[30;1m949 | [0m[35m            while postmaster.is_running():  # Need a timeout here?[0m
[30;1m950 | [0m[35m                self._connection.query("SELECT 1")[0m
[30;1m951 | [0m[35m                time.sleep(STOP_POLLING_INTERVAL)[0m
[30;1m952 | [0m[35m        except (psycopg.Error, PostgresConnectionException):[0m

[31m--[ [0m[34mMatch #[0m[33m1723[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m877 | [0m[35m        if not block_callbacks:[0m
[30;1m878 | [0m[35m            self.set_state('stopping')[0m
[30;1m879 | [0m[35m[0m
[30;1m880 | [0m[35m        # invoke user-directed before stop script[0m
[30;1m881 | [0m[35m        self._before_stop()[0m
[30;1m882 | [0m[35m[0m
[30;1m883 | [0m[35m        if before_shutdown:[0m
[30;1m884 | [0m[35m            before_shutdown()[0m

[31m--[ [0m[34mMatch #[0m[33m1724[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m818 | [0m[35m        for p in ['connect_timeout', 'options']:[0m
[30;1m819 | [0m[35m            connect_kwargs.pop(p, None)[0m
[30;1m820 | [0m[35m        if timeout:[0m
[30;1m821 | [0m[35m            connect_kwargs['connect_timeout'] = timeout[0m
[30;1m822 | [0m[35m        try:[0m
[30;1m823 | [0m[35m            with get_connection_cursor(**connect_kwargs) as cur:[0m
[30;1m824 | [0m[35m                cur.execute("SET statement_timeout = 0")[0m
[30;1m825 | [0m[35m                if check_not_is_in_recovery:[0m

[31m--[ [0m[34mMatch #[0m[33m1725[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m806 | [0m[35m            if ret and after_start:[0m
[30;1m807 | [0m[35m                after_start()[0m
[30;1m808 | [0m[35m            return ret[0m
[30;1m809 | [0m[35m        elif timeout is not None:[0m
[30;1m810 | [0m[35m            return False[0m
[30;1m811 | [0m[35m        else:[0m
[30;1m812 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m1726[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m790 | [0m[35m            if task:[0m
[30;1m791 | [0m[35m                task.complete(self._postmaster_proc)[0m
[30;1m792 | [0m[35m[0m
[30;1m793 | [0m[35m        start_timeout = timeout[0m
[30;1m794 | [0m[35m        if not start_timeout:[0m
[30;1m795 | [0m[35m            try:[0m
[30;1m796 | [0m[35m                start_timeout = float(self.config.get('pg_ctl_timeout', 60) or 0)[0m
[30;1m797 | [0m[35m            except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m1727[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m340 | [0m[35m        """Set new or update current :attr:`_pending_restart_reason`.[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        :param diff_dict: :class:``CaseInsensitiveDict`` object with the parameters that are causing[0m
[30;1m343 | [0m[35m            state with the diff of their values. Used to reset/update the :attr:`_pending_restart_re[0m
[30;1m344 | [0m[35m        """[0m
[30;1m345 | [0m[35m        self._pending_restart_reason = diff_dict[0m
[30;1m346 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1728[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m330 | [0m[35m    def pending_restart_reason(self) -> CaseInsensitiveDict:[0m
[30;1m331 | [0m[35m        """Get :attr:`_pending_restart_reason` value.[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m        :attr:`_pending_restart_reason` is a :class:`CaseInsensitiveDict` object of the PG parameter[0m
[30;1m334 | [0m[35m        causing pending restart state. Every key is a parameter name, value - a dictionary containin[0m
[30;1m335 | [0m[35m        and the new value (see :func:`~patroni.postgresql.config.get_param_diff`).[0m
[30;1m336 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1729[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m(), pg_last_wal_replay_lsn(), and  pg_is_wal_replay_paused()[0m
[30;1m209 | [0m[35m        4. for v9.6+ we query primary_slot_name and primary_conninfo from pg_stat_get_wal_receiver()[0m
[30;1m210 | [0m[35m        5. for v11+ with permanent logical slots we query from pg_replication_slots and aggregate th[0m
[30;1m211 | [0m[35m        6. for standby_leader node running v9.6+ we also query pg_control_checkpoint to fetch timeli[0m
[30;1m212 | [0m[35m        7. if sync replication is enabled we query pg_stat_replication and aggregate the result.[0m
[30;1m213 | [0m[35m           In addition to that we get current values of synchronous_commit and synchronous_standby_n[0m
[30;1m214 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1730[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport shlex[0m
[30;1m5 | [0m[35mimport shutil[0m
[30;1m6 | [0m[35mimport subprocess[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m10 | [0m[35mfrom copy import deepcopy[0m
[30;1m11 | [0m[35mfrom datetime import datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1731[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m          in *validators* for the corresponding Postgres *version*; or[0m
[30;1m434 | [0m[35m        * ``None`` if *name* does not have a validator in *validators* and is not present in *availa[0m
[30;1m435 | [0m[35m    """[0m
[30;1m436 | [0m[35m    for validator in validators.get(name, ()) or ():[0m
[30;1m437 | [0m[35m        if version >= validator.version_from and\[0m
[30;1m438 | [0m[35m                (validator.version_till is None or version < validator.version_till):[0m
[30;1m439 | [0m[35m            return validator.transform(name, value)[0m

[31m--[ [0m[34mMatch #[0m[33m1732[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m403 | [0m[35m        for section in ['parameters', 'recovery_parameters']:[0m
[30;1m404 | [0m[35m            section_var = mapping[section][0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m            config_section = config.get(section, {})[0m
[30;1m407 | [0m[35m            for parameter in config_section.keys():[0m
[30;1m408 | [0m[35m                section_var[parameter] = _get_postgres_guc_validators(config_section, parameter)[0m
[30;1m409 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1733[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m    :rtype: yields any exception that is faced while parsing a validator spec into a Patroni validat[0m
[30;1m246 | [0m[35m    """[0m
[30;1m247 | [0m[35m    validators: List[_Transformable] = [][0m
[30;1m248 | [0m[35m    for validator_spec in config.get(parameter, []):[0m
[30;1m249 | [0m[35m        try:[0m
[30;1m250 | [0m[35m            validator = ValidatorFactory(validator_spec)[0m
[30;1m251 | [0m[35m            validators.append(validator)[0m

[31m--[ [0m[34mMatch #[0m[33m1734[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m488 | [0m[35m    # Recovery settings are not present in ``postgres --describe-config`` output of Postgres <= 11. [0m
[30;1m489 | [0m[35m    # just pass down the list of settings defined in Patroni validators so :func:`_transform_paramet[0m
[30;1m490 | [0m[35m    # discard the recovery GUCs when running Postgres <= 11.[0m
[30;1m491 | [0m[35m    # NOTE: At the moment this change was done Postgres 11 was almost EOL, and had been likely exten[0m
[30;1m492 | [0m[35m    # Patroni, so we should be able to rely solely on Patroni validators as the source of truth.[0m
[30;1m493 | [0m[35m    return _transform_parameter_value([0m
[30;1m494 | [0m[35m        recovery_parameters, version, name, value,[0m

[31m--[ [0m[34mMatch #[0m[33m1735[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m148 | [0m[35m object in the tuple represents a different[0m
[30;1m149 | [0m[35m#          validation of the GUC across postgres versions. If a GUC validation has never changed ove[0m
[30;1m150 | [0m[35m#          have a single object in the tuple. For example, `password_encryption` used to be a boolea[0m
[30;1m151 | [0m[35m#          10, at which point it started being an enum. In that case the value of `password_encrypti[0m
[30;1m152 | [0m[35m#          of 2 `_Transformable` objects (`Bool` and `Enum`, respectively), each one reprensenting a[0m
[30;1m153 | [0m[35m#          validation rule.[0m
[30;1m154 | [0m[35mparameters = CaseInsensitiveDict()[0m

[31m--[ [0m[34mMatch #[0m[33m1736[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m    Each YAML file may contain either or both of these root attributes, here called sections:[0m
[30;1m299 | [0m[35m        * ``parameters``: general GUCs that would be written to ``postgresql.conf``;[0m
[30;1m300 | [0m[35m        * ``recovery_parameters``: recovery related GUCs that would be written to ``recovery.conf`` [0m
[30;1m301 | [0m[35m            writes them to ``postgresql.conf`` if running PG 12 and above).[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m    Then, each of these sections, if specified, may contain one or more attributes with the followin[0m
[30;1m304 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1737[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m285 | [0m[35m    ``parameters`` and/or ``recovery_parameters`` variables.[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    Walk through directories in top-down fashion and for each of them:[0m
[30;1m288 | [0m[35m        * Sort files by name;[0m
[30;1m289 | [0m[35m        * Load validators from YAML files that were found.[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    Any problem faced while reading or parsing files will be logged as a ``WARNING`` by the child fu[0m

[31m--[ [0m[34mMatch #[0m[33m1738[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        config["users"][0]["user"]["token"] = "token"[0m
[30;1m144 | [0m[35m        with patch('builtins.open', mock_open(read_data=json.dumps(config))):[0m
[30;1m145 | [0m[35m            k8s_config.load_kube_config()[0m
[30;1m146 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer token')[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        config["users"][0]["user"]["client-key-data"] = base64.b64encode(b'foobar').decode('utf-8')[0m
[30;1m149 | [0m[35m        config["clusters"][0]["cluster"]["certificate-authority-data"] = base64.b64encode(b'foobar')[0m

[31m--[ [0m[34mMatch #[0m[33m1739[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m            # token refreshed[0m
[30;1m128 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer c')[0m
[30;1m129 | [0m[35m            # no need to refresh token[0m
[30;1m130 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer c')[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    def test_load_kube_config(self):[0m
[30;1m133 | [0m[35m        config = {[0m

[31m--[ [0m[34mMatch #[0m[33m1740[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer b')[0m
[30;1m124 | [0m[35m            time.sleep(0.1)[0m
[30;1m125 | [0m[35m            # token refreshed[0m
[30;1m126 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer c')[0m
[30;1m127 | [0m[35m            # no need to refresh token[0m
[30;1m128 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer c')[0m
[30;1m129 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1741[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m            # token file is empty[0m
[30;1m121 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m
[30;1m122 | [0m[35m            # token refreshed[0m
[30;1m123 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer b')[0m
[30;1m124 | [0m[35m            time.sleep(0.1)[0m
[30;1m125 | [0m[35m            # token refreshed[0m
[30;1m126 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer c')[0m

[31m--[ [0m[34mMatch #[0m[33m1742[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m            # token file doesn't exist[0m
[30;1m121 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m
[30;1m122 | [0m[35m            # token file is empty[0m
[30;1m123 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m
[30;1m124 | [0m[35m            # token refreshed[0m
[30;1m125 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer b')[0m
[30;1m126 | [0m[35m            time.sleep(0.1)[0m

[31m--[ [0m[34mMatch #[0m[33m1743[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m
[30;1m120 | [0m[35m            time.sleep(0.1)[0m
[30;1m121 | [0m[35m            # token file doesn't exist[0m
[30;1m122 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m
[30;1m123 | [0m[35m            # token file is empty[0m
[30;1m124 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m
[30;1m125 | [0m[35m            # token refreshed[0m

[31m--[ [0m[34mMatch #[0m[33m1744[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m                    mock_open(read_data='cert')(), mock_open(read_data='a')(),[0m
[30;1m114 | [0m[35m                    mock_open()(), mock_open(read_data='b')(), mock_open(read_data='c')()])):[0m
[30;1m115 | [0m[35m            k8s_config.load_incluster_config(token_refresh_interval=datetime.timedelta(milliseconds=[0m
[30;1m116 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m
[30;1m117 | [0m[35m            time.sleep(0.1)[0m
[30;1m118 | [0m[35m            # token file doesn't exist[0m
[30;1m119 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m

[31m--[ [0m[34mMatch #[0m[33m1745[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m                self.assertRaises(k8s_config.ConfigException, k8s_config.load_incluster_config)[0m
[30;1m105 | [0m[35m            k8s_config.load_incluster_config()[0m
[30;1m106 | [0m[35m            self.assertEqual(k8s_config.server, 'https://a:1')[0m
[30;1m107 | [0m[35m            self.assertEqual(k8s_config.headers.get('authorization'), 'Bearer a')[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    def test_refresh_token(self):[0m
[30;1m110 | [0m[35m        with patch('os.environ', {SERVICE_HOST_ENV_NAME: 'a', SERVICE_PORT_ENV_NAME: '1'}), \[0m

[31m--[ [0m[34mMatch #[0m[33m1746[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m.hostname[0m
[30;1m73 | [0m[35m                                       name='p-0', annotations={'status': '{}'},[0m
[30;1m74 | [0m[35m                                       uid='964dfeae-e79b-4476-8a5a-1920b5c2a69d')[0m
[30;1m75 | [0m[35m    status = k8s_client.V1PodStatus(pod_ip='10.0.0.1')[0m
[30;1m76 | [0m[35m    spec = k8s_client.V1PodSpec(hostname='p-0', node_name='kind-control-plane', containers=[])[0m
[30;1m77 | [0m[35m    items = [k8s_client.V1Pod(metadata=metadata, status=status, spec=spec)][0m
[30;1m78 | [0m[35m    return k8s_client.V1PodList(items=items, kind='PodList')[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1747[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35mclass TestK8sConfig(unittest.TestCase):[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    def test_load_incluster_config(self):[0m
[30;1m94 | [0m[35m        for env in ({}, {SERVICE_HOST_ENV_NAME: '', SERVICE_PORT_ENV_NAME: ''}):[0m
[30;1m95 | [0m[35m            with patch('os.environ', env):[0m
[30;1m96 | [0m[35m                self.assertRaises(k8s_config.ConfigException, k8s_config.load_incluster_config)[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1748[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport datetime[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport socket[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport unittest[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom threading import Thread[0m
[30;1m9 | [0m[35mfrom unittest import mock[0m

[31m--[ [0m[34mMatch #[0m[33m1749[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_kubernetes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport datetime[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport socket[0m
[30;1m5 | [0m[35mimport time[0m

[31m--[ [0m[34mMatch #[0m[33m1750[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/cancellable.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        communicate: Optional[Dict[str, str]] = kwargs.pop('communicate', None)[0m
[30;1m84 | [0m[35m        input_data = None[0m
[30;1m85 | [0m[35m        if isinstance(communicate, dict):[0m
[30;1m86 | [0m[35m            input_data = communicate.get('input')[0m
[30;1m87 | [0m[35m            if input_data:[0m
[30;1m88 | [0m[35m                if input_data[-1] != '\n':[0m
[30;1m89 | [0m[35m                    input_data += '\n'[0m

[31m--[ [0m[34mMatch #[0m[33m1751[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/postgresql/cancellable.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        try:[0m
[30;1m31 | [0m[35m            self._process_children = [][0m
[30;1m32 | [0m[35m            self._process_cmd = cmd[0m
[30;1m33 | [0m[35m            self._process = psutil.Popen(cmd, *args, **kwargs)[0m
[30;1m34 | [0m[35m        except Exception:[0m
[30;1m35 | [0m[35m            return logger.exception('Failed to execute %s', cmd)[0m
[30;1m36 | [0m[35m        return True[0m

[31m--[ [0m[34mMatch #[0m[33m1752[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m523 | [0m[35m            if TYPE_CHECKING:  # pragma: no cover[0m
[30;1m524 | [0m[35m                assert self.log_handler is not None[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m            record = self._queue_handler.queue.get(True)[0m
[30;1m527 | [0m[35m            # special message that indicates Patroni is shutting down[0m
[30;1m528 | [0m[35m            if record is None:[0m
[30;1m529 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m1753[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m                    self.log_handler = handler[0m
[30;1m487 | [0m[35m[0m
[30;1m488 | [0m[35m            self._config = config.copy()[0m
[30;1m489 | [0m[35m            self.update_loggers(config.get('loggers') or {})[0m
[30;1m490 | [0m[35m[0m
[30;1m491 | [0m[35m    def _close_old_handlers(self) -> None:[0m
[30;1m492 | [0m[35m        """Close old log handlers.[0m

[31m--[ [0m[34mMatch #[0m[33m1754[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m467 | [0m[35m                handler.set_log_file_mode(mode)[0m
[30;1m468 | [0m[35m                max_file_size = int(config.get('file_size', 25000000))[0m
[30;1m469 | [0m[35m                handler.maxBytes = max_file_size  # pyright: ignore [reportAttributeAccessIssue][0m
[30;1m470 | [0m[35m                handler.backupCount = int(config.get('file_num', 4))[0m
[30;1m471 | [0m[35m            # we can't use `if not isinstance(handler, logging.StreamHandler)` below,[0m
[30;1m472 | [0m[35m            # because RotatingFileHandler and PatroniFileHandler are children of StreamHandler!!![0m
[30;1m473 | [0m[35m            elif handler is None or isinstance(handler, PatroniFileHandler):[0m

[31m--[ [0m[34mMatch #[0m[33m1755[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m465 | [0m[35m                if not isinstance(handler, PatroniFileHandler):[0m
[30;1m466 | [0m[35m                    handler = PatroniFileHandler(os.path.join(config['dir'], __name__), mode)[0m
[30;1m467 | [0m[35m                handler.set_log_file_mode(mode)[0m
[30;1m468 | [0m[35m                max_file_size = int(config.get('file_size', 25000000))[0m
[30;1m469 | [0m[35m                handler.maxBytes = max_file_size  # pyright: ignore [reportAttributeAccessIssue][0m
[30;1m470 | [0m[35m                handler.backupCount = int(config.get('file_num', 4))[0m
[30;1m471 | [0m[35m            # we can't use `if not isinstance(handler, logging.StreamHandler)` below,[0m

[31m--[ [0m[34mMatch #[0m[33m1756[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m            handler = self.log_handler[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m            if 'dir' in config:[0m
[30;1m464 | [0m[35m                mode = parse_int(config.get('mode'))[0m
[30;1m465 | [0m[35m                if not isinstance(handler, PatroniFileHandler):[0m
[30;1m466 | [0m[35m                    handler = PatroniFileHandler(os.path.join(config['dir'], __name__), mode)[0m
[30;1m467 | [0m[35m                handler.set_log_file_mode(mode)[0m

[31m--[ [0m[34mMatch #[0m[33m1757[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m451 | [0m[35m                self._queue_handler.queue.maxsize = config.get('max_queue_size', self.DEFAULT_MAX_QU[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m            self._root_logger.setLevel(config.get('level', PatroniLogger.DEFAULT_LEVEL))[0m
[30;1m454 | [0m[35m            if config.get('traceback_level', PatroniLogger.DEFAULT_TRACEBACK_LEVEL).lower() == 'debu[0m
[30;1m455 | [0m[35m                # show stack traces only if ``log.traceback_level`` is ``DEBUG``[0m
[30;1m456 | [0m[35m                logging.Logger.exception = debug_exception[0m
[30;1m457 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1758[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m450 | [0m[35m            with self._queue_handler.queue.mutex:[0m
[30;1m451 | [0m[35m                self._queue_handler.queue.maxsize = config.get('max_queue_size', self.DEFAULT_MAX_QU[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m            self._root_logger.setLevel(config.get('level', PatroniLogger.DEFAULT_LEVEL))[0m
[30;1m454 | [0m[35m            if config.get('traceback_level', PatroniLogger.DEFAULT_TRACEBACK_LEVEL).lower() == 'debu[0m
[30;1m455 | [0m[35m                # show stack traces only if ``log.traceback_level`` is ``DEBUG``[0m
[30;1m456 | [0m[35m                logging.Logger.exception = debug_exception[0m

[31m--[ [0m[34mMatch #[0m[33m1759[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m448 | [0m[35m        """[0m
[30;1m449 | [0m[35m        if self._config is None or not deep_compare(self._config, config):[0m
[30;1m450 | [0m[35m            with self._queue_handler.queue.mutex:[0m
[30;1m451 | [0m[35m                self._queue_handler.queue.maxsize = config.get('max_queue_size', self.DEFAULT_MAX_QU[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m            self._root_logger.setLevel(config.get('level', PatroniLogger.DEFAULT_LEVEL))[0m
[30;1m454 | [0m[35m            if config.get('traceback_level', PatroniLogger.DEFAULT_TRACEBACK_LEVEL).lower() == 'debu[0m

[31m--[ [0m[34mMatch #[0m[33m1760[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m425 | [0m[35m        logtype = config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m426 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m427 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m
[30;1m428 | [0m[35m        static_fields = config.get('static_fields', {})[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m        if dateformat is not None and not isinstance(dateformat, str):[0m
[30;1m431 | [0m[35m            _LOGGER.warning('Expected log dateformat to be a string, but got "%s"', _type(dateformat[0m

[31m--[ [0m[34mMatch #[0m[33m1761[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m424 | [0m[35m        """[0m
[30;1m425 | [0m[35m        logtype = config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m426 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m427 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m
[30;1m428 | [0m[35m        static_fields = config.get('static_fields', {})[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m        if dateformat is not None and not isinstance(dateformat, str):[0m

[31m--[ [0m[34mMatch #[0m[33m1762[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m        :returns: A :class:`logging.Formatter` object that can be used to format log records.[0m
[30;1m424 | [0m[35m        """[0m
[30;1m425 | [0m[35m        logtype = config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m426 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m427 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m
[30;1m428 | [0m[35m        static_fields = config.get('static_fields', {})[0m
[30;1m429 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1763[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35m        :returns: A :class:`logging.Formatter` object that can be used to format log records.[0m
[30;1m424 | [0m[35m        """[0m
[30;1m425 | [0m[35m        logtype = config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m426 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m427 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m
[30;1m428 | [0m[35m        static_fields = config.get('static_fields', {})[0m

[31m--[ [0m[34mMatch #[0m[33m1764[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        old_static_fields = old_config.get('static_fields', {})[0m
[30;1m306 | [0m[35m        static_fields = config.get('static_fields', {})[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m        old_log_config = {[0m
[30;1m309 | [0m[35m            'type': oldlogtype,[0m

[31m--[ [0m[34mMatch #[0m[33m1765[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m302 | [0m[35m        olddateformat = old_config.get('dateformat') or None[0m
[30;1m303 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        old_static_fields = old_config.get('static_fields', {})[0m
[30;1m306 | [0m[35m        static_fields = config.get('static_fields', {})[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m        old_log_config = {[0m

[31m--[ [0m[34mMatch #[0m[33m1766[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m300 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m        olddateformat = old_config.get('dateformat') or None[0m
[30;1m303 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        old_static_fields = old_config.get('static_fields', {})[0m
[30;1m306 | [0m[35m        static_fields = config.get('static_fields', {})[0m

[31m--[ [0m[34mMatch #[0m[33m1767[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m        oldlogformat: type_logformat = old_config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m300 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m        olddateformat = old_config.get('dateformat') or None[0m
[30;1m303 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        old_static_fields = old_config.get('static_fields', {})[0m

[31m--[ [0m[34mMatch #[0m[33m1768[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m        logtype = config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m        oldlogformat: type_logformat = old_config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m300 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m        olddateformat = old_config.get('dateformat') or None[0m
[30;1m303 | [0m[35m        dateformat = config.get('dateformat') or None  # Convert empty string to `None`[0m

[31m--[ [0m[34mMatch #[0m[33m1769[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m        oldlogtype = old_config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m297 | [0m[35m        logtype = config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m        oldlogformat: type_logformat = old_config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m300 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m        olddateformat = old_config.get('dateformat') or None[0m

[31m--[ [0m[34mMatch #[0m[33m1770[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m        old_config = self._config or {}[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        oldlogtype = old_config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m297 | [0m[35m        logtype = config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m        oldlogformat: type_logformat = old_config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m
[30;1m300 | [0m[35m        logformat: type_logformat = config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m

[31m--[ [0m[34mMatch #[0m[33m1771[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m293 | [0m[35m        """[0m
[30;1m294 | [0m[35m        old_config = self._config or {}[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        oldlogtype = old_config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m297 | [0m[35m        logtype = config.get('type', PatroniLogger.DEFAULT_TYPE)[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m        oldlogformat: type_logformat = old_config.get('format', PatroniLogger.DEFAULT_FORMAT)[0m

[31m--[ [0m[34mMatch #[0m[33m1772[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m275 | [0m[35m            if not isinstance(logger, logging.PlaceHolder):[0m
[30;1m276 | [0m[35m                # if this logger is present in *config*, use the configured level, otherwise[0m
[30;1m277 | [0m[35m                # use ``logging.NOTSET``, which means it will inherit the level[0m
[30;1m278 | [0m[35m                # from any parent node up to the root for which log level is defined.[0m
[30;1m279 | [0m[35m                level = loggers.pop(name, logging.NOTSET)[0m
[30;1m280 | [0m[35m                logger.setLevel(level)[0m
[30;1m281 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1773[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m        """[0m
[30;1m271 | [0m[35m        loggers = deepcopy(config)[0m
[30;1m272 | [0m[35m        for name, logger in self._root_logger.manager.loggerDict.items():[0m
[30;1m273 | [0m[35m            # ``Placeholder`` is a node in the log manager for which no logger has been defined. We [0m
[30;1m274 | [0m[35m            # in the ones that were defined[0m
[30;1m275 | [0m[35m            if not isinstance(logger, logging.PlaceHolder):[0m
[30;1m276 | [0m[35m                # if this logger is present in *config*, use the configured level, otherwise[0m

[31m--[ [0m[34mMatch #[0m[33m1774[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m                       * ``log.loggers`` section of Patroni configuration; or[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m                       * from the method that is trying to make sure that the node name[0m
[30;1m263 | [0m[35m                         isn't duplicated (to silence annoying ``urllib3`` WARNING's).[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        :Example:[0m

[31m--[ [0m[34mMatch #[0m[33m1775[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/log.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m196 | [0m[35mclass PatroniLogger(Thread):[0m
[30;1m197 | [0m[35m    """Logging thread for the Patroni daemon process.[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    It is a 2-step logging approach. Any time a log message is issued it is initially enqueued in-me[0m
[30;1m200 | [0m[35m    asynchronously flushed to the final destination by the logging thread.[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m    .. seealso::[0m

[31m--[ [0m[34mMatch #[0m[33m1776[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m859 | [0m[35m    """[0m
[30;1m860 | [0m[35m    types: Dict[Any, str] = {str: 'a string', int: 'an integer', float: 'a number',[0m
[30;1m861 | [0m[35m                             bool: 'a boolean', list: 'an array', dict: 'a dictionary'}[0m
[30;1m862 | [0m[35m    return types.get(python_type, getattr(python_type, __name__, "unknown type"))[0m
[30;1m863 | [0m[35m[0m
[30;1m864 | [0m[35m[0m
[30;1m865 | [0m[35mdef assert_(condition: bool, message: str = "Wrong value") -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1777[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m336 | [0m[35m    if not bin_name:[0m
[30;1m337 | [0m[35m        raise ConfigParseError("is an empty string")[0m
[30;1m338 | [0m[35m    data = cast(Dict[Any, Any], schema.data)[0m
[30;1m339 | [0m[35m    bin_dir = data.get('postgresql', {}).get('bin_dir', None)[0m
[30;1m340 | [0m[35m    if not shutil.which(bin_name, path=bin_dir):[0m
[30;1m341 | [0m[35m        raise ConfigParseError(f"does not contain '{bin_name}' in '{bin_dir or '$PATH'}'")[0m
[30;1m342 | [0m[35m    return True[0m

[31m--[ [0m[34mMatch #[0m[33m1778[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m336 | [0m[35m    if not bin_name:[0m
[30;1m337 | [0m[35m        raise ConfigParseError("is an empty string")[0m
[30;1m338 | [0m[35m    data = cast(Dict[Any, Any], schema.data)[0m
[30;1m339 | [0m[35m    bin_dir = data.get('postgresql', {}).get('bin_dir', None)[0m
[30;1m340 | [0m[35m    if not shutil.which(bin_name, path=bin_dir):[0m
[30;1m341 | [0m[35m        raise ConfigParseError(f"does not contain '{bin_name}' in '{bin_dir or '$PATH'}'")[0m
[30;1m342 | [0m[35m    return True[0m

[31m--[ [0m[34mMatch #[0m[33m1779[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m300 | [0m[35m                raise ConfigParseError("data dir for the cluster is not empty, but doesn't contain"[0m
[30;1m301 | [0m[35m                                       " \"{}\" directory".format(waldir))[0m
[30;1m302 | [0m[35m            data = cast(Dict[Any, Any], schema.data)[0m
[30;1m303 | [0m[35m            bin_dir = data.get("postgresql", {}).get("bin_dir", None)[0m
[30;1m304 | [0m[35m            major_version = get_major_version(bin_dir, get_bin_name('postgres'))[0m
[30;1m305 | [0m[35m            if pgversion != major_version:[0m
[30;1m306 | [0m[35m                raise ConfigParseError("data_dir directory postgresql version ({}) doesn't match wit[0m

[31m--[ [0m[34mMatch #[0m[33m1780[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m300 | [0m[35m                raise ConfigParseError("data dir for the cluster is not empty, but doesn't contain"[0m
[30;1m301 | [0m[35m                                       " \"{}\" directory".format(waldir))[0m
[30;1m302 | [0m[35m            data = cast(Dict[Any, Any], schema.data)[0m
[30;1m303 | [0m[35m            bin_dir = data.get("postgresql", {}).get("bin_dir", None)[0m
[30;1m304 | [0m[35m            major_version = get_major_version(bin_dir, get_bin_name('postgres'))[0m
[30;1m305 | [0m[35m            if pgversion != major_version:[0m
[30;1m306 | [0m[35m                raise ConfigParseError("data_dir directory postgresql version ({}) doesn't match wit[0m

[31m--[ [0m[34mMatch #[0m[33m1781[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    :returns: value of ``postgresql.bin_name[*bin_name*]``, if present, otherwise *bin_name*.[0m
[30;1m261 | [0m[35m    """[0m
[30;1m262 | [0m[35m    data = cast(Dict[Any, Any], schema.data)[0m
[30;1m263 | [0m[35m    return (data.get('postgresql', {}).get('bin_name', {}) or EMPTY_DICT).get(bin_name, bin_name)[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35mdef validate_data_dir(data_dir: str) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1782[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    :returns: value of ``postgresql.bin_name[*bin_name*]``, if present, otherwise *bin_name*.[0m
[30;1m261 | [0m[35m    """[0m
[30;1m262 | [0m[35m    data = cast(Dict[Any, Any], schema.data)[0m
[30;1m263 | [0m[35m    return (data.get('postgresql', {}).get('bin_name', {}) or EMPTY_DICT).get(bin_name, bin_name)[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35mdef validate_data_dir(data_dir: str) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1783[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    :returns: value of ``postgresql.bin_name[*bin_name*]``, if present, otherwise *bin_name*.[0m
[30;1m261 | [0m[35m    """[0m
[30;1m262 | [0m[35m    data = cast(Dict[Any, Any], schema.data)[0m
[30;1m263 | [0m[35m    return (data.get('postgresql', {}).get('bin_name', {}) or EMPTY_DICT).get(bin_name, bin_name)[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35mdef validate_data_dir(data_dir: str) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1784[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m            try:[0m
[30;1m155 | [0m[35m                if s.connect_ex((host, port)) == 0:[0m
[30;1m156 | [0m[35m                    # Do not raise an exception if ignore_listen_port is set to True.[0m
[30;1m157 | [0m[35m                    if listen and not _validation_params.get('ignore_listen_port', False):[0m
[30;1m158 | [0m[35m                        raise ConfigParseError("Port {} is already in use.".format(port))[0m
[30;1m159 | [0m[35m                elif not listen:[0m
[30;1m160 | [0m[35m                    raise ConfigParseError("{} is not reachable".format(host_port))[0m

[31m--[ [0m[34mMatch #[0m[33m1785[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m829 | [0m[35m        # If the key was defined as an `Or` object in `validator` attribute, then each of its values[0m
[30;1m830 | [0m[35m        # the keys to access the `data` dictionary.[0m
[30;1m831 | [0m[35m        elif isinstance(key, Or):[0m
[30;1m832 | [0m[35m            # At least one of the `Or` entries should be available in the `data` dictionary. If we f[0m
[30;1m833 | [0m[35m            # one of them in `data`, then we return all found entries so the caller method can valid[0m
[30;1m834 | [0m[35m            if any([item in data for item in key.args]):[0m
[30;1m835 | [0m[35m                for item in key.args:[0m

[31m--[ [0m[34mMatch #[0m[33m1786[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m829 | [0m[35m        # If the key was defined as an `Or` object in `validator` attribute, then each of its values[0m
[30;1m830 | [0m[35m        # the keys to access the `data` dictionary.[0m
[30;1m831 | [0m[35m        elif isinstance(key, Or):[0m
[30;1m832 | [0m[35m            # At least one of the `Or` entries should be available in the `data` dictionary. If we f[0m
[30;1m833 | [0m[35m            # one of them in `data`, then we return all found entries so the caller method can valid[0m
[30;1m834 | [0m[35m            if any([item in data for item in key.args]):[0m
[30;1m835 | [0m[35m                for item in key.args:[0m

[31m--[ [0m[34mMatch #[0m[33m1787[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m656 | [0m[35m should be an :class:`int` instance;[0m
[30;1m657 | [0m[35m                * It must contain a ``aliases`` entry which value should be a :class:`list` of :clas[0m
[30;1m658 | [0m[35m                * It may optionally contain a ``data_directory`` entry, with a value which should be[0m
[30;1m659 | [0m[35m                * It must contain at least one of ``log_to_file`` or ``log_to_db``, with a value whi[0m
[30;1m660 | [0m[35m                  :class:`bool` instance;[0m
[30;1m661 | [0m[35m                * It must contain a ``version`` entry which value should be either an :class:`int` o[0m
[30;1m662 | [0m[35m                  instance.[0m
[30;1m663 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1788[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m618 | [0m[35m                  configuration option, and that class makes this configuration option as optional t[0m
[30;1m619 | [0m[35m                  user, allowing it to not be specified in the YAML; or[0m
[30;1m620 | [0m[35m                * An :class:`Or` instance. The ``args`` attribute of that object will contain a tupl[0m
[30;1m621 | [0m[35m                    configuration option names. At least one of them should be specified by the user[0m
[30;1m622 | [0m[35m[0m
[30;1m623 | [0m[35m            * For the values it can be either:[0m
[30;1m624 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1789[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m466 | [0m[35m                    "failover_priority": IntValidator(min=0, raise_assert=True),[0m
[30;1m467 | [0m[35m                })[0m
[30;1m468 | [0m[35m[0m
[30;1m469 | [0m[35m        The :class`AtMostOne` object is used to define that at most one of ``nofailover`` and[0m
[30;1m470 | [0m[35m        ``failover_priority`` can be provided.[0m
[30;1m471 | [0m[35m        """[0m
[30;1m472 | [0m[35m        self.args = args[0m

[31m--[ [0m[34mMatch #[0m[33m1790[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m444 | [0m[35mclass AtMostOne(object):[0m
[30;1m445 | [0m[35m    """Mark that at most one option from a :class:`Case` can be supplied.[0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m    Represents a list of possible configuration options in a given scope, where at most one can actu[0m
[30;1m448 | [0m[35m    be provided.[0m
[30;1m449 | [0m[35m[0m
[30;1m450 | [0m[35m    .. note::[0m

[31m--[ [0m[34mMatch #[0m[33m1791[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m[0m
[30;1m444 | [0m[35mclass AtMostOne(object):[0m
[30;1m445 | [0m[35m    """Mark that at most one option from a :class:`Case` can be supplied.[0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m    Represents a list of possible configuration options in a given scope, where at most one can actu[0m
[30;1m448 | [0m[35m    be provided.[0m

[31m--[ [0m[34mMatch #[0m[33m1792[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m    elif isinstance(logformat, list):[0m
[30;1m65 | [0m[35m        logformat = cast(List[Any], logformat)[0m
[30;1m66 | [0m[35m        if len(logformat) == 0:[0m
[30;1m67 | [0m[35m            raise ConfigParseError('should contain at least one item')[0m
[30;1m68 | [0m[35m        if not all(map(validate_log_field, logformat)):[0m
[30;1m69 | [0m[35m            raise ConfigParseError('each item should be a string or a dictionary with string values'[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1793[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m829 | [0m[35m        # If the key was defined as an `Or` object in `validator` attribute, then each of its values[0m
[30;1m830 | [0m[35m        # the keys to access the `data` dictionary.[0m
[30;1m831 | [0m[35m        elif isinstance(key, Or):[0m
[30;1m832 | [0m[35m            # At least one of the `Or` entries should be available in the `data` dictionary. If we f[0m
[30;1m833 | [0m[35m            # one of them in `data`, then we return all found entries so the caller method can valid[0m
[30;1m834 | [0m[35m            if any([item in data for item in key.args]):[0m
[30;1m835 | [0m[35m                for item in key.args:[0m

[31m--[ [0m[34mMatch #[0m[33m1794[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m774 | [0m[35m                    validator = validators[key][0m
[30;1m775 | [0m[35m                    if isinstance(key, (Or, AtMostOne)) and isinstance(validators[key], Case):[0m
[30;1m776 | [0m[35m                        validator = validators[key]._schema[d][0m
[30;1m777 | [0m[35m                    # In this loop we may be calling a new `Schema` either over an intermediate node[0m
[30;1m778 | [0m[35m                    # over a leaf node. In the latter case the recursive calls in the given path wil[0m
[30;1m779 | [0m[35m                    for v in Schema(validator).validate(data[d]):[0m
[30;1m780 | [0m[35m                        yield Result(v.status, v.error,[0m

[31m--[ [0m[34mMatch #[0m[33m1795[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m698 | [0m[35mtatements deal with the situation where we already reached a leaf node in the `Schema` structure, th[0m
[30;1m699 | [0m[35m        # we are dealing with an actual value validation. The remaining logic in this method is used[0m
[30;1m700 | [0m[35m        # iterable objects in the structure, until we eventually reach a leaf node to validate its v[0m
[30;1m701 | [0m[35m        if isinstance(self.validator, str):[0m
[30;1m702 | [0m[35m            yield Result(isinstance(self.data, str), "is not a string", level=1, data=self.data)[0m
[30;1m703 | [0m[35m        elif isinstance(self.validator, type):[0m
[30;1m704 | [0m[35m            yield Result(isinstance(self.data, self.validator),[0m

[31m--[ [0m[34mMatch #[0m[33m1796[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m695 | [0m[35m        self.data = data[0m
[30;1m696 | [0m[35m[0m
[30;1m697 | [0m[35m        # New `Schema` objects can be created while validating a given `Schema`, depending on its st[0m
[30;1m698 | [0m[35m        # 3 IF statements deal with the situation where we already reached a leaf node in the `Schem[0m
[30;1m699 | [0m[35m        # we are dealing with an actual value validation. The remaining logic in this method is used[0m
[30;1m700 | [0m[35m        # iterable objects in the structure, until we eventually reach a leaf node to validate its v[0m
[30;1m701 | [0m[35m        if isinstance(self.validator, str):[0m

[31m--[ [0m[34mMatch #[0m[33m1797[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    :param ip: the IP to be checked.[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m    :returns: ``True`` if the IP is an IPv6 address.[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    :raises:[0m
[30;1m246 | [0m[35m        :class:`~patroni.exceptions.ConfigParseError`: if *ip* is not a valid IPv6 address.[0m

[31m--[ [0m[34mMatch #[0m[33m1798[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35mdef is_ipv6_address(ip: str) -> bool:[0m
[30;1m239 | [0m[35m    """Check if *ip* is a valid IPv6 address.[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    :param ip: the IP to be checked.[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m    :returns: ``True`` if the IP is an IPv6 address.[0m
[30;1m244 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1799[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    :param ip: the IP to be checked.[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    :returns: ``True`` if the IP is an IPv4 address.[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m    :raises:[0m
[30;1m229 | [0m[35m        :class:`~patroni.exceptions.ConfigParseError`: if *ip* is not a valid IPv4 address.[0m

[31m--[ [0m[34mMatch #[0m[33m1800[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35mdef is_ipv4_address(ip: str) -> bool:[0m
[30;1m222 | [0m[35m    """Check if *ip* is a valid IPv4 address.[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    :param ip: the IP to be checked.[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m    :returns: ``True`` if the IP is an IPv4 address.[0m
[30;1m227 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1801[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m        else:[0m
[30;1m140 | [0m[35m            hosts = [hosts][0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # If host is set to "*" get all hostnames and/or IP addresses that the host would be able to[0m
[30;1m143 | [0m[35m        if "*" in hosts:[0m
[30;1m144 | [0m[35m            if len(hosts) != 1:[0m
[30;1m145 | [0m[35m                raise ConfigParseError("expecting '*' alone")[0m

[31m--[ [0m[34mMatch #[0m[33m1802[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/scripts/barman/config_switch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mRefer to :class:`ExitCode` for possible exit codes of this sub-command.[0m
[30;1m16 | [0m[35m"""[0m
[30;1m17 | [0m[35mimport logging[0m
[30;1m18 | [0m[35mimport time[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mfrom argparse import Namespace[0m
[30;1m21 | [0m[35mfrom enum import IntEnum[0m
[30;1m22 | [0m[35mfrom typing import Optional, TYPE_CHECKING[0m

[31m--[ [0m[34mMatch #[0m[33m1803[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/daemon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m        :param local: will be ``True`` if there are changes in the local configuration file.[0m
[30;1m120 | [0m[35m        """[0m
[30;1m121 | [0m[35m        if local:[0m
[30;1m122 | [0m[35m            self.logger.reload_config(self.config.get('log', {}))[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    @abc.abstractmethod[0m
[30;1m125 | [0m[35m    def _run_cycle(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1804[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/tests/test_bootstrap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m258 | [0m[35m            self.b.post_bootstrap({'users': 1}, task)[0m
[30;1m259 | [0m[35m            self.assertEqual(mock_logger.call_args_list[0][0][0],[0m
[30;1m260 | [0m[35m                             'User creation is not be supported starting from v4.0.0. '[0m
[30;1m261 | [0m[35m                             'Please use "bootstrap.post_bootstrap" script to create users.')[0m
[30;1m262 | [0m[35m            self.assertTrue(task.result)[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m        self.b.bootstrap(config)[0m

[31m--[ [0m[34mMatch #[0m[33m1805[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/collections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35m            >>> repr(CaseInsensitiveDict({'a': 'b', 'A': 'B', 'c': 'd'}))  # doctest: +ELLIPSIS[0m
[30;1m208 | [0m[35m            "<CaseInsensitiveDict{'A': 'B', 'c': 'd'} at ..."[0m
[30;1m209 | [0m[35m        """[0m
[30;1m210 | [0m[35m        return '<{0}{1} at {2:x}>'.format(type(self).__name__, dict(self.items()), id(self))[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35mclass _FrozenDict(Mapping[str, Any]):[0m

[31m--[ [0m[34mMatch #[0m[33m1806[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/collections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m        :Example:[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m            >>> repr(CaseInsensitiveDict({'a': 'b', 'A': 'B', 'c': 'd'}))  # doctest: +ELLIPSIS[0m
[30;1m208 | [0m[35m            "<CaseInsensitiveDict{'A': 'B', 'c': 'd'} at ..."[0m
[30;1m209 | [0m[35m        """[0m
[30;1m210 | [0m[35m        return '<{0}{1} at {2:x}>'.format(type(self).__name__, dict(self.items()), id(self))[0m
[30;1m211 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1807[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/collections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m            >>> repr(CaseInsensitiveSet(('1', 'test', 'Test', 'TESt', 'test2')))  # doctest: +ELLIPS[0m
[30;1m36 | [0m[35m            "<CaseInsensitiveSet('1', 'TESt', 'test2') at ..."[0m
[30;1m37 | [0m[35m        """[0m
[30;1m38 | [0m[35m        return '<{0}{1} at {2:x}>'.format(type(self).__name__, tuple(self._values.values()), id(self[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    def __str__(self) -> str:[0m
[30;1m41 | [0m[35m        """Get set values for printing.[0m

[31m--[ [0m[34mMatch #[0m[33m1808[0m[34m of [0m[33m1808[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/patroni-4.0.5/patroni/collections.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m        :Example:[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m            >>> repr(CaseInsensitiveSet(('1', 'test', 'Test', 'TESt', 'test2')))  # doctest: +ELLIPS[0m
[30;1m36 | [0m[35m            "<CaseInsensitiveSet('1', 'TESt', 'test2') at ..."[0m
[30;1m37 | [0m[35m        """[0m
[30;1m38 | [0m[35m        return '<{0}{1} at {2:x}>'.format(type(self).__name__, tuple(self._values.values()), id(self[0m
[30;1m39 | [0m[35m[0m

1808 matches found.
