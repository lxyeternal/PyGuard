[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m865 | [0m[35m              scheme=https[0m
[30;1m866 | [0m[35m              port=8443[0m
[30;1m867 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m868 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m869 | [0m[35m            fi[0m
[30;1m870 | [0m[35m[0m
[30;1m871 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m864 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m865 | [0m[35m              scheme=https[0m
[30;1m866 | [0m[35m              port=8443[0m
[30;1m867 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m868 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m869 | [0m[35m            fi[0m
[30;1m870 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m834 | [0m[35m            VolumeSize: 400[0m
[30;1m835 | [0m[35m            VolumeType: gp2[0m
[30;1m836 | [0m[35m      UserData:[0m
[30;1m837 | [0m[35m        Fn::Base64: !Sub[0m
[30;1m838 | [0m[35m          - |[0m
[30;1m839 | [0m[35m            Content-Type: multipart/mixed; boundary="//"[0m
[30;1m840 | [0m[35m            MIME-Version: 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m  MasterTLSKey:[0m
[30;1m159 | [0m[35m    Type: String[0m
[30;1m160 | [0m[35m    Description: Base64-encoded TLS key for the master[0m
[30;1m161 | [0m[35m    Default: ""[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m  MasterCertName:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m  MasterTLSCert:[0m
[30;1m154 | [0m[35m    Type: String[0m
[30;1m155 | [0m[35m    Description: Base64-encoded TLS certificate for the master[0m
[30;1m156 | [0m[35m    Default: ""[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m  MasterTLSKey:[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1000 | [0m[35m                --env DET_MASTER=http://determined-master:8080 \[0m
[30;1m1001 | [0m[35m                --env DB_NAME=lore \[0m
[30;1m1002 | [0m[35m                --env DB_USER=postgres \[0m
[30;1m1003 | [0m[35m                --env DB_PASSWORD=${DBPassword} \[0m
[30;1m1004 | [0m[35m                --env DB_HOST=${Database.Endpoint.Address} \[0m
[30;1m1005 | [0m[35m                --env DB_PORT=5432 \[0m
[30;1m1006 | [0m[35m                --env LORE_DOCKER_TAG_SUFFIX="${GenAIVersion}" \[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1000 | [0m[35m                --env DET_MASTER=http://determined-master:8080 \[0m
[30;1m1001 | [0m[35m                --env DB_NAME=lore \[0m
[30;1m1002 | [0m[35m                --env DB_USER=postgres \[0m
[30;1m1003 | [0m[35m                --env DB_PASSWORD=${DBPassword} \[0m
[30;1m1004 | [0m[35m                --env DB_HOST=${Database.Endpoint.Address} \[0m
[30;1m1005 | [0m[35m                --env DB_PORT=5432 \[0m
[30;1m1006 | [0m[35m                --env LORE_DOCKER_TAG_SUFFIX="${GenAIVersion}" \[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m967 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m968 | [0m[35m[0m
[30;1m969 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m970 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m971 | [0m[35m            fi[0m
[30;1m972 | [0m[35m[0m
[30;1m973 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m944 | [0m[35m                container_path: "${GenAISharedFSMountPath}"[0m
[30;1m945 | [0m[35m            [0m
[30;1m946 | [0m[35m            security:[0m
[30;1m947 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m948 | [0m[35m            EOF[0m
[30;1m949 | [0m[35m[0m
[30;1m950 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m944 | [0m[35m                container_path: "${GenAISharedFSMountPath}"[0m
[30;1m945 | [0m[35m            [0m
[30;1m946 | [0m[35m            security:[0m
[30;1m947 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m948 | [0m[35m            EOF[0m
[30;1m949 | [0m[35m[0m
[30;1m950 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m930 | [0m[35m                  mkdir -p /mnt/efs[0m
[30;1m931 | [0m[35m                  mount -t efs ${EFSVal}:/ /mnt/efs[0m
[30;1m932 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m933 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m934 | [0m[35m                  fi[0m
[30;1m935 | [0m[35m[0m
[30;1m936 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m877 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m878 | [0m[35m[0m
[30;1m879 | [0m[35m            db:[0m
[30;1m880 | [0m[35m              password: "${DBPassword}"[0m
[30;1m881 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m882 | [0m[35m              name: determined[0m
[30;1m883 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m877 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m878 | [0m[35m[0m
[30;1m879 | [0m[35m            db:[0m
[30;1m880 | [0m[35m              password: "${DBPassword}"[0m
[30;1m881 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m882 | [0m[35m              name: determined[0m
[30;1m883 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m648 | [0m[35m      DatabaseName: determined[0m
[30;1m649 | [0m[35m      DBSubnetGroupName: !Ref DatabaseSubnetGroup[0m
[30;1m650 | [0m[35m      MasterUsername: postgres[0m
[30;1m651 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m652 | [0m[35m      Tags:[0m
[30;1m653 | [0m[35m        - Key: user[0m
[30;1m654 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m648 | [0m[35m      DatabaseName: determined[0m
[30;1m649 | [0m[35m      DBSubnetGroupName: !Ref DatabaseSubnetGroup[0m
[30;1m650 | [0m[35m      MasterUsername: postgres[0m
[30;1m651 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m652 | [0m[35m      Tags:[0m
[30;1m653 | [0m[35m        - Key: user[0m
[30;1m654 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m      security:[0m
[30;1m303 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m304 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m305 | [0m[35m        tls:[0m
[30;1m306 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m      security:[0m
[30;1m303 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m304 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m305 | [0m[35m        tls:[0m
[30;1m306 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m      db:[0m
[30;1m257 | [0m[35m        user: postgres[0m
[30;1m258 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m259 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m260 | [0m[35m        port: 5432[0m
[30;1m261 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m      db:[0m
[30;1m257 | [0m[35m        user: postgres[0m
[30;1m258 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m259 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m260 | [0m[35m        port: 5432[0m
[30;1m261 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m  InitialUserPassword:[0m
[30;1m239 | [0m[35m    Type: String[0m
[30;1m240 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m241 | [0m[35m    Default: ""[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m  MasterConfigTemplate:[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m235 | [0m[35m    Description: preexisting EFS ID to mount[0m
[30;1m236 | [0m[35m    Default: ""[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m  InitialUserPassword:[0m
[30;1m239 | [0m[35m    Type: String[0m
[30;1m240 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m241 | [0m[35m    Default: ""[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m  DBPassword:[0m
[30;1m107 | [0m[35m    Type: String[0m
[30;1m108 | [0m[35m    Description: Password for database[0m
[30;1m109 | [0m[35m    NoEcho: true[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m  MaxAuxContainersPerAgent:[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m    Type: String[0m
[30;1m104 | [0m[35m    Description: Determined version or commit for master image[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m  DBPassword:[0m
[30;1m107 | [0m[35m    Type: String[0m
[30;1m108 | [0m[35m    Description: Password for database[0m
[30;1m109 | [0m[35m    NoEcho: true[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m
[30;1m97 | [0m[35m    Type: String[0m
[30;1m98 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m99 | [0m[35m    Default: ""[0m
[30;1m100 | [0m[35m    NoEcho: true[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m999 | [0m[35m                --name lore-backend \[0m
[30;1m1000 | [0m[35m                --env DET_MASTER=http://determined-master:8080 \[0m
[30;1m1001 | [0m[35m                --env DB_NAME=lore \[0m
[30;1m1002 | [0m[35m                --env DB_USER=postgres \[0m
[30;1m1003 | [0m[35m                --env DB_PASSWORD=${DBPassword} \[0m
[30;1m1004 | [0m[35m                --env DB_HOST=${Database.Endpoint.Address} \[0m
[30;1m1005 | [0m[35m                --env DB_PORT=5432 \[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/database/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35mresource "google_sql_user" "db_users" {[0m
[30;1m38 | [0m[35m  name     = var.db_username[0m
[30;1m39 | [0m[35m  instance = google_sql_database_instance.db_instance.name[0m
[30;1m40 | [0m[35m  password = var.db_password[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m}[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/database/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35mresource "google_sql_user" "db_users" {[0m
[30;1m38 | [0m[35m  name     = var.db_username[0m
[30;1m39 | [0m[35m  instance = google_sql_database_instance.db_instance.name[0m
[30;1m40 | [0m[35m  password = var.db_password[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m}[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m268 | [0m[35m            output_path = pathlib.Path(output_filename)[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m        with output_path.open("wb") as f:[0m
[30;1m271 | [0m[35m            f.write(base64.b64decode(resp.b64Tgz))[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m        return str(output_path)[0m
[30;1m274 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport enum[0m
[30;1m3 | [0m[35mimport pathlib[0m
[30;1m4 | [0m[35mimport sys[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m      ssl_root_cert: ${var.database_ssl_enabled ? "/etc/determined/db_ssl_root_cert.pem" : ""}[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    security:[0m
[30;1m51 | [0m[35m      initial_user_password: ${var.initial_user_password}[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    cpu_env_image: ${var.cpu_env_image}[0m
[30;1m54 | [0m[35m    gpu_env_image: ${var.gpu_env_image}[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m      ssl_root_cert: ${var.database_ssl_enabled ? "/etc/determined/db_ssl_root_cert.pem" : ""}[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    security:[0m
[30;1m51 | [0m[35m      initial_user_password: ${var.initial_user_password}[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    cpu_env_image: ${var.cpu_env_image}[0m
[30;1m54 | [0m[35m    gpu_env_image: ${var.gpu_env_image}[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    db:[0m
[30;1m42 | [0m[35m      user: "${var.db_username}"[0m
[30;1m43 | [0m[35m      password: "${var.db_password}"[0m
[30;1m44 | [0m[35m      host: "${var.database_hostname}"[0m
[30;1m45 | [0m[35m      port: 5432[0m
[30;1m46 | [0m[35m      name: "${var.database_name}"[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    db:[0m
[30;1m42 | [0m[35m      user: "${var.db_username}"[0m
[30;1m43 | [0m[35m      password: "${var.db_password}"[0m
[30;1m44 | [0m[35m      host: "${var.database_hostname}"[0m
[30;1m45 | [0m[35m      port: 5432[0m
[30;1m46 | [0m[35m      name: "${var.database_name}"[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/master.yaml.tmpl[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m{{ end }}[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35msecurity:[0m
[30;1m57 | [0m[35m    initial_user_password: "{{ .security.initial_user_password }}"[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/master.yaml.tmpl[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m{{ end }}[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35msecurity:[0m
[30;1m57 | [0m[35m    initial_user_password: "{{ .security.initial_user_password }}"[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/master.yaml.tmpl[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mdb:[0m
[30;1m9 | [0m[35m  user: "{{ .db.user }}"[0m
[30;1m10 | [0m[35m  password: "{{ .db.password }}"[0m
[30;1m11 | [0m[35m  host: "{{ .db.host }}"[0m
[30;1m12 | [0m[35m  port: {{ .db.port }}[0m
[30;1m13 | [0m[35m  name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/master.yaml.tmpl[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mdb:[0m
[30;1m9 | [0m[35m  user: "{{ .db.user }}"[0m
[30;1m10 | [0m[35m  password: "{{ .db.password }}"[0m
[30;1m11 | [0m[35m  host: "{{ .db.host }}"[0m
[30;1m12 | [0m[35m  port: {{ .db.port }}[0m
[30;1m13 | [0m[35m  name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m182 | [0m[35m  cpu_env_image = var.cpu_env_image[0m
[30;1m183 | [0m[35m  gpu_env_image = var.gpu_env_image[0m
[30;1m184 | [0m[35m  labels = var.labels[0m
[30;1m185 | [0m[35m  initial_user_password = var.initial_user_password[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m  network_name = module.network.network_name[0m
[30;1m188 | [0m[35m  subnetwork_name = module.network.subnetwork_name[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m182 | [0m[35m  cpu_env_image = var.cpu_env_image[0m
[30;1m183 | [0m[35m  gpu_env_image = var.gpu_env_image[0m
[30;1m184 | [0m[35m  labels = var.labels[0m
[30;1m185 | [0m[35m  initial_user_password = var.initial_user_password[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m  network_name = module.network.network_name[0m
[30;1m188 | [0m[35m  subnetwork_name = module.network.subnetwork_name[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m176 | [0m[35m  preemptible = var.preemptible[0m
[30;1m177 | [0m[35m  operation_timeout_period = var.operation_timeout_period[0m
[30;1m178 | [0m[35m  db_username = var.db_username[0m
[30;1m179 | [0m[35m  db_password = var.db_password[0m
[30;1m180 | [0m[35m  scheduler_type = var.scheduler_type[0m
[30;1m181 | [0m[35m  preemption_enabled = var.preemption_enabled[0m
[30;1m182 | [0m[35m  cpu_env_image = var.cpu_env_image[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m176 | [0m[35m  preemptible = var.preemptible[0m
[30;1m177 | [0m[35m  operation_timeout_period = var.operation_timeout_period[0m
[30;1m178 | [0m[35m  db_username = var.db_username[0m
[30;1m179 | [0m[35m  db_password = var.db_password[0m
[30;1m180 | [0m[35m  scheduler_type = var.scheduler_type[0m
[30;1m181 | [0m[35m  preemption_enabled = var.preemption_enabled[0m
[30;1m182 | [0m[35m  cpu_env_image = var.cpu_env_image[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35m  unique_id = local.unique_id[0m
[30;1m117 | [0m[35m  db_tier = var.db_tier[0m
[30;1m118 | [0m[35m  db_username = var.db_username[0m
[30;1m119 | [0m[35m  db_password = var.db_password[0m
[30;1m120 | [0m[35m  db_version = var.db_version[0m
[30;1m121 | [0m[35m  user_labels = var.labels[0m
[30;1m122 | [0m[35m  network_self_link = module.network.network_self_link[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35m  unique_id = local.unique_id[0m
[30;1m117 | [0m[35m  db_tier = var.db_tier[0m
[30;1m118 | [0m[35m  db_username = var.db_username[0m
[30;1m119 | [0m[35m  db_password = var.db_password[0m
[30;1m120 | [0m[35m  db_version = var.db_version[0m
[30;1m121 | [0m[35m  user_labels = var.labels[0m
[30;1m122 | [0m[35m  network_self_link = module.network.network_self_link[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m518 | [0m[35m    port = parsed.port or default_port[0m
[30;1m519 | [0m[35m    netloc = f"{parsed.hostname}:{port}"[0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m    # Discard username, password, query, and fragment.[0m
[30;1m522 | [0m[35m    return parse.urlunparse((parsed.scheme, netloc, parsed.path, "", "", "")).rstrip("/")[0m
[30;1m523 | [0m[35m[0m
[30;1m524 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    token_store = TokenStore(master_address)[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m    user, _, __ = default_load_user_password(requested_user, None, token_store)[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m    token = token_store.get_token(user)[0m
[30;1m289 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m251 | [0m[35m        raise[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    try:[0m
[30;1m254 | [0m[35m        check_password_complexity(password)[0m
[30;1m255 | [0m[35m    except ValueError as e:[0m
[30;1m256 | [0m[35m        warn_about_complexity(e)[0m
[30;1m257 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m251 | [0m[35m        raise[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    try:[0m
[30;1m254 | [0m[35m        check_password_complexity(password)[0m
[30;1m255 | [0m[35m    except ValueError as e:[0m
[30;1m256 | [0m[35m        warn_about_complexity(e)[0m
[30;1m257 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m242 | [0m[35m        sess = login(master_address, user, password, cert)[0m
[30;1m243 | [0m[35m        user, token = sess.username, sess.token[0m
[30;1m244 | [0m[35m    except api.errors.ForbiddenException:[0m
[30;1m245 | [0m[35m        # Master will return a 403 if the user is not found, or if the password is incorrect.[0m
[30;1m246 | [0m[35m        # This is the right response to a failed explicit login attempt. But in the "fallback" case,[0m
[30;1m247 | [0m[35m        # a user hasn't provided login information. There, a 401 "maybe try logging in" is a more[0m
[30;1m248 | [0m[35m        # appropriate response to login failure.[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m239 | [0m[35m        password = getpass.getpass(f"Password for user '{user}': ")[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    try:[0m
[30;1m242 | [0m[35m        sess = login(master_address, user, password, cert)[0m
[30;1m243 | [0m[35m        user, token = sess.username, sess.token[0m
[30;1m244 | [0m[35m    except api.errors.ForbiddenException:[0m
[30;1m245 | [0m[35m        # Master will return a 403 if the user is not found, or if the password is incorrect.[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m236 | [0m[35m        return api.Session(master=master_address, username=env_user, token=env_token, cert=cert)[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m    if password is None:[0m
[30;1m239 | [0m[35m        password = getpass.getpass(f"Password for user '{user}': ")[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    try:[0m
[30;1m242 | [0m[35m        sess = login(master_address, user, password, cert)[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m236 | [0m[35m        return api.Session(master=master_address, username=env_user, token=env_token, cert=cert)[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m    if password is None:[0m
[30;1m239 | [0m[35m        password = getpass.getpass(f"Password for user '{user}': ")[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    try:[0m
[30;1m242 | [0m[35m        sess = login(master_address, user, password, cert)[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m235 | [0m[35m        assert env_token[0m
[30;1m236 | [0m[35m        return api.Session(master=master_address, username=env_user, token=env_token, cert=cert)[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m    if password is None:[0m
[30;1m239 | [0m[35m        password = getpass.getpass(f"Password for user '{user}': ")[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    token_store = TokenStore(master_address)[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    user, password, was_fallback = default_load_user_password(requested_user, password, token_store)[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    # Check the token store if this session_user has a cached token. If so, check with the[0m
[30;1m213 | [0m[35m    # master to verify it has not expired. Otherwise, let the token be None.[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    token_store = TokenStore(master_address)[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    user, password, was_fallback = default_load_user_password(requested_user, password, token_store)[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    # Check the token store if this session_user has a cached token. If so, check with the[0m
[30;1m213 | [0m[35m    # master to verify it has not expired. Otherwise, let the token be None.[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    token_store = TokenStore(master_address)[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    user, password, was_fallback = default_load_user_password(requested_user, password, token_store)[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    # Check the token store if this session_user has a cached token. If so, check with the[0m
[30;1m213 | [0m[35m    # master to verify it has not expired. Otherwise, let the token be None.[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m    As a somewhat surprising side-effect of re-using an existing token from the cache, it is[0m
[30;1m201 | [0m[35m    actually possible in cache hit scenarios for an invalid password here to result in a valid login[0m
[30;1m202 | [0m[35m    since the password is only used in a cache miss.[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    Returns:[0m
[30;1m205 | [0m[35m        A new, logged-in Session (one that has a valid token).[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m198 | [0m[35m    login tokens are active, but it must be considered before asking the user for a password.[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m    As a somewhat surprising side-effect of re-using an existing token from the cache, it is[0m
[30;1m201 | [0m[35m    actually possible in cache hit scenarios for an invalid password here to result in a valid login[0m
[30;1m202 | [0m[35m    since the password is only used in a cache miss.[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    There is also a special case for checking if the DET_USER_TOKEN is set in the environment (by[0m
[30;1m197 | [0m[35m    the determined-master).  That must happen in this function because it is only used when no other[0m
[30;1m198 | [0m[35m    login tokens are active, but it must be considered before asking the user for a password.[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m    As a somewhat surprising side-effect of re-using an existing token from the cache, it is[0m
[30;1m201 | [0m[35m    actually possible in cache hit scenarios for an invalid password here to result in a valid login[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m180 | [0m[35mdef login_with_cache([0m
[30;1m181 | [0m[35m    master_address: str,[0m
[30;1m182 | [0m[35m    requested_user: Optional[str] = None,[0m
[30;1m183 | [0m[35m    password: Optional[str] = None,[0m
[30;1m184 | [0m[35m    cert: Optional[certs.Cert] = None,[0m
[30;1m185 | [0m[35m) -> "api.Session":[0m
[30;1m186 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m172 | [0m[35m    # Last priority is the default username and password.[0m
[30;1m173 | [0m[35m    return ([0m
[30;1m174 | [0m[35m        constants.DEFAULT_DETERMINED_USER,[0m
[30;1m175 | [0m[35m        password or constants.DEFAULT_DETERMINED_PASSWORD,[0m
[30;1m176 | [0m[35m        True,[0m
[30;1m177 | [0m[35m    )[0m
[30;1m178 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m172 | [0m[35m    # Last priority is the default username and password.[0m
[30;1m173 | [0m[35m    return ([0m
[30;1m174 | [0m[35m        constants.DEFAULT_DETERMINED_USER,[0m
[30;1m175 | [0m[35m        password or constants.DEFAULT_DETERMINED_PASSWORD,[0m
[30;1m176 | [0m[35m        True,[0m
[30;1m177 | [0m[35m    )[0m
[30;1m178 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m169 | [0m[35m    if active_user is not None:[0m
[30;1m170 | [0m[35m        return active_user, password, False[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    # Last priority is the default username and password.[0m
[30;1m173 | [0m[35m    return ([0m
[30;1m174 | [0m[35m        constants.DEFAULT_DETERMINED_USER,[0m
[30;1m175 | [0m[35m        password or constants.DEFAULT_DETERMINED_PASSWORD,[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m167 | [0m[35m    # Next priority is the active user in the token store.[0m
[30;1m168 | [0m[35m    active_user = token_store.get_active_user()[0m
[30;1m169 | [0m[35m    if active_user is not None:[0m
[30;1m170 | [0m[35m        return active_user, password, False[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    # Last priority is the default username and password.[0m
[30;1m173 | [0m[35m    return ([0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m160 | [0m[35m    # the container has an active user, that means the user has explicitly ran `det user login`[0m
[30;1m161 | [0m[35m    # inside the container.[0m
[30;1m162 | [0m[35m    env_user = get_det_username_from_env()[0m
[30;1m163 | [0m[35m    env_pass = get_det_password_from_env()[0m
[30;1m164 | [0m[35m    if env_user is not None and env_pass is not None:[0m
[30;1m165 | [0m[35m        return env_user, env_pass, False[0m
[30;1m166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m    if requested_user:[0m
[30;1m155 | [0m[35m        return requested_user, password, False[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    # Next highest priority is user/password from environment.[0m
[30;1m158 | [0m[35m    # Watch out! We have to check for DET_USER and DET_PASS, because containers will have DET_USER[0m
[30;1m159 | [0m[35m    # set, but that doesn't overrule the active user in the TokenStore, because if the TokenStore in[0m
[30;1m160 | [0m[35m    # the container has an active user, that means the user has explicitly ran `det user login`[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35m    """[0m
[30;1m153 | [0m[35m    # Always prefer an explicitly provided user/password.[0m
[30;1m154 | [0m[35m    if requested_user:[0m
[30;1m155 | [0m[35m        return requested_user, password, False[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    # Next highest priority is user/password from environment.[0m
[30;1m158 | [0m[35m    # Watch out! We have to check for DET_USER and DET_PASS, because containers will have DET_USER[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m150 | [0m[35m        A tuple of (username, Optional[password], was_fallback], where was_fallback indicates that[0m
[30;1m151 | [0m[35m        we are returning the system default username and password.[0m
[30;1m152 | [0m[35m    """[0m
[30;1m153 | [0m[35m    # Always prefer an explicitly provided user/password.[0m
[30;1m154 | [0m[35m    if requested_user:[0m
[30;1m155 | [0m[35m        return requested_user, password, False[0m
[30;1m156 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    Returns:[0m
[30;1m150 | [0m[35m        A tuple of (username, Optional[password], was_fallback], where was_fallback indicates that[0m
[30;1m151 | [0m[35m        we are returning the system default username and password.[0m
[30;1m152 | [0m[35m    """[0m
[30;1m153 | [0m[35m    # Always prefer an explicitly provided user/password.[0m
[30;1m154 | [0m[35m    if requested_user:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m147 | [0m[35m        password: a password explicitly provided by the end user[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    Returns:[0m
[30;1m150 | [0m[35m        A tuple of (username, Optional[password], was_fallback], where was_fallback indicates that[0m
[30;1m151 | [0m[35m        we are returning the system default username and password.[0m
[30;1m152 | [0m[35m    """[0m
[30;1m153 | [0m[35m    # Always prefer an explicitly provided user/password.[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    Args:[0m
[30;1m146 | [0m[35m        requested_user: a username explicitly provided by the end user[0m
[30;1m147 | [0m[35m        password: a password explicitly provided by the end user[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    Returns:[0m
[30;1m150 | [0m[35m        A tuple of (username, Optional[password], was_fallback], where was_fallback indicates that[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    Args:[0m
[30;1m146 | [0m[35m        requested_user: a username explicitly provided by the end user[0m
[30;1m147 | [0m[35m        password: a password explicitly provided by the end user[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    Returns:[0m
[30;1m150 | [0m[35m        A tuple of (username, Optional[password], was_fallback], where was_fallback indicates that[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m137 | [0m[35m    token_store: "TokenStore",[0m
[30;1m138 | [0m[35m) -> Tuple[str, Optional[str], bool]:[0m
[30;1m139 | [0m[35m    """[0m
[30;1m140 | [0m[35m    Decide on a username and password for a login attempt.[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    When values are explicitly provided, they should be honored.  But when they are not provided,[0m
[30;1m143 | [0m[35m    check environment variables and the token store before falling back to the system default.[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mdef default_load_user_password([0m
[30;1m135 | [0m[35m    requested_user: Optional[str],[0m
[30;1m136 | [0m[35m    password: Optional[str],[0m
[30;1m137 | [0m[35m    token_store: "TokenStore",[0m
[30;1m138 | [0m[35m) -> Tuple[str, Optional[str], bool]:[0m
[30;1m139 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m    return api.Session(master=master_address, username=username, token=r.token, cert=cert)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mdef default_load_user_password([0m
[30;1m135 | [0m[35m    requested_user: Optional[str],[0m
[30;1m136 | [0m[35m    password: Optional[str],[0m
[30;1m137 | [0m[35m    token_store: "TokenStore",[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m    """[0m
[30;1m127 | [0m[35m    password = api.salt_and_hash(password)[0m
[30;1m128 | [0m[35m    unauth_session = api.UnauthSession(master=master_address, cert=cert, max_retries=0)[0m
[30;1m129 | [0m[35m    login = bindings.v1LoginRequest(username=username, password=password, isHashed=True)[0m
[30;1m130 | [0m[35m    r = bindings.post_Login(session=unauth_session, body=login)[0m
[30;1m131 | [0m[35m    return api.Session(master=master_address, username=username, token=r.token, cert=cert)[0m
[30;1m132 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m    """[0m
[30;1m127 | [0m[35m    password = api.salt_and_hash(password)[0m
[30;1m128 | [0m[35m    unauth_session = api.UnauthSession(master=master_address, cert=cert, max_retries=0)[0m
[30;1m129 | [0m[35m    login = bindings.v1LoginRequest(username=username, password=password, isHashed=True)[0m
[30;1m130 | [0m[35m    r = bindings.post_Login(session=unauth_session, body=login)[0m
[30;1m131 | [0m[35m    return api.Session(master=master_address, username=username, token=r.token, cert=cert)[0m
[30;1m132 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m    Returns:[0m
[30;1m125 | [0m[35m        A new, logged-in api.Session (one that has a valid token).[0m
[30;1m126 | [0m[35m    """[0m
[30;1m127 | [0m[35m    password = api.salt_and_hash(password)[0m
[30;1m128 | [0m[35m    unauth_session = api.UnauthSession(master=master_address, cert=cert, max_retries=0)[0m
[30;1m129 | [0m[35m    login = bindings.v1LoginRequest(username=username, password=password, isHashed=True)[0m
[30;1m130 | [0m[35m    r = bindings.post_Login(session=unauth_session, body=login)[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m    Returns:[0m
[30;1m125 | [0m[35m        A new, logged-in api.Session (one that has a valid token).[0m
[30;1m126 | [0m[35m    """[0m
[30;1m127 | [0m[35m    password = api.salt_and_hash(password)[0m
[30;1m128 | [0m[35m    unauth_session = api.UnauthSession(master=master_address, cert=cert, max_retries=0)[0m
[30;1m129 | [0m[35m    login = bindings.v1LoginRequest(username=username, password=password, isHashed=True)[0m
[30;1m130 | [0m[35m    r = bindings.post_Login(session=unauth_session, body=login)[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35mdef login([0m
[30;1m109 | [0m[35m    master_address: str,[0m
[30;1m110 | [0m[35m    username: str,[0m
[30;1m111 | [0m[35m    password: str,[0m
[30;1m112 | [0m[35m    cert: Optional[certs.Cert] = None,[0m
[30;1m113 | [0m[35m) -> "api.Session":[0m
[30;1m114 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m    return os.environ.get("DET_USER_TOKEN")[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mdef get_det_password_from_env() -> Optional[str]:[0m
[30;1m101 | [0m[35m    return os.environ.get("DET_PASS")[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m        results.append(bad + "password must include a number")[0m
[30;1m84 | [0m[35m        ok = False[0m
[30;1m85 | [0m[35m    else:[0m
[30;1m86 | [0m[35m        results.append(good + "password must include a number")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    if not ok:[0m
[30;1m89 | [0m[35m        raise ValueError("\n".join(results))[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m        results.append(good + "password must include a lowercase letter")[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    if not password or re.search(r"\d", password) is None:[0m
[30;1m83 | [0m[35m        results.append(bad + "password must include a number")[0m
[30;1m84 | [0m[35m        ok = False[0m
[30;1m85 | [0m[35m    else:[0m
[30;1m86 | [0m[35m        results.append(good + "password must include a number")[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35m    else:[0m
[30;1m80 | [0m[35m        results.append(good + "password must include a lowercase letter")[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    if not password or re.search(r"\d", password) is None:[0m
[30;1m83 | [0m[35m        results.append(bad + "password must include a number")[0m
[30;1m84 | [0m[35m        ok = False[0m
[30;1m85 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35m    else:[0m
[30;1m80 | [0m[35m        results.append(good + "password must include a lowercase letter")[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    if not password or re.search(r"\d", password) is None:[0m
[30;1m83 | [0m[35m        results.append(bad + "password must include a number")[0m
[30;1m84 | [0m[35m        ok = False[0m
[30;1m85 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m        results.append(bad + "password must include a lowercase letter")[0m
[30;1m78 | [0m[35m        ok = False[0m
[30;1m79 | [0m[35m    else:[0m
[30;1m80 | [0m[35m        results.append(good + "password must include a lowercase letter")[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    if not password or re.search(r"\d", password) is None:[0m
[30;1m83 | [0m[35m        results.append(bad + "password must include a number")[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m74 | [0m[35m        results.append(good + "password must include an uppercase letter")[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    if not password or re.search(r"[a-z]", password) is None:[0m
[30;1m77 | [0m[35m        results.append(bad + "password must include a lowercase letter")[0m
[30;1m78 | [0m[35m        ok = False[0m
[30;1m79 | [0m[35m    else:[0m
[30;1m80 | [0m[35m        results.append(good + "password must include a lowercase letter")[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m73 | [0m[35m    else:[0m
[30;1m74 | [0m[35m        results.append(good + "password must include an uppercase letter")[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    if not password or re.search(r"[a-z]", password) is None:[0m
[30;1m77 | [0m[35m        results.append(bad + "password must include a lowercase letter")[0m
[30;1m78 | [0m[35m        ok = False[0m
[30;1m79 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m73 | [0m[35m    else:[0m
[30;1m74 | [0m[35m        results.append(good + "password must include an uppercase letter")[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    if not password or re.search(r"[a-z]", password) is None:[0m
[30;1m77 | [0m[35m        results.append(bad + "password must include a lowercase letter")[0m
[30;1m78 | [0m[35m        ok = False[0m
[30;1m79 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m71 | [0m[35m        results.append(bad + "password must include an uppercase letter")[0m
[30;1m72 | [0m[35m        ok = False[0m
[30;1m73 | [0m[35m    else:[0m
[30;1m74 | [0m[35m        results.append(good + "password must include an uppercase letter")[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    if not password or re.search(r"[a-z]", password) is None:[0m
[30;1m77 | [0m[35m        results.append(bad + "password must include a lowercase letter")[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m68 | [0m[35m        results.append(good + "password must have at least 8 characters")[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    if not password or re.search(r"[A-Z]", password) is None:[0m
[30;1m71 | [0m[35m        results.append(bad + "password must include an uppercase letter")[0m
[30;1m72 | [0m[35m        ok = False[0m
[30;1m73 | [0m[35m    else:[0m
[30;1m74 | [0m[35m        results.append(good + "password must include an uppercase letter")[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m    else:[0m
[30;1m68 | [0m[35m        results.append(good + "password must have at least 8 characters")[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    if not password or re.search(r"[A-Z]", password) is None:[0m
[30;1m71 | [0m[35m        results.append(bad + "password must include an uppercase letter")[0m
[30;1m72 | [0m[35m        ok = False[0m
[30;1m73 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m    else:[0m
[30;1m68 | [0m[35m        results.append(good + "password must have at least 8 characters")[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    if not password or re.search(r"[A-Z]", password) is None:[0m
[30;1m71 | [0m[35m        results.append(bad + "password must include an uppercase letter")[0m
[30;1m72 | [0m[35m        ok = False[0m
[30;1m73 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m        results.append(bad + "password must have at least 8 characters")[0m
[30;1m66 | [0m[35m        ok = False[0m
[30;1m67 | [0m[35m    else:[0m
[30;1m68 | [0m[35m        results.append(good + "password must have at least 8 characters")[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    if not password or re.search(r"[A-Z]", password) is None:[0m
[30;1m71 | [0m[35m        results.append(bad + "password must include an uppercase letter")[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m        results.append(good + "password cannot be blank")[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if not password or len(password) < 8:[0m
[30;1m65 | [0m[35m        results.append(bad + "password must have at least 8 characters")[0m
[30;1m66 | [0m[35m        ok = False[0m
[30;1m67 | [0m[35m    else:[0m
[30;1m68 | [0m[35m        results.append(good + "password must have at least 8 characters")[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m61 | [0m[35m    else:[0m
[30;1m62 | [0m[35m        results.append(good + "password cannot be blank")[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if not password or len(password) < 8:[0m
[30;1m65 | [0m[35m        results.append(bad + "password must have at least 8 characters")[0m
[30;1m66 | [0m[35m        ok = False[0m
[30;1m67 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m61 | [0m[35m    else:[0m
[30;1m62 | [0m[35m        results.append(good + "password cannot be blank")[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if not password or len(password) < 8:[0m
[30;1m65 | [0m[35m        results.append(bad + "password must have at least 8 characters")[0m
[30;1m66 | [0m[35m        ok = False[0m
[30;1m67 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m        results.append(bad + "password cannot be blank")[0m
[30;1m60 | [0m[35m        ok = False[0m
[30;1m61 | [0m[35m    else:[0m
[30;1m62 | [0m[35m        results.append(good + "password cannot be blank")[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if not password or len(password) < 8:[0m
[30;1m65 | [0m[35m        results.append(bad + "password must have at least 8 characters")[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m    ok = True[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    if not password:[0m
[30;1m59 | [0m[35m        results.append(bad + "password cannot be blank")[0m
[30;1m60 | [0m[35m        ok = False[0m
[30;1m61 | [0m[35m    else:[0m
[30;1m62 | [0m[35m        results.append(good + "password cannot be blank")[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m    results = [][0m
[30;1m56 | [0m[35m    ok = True[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    if not password:[0m
[30;1m59 | [0m[35m        results.append(bad + "password cannot be blank")[0m
[30;1m60 | [0m[35m        ok = False[0m
[30;1m61 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m        password: a password to check.[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    Raises:[0m
[30;1m49 | [0m[35m        ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m50 | [0m[35m    """[0m
[30;1m51 | [0m[35m    # TODO: DET-10209 - this should either invoke a shared lib or call a server endpoint[0m
[30;1m52 | [0m[35m    good = "\u2713 "  # ✓[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35m        - Must contain at least one number.[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    Args:[0m
[30;1m46 | [0m[35m        password: a password to check.[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    Raises:[0m
[30;1m49 | [0m[35m        ValueError: an error describing why the password does not meet complexity requirements.[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35m        - Must contain at least one number.[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    Args:[0m
[30;1m46 | [0m[35m        password: a password to check.[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    Raises:[0m
[30;1m49 | [0m[35m        ValueError: an error describing why the password does not meet complexity requirements.[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mdef check_password_complexity(password: Optional[str]) -> None:[0m
[30;1m37 | [0m[35m    """Raises a ValueError if the password does not meet complexity requirements.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    The complexity requirements are:[0m
[30;1m40 | [0m[35m        - Must be at least 8 characters long.[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m    )[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mdef check_password_complexity(password: Optional[str]) -> None:[0m
[30;1m37 | [0m[35m    """Raises a ValueError if the password does not meet complexity requirements.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    The complexity requirements are:[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m    )[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mdef check_password_complexity(password: Optional[str]) -> None:[0m
[30;1m37 | [0m[35m    """Raises a ValueError if the password does not meet complexity requirements.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    The complexity requirements are:[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m28 | [0m[35m    print([0m
[30;1m29 | [0m[35m        "Warning: your password does not appear to satisfy "[0m
[30;1m30 | [0m[35m        + f"recommended complexity requirements:\n{e}\n"[0m
[30;1m31 | [0m[35m        + "Please change your password as soon as possible.",[0m
[30;1m32 | [0m[35m        file=sys.stderr,[0m
[30;1m33 | [0m[35m    )[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mdef warn_about_complexity(e: ValueError) -> None:[0m
[30;1m28 | [0m[35m    print([0m
[30;1m29 | [0m[35m        "Warning: your password does not appear to satisfy "[0m
[30;1m30 | [0m[35m        + f"recommended complexity requirements:\n{e}\n"[0m
[30;1m31 | [0m[35m        + "Please change your password as soon as possible.",[0m
[30;1m32 | [0m[35m        file=sys.stderr,[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m    if password:[0m
[30;1m22 | [0m[35m        return hashlib.sha512((PASSWORD_SALT + password).encode()).hexdigest()[0m
[30;1m23 | [0m[35m    else:[0m
[30;1m24 | [0m[35m        return password[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mdef warn_about_complexity(e: ValueError) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mdef salt_and_hash(password: str) -> str:[0m
[30;1m21 | [0m[35m    if password:[0m
[30;1m22 | [0m[35m        return hashlib.sha512((PASSWORD_SALT + password).encode()).hexdigest()[0m
[30;1m23 | [0m[35m    else:[0m
[30;1m24 | [0m[35m        return password[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mdef salt_and_hash(password: str) -> str:[0m
[30;1m21 | [0m[35m    if password:[0m
[30;1m22 | [0m[35m        return hashlib.sha512((PASSWORD_SALT + password).encode()).hexdigest()[0m
[30;1m23 | [0m[35m    else:[0m
[30;1m24 | [0m[35m        return password[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mdef salt_and_hash(password: str) -> str:[0m
[30;1m21 | [0m[35m    if password:[0m
[30;1m22 | [0m[35m        return hashlib.sha512((PASSWORD_SALT + password).encode()).hexdigest()[0m
[30;1m23 | [0m[35m    else:[0m
[30;1m24 | [0m[35m        return password[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35mPASSWORD_SALT = "GubPEmmotfiK9TMD6Zdw"[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mdef salt_and_hash(password: str) -> str:[0m
[30;1m21 | [0m[35m    if password:[0m
[30;1m22 | [0m[35m        return hashlib.sha512((PASSWORD_SALT + password).encode()).hexdigest()[0m
[30;1m23 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14 | [0m[35mfrom determined.common import api, constants, util[0m
[30;1m15 | [0m[35mfrom determined.common.api import bindings, certs[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mPASSWORD_SALT = "GubPEmmotfiK9TMD6Zdw"[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mdef salt_and_hash(password: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m231 | [0m[35m    ):[0m
[30;1m232 | [0m[35m        env_user = get_det_username_from_env()[0m
[30;1m233 | [0m[35m        assert env_user[0m
[30;1m234 | [0m[35m        env_token = get_det_user_token_from_env()[0m
[30;1m235 | [0m[35m        assert env_token[0m
[30;1m236 | [0m[35m        return api.Session(master=master_address, username=env_user, token=env_token, cert=cert)[0m
[30;1m237 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m229 | [0m[35m        and get_det_user_token_from_env() is not None[0m
[30;1m230 | [0m[35m        and requested_user in (None, get_det_username_from_env())[0m
[30;1m231 | [0m[35m    ):[0m
[30;1m232 | [0m[35m        env_user = get_det_username_from_env()[0m
[30;1m233 | [0m[35m        assert env_user[0m
[30;1m234 | [0m[35m        env_token = get_det_user_token_from_env()[0m
[30;1m235 | [0m[35m        assert env_token[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m160 | [0m[35m    # the container has an active user, that means the user has explicitly ran `det user login`[0m
[30;1m161 | [0m[35m    # inside the container.[0m
[30;1m162 | [0m[35m    env_user = get_det_username_from_env()[0m
[30;1m163 | [0m[35m    env_pass = get_det_password_from_env()[0m
[30;1m164 | [0m[35m    if env_user is not None and env_pass is not None:[0m
[30;1m165 | [0m[35m        return env_user, env_pass, False[0m
[30;1m166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m159 | [0m[35m    # set, but that doesn't overrule the active user in the TokenStore, because if the TokenStore in[0m
[30;1m160 | [0m[35m    # the container has an active user, that means the user has explicitly ran `det user login`[0m
[30;1m161 | [0m[35m    # inside the container.[0m
[30;1m162 | [0m[35m    env_user = get_det_username_from_env()[0m
[30;1m163 | [0m[35m    env_pass = get_det_password_from_env()[0m
[30;1m164 | [0m[35m    if env_user is not None and env_pass is not None:[0m
[30;1m165 | [0m[35m        return env_user, env_pass, False[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mdef get_det_session_token_from_env() -> Optional[str]:[0m
[30;1m105 | [0m[35m    return os.environ.get("DET_SESSION_TOKEN")[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mdef login([0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mdef get_det_password_from_env() -> Optional[str]:[0m
[30;1m101 | [0m[35m    return os.environ.get("DET_PASS")[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mdef get_det_session_token_from_env() -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef get_det_user_token_from_env() -> Optional[str]:[0m
[30;1m97 | [0m[35m    return os.environ.get("DET_USER_TOKEN")[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mdef get_det_password_from_env() -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef get_det_username_from_env() -> Optional[str]:[0m
[30;1m93 | [0m[35m    return os.environ.get("DET_USER")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef get_det_user_token_from_env() -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m620 | [0m[35m    resp = bindings.get_GetModelDef(cli.setup_session(args), experimentId=args.experiment_id)[0m
[30;1m621 | [0m[35m    dst = f"experiment_{args.experiment_id}_model_def.tgz"[0m
[30;1m622 | [0m[35m    with args.output_dir.joinpath(dst).open("wb") as f:[0m
[30;1m623 | [0m[35m        f.write(base64.b64decode(resp.b64Tgz))[0m
[30;1m624 | [0m[35m[0m
[30;1m625 | [0m[35m[0m
[30;1m626 | [0m[35mdef download(args: argparse.Namespace) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport numbers[0m
[30;1m5 | [0m[35mimport pathlib[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m597 | [0m[35m                        cli.Arg([0m
[30;1m598 | [0m[35m                            "--initial-user-password",[0m
[30;1m599 | [0m[35m                            type=str,[0m
[30;1m600 | [0m[35m                            help="Password for the default 'determined' and 'admin' users.",[0m
[30;1m601 | [0m[35m                        ),[0m
[30;1m602 | [0m[35m                    ],[0m
[30;1m603 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m595 | [0m[35m                            "can be repeated",[0m
[30;1m596 | [0m[35m                        ),[0m
[30;1m597 | [0m[35m                        cli.Arg([0m
[30;1m598 | [0m[35m                            "--initial-user-password",[0m
[30;1m599 | [0m[35m                            type=str,[0m
[30;1m600 | [0m[35m                            help="Password for the default 'determined' and 'admin' users.",[0m
[30;1m601 | [0m[35m                        ),[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m482 | [0m[35m                            "--db-password",[0m
[30;1m483 | [0m[35m                            type=str,[0m
[30;1m484 | [0m[35m                            default=constants.defaults.DB_PASSWORD,[0m
[30;1m485 | [0m[35m                            help="password for master database",[0m
[30;1m486 | [0m[35m                        ),[0m
[30;1m487 | [0m[35m                        cli.Arg([0m
[30;1m488 | [0m[35m                            "--max-aux-containers-per-agent",[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m481 | [0m[35m                        cli.Arg([0m
[30;1m482 | [0m[35m                            "--db-password",[0m
[30;1m483 | [0m[35m                            type=str,[0m
[30;1m484 | [0m[35m                            default=constants.defaults.DB_PASSWORD,[0m
[30;1m485 | [0m[35m                            help="password for master database",[0m
[30;1m486 | [0m[35m                        ),[0m
[30;1m487 | [0m[35m                        cli.Arg([0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m479 | [0m[35m                            help="instance type for agents in the auxiliary resource pool",[0m
[30;1m480 | [0m[35m                        ),[0m
[30;1m481 | [0m[35m                        cli.Arg([0m
[30;1m482 | [0m[35m                            "--db-password",[0m
[30;1m483 | [0m[35m                            type=str,[0m
[30;1m484 | [0m[35m                            default=constants.defaults.DB_PASSWORD,[0m
[30;1m485 | [0m[35m                            help="password for master database",[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m199 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m200 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m201 | [0m[35m        det_configs["initial_user_password"] = initial_user_password[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    print("Starting Determined deployment on GCP...\n")[0m
[30;1m204 | [0m[35m    gcp.deploy(det_configs, env, variables_to_exclude)[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m199 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m200 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m201 | [0m[35m        det_configs["initial_user_password"] = initial_user_password[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    print("Starting Determined deployment on GCP...\n")[0m
[30;1m204 | [0m[35m    gcp.deploy(det_configs, env, variables_to_exclude)[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m199 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m200 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m201 | [0m[35m        det_configs["initial_user_password"] = initial_user_password[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    print("Starting Determined deployment on GCP...\n")[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m199 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m200 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m201 | [0m[35m        det_configs["initial_user_password"] = initial_user_password[0m
[30;1m202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m199 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m200 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m201 | [0m[35m        det_configs["initial_user_password"] = initial_user_password[0m
[30;1m202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m199 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m200 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m201 | [0m[35m        det_configs["initial_user_password"] = initial_user_password[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m199 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m200 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m201 | [0m[35m        det_configs["initial_user_password"] = initial_user_password[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m193 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m194 | [0m[35m        if not initial_user_password:[0m
[30;1m195 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m199 | [0m[35m            if initial_user_password != initial_user_password_check:[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m192 | [0m[35m    ):[0m
[30;1m193 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m194 | [0m[35m        if not initial_user_password:[0m
[30;1m195 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m191 | [0m[35m        )[0m
[30;1m192 | [0m[35m    ):[0m
[30;1m193 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m194 | [0m[35m        if not initial_user_password:[0m
[30;1m195 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m
[30;1m197 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m190 | [0m[35m            args.tf_state_gcs_bucket_name, det_configs["project_id"], det_configs["cluster_id"][0m
[30;1m191 | [0m[35m        )[0m
[30;1m192 | [0m[35m    ):[0m
[30;1m193 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m194 | [0m[35m        if not initial_user_password:[0m
[30;1m195 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m190 | [0m[35m            args.tf_state_gcs_bucket_name, det_configs["project_id"], det_configs["cluster_id"][0m
[30;1m191 | [0m[35m        )[0m
[30;1m192 | [0m[35m    ):[0m
[30;1m193 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m194 | [0m[35m        if not initial_user_password:[0m
[30;1m195 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m196 | [0m[35m                "Please enter an initial password for the built-in `determined` and `admin` users: "[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m            "master_instance_type": constants.defaults.MASTER_INSTANCE_TYPE,[0m
[30;1m123 | [0m[35m            "compute_agent_instance_type": constants.defaults.COMPUTE_AGENT_INSTANCE_TYPE,[0m
[30;1m124 | [0m[35m            "aux_agent_instance_type": constants.defaults.AUX_AGENT_INSTANCE_TYPE,[0m
[30;1m125 | [0m[35m            "db_password": constants.defaults.AUX_AGENT_INSTANCE_TYPE,[0m
[30;1m126 | [0m[35m            "max_aux_containers_per_agent": constants.defaults.MAX_AUX_CONTAINERS_PER_AGENT,[0m
[30;1m127 | [0m[35m            "max_idle_agent_period": constants.defaults.MAX_IDLE_AGENT_PERIOD,[0m
[30;1m128 | [0m[35m            "max_agent_starting_period": constants.defaults.MAX_AGENT_STARTING_PERIOD,[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/analytics.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Segment.io Configuration[0m
[30;1m14 | [0m[35m# https://github.com/segmentio/analytics-python/blob/5d87a9085c18ee25660c8196dd1233100f9b61b6/segmen[0m
[30;1m15 | [0m[35manalytics.write_key = os.environ.get("DET_SEGMENT_API_KEY")[0m
[30;1m16 | [0m[35manalytics.max_retries = 5[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/analytics.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m8 | [0m[35mlogger = logging.getLogger("determined.common")[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35menabled = os.environ.get("DET_SEGMENT_ENABLED") == "true"[0m
[30;1m11 | [0m[35m_cluster_id = os.environ.get("DET_CLUSTER_ID")[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Segment.io Configuration[0m
[30;1m14 | [0m[35m# https://github.com/segmentio/analytics-python/blob/5d87a9085c18ee25660c8196dd1233100f9b61b6/segmen[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/analytics.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mlogger = logging.getLogger("determined.common")[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35menabled = os.environ.get("DET_SEGMENT_ENABLED") == "true"[0m
[30;1m11 | [0m[35m_cluster_id = os.environ.get("DET_CLUSTER_ID")[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Segment.io Configuration[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    @secret_key.setter[0m
[30;1m104 | [0m[35m    def secret_key(self, value: str) -> None:[0m
[30;1m105 | [0m[35m        self._secret_key = compat.ensure_unicode(value)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    @property[0m
[30;1m108 | [0m[35m    def token(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m101 | [0m[35m        return self._secret_key[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    @secret_key.setter[0m
[30;1m104 | [0m[35m    def secret_key(self, value: str) -> None:[0m
[30;1m105 | [0m[35m        self._secret_key = compat.ensure_unicode(value)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m        self._refresh()[0m
[30;1m101 | [0m[35m        return self._secret_key[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    @secret_key.setter[0m
[30;1m104 | [0m[35m    def secret_key(self, value: str) -> None:[0m
[30;1m105 | [0m[35m        self._secret_key = compat.ensure_unicode(value)[0m
[30;1m106 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def secret_key(self) -> Any:[0m
[30;1m100 | [0m[35m        self._refresh()[0m
[30;1m101 | [0m[35m        return self._secret_key[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    @secret_key.setter[0m
[30;1m104 | [0m[35m    def secret_key(self, value: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m        self._access_key = compat.ensure_unicode(value)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def secret_key(self) -> Any:[0m
[30;1m100 | [0m[35m        self._refresh()[0m
[30;1m101 | [0m[35m        return self._secret_key[0m
[30;1m102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m    def get_frozen_credentials(self) -> credentials.ReadOnlyCredentials:[0m
[30;1m85 | [0m[35m        self._refresh()[0m
[30;1m86 | [0m[35m        with self._lock:[0m
[30;1m87 | [0m[35m            return credentials.ReadOnlyCredentials(self._access_key, self._secret_key, self._token)[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    @property[0m
[30;1m90 | [0m[35m    def access_key(self) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m        self.secret_key = creds.secret_key[0m
[30;1m52 | [0m[35m        self.token = creds.token[0m
[30;1m53 | [0m[35m        self._frozen_credentials = credentials.ReadOnlyCredentials([0m
[30;1m54 | [0m[35m            creds.access_key, creds.secret_key, creds.token[0m
[30;1m55 | [0m[35m        )[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    def _credentials_file(self) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m        creds = self._credentials_provider.load()[0m
[30;1m49 | [0m[35m        self._last_loaded = self._credentials_modified_time()[0m
[30;1m50 | [0m[35m        self.access_key = creds.access_key[0m
[30;1m51 | [0m[35m        self.secret_key = creds.secret_key[0m
[30;1m52 | [0m[35m        self.token = creds.token[0m
[30;1m53 | [0m[35m        self._frozen_credentials = credentials.ReadOnlyCredentials([0m
[30;1m54 | [0m[35m            creds.access_key, creds.secret_key, creds.token[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m        creds = self._credentials_provider.load()[0m
[30;1m49 | [0m[35m        self._last_loaded = self._credentials_modified_time()[0m
[30;1m50 | [0m[35m        self.access_key = creds.access_key[0m
[30;1m51 | [0m[35m        self.secret_key = creds.secret_key[0m
[30;1m52 | [0m[35m        self.token = creds.token[0m
[30;1m53 | [0m[35m        self._frozen_credentials = credentials.ReadOnlyCredentials([0m
[30;1m54 | [0m[35m            creds.access_key, creds.secret_key, creds.token[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m265 | [0m[35m                    "--db-password",[0m
[30;1m266 | [0m[35m                    type=str,[0m
[30;1m267 | [0m[35m                    default="postgres",[0m
[30;1m268 | [0m[35m                    help="password for master database",[0m
[30;1m269 | [0m[35m                ),[0m
[30;1m270 | [0m[35m                cli.Arg([0m
[30;1m271 | [0m[35m                    "--delete-db",[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m262 | [0m[35m                    help="version or commit to use",[0m
[30;1m263 | [0m[35m                ),[0m
[30;1m264 | [0m[35m                cli.Arg([0m
[30;1m265 | [0m[35m                    "--db-password",[0m
[30;1m266 | [0m[35m                    type=str,[0m
[30;1m267 | [0m[35m                    default="postgres",[0m
[30;1m268 | [0m[35m                    help="password for master database",[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m242 | [0m[35m                    "--initial-user-password",[0m
[30;1m243 | [0m[35m                    type=str,[0m
[30;1m244 | [0m[35m                    default=None,[0m
[30;1m245 | [0m[35m                    help="Initial password for admin/determined users",[0m
[30;1m246 | [0m[35m                ),[0m
[30;1m247 | [0m[35m                cli.Arg([0m
[30;1m248 | [0m[35m                    "--master-port",[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m239 | [0m[35m                    ),[0m
[30;1m240 | [0m[35m                ),[0m
[30;1m241 | [0m[35m                cli.Arg([0m
[30;1m242 | [0m[35m                    "--initial-user-password",[0m
[30;1m243 | [0m[35m                    type=str,[0m
[30;1m244 | [0m[35m                    default=None,[0m
[30;1m245 | [0m[35m                    help="Initial password for admin/determined users",[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m168 | [0m[35m                    "--db-password",[0m
[30;1m169 | [0m[35m                    type=str,[0m
[30;1m170 | [0m[35m                    default="postgres",[0m
[30;1m171 | [0m[35m                    help="password for master database",[0m
[30;1m172 | [0m[35m                ),[0m
[30;1m173 | [0m[35m                cli.Arg([0m
[30;1m174 | [0m[35m                    "--delete-db",[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m165 | [0m[35m                    help="version or commit to use",[0m
[30;1m166 | [0m[35m                ),[0m
[30;1m167 | [0m[35m                cli.Arg([0m
[30;1m168 | [0m[35m                    "--db-password",[0m
[30;1m169 | [0m[35m                    type=str,[0m
[30;1m170 | [0m[35m                    default="postgres",[0m
[30;1m171 | [0m[35m                    help="password for master database",[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m139 | [0m[35m                    "--initial-user-password",[0m
[30;1m140 | [0m[35m                    type=str,[0m
[30;1m141 | [0m[35m                    default=None,[0m
[30;1m142 | [0m[35m                    help="Initial password for admin/determined users",[0m
[30;1m143 | [0m[35m                ),[0m
[30;1m144 | [0m[35m                cli.Arg([0m
[30;1m145 | [0m[35m                    "--agents",[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m136 | [0m[35m                    ),[0m
[30;1m137 | [0m[35m                ),[0m
[30;1m138 | [0m[35m                cli.Arg([0m
[30;1m139 | [0m[35m                    "--initial-user-password",[0m
[30;1m140 | [0m[35m                    type=str,[0m
[30;1m141 | [0m[35m                    default=None,[0m
[30;1m142 | [0m[35m                    help="Initial password for admin/determined users",[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m        master_name=args.master_name,[0m
[30;1m57 | [0m[35m        image_repo_prefix=args.image_repo_prefix,[0m
[30;1m58 | [0m[35m        version=args.det_version,[0m
[30;1m59 | [0m[35m        db_password=args.db_password,[0m
[30;1m60 | [0m[35m        delete_db=args.delete_db,[0m
[30;1m61 | [0m[35m        autorestart=(not args.no_autorestart),[0m
[30;1m62 | [0m[35m        cluster_name=args.cluster_name,[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m        master_name=args.master_name,[0m
[30;1m57 | [0m[35m        image_repo_prefix=args.image_repo_prefix,[0m
[30;1m58 | [0m[35m        version=args.det_version,[0m
[30;1m59 | [0m[35m        db_password=args.db_password,[0m
[30;1m60 | [0m[35m        delete_db=args.delete_db,[0m
[30;1m61 | [0m[35m        autorestart=(not args.no_autorestart),[0m
[30;1m62 | [0m[35m        cluster_name=args.cluster_name,[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    cluster_utils.master_up([0m
[30;1m52 | [0m[35m        port=args.master_port,[0m
[30;1m53 | [0m[35m        initial_user_password=args.initial_user_password,[0m
[30;1m54 | [0m[35m        master_config_path=args.master_config_path,[0m
[30;1m55 | [0m[35m        storage_host_path=args.storage_host_path,[0m
[30;1m56 | [0m[35m        master_name=args.master_name,[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    cluster_utils.master_up([0m
[30;1m52 | [0m[35m        port=args.master_port,[0m
[30;1m53 | [0m[35m        initial_user_password=args.initial_user_password,[0m
[30;1m54 | [0m[35m        master_config_path=args.master_config_path,[0m
[30;1m55 | [0m[35m        storage_host_path=args.storage_host_path,[0m
[30;1m56 | [0m[35m        master_name=args.master_name,[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m        cluster_name=args.cluster_name,[0m
[30;1m27 | [0m[35m        image_repo_prefix=args.image_repo_prefix,[0m
[30;1m28 | [0m[35m        version=args.det_version,[0m
[30;1m29 | [0m[35m        db_password=args.db_password,[0m
[30;1m30 | [0m[35m        delete_db=args.delete_db,[0m
[30;1m31 | [0m[35m        gpu=args.gpu,[0m
[30;1m32 | [0m[35m        autorestart=(not args.no_autorestart),[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m        cluster_name=args.cluster_name,[0m
[30;1m27 | [0m[35m        image_repo_prefix=args.image_repo_prefix,[0m
[30;1m28 | [0m[35m        version=args.det_version,[0m
[30;1m29 | [0m[35m        db_password=args.db_password,[0m
[30;1m30 | [0m[35m        delete_db=args.delete_db,[0m
[30;1m31 | [0m[35m        gpu=args.gpu,[0m
[30;1m32 | [0m[35m        autorestart=(not args.no_autorestart),[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m    cluster_utils.cluster_up([0m
[30;1m21 | [0m[35m        num_agents=args.agents,[0m
[30;1m22 | [0m[35m        port=args.master_port,[0m
[30;1m23 | [0m[35m        initial_user_password=args.initial_user_password,[0m
[30;1m24 | [0m[35m        master_config_path=args.master_config_path,[0m
[30;1m25 | [0m[35m        storage_host_path=args.storage_host_path,[0m
[30;1m26 | [0m[35m        cluster_name=args.cluster_name,[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m    cluster_utils.cluster_up([0m
[30;1m21 | [0m[35m        num_agents=args.agents,[0m
[30;1m22 | [0m[35m        port=args.master_port,[0m
[30;1m23 | [0m[35m        initial_user_password=args.initial_user_password,[0m
[30;1m24 | [0m[35m        master_config_path=args.master_config_path,[0m
[30;1m25 | [0m[35m        storage_host_path=args.storage_host_path,[0m
[30;1m26 | [0m[35m        cluster_name=args.cluster_name,[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m78 | [0m[35m    NOTEBOOK_TIMEOUT = "NotebookTimeout"[0m
[30;1m79 | [0m[35m    GENAI_VERSION = "GenAIVersion"[0m
[30;1m80 | [0m[35m    GENAI_SHARED_FS_MOUNT_PATH = "GenAISharedFSMountPath"[0m
[30;1m81 | [0m[35m    INITIAL_USER_PASSWORD = "InitialUserPassword"[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mclass misc:[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m78 | [0m[35m    NOTEBOOK_TIMEOUT = "NotebookTimeout"[0m
[30;1m79 | [0m[35m    GENAI_VERSION = "GenAIVersion"[0m
[30;1m80 | [0m[35m    GENAI_SHARED_FS_MOUNT_PATH = "GenAISharedFSMountPath"[0m
[30;1m81 | [0m[35m    INITIAL_USER_PASSWORD = "InitialUserPassword"[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mclass misc:[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m38 | [0m[35m    MASTER_PORT = "MasterPort"[0m
[30;1m39 | [0m[35m    MASTER_SCHEME = "MasterScheme"[0m
[30;1m40 | [0m[35m    VERSION = "Version"[0m
[30;1m41 | [0m[35m    DB_PASSWORD = "DBPassword"[0m
[30;1m42 | [0m[35m    DB_INSTANCE_TYPE = "DBInstanceType"[0m
[30;1m43 | [0m[35m    DB_SNAPSHOT = "DBSnapshot"[0m
[30;1m44 | [0m[35m    DB_SIZE = "DBSize"[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m38 | [0m[35m    MASTER_PORT = "MasterPort"[0m
[30;1m39 | [0m[35m    MASTER_SCHEME = "MasterScheme"[0m
[30;1m40 | [0m[35m    VERSION = "Version"[0m
[30;1m41 | [0m[35m    DB_PASSWORD = "DBPassword"[0m
[30;1m42 | [0m[35m    DB_INSTANCE_TYPE = "DBInstanceType"[0m
[30;1m43 | [0m[35m    DB_SNAPSHOT = "DBSnapshot"[0m
[30;1m44 | [0m[35m    DB_SIZE = "DBSize"[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mclass defaults:[0m
[30;1m13 | [0m[35m    DEPLOYMENT_TYPE = deployment_types.SIMPLE_RDS[0m
[30;1m14 | [0m[35m    DB_PASSWORD = "postgres"[0m
[30;1m15 | [0m[35m    REGION = "us-west-2"[0m
[30;1m16 | [0m[35m    STACK_TAG_KEY = "managed-by"[0m
[30;1m17 | [0m[35m    STACK_TAG_VALUE = "determined"[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1 | [0m[35mclass defaults:[0m
[30;1m2 | [0m[35m    AUX_AGENT_INSTANCE_TYPE = "n1-standard-4"[0m
[30;1m3 | [0m[35m    COMPUTE_AGENT_INSTANCE_TYPE = "n1-standard-32"[0m
[30;1m4 | [0m[35m    DB_PASSWORD = "postgres"[0m
[30;1m5 | [0m[35m    BOOT_DISK_SIZE = 200[0m
[30;1m6 | [0m[35m    BOOT_DISK_TYPE = "pd-standard"[0m
[30;1m7 | [0m[35m    ENVIRONMENT_IMAGE = "det-environments-0736b6d"[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m233 | [0m[35m            local_size=int(os.environ["LOCAL_WORLD_SIZE"]),[0m
[30;1m234 | [0m[35m            cross_rank=int(os.environ["GROUP_RANK"]),[0m
[30;1m235 | [0m[35m            cross_size=int(os.environ["GROUP_WORLD_SIZE"]),[0m
[30;1m236 | [0m[35m            chief_ip=chief_ip or os.environ.get("DET_CHIEF_IP"),[0m
[30;1m237 | [0m[35m        )[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m213 | [0m[35m            local_size=int(os.environ["LOCAL_SIZE"]),[0m
[30;1m214 | [0m[35m            cross_rank=int(os.environ["CROSS_RANK"]),[0m
[30;1m215 | [0m[35m            cross_size=int(os.environ["CROSS_SIZE"]),[0m
[30;1m216 | [0m[35m            chief_ip=chief_ip or os.environ.get("DET_CHIEF_IP"),[0m
[30;1m217 | [0m[35m        )[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m193 | [0m[35m            local_size=hvd.local_size(),[0m
[30;1m194 | [0m[35m            cross_rank=hvd.cross_rank(),[0m
[30;1m195 | [0m[35m            cross_size=hvd.cross_size(),[0m
[30;1m196 | [0m[35m            chief_ip=chief_ip or os.environ.get("DET_CHIEF_IP"),[0m
[30;1m197 | [0m[35m        )[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m124 | [0m[35m    ) -> None:[0m
[30;1m125 | [0m[35m        # We use an environment variable to allow users to enable custom initialization routine for[0m
[30;1m126 | [0m[35m        # distributed training since the pre_execute_hook runs before trial initialization.[0m
[30;1m127 | [0m[35m        manual_dist_init = os.environ.get("DET_MANUAL_INIT_DISTRIBUTED")[0m
[30;1m128 | [0m[35m        if not manual_dist_init:[0m
[30;1m129 | [0m[35m            # DeepSpeed's init_distributed handles situations in which only 1 gpu is used and[0m
[30;1m130 | [0m[35m            # also handles multiple calls to init in one process.[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/database/variables.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m9 | [0m[35m  type = string[0m
[30;1m10 | [0m[35m}[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mvariable "db_password" {[0m
[30;1m13 | [0m[35m  type = string[0m
[30;1m14 | [0m[35m}[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/variables.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m145 | [0m[35mvariable "labels" {[0m
[30;1m146 | [0m[35m}[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35mvariable "initial_user_password" {[0m
[30;1m149 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/variables.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35mvariable "db_username" {[0m
[30;1m101 | [0m[35m}[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mvariable "db_password" {[0m
[30;1m104 | [0m[35m}[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35mvariable "database_name" {[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/render.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35mdef _coloring_enabled() -> bool:[0m
[30;1m267 | [0m[35m    return sys.stdout.isatty() and os.environ.get("DET_CLI_COLORIZE", "").lower() in ("1", "true")[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35mdef print_json(data: Union[str, Any]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m184 | [0m[35m        if sys.platform == "win32":[0m
[30;1m185 | [0m[35m            # Convert the backslashes of the -i argument to ssh to forwardslashes.  This is[0m
[30;1m186 | [0m[35m            # important because when passing the output of ssh_show_command to VSCode, VSCode would[0m
[30;1m187 | [0m[35m            # put backslashes in .ssh/config, which would not be handled correctly by ssh.  When[0m
[30;1m188 | [0m[35m            # invoking ssh directly, it behaves the same whether -i has backslashes or not.[0m
[30;1m189 | [0m[35m            unixy_keypath = unixy_keypath.replace("\\", "/")[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    f, keypath = _prepare_key(cache_dir)[0m
[30;1m157 | [0m[35m    with f as keyfile:[0m
[30;1m158 | [0m[35m        keyfile.write(shell["privateKey"])[0m
[30;1m159 | [0m[35m        keyfile.flush()[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        # Use determined.cli.tunnel as a portable script for using the HTTP CONNECT mechanism,[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m    _open_shell([0m
[30;1m77 | [0m[35m        sess,[0m
[30;1m78 | [0m[35m        shell,[0m
[30;1m79 | [0m[35m        args.ssh_opts,[0m
[30;1m80 | [0m[35m        retain_keys_and_print=True,[0m
[30;1m81 | [0m[35m        print_only=True,[0m
[30;1m82 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m    _open_shell([0m
[30;1m57 | [0m[35m        sess,[0m
[30;1m58 | [0m[35m        shell,[0m
[30;1m59 | [0m[35m        args.ssh_opts,[0m
[30;1m60 | [0m[35m        retain_keys_and_print=args.show_ssh_command,[0m
[30;1m61 | [0m[35m        print_only=False,[0m
[30;1m62 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35m    _open_shell([0m
[30;1m44 | [0m[35m        sess,[0m
[30;1m45 | [0m[35m        shell.to_json(),[0m
[30;1m46 | [0m[35m        args.ssh_opts,[0m
[30;1m47 | [0m[35m        retain_keys_and_print=args.show_ssh_command,[0m
[30;1m48 | [0m[35m        print_only=False,[0m
[30;1m49 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m272 | [0m[35m            cli.Arg([0m
[30;1m273 | [0m[35m                "--remote",[0m
[30;1m274 | [0m[35m                action="store_true",[0m
[30;1m275 | [0m[35m                help="disallow using passwords, user must use the configured external IdP",[0m
[30;1m276 | [0m[35m            ),[0m
[30;1m277 | [0m[35m        ]),[0m
[30;1m278 | [0m[35m        cli.Cmd("link-with-agent-user", link_with_agent_user, "link a user with UID/GID on agent", [[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m268 | [0m[35m        cli.Cmd("create", create_user, "create user", [[0m
[30;1m269 | [0m[35m            cli.Arg("username", help="name of new user"),[0m
[30;1m270 | [0m[35m            cli.Arg("--admin", action="store_true", help="give new user admin rights"),[0m
[30;1m271 | [0m[35m            cli.Arg("--password", help="password of new user"),[0m
[30;1m272 | [0m[35m            cli.Arg([0m
[30;1m273 | [0m[35m                "--remote",[0m
[30;1m274 | [0m[35m                action="store_true",[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m268 | [0m[35m        cli.Cmd("create", create_user, "create user", [[0m
[30;1m269 | [0m[35m            cli.Arg("username", help="name of new user"),[0m
[30;1m270 | [0m[35m            cli.Arg("--admin", action="store_true", help="give new user admin rights"),[0m
[30;1m271 | [0m[35m            cli.Arg("--password", help="password of new user"),[0m
[30;1m272 | [0m[35m            cli.Arg([0m
[30;1m273 | [0m[35m                "--remote",[0m
[30;1m274 | [0m[35m                action="store_true",[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m248 | [0m[35m        ], deprecation_message="Please use 'det user edit <target_user> --username <username>'"),[0m
[30;1m249 | [0m[35m        cli.Cmd("change-password", change_password, "change password for user", [[0m
[30;1m250 | [0m[35m            cli.Arg([0m
[30;1m251 | [0m[35m                "target_user", nargs="?", default=None, help="name of user to change password of"[0m
[30;1m252 | [0m[35m            )[0m
[30;1m253 | [0m[35m        ]),[0m
[30;1m254 | [0m[35m        cli.Cmd("logout", log_out_user, "log out user", [[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m246 | [0m[35m            ),[0m
[30;1m247 | [0m[35m            cli.Arg("new_username", default=None, help="new username for target_user"),[0m
[30;1m248 | [0m[35m        ], deprecation_message="Please use 'det user edit <target_user> --username <username>'"),[0m
[30;1m249 | [0m[35m        cli.Cmd("change-password", change_password, "change password for user", [[0m
[30;1m250 | [0m[35m            cli.Arg([0m
[30;1m251 | [0m[35m                "target_user", nargs="?", default=None, help="name of user to change password of"[0m
[30;1m252 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m246 | [0m[35m            ),[0m
[30;1m247 | [0m[35m            cli.Arg("new_username", default=None, help="new username for target_user"),[0m
[30;1m248 | [0m[35m        ], deprecation_message="Please use 'det user edit <target_user> --username <username>'"),[0m
[30;1m249 | [0m[35m        cli.Cmd("change-password", change_password, "change password for user", [[0m
[30;1m250 | [0m[35m            cli.Arg([0m
[30;1m251 | [0m[35m                "target_user", nargs="?", default=None, help="name of user to change password of"[0m
[30;1m252 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m246 | [0m[35m            ),[0m
[30;1m247 | [0m[35m            cli.Arg("new_username", default=None, help="new username for target_user"),[0m
[30;1m248 | [0m[35m        ], deprecation_message="Please use 'det user edit <target_user> --username <username>'"),[0m
[30;1m249 | [0m[35m        cli.Cmd("change-password", change_password, "change password for user", [[0m
[30;1m250 | [0m[35m            cli.Arg([0m
[30;1m251 | [0m[35m                "target_user", nargs="?", default=None, help="name of user to change password of"[0m
[30;1m252 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    d.create_user(username=username, admin=admin, password=password, remote=remote)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35mdef whoami(args: argparse.Namespace) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    d.create_user(username=username, admin=admin, password=password, remote=remote)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35mdef whoami(args: argparse.Namespace) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m
[30;1m174 | [0m[35m        check_password = getpass.getpass("Confirm password: ")[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    d.create_user(username=username, admin=admin, password=password, remote=remote)[0m
[30;1m179 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m
[30;1m174 | [0m[35m        check_password = getpass.getpass("Confirm password: ")[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    d.create_user(username=username, admin=admin, password=password, remote=remote)[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m
[30;1m174 | [0m[35m        check_password = getpass.getpass("Confirm password: ")[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    d.create_user(username=username, admin=admin, password=password, remote=remote)[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m
[30;1m174 | [0m[35m        check_password = getpass.getpass("Confirm password: ")[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m
[30;1m177 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m
[30;1m174 | [0m[35m        check_password = getpass.getpass("Confirm password: ")[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m
[30;1m177 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m170 | [0m[35m    password = args.password[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m
[30;1m174 | [0m[35m        check_password = getpass.getpass("Confirm password: ")[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m170 | [0m[35m    password = args.password[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m
[30;1m174 | [0m[35m        check_password = getpass.getpass("Confirm password: ")[0m
[30;1m175 | [0m[35m        if password != check_password:[0m
[30;1m176 | [0m[35m            raise errors.CliError("Passwords do not match")[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m169 | [0m[35m    remote = bool(args.remote)[0m
[30;1m170 | [0m[35m    password = args.password[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m
[30;1m174 | [0m[35m        check_password = getpass.getpass("Confirm password: ")[0m
[30;1m175 | [0m[35m        if password != check_password:[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m167 | [0m[35m    username = args.username[0m
[30;1m168 | [0m[35m    admin = bool(args.admin)[0m
[30;1m169 | [0m[35m    remote = bool(args.remote)[0m
[30;1m170 | [0m[35m    password = args.password[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m167 | [0m[35m    username = args.username[0m
[30;1m168 | [0m[35m    admin = bool(args.admin)[0m
[30;1m169 | [0m[35m    remote = bool(args.remote)[0m
[30;1m170 | [0m[35m    password = args.password[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if not remote and not password:[0m
[30;1m173 | [0m[35m        password = getpass.getpass("Password for user '{}': ".format(username))[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m135 | [0m[35m    # password change so that the user doesn't have to do so manually.[0m
[30;1m136 | [0m[35m    if args.target_user is None:[0m
[30;1m137 | [0m[35m        token_store = authentication.TokenStore(args.master)[0m
[30;1m138 | [0m[35m        sess = authentication.login(args.master, username, password, cli.cert)[0m
[30;1m139 | [0m[35m        token_store.set_token(sess.username, sess.token)[0m
[30;1m140 | [0m[35m        token_store.set_active(sess.username)[0m
[30;1m141 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m132 | [0m[35m    user_obj.change_password(new_password=password)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    # If the target user's password isn't being changed by another user, reauthenticate after[0m
[30;1m135 | [0m[35m    # password change so that the user doesn't have to do so manually.[0m
[30;1m136 | [0m[35m    if args.target_user is None:[0m
[30;1m137 | [0m[35m        token_store = authentication.TokenStore(args.master)[0m
[30;1m138 | [0m[35m        sess = authentication.login(args.master, username, password, cli.cert)[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m    user_obj = d.get_user_by_name(username)[0m
[30;1m132 | [0m[35m    user_obj.change_password(new_password=password)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    # If the target user's password isn't being changed by another user, reauthenticate after[0m
[30;1m135 | [0m[35m    # password change so that the user doesn't have to do so manually.[0m
[30;1m136 | [0m[35m    if args.target_user is None:[0m
[30;1m137 | [0m[35m        token_store = authentication.TokenStore(args.master)[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        raise errors.CliError("Passwords do not match")[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    user_obj = d.get_user_by_name(username)[0m
[30;1m132 | [0m[35m    user_obj.change_password(new_password=password)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    # If the target user's password isn't being changed by another user, reauthenticate after[0m
[30;1m135 | [0m[35m    # password change so that the user doesn't have to do so manually.[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        raise errors.CliError("Passwords do not match")[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    user_obj = d.get_user_by_name(username)[0m
[30;1m132 | [0m[35m    user_obj.change_password(new_password=password)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    # If the target user's password isn't being changed by another user, reauthenticate after[0m
[30;1m135 | [0m[35m    # password change so that the user doesn't have to do so manually.[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        raise errors.CliError("Passwords do not match")[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    user_obj = d.get_user_by_name(username)[0m
[30;1m132 | [0m[35m    user_obj.change_password(new_password=password)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    # If the target user's password isn't being changed by another user, reauthenticate after[0m
[30;1m135 | [0m[35m    # password change so that the user doesn't have to do so manually.[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m    check_password = getpass.getpass("Confirm password: ")[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    if password != check_password:[0m
[30;1m129 | [0m[35m        raise errors.CliError("Passwords do not match")[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    user_obj = d.get_user_by_name(username)[0m
[30;1m132 | [0m[35m    user_obj.change_password(new_password=password)[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m    password = getpass.getpass("New password for user '{}': ".format(username))[0m
[30;1m126 | [0m[35m    check_password = getpass.getpass("Confirm password: ")[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    if password != check_password:[0m
[30;1m129 | [0m[35m        raise errors.CliError("Passwords do not match")[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    user_obj = d.get_user_by_name(username)[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m    password = getpass.getpass("New password for user '{}': ".format(username))[0m
[30;1m126 | [0m[35m    check_password = getpass.getpass("Confirm password: ")[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    if password != check_password:[0m
[30;1m129 | [0m[35m        raise errors.CliError("Passwords do not match")[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    user_obj = d.get_user_by_name(username)[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m123 | [0m[35m        raise errors.CliError("Please log in as an admin or user to change passwords")[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    password = getpass.getpass("New password for user '{}': ".format(username))[0m
[30;1m126 | [0m[35m    check_password = getpass.getpass("Confirm password: ")[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    if password != check_password:[0m
[30;1m129 | [0m[35m        raise errors.CliError("Passwords do not match")[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m123 | [0m[35m        raise errors.CliError("Please log in as an admin or user to change passwords")[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    password = getpass.getpass("New password for user '{}': ".format(username))[0m
[30;1m126 | [0m[35m    check_password = getpass.getpass("Confirm password: ")[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    if password != check_password:[0m
[30;1m129 | [0m[35m        raise errors.CliError("Passwords do not match")[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m        # The default user should have been set by now by autologin.[0m
[30;1m123 | [0m[35m        raise errors.CliError("Please log in as an admin or user to change passwords")[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    password = getpass.getpass("New password for user '{}': ".format(username))[0m
[30;1m126 | [0m[35m    check_password = getpass.getpass("Confirm password: ")[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    if password != check_password:[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m        # The default user should have been set by now by autologin.[0m
[30;1m123 | [0m[35m        raise errors.CliError("Please log in as an admin or user to change passwords")[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    password = getpass.getpass("New password for user '{}': ".format(username))[0m
[30;1m126 | [0m[35m    check_password = getpass.getpass("Confirm password: ")[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    if password != check_password:[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    if not username:[0m
[30;1m122 | [0m[35m        # The default user should have been set by now by autologin.[0m
[30;1m123 | [0m[35m        raise errors.CliError("Please log in as an admin or user to change passwords")[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    password = getpass.getpass("New password for user '{}': ".format(username))[0m
[30;1m126 | [0m[35m    check_password = getpass.getpass("Confirm password: ")[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m    user_obj.rename(new_username=args.new_username)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35mdef change_password(args: argparse.Namespace) -> None:[0m
[30;1m112 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m113 | [0m[35m    d = client.Determined._from_session(sess)[0m
[30;1m114 | [0m[35m    if args.target_user:[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m81 | [0m[35m        raise api.errors.InvalidCredentialsException()[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    try:[0m
[30;1m84 | [0m[35m        authentication.check_password_complexity(password)[0m
[30;1m85 | [0m[35m    except ValueError as e:[0m
[30;1m86 | [0m[35m        authentication.warn_about_complexity(e)[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m81 | [0m[35m        raise api.errors.InvalidCredentialsException()[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    try:[0m
[30;1m84 | [0m[35m        authentication.check_password_complexity(password)[0m
[30;1m85 | [0m[35m    except ValueError as e:[0m
[30;1m86 | [0m[35m        authentication.warn_about_complexity(e)[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    token_store = authentication.TokenStore(args.master)[0m
[30;1m78 | [0m[35m    try:[0m
[30;1m79 | [0m[35m        sess = authentication.login(args.master, username, password, cli.cert)[0m
[30;1m80 | [0m[35m    except api.errors.UnauthenticatedException:[0m
[30;1m81 | [0m[35m        raise api.errors.InvalidCredentialsException()[0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m72 | [0m[35m        username = args.username[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    message = "Password for user '{}': ".format(username)[0m
[30;1m75 | [0m[35m    password = getpass.getpass(message)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    token_store = authentication.TokenStore(args.master)[0m
[30;1m78 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m71 | [0m[35m    else:[0m
[30;1m72 | [0m[35m        username = args.username[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    message = "Password for user '{}': ".format(username)[0m
[30;1m75 | [0m[35m    password = getpass.getpass(message)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    token_store = authentication.TokenStore(args.master)[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/deployment_types/secure.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m            self.master_info,[0m
[30;1m76 | [0m[35m            self.ui_info,[0m
[30;1m77 | [0m[35m            self.logs_info,[0m
[30;1m78 | [0m[35m            self.ssh_info,[0m
[30;1m79 | [0m[35m        )[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def wait_for_master(self, timeout: int = 0) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/deployment_types/base.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m            self.master_info,[0m
[30;1m127 | [0m[35m            self.ui_info,[0m
[30;1m128 | [0m[35m            self.logs_info,[0m
[30;1m129 | [0m[35m            self.ssh_info,[0m
[30;1m130 | [0m[35m        )[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    def print_output_info(self, **kwargs: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/deployment_types/base.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m    constants.cloudformation.NOTEBOOK_TIMEOUT,[0m
[30;1m46 | [0m[35m    constants.cloudformation.GENAI_VERSION,[0m
[30;1m47 | [0m[35m    constants.cloudformation.GENAI_SHARED_FS_MOUNT_PATH,[0m
[30;1m48 | [0m[35m    constants.cloudformation.INITIAL_USER_PASSWORD,[0m
[30;1m49 | [0m[35m]  # type: List[str][0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/deployment_types/base.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m    constants.cloudformation.COMPUTE_AGENT_INSTANCE_TYPE,[0m
[30;1m23 | [0m[35m    constants.cloudformation.INBOUND_CIDR,[0m
[30;1m24 | [0m[35m    constants.cloudformation.VERSION,[0m
[30;1m25 | [0m[35m    constants.cloudformation.DB_PASSWORD,[0m
[30;1m26 | [0m[35m    constants.cloudformation.MAX_IDLE_AGENT_PERIOD,[0m
[30;1m27 | [0m[35m    constants.cloudformation.MAX_AGENT_STARTING_PERIOD,[0m
[30;1m28 | [0m[35m    constants.cloudformation.MAX_AUX_CONTAINERS_PER_AGENT,[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m    if data is not None:[0m
[30;1m449 | [0m[35m        message_bytes = json.dumps(data).encode("utf-8")[0m
[30;1m450 | [0m[35m        base64_bytes = base64.b64encode(message_bytes)[0m
[30;1m451 | [0m[35m        body["data"] = base64_bytes[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    if preview:[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m"""Shared CLI interface for NTSCs (notebooks, tensorboards, shells, and commands)."""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport argparse[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport collections[0m
[30;1m6 | [0m[35mimport functools[0m
[30;1m7 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m473 | [0m[35m        else "/tensorboard/{}/events?tail=1".format(task_id)[0m
[30;1m474 | [0m[35m    )[0m
[30;1m475 | [0m[35m    wait_path_url = service_address + wait_path[0m
[30;1m476 | [0m[35m    public_url = os.environ.get("PUBLIC_URL", "/det")[0m
[30;1m477 | [0m[35m    wait_page_url = "{}/wait/{}/{}?eventUrl={}&serviceAddr={}".format([0m
[30;1m478 | [0m[35m        public_url, task_type, task_id, wait_path_url, service_address[0m
[30;1m479 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m698 | [0m[35m              scheme=https[0m
[30;1m699 | [0m[35m              port=8443[0m
[30;1m700 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m701 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m702 | [0m[35m            fi[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m697 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m698 | [0m[35m              scheme=https[0m
[30;1m699 | [0m[35m              port=8443[0m
[30;1m700 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m701 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m702 | [0m[35m            fi[0m
[30;1m703 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m668 | [0m[35m            VolumeSize: 200[0m
[30;1m669 | [0m[35m            VolumeType: gp2[0m
[30;1m670 | [0m[35m      UserData:[0m
[30;1m671 | [0m[35m        Fn::Base64: !Sub[0m
[30;1m672 | [0m[35m          - |[0m
[30;1m673 | [0m[35m            Content-Type: multipart/mixed; boundary="//"[0m
[30;1m674 | [0m[35m            MIME-Version: 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m  MasterTLSKey:[0m
[30;1m152 | [0m[35m    Type: String[0m
[30;1m153 | [0m[35m    Description: Base64-encoded TLS key for the master[0m
[30;1m154 | [0m[35m    Default: ""[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m  MasterCertName:[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m  MasterTLSCert:[0m
[30;1m147 | [0m[35m    Type: String[0m
[30;1m148 | [0m[35m    Description: Base64-encoded TLS certificate for the master[0m
[30;1m149 | [0m[35m    Default: ""[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m  MasterTLSKey:[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m790 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m793 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m794 | [0m[35m            fi[0m
[30;1m795 | [0m[35m[0m
[30;1m796 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m770 | [0m[35m            notebook_timeout: ${NotebookTimeout}[0m
[30;1m771 | [0m[35m            [0m
[30;1m772 | [0m[35m            security:[0m
[30;1m773 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m774 | [0m[35m            EOF[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m770 | [0m[35m            notebook_timeout: ${NotebookTimeout}[0m
[30;1m771 | [0m[35m            [0m
[30;1m772 | [0m[35m            security:[0m
[30;1m773 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m774 | [0m[35m            EOF[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m761 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m762 | [0m[35m                startup_script: |[0m
[30;1m763 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m764 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m765 | [0m[35m                  fi[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m710 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m            db:[0m
[30;1m713 | [0m[35m              password: "${DBPassword}"[0m
[30;1m714 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m715 | [0m[35m              name: postgres[0m
[30;1m716 | [0m[35m              ssl_mode: require[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m710 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m            db:[0m
[30;1m713 | [0m[35m              password: "${DBPassword}"[0m
[30;1m714 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m715 | [0m[35m              name: postgres[0m
[30;1m716 | [0m[35m              ssl_mode: require[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m496 | [0m[35m      MasterUsername:[0m
[30;1m497 | [0m[35m        !If [NoDBSnapshot, "postgres", !Ref "AWS::NoValue"][0m
[30;1m498 | [0m[35m      MasterUserPassword:[0m
[30;1m499 | [0m[35m        !If [NoDBSnapshot, !Ref DBPassword, !Ref "AWS::NoValue"][0m
[30;1m500 | [0m[35m      Tags:[0m
[30;1m501 | [0m[35m        - Key: user[0m
[30;1m502 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m495 | [0m[35m      Engine: postgres[0m
[30;1m496 | [0m[35m      MasterUsername:[0m
[30;1m497 | [0m[35m        !If [NoDBSnapshot, "postgres", !Ref "AWS::NoValue"][0m
[30;1m498 | [0m[35m      MasterUserPassword:[0m
[30;1m499 | [0m[35m        !If [NoDBSnapshot, !Ref DBPassword, !Ref "AWS::NoValue"][0m
[30;1m500 | [0m[35m      Tags:[0m
[30;1m501 | [0m[35m        - Key: user[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m      security:[0m
[30;1m298 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m299 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m300 | [0m[35m        tls:[0m
[30;1m301 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m      security:[0m
[30;1m298 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m299 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m300 | [0m[35m        tls:[0m
[30;1m301 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m      db:[0m
[30;1m252 | [0m[35m        user: postgres[0m
[30;1m253 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m254 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m255 | [0m[35m        port: 5432[0m
[30;1m256 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m      db:[0m
[30;1m252 | [0m[35m        user: postgres[0m
[30;1m253 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m254 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m255 | [0m[35m        port: 5432[0m
[30;1m256 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m  InitialUserPassword:[0m
[30;1m234 | [0m[35m    Type: String[0m
[30;1m235 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m236 | [0m[35m    Default: ""[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m  MasterConfigTemplate:[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m230 | [0m[35m    Description: Specifies the duration in seconds before idle notebook instances are automatically [0m
[30;1m231 | [0m[35m    Default: 0[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m  InitialUserPassword:[0m
[30;1m234 | [0m[35m    Type: String[0m
[30;1m235 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m236 | [0m[35m    Default: ""[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m  DBPassword:[0m
[30;1m99 | [0m[35m    Type: String[0m
[30;1m100 | [0m[35m    Description: Password for database (eg. "postgres")[0m
[30;1m101 | [0m[35m    NoEcho: true[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m  DBInstanceType:[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m    Type: String[0m
[30;1m96 | [0m[35m    Description: Determined version or commit for master docker image[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m  DBPassword:[0m
[30;1m99 | [0m[35m    Type: String[0m
[30;1m100 | [0m[35m    Description: Password for database (eg. "postgres")[0m
[30;1m101 | [0m[35m    NoEcho: true[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  DockerPass:[0m
[30;1m89 | [0m[35m    Type: String[0m
[30;1m90 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m91 | [0m[35m    Default: ""[0m
[30;1m92 | [0m[35m    NoEcho: true[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/cli/_util.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m    return authentication.login_with_cache([0m
[30;1m99 | [0m[35m        master_address=master_url,[0m
[30;1m100 | [0m[35m        requested_user=args.user,[0m
[30;1m101 | [0m[35m        password=None,[0m
[30;1m102 | [0m[35m        cert=cli.cert,[0m
[30;1m103 | [0m[35m    )[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m849 | [0m[35m              scheme=https[0m
[30;1m850 | [0m[35m              port=8443[0m
[30;1m851 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m852 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m853 | [0m[35m            fi[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m848 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m849 | [0m[35m              scheme=https[0m
[30;1m850 | [0m[35m              port=8443[0m
[30;1m851 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m852 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m853 | [0m[35m            fi[0m
[30;1m854 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m819 | [0m[35m            VolumeSize: 200[0m
[30;1m820 | [0m[35m            VolumeType: gp2[0m
[30;1m821 | [0m[35m      UserData:[0m
[30;1m822 | [0m[35m        Fn::Base64: !Sub[0m
[30;1m823 | [0m[35m          - |[0m
[30;1m824 | [0m[35m            Content-Type: multipart/mixed; boundary="//"[0m
[30;1m825 | [0m[35m            MIME-Version: 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m  MasterTLSKey:[0m
[30;1m180 | [0m[35m    Type: String[0m
[30;1m181 | [0m[35m    Description: Base64-encoded TLS key for the master[0m
[30;1m182 | [0m[35m    Default: ""[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m  MasterCertName:[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m  MasterTLSCert:[0m
[30;1m175 | [0m[35m    Type: String[0m
[30;1m176 | [0m[35m    Description: Base64-encoded TLS certificate for the master[0m
[30;1m177 | [0m[35m    Default: ""[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m  MasterTLSKey:[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m940 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m943 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m944 | [0m[35m            fi[0m
[30;1m945 | [0m[35m[0m
[30;1m946 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m917 | [0m[35m            notebook_timeout: ${NotebookTimeout}[0m
[30;1m918 | [0m[35m            [0m
[30;1m919 | [0m[35m            security:[0m
[30;1m920 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m921 | [0m[35m            EOF[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m917 | [0m[35m            notebook_timeout: ${NotebookTimeout}[0m
[30;1m918 | [0m[35m            [0m
[30;1m919 | [0m[35m            security:[0m
[30;1m920 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m921 | [0m[35m            EOF[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m908 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m909 | [0m[35m                startup_script: |[0m
[30;1m910 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m911 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m912 | [0m[35m                  fi[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m861 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m862 | [0m[35m[0m
[30;1m863 | [0m[35m            db:[0m
[30;1m864 | [0m[35m              password: "${DBPassword}"[0m
[30;1m865 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m866 | [0m[35m              name: determined[0m
[30;1m867 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m861 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m862 | [0m[35m[0m
[30;1m863 | [0m[35m            db:[0m
[30;1m864 | [0m[35m              password: "${DBPassword}"[0m
[30;1m865 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m866 | [0m[35m              name: determined[0m
[30;1m867 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m637 | [0m[35m      DatabaseName: determined[0m
[30;1m638 | [0m[35m      DBSubnetGroupName: !Ref DatabaseSubnetGroup[0m
[30;1m639 | [0m[35m      MasterUsername: postgres[0m
[30;1m640 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m641 | [0m[35m      Tags:[0m
[30;1m642 | [0m[35m        - Key: user[0m
[30;1m643 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m637 | [0m[35m      DatabaseName: determined[0m
[30;1m638 | [0m[35m      DBSubnetGroupName: !Ref DatabaseSubnetGroup[0m
[30;1m639 | [0m[35m      MasterUsername: postgres[0m
[30;1m640 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m641 | [0m[35m      Tags:[0m
[30;1m642 | [0m[35m        - Key: user[0m
[30;1m643 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m      security:[0m
[30;1m289 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m290 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m291 | [0m[35m        tls:[0m
[30;1m292 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m      security:[0m
[30;1m289 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m290 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m291 | [0m[35m        tls:[0m
[30;1m292 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m      db:[0m
[30;1m243 | [0m[35m        user: postgres[0m
[30;1m244 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m245 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m246 | [0m[35m        port: 5432[0m
[30;1m247 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m      db:[0m
[30;1m243 | [0m[35m        user: postgres[0m
[30;1m244 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m245 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m246 | [0m[35m        port: 5432[0m
[30;1m247 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m  InitialUserPassword:[0m
[30;1m225 | [0m[35m    Type: String[0m
[30;1m226 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m227 | [0m[35m    Default: ""[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m  MasterConfigTemplate:[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m221 | [0m[35m    Description: Specifies the duration in seconds before idle notebook instances are automatically [0m
[30;1m222 | [0m[35m    Default: 0[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m  InitialUserPassword:[0m
[30;1m225 | [0m[35m    Type: String[0m
[30;1m226 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m227 | [0m[35m    Default: ""[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m  DBPassword:[0m
[30;1m128 | [0m[35m    Type: String[0m
[30;1m129 | [0m[35m    Description: Password for database[0m
[30;1m130 | [0m[35m    NoEcho: true[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m  MaxAuxContainersPerAgent:[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m    Type: String[0m
[30;1m125 | [0m[35m    Description: Determined version or commit for master image[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m  DBPassword:[0m
[30;1m128 | [0m[35m    Type: String[0m
[30;1m129 | [0m[35m    Description: Password for database[0m
[30;1m130 | [0m[35m    NoEcho: true[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m  DockerPass:[0m
[30;1m118 | [0m[35m    Type: String[0m
[30;1m119 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m120 | [0m[35m    Default: ""[0m
[30;1m121 | [0m[35m    NoEcho: true[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m835 | [0m[35m              scheme=https[0m
[30;1m836 | [0m[35m              port=8443[0m
[30;1m837 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m838 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m839 | [0m[35m            fi[0m
[30;1m840 | [0m[35m[0m
[30;1m841 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m834 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m835 | [0m[35m              scheme=https[0m
[30;1m836 | [0m[35m              port=8443[0m
[30;1m837 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m838 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m839 | [0m[35m            fi[0m
[30;1m840 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m805 | [0m[35m            VolumeSize: 200[0m
[30;1m806 | [0m[35m            VolumeType: gp2[0m
[30;1m807 | [0m[35m      UserData:[0m
[30;1m808 | [0m[35m        Fn::Base64: !Sub[0m
[30;1m809 | [0m[35m          - |[0m
[30;1m810 | [0m[35m            Content-Type: multipart/mixed; boundary="//"[0m
[30;1m811 | [0m[35m            MIME-Version: 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m  MasterTLSKey:[0m
[30;1m159 | [0m[35m    Type: String[0m
[30;1m160 | [0m[35m    Description: Base64-encoded TLS key for the master[0m
[30;1m161 | [0m[35m    Default: ""[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m  MasterCertName:[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m  MasterTLSCert:[0m
[30;1m154 | [0m[35m    Type: String[0m
[30;1m155 | [0m[35m    Description: Base64-encoded TLS certificate for the master[0m
[30;1m156 | [0m[35m    Default: ""[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m  MasterTLSKey:[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m936 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m937 | [0m[35m[0m
[30;1m938 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m939 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m940 | [0m[35m            fi[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m913 | [0m[35m                container_path: /run/determined/workdir/shared_fs[0m
[30;1m914 | [0m[35m[0m
[30;1m915 | [0m[35m            security:[0m
[30;1m916 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m917 | [0m[35m            EOF[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m913 | [0m[35m                container_path: /run/determined/workdir/shared_fs[0m
[30;1m914 | [0m[35m[0m
[30;1m915 | [0m[35m            security:[0m
[30;1m916 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m917 | [0m[35m            EOF[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m900 | [0m[35m                  mkdir -p /mnt/efs[0m
[30;1m901 | [0m[35m                  mount -t efs ${EFSVal}:/ /mnt/efs[0m
[30;1m902 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m903 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m904 | [0m[35m                  fi[0m
[30;1m905 | [0m[35m[0m
[30;1m906 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m847 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m848 | [0m[35m[0m
[30;1m849 | [0m[35m            db:[0m
[30;1m850 | [0m[35m              password: "${DBPassword}"[0m
[30;1m851 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m852 | [0m[35m              name: determined[0m
[30;1m853 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m847 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m848 | [0m[35m[0m
[30;1m849 | [0m[35m            db:[0m
[30;1m850 | [0m[35m              password: "${DBPassword}"[0m
[30;1m851 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m852 | [0m[35m              name: determined[0m
[30;1m853 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m619 | [0m[35m      DatabaseName: determined[0m
[30;1m620 | [0m[35m      DBSubnetGroupName: !Ref DatabaseSubnetGroup[0m
[30;1m621 | [0m[35m      MasterUsername: postgres[0m
[30;1m622 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m623 | [0m[35m      Tags:[0m
[30;1m624 | [0m[35m        - Key: user[0m
[30;1m625 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m619 | [0m[35m      DatabaseName: determined[0m
[30;1m620 | [0m[35m      DBSubnetGroupName: !Ref DatabaseSubnetGroup[0m
[30;1m621 | [0m[35m      MasterUsername: postgres[0m
[30;1m622 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m623 | [0m[35m      Tags:[0m
[30;1m624 | [0m[35m        - Key: user[0m
[30;1m625 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m      security:[0m
[30;1m293 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m294 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m295 | [0m[35m        tls:[0m
[30;1m296 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m      security:[0m
[30;1m293 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m294 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m295 | [0m[35m        tls:[0m
[30;1m296 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m      db:[0m
[30;1m247 | [0m[35m        user: postgres[0m
[30;1m248 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m249 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m250 | [0m[35m        port: 5432[0m
[30;1m251 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m      db:[0m
[30;1m247 | [0m[35m        user: postgres[0m
[30;1m248 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m249 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m250 | [0m[35m        port: 5432[0m
[30;1m251 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m  InitialUserPassword:[0m
[30;1m229 | [0m[35m    Type: String[0m
[30;1m230 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m231 | [0m[35m    Default: ""[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m  MasterConfigTemplate:[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m225 | [0m[35m    Description: preexisting EFS ID to mount[0m
[30;1m226 | [0m[35m    Default: ""[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m  InitialUserPassword:[0m
[30;1m229 | [0m[35m    Type: String[0m
[30;1m230 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m231 | [0m[35m    Default: ""[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m  DBPassword:[0m
[30;1m107 | [0m[35m    Type: String[0m
[30;1m108 | [0m[35m    Description: Password for database[0m
[30;1m109 | [0m[35m    NoEcho: true[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m  MaxAuxContainersPerAgent:[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m    Type: String[0m
[30;1m104 | [0m[35m    Description: Determined version or commit for master image[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m  DBPassword:[0m
[30;1m107 | [0m[35m    Type: String[0m
[30;1m108 | [0m[35m    Description: Password for database[0m
[30;1m109 | [0m[35m    NoEcho: true[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m
[30;1m97 | [0m[35m    Type: String[0m
[30;1m98 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m99 | [0m[35m    Default: ""[0m
[30;1m100 | [0m[35m    NoEcho: true[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m645 | [0m[35m              scheme=https[0m
[30;1m646 | [0m[35m              port=8443[0m
[30;1m647 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m648 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m649 | [0m[35m            fi[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m644 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m645 | [0m[35m              scheme=https[0m
[30;1m646 | [0m[35m              port=8443[0m
[30;1m647 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m648 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m649 | [0m[35m            fi[0m
[30;1m650 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m615 | [0m[35m            VolumeSize: 200[0m
[30;1m616 | [0m[35m            VolumeType: gp2[0m
[30;1m617 | [0m[35m      UserData:[0m
[30;1m618 | [0m[35m        Fn::Base64: !Sub[0m
[30;1m619 | [0m[35m          - |[0m
[30;1m620 | [0m[35m            Content-Type: multipart/mixed; boundary="//"[0m
[30;1m621 | [0m[35m            MIME-Version: 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m  MasterTLSKey:[0m
[30;1m113 | [0m[35m    Type: String[0m
[30;1m114 | [0m[35m    Description: Base64-encoded TLS key for the master[0m
[30;1m115 | [0m[35m    Default: ""[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m  MasterCertName:[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m  MasterTLSCert:[0m
[30;1m108 | [0m[35m    Type: String[0m
[30;1m109 | [0m[35m    Description: Base64-encoded TLS certificate for the master[0m
[30;1m110 | [0m[35m    Default: ""[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m  MasterTLSKey:[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m736 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m739 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m740 | [0m[35m            fi[0m
[30;1m741 | [0m[35m[0m
[30;1m742 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m713 | [0m[35m            notebook_timeout: ${NotebookTimeout}[0m
[30;1m714 | [0m[35m            [0m
[30;1m715 | [0m[35m            security:[0m
[30;1m716 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m717 | [0m[35m            EOF[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m713 | [0m[35m            notebook_timeout: ${NotebookTimeout}[0m
[30;1m714 | [0m[35m            [0m
[30;1m715 | [0m[35m            security:[0m
[30;1m716 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m717 | [0m[35m            EOF[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m704 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m705 | [0m[35m                startup_script: |[0m
[30;1m706 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m707 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m708 | [0m[35m                  fi[0m
[30;1m709 | [0m[35m[0m
[30;1m710 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m657 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m658 | [0m[35m[0m
[30;1m659 | [0m[35m            db:[0m
[30;1m660 | [0m[35m              password: "${DBPassword}"[0m
[30;1m661 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m662 | [0m[35m              name: determined[0m
[30;1m663 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m657 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m658 | [0m[35m[0m
[30;1m659 | [0m[35m            db:[0m
[30;1m660 | [0m[35m              password: "${DBPassword}"[0m
[30;1m661 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m662 | [0m[35m              name: determined[0m
[30;1m663 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m443 | [0m[35m      DatabaseName: determined[0m
[30;1m444 | [0m[35m      DBClusterParameterGroupName: 'default.aurora-postgresql11'[0m
[30;1m445 | [0m[35m      MasterUsername: postgres[0m
[30;1m446 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m447 | [0m[35m      Tags:[0m
[30;1m448 | [0m[35m        - Key: user[0m
[30;1m449 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m443 | [0m[35m      DatabaseName: determined[0m
[30;1m444 | [0m[35m      DBClusterParameterGroupName: 'default.aurora-postgresql11'[0m
[30;1m445 | [0m[35m      MasterUsername: postgres[0m
[30;1m446 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m447 | [0m[35m      Tags:[0m
[30;1m448 | [0m[35m        - Key: user[0m
[30;1m449 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m      security:[0m
[30;1m239 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m240 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m241 | [0m[35m        tls:[0m
[30;1m242 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m      security:[0m
[30;1m239 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m240 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m241 | [0m[35m        tls:[0m
[30;1m242 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m      db:[0m
[30;1m193 | [0m[35m        user: postgres[0m
[30;1m194 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m195 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m196 | [0m[35m        port: 5432[0m
[30;1m197 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m      db:[0m
[30;1m193 | [0m[35m        user: postgres[0m
[30;1m194 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m195 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m196 | [0m[35m        port: 5432[0m
[30;1m197 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m  InitialUserPassword:[0m
[30;1m175 | [0m[35m    Type: String[0m
[30;1m176 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m177 | [0m[35m    Default: ""[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m  MasterConfigTemplate:[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m171 | [0m[35m    Description: Specifies the duration in seconds before idle notebook instances are automatically [0m
[30;1m172 | [0m[35m    Default: 0[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m  InitialUserPassword:[0m
[30;1m175 | [0m[35m    Type: String[0m
[30;1m176 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m177 | [0m[35m    Default: ""[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m  DBPassword:[0m
[30;1m73 | [0m[35m    Type: String[0m
[30;1m74 | [0m[35m    Description: Password for database (eg. "postgres")[0m
[30;1m75 | [0m[35m    NoEcho: true[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m  MaxAuxContainersPerAgent:[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35m    Type: String[0m
[30;1m70 | [0m[35m    Description: Determined version or commit for master docker image[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m  DBPassword:[0m
[30;1m73 | [0m[35m    Type: String[0m
[30;1m74 | [0m[35m    Description: Password for database (eg. "postgres")[0m
[30;1m75 | [0m[35m    NoEcho: true[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m  DockerPass:[0m
[30;1m63 | [0m[35m    Type: String[0m
[30;1m64 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m65 | [0m[35m    Default: ""[0m
[30;1m66 | [0m[35m    NoEcho: true[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/variables.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m251 | [0m[35m  default = "postgres"[0m
[30;1m252 | [0m[35m}[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35mvariable "db_password" {[0m
[30;1m255 | [0m[35m  type = string[0m
[30;1m256 | [0m[35m  default = "postgres"[0m
[30;1m257 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/gcp/terraform/variables.tf[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m227 | [0m[35m  default = ""[0m
[30;1m228 | [0m[35m}[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35mvariable "initial_user_password" {[0m
[30;1m231 | [0m[35m  type = string[0m
[30;1m232 | [0m[35m  default = ""[0m
[30;1m233 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/v1file_utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mdef v1File_from_local_file(archive_path: str, path: pathlib.Path) -> bindings.v1File:[0m
[30;1m32 | [0m[35m    with path.open("rb") as f:[0m
[30;1m33 | [0m[35m        content = base64.b64encode(f.read()).decode("utf8")[0m
[30;1m34 | [0m[35m    st = path.stat()[0m
[30;1m35 | [0m[35m    return bindings.v1File([0m
[30;1m36 | [0m[35m        path=archive_path,[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/v1file_utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mdef v1File_size(f: bindings.v1File) -> int:[0m
[30;1m10 | [0m[35m    if f.content:[0m
[30;1m11 | [0m[35m        # The content is already base64-encoded, and we want the real length.[0m
[30;1m12 | [0m[35m        return len(f.content) // 4 * 3[0m
[30;1m13 | [0m[35m    return 0[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/v1file_utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport pathlib[0m
[30;1m3 | [0m[35mimport tarfile[0m
[30;1m4 | [0m[35mfrom typing import Any, Dict[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m855 | [0m[35m              scheme=https[0m
[30;1m856 | [0m[35m              port=8443[0m
[30;1m857 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m858 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m859 | [0m[35m            fi[0m
[30;1m860 | [0m[35m[0m
[30;1m861 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m854 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m855 | [0m[35m              scheme=https[0m
[30;1m856 | [0m[35m              port=8443[0m
[30;1m857 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m858 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m859 | [0m[35m            fi[0m
[30;1m860 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m825 | [0m[35m            VolumeSize: 200[0m
[30;1m826 | [0m[35m            VolumeType: gp2[0m
[30;1m827 | [0m[35m      UserData:[0m
[30;1m828 | [0m[35m        Fn::Base64: !Sub[0m
[30;1m829 | [0m[35m          - |[0m
[30;1m830 | [0m[35m            Content-Type: multipart/mixed; boundary="//"[0m
[30;1m831 | [0m[35m            MIME-Version: 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m  MasterTLSKey:[0m
[30;1m159 | [0m[35m    Type: String[0m
[30;1m160 | [0m[35m    Description: Base64-encoded TLS key for the master[0m
[30;1m161 | [0m[35m    Default: ""[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m  MasterCertName:[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m  MasterTLSCert:[0m
[30;1m154 | [0m[35m    Type: String[0m
[30;1m155 | [0m[35m    Description: Base64-encoded TLS certificate for the master[0m
[30;1m156 | [0m[35m    Default: ""[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m  MasterTLSKey:[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m956 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m957 | [0m[35m[0m
[30;1m958 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m959 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m960 | [0m[35m            fi[0m
[30;1m961 | [0m[35m[0m
[30;1m962 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m933 | [0m[35m                container_path: /run/determined/workdir/shared_fs[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m            security:[0m
[30;1m936 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m937 | [0m[35m            EOF[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m933 | [0m[35m                container_path: /run/determined/workdir/shared_fs[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m            security:[0m
[30;1m936 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m937 | [0m[35m            EOF[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m920 | [0m[35m                  mkdir /mnt/fsx[0m
[30;1m921 | [0m[35m                  mount -t lustre -o noatime,flock ${FSxVal} /mnt/fsx[0m
[30;1m922 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m923 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m924 | [0m[35m                  fi[0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m867 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m868 | [0m[35m[0m
[30;1m869 | [0m[35m            db:[0m
[30;1m870 | [0m[35m              password: "${DBPassword}"[0m
[30;1m871 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m872 | [0m[35m              name: determined[0m
[30;1m873 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m867 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m868 | [0m[35m[0m
[30;1m869 | [0m[35m            db:[0m
[30;1m870 | [0m[35m              password: "${DBPassword}"[0m
[30;1m871 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m872 | [0m[35m              name: determined[0m
[30;1m873 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m625 | [0m[35m      DatabaseName: determined[0m
[30;1m626 | [0m[35m      DBSubnetGroupName: !Ref DatabaseSubnetGroup[0m
[30;1m627 | [0m[35m      MasterUsername: postgres[0m
[30;1m628 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m629 | [0m[35m      Tags:[0m
[30;1m630 | [0m[35m        - Key: user[0m
[30;1m631 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m625 | [0m[35m      DatabaseName: determined[0m
[30;1m626 | [0m[35m      DBSubnetGroupName: !Ref DatabaseSubnetGroup[0m
[30;1m627 | [0m[35m      MasterUsername: postgres[0m
[30;1m628 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m629 | [0m[35m      Tags:[0m
[30;1m630 | [0m[35m        - Key: user[0m
[30;1m631 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m      security:[0m
[30;1m293 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m294 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m295 | [0m[35m        tls:[0m
[30;1m296 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m      security:[0m
[30;1m293 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m294 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m295 | [0m[35m        tls:[0m
[30;1m296 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m      db:[0m
[30;1m247 | [0m[35m        user: postgres[0m
[30;1m248 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m249 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m250 | [0m[35m        port: 5432[0m
[30;1m251 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m      db:[0m
[30;1m247 | [0m[35m        user: postgres[0m
[30;1m248 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m249 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m250 | [0m[35m        port: 5432[0m
[30;1m251 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m  InitialUserPassword:[0m
[30;1m229 | [0m[35m    Type: String[0m
[30;1m230 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m231 | [0m[35m    Default: ""[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m  MasterConfigTemplate:[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m225 | [0m[35m    Description: preexisting FSx ID to mount[0m
[30;1m226 | [0m[35m    Default: ""[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m  InitialUserPassword:[0m
[30;1m229 | [0m[35m    Type: String[0m
[30;1m230 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m231 | [0m[35m    Default: ""[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m  DBPassword:[0m
[30;1m107 | [0m[35m    Type: String[0m
[30;1m108 | [0m[35m    Description: Password for database[0m
[30;1m109 | [0m[35m    NoEcho: true[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m  MaxAuxContainersPerAgent:[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m    Type: String[0m
[30;1m104 | [0m[35m    Description: Determined version or commit for master image[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m  DBPassword:[0m
[30;1m107 | [0m[35m    Type: String[0m
[30;1m108 | [0m[35m    Description: Password for database[0m
[30;1m109 | [0m[35m    NoEcho: true[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m
[30;1m97 | [0m[35m    Type: String[0m
[30;1m98 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m99 | [0m[35m    Default: ""[0m
[30;1m100 | [0m[35m    NoEcho: true[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m683 | [0m[35m              scheme=https[0m
[30;1m684 | [0m[35m              port=8443[0m
[30;1m685 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m686 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m687 | [0m[35m            fi[0m
[30;1m688 | [0m[35m[0m
[30;1m689 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m682 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m683 | [0m[35m              scheme=https[0m
[30;1m684 | [0m[35m              port=8443[0m
[30;1m685 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m686 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m687 | [0m[35m            fi[0m
[30;1m688 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m653 | [0m[35m            VolumeSize: 200[0m
[30;1m654 | [0m[35m            VolumeType: gp2[0m
[30;1m655 | [0m[35m      UserData:[0m
[30;1m656 | [0m[35m        Fn::Base64: !Sub[0m
[30;1m657 | [0m[35m          - |[0m
[30;1m658 | [0m[35m            Content-Type: multipart/mixed; boundary="//"[0m
[30;1m659 | [0m[35m            MIME-Version: 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m  MasterTLSKey:[0m
[30;1m139 | [0m[35m    Type: String[0m
[30;1m140 | [0m[35m    Description: Base64-encoded TLS key for the master[0m
[30;1m141 | [0m[35m    Default: ""[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m  MasterCertName:[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m  MasterTLSCert:[0m
[30;1m134 | [0m[35m    Type: String[0m
[30;1m135 | [0m[35m    Description: Base64-encoded TLS certificate for the master[0m
[30;1m136 | [0m[35m    Default: ""[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m  MasterTLSKey:[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m778 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m781 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m782 | [0m[35m            fi[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m755 | [0m[35m            notebook_timeout: ${NotebookTimeout}[0m
[30;1m756 | [0m[35m            [0m
[30;1m757 | [0m[35m            security:[0m
[30;1m758 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m759 | [0m[35m            EOF[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m755 | [0m[35m            notebook_timeout: ${NotebookTimeout}[0m
[30;1m756 | [0m[35m            [0m
[30;1m757 | [0m[35m            security:[0m
[30;1m758 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m759 | [0m[35m            EOF[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m746 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m747 | [0m[35m                startup_script: |[0m
[30;1m748 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m749 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m750 | [0m[35m                  fi[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m695 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m696 | [0m[35m[0m
[30;1m697 | [0m[35m            db:[0m
[30;1m698 | [0m[35m              password: "${DBPassword}"[0m
[30;1m699 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m700 | [0m[35m              name: determined[0m
[30;1m701 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m695 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m696 | [0m[35m[0m
[30;1m697 | [0m[35m            db:[0m
[30;1m698 | [0m[35m              password: "${DBPassword}"[0m
[30;1m699 | [0m[35m              host: "${Database.Endpoint.Address}"[0m
[30;1m700 | [0m[35m              name: determined[0m
[30;1m701 | [0m[35m              ssl_root_cert: /etc/determined/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m479 | [0m[35m      EngineMode: serverless[0m
[30;1m480 | [0m[35m      DatabaseName: determined[0m
[30;1m481 | [0m[35m      MasterUsername: postgres[0m
[30;1m482 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m483 | [0m[35m      Tags:[0m
[30;1m484 | [0m[35m        - Key: user[0m
[30;1m485 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m479 | [0m[35m      EngineMode: serverless[0m
[30;1m480 | [0m[35m      DatabaseName: determined[0m
[30;1m481 | [0m[35m      MasterUsername: postgres[0m
[30;1m482 | [0m[35m      MasterUserPassword: !Ref DBPassword[0m
[30;1m483 | [0m[35m      Tags:[0m
[30;1m484 | [0m[35m        - Key: user[0m
[30;1m485 | [0m[35m          Value: !Ref AWS::StackName[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m      security:[0m
[30;1m285 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m286 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m287 | [0m[35m        tls:[0m
[30;1m288 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m      security:[0m
[30;1m285 | [0m[35m        initial_user_password: {{ .security.initial_user_password }}[0m
[30;1m286 | [0m[35m        {{- if eq .scheme "https" }}[0m
[30;1m287 | [0m[35m        tls:[0m
[30;1m288 | [0m[35m          cert: /etc/determined/master.crt[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m      db:[0m
[30;1m239 | [0m[35m        user: postgres[0m
[30;1m240 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m241 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m242 | [0m[35m        port: 5432[0m
[30;1m243 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m      db:[0m
[30;1m239 | [0m[35m        user: postgres[0m
[30;1m240 | [0m[35m        password: "{{ .db.password }}"[0m
[30;1m241 | [0m[35m        host: "{{ .db.host }}"[0m
[30;1m242 | [0m[35m        port: 5432[0m
[30;1m243 | [0m[35m        name: "{{ .db.name }}"[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m  InitialUserPassword:[0m
[30;1m221 | [0m[35m    Type: String[0m
[30;1m222 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m223 | [0m[35m    Default: ""[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m  MasterConfigTemplate:[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m217 | [0m[35m    Description: Specifies the duration in seconds before idle notebook instances are automatically [0m
[30;1m218 | [0m[35m    Default: 0[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m  InitialUserPassword:[0m
[30;1m221 | [0m[35m    Type: String[0m
[30;1m222 | [0m[35m    Description: Default password for the built-in 'determined' and 'admin' user.[0m
[30;1m223 | [0m[35m    Default: ""[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m  DBPassword:[0m
[30;1m99 | [0m[35m    Type: String[0m
[30;1m100 | [0m[35m    Description: Password for database (eg. "postgres")[0m
[30;1m101 | [0m[35m    NoEcho: true[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m  MaxAuxContainersPerAgent:[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m    Type: String[0m
[30;1m96 | [0m[35m    Description: Determined version or commit for master docker image[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m  DBPassword:[0m
[30;1m99 | [0m[35m    Type: String[0m
[30;1m100 | [0m[35m    Description: Password for database (eg. "postgres")[0m
[30;1m101 | [0m[35m    NoEcho: true[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  DockerPass:[0m
[30;1m89 | [0m[35m    Type: String[0m
[30;1m90 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m91 | [0m[35m    Default: ""[0m
[30;1m92 | [0m[35m    NoEcho: true[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/util.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m205 | [0m[35m    #  - disable retries: {"total":0}[0m
[30;1m206 | [0m[35m    #  - shorten the wait times {"total":10,"backoff_factor":0.5,"method_whitelist":false}[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    config_data = os.environ.get("DET_RETRY_CONFIG")[0m
[30;1m209 | [0m[35m    if config_data is not None:[0m
[30;1m210 | [0m[35m        config = json.loads(config_data)[0m
[30;1m211 | [0m[35m        return urllib3.util.retry.Retry(**config)[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/util.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35mdef get_config_path() -> pathlib.Path:[0m
[30;1m184 | [0m[35m    if os.environ.get("DET_DEBUG_CONFIG_PATH"):[0m
[30;1m185 | [0m[35m        return pathlib.Path(os.environ["DET_DEBUG_CONFIG_PATH"])[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    system = platform.system()[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/constants.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m11 | [0m[35m# The maximum size of a model (the sum of the model definition plus any[0m
[30;1m12 | [0m[35m# additional package dependencies). Models are created via HTTP and sent[0m
[30;1m13 | [0m[35m# to agents via WebSockets; we also have to account for the overhead of[0m
[30;1m14 | [0m[35m# base64 encoding. Models are also stored in Postgres but the max[0m
[30;1m15 | [0m[35m# Postgres field size is 1GB, so we ignore that here.[0m
[30;1m16 | [0m[35mMAX_ENCODED_SIZE = (min(MAX_WEBSOCKET_MSG_SIZE, MAX_HTTP_REQUEST_SIZE) // 8) * 6[0m
[30;1m17 | [0m[35m# We subtract one megabyte to account for any message envelope size we may have.[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m# The username and password for the default user.[0m
[30;1m26 | [0m[35mDEFAULT_DETERMINED_USER = "determined"[0m
[30;1m27 | [0m[35mDEFAULT_DETERMINED_PASSWORD = ""[0m
[30;1m28 | [0m[35mDEFAULT_CHECKPOINT_PATH = "checkpoints"[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mSHARED_FS_CONTAINER_PATH = "/determined_shared_fs"[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m# training step is completed.[0m
[30;1m23 | [0m[35mMAX_METRICS_SIZE = 100 * (1 << 20)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m# The username and password for the default user.[0m
[30;1m26 | [0m[35mDEFAULT_DETERMINED_USER = "determined"[0m
[30;1m27 | [0m[35mDEFAULT_DETERMINED_PASSWORD = ""[0m
[30;1m28 | [0m[35mDEFAULT_CHECKPOINT_PATH = "checkpoints"[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m120 | [0m[35m    # easiest way to get the chief_ip is with container_addrs.[0m
[30;1m121 | [0m[35m    chief_ip = info.container_addrs[0][0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    # Chief IP is set as an environment variable to support nested launch layers[0m
[30;1m124 | [0m[35m    os.environ["DET_CHIEF_IP"] = chief_ip[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    if info.container_rank > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m105 | [0m[35m            return p.wait()[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    # Hack: get the resources id from the environment.[0m
[30;1m108 | [0m[35m    resources_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m109 | [0m[35m    assert resources_id is not None, "Unable to run with DET_RESOURCES_ID unset"[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    # Hack: read the full config.  The experiment config is not a stable API![0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        authentication.check_password_complexity(new_password)[0m
[30;1m94 | [0m[35m        new_password = api.salt_and_hash(new_password)[0m
[30;1m95 | [0m[35m        patch_user = bindings.v1PatchUser(password=new_password, isHashed=True)[0m
[30;1m96 | [0m[35m        bindings.patch_PatchUser(self._session, body=patch_user, userId=self.user_id)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def link_with_agent([0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        authentication.check_password_complexity(new_password)[0m
[30;1m94 | [0m[35m        new_password = api.salt_and_hash(new_password)[0m
[30;1m95 | [0m[35m        patch_user = bindings.v1PatchUser(password=new_password, isHashed=True)[0m
[30;1m96 | [0m[35m        bindings.patch_PatchUser(self._session, body=patch_user, userId=self.user_id)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def link_with_agent([0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        authentication.check_password_complexity(new_password)[0m
[30;1m94 | [0m[35m        new_password = api.salt_and_hash(new_password)[0m
[30;1m95 | [0m[35m        patch_user = bindings.v1PatchUser(password=new_password, isHashed=True)[0m
[30;1m96 | [0m[35m        bindings.patch_PatchUser(self._session, body=patch_user, userId=self.user_id)[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        authentication.check_password_complexity(new_password)[0m
[30;1m94 | [0m[35m        new_password = api.salt_and_hash(new_password)[0m
[30;1m95 | [0m[35m        patch_user = bindings.v1PatchUser(password=new_password, isHashed=True)[0m
[30;1m96 | [0m[35m        bindings.patch_PatchUser(self._session, body=patch_user, userId=self.user_id)[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m        Raises:[0m
[30;1m91 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        authentication.check_password_complexity(new_password)[0m
[30;1m94 | [0m[35m        new_password = api.salt_and_hash(new_password)[0m
[30;1m95 | [0m[35m        patch_user = bindings.v1PatchUser(password=new_password, isHashed=True)[0m
[30;1m96 | [0m[35m        bindings.patch_PatchUser(self._session, body=patch_user, userId=self.user_id)[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m        Raises:[0m
[30;1m91 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        authentication.check_password_complexity(new_password)[0m
[30;1m94 | [0m[35m        new_password = api.salt_and_hash(new_password)[0m
[30;1m95 | [0m[35m        patch_user = bindings.v1PatchUser(password=new_password, isHashed=True)[0m
[30;1m96 | [0m[35m        bindings.patch_PatchUser(self._session, body=patch_user, userId=self.user_id)[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m88 | [0m[35m            new_password: password to set.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        Raises:[0m
[30;1m91 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        authentication.check_password_complexity(new_password)[0m
[30;1m94 | [0m[35m        new_password = api.salt_and_hash(new_password)[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m        """Changes this user's password.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        Arg:[0m
[30;1m88 | [0m[35m            new_password: password to set.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        Raises:[0m
[30;1m91 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m        """Changes this user's password.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        Arg:[0m
[30;1m88 | [0m[35m            new_password: password to set.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        Raises:[0m
[30;1m91 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m82 | [0m[35m        self.reload()[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def change_password(self, new_password: str) -> None:[0m
[30;1m85 | [0m[35m        """Changes this user's password.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        Arg:[0m
[30;1m88 | [0m[35m            new_password: password to set.[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m81 | [0m[35m        bindings.patch_PatchUser(self._session, body=patch_user, userId=self.user_id)[0m
[30;1m82 | [0m[35m        self.reload()[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def change_password(self, new_password: str) -> None:[0m
[30;1m85 | [0m[35m        """Changes this user's password.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        Arg:[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m81 | [0m[35m        bindings.patch_PatchUser(self._session, body=patch_user, userId=self.user_id)[0m
[30;1m82 | [0m[35m        self.reload()[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def change_password(self, new_password: str) -> None:[0m
[30;1m85 | [0m[35m        """Changes this user's password.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        Arg:[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35m        user_id: (int) Unique ID for the user in the Determined database.[0m
[30;1m17 | [0m[35m        username: (Mutable, Optional[str]) Username of the user in the Determined cluster.[0m
[30;1m18 | [0m[35m        admin: (Mutable, Optional[bool]) Whether the user has admin privileges.[0m
[30;1m19 | [0m[35m        remote: (Mutable, Optional[bool]) When true, prevents password sign-on and requires user to[0m
[30;1m20 | [0m[35m            sign-on using external IdP[0m
[30;1m21 | [0m[35m        agent_uid: (Mutable, Optional[int]) UID on the agent this user is linked to.[0m
[30;1m22 | [0m[35m        agent_gid: (Mutable, Optional[int]) GID on the agent this user is linked to.[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m            authentication.check_password_complexity(password)[0m
[30;1m104 | [0m[35m            if password is not None:[0m
[30;1m105 | [0m[35m                hashedPassword = api.salt_and_hash(password)[0m
[30;1m106 | [0m[35m        req = bindings.v1PostUserRequest(password=hashedPassword, user=create_user, isHashed=True)[0m
[30;1m107 | [0m[35m        resp = bindings.post_PostUser(self._session, body=req)[0m
[30;1m108 | [0m[35m        assert resp.user is not None[0m
[30;1m109 | [0m[35m        return user.User._from_bindings(resp.user, self._session)[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m            authentication.check_password_complexity(password)[0m
[30;1m104 | [0m[35m            if password is not None:[0m
[30;1m105 | [0m[35m                hashedPassword = api.salt_and_hash(password)[0m
[30;1m106 | [0m[35m        req = bindings.v1PostUserRequest(password=hashedPassword, user=create_user, isHashed=True)[0m
[30;1m107 | [0m[35m        resp = bindings.post_PostUser(self._session, body=req)[0m
[30;1m108 | [0m[35m        assert resp.user is not None[0m
[30;1m109 | [0m[35m        return user.User._from_bindings(resp.user, self._session)[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m        if not remote:[0m
[30;1m103 | [0m[35m            authentication.check_password_complexity(password)[0m
[30;1m104 | [0m[35m            if password is not None:[0m
[30;1m105 | [0m[35m                hashedPassword = api.salt_and_hash(password)[0m
[30;1m106 | [0m[35m        req = bindings.v1PostUserRequest(password=hashedPassword, user=create_user, isHashed=True)[0m
[30;1m107 | [0m[35m        resp = bindings.post_PostUser(self._session, body=req)[0m
[30;1m108 | [0m[35m        assert resp.user is not None[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m        if not remote:[0m
[30;1m103 | [0m[35m            authentication.check_password_complexity(password)[0m
[30;1m104 | [0m[35m            if password is not None:[0m
[30;1m105 | [0m[35m                hashedPassword = api.salt_and_hash(password)[0m
[30;1m106 | [0m[35m        req = bindings.v1PostUserRequest(password=hashedPassword, user=create_user, isHashed=True)[0m
[30;1m107 | [0m[35m        resp = bindings.post_PostUser(self._session, body=req)[0m
[30;1m108 | [0m[35m        assert resp.user is not None[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m101 | [0m[35m        hashedPassword = None[0m
[30;1m102 | [0m[35m        if not remote:[0m
[30;1m103 | [0m[35m            authentication.check_password_complexity(password)[0m
[30;1m104 | [0m[35m            if password is not None:[0m
[30;1m105 | [0m[35m                hashedPassword = api.salt_and_hash(password)[0m
[30;1m106 | [0m[35m        req = bindings.v1PostUserRequest(password=hashedPassword, user=create_user, isHashed=True)[0m
[30;1m107 | [0m[35m        resp = bindings.post_PostUser(self._session, body=req)[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m        create_user = bindings.v1User(username=username, admin=admin, active=True, remote=remote)[0m
[30;1m101 | [0m[35m        hashedPassword = None[0m
[30;1m102 | [0m[35m        if not remote:[0m
[30;1m103 | [0m[35m            authentication.check_password_complexity(password)[0m
[30;1m104 | [0m[35m            if password is not None:[0m
[30;1m105 | [0m[35m                hashedPassword = api.salt_and_hash(password)[0m
[30;1m106 | [0m[35m        req = bindings.v1PostUserRequest(password=hashedPassword, user=create_user, isHashed=True)[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m        create_user = bindings.v1User(username=username, admin=admin, active=True, remote=remote)[0m
[30;1m101 | [0m[35m        hashedPassword = None[0m
[30;1m102 | [0m[35m        if not remote:[0m
[30;1m103 | [0m[35m            authentication.check_password_complexity(password)[0m
[30;1m104 | [0m[35m            if password is not None:[0m
[30;1m105 | [0m[35m                hashedPassword = api.salt_and_hash(password)[0m
[30;1m106 | [0m[35m        req = bindings.v1PostUserRequest(password=hashedPassword, user=create_user, isHashed=True)[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        create_user = bindings.v1User(username=username, admin=admin, active=True, remote=remote)[0m
[30;1m101 | [0m[35m        hashedPassword = None[0m
[30;1m102 | [0m[35m        if not remote:[0m
[30;1m103 | [0m[35m            authentication.check_password_complexity(password)[0m
[30;1m104 | [0m[35m            if password is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m            A :class:`~determined.experimental.client.User` of the created user.[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        Raises:[0m
[30;1m98 | [0m[35m            ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        create_user = bindings.v1User(username=username, admin=admin, active=True, remote=remote)[0m
[30;1m101 | [0m[35m        hashedPassword = None[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m88 | [0m[35m        Arg:[0m
[30;1m89 | [0m[35m            username: username of the user.[0m
[30;1m90 | [0m[35m            admin: indicates whether the user is an admin.[0m
[30;1m91 | [0m[35m            password: password of the user.[0m
[30;1m92 | [0m[35m            remote: indicates whether the user is managed by a remote service.[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m88 | [0m[35m        Arg:[0m
[30;1m89 | [0m[35m            username: username of the user.[0m
[30;1m90 | [0m[35m            admin: indicates whether the user is an admin.[0m
[30;1m91 | [0m[35m            password: password of the user.[0m
[30;1m92 | [0m[35m            remote: indicates whether the user is managed by a remote service.[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m        The user's credentials may be managed by a remote service (Enterprise edition only),[0m
[30;1m78 | [0m[35m        in which case the `remote` argument should be set to `true`, and then SSO should be[0m
[30;1m79 | [0m[35m        configured for the user. A remote user has no password and cannot log in except via SSO.[0m
[30;1m80 | [0m[35m        Otherwise, a password must be set that meets complexity requirements.[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        The complexity requirements are:[0m
[30;1m83 | [0m[35m            - Must be at least 8 characters long.[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m        The user's credentials may be managed by a remote service (Enterprise edition only),[0m
[30;1m78 | [0m[35m        in which case the `remote` argument should be set to `true`, and then SSO should be[0m
[30;1m79 | [0m[35m        configured for the user. A remote user has no password and cannot log in except via SSO.[0m
[30;1m80 | [0m[35m        Otherwise, a password must be set that meets complexity requirements.[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        The complexity requirements are:[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m        return new_det[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    def create_user([0m
[30;1m73 | [0m[35m        self, username: str, admin: bool, password: Optional[str] = None, remote: bool = False[0m
[30;1m74 | [0m[35m    ) -> user.User:[0m
[30;1m75 | [0m[35m        """Creates a user.[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m            explicit_noverify=noverify,[0m
[30;1m56 | [0m[35m        )[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        self._session = authentication.login_with_cache(self._master, user, password, cert=cert)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    @classmethod[0m
[30;1m61 | [0m[35m    def _from_session(cls, session: api.Session) -> "Determined":[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35m        self,[0m
[30;1m42 | [0m[35m        master: Optional[str] = None,[0m
[30;1m43 | [0m[35m        user: Optional[str] = None,[0m
[30;1m44 | [0m[35m        password: Optional[str] = None,[0m
[30;1m45 | [0m[35m        cert_path: Optional[str] = None,[0m
[30;1m46 | [0m[35m        cert_name: Optional[str] = None,[0m
[30;1m47 | [0m[35m        noverify: bool = False,[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m274 | [0m[35m        ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m275 | [0m[35m    """[0m
[30;1m276 | [0m[35m    assert _determined is not None[0m
[30;1m277 | [0m[35m    return _determined.create_user(username, admin, password, remote)[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m@_require_singleton[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m271 | [0m[35m        A :class:`~determined.experimental.client.User` of the created user.[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m    Raises:[0m
[30;1m274 | [0m[35m        ValueError: an error describing why the password does not meet complexity requirements.[0m
[30;1m275 | [0m[35m    """[0m
[30;1m276 | [0m[35m    assert _determined is not None[0m
[30;1m277 | [0m[35m    return _determined.create_user(username, admin, password, remote)[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m264 | [0m[35m    Arg:[0m
[30;1m265 | [0m[35m        username: username of the user.[0m
[30;1m266 | [0m[35m        admin: indicates whether the user is an admin.[0m
[30;1m267 | [0m[35m        password: password of the user.[0m
[30;1m268 | [0m[35m        remote: indicates whether the user is managed by a remote service.[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m264 | [0m[35m    Arg:[0m
[30;1m265 | [0m[35m        username: username of the user.[0m
[30;1m266 | [0m[35m        admin: indicates whether the user is an admin.[0m
[30;1m267 | [0m[35m        password: password of the user.[0m
[30;1m268 | [0m[35m        remote: indicates whether the user is managed by a remote service.[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m253 | [0m[35m    The user's credentials may be managed by a remote service (Enterprise edition only),[0m
[30;1m254 | [0m[35m    in which case the `remote` argument should be set to `true`, and then SSO should be[0m
[30;1m255 | [0m[35m    configured for the user. A remote user has no password and cannot log in except via SSO.[0m
[30;1m256 | [0m[35m    Otherwise, a password must be set that meets complexity requirements.[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    The complexity requirements are:[0m
[30;1m259 | [0m[35m        - Must be at least 8 characters long.[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    The user's credentials may be managed by a remote service (Enterprise edition only),[0m
[30;1m254 | [0m[35m    in which case the `remote` argument should be set to `true`, and then SSO should be[0m
[30;1m255 | [0m[35m    configured for the user. A remote user has no password and cannot log in except via SSO.[0m
[30;1m256 | [0m[35m    Otherwise, a password must be set that meets complexity requirements.[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    The complexity requirements are:[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m@_require_singleton[0m
[30;1m248 | [0m[35mdef create_user([0m
[30;1m249 | [0m[35m    username: str, admin: bool, password: Optional[str] = None, remote: bool = False[0m
[30;1m250 | [0m[35m) -> User:[0m
[30;1m251 | [0m[35m    """Creates a user.[0m
[30;1m252 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m160 | [0m[35m            "client.Determined() objects, which each expose the same functions as this module."[0m
[30;1m161 | [0m[35m        )[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    _determined = Determined(master, user, password, cert_path, cert_name, noverify)[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m@_require_singleton[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m            DET_MASTER and DET_MASTER_ADDR will be checked for the master URL in that order.[0m
[30;1m143 | [0m[35m        user (string, optional): The Determined username used for[0m
[30;1m144 | [0m[35m            authentication. (default: ``determined``)[0m
[30;1m145 | [0m[35m        password (string, optional): The password associated with the user.[0m
[30;1m146 | [0m[35m        cert_path (string, optional): A path to a custom PEM-encoded certificate,[0m
[30;1m147 | [0m[35m            against which to validate the master.  (default: ``None``)[0m
[30;1m148 | [0m[35m        cert_name (string, optional): The name of the master hostname to use during certificate[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m            DET_MASTER and DET_MASTER_ADDR will be checked for the master URL in that order.[0m
[30;1m143 | [0m[35m        user (string, optional): The Determined username used for[0m
[30;1m144 | [0m[35m            authentication. (default: ``determined``)[0m
[30;1m145 | [0m[35m        password (string, optional): The password associated with the user.[0m
[30;1m146 | [0m[35m        cert_path (string, optional): A path to a custom PEM-encoded certificate,[0m
[30;1m147 | [0m[35m            against which to validate the master.  (default: ``None``)[0m
[30;1m148 | [0m[35m        cert_name (string, optional): The name of the master hostname to use during certificate[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m134 | [0m[35m       machine, you should always be able to use ``det user login`` on the CLI, and ``login()``[0m
[30;1m135 | [0m[35m       will not need either a user or a password.  If you have ran ``det user login`` with multiple[0m
[30;1m136 | [0m[35m       users (and you have not ran ``det user logout``), then you should be able to run[0m
[30;1m137 | [0m[35m       ``login(user=...)`` for any of those users without putting your password in your code.[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    Args:[0m
[30;1m140 | [0m[35m        master (string, optional): The URL of the Determined master.[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m       Try to avoid having your password in your python code.  If you are running on your local[0m
[30;1m134 | [0m[35m       machine, you should always be able to use ``det user login`` on the CLI, and ``login()``[0m
[30;1m135 | [0m[35m       will not need either a user or a password.  If you have ran ``det user login`` with multiple[0m
[30;1m136 | [0m[35m       users (and you have not ran ``det user logout``), then you should be able to run[0m
[30;1m137 | [0m[35m       ``login(user=...)`` for any of those users without putting your password in your code.[0m
[30;1m138 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    .. note::[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m       Try to avoid having your password in your python code.  If you are running on your local[0m
[30;1m134 | [0m[35m       machine, you should always be able to use ``det user login`` on the CLI, and ``login()``[0m
[30;1m135 | [0m[35m       will not need either a user or a password.  If you have ran ``det user login`` with multiple[0m
[30;1m136 | [0m[35m       users (and you have not ran ``det user logout``), then you should be able to run[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35mdef login([0m
[30;1m108 | [0m[35m    master: Optional[str] = None,[0m
[30;1m109 | [0m[35m    user: Optional[str] = None,[0m
[30;1m110 | [0m[35m    password: Optional[str] = None,[0m
[30;1m111 | [0m[35m    cert_path: Optional[str] = None,[0m
[30;1m112 | [0m[35m    cert_name: Optional[str] = None,[0m
[30;1m113 | [0m[35m    noverify: bool = False,[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m   # If you have called `det user login`, environment variables will have been set such that[0m
[30;1m16 | [0m[35m   # logging in with `login` is unnecessary:[0m
[30;1m17 | [0m[35m   # client.login(master=..., user=..., password=...)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mThe next step is to call :func:`~determined.experimental.client.create_experiment`:[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m340 | [0m[35m    # * -p our custom port[0m
[30;1m341 | [0m[35m    # * other args are default ssh args for pdsh[0m
[30;1m342 | [0m[35m    os.environ["PDSH_SSH_ARGS"] = ([0m
[30;1m343 | [0m[35m        "-o PasswordAuthentication=no -o StrictHostKeyChecking=no "[0m
[30;1m344 | [0m[35m        f"-p {constants.DTRAIN_SSH_PORT} -2 -a -x %h"[0m
[30;1m345 | [0m[35m    )[0m
[30;1m346 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m261 | [0m[35m        dtrain_network_interface = os.environ.get("DET_INTER_NODE_NETWORK_INTERFACE", None)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        if dtrain_network_interface is not None and len(dtrain_network_interface) > 0:[0m
[30;1m264 | [0m[35m            os.environ["NCCL_SOCKET_IFNAME"] = dtrain_network_interface[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m    # In some downstream training code, the hostfile is expected on all nodes so we create the[0m
[30;1m267 | [0m[35m    # hostfile on all nodes here before opening the non-chief node subprocess.  Since we[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m258 | [0m[35m    # network interface, if the value of "dtrain_network_interface" under[0m
[30;1m259 | [0m[35m    # "task_container_defaults" has been set in the "master.yaml".[0m
[30;1m260 | [0m[35m    if is_using_cuda() and not is_nccl_socket_ifname_env_var_set():[0m
[30;1m261 | [0m[35m        dtrain_network_interface = os.environ.get("DET_INTER_NODE_NETWORK_INTERFACE", None)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        if dtrain_network_interface is not None and len(dtrain_network_interface) > 0:[0m
[30;1m264 | [0m[35m            os.environ["NCCL_SOCKET_IFNAME"] = dtrain_network_interface[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m250 | [0m[35m    # easiest way to get the chief_ip is with container_addrs.[0m
[30;1m251 | [0m[35m    chief_ip = info.container_addrs[0][0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    # Chief IP is set as an environment variable to support nested launch layers[0m
[30;1m254 | [0m[35m    os.environ["DET_CHIEF_IP"] = chief_ip[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    # If the NCCL_SOCKET_IFNAME environment variable wasn't explicitly set by[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m242 | [0m[35m    check_deepspeed_version(multi_machine)[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m    # Hack: get the resources id from the environment.[0m
[30;1m245 | [0m[35m    resources_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m246 | [0m[35m    assert resources_id is not None, "Unable to run with DET_RESOURCES_ID unset"[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m    # The launch layer should provide the chief_ip to the training code, so that the training code[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef is_nccl_socket_ifname_env_var_set() -> bool:[0m
[30;1m43 | [0m[35m    val = os.getenv("NCCL_SOCKET_IFNAME")[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    if val is None or len(val.strip()) == 0:[0m
[30;1m46 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    try:[0m
[30;1m515 | [0m[35m        if new_dict["environment"]["registry_auth"].get("password") is not None:[0m
[30;1m516 | [0m[35m            new_dict["environment"]["registry_auth"]["password"] = mask[0m
[30;1m517 | [0m[35m    except (KeyError, AttributeError):[0m
[30;1m518 | [0m[35m        pass[0m
[30;1m519 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m512 | [0m[35m        pass[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    try:[0m
[30;1m515 | [0m[35m        if new_dict["environment"]["registry_auth"].get("password") is not None:[0m
[30;1m516 | [0m[35m            new_dict["environment"]["registry_auth"]["password"] = mask[0m
[30;1m517 | [0m[35m    except (KeyError, AttributeError):[0m
[30;1m518 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m495 | [0m[35m    new_dict = copy.deepcopy(d)[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35m    # checkpoint_storage[0m
[30;1m498 | [0m[35m    for key in ("access_key", "secret_key"):[0m
[30;1m499 | [0m[35m        if key in new_dict:[0m
[30;1m500 | [0m[35m            new_dict[key] = mask[0m
[30;1m501 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m512 | [0m[35m        pass[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    try:[0m
[30;1m515 | [0m[35m        if new_dict["environment"]["registry_auth"].get("password") is not None:[0m
[30;1m516 | [0m[35m            new_dict["environment"]["registry_auth"]["password"] = mask[0m
[30;1m517 | [0m[35m    except (KeyError, AttributeError):[0m
[30;1m518 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/errors.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35mclass InvalidCredentialsException(UnauthenticatedException):[0m
[30;1m126 | [0m[35m    def __init__(self) -> None:[0m
[30;1m127 | [0m[35m        super().__init__(message="Invalid username/password combination. Please try again.")[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/errors.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m    def __init__([0m
[30;1m88 | [0m[35m        self,[0m
[30;1m89 | [0m[35m        message: str = ([0m
[30;1m90 | [0m[35m            "Unauthenticated: Please use 'det user login <username>' for password login, or"[0m
[30;1m91 | [0m[35m            " for Enterprise users logging in with an SSO provider,"[0m
[30;1m92 | [0m[35m            " use 'det auth login --provider=<provider>'."[0m
[30;1m93 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m30 | [0m[35m    if len(b64_tgz) == 0:[0m
[30;1m31 | [0m[35m        return  # Non trials can have empty model defs.[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    tgz = base64.b64decode(b64_tgz)[0m
[30;1m34 | [0m[35m    with tarfile.open(fileobj=io.BytesIO(tgz), mode="r:gz") as context_directory:[0m
[30;1m35 | [0m[35m        # Ensure all members of the tarball resolve to subdirectories.[0m
[30;1m36 | [0m[35m        for path in context_directory.getnames():[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport io[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m407 | [0m[35m        # based only on task logs.[0m
[30;1m408 | [0m[35m        hostname = os.environ.get("HOSTNAME", "")[0m
[30;1m409 | [0m[35m        agent_id = os.environ.get("DET_AGENT_ID", "")[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m
[30;1m412 | [0m[35m        logger.info([0m
[30;1m413 | [0m[35m            f"Running task container on agent_id={agent_id}, hostname={hostname} "[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m406 | [0m[35m        # Log where we are running and what GPUs are attached so hardware failures can be traced[0m
[30;1m407 | [0m[35m        # based only on task logs.[0m
[30;1m408 | [0m[35m        hostname = os.environ.get("HOSTNAME", "")[0m
[30;1m409 | [0m[35m        agent_id = os.environ.get("DET_AGENT_ID", "")[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m
[30;1m412 | [0m[35m        logger.info([0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m405 | [0m[35m        resources._to_file()[0m
[30;1m406 | [0m[35m        # Log where we are running and what GPUs are attached so hardware failures can be traced[0m
[30;1m407 | [0m[35m        # based only on task logs.[0m
[30;1m408 | [0m[35m        hostname = os.environ.get("HOSTNAME", "")[0m
[30;1m409 | [0m[35m        agent_id = os.environ.get("DET_AGENT_ID", "")[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35mdef do_proxy(sess: api.Session, allocation_id: str) -> None:[0m
[30;1m330 | [0m[35m    r_type = os.environ.get("DET_RESOURCES_TYPE")[0m
[30;1m331 | [0m[35m    assert r_type, "Unable to complete rendezvous info without DET_RESOURCES_TYPE"[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m    if r_type == RESOURCES_TYPE_DOCKER_CONTAINER:[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m314 | [0m[35m    if bool(os.environ.get("DET_PROXY_THROUGH_GATEWAY", None)):[0m
[30;1m315 | [0m[35m        return[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    pod_ip_str = os.environ.get("DET_KUBERNETES_POD_IP")[0m
[30;1m318 | [0m[35m    assert pod_ip_str, "Unable to complete rendezvous without DET_KUBERNETES_POD_IP"[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    bindings.post_PostAllocationProxyAddress([0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m311 | [0m[35m    # When using a gateway, we know the static IP in advance so we don't want to tell the[0m
[30;1m312 | [0m[35m    # master the pod IP. Handling this on the master side gets a little tricky with restore.[0m
[30;1m313 | [0m[35m    # For example we send this proxy address before master sends the allocation its address.[0m
[30;1m314 | [0m[35m    if bool(os.environ.get("DET_PROXY_THROUGH_GATEWAY", None)):[0m
[30;1m315 | [0m[35m        return[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    pod_ip_str = os.environ.get("DET_KUBERNETES_POD_IP")[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35mdef proxy_ifaces() -> List[str]:[0m
[30;1m277 | [0m[35m    # Manual override, for maximum flexibility.[0m
[30;1m278 | [0m[35m    proxy_ifaces = os.environ.get("DET_SLURM_PROXY_IFACE")[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m    if not proxy_ifaces:[0m
[30;1m281 | [0m[35m        return [][0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m257 | [0m[35m    r_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m258 | [0m[35m    assert r_id, "Unable to complete rendezvous info without DET_RESOURCES_ID"[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    r_type = os.environ.get("DET_RESOURCES_TYPE")[0m
[30;1m261 | [0m[35m    assert r_type, "Unable to complete rendezvous info without DET_RESOURCES_TYPE"[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    rendezvous_info = None[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35mdef do_rendezvous(sess: api.Session, allocation_id: str) -> None:[0m
[30;1m257 | [0m[35m    r_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m258 | [0m[35m    assert r_id, "Unable to complete rendezvous info without DET_RESOURCES_ID"[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    r_type = os.environ.get("DET_RESOURCES_TYPE")[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35mdef rendezvous_ifaces() -> List[str]:[0m
[30;1m207 | [0m[35m    # First case is a manual override. For maximum flexibility, this can be a comma-delimited list.[0m
[30;1m208 | [0m[35m    rendezvous_iface = os.environ.get("DET_SLURM_RENDEZVOUS_IFACE")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # If it doesn't work, fallback to just eth. Rendezvous over eth is fine since horovod will[0m
[30;1m211 | [0m[35m    # still use DET_INTER_NODE_NETWORK_INTERFACE for everything important, and SSH over IB mostly[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m185 | [0m[35m    # Tells the Determined Master how many containers are part of the job so[0m
[30;1m186 | [0m[35m    # that it knows how many unique IDs it should expect notifications from[0m
[30;1m187 | [0m[35m    # in order to change the experiment's state from "Pulling" to "Running".[0m
[30;1m188 | [0m[35m    num_peers_str = os.environ.get("SLURM_NPROCS")[0m
[30;1m189 | [0m[35m    assert num_peers_str, "Unable to send container running notification without SLURM_NPROCS"[0m
[30;1m190 | [0m[35m    num_peers = int(num_peers_str)[0m
[30;1m191 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m178 | [0m[35m# Master can change the state from "Pulling" to "Running".[0m
[30;1m179 | [0m[35mdef send_container_running_notification(sess: api.Session, allocation_id: str) -> None:[0m
[30;1m180 | [0m[35m    # Tells the Determined Master this container's unique ID.[0m
[30;1m181 | [0m[35m    rank_str = os.environ.get("SLURM_PROCID")[0m
[30;1m182 | [0m[35m    assert rank_str, "Unable to send container running notification without SLURM_PROCID"[0m
[30;1m183 | [0m[35m    rank = int(rank_str)[0m
[30;1m184 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m123 | [0m[35m    pod_ip_str = os.environ.get("DET_KUBERNETES_POD_IP")[0m
[30;1m124 | [0m[35m    assert pod_ip_str, "Unable to rendezvous without DET_KUBERNETES_POD_IP"[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    num_slots_str = os.environ.get("DET_SLOT_IDS")[0m
[30;1m127 | [0m[35m    assert num_slots_str, "Unable to rendezvous without DET_SLOT_IDS"[0m
[30;1m128 | [0m[35m    num_slots = len(json.loads(os.environ["DET_SLOT_IDS"]))[0m
[30;1m129 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m120 | [0m[35m    assert job_parallelism_str, "Unable to rendezvous without DET_KUBERNETES_JOB_PARALLELISM"[0m
[30;1m121 | [0m[35m    job_parallelism = int(job_parallelism_str)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    pod_ip_str = os.environ.get("DET_KUBERNETES_POD_IP")[0m
[30;1m124 | [0m[35m    assert pod_ip_str, "Unable to rendezvous without DET_KUBERNETES_POD_IP"[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    num_slots_str = os.environ.get("DET_SLOT_IDS")[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m116 | [0m[35m    allocation_id: str,[0m
[30;1m117 | [0m[35m    resources_id: str,[0m
[30;1m118 | [0m[35m) -> "det.RendezvousInfo":[0m
[30;1m119 | [0m[35m    job_parallelism_str = os.environ.get("DET_KUBERNETES_JOB_PARALLELISM")[0m
[30;1m120 | [0m[35m    assert job_parallelism_str, "Unable to rendezvous without DET_KUBERNETES_JOB_PARALLELISM"[0m
[30;1m121 | [0m[35m    job_parallelism = int(job_parallelism_str)[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m72 | [0m[35m    assert num_peers_str, "Unable to complete rendezvous without SLURM_NPROCS"[0m
[30;1m73 | [0m[35m    num_peers = int(num_peers_str)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    num_slots_str = os.environ.get("DET_SLOT_IDS")[0m
[30;1m76 | [0m[35m    assert num_slots_str, "Unable to complete rendezvous without DET_SLOT_IDS"[0m
[30;1m77 | [0m[35m    num_slots = len(json.loads(os.environ["DET_SLOT_IDS"]))[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m68 | [0m[35m    assert rank_str, "Unable to complete rendezvous without SLURM_PROCID"[0m
[30;1m69 | [0m[35m    rank = int(rank_str)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    num_peers_str = os.environ.get("SLURM_NPROCS")[0m
[30;1m72 | [0m[35m    assert num_peers_str, "Unable to complete rendezvous without SLURM_NPROCS"[0m
[30;1m73 | [0m[35m    num_peers = int(num_peers_str)[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m64 | [0m[35m    allocation_id: str,[0m
[30;1m65 | [0m[35m    resources_id: str,[0m
[30;1m66 | [0m[35m) -> "det.RendezvousInfo":[0m
[30;1m67 | [0m[35m    rank_str = os.environ.get("SLURM_PROCID")[0m
[30;1m68 | [0m[35m    assert rank_str, "Unable to complete rendezvous without SLURM_PROCID"[0m
[30;1m69 | [0m[35m    rank = int(rank_str)[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24085 | [0m[35m    )[0m
[30;1m24086 | [0m[35m    if _resp.status_code == 200:[0m
[30;1m24087 | [0m[35m        return v1SetUserPasswordResponse.from_json(_resp.json())[0m
[30;1m24088 | [0m[35m    raise APIHttpError("post_SetUserPassword", _resp)[0m
[30;1m24089 | [0m[35m[0m
[30;1m24090 | [0m[35mdef post_SetWorkspaceNamespaceBindings([0m
[30;1m24091 | [0m[35m    session: "api.BaseSession",[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24084 | [0m[35m        stream=False,[0m
[30;1m24085 | [0m[35m    )[0m
[30;1m24086 | [0m[35m    if _resp.status_code == 200:[0m
[30;1m24087 | [0m[35m        return v1SetUserPasswordResponse.from_json(_resp.json())[0m
[30;1m24088 | [0m[35m    raise APIHttpError("post_SetUserPassword", _resp)[0m
[30;1m24089 | [0m[35m[0m
[30;1m24090 | [0m[35mdef post_SetWorkspaceNamespaceBindings([0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24075 | [0m[35m    _params = None[0m
[30;1m24076 | [0m[35m    _resp = session._do_request([0m
[30;1m24077 | [0m[35m        method="POST",[0m
[30;1m24078 | [0m[35m        path=f"/api/v1/users/{userId}/password",[0m
[30;1m24079 | [0m[35m        params=_params,[0m
[30;1m24080 | [0m[35m        json=body,[0m
[30;1m24081 | [0m[35m        data=None,[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24069 | [0m[35m) -> "v1SetUserPasswordResponse":[0m
[30;1m24070 | [0m[35m    """Set the requested user's password.[0m
[30;1m24071 | [0m[35m[0m
[30;1m24072 | [0m[35m    - body: The password of the user.[0m
[30;1m24073 | [0m[35m    - userId: The id of the user.[0m
[30;1m24074 | [0m[35m    """[0m
[30;1m24075 | [0m[35m    _params = None[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24067 | [0m[35m    body: str,[0m
[30;1m24068 | [0m[35m    userId: int,[0m
[30;1m24069 | [0m[35m) -> "v1SetUserPasswordResponse":[0m
[30;1m24070 | [0m[35m    """Set the requested user's password.[0m
[30;1m24071 | [0m[35m[0m
[30;1m24072 | [0m[35m    - body: The password of the user.[0m
[30;1m24073 | [0m[35m    - userId: The id of the user.[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24066 | [0m[35m    *,[0m
[30;1m24067 | [0m[35m    body: str,[0m
[30;1m24068 | [0m[35m    userId: int,[0m
[30;1m24069 | [0m[35m) -> "v1SetUserPasswordResponse":[0m
[30;1m24070 | [0m[35m    """Set the requested user's password.[0m
[30;1m24071 | [0m[35m[0m
[30;1m24072 | [0m[35m    - body: The password of the user.[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24061 | [0m[35m        return v1SetTensorboardPriorityResponse.from_json(_resp.json())[0m
[30;1m24062 | [0m[35m    raise APIHttpError("post_SetTensorboardPriority", _resp)[0m
[30;1m24063 | [0m[35m[0m
[30;1m24064 | [0m[35mdef post_SetUserPassword([0m
[30;1m24065 | [0m[35m    session: "api.BaseSession",[0m
[30;1m24066 | [0m[35m    *,[0m
[30;1m24067 | [0m[35m    body: str,[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14888 | [0m[35m        if not omit_unset or "exitStatus" in vars(self):[0m
[30;1m14889 | [0m[35m            out["exitStatus"] = self.exitStatus[0m
[30;1m14890 | [0m[35m        if not omit_unset or "privateKey" in vars(self):[0m
[30;1m14891 | [0m[35m            out["privateKey"] = self.privateKey[0m
[30;1m14892 | [0m[35m        if not omit_unset or "publicKey" in vars(self):[0m
[30;1m14893 | [0m[35m            out["publicKey"] = self.publicKey[0m
[30;1m14894 | [0m[35m        if not omit_unset or "userId" in vars(self):[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14888 | [0m[35m        if not omit_unset or "exitStatus" in vars(self):[0m
[30;1m14889 | [0m[35m            out["exitStatus"] = self.exitStatus[0m
[30;1m14890 | [0m[35m        if not omit_unset or "privateKey" in vars(self):[0m
[30;1m14891 | [0m[35m            out["privateKey"] = self.privateKey[0m
[30;1m14892 | [0m[35m        if not omit_unset or "publicKey" in vars(self):[0m
[30;1m14893 | [0m[35m            out["publicKey"] = self.publicKey[0m
[30;1m14894 | [0m[35m        if not omit_unset or "userId" in vars(self):[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14887 | [0m[35m            out["displayName"] = self.displayName[0m
[30;1m14888 | [0m[35m        if not omit_unset or "exitStatus" in vars(self):[0m
[30;1m14889 | [0m[35m            out["exitStatus"] = self.exitStatus[0m
[30;1m14890 | [0m[35m        if not omit_unset or "privateKey" in vars(self):[0m
[30;1m14891 | [0m[35m            out["privateKey"] = self.privateKey[0m
[30;1m14892 | [0m[35m        if not omit_unset or "publicKey" in vars(self):[0m
[30;1m14893 | [0m[35m            out["publicKey"] = self.publicKey[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14859 | [0m[35m        if "exitStatus" in obj:[0m
[30;1m14860 | [0m[35m            kwargs["exitStatus"] = obj["exitStatus"][0m
[30;1m14861 | [0m[35m        if "privateKey" in obj:[0m
[30;1m14862 | [0m[35m            kwargs["privateKey"] = obj["privateKey"][0m
[30;1m14863 | [0m[35m        if "publicKey" in obj:[0m
[30;1m14864 | [0m[35m            kwargs["publicKey"] = obj["publicKey"][0m
[30;1m14865 | [0m[35m        if "userId" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14859 | [0m[35m        if "exitStatus" in obj:[0m
[30;1m14860 | [0m[35m            kwargs["exitStatus"] = obj["exitStatus"][0m
[30;1m14861 | [0m[35m        if "privateKey" in obj:[0m
[30;1m14862 | [0m[35m            kwargs["privateKey"] = obj["privateKey"][0m
[30;1m14863 | [0m[35m        if "publicKey" in obj:[0m
[30;1m14864 | [0m[35m            kwargs["publicKey"] = obj["publicKey"][0m
[30;1m14865 | [0m[35m        if "userId" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14858 | [0m[35m            kwargs["displayName"] = obj["displayName"][0m
[30;1m14859 | [0m[35m        if "exitStatus" in obj:[0m
[30;1m14860 | [0m[35m            kwargs["exitStatus"] = obj["exitStatus"][0m
[30;1m14861 | [0m[35m        if "privateKey" in obj:[0m
[30;1m14862 | [0m[35m            kwargs["privateKey"] = obj["privateKey"][0m
[30;1m14863 | [0m[35m        if "publicKey" in obj:[0m
[30;1m14864 | [0m[35m            kwargs["publicKey"] = obj["publicKey"][0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14830 | [0m[35m        if not isinstance(exitStatus, Unset):[0m
[30;1m14831 | [0m[35m            self.exitStatus = exitStatus[0m
[30;1m14832 | [0m[35m        if not isinstance(privateKey, Unset):[0m
[30;1m14833 | [0m[35m            self.privateKey = privateKey[0m
[30;1m14834 | [0m[35m        if not isinstance(publicKey, Unset):[0m
[30;1m14835 | [0m[35m            self.publicKey = publicKey[0m
[30;1m14836 | [0m[35m        if not isinstance(userId, Unset):[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14830 | [0m[35m        if not isinstance(exitStatus, Unset):[0m
[30;1m14831 | [0m[35m            self.exitStatus = exitStatus[0m
[30;1m14832 | [0m[35m        if not isinstance(privateKey, Unset):[0m
[30;1m14833 | [0m[35m            self.privateKey = privateKey[0m
[30;1m14834 | [0m[35m        if not isinstance(publicKey, Unset):[0m
[30;1m14835 | [0m[35m            self.publicKey = publicKey[0m
[30;1m14836 | [0m[35m        if not isinstance(userId, Unset):[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14829 | [0m[35m            self.displayName = displayName[0m
[30;1m14830 | [0m[35m        if not isinstance(exitStatus, Unset):[0m
[30;1m14831 | [0m[35m            self.exitStatus = exitStatus[0m
[30;1m14832 | [0m[35m        if not isinstance(privateKey, Unset):[0m
[30;1m14833 | [0m[35m            self.privateKey = privateKey[0m
[30;1m14834 | [0m[35m        if not isinstance(publicKey, Unset):[0m
[30;1m14835 | [0m[35m            self.publicKey = publicKey[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14807 | [0m[35m        container: "typing.Union[v1Container, None, Unset]" = _unset,[0m
[30;1m14808 | [0m[35m        displayName: "typing.Union[str, None, Unset]" = _unset,[0m
[30;1m14809 | [0m[35m        exitStatus: "typing.Union[str, None, Unset]" = _unset,[0m
[30;1m14810 | [0m[35m        privateKey: "typing.Union[str, None, Unset]" = _unset,[0m
[30;1m14811 | [0m[35m        publicKey: "typing.Union[str, None, Unset]" = _unset,[0m
[30;1m14812 | [0m[35m        userId: "typing.Union[int, None, Unset]" = _unset,[0m
[30;1m14813 | [0m[35m    ):[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14787 | [0m[35m    container: "typing.Optional[v1Container]" = None[0m
[30;1m14788 | [0m[35m    displayName: "typing.Optional[str]" = None[0m
[30;1m14789 | [0m[35m    exitStatus: "typing.Optional[str]" = None[0m
[30;1m14790 | [0m[35m    privateKey: "typing.Optional[str]" = None[0m
[30;1m14791 | [0m[35m    publicKey: "typing.Optional[str]" = None[0m
[30;1m14792 | [0m[35m    userId: "typing.Optional[int]" = None[0m
[30;1m14793 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14712 | [0m[35m            self.user = user[0m
[30;1m14713 | [0m[35m[0m
[30;1m14714 | [0m[35m    @classmethod[0m
[30;1m14715 | [0m[35m    def from_json(cls, obj: Json) -> "v1SetUserPasswordResponse":[0m
[30;1m14716 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m14717 | [0m[35m        }[0m
[30;1m14718 | [0m[35m        if "user" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14700 | [0m[35m        return out[0m
[30;1m14701 | [0m[35m[0m
[30;1m14702 | [0m[35mclass v1SetUserPasswordResponse(Printable):[0m
[30;1m14703 | [0m[35m    """Response to SetUserPasswordRequest."""[0m
[30;1m14704 | [0m[35m    user: "typing.Optional[v1User]" = None[0m
[30;1m14705 | [0m[35m[0m
[30;1m14706 | [0m[35m    def __init__([0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14699 | [0m[35m            out["tensorboard"] = None if self.tensorboard is None else self.tensorboard.to_json(omit[0m
[30;1m14700 | [0m[35m        return out[0m
[30;1m14701 | [0m[35m[0m
[30;1m14702 | [0m[35mclass v1SetUserPasswordResponse(Printable):[0m
[30;1m14703 | [0m[35m    """Response to SetUserPasswordRequest."""[0m
[30;1m14704 | [0m[35m    user: "typing.Optional[v1User]" = None[0m
[30;1m14705 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13231 | [0m[35m            "rootVolumeSize": self.rootVolumeSize,[0m
[30;1m13232 | [0m[35m            "securityGroupId": self.securityGroupId,[0m
[30;1m13233 | [0m[35m            "spotEnabled": self.spotEnabled,[0m
[30;1m13234 | [0m[35m            "sshKeyName": self.sshKeyName,[0m
[30;1m13235 | [0m[35m            "tagKey": self.tagKey,[0m
[30;1m13236 | [0m[35m            "tagValue": self.tagValue,[0m
[30;1m13237 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13176 | [0m[35m        self.rootVolumeSize = rootVolumeSize[0m
[30;1m13177 | [0m[35m        self.securityGroupId = securityGroupId[0m
[30;1m13178 | [0m[35m        self.spotEnabled = spotEnabled[0m
[30;1m13179 | [0m[35m        self.sshKeyName = sshKeyName[0m
[30;1m13180 | [0m[35m        self.tagKey = tagKey[0m
[30;1m13181 | [0m[35m        self.tagValue = tagValue[0m
[30;1m13182 | [0m[35m        if not isinstance(customTags, Unset):[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11536 | [0m[35m        if not omit_unset or "isHashed" in vars(self):[0m
[30;1m11537 | [0m[35m            out["isHashed"] = self.isHashed[0m
[30;1m11538 | [0m[35m        if not omit_unset or "password" in vars(self):[0m
[30;1m11539 | [0m[35m            out["password"] = self.password[0m
[30;1m11540 | [0m[35m        if not omit_unset or "user" in vars(self):[0m
[30;1m11541 | [0m[35m            out["user"] = None if self.user is None else self.user.to_json(omit_unset)[0m
[30;1m11542 | [0m[35m        return out[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11536 | [0m[35m        if not omit_unset or "isHashed" in vars(self):[0m
[30;1m11537 | [0m[35m            out["isHashed"] = self.isHashed[0m
[30;1m11538 | [0m[35m        if not omit_unset or "password" in vars(self):[0m
[30;1m11539 | [0m[35m            out["password"] = self.password[0m
[30;1m11540 | [0m[35m        if not omit_unset or "user" in vars(self):[0m
[30;1m11541 | [0m[35m            out["user"] = None if self.user is None else self.user.to_json(omit_unset)[0m
[30;1m11542 | [0m[35m        return out[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11535 | [0m[35m        }[0m
[30;1m11536 | [0m[35m        if not omit_unset or "isHashed" in vars(self):[0m
[30;1m11537 | [0m[35m            out["isHashed"] = self.isHashed[0m
[30;1m11538 | [0m[35m        if not omit_unset or "password" in vars(self):[0m
[30;1m11539 | [0m[35m            out["password"] = self.password[0m
[30;1m11540 | [0m[35m        if not omit_unset or "user" in vars(self):[0m
[30;1m11541 | [0m[35m            out["user"] = None if self.user is None else self.user.to_json(omit_unset)[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11525 | [0m[35m        if "isHashed" in obj:[0m
[30;1m11526 | [0m[35m            kwargs["isHashed"] = obj["isHashed"][0m
[30;1m11527 | [0m[35m        if "password" in obj:[0m
[30;1m11528 | [0m[35m            kwargs["password"] = obj["password"][0m
[30;1m11529 | [0m[35m        if "user" in obj:[0m
[30;1m11530 | [0m[35m            kwargs["user"] = v1User.from_json(obj["user"]) if obj["user"] is not None else None[0m
[30;1m11531 | [0m[35m        return cls(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11525 | [0m[35m        if "isHashed" in obj:[0m
[30;1m11526 | [0m[35m            kwargs["isHashed"] = obj["isHashed"][0m
[30;1m11527 | [0m[35m        if "password" in obj:[0m
[30;1m11528 | [0m[35m            kwargs["password"] = obj["password"][0m
[30;1m11529 | [0m[35m        if "user" in obj:[0m
[30;1m11530 | [0m[35m            kwargs["user"] = v1User.from_json(obj["user"]) if obj["user"] is not None else None[0m
[30;1m11531 | [0m[35m        return cls(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11524 | [0m[35m        }[0m
[30;1m11525 | [0m[35m        if "isHashed" in obj:[0m
[30;1m11526 | [0m[35m            kwargs["isHashed"] = obj["isHashed"][0m
[30;1m11527 | [0m[35m        if "password" in obj:[0m
[30;1m11528 | [0m[35m            kwargs["password"] = obj["password"][0m
[30;1m11529 | [0m[35m        if "user" in obj:[0m
[30;1m11530 | [0m[35m            kwargs["user"] = v1User.from_json(obj["user"]) if obj["user"] is not None else None[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11514 | [0m[35m        if not isinstance(isHashed, Unset):[0m
[30;1m11515 | [0m[35m            self.isHashed = isHashed[0m
[30;1m11516 | [0m[35m        if not isinstance(password, Unset):[0m
[30;1m11517 | [0m[35m            self.password = password[0m
[30;1m11518 | [0m[35m        if not isinstance(user, Unset):[0m
[30;1m11519 | [0m[35m            self.user = user[0m
[30;1m11520 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11514 | [0m[35m        if not isinstance(isHashed, Unset):[0m
[30;1m11515 | [0m[35m            self.isHashed = isHashed[0m
[30;1m11516 | [0m[35m        if not isinstance(password, Unset):[0m
[30;1m11517 | [0m[35m            self.password = password[0m
[30;1m11518 | [0m[35m        if not isinstance(user, Unset):[0m
[30;1m11519 | [0m[35m            self.user = user[0m
[30;1m11520 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11513 | [0m[35m    ):[0m
[30;1m11514 | [0m[35m        if not isinstance(isHashed, Unset):[0m
[30;1m11515 | [0m[35m            self.isHashed = isHashed[0m
[30;1m11516 | [0m[35m        if not isinstance(password, Unset):[0m
[30;1m11517 | [0m[35m            self.password = password[0m
[30;1m11518 | [0m[35m        if not isinstance(user, Unset):[0m
[30;1m11519 | [0m[35m            self.user = user[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11508 | [0m[35m        self,[0m
[30;1m11509 | [0m[35m        *,[0m
[30;1m11510 | [0m[35m        isHashed: "typing.Union[bool, None, Unset]" = _unset,[0m
[30;1m11511 | [0m[35m        password: "typing.Union[str, None, Unset]" = _unset,[0m
[30;1m11512 | [0m[35m        user: "typing.Union[v1User, None, Unset]" = _unset,[0m
[30;1m11513 | [0m[35m    ):[0m
[30;1m11514 | [0m[35m        if not isinstance(isHashed, Unset):[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11501 | [0m[35mclass v1PostUserRequest(Printable):[0m
[30;1m11502 | [0m[35m    """Create a new user."""[0m
[30;1m11503 | [0m[35m    isHashed: "typing.Optional[bool]" = None[0m
[30;1m11504 | [0m[35m    password: "typing.Optional[str]" = None[0m
[30;1m11505 | [0m[35m    user: "typing.Optional[v1User]" = None[0m
[30;1m11506 | [0m[35m[0m
[30;1m11507 | [0m[35m    def __init__([0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10720 | [0m[35m    value like 2001 and 2002.[0m
[30;1m10721 | [0m[35m    - PERMISSION_TYPE_UNSPECIFIED: The permission type is unknown.[0m
[30;1m10722 | [0m[35m    - PERMISSION_TYPE_ADMINISTRATE_USER: Can create and update other users.[0m
[30;1m10723 | [0m[35m    Allows updating other users passwords making this[0m
[30;1m10724 | [0m[35m    permission give all other permissions effectively.[0m
[30;1m10725 | [0m[35m    - PERMISSION_TYPE_ADMINISTRATE_OAUTH: Ability to manage OAuth clients and settings.[0m
[30;1m10726 | [0m[35m    - PERMISSION_TYPE_CREATE_EXPERIMENT: Ability to create experiments.[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10335 | [0m[35m        if not omit_unset or "isHashed" in vars(self):[0m
[30;1m10336 | [0m[35m            out["isHashed"] = self.isHashed[0m
[30;1m10337 | [0m[35m        if not omit_unset or "password" in vars(self):[0m
[30;1m10338 | [0m[35m            out["password"] = self.password[0m
[30;1m10339 | [0m[35m        if not omit_unset or "remote" in vars(self):[0m
[30;1m10340 | [0m[35m            out["remote"] = self.remote[0m
[30;1m10341 | [0m[35m        if not omit_unset or "username" in vars(self):[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10335 | [0m[35m        if not omit_unset or "isHashed" in vars(self):[0m
[30;1m10336 | [0m[35m            out["isHashed"] = self.isHashed[0m
[30;1m10337 | [0m[35m        if not omit_unset or "password" in vars(self):[0m
[30;1m10338 | [0m[35m            out["password"] = self.password[0m
[30;1m10339 | [0m[35m        if not omit_unset or "remote" in vars(self):[0m
[30;1m10340 | [0m[35m            out["remote"] = self.remote[0m
[30;1m10341 | [0m[35m        if not omit_unset or "username" in vars(self):[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10334 | [0m[35m            out["displayName"] = self.displayName[0m
[30;1m10335 | [0m[35m        if not omit_unset or "isHashed" in vars(self):[0m
[30;1m10336 | [0m[35m            out["isHashed"] = self.isHashed[0m
[30;1m10337 | [0m[35m        if not omit_unset or "password" in vars(self):[0m
[30;1m10338 | [0m[35m            out["password"] = self.password[0m
[30;1m10339 | [0m[35m        if not omit_unset or "remote" in vars(self):[0m
[30;1m10340 | [0m[35m            out["remote"] = self.remote[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10314 | [0m[35m        if "isHashed" in obj:[0m
[30;1m10315 | [0m[35m            kwargs["isHashed"] = obj["isHashed"][0m
[30;1m10316 | [0m[35m        if "password" in obj:[0m
[30;1m10317 | [0m[35m            kwargs["password"] = obj["password"][0m
[30;1m10318 | [0m[35m        if "remote" in obj:[0m
[30;1m10319 | [0m[35m            kwargs["remote"] = obj["remote"][0m
[30;1m10320 | [0m[35m        if "username" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10314 | [0m[35m        if "isHashed" in obj:[0m
[30;1m10315 | [0m[35m            kwargs["isHashed"] = obj["isHashed"][0m
[30;1m10316 | [0m[35m        if "password" in obj:[0m
[30;1m10317 | [0m[35m            kwargs["password"] = obj["password"][0m
[30;1m10318 | [0m[35m        if "remote" in obj:[0m
[30;1m10319 | [0m[35m            kwargs["remote"] = obj["remote"][0m
[30;1m10320 | [0m[35m        if "username" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10313 | [0m[35m            kwargs["displayName"] = obj["displayName"][0m
[30;1m10314 | [0m[35m        if "isHashed" in obj:[0m
[30;1m10315 | [0m[35m            kwargs["isHashed"] = obj["isHashed"][0m
[30;1m10316 | [0m[35m        if "password" in obj:[0m
[30;1m10317 | [0m[35m            kwargs["password"] = obj["password"][0m
[30;1m10318 | [0m[35m        if "remote" in obj:[0m
[30;1m10319 | [0m[35m            kwargs["remote"] = obj["remote"][0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10293 | [0m[35m        if not isinstance(isHashed, Unset):[0m
[30;1m10294 | [0m[35m            self.isHashed = isHashed[0m
[30;1m10295 | [0m[35m        if not isinstance(password, Unset):[0m
[30;1m10296 | [0m[35m            self.password = password[0m
[30;1m10297 | [0m[35m        if not isinstance(remote, Unset):[0m
[30;1m10298 | [0m[35m            self.remote = remote[0m
[30;1m10299 | [0m[35m        if not isinstance(username, Unset):[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10293 | [0m[35m        if not isinstance(isHashed, Unset):[0m
[30;1m10294 | [0m[35m            self.isHashed = isHashed[0m
[30;1m10295 | [0m[35m        if not isinstance(password, Unset):[0m
[30;1m10296 | [0m[35m            self.password = password[0m
[30;1m10297 | [0m[35m        if not isinstance(remote, Unset):[0m
[30;1m10298 | [0m[35m            self.remote = remote[0m
[30;1m10299 | [0m[35m        if not isinstance(username, Unset):[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10292 | [0m[35m            self.displayName = displayName[0m
[30;1m10293 | [0m[35m        if not isinstance(isHashed, Unset):[0m
[30;1m10294 | [0m[35m            self.isHashed = isHashed[0m
[30;1m10295 | [0m[35m        if not isinstance(password, Unset):[0m
[30;1m10296 | [0m[35m            self.password = password[0m
[30;1m10297 | [0m[35m        if not isinstance(remote, Unset):[0m
[30;1m10298 | [0m[35m            self.remote = remote[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10278 | [0m[35m        agentUserGroup: "typing.Union[v1AgentUserGroup, None, Unset]" = _unset,[0m
[30;1m10279 | [0m[35m        displayName: "typing.Union[str, None, Unset]" = _unset,[0m
[30;1m10280 | [0m[35m        isHashed: "typing.Union[bool, None, Unset]" = _unset,[0m
[30;1m10281 | [0m[35m        password: "typing.Union[str, None, Unset]" = _unset,[0m
[30;1m10282 | [0m[35m        remote: "typing.Union[bool, None, Unset]" = _unset,[0m
[30;1m10283 | [0m[35m        username: "typing.Union[str, None, Unset]" = _unset,[0m
[30;1m10284 | [0m[35m    ):[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10266 | [0m[35m    agentUserGroup: "typing.Optional[v1AgentUserGroup]" = None[0m
[30;1m10267 | [0m[35m    displayName: "typing.Optional[str]" = None[0m
[30;1m10268 | [0m[35m    isHashed: "typing.Optional[bool]" = None[0m
[30;1m10269 | [0m[35m    password: "typing.Optional[str]" = None[0m
[30;1m10270 | [0m[35m    remote: "typing.Optional[bool]" = None[0m
[30;1m10271 | [0m[35m    username: "typing.Optional[str]" = None[0m
[30;1m10272 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8614 | [0m[35m[0m
[30;1m8615 | [0m[35m    def to_json(self, omit_unset: bool = False) -> typing.Dict[str, typing.Any]:[0m
[30;1m8616 | [0m[35m        out: "typing.Dict[str, typing.Any]" = {[0m
[30;1m8617 | [0m[35m            "password": self.password,[0m
[30;1m8618 | [0m[35m            "username": self.username,[0m
[30;1m8619 | [0m[35m        }[0m
[30;1m8620 | [0m[35m        if not omit_unset or "isHashed" in vars(self):[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8614 | [0m[35m[0m
[30;1m8615 | [0m[35m    def to_json(self, omit_unset: bool = False) -> typing.Dict[str, typing.Any]:[0m
[30;1m8616 | [0m[35m        out: "typing.Dict[str, typing.Any]" = {[0m
[30;1m8617 | [0m[35m            "password": self.password,[0m
[30;1m8618 | [0m[35m            "username": self.username,[0m
[30;1m8619 | [0m[35m        }[0m
[30;1m8620 | [0m[35m        if not omit_unset or "isHashed" in vars(self):[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8605 | [0m[35m    @classmethod[0m
[30;1m8606 | [0m[35m    def from_json(cls, obj: Json) -> "v1LoginRequest":[0m
[30;1m8607 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m8608 | [0m[35m            "password": obj["password"],[0m
[30;1m8609 | [0m[35m            "username": obj["username"],[0m
[30;1m8610 | [0m[35m        }[0m
[30;1m8611 | [0m[35m        if "isHashed" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8605 | [0m[35m    @classmethod[0m
[30;1m8606 | [0m[35m    def from_json(cls, obj: Json) -> "v1LoginRequest":[0m
[30;1m8607 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m8608 | [0m[35m            "password": obj["password"],[0m
[30;1m8609 | [0m[35m            "username": obj["username"],[0m
[30;1m8610 | [0m[35m        }[0m
[30;1m8611 | [0m[35m        if "isHashed" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8597 | [0m[35m        username: str,[0m
[30;1m8598 | [0m[35m        isHashed: "typing.Union[bool, None, Unset]" = _unset,[0m
[30;1m8599 | [0m[35m    ):[0m
[30;1m8600 | [0m[35m        self.password = password[0m
[30;1m8601 | [0m[35m        self.username = username[0m
[30;1m8602 | [0m[35m        if not isinstance(isHashed, Unset):[0m
[30;1m8603 | [0m[35m            self.isHashed = isHashed[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8597 | [0m[35m        username: str,[0m
[30;1m8598 | [0m[35m        isHashed: "typing.Union[bool, None, Unset]" = _unset,[0m
[30;1m8599 | [0m[35m    ):[0m
[30;1m8600 | [0m[35m        self.password = password[0m
[30;1m8601 | [0m[35m        self.username = username[0m
[30;1m8602 | [0m[35m        if not isinstance(isHashed, Unset):[0m
[30;1m8603 | [0m[35m            self.isHashed = isHashed[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8593 | [0m[35m    def __init__([0m
[30;1m8594 | [0m[35m        self,[0m
[30;1m8595 | [0m[35m        *,[0m
[30;1m8596 | [0m[35m        password: str,[0m
[30;1m8597 | [0m[35m        username: str,[0m
[30;1m8598 | [0m[35m        isHashed: "typing.Union[bool, None, Unset]" = _unset,[0m
[30;1m8599 | [0m[35m    ):[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/keras/_tf_keras_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m52 | [0m[35m        self.compile_args = None  # type: Optional[inspect.BoundArguments][0m
[30;1m53 | [0m[35m        self.train_config = None  # type: Optional[TFKerasTrainConfig][0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        optimizations_config = self.env.experiment_config.get_optimizations_config()[0m
[30;1m56 | [0m[35m        self._aggregation_frequency = cast(int, optimizations_config.get("aggregation_frequency"))[0m
[30;1m57 | [0m[35m        self._average_aggregated_gradients = cast([0m
[30;1m58 | [0m[35m            bool, optimizations_config.get("average_aggregated_gradients")[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    if parsed.username or parsed.password or parsed.query or parsed.fragment:[0m
[30;1m69 | [0m[35m        raise ValueError([0m
[30;1m70 | [0m[35m            f"invalid master url {url}; master url must not contain username, password, query, or "[0m
[30;1m71 | [0m[35m            "fragment"[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m    if not parsed.hostname:[0m
[30;1m66 | [0m[35m        raise ValueError(f"invalid master url {url}; master url must contain a nonempty hostname")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    if parsed.username or parsed.password or parsed.query or parsed.fragment:[0m
[30;1m69 | [0m[35m        raise ValueError([0m
[30;1m70 | [0m[35m            f"invalid master url {url}; master url must not contain username, password, query, or "[0m
[30;1m71 | [0m[35m            "fragment"[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35m      - nonempty host[0m
[30;1m42 | [0m[35m      - explicit port[0m
[30;1m43 | [0m[35m      - path does not end in a '/', if it is present at all[0m
[30;1m44 | [0m[35m      - no username, password, query, or fragment[0m
[30;1m45 | [0m[35m      - a full url can be trivially formed a la f"{master_url}/path/to/resource"[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    In addition to validation, canonicalization is important for the authentication cache, because[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m89 | [0m[35m        master_url = user_requested_master or get_default_master_url()[0m
[30;1m90 | [0m[35m        master_url = canonicalize_master_url(master_url)[0m
[30;1m91 | [0m[35m    """[0m
[30;1m92 | [0m[35m    return os.environ.get("DET_MASTER", os.environ.get("DET_MASTER_ADDR", "localhost:8080"))[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mdef read_paginated([0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/certs.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m213 | [0m[35m        maybe_shim_old_cert_store(old_path, store_path, master_url)[0m
[30;1m214 | [0m[35m        cert_pem = cert_store.get_cert(master_url)[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m    env_name = os.environ.get("DET_MASTER_CERT_NAME")[0m
[30;1m217 | [0m[35m    if env_name == "":[0m
[30;1m218 | [0m[35m        env_name = None[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/api/certs.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m192 | [0m[35m        return Cert(cert_pem=cert_pem, noverify=explicit_noverify, name=explicit_cert_name)[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    # Let any environment variable for CERT_FILE override the default store.[0m
[30;1m195 | [0m[35m    env_path = os.environ.get("DET_MASTER_CERT_FILE")[0m
[30;1m196 | [0m[35m    noverify = False[0m
[30;1m197 | [0m[35m    cert_pem = None[0m
[30;1m198 | [0m[35m    if env_path:[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m471 | [0m[35m        # because we would have to communicate after every batch to know how many records were in[0m
[30;1m472 | [0m[35m        # each batch on each worker in order to trigger on_epoch_end callbacks correctly.[0m
[30;1m473 | [0m[35m        batches_per_epoch = None[0m
[30;1m474 | [0m[35m        records_per_epoch = self.env.experiment_config.get_records_per_epoch()[0m
[30;1m475 | [0m[35m        if records_per_epoch is not None:[0m
[30;1m476 | [0m[35m            batches_per_epoch = records_per_epoch // self.context.get_global_batch_size()[0m
[30;1m477 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m436 | [0m[35m            "the callbacks parameter of model.fit() or model.eval() must be a list of Callbacks",[0m
[30;1m437 | [0m[35m        )[0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m        if self.env.experiment_config.get_records_per_epoch() is None:[0m
[30;1m440 | [0m[35m            for cb in callbacks_list:[0m
[30;1m441 | [0m[35m                if util.is_overridden(cb.on_epoch_end, callbacks.Callback) and not getattr([0m
[30;1m442 | [0m[35m                    cb, "_skip_epoch_end_check", False[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/s3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35m            "s3",[0m
[30;1m37 | [0m[35m            endpoint_url=endpoint_url,[0m
[30;1m38 | [0m[35m            aws_access_key_id=access_key,[0m
[30;1m39 | [0m[35m            aws_secret_access_key=secret_key,[0m
[30;1m40 | [0m[35m        )[0m
[30;1m41 | [0m[35m        self.bucket = self.s3.Bucket(self.bucket_name)[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/common/storage/s3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m        self,[0m
[30;1m21 | [0m[35m        bucket: str,[0m
[30;1m22 | [0m[35m        access_key: Optional[str] = None,[0m
[30;1m23 | [0m[35m        secret_key: Optional[str] = None,[0m
[30;1m24 | [0m[35m        endpoint_url: Optional[str] = None,[0m
[30;1m25 | [0m[35m        prefix: Optional[str] = None,[0m
[30;1m26 | [0m[35m        temp_dir: Optional[str] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m138 | [0m[35m            **env.experiment_config.get_min_validation_period()[0m
[30;1m139 | [0m[35m        )[0m
[30;1m140 | [0m[35m        self.min_ckpt_period_batches = self.as_batches([0m
[30;1m141 | [0m[35m            **env.experiment_config.get_min_checkpoint_period()[0m
[30;1m142 | [0m[35m        )[0m
[30;1m143 | [0m[35m        if self.min_val_period_batches < 1:[0m
[30;1m144 | [0m[35m            self.min_val_period_batches = sys.maxsize[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m135 | [0m[35m                    "in epoch units."[0m
[30;1m136 | [0m[35m                )[0m
[30;1m137 | [0m[35m        self.min_val_period_batches = self.as_batches([0m
[30;1m138 | [0m[35m            **env.experiment_config.get_min_validation_period()[0m
[30;1m139 | [0m[35m        )[0m
[30;1m140 | [0m[35m        self.min_ckpt_period_batches = self.as_batches([0m
[30;1m141 | [0m[35m            **env.experiment_config.get_min_checkpoint_period()[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m128 | [0m[35m                    "in epoch units."[0m
[30;1m129 | [0m[35m                )[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        if env.experiment_config.get_min_validation_period().get("epochs") is not None:[0m
[30;1m132 | [0m[35m            if self.records_per_epoch is None:[0m
[30;1m133 | [0m[35m                raise ValueError([0m
[30;1m134 | [0m[35m                    "records_per_epoch must be specified if min_validation_period is configured "[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m121 | [0m[35m        # precalculated periods, in batches[0m
[30;1m122 | [0m[35m        self.records_per_epoch = env.experiment_config.get_records_per_epoch()[0m
[30;1m123 | [0m[35m        self.global_batch_size = global_batch_size[0m
[30;1m124 | [0m[35m        if env.experiment_config.get_min_checkpoint_period().get("epochs") is not None:[0m
[30;1m125 | [0m[35m            if self.records_per_epoch is None:[0m
[30;1m126 | [0m[35m                raise ValueError([0m
[30;1m127 | [0m[35m                    "records_per_epoch must be specified if min_checkpoint_period is configured "[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m119 | [0m[35m        self.state = self.SavableState(trial_id=self._trial_id)[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m        # precalculated periods, in batches[0m
[30;1m122 | [0m[35m        self.records_per_epoch = env.experiment_config.get_records_per_epoch()[0m
[30;1m123 | [0m[35m        self.global_batch_size = global_batch_size[0m
[30;1m124 | [0m[35m        if env.experiment_config.get_min_checkpoint_period().get("epochs") is not None:[0m
[30;1m125 | [0m[35m            if self.records_per_epoch is None:[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        self.want_initial_val = self.env.experiment_config.get("perform_initial_validation", False)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        self.ckpt_policy = self.env.experiment_config.get("checkpoint_policy", "best")[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        self.state = self.SavableState(trial_id=self._trial_id)[0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        self.val_from_previous_run = self.core_context.train._get_last_validation()[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        self.want_initial_val = self.env.experiment_config.get("perform_initial_validation", False)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        self.ckpt_policy = self.env.experiment_config.get("checkpoint_policy", "best")[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m35 | [0m[35m    if bucket is None:[0m
[30;1m36 | [0m[35m        return[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    endpoint_url = os.environ.get("DET_S3_ENDPOINT_URL")[0m
[30;1m39 | [0m[35m    client = boto3.client("s3", endpoint_url=endpoint_url)[0m
[30;1m40 | [0m[35m    bucket_location = client.get_bucket_location(Bucket=bucket)[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mdef set_s3_region() -> None:[0m
[30;1m34 | [0m[35m    bucket = os.environ.get("AWS_BUCKET")[0m
[30;1m35 | [0m[35m    if bucket is None:[0m
[30;1m36 | [0m[35m        return[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m283 | [0m[35m            # Optional info:[0m
[30;1m284 | [0m[35m            master_cert_name=os.environ.get("DET_MASTER_CERT_NAME"),[0m
[30;1m285 | [0m[35m            master_cert_file=os.environ.get("DET_MASTER_CERT_FILE"),[0m
[30;1m286 | [0m[35m            latest_checkpoint=os.environ.get("DET_LATEST_CHECKPOINT"),[0m
[30;1m287 | [0m[35m            # Separate info objects:[0m
[30;1m288 | [0m[35m            trial_info=TrialInfo._from_file(),[0m
[30;1m289 | [0m[35m            rendezvous_info=RendezvousInfo._from_file(),[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m282 | [0m[35m            task_type=os.environ["DET_TASK_TYPE"],[0m
[30;1m283 | [0m[35m            # Optional info:[0m
[30;1m284 | [0m[35m            master_cert_name=os.environ.get("DET_MASTER_CERT_NAME"),[0m
[30;1m285 | [0m[35m            master_cert_file=os.environ.get("DET_MASTER_CERT_FILE"),[0m
[30;1m286 | [0m[35m            latest_checkpoint=os.environ.get("DET_LATEST_CHECKPOINT"),[0m
[30;1m287 | [0m[35m            # Separate info objects:[0m
[30;1m288 | [0m[35m            trial_info=TrialInfo._from_file(),[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m281 | [0m[35m            session_token=os.environ["DET_SESSION_TOKEN"],[0m
[30;1m282 | [0m[35m            task_type=os.environ["DET_TASK_TYPE"],[0m
[30;1m283 | [0m[35m            # Optional info:[0m
[30;1m284 | [0m[35m            master_cert_name=os.environ.get("DET_MASTER_CERT_NAME"),[0m
[30;1m285 | [0m[35m            master_cert_file=os.environ.get("DET_MASTER_CERT_FILE"),[0m
[30;1m286 | [0m[35m            latest_checkpoint=os.environ.get("DET_LATEST_CHECKPOINT"),[0m
[30;1m287 | [0m[35m            # Separate info objects:[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m120 | [0m[35m            steps_completed=int(os.environ["DET_STEPS_COMPLETED"]),[0m
[30;1m121 | [0m[35m            trial_run_id=int(os.environ["DET_TRIAL_RUN_ID"]),[0m
[30;1m122 | [0m[35m            debug=experiment_config.get("debug", False),[0m
[30;1m123 | [0m[35m            inter_node_network_interface=os.environ.get("DET_INTER_NODE_NETWORK_INTERFACE"),[0m
[30;1m124 | [0m[35m        )[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    def _to_file(self, path: str = DEFAULT_TRIAL_INFO_PATH) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mdef getenv_int(key: str) -> Optional[int]:[0m
[30;1m15 | [0m[35m    val = os.environ.get(key)[0m
[30;1m16 | [0m[35m    return val if val is None else int(val)[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/tensorboard/fetchers/s3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m            "s3",[0m
[30;1m23 | [0m[35m            endpoint_url=storage_config.get("endpoint_url"),[0m
[30;1m24 | [0m[35m            aws_access_key_id=storage_config.get("access_key"),[0m
[30;1m25 | [0m[35m            aws_secret_access_key=storage_config.get("secret_key"),[0m
[30;1m26 | [0m[35m        )[0m
[30;1m27 | [0m[35m        self.client = self.s3.meta.client[0m
[30;1m28 | [0m[35m        self.bucket_name = str(storage_config["bucket"])[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m222 | [0m[35m            master_tls_cert = base64.b64encode(f.read()).decode()[0m
[30;1m223 | [0m[35m    if args.master_tls_key:[0m
[30;1m224 | [0m[35m        with open(args.master_tls_key, "rb") as f:[0m
[30;1m225 | [0m[35m            master_tls_key = base64.b64encode(f.read()).decode()[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    config_file_contents = {}[0m
[30;1m228 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m219 | [0m[35m    master_tls_cert = master_tls_key = ""[0m
[30;1m220 | [0m[35m    if args.master_tls_cert:[0m
[30;1m221 | [0m[35m        with open(args.master_tls_cert, "rb") as f:[0m
[30;1m222 | [0m[35m            master_tls_cert = base64.b64encode(f.read()).decode()[0m
[30;1m223 | [0m[35m    if args.master_tls_key:[0m
[30;1m224 | [0m[35m        with open(args.master_tls_key, "rb") as f:[0m
[30;1m225 | [0m[35m            master_tls_key = base64.b64encode(f.read()).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport getpass[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport pathlib[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m709 | [0m[35m                cli.Arg([0m
[30;1m710 | [0m[35m                    "--initial-user-password",[0m
[30;1m711 | [0m[35m                    type=str,[0m
[30;1m712 | [0m[35m                    help="Password for the default 'determined' and 'admin' users.",[0m
[30;1m713 | [0m[35m                ),[0m
[30;1m714 | [0m[35m            ],[0m
[30;1m715 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m707 | [0m[35m                    + " GenAI. Defaults to `/run/determined/workdir/shared_fs`",[0m
[30;1m708 | [0m[35m                ),[0m
[30;1m709 | [0m[35m                cli.Arg([0m
[30;1m710 | [0m[35m                    "--initial-user-password",[0m
[30;1m711 | [0m[35m                    type=str,[0m
[30;1m712 | [0m[35m                    help="Password for the default 'determined' and 'admin' users.",[0m
[30;1m713 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m686 | [0m[35m                cli.Arg([0m
[30;1m687 | [0m[35m                    "--docker-pass",[0m
[30;1m688 | [0m[35m                    type=str,[0m
[30;1m689 | [0m[35m                    help="Docker password used to pull the Determined master and agent images",[0m
[30;1m690 | [0m[35m                ),[0m
[30;1m691 | [0m[35m                cli.Arg([0m
[30;1m692 | [0m[35m                    "--notebook-timeout",[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m516 | [0m[35m                    "--db-password",[0m
[30;1m517 | [0m[35m                    type=str,[0m
[30;1m518 | [0m[35m                    default=constants.defaults.DB_PASSWORD,[0m
[30;1m519 | [0m[35m                    help="password for master database",[0m
[30;1m520 | [0m[35m                ),[0m
[30;1m521 | [0m[35m                cli.Arg([0m
[30;1m522 | [0m[35m                    "--db-snapshot",[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m515 | [0m[35m                cli.Arg([0m
[30;1m516 | [0m[35m                    "--db-password",[0m
[30;1m517 | [0m[35m                    type=str,[0m
[30;1m518 | [0m[35m                    default=constants.defaults.DB_PASSWORD,[0m
[30;1m519 | [0m[35m                    help="password for master database",[0m
[30;1m520 | [0m[35m                ),[0m
[30;1m521 | [0m[35m                cli.Arg([0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m513 | [0m[35m                    help=argparse.SUPPRESS,[0m
[30;1m514 | [0m[35m                ),[0m
[30;1m515 | [0m[35m                cli.Arg([0m
[30;1m516 | [0m[35m                    "--db-password",[0m
[30;1m517 | [0m[35m                    type=str,[0m
[30;1m518 | [0m[35m                    default=constants.defaults.DB_PASSWORD,[0m
[30;1m519 | [0m[35m                    help="password for master database",[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m305 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        deployment_object.add_parameters([0m
[30;1m308 | [0m[35m            {constants.cloudformation.INITIAL_USER_PASSWORD: initial_user_password}[0m
[30;1m309 | [0m[35m        )[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m    print("Starting Determined Deployment")[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m305 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        deployment_object.add_parameters([0m
[30;1m308 | [0m[35m            {constants.cloudformation.INITIAL_USER_PASSWORD: initial_user_password}[0m
[30;1m309 | [0m[35m        )[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m    print("Starting Determined Deployment")[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m304 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m305 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        deployment_object.add_parameters([0m
[30;1m308 | [0m[35m            {constants.cloudformation.INITIAL_USER_PASSWORD: initial_user_password}[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m304 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m305 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        deployment_object.add_parameters([0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m304 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m305 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        deployment_object.add_parameters([0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m300 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m304 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m305 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m306 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m300 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m304 | [0m[35m            if initial_user_password != initial_user_password_check:[0m
[30;1m305 | [0m[35m                raise ValueError("passwords did not match")[0m
[30;1m306 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m298 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m299 | [0m[35m        if not initial_user_password:[0m
[30;1m300 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m304 | [0m[35m            if initial_user_password != initial_user_password_check:[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m297 | [0m[35m    if not deployment_object.exists():[0m
[30;1m298 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m299 | [0m[35m        if not initial_user_password:[0m
[30;1m300 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m            initial_user_password_check = getpass.getpass("Enter the password again: ")[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m    if not deployment_object.exists():[0m
[30;1m298 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m299 | [0m[35m        if not initial_user_password:[0m
[30;1m300 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m
[30;1m302 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m295 | [0m[35m        preflight.check_quotas(det_configs, deployment_object)[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m    if not deployment_object.exists():[0m
[30;1m298 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m299 | [0m[35m        if not initial_user_password:[0m
[30;1m300 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m295 | [0m[35m        preflight.check_quotas(det_configs, deployment_object)[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m    if not deployment_object.exists():[0m
[30;1m298 | [0m[35m        initial_user_password = args.initial_user_password[0m
[30;1m299 | [0m[35m        if not initial_user_password:[0m
[30;1m300 | [0m[35m            initial_user_password = getpass.getpass([0m
[30;1m301 | [0m[35m                "Please enter a password for the built-in `determined` and `admin` users: "[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m247 | [0m[35m        constants.cloudformation.BOTO3_SESSION: boto3_session,[0m
[30;1m248 | [0m[35m        constants.cloudformation.VERSION: args.det_version,[0m
[30;1m249 | [0m[35m        constants.cloudformation.INBOUND_CIDR: args.inbound_cidr,[0m
[30;1m250 | [0m[35m        constants.cloudformation.DB_PASSWORD: args.db_password,[0m
[30;1m251 | [0m[35m        constants.cloudformation.DB_INSTANCE_TYPE: args.db_instance_type,[0m
[30;1m252 | [0m[35m        constants.cloudformation.DB_SNAPSHOT: args.db_snapshot,[0m
[30;1m253 | [0m[35m        constants.cloudformation.DB_SIZE: args.db_size,[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m247 | [0m[35m        constants.cloudformation.BOTO3_SESSION: boto3_session,[0m
[30;1m248 | [0m[35m        constants.cloudformation.VERSION: args.det_version,[0m
[30;1m249 | [0m[35m        constants.cloudformation.INBOUND_CIDR: args.inbound_cidr,[0m
[30;1m250 | [0m[35m        constants.cloudformation.DB_PASSWORD: args.db_password,[0m
[30;1m251 | [0m[35m        constants.cloudformation.DB_INSTANCE_TYPE: args.db_instance_type,[0m
[30;1m252 | [0m[35m        constants.cloudformation.DB_SNAPSHOT: args.db_snapshot,[0m
[30;1m253 | [0m[35m        constants.cloudformation.DB_SIZE: args.db_size,[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m182 | [0m[35m            # this precedence is implemented in the deployment template[0m
[30;1m183 | [0m[35m            print([0m
[30;1m184 | [0m[35m                "--db-snapshot and --db-password are mutually exclusive, "[0m
[30;1m185 | [0m[35m                "password value ignored as snapshot would take precedence"[0m
[30;1m186 | [0m[35m            )[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    if args.deployment_type != constants.deployment_types.GENAI:[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m181 | [0m[35m        if args.db_snapshot is not None and args.db_password != constants.defaults.DB_PASSWORD:[0m
[30;1m182 | [0m[35m            # this precedence is implemented in the deployment template[0m
[30;1m183 | [0m[35m            print([0m
[30;1m184 | [0m[35m                "--db-snapshot and --db-password are mutually exclusive, "[0m
[30;1m185 | [0m[35m                "password value ignored as snapshot would take precedence"[0m
[30;1m186 | [0m[35m            )[0m
[30;1m187 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m178 | [0m[35m        if args.db_size is not None and args.db_size < 20:[0m
[30;1m179 | [0m[35m            raise ValueError("--db-size must be greater than or equal to 20 GB")[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        if args.db_snapshot is not None and args.db_password != constants.defaults.DB_PASSWORD:[0m
[30;1m182 | [0m[35m            # this precedence is implemented in the deployment template[0m
[30;1m183 | [0m[35m            print([0m
[30;1m184 | [0m[35m                "--db-snapshot and --db-password are mutually exclusive, "[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m178 | [0m[35m        if args.db_size is not None and args.db_size < 20:[0m
[30;1m179 | [0m[35m            raise ValueError("--db-size must be greater than or equal to 20 GB")[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        if args.db_snapshot is not None and args.db_password != constants.defaults.DB_PASSWORD:[0m
[30;1m182 | [0m[35m            # this precedence is implemented in the deployment template[0m
[30;1m183 | [0m[35m            print([0m
[30;1m184 | [0m[35m                "--db-snapshot and --db-password are mutually exclusive, "[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/launch.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m69 | [0m[35m    assert info.task_type == "TRIAL", f'must be run with task_type="TRIAL", not "{info.task_type}"'[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    # Hack: get the resources id from the environment.[0m
[30;1m72 | [0m[35m    resources_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m73 | [0m[35m    assert resources_id is not None, "Unable to run with DET_RESOURCES_ID unset"[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    # Hack: read the full config.  The experiment config is not a stable API![0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/exec/launch.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m46 | [0m[35m    # Signals we want to forward from wrapper process to the child[0m
[30;1m47 | [0m[35m    sig_names = ["SIGINT", "SIGTERM", "SIGHUP", "SIGUSR1", "SIGUSR2", "SIGWINCH", "SIGBREAK"][0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    if os.environ.get("DET_RESOURCES_TYPE") == prep_container.RESOURCES_TYPE_SLURM_JOB:[0m
[30;1m50 | [0m[35m        # SLURM sends SIGTERM to notify of pending preemption, so we register a custom[0m
[30;1m51 | [0m[35m        # handler to intercept it in the chief rank, and ignore in others.   We invoke[0m
[30;1m52 | [0m[35m        # trigger_preemption to cause a checkpoint and clean exit (given enough time).[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m24 | [0m[35m        return bool(os.environ.get(self.TORCH, None))[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def use_deepspeed(self) -> bool:[0m
[30;1m27 | [0m[35m        return bool(os.environ.get(self.DEEPSPEED, None))[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mclass TrialController(metaclass=abc.ABCMeta):[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m21 | [0m[35m        return bool(os.environ.get(self.HOROVOD, None))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def use_torch(self) -> bool:[0m
[30;1m24 | [0m[35m        return bool(os.environ.get(self.TORCH, None))[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def use_deepspeed(self) -> bool:[0m
[30;1m27 | [0m[35m        return bool(os.environ.get(self.DEEPSPEED, None))[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35m    TORCH = "USE_TORCH_DISTRIBUTED"[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    def use_horovod(self) -> bool:[0m
[30;1m21 | [0m[35m        return bool(os.environ.get(self.HOROVOD, None))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def use_torch(self) -> bool:[0m
[30;1m24 | [0m[35m        return bool(os.environ.get(self.TORCH, None))[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m        return s3.S3TensorboardManager([0m
[30;1m109 | [0m[35m            checkpoint_config["bucket"],[0m
[30;1m110 | [0m[35m            checkpoint_config.get("access_key", None),[0m
[30;1m111 | [0m[35m            checkpoint_config.get("secret_key", None),[0m
[30;1m112 | [0m[35m            checkpoint_config.get("endpoint_url", None),[0m
[30;1m113 | [0m[35m            checkpoint_config.get("prefix", None),[0m
[30;1m114 | [0m[35m            base_path,[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef get_base_path(checkpoint_config: Dict[str, Any]) -> pathlib.Path:[0m
[30;1m31 | [0m[35m    allocation_id = os.environ.get("DET_ALLOCATION_ID", "")[0m
[30;1m32 | [0m[35m    rank = get_rank_if_horovod_process_else_return_zero()[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    if checkpoint_config.get("base_path"):[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m460 | [0m[35m        master_name=f"{cluster_name}_{MASTER_NAME}",[0m
[30;1m461 | [0m[35m        image_repo_prefix=image_repo_prefix,[0m
[30;1m462 | [0m[35m        version=version,[0m
[30;1m463 | [0m[35m        db_password=db_password,[0m
[30;1m464 | [0m[35m        delete_db=delete_db,[0m
[30;1m465 | [0m[35m        autorestart=autorestart,[0m
[30;1m466 | [0m[35m        cluster_name=cluster_name,[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m460 | [0m[35m        master_name=f"{cluster_name}_{MASTER_NAME}",[0m
[30;1m461 | [0m[35m        image_repo_prefix=image_repo_prefix,[0m
[30;1m462 | [0m[35m        version=version,[0m
[30;1m463 | [0m[35m        db_password=db_password,[0m
[30;1m464 | [0m[35m        delete_db=delete_db,[0m
[30;1m465 | [0m[35m        autorestart=autorestart,[0m
[30;1m466 | [0m[35m        cluster_name=cluster_name,[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m454 | [0m[35m    cluster_down(cluster_name, delete_db)[0m
[30;1m455 | [0m[35m    master_up([0m
[30;1m456 | [0m[35m        port=port,[0m
[30;1m457 | [0m[35m        initial_user_password=initial_user_password,[0m
[30;1m458 | [0m[35m        master_config_path=master_config_path,[0m
[30;1m459 | [0m[35m        storage_host_path=storage_host_path,[0m
[30;1m460 | [0m[35m        master_name=f"{cluster_name}_{MASTER_NAME}",[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m454 | [0m[35m    cluster_down(cluster_name, delete_db)[0m
[30;1m455 | [0m[35m    master_up([0m
[30;1m456 | [0m[35m        port=port,[0m
[30;1m457 | [0m[35m        initial_user_password=initial_user_password,[0m
[30;1m458 | [0m[35m        master_config_path=master_config_path,[0m
[30;1m459 | [0m[35m        storage_host_path=storage_host_path,[0m
[30;1m460 | [0m[35m        master_name=f"{cluster_name}_{MASTER_NAME}",[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m444 | [0m[35m    cluster_name: str,[0m
[30;1m445 | [0m[35m    image_repo_prefix: str,[0m
[30;1m446 | [0m[35m    version: str,[0m
[30;1m447 | [0m[35m    db_password: str,[0m
[30;1m448 | [0m[35m    delete_db: bool,[0m
[30;1m449 | [0m[35m    gpu: bool,[0m
[30;1m450 | [0m[35m    autorestart: bool,[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m438 | [0m[35mdef cluster_up([0m
[30;1m439 | [0m[35m    num_agents: int,[0m
[30;1m440 | [0m[35m    port: int,[0m
[30;1m441 | [0m[35m    initial_user_password: Optional[str],[0m
[30;1m442 | [0m[35m    master_config_path: Optional[pathlib.Path],[0m
[30;1m443 | [0m[35m    storage_host_path: pathlib.Path,[0m
[30;1m444 | [0m[35m    cluster_name: str,[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35mdef db_up(name: str, password: str, network_name: str, cluster_name: str, volume_name: str) -> None:[0m
[30;1m381 | [0m[35m    print(f"Creating {name}...")[0m
[30;1m382 | [0m[35m    env = {"PGUSER": "postgres", "POSTGRES_DB": "determined", "POSTGRES_PASSWORD": password}[0m
[30;1m383 | [0m[35m    client = docker_client()[0m
[30;1m384 | [0m[35m    client.containers.run([0m
[30;1m385 | [0m[35m        image="postgres:10.14",[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35mdef db_up(name: str, password: str, network_name: str, cluster_name: str, volume_name: str) -> None:[0m
[30;1m381 | [0m[35m    print(f"Creating {name}...")[0m
[30;1m382 | [0m[35m    env = {"PGUSER": "postgres", "POSTGRES_DB": "determined", "POSTGRES_PASSWORD": password}[0m
[30;1m383 | [0m[35m    client = docker_client()[0m
[30;1m384 | [0m[35m    client.containers.run([0m
[30;1m385 | [0m[35m        image="postgres:10.14",[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m377 | [0m[35m        exit_stack.pop_all()[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35mdef db_up(name: str, password: str, network_name: str, cluster_name: str, volume_name: str) -> None:[0m
[30;1m381 | [0m[35m    print(f"Creating {name}...")[0m
[30;1m382 | [0m[35m    env = {"PGUSER": "postgres", "POSTGRES_DB": "determined", "POSTGRES_PASSWORD": password}[0m
[30;1m383 | [0m[35m    client = docker_client()[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m370 | [0m[35m                    )[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m            except api.errors.UnauthenticatedException:[0m
[30;1m373 | [0m[35m                # There was a non-generated password there already; carry on[0m
[30;1m374 | [0m[35m                pass[0m
[30;1m375 | [0m[35m[0m
[30;1m376 | [0m[35m        # Remove all cleanup methods from ExitStack.[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m366 | [0m[35m                    # the password so users aren't locked out[0m
[30;1m367 | [0m[35m                    print([0m
[30;1m368 | [0m[35m                        "A password has been created for you. The admin and determined users "[0m
[30;1m369 | [0m[35m                        + f"can log in with this password:\n\t{generated_user_password}\n"[0m
[30;1m370 | [0m[35m                    )[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m            except api.errors.UnauthenticatedException:[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m366 | [0m[35m                    # the password so users aren't locked out[0m
[30;1m367 | [0m[35m                    print([0m
[30;1m368 | [0m[35m                        "A password has been created for you. The admin and determined users "[0m
[30;1m369 | [0m[35m                        + f"can log in with this password:\n\t{generated_user_password}\n"[0m
[30;1m370 | [0m[35m                    )[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m            except api.errors.UnauthenticatedException:[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m365 | [0m[35m                    # are problems with the deployment itself, so just print[0m
[30;1m366 | [0m[35m                    # the password so users aren't locked out[0m
[30;1m367 | [0m[35m                    print([0m
[30;1m368 | [0m[35m                        "A password has been created for you. The admin and determined users "[0m
[30;1m369 | [0m[35m                        + f"can log in with this password:\n\t{generated_user_password}\n"[0m
[30;1m370 | [0m[35m                    )[0m
[30;1m371 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m363 | [0m[35m                    # User could exit, or might be unable to pass validation,[0m
[30;1m364 | [0m[35m                    # or this might not even be interactive; none of these[0m
[30;1m365 | [0m[35m                    # are problems with the deployment itself, so just print[0m
[30;1m366 | [0m[35m                    # the password so users aren't locked out[0m
[30;1m367 | [0m[35m                    print([0m
[30;1m368 | [0m[35m                        "A password has been created for you. The admin and determined users "[0m
[30;1m369 | [0m[35m                        + f"can log in with this password:\n\t{generated_user_password}\n"[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m359 | [0m[35m                        user = d.get_user_by_name("determined")[0m
[30;1m360 | [0m[35m                        user.change_password(new_password)[0m
[30;1m361 | [0m[35m                        user = d.get_user_by_name("admin")[0m
[30;1m362 | [0m[35m                        user.change_password(new_password)[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m                except Exception:[0m
[30;1m365 | [0m[35m                    # User could exit, or might be unable to pass validation,[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m359 | [0m[35m                        user = d.get_user_by_name("determined")[0m
[30;1m360 | [0m[35m                        user.change_password(new_password)[0m
[30;1m361 | [0m[35m                        user = d.get_user_by_name("admin")[0m
[30;1m362 | [0m[35m                        user.change_password(new_password)[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m                except Exception:[0m
[30;1m365 | [0m[35m                    # User could exit, or might be unable to pass validation,[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m                        d = determined.Determined._from_session(sess)[0m
[30;1m357 | [0m[35m                        user = d.get_user_by_name("determined")[0m
[30;1m358 | [0m[35m                        user.change_password(new_password)[0m
[30;1m359 | [0m[35m                        user = d.get_user_by_name("admin")[0m
[30;1m360 | [0m[35m                        user.change_password(new_password)[0m
[30;1m361 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m                        d = determined.Determined._from_session(sess)[0m
[30;1m357 | [0m[35m                        user = d.get_user_by_name("determined")[0m
[30;1m358 | [0m[35m                        user.change_password(new_password)[0m
[30;1m359 | [0m[35m                        user = d.get_user_by_name("admin")[0m
[30;1m360 | [0m[35m                        user.change_password(new_password)[0m
[30;1m361 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m351 | [0m[35m                        authentication.check_password_complexity(new_password)[0m
[30;1m352 | [0m[35m                        new_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m353 | [0m[35m                        if new_password != new_password_check:[0m
[30;1m354 | [0m[35m                            raise ValueError("passwords did not match")[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m                        d = determined.Determined._from_session(sess)[0m
[30;1m357 | [0m[35m                        user = d.get_user_by_name("determined")[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m                        authentication.check_password_complexity(new_password)[0m
[30;1m352 | [0m[35m                        new_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m353 | [0m[35m                        if new_password != new_password_check:[0m
[30;1m354 | [0m[35m                            raise ValueError("passwords did not match")[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m                        d = determined.Determined._from_session(sess)[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m                        authentication.check_password_complexity(new_password)[0m
[30;1m352 | [0m[35m                        new_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m353 | [0m[35m                        if new_password != new_password_check:[0m
[30;1m354 | [0m[35m                            raise ValueError("passwords did not match")[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m                        d = determined.Determined._from_session(sess)[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m349 | [0m[35m                            new_password = getpass.getpass(prompt)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m                        authentication.check_password_complexity(new_password)[0m
[30;1m352 | [0m[35m                        new_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m353 | [0m[35m                        if new_password != new_password_check:[0m
[30;1m354 | [0m[35m                            raise ValueError("passwords did not match")[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m349 | [0m[35m                            new_password = getpass.getpass(prompt)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m                        authentication.check_password_complexity(new_password)[0m
[30;1m352 | [0m[35m                        new_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m353 | [0m[35m                        if new_password != new_password_check:[0m
[30;1m354 | [0m[35m                            raise ValueError("passwords did not match")[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m348 | [0m[35m                            print(e)[0m
[30;1m349 | [0m[35m                            new_password = getpass.getpass(prompt)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m                        authentication.check_password_complexity(new_password)[0m
[30;1m352 | [0m[35m                        new_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m353 | [0m[35m                        if new_password != new_password_check:[0m
[30;1m354 | [0m[35m                            raise ValueError("passwords did not match")[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m348 | [0m[35m                            print(e)[0m
[30;1m349 | [0m[35m                            new_password = getpass.getpass(prompt)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m                        authentication.check_password_complexity(new_password)[0m
[30;1m352 | [0m[35m                        new_password_check = getpass.getpass("Enter the password again: ")[0m
[30;1m353 | [0m[35m                        if new_password != new_password_check:[0m
[30;1m354 | [0m[35m                            raise ValueError("passwords did not match")[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m346 | [0m[35m                            authentication.check_password_complexity(new_password)[0m
[30;1m347 | [0m[35m                        except ValueError as e:[0m
[30;1m348 | [0m[35m                            print(e)[0m
[30;1m349 | [0m[35m                            new_password = getpass.getpass(prompt)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m                        authentication.check_password_complexity(new_password)[0m
[30;1m352 | [0m[35m                        new_password_check = getpass.getpass("Enter the password again: ")[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m343 | [0m[35m                        new_password = getpass.getpass(prompt)[0m
[30;1m344 | [0m[35m                        # Give one more chance if this password is too weak[0m
[30;1m345 | [0m[35m                        try:[0m
[30;1m346 | [0m[35m                            authentication.check_password_complexity(new_password)[0m
[30;1m347 | [0m[35m                        except ValueError as e:[0m
[30;1m348 | [0m[35m                            print(e)[0m
[30;1m349 | [0m[35m                            new_password = getpass.getpass(prompt)[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m343 | [0m[35m                        new_password = getpass.getpass(prompt)[0m
[30;1m344 | [0m[35m                        # Give one more chance if this password is too weak[0m
[30;1m345 | [0m[35m                        try:[0m
[30;1m346 | [0m[35m                            authentication.check_password_complexity(new_password)[0m
[30;1m347 | [0m[35m                        except ValueError as e:[0m
[30;1m348 | [0m[35m                            print(e)[0m
[30;1m349 | [0m[35m                            new_password = getpass.getpass(prompt)[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m341 | [0m[35m                            + "`determined` and `admin` users: "[0m
[30;1m342 | [0m[35m                        )[0m
[30;1m343 | [0m[35m                        new_password = getpass.getpass(prompt)[0m
[30;1m344 | [0m[35m                        # Give one more chance if this password is too weak[0m
[30;1m345 | [0m[35m                        try:[0m
[30;1m346 | [0m[35m                            authentication.check_password_complexity(new_password)[0m
[30;1m347 | [0m[35m                        except ValueError as e:[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m340 | [0m[35m                            "Please enter a password for the built-in "[0m
[30;1m341 | [0m[35m                            + "`determined` and `admin` users: "[0m
[30;1m342 | [0m[35m                        )[0m
[30;1m343 | [0m[35m                        new_password = getpass.getpass(prompt)[0m
[30;1m344 | [0m[35m                        # Give one more chance if this password is too weak[0m
[30;1m345 | [0m[35m                        try:[0m
[30;1m346 | [0m[35m                            authentication.check_password_complexity(new_password)[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m337 | [0m[35m                    with warnings.catch_warnings():[0m
[30;1m338 | [0m[35m                        warnings.filterwarnings(action="error", category=getpass.GetPassWarning)[0m
[30;1m339 | [0m[35m                        prompt = ([0m
[30;1m340 | [0m[35m                            "Please enter a password for the built-in "[0m
[30;1m341 | [0m[35m                            + "`determined` and `admin` users: "[0m
[30;1m342 | [0m[35m                        )[0m
[30;1m343 | [0m[35m                        new_password = getpass.getpass(prompt)[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m332 | [0m[35m                        raise EOFError[0m
[30;1m333 | [0m[35m                    # getpass raises this warning instead of an exception if it can't find the[0m
[30;1m334 | [0m[35m                    # terminal, which almost always means we're not going to be able to receive[0m
[30;1m335 | [0m[35m                    # a password interactively and securely, so should abort quickly rather[0m
[30;1m336 | [0m[35m                    # than time out.[0m
[30;1m337 | [0m[35m                    with warnings.catch_warnings():[0m
[30;1m338 | [0m[35m                        warnings.filterwarnings(action="error", category=getpass.GetPassWarning)[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m324 | [0m[35m                print([0m
[30;1m325 | [0m[35m                    "Determined Master was launched without a strong initial_user_password set. "[0m
[30;1m326 | [0m[35m                    + "Please set a strong password by following prompts, or by logging in "[0m
[30;1m327 | [0m[35m                    + "with generated passwords and following the password change process."[0m
[30;1m328 | [0m[35m                )[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m                try:[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m324 | [0m[35m                print([0m
[30;1m325 | [0m[35m                    "Determined Master was launched without a strong initial_user_password set. "[0m
[30;1m326 | [0m[35m                    + "Please set a strong password by following prompts, or by logging in "[0m
[30;1m327 | [0m[35m                    + "with generated passwords and following the password change process."[0m
[30;1m328 | [0m[35m                )[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m                try:[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m323 | [0m[35m                # No exception was raised, so this generated password is the way to log in.[0m
[30;1m324 | [0m[35m                print([0m
[30;1m325 | [0m[35m                    "Determined Master was launched without a strong initial_user_password set. "[0m
[30;1m326 | [0m[35m                    + "Please set a strong password by following prompts, or by logging in "[0m
[30;1m327 | [0m[35m                    + "with generated passwords and following the password change process."[0m
[30;1m328 | [0m[35m                )[0m
[30;1m329 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m                # No exception was raised, so this generated password is the way to log in.[0m
[30;1m324 | [0m[35m                print([0m
[30;1m325 | [0m[35m                    "Determined Master was launched without a strong initial_user_password set. "[0m
[30;1m326 | [0m[35m                    + "Please set a strong password by following prompts, or by logging in "[0m
[30;1m327 | [0m[35m                    + "with generated passwords and following the password change process."[0m
[30;1m328 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m320 | [0m[35m                ).with_retry(util.get_max_retries_config())[0m
[30;1m321 | [0m[35m                sess.get("/api/v1/me")[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m                # No exception was raised, so this generated password is the way to log in.[0m
[30;1m324 | [0m[35m                print([0m
[30;1m325 | [0m[35m                    "Determined Master was launched without a strong initial_user_password set. "[0m
[30;1m326 | [0m[35m                    + "Please set a strong password by following prompts, or by logging in "[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m316 | [0m[35m        if generated_user_password is not None:[0m
[30;1m317 | [0m[35m            try:[0m
[30;1m318 | [0m[35m                sess = authentication.login([0m
[30;1m319 | [0m[35m                    f"http://localhost:{port}", "admin", generated_user_password[0m
[30;1m320 | [0m[35m                ).with_retry(util.get_max_retries_config())[0m
[30;1m321 | [0m[35m                sess.get("/api/v1/me")[0m
[30;1m322 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m        _wait_for_master(f"http://localhost:{port}", cluster_name)[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m        if generated_user_password is not None:[0m
[30;1m317 | [0m[35m            try:[0m
[30;1m318 | [0m[35m                sess = authentication.login([0m
[30;1m319 | [0m[35m                    f"http://localhost:{port}", "admin", generated_user_password[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m273 | [0m[35m        exit_stack.enter_context(defer_cleanup(lambda: db_down(db_name, VOLUME_NAME, delete_db)))[0m
[30;1m274 | [0m[35m        db_up([0m
[30;1m275 | [0m[35m            name=db_name,[0m
[30;1m276 | [0m[35m            password=db_password,[0m
[30;1m277 | [0m[35m            network_name=NETWORK_NAME,[0m
[30;1m278 | [0m[35m            cluster_name=cluster_name,[0m
[30;1m279 | [0m[35m            volume_name=volume_name,[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m273 | [0m[35m        exit_stack.enter_context(defer_cleanup(lambda: db_down(db_name, VOLUME_NAME, delete_db)))[0m
[30;1m274 | [0m[35m        db_up([0m
[30;1m275 | [0m[35m            name=db_name,[0m
[30;1m276 | [0m[35m            password=db_password,[0m
[30;1m277 | [0m[35m            network_name=NETWORK_NAME,[0m
[30;1m278 | [0m[35m            cluster_name=cluster_name,[0m
[30;1m279 | [0m[35m            volume_name=volume_name,[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m238 | [0m[35m    restart_policy = "unless-stopped" if autorestart else "no"[0m
[30;1m239 | [0m[35m    env = {[0m
[30;1m240 | [0m[35m        "DET_MASTER_HTTP_PORT": str(port),[0m
[30;1m241 | [0m[35m        "DET_DB_PASSWORD": db_password,[0m
[30;1m242 | [0m[35m        "DET_LOG_INFO": "info",[0m
[30;1m243 | [0m[35m    }[0m
[30;1m244 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m238 | [0m[35m    restart_policy = "unless-stopped" if autorestart else "no"[0m
[30;1m239 | [0m[35m    env = {[0m
[30;1m240 | [0m[35m        "DET_MASTER_HTTP_PORT": str(port),[0m
[30;1m241 | [0m[35m        "DET_DB_PASSWORD": db_password,[0m
[30;1m242 | [0m[35m        "DET_LOG_INFO": "info",[0m
[30;1m243 | [0m[35m    }[0m
[30;1m244 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m197 | [0m[35m        random.shuffle(random_password)[0m
[30;1m198 | [0m[35m        generated_user_password = "".join(random_password)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        master_conf["security"]["initial_user_password"] = generated_user_password[0m
[30;1m201 | [0m[35m        make_temp_conf = True[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    if storage_host_path is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m197 | [0m[35m        random.shuffle(random_password)[0m
[30;1m198 | [0m[35m        generated_user_password = "".join(random_password)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        master_conf["security"]["initial_user_password"] = generated_user_password[0m
[30;1m201 | [0m[35m        make_temp_conf = True[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    if storage_host_path is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m        ][0m
[30;1m196 | [0m[35m        random_password.extend([secrets.choice(random_password_characters) for _ in range(13)])[0m
[30;1m197 | [0m[35m        random.shuffle(random_password)[0m
[30;1m198 | [0m[35m        generated_user_password = "".join(random_password)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        master_conf["security"]["initial_user_password"] = generated_user_password[0m
[30;1m201 | [0m[35m        make_temp_conf = True[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m        ][0m
[30;1m196 | [0m[35m        random_password.extend([secrets.choice(random_password_characters) for _ in range(13)])[0m
[30;1m197 | [0m[35m        random.shuffle(random_password)[0m
[30;1m198 | [0m[35m        generated_user_password = "".join(random_password)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        master_conf["security"]["initial_user_password"] = generated_user_password[0m
[30;1m201 | [0m[35m        make_temp_conf = True[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m194 | [0m[35m            secrets.choice(string.digits),[0m
[30;1m195 | [0m[35m        ][0m
[30;1m196 | [0m[35m        random_password.extend([secrets.choice(random_password_characters) for _ in range(13)])[0m
[30;1m197 | [0m[35m        random.shuffle(random_password)[0m
[30;1m198 | [0m[35m        generated_user_password = "".join(random_password)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        master_conf["security"]["initial_user_password"] = generated_user_password[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m193 | [0m[35m            secrets.choice(string.ascii_uppercase),[0m
[30;1m194 | [0m[35m            secrets.choice(string.digits),[0m
[30;1m195 | [0m[35m        ][0m
[30;1m196 | [0m[35m        random_password.extend([secrets.choice(random_password_characters) for _ in range(13)])[0m
[30;1m197 | [0m[35m        random.shuffle(random_password)[0m
[30;1m198 | [0m[35m        generated_user_password = "".join(random_password)[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m193 | [0m[35m            secrets.choice(string.ascii_uppercase),[0m
[30;1m194 | [0m[35m            secrets.choice(string.digits),[0m
[30;1m195 | [0m[35m        ][0m
[30;1m196 | [0m[35m        random_password.extend([secrets.choice(random_password_characters) for _ in range(13)])[0m
[30;1m197 | [0m[35m        random.shuffle(random_password)[0m
[30;1m198 | [0m[35m        generated_user_password = "".join(random_password)[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m188 | [0m[35m        )[0m
[30;1m189 | [0m[35m    except ValueError:[0m
[30;1m190 | [0m[35m        random_password_characters = string.ascii_uppercase + string.ascii_lowercase + string.digits[0m
[30;1m191 | [0m[35m        random_password = [[0m
[30;1m192 | [0m[35m            secrets.choice(string.ascii_lowercase),[0m
[30;1m193 | [0m[35m            secrets.choice(string.ascii_uppercase),[0m
[30;1m194 | [0m[35m            secrets.choice(string.digits),[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m187 | [0m[35m            master_conf["security"].get("initial_user_password")[0m
[30;1m188 | [0m[35m        )[0m
[30;1m189 | [0m[35m    except ValueError:[0m
[30;1m190 | [0m[35m        random_password_characters = string.ascii_uppercase + string.ascii_lowercase + string.digits[0m
[30;1m191 | [0m[35m        random_password = [[0m
[30;1m192 | [0m[35m            secrets.choice(string.ascii_lowercase),[0m
[30;1m193 | [0m[35m            secrets.choice(string.ascii_uppercase),[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    try:[0m
[30;1m186 | [0m[35m        authentication.check_password_complexity([0m
[30;1m187 | [0m[35m            master_conf["security"].get("initial_user_password")[0m
[30;1m188 | [0m[35m        )[0m
[30;1m189 | [0m[35m    except ValueError:[0m
[30;1m190 | [0m[35m        random_password_characters = string.ascii_uppercase + string.ascii_lowercase + string.digits[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m183 | [0m[35m        make_temp_conf = True[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    try:[0m
[30;1m186 | [0m[35m        authentication.check_password_complexity([0m
[30;1m187 | [0m[35m            master_conf["security"].get("initial_user_password")[0m
[30;1m188 | [0m[35m        )[0m
[30;1m189 | [0m[35m    except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m179 | [0m[35m        master_conf["security"] = {}[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    if initial_user_password is not None:[0m
[30;1m182 | [0m[35m        master_conf["security"]["initial_user_password"] = initial_user_password[0m
[30;1m183 | [0m[35m        make_temp_conf = True[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m179 | [0m[35m        master_conf["security"] = {}[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    if initial_user_password is not None:[0m
[30;1m182 | [0m[35m        master_conf["security"]["initial_user_password"] = initial_user_password[0m
[30;1m183 | [0m[35m        make_temp_conf = True[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m178 | [0m[35m    if master_conf.get("security") is None:[0m
[30;1m179 | [0m[35m        master_conf["security"] = {}[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    if initial_user_password is not None:[0m
[30;1m182 | [0m[35m        master_conf["security"]["initial_user_password"] = initial_user_password[0m
[30;1m183 | [0m[35m        make_temp_conf = True[0m
[30;1m184 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m163 | [0m[35m    # Some cli flags for det deploy local will cause us to write a temporary master.yaml.[0m
[30;1m164 | [0m[35m    make_temp_conf = False[0m
[30;1m165 | [0m[35m    # If we have to generate a password for the user, we should print it later.[0m
[30;1m166 | [0m[35m    generated_user_password = None[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    if master_name is None:[0m
[30;1m169 | [0m[35m        master_name = f"{cluster_name}_{MASTER_NAME}"[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m162 | [0m[35m) -> None:[0m
[30;1m163 | [0m[35m    # Some cli flags for det deploy local will cause us to write a temporary master.yaml.[0m
[30;1m164 | [0m[35m    make_temp_conf = False[0m
[30;1m165 | [0m[35m    # If we have to generate a password for the user, we should print it later.[0m
[30;1m166 | [0m[35m    generated_user_password = None[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    if master_name is None:[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m153 | [0m[35m    master_name: Optional[str],[0m
[30;1m154 | [0m[35m    image_repo_prefix: str,[0m
[30;1m155 | [0m[35m    version: str,[0m
[30;1m156 | [0m[35m    db_password: str,[0m
[30;1m157 | [0m[35m    delete_db: bool,[0m
[30;1m158 | [0m[35m    autorestart: bool,[0m
[30;1m159 | [0m[35m    cluster_name: str,[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35mdef master_up([0m
[30;1m149 | [0m[35m    port: int,[0m
[30;1m150 | [0m[35m    initial_user_password: Optional[str],[0m
[30;1m151 | [0m[35m    master_config_path: Optional[pathlib.Path],[0m
[30;1m152 | [0m[35m    storage_host_path: pathlib.Path,[0m
[30;1m153 | [0m[35m    master_name: Optional[str],[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35mdef db_up(name: str, password: str, network_name: str, cluster_name: str, volume_name: str) -> None:[0m
[30;1m381 | [0m[35m    print(f"Creating {name}...")[0m
[30;1m382 | [0m[35m    env = {"PGUSER": "postgres", "POSTGRES_DB": "determined", "POSTGRES_PASSWORD": password}[0m
[30;1m383 | [0m[35m    client = docker_client()[0m
[30;1m384 | [0m[35m    client.containers.run([0m
[30;1m385 | [0m[35m        image="postgres:10.14",[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/tensorboard/s3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35m            "s3",[0m
[30;1m38 | [0m[35m            endpoint_url=endpoint_url,[0m
[30;1m39 | [0m[35m            aws_access_key_id=access_key,[0m
[30;1m40 | [0m[35m            aws_secret_access_key=secret_key,[0m
[30;1m41 | [0m[35m        )[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        self.prefix = storage.normalize_prefix(prefix)[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/tensorboard/s3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m            "s3",[0m
[30;1m32 | [0m[35m            endpoint_url=endpoint_url,[0m
[30;1m33 | [0m[35m            aws_access_key_id=access_key,[0m
[30;1m34 | [0m[35m            aws_secret_access_key=secret_key,[0m
[30;1m35 | [0m[35m        )[0m
[30;1m36 | [0m[35m        self.resource = boto3.resource([0m
[30;1m37 | [0m[35m            "s3",[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/tensorboard/s3.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m        self,[0m
[30;1m18 | [0m[35m        bucket: str,[0m
[30;1m19 | [0m[35m        access_key: Optional[str],[0m
[30;1m20 | [0m[35m        secret_key: Optional[str],[0m
[30;1m21 | [0m[35m        endpoint_url: Optional[str],[0m
[30;1m22 | [0m[35m        prefix: Optional[str],[0m
[30;1m23 | [0m[35m        *args: Any,[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m252 | [0m[35m    if distributed_backend.use_deepspeed():[0m
[30;1m253 | [0m[35m        # We use an environment variable to allow users to enable custom initialization routine for[0m
[30;1m254 | [0m[35m        # distributed training since the pre_execute_hook runs before trial initialization.[0m
[30;1m255 | [0m[35m        manual_dist_init = os.environ.get("DET_MANUAL_INIT_DISTRIBUTED")[0m
[30;1m256 | [0m[35m        if not manual_dist_init:[0m
[30;1m257 | [0m[35m            deepspeed.init_distributed(auto_mpi_discovery=False)[0m
[30;1m258 | [0m[35m        return core.DistributedContext.from_deepspeed()[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m21925 | [0m[35m    session: "api.BaseSession",[0m
[30;1m21926 | [0m[35m    *,[0m
[30;1m21927 | [0m[35m    id: int,[0m
[30;1m21928 | [0m[35m) -> "v1ListWorkspaceNamespaceBindingsResponse":[0m
[30;1m21929 | [0m[35m    """List namespaces bound to a workspace.[0m
[30;1m21930 | [0m[35m[0m
[30;1m21931 | [0m[35m    - id: The unique id of the workspace.[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m21513 | [0m[35m[0m
[30;1m21514 | [0m[35mdef get_GetWorkspacesWithDefaultNamespaceBindings([0m
[30;1m21515 | [0m[35m    session: "api.BaseSession",[0m
[30;1m21516 | [0m[35m) -> "v1GetWorkspacesWithDefaultNamespaceBindingsResponse":[0m
[30;1m21517 | [0m[35m    """Gets the ids of all workspaces that are bound to the default namespace for[0m
[30;1m21518 | [0m[35m    atleast one cluster.[0m
[30;1m21519 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m21059 | [0m[35m    session: "api.BaseSession",[0m
[30;1m21060 | [0m[35m    *,[0m
[30;1m21061 | [0m[35m    id: int,[0m
[30;1m21062 | [0m[35m) -> "v1GetTrialRemainingLogRetentionDaysResponse":[0m
[30;1m21063 | [0m[35m    """Get the list of trials for an experiment.[0m
[30;1m21064 | [0m[35m[0m
[30;1m21065 | [0m[35m    - id: The trial id.[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m19356 | [0m[35m    *,[0m
[30;1m19357 | [0m[35m    workspaceId: int,[0m
[30;1m19358 | [0m[35m    name: "typing.Optional[str]" = None,[0m
[30;1m19359 | [0m[35m) -> "v1GetGroupsAndUsersAssignedToWorkspaceResponse":[0m
[30;1m19360 | [0m[35m    """Get groups and users assigned to a given workspace with what roles are[0m
[30;1m19361 | [0m[35m    assigned.[0m
[30;1m19362 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m19103 | [0m[35m    session: "api.BaseSession",[0m
[30;1m19104 | [0m[35m    *,[0m
[30;1m19105 | [0m[35m    experimentId: int,[0m
[30;1m19106 | [0m[35m) -> "v1GetExperimentValidationHistoryResponse":[0m
[30;1m19107 | [0m[35m    """Get the validation history for an experiment.[0m
[30;1m19108 | [0m[35m[0m
[30;1m19109 | [0m[35m    - experimentId: The id of the experiment.[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m18754 | [0m[35m    session: "api.BaseSession",[0m
[30;1m18755 | [0m[35m    *,[0m
[30;1m18756 | [0m[35m    experimentId: int,[0m
[30;1m18757 | [0m[35m) -> "v1GetBestSearcherValidationMetricResponse":[0m
[30;1m18758 | [0m[35m    """Get the best searcher validation for an experiment by the given metric.[0m
[30;1m18759 | [0m[35m[0m
[30;1m18760 | [0m[35m    - experimentId: The ID of the experiment.[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m17666 | [0m[35mdef post_BulkAutoCreateWorkspaceNamespaceBindings([0m
[30;1m17667 | [0m[35m    session: "api.BaseSession",[0m
[30;1m17668 | [0m[35m    *,[0m
[30;1m17669 | [0m[35m    body: "v1BulkAutoCreateWorkspaceNamespaceBindingsRequest",[0m
[30;1m17670 | [0m[35m) -> None:[0m
[30;1m17671 | [0m[35m    """Binds the given workpaces to new auto-created namespaces."""[0m
[30;1m17672 | [0m[35m    _params = None[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m17305 | [0m[35m    session: "api.BaseSession",[0m
[30;1m17306 | [0m[35m    *,[0m
[30;1m17307 | [0m[35m    allocationId: str,[0m
[30;1m17308 | [0m[35m    body: "v1AllocationPendingPreemptionSignalRequest",[0m
[30;1m17309 | [0m[35m) -> None:[0m
[30;1m17310 | [0m[35m    """Report the receipt of a signal to stop the given allocation early.[0m
[30;1m17311 | [0m[35m    This is used to communicate back from a SLURM job that it has been[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m8430 | [0m[35m        self.namespaceBindings = namespaceBindings[0m
[30;1m8431 | [0m[35m[0m
[30;1m8432 | [0m[35m    @classmethod[0m
[30;1m8433 | [0m[35m    def from_json(cls, obj: Json) -> "v1ListWorkspaceNamespaceBindingsResponse":[0m
[30;1m8434 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m8435 | [0m[35m            "namespaceBindings": {k: v1WorkspaceNamespaceBinding.from_json(v) for k, v in obj["names[0m
[30;1m8436 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m7166 | [0m[35m            self.workspaceIds = workspaceIds[0m
[30;1m7167 | [0m[35m[0m
[30;1m7168 | [0m[35m    @classmethod[0m
[30;1m7169 | [0m[35m    def from_json(cls, obj: Json) -> "v1GetWorkspacesWithDefaultNamespaceBindingsResponse":[0m
[30;1m7170 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m7171 | [0m[35m        }[0m
[30;1m7172 | [0m[35m        if "workspaceIds" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m6787 | [0m[35m            self.remainingDays = remainingDays[0m
[30;1m6788 | [0m[35m[0m
[30;1m6789 | [0m[35m    @classmethod[0m
[30;1m6790 | [0m[35m    def from_json(cls, obj: Json) -> "v1GetTrialRemainingLogRetentionDaysResponse":[0m
[30;1m6791 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m6792 | [0m[35m        }[0m
[30;1m6793 | [0m[35m        if "remainingDays" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m6740 | [0m[35m        self.labels = labels[0m
[30;1m6741 | [0m[35m[0m
[30;1m6742 | [0m[35m    @classmethod[0m
[30;1m6743 | [0m[35m    def from_json(cls, obj: Json) -> "v1GetTrialProfilerAvailableSeriesResponse":[0m
[30;1m6744 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m6745 | [0m[35m            "labels": [v1TrialProfilerMetricLabels.from_json(x) for x in obj["labels"]],[0m
[30;1m6746 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m5137 | [0m[35m        self.usersAssignedDirectly = usersAssignedDirectly[0m
[30;1m5138 | [0m[35m[0m
[30;1m5139 | [0m[35m    @classmethod[0m
[30;1m5140 | [0m[35m    def from_json(cls, obj: Json) -> "v1GetGroupsAndUsersAssignedToWorkspaceResponse":[0m
[30;1m5141 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m5142 | [0m[35m            "assignments": [v1RoleWithAssignments.from_json(x) for x in obj["assignments"]],[0m
[30;1m5143 | [0m[35m            "groups": [v1GroupDetails.from_json(x) for x in obj["groups"]],[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m4970 | [0m[35m            self.validationHistory = validationHistory[0m
[30;1m4971 | [0m[35m[0m
[30;1m4972 | [0m[35m    @classmethod[0m
[30;1m4973 | [0m[35m    def from_json(cls, obj: Json) -> "v1GetExperimentValidationHistoryResponse":[0m
[30;1m4974 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m4975 | [0m[35m        }[0m
[30;1m4976 | [0m[35m        if "validationHistory" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m4668 | [0m[35m            self.metric = metric[0m
[30;1m4669 | [0m[35m[0m
[30;1m4670 | [0m[35m    @classmethod[0m
[30;1m4671 | [0m[35m    def from_json(cls, obj: Json) -> "v1GetBestSearcherValidationMetricResponse":[0m
[30;1m4672 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m4673 | [0m[35m        }[0m
[30;1m4674 | [0m[35m        if "metric" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1927 | [0m[35m            self.workspaceIds = workspaceIds[0m
[30;1m1928 | [0m[35m[0m
[30;1m1929 | [0m[35m    @classmethod[0m
[30;1m1930 | [0m[35m    def from_json(cls, obj: Json) -> "v1BulkAutoCreateWorkspaceNamespaceBindingsRequest":[0m
[30;1m1931 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m1932 | [0m[35m        }[0m
[30;1m1933 | [0m[35m        if "workspaceIds" in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m1452 | [0m[35m        self.allocationId = allocationId[0m
[30;1m1453 | [0m[35m[0m
[30;1m1454 | [0m[35m    @classmethod[0m
[30;1m1455 | [0m[35m    def from_json(cls, obj: Json) -> "v1AllocationPendingPreemptionSignalRequest":[0m
[30;1m1456 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m
[30;1m1457 | [0m[35m            "allocationId": obj["allocationId"],[0m
[30;1m1458 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m981 | [0m[35m[0m
[30;1m982 | [0m[35m            apt-get install -y binutils git[0m
[30;1m983 | [0m[35m            if [ ! -d "efs-utils" ]; then[0m
[30;1m984 | [0m[35m              apt-get update[0m
[30;1m985 | [0m[35m              apt-get -y install git binutils rustc cargo pkg-config libssl-dev[0m
[30;1m986 | [0m[35m              git clone https://github.com/aws/efs-utils[0m
[30;1m987 | [0m[35m              cd efs-utils[0m
[30;1m988 | [0m[35m              ./build-deb.sh[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m960 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m961 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m962 | [0m[35m               stable"[0m
[30;1m963 | [0m[35m            apt-get update[0m
[30;1m964 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m967 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m948 | [0m[35m            EOF[0m
[30;1m949 | [0m[35m[0m
[30;1m950 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m951 | [0m[35m            apt-get update[0m
[30;1m952 | [0m[35m            apt-get install -y \[0m
[30;1m953 | [0m[35m                apt-transport-https \[0m
[30;1m954 | [0m[35m                ca-certificates \[0m
[30;1m955 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1088 | [0m[35m    Value: !Ref Version[0m
[30;1m1089 | [0m[35m[0m
[30;1m1090 | [0m[35m  DeterminedAddress:[0m
[30;1m1091 | [0m[35m    Description: Ip address of Determined Master[0m
[30;1m1092 | [0m[35m    Value: !GetAtt MasterInstance.PublicDnsName[0m
[30;1m1093 | [0m[35m[0m
[30;1m1094 | [0m[35m  MasterPort:[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1022 | [0m[35m                -c "/usr/bin/determined-gotmpl -i /etc/determined/master.yaml.context /etc/determine[0m
[30;1m1023 | [0m[35m            test $? -eq 0 || ( echo "Failed to generate master.yaml" && exit 1 )[0m
[30;1m1024 | [0m[35m[0m
[30;1m1025 | [0m[35m            docker run \[0m
[30;1m1026 | [0m[35m                --name determined-master \[0m
[30;1m1027 | [0m[35m                --network determined \[0m
[30;1m1028 | [0m[35m                --restart unless-stopped \[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1013 | [0m[35m            fi[0m
[30;1m1014 | [0m[35m[0m
[30;1m1015 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m1016 | [0m[35m            docker run \[0m
[30;1m1017 | [0m[35m                --name determined-master-configurator \[0m
[30;1m1018 | [0m[35m                --rm \[0m
[30;1m1019 | [0m[35m                -v /usr/local/determined/etc/:/etc/determined/ \[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m995 | [0m[35m            mount -t efs ${EFSVal}:/ /mnt/efs[0m
[30;1m996 | [0m[35m[0m
[30;1m997 | [0m[35m            if [ ! -z "${GenAIVersion}" ]; then[0m
[30;1m998 | [0m[35m              docker run -d \[0m
[30;1m999 | [0m[35m                --name lore-backend \[0m
[30;1m1000 | [0m[35m                --env DET_MASTER=http://determined-master:8080 \[0m
[30;1m1001 | [0m[35m                --env DB_NAME=lore \[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m992 | [0m[35m              rm -r efs-utils[0m
[30;1m993 | [0m[35m            fi[0m
[30;1m994 | [0m[35m[0m
[30;1m995 | [0m[35m            mount -t efs ${EFSVal}:/ /mnt/efs[0m
[30;1m996 | [0m[35m[0m
[30;1m997 | [0m[35m            if [ ! -z "${GenAIVersion}" ]; then[0m
[30;1m998 | [0m[35m              docker run -d \[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m987 | [0m[35m              cd efs-utils[0m
[30;1m988 | [0m[35m              ./build-deb.sh[0m
[30;1m989 | [0m[35m              chown _apt:root ./build/amazon-efs-utils*deb[0m
[30;1m990 | [0m[35m              apt-get install -y ./build/amazon-efs-utils*deb[0m
[30;1m991 | [0m[35m              cd ..[0m
[30;1m992 | [0m[35m              rm -r efs-utils[0m
[30;1m993 | [0m[35m            fi[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m986 | [0m[35m              git clone https://github.com/aws/efs-utils[0m
[30;1m987 | [0m[35m              cd efs-utils[0m
[30;1m988 | [0m[35m              ./build-deb.sh[0m
[30;1m989 | [0m[35m              chown _apt:root ./build/amazon-efs-utils*deb[0m
[30;1m990 | [0m[35m              apt-get install -y ./build/amazon-efs-utils*deb[0m
[30;1m991 | [0m[35m              cd ..[0m
[30;1m992 | [0m[35m              rm -r efs-utils[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m983 | [0m[35m            if [ ! -d "efs-utils" ]; then[0m
[30;1m984 | [0m[35m              apt-get update[0m
[30;1m985 | [0m[35m              apt-get -y install git binutils rustc cargo pkg-config libssl-dev[0m
[30;1m986 | [0m[35m              git clone https://github.com/aws/efs-utils[0m
[30;1m987 | [0m[35m              cd efs-utils[0m
[30;1m988 | [0m[35m              ./build-deb.sh[0m
[30;1m989 | [0m[35m              chown _apt:root ./build/amazon-efs-utils*deb[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m982 | [0m[35m            apt-get install -y binutils git[0m
[30;1m983 | [0m[35m            if [ ! -d "efs-utils" ]; then[0m
[30;1m984 | [0m[35m              apt-get update[0m
[30;1m985 | [0m[35m              apt-get -y install git binutils rustc cargo pkg-config libssl-dev[0m
[30;1m986 | [0m[35m              git clone https://github.com/aws/efs-utils[0m
[30;1m987 | [0m[35m              cd efs-utils[0m
[30;1m988 | [0m[35m              ./build-deb.sh[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m982 | [0m[35m            apt-get install -y binutils git[0m
[30;1m983 | [0m[35m            if [ ! -d "efs-utils" ]; then[0m
[30;1m984 | [0m[35m              apt-get update[0m
[30;1m985 | [0m[35m              apt-get -y install git binutils rustc cargo pkg-config libssl-dev[0m
[30;1m986 | [0m[35m              git clone https://github.com/aws/efs-utils[0m
[30;1m987 | [0m[35m              cd efs-utils[0m
[30;1m988 | [0m[35m              ./build-deb.sh[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m981 | [0m[35m[0m
[30;1m982 | [0m[35m            apt-get install -y binutils git[0m
[30;1m983 | [0m[35m            if [ ! -d "efs-utils" ]; then[0m
[30;1m984 | [0m[35m              apt-get update[0m
[30;1m985 | [0m[35m              apt-get -y install git binutils rustc cargo pkg-config libssl-dev[0m
[30;1m986 | [0m[35m              git clone https://github.com/aws/efs-utils[0m
[30;1m987 | [0m[35m              cd efs-utils[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m979 | [0m[35m[0m
[30;1m980 | [0m[35m            date >> /tmp/cloud-init-log[0m
[30;1m981 | [0m[35m[0m
[30;1m982 | [0m[35m            apt-get install -y binutils git[0m
[30;1m983 | [0m[35m            if [ ! -d "efs-utils" ]; then[0m
[30;1m984 | [0m[35m              apt-get update[0m
[30;1m985 | [0m[35m              apt-get -y install git binutils rustc cargo pkg-config libssl-dev[0m
[30;1m986 | [0m[35m              git clone https://github.com/aws/efs-utils[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m979 | [0m[35m[0m
[30;1m980 | [0m[35m            date >> /tmp/cloud-init-log[0m
[30;1m981 | [0m[35m[0m
[30;1m982 | [0m[35m            apt-get install -y binutils git[0m
[30;1m983 | [0m[35m            if [ ! -d "efs-utils" ]; then[0m
[30;1m984 | [0m[35m              apt-get update[0m
[30;1m985 | [0m[35m              apt-get -y install git binutils rustc cargo pkg-config libssl-dev[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m973 | [0m[35m            docker network create determined[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m976 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m977 | [0m[35m[0m
[30;1m978 | [0m[35m            mkdir -p /mnt/efs[0m
[30;1m979 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m972 | [0m[35m[0m
[30;1m973 | [0m[35m            docker network create determined[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m976 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m977 | [0m[35m[0m
[30;1m978 | [0m[35m            mkdir -p /mnt/efs[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m970 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m971 | [0m[35m            fi[0m
[30;1m972 | [0m[35m[0m
[30;1m973 | [0m[35m            docker network create determined[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m976 | [0m[35m            docker rm $(docker ps -a -q)[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m967 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m968 | [0m[35m[0m
[30;1m969 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m970 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m971 | [0m[35m            fi[0m
[30;1m972 | [0m[35m[0m
[30;1m973 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m963 | [0m[35m            apt-get update[0m
[30;1m964 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m967 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m968 | [0m[35m[0m
[30;1m969 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m961 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m962 | [0m[35m               stable"[0m
[30;1m963 | [0m[35m            apt-get update[0m
[30;1m964 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m967 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m960 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m961 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m962 | [0m[35m               stable"[0m
[30;1m963 | [0m[35m            apt-get update[0m
[30;1m964 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m955 | [0m[35m                curl \[0m
[30;1m956 | [0m[35m                gnupg-agent \[0m
[30;1m957 | [0m[35m                software-properties-common[0m
[30;1m958 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m
[30;1m959 | [0m[35m            add-apt-repository \[0m
[30;1m960 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m961 | [0m[35m               $(lsb_release -cs) \[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m952 | [0m[35m            apt-get install -y \[0m
[30;1m953 | [0m[35m                apt-transport-https \[0m
[30;1m954 | [0m[35m                ca-certificates \[0m
[30;1m955 | [0m[35m                curl \[0m
[30;1m956 | [0m[35m                gnupg-agent \[0m
[30;1m957 | [0m[35m                software-properties-common[0m
[30;1m958 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m949 | [0m[35m[0m
[30;1m950 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m951 | [0m[35m            apt-get update[0m
[30;1m952 | [0m[35m            apt-get install -y \[0m
[30;1m953 | [0m[35m                apt-transport-https \[0m
[30;1m954 | [0m[35m                ca-certificates \[0m
[30;1m955 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m948 | [0m[35m            EOF[0m
[30;1m949 | [0m[35m[0m
[30;1m950 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m951 | [0m[35m            apt-get update[0m
[30;1m952 | [0m[35m            apt-get install -y \[0m
[30;1m953 | [0m[35m                apt-transport-https \[0m
[30;1m954 | [0m[35m                ca-certificates \[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m947 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m948 | [0m[35m            EOF[0m
[30;1m949 | [0m[35m[0m
[30;1m950 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m951 | [0m[35m            apt-get update[0m
[30;1m952 | [0m[35m            apt-get install -y \[0m
[30;1m953 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m947 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m948 | [0m[35m            EOF[0m
[30;1m949 | [0m[35m[0m
[30;1m950 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m951 | [0m[35m            apt-get update[0m
[30;1m952 | [0m[35m            apt-get install -y \[0m
[30;1m953 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m930 | [0m[35m                  mkdir -p /mnt/efs[0m
[30;1m931 | [0m[35m                  mount -t efs ${EFSVal}:/ /mnt/efs[0m
[30;1m932 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m933 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m934 | [0m[35m                  fi[0m
[30;1m935 | [0m[35m[0m
[30;1m936 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m928 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m929 | [0m[35m                startup_script: |[0m
[30;1m930 | [0m[35m                  mkdir -p /mnt/efs[0m
[30;1m931 | [0m[35m                  mount -t efs ${EFSVal}:/ /mnt/efs[0m
[30;1m932 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m933 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m934 | [0m[35m                  fi[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m872 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m873 | [0m[35m            EOF[0m
[30;1m874 | [0m[35m[0m
[30;1m875 | [0m[35m            cat << EOF > /usr/local/determined/etc/master.yaml.context[0m
[30;1m876 | [0m[35m            checkpoint_storage:[0m
[30;1m877 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m878 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m868 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m869 | [0m[35m            fi[0m
[30;1m870 | [0m[35m[0m
[30;1m871 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m
[30;1m872 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m873 | [0m[35m            EOF[0m
[30;1m874 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m865 | [0m[35m              scheme=https[0m
[30;1m866 | [0m[35m              port=8443[0m
[30;1m867 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m868 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m869 | [0m[35m            fi[0m
[30;1m870 | [0m[35m[0m
[30;1m871 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m865 | [0m[35m              scheme=https[0m
[30;1m866 | [0m[35m              port=8443[0m
[30;1m867 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m868 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m869 | [0m[35m            fi[0m
[30;1m870 | [0m[35m[0m
[30;1m871 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m864 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m865 | [0m[35m              scheme=https[0m
[30;1m866 | [0m[35m              port=8443[0m
[30;1m867 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m868 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m869 | [0m[35m            fi[0m
[30;1m870 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m864 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m865 | [0m[35m              scheme=https[0m
[30;1m866 | [0m[35m              port=8443[0m
[30;1m867 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m868 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m869 | [0m[35m            fi[0m
[30;1m870 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m  MountEFSId:[0m
[30;1m234 | [0m[35m    Type: String[0m
[30;1m235 | [0m[35m    Description: preexisting EFS ID to mount[0m
[30;1m236 | [0m[35m    Default: ""[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m  InitialUserPassword:[0m
[30;1m239 | [0m[35m    Type: String[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m  GenAISharedFSMountPath:[0m
[30;1m229 | [0m[35m    Type: String[0m
[30;1m230 | [0m[35m    Description: GenAI shared file system mount path[0m
[30;1m231 | [0m[35m    Default: /run/determined/workdir/shared_fs[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m  MountEFSId:[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m  GpuEnvImage:[0m
[30;1m209 | [0m[35m    Type: String[0m
[30;1m210 | [0m[35m    Description: Docker image for GPU tasks[0m
[30;1m211 | [0m[35m    Default: ""[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m  LogGroupPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m  CpuEnvImage:[0m
[30;1m204 | [0m[35m    Type: String[0m
[30;1m205 | [0m[35m    Description: Docker image for CPU tasks[0m
[30;1m206 | [0m[35m    Default: ""[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m  GpuEnvImage:[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m  AgentReconnectBackoff:[0m
[30;1m189 | [0m[35m    Type: Number[0m
[30;1m190 | [0m[35m    Description: Time between reconnect attempts, with the exception of the first.[0m
[30;1m191 | [0m[35m    Default: 5[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m  AgentConfigFileContents:[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m
[30;1m97 | [0m[35m    Type: String[0m
[30;1m98 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m99 | [0m[35m    Default: ""[0m
[30;1m100 | [0m[35m    NoEcho: true[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m  DockerUser:[0m
[30;1m92 | [0m[35m    Type: String[0m
[30;1m93 | [0m[35m    Description: Docker user to pull images that need authentication[0m
[30;1m94 | [0m[35m    Default: ""[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m  AgentImageName:[0m
[30;1m87 | [0m[35m    Type: String[0m
[30;1m88 | [0m[35m    Description: Name of the Docker image to use for the Determined agent[0m
[30;1m89 | [0m[35m    Default: determined-agent[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m  DockerUser:[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m  MasterImageName:[0m
[30;1m82 | [0m[35m    Type: String[0m
[30;1m83 | [0m[35m    Description: Name of the Docker image to use for the Determined master[0m
[30;1m84 | [0m[35m    Default: determined-master[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m  AgentImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m  ImageRepoPrefix:[0m
[30;1m77 | [0m[35m    Type: String[0m
[30;1m78 | [0m[35m    Description: Docker image repository to use for determined-master and determined-agent images[0m
[30;1m79 | [0m[35m    Default: determinedai[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m  MasterImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m  InboundCIDRRange:[0m
[30;1m72 | [0m[35m    Type: String[0m
[30;1m73 | [0m[35m    Description: Ip range for Inbound[0m
[30;1m74 | [0m[35m    Default: 0.0.0.0/0[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m  ImageRepoPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    Default: 10.192.10.0/24[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m  Subnet2CIDR:[0m
[30;1m48 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the public subnet in the second Avail[0m
[30;1m49 | [0m[35m    Type: String[0m
[30;1m50 | [0m[35m    Default: 10.192.11.0/24[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    Default: 10.192.0.0/16[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m  Subnet1CIDR:[0m
[30;1m43 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the public subnet in the first Availa[0m
[30;1m44 | [0m[35m    Type: String[0m
[30;1m45 | [0m[35m    Default: 10.192.10.0/24[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/lore.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mParameters:[0m
[30;1m37 | [0m[35m  VpcCIDR:[0m
[30;1m38 | [0m[35m    Description: Please enter the IP range (CIDR notation) for this VPC[0m
[30;1m39 | [0m[35m    Type: String[0m
[30;1m40 | [0m[35m    Default: 10.192.0.0/16[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/service_account/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mresource "google_service_account" "service_account" {[0m
[30;1m8 | [0m[35m  account_id   = "det-${var.unique_id}"[0m
[30;1m9 | [0m[35m  display_name = "DET Service Account ${var.unique_id}"[0m
[30;1m10 | [0m[35m}[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mresource "google_project_iam_member" "project_compute" {[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/service_account/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m// Create Service Account[0m
[30;1m2 | [0m[35mlocals {[0m
[30;1m3 | [0m[35m  service_account_email = google_service_account.service_account.email[0m
[30;1m4 | [0m[35m  resource_member = "serviceAccount:${local.service_account_email}"[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m596 | [0m[35m            training = ckpt.training[0m
[30;1m597 | [0m[35m            assert training[0m
[30;1m598 | [0m[35m            metric = training.validation_metrics.get("avgMetrics") or {}[0m
[30;1m599 | [0m[35m            metric = metric.get(sort_by)[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m            # Return a tuple that ensures checkpoints missing metrics appear last.[0m
[30;1m602 | [0m[35m            if reverse:[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m595 | [0m[35m        def key(ckpt: checkpoint.Checkpoint) -> Any:[0m
[30;1m596 | [0m[35m            training = ckpt.training[0m
[30;1m597 | [0m[35m            assert training[0m
[30;1m598 | [0m[35m            metric = training.validation_metrics.get("avgMetrics") or {}[0m
[30;1m599 | [0m[35m            metric = metric.get(sort_by)[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m            # Return a tuple that ensures checkpoints missing metrics appear last.[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m                    "no searcher.metric found in experiment config; please provide a sort_by metric"[0m
[30;1m589 | [0m[35m                )[0m
[30;1m590 | [0m[35m            sort_by = sb[0m
[30;1m591 | [0m[35m            smaller_is_better = config.get("searcher", {}).get("smaller_is_better", True)[0m
[30;1m592 | [0m[35m[0m
[30;1m593 | [0m[35m        reverse = not smaller_is_better[0m
[30;1m594 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m                    "no searcher.metric found in experiment config; please provide a sort_by metric"[0m
[30;1m589 | [0m[35m                )[0m
[30;1m590 | [0m[35m            sort_by = sb[0m
[30;1m591 | [0m[35m            smaller_is_better = config.get("searcher", {}).get("smaller_is_better", True)[0m
[30;1m592 | [0m[35m[0m
[30;1m593 | [0m[35m        reverse = not smaller_is_better[0m
[30;1m594 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m582 | [0m[35m            training = checkpoints[0].training[0m
[30;1m583 | [0m[35m            assert training[0m
[30;1m584 | [0m[35m            config = training.experiment_config[0m
[30;1m585 | [0m[35m            sb = config.get("searcher", {}).get("metric")[0m
[30;1m586 | [0m[35m            if not isinstance(sb, str):[0m
[30;1m587 | [0m[35m                raise ValueError([0m
[30;1m588 | [0m[35m                    "no searcher.metric found in experiment config; please provide a sort_by metric"[0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m582 | [0m[35m            training = checkpoints[0].training[0m
[30;1m583 | [0m[35m            assert training[0m
[30;1m584 | [0m[35m            config = training.experiment_config[0m
[30;1m585 | [0m[35m            sb = config.get("searcher", {}).get("metric")[0m
[30;1m586 | [0m[35m            if not isinstance(sb, str):[0m
[30;1m587 | [0m[35m                raise ValueError([0m
[30;1m588 | [0m[35m                    "no searcher.metric found in experiment config; please provide a sort_by metric"[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m313 | [0m[35m                :class:`~determined.experimental.OrderBy`.[0m
[30;1m314 | [0m[35m            limit: Optional field that sets maximum page size of the response from the server.[0m
[30;1m315 | [0m[35m                When there are many trials to return, a lower page size can result in shorter[0m
[30;1m316 | [0m[35m                latency at the expense of more HTTP requests to the server. Defaults to no maximum.[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        Returns:[0m
[30;1m319 | [0m[35m            This method returns an Iterable of :class:`~determined.experimental.Trial` instances[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m260 | [0m[35m        resp = bindings.get_GetModelDef(self._session, experimentId=self._id)[0m
[30;1m261 | [0m[35m        output_filename = f"exp-{self.id}_model_def.tar.gz"[0m
[30;1m262 | [0m[35m        if output_dir:[0m
[30;1m263 | [0m[35m            # Expand "~" to user home directory path.[0m
[30;1m264 | [0m[35m            output_path = pathlib.Path(output_dir).expanduser()[0m
[30;1m265 | [0m[35m            output_path.mkdir(parents=True, exist_ok=True)[0m
[30;1m266 | [0m[35m            output_path = output_path / output_filename[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35m    Note:[0m
[30;1m117 | [0m[35m        All attributes are cached by default.[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        Some attributes are mutable and may be changed by methods that update these values,[0m
[30;1m120 | [0m[35m        either automatically (eg. :meth:`wait()`) or explicitly with :meth:`reload()`.[0m
[30;1m121 | [0m[35m    """[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m546 | [0m[35m                in the experiment configuration searcher field will be[0m
[30;1m547 | [0m[35m                used.[0m
[30;1m548 | [0m[35m[0m
[30;1m549 | [0m[35m            smaller_is_better (bool, optional): Specifies whether to sort the[0m
[30;1m550 | [0m[35m                metric above in ascending or descending order. If ``sort_by`` is unset,[0m
[30;1m551 | [0m[35m                this parameter is ignored. By default, the value of ``smaller_is_better``[0m
[30;1m552 | [0m[35m                from the experiment's configuration is used.[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m535 | [0m[35m        Return the N :class:`~determined.experimental.Checkpoint` instances with the best[0m
[30;1m536 | [0m[35m        validation metrics, as defined by the ``sort_by`` and ``smaller_is_better``[0m
[30;1m537 | [0m[35m        arguments. This method will return the best checkpoint from the[0m
[30;1m538 | [0m[35m        top N best-performing distinct trials of the experiment. Only checkpoints in[0m
[30;1m539 | [0m[35m        a ``COMPLETED`` state with a matching ``COMPLETED`` validation are considered.[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m        Arguments:[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m481 | [0m[35m        are considered.[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m        Arguments:[0m
[30;1m484 | [0m[35m            sort_by: (Optional) Parameter to sort checkpoints by. Accepts either[0m
[30;1m485 | [0m[35m                ``checkpoint.CheckpointSortBy`` or a string representing a validation metric name.[0m
[30;1m486 | [0m[35m            order_by: (Optional) Order of sorted checkpoints (ascending or descending).[0m
[30;1m487 | [0m[35m            max_results: (Optional) Maximum number of results to return. Defaults to no maximum.[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m439 | [0m[35m                order checkpoints by. If this parameter is not specified, the metric[0m
[30;1m440 | [0m[35m                defined in the experiment configuration ``searcher`` field will be used.[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m            smaller_is_better (bool, optional): Specifies whether to sort the[0m
[30;1m443 | [0m[35m                metric above in ascending or descending order. If ``sort_by`` is unset,[0m
[30;1m444 | [0m[35m                this parameter is ignored. By default, the value of ``smaller_is_better``[0m
[30;1m445 | [0m[35m                from the experiment's configuration is used.[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m399 | [0m[35m        """Wait for the experiment to reach a complete or terminal state.[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m        Arguments:[0m
[30;1m402 | [0m[35m            interval: An interval time in seconds before checking next experiment state.[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m        Returns:[0m
[30;1m405 | [0m[35m            The terminal state the experiment is in after waiting[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m340 | [0m[35m        """Wait for the first trial to be started for this experiment.[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        Arguments:[0m
[30;1m343 | [0m[35m            interval: An interval time in seconds before checking next experiment state.[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m        Returns:[0m
[30;1m346 | [0m[35m            The first trial of the experiment.[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m        Arguments:[0m
[30;1m311 | [0m[35m            sort_by: Which field to sort by. See :class:`~determined.experimental.TrialSortBy`.[0m
[30;1m312 | [0m[35m            order_by: Whether to sort in ascending or descending order. See[0m
[30;1m313 | [0m[35m                :class:`~determined.experimental.OrderBy`.[0m
[30;1m314 | [0m[35m            limit: Optional field that sets maximum page size of the response from the server.[0m
[30;1m315 | [0m[35m                When there are many trials to return, a lower page size can result in shorter[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m        """Generate an iterator of trials of an experiment.[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m        Arguments:[0m
[30;1m311 | [0m[35m            sort_by: Which field to sort by. See :class:`~determined.experimental.TrialSortBy`.[0m
[30;1m312 | [0m[35m            order_by: Whether to sort in ascending or descending order. See[0m
[30;1m313 | [0m[35m                :class:`~determined.experimental.OrderBy`.[0m
[30;1m314 | [0m[35m            limit: Optional field that sets maximum page size of the response from the server.[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m        Arguments:[0m
[30;1m296 | [0m[35m            sort_by: Which field to sort by. See :class:`~determined.experimental.TrialSortBy`.[0m
[30;1m297 | [0m[35m            order_by: Whether to sort in ascending or descending order. See[0m
[30;1m298 | [0m[35m                :class:`~determined.experimental.TrialOrderBy`.[0m
[30;1m299 | [0m[35m        """[0m
[30;1m300 | [0m[35m        return list(self.iter_trials(sort_by, order_by))[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m293 | [0m[35m        """Fetch all trials of an experiment.[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m        Arguments:[0m
[30;1m296 | [0m[35m            sort_by: Which field to sort by. See :class:`~determined.experimental.TrialSortBy`.[0m
[30;1m297 | [0m[35m            order_by: Whether to sort in ascending or descending order. See[0m
[30;1m298 | [0m[35m                :class:`~determined.experimental.TrialOrderBy`.[0m
[30;1m299 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m260 | [0m[35m        resp = bindings.get_GetModelDef(self._session, experimentId=self._id)[0m
[30;1m261 | [0m[35m        output_filename = f"exp-{self.id}_model_def.tar.gz"[0m
[30;1m262 | [0m[35m        if output_dir:[0m
[30;1m263 | [0m[35m            # Expand "~" to user home directory path.[0m
[30;1m264 | [0m[35m            output_path = pathlib.Path(output_dir).expanduser()[0m
[30;1m265 | [0m[35m            output_path.mkdir(parents=True, exist_ok=True)[0m
[30;1m266 | [0m[35m            output_path = output_path / output_filename[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport enum[0m
[30;1m3 | [0m[35mimport pathlib[0m
[30;1m4 | [0m[35mimport sys[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport warnings[0m
[30;1m7 | [0m[35mfrom typing import Any, Dict, Iterator, List, Optional, Set, Union[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom determined.common import api[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport enum[0m
[30;1m3 | [0m[35mimport pathlib[0m
[30;1m4 | [0m[35mimport sys[0m
[30;1m5 | [0m[35mimport time[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m.hostname[0m
[30;1m41 | [0m[35m    db:[0m
[30;1m42 | [0m[35m      user: "${var.db_username}"[0m
[30;1m43 | [0m[35m      password: "${var.db_password}"[0m
[30;1m44 | [0m[35m      host: "${var.database_hostname}"[0m
[30;1m45 | [0m[35m      port: 5432[0m
[30;1m46 | [0m[35m      name: "${var.database_name}"[0m
[30;1m47 | [0m[35m      ssl_mode: ${var.database_ssl_enabled ? "verify-ca" : "disable"}[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m130 | [0m[35m       "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m131 | [0m[35m       $(lsb_release -cs) \[0m
[30;1m132 | [0m[35m       stable"[0m
[30;1m133 | [0m[35m    apt-get update[0m
[30;1m134 | [0m[35m    apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    cat << EOF > /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m137 | [0m[35m    ${var.database_ssl_root_cert}[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m    fi[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m121 | [0m[35m    apt-get update[0m
[30;1m122 | [0m[35m    apt-get install -y \[0m
[30;1m123 | [0m[35m        apt-transport-https \[0m
[30;1m124 | [0m[35m        ca-certificates \[0m
[30;1m125 | [0m[35m        curl \[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m    if [ -n "${var.filestore_address}" ]; then[0m
[30;1m107 | [0m[35m      cat << EOF >> /usr/local/determined/etc/master.yaml.context[0m
[30;1m108 | [0m[35m        startup_script: |[0m
[30;1m109 | [0m[35m                        apt-get -y update && apt-get -y install nfs-common[0m
[30;1m110 | [0m[35m                        mkdir -p /mnt/shared_fs[0m
[30;1m111 | [0m[35m                        mount ${var.filestore_address} /mnt/shared_fs[0m
[30;1m112 | [0m[35m                        df -h --type=nfs[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m        -c "/usr/bin/determined-gotmpl -i /etc/determined/master.yaml.context /etc/determined/master[0m
[30;1m150 | [0m[35m    test $? -eq 0 || ( echo "Failed to generate master.yaml" && exit 1 )[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    docker run \[0m
[30;1m153 | [0m[35m        --name determined-master \[0m
[30;1m154 | [0m[35m        --network ${var.master_docker_network} \[0m
[30;1m155 | [0m[35m        --restart unless-stopped \[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m    docker network create ${var.master_docker_network}[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    touch /usr/local/determined/etc/master.yaml[0m
[30;1m143 | [0m[35m    docker run \[0m
[30;1m144 | [0m[35m        --name determined-master-configurator \[0m
[30;1m145 | [0m[35m        --rm \[0m
[30;1m146 | [0m[35m        -v /usr/local/determined/etc/:/etc/determined/ \[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m    ${var.database_ssl_root_cert}[0m
[30;1m138 | [0m[35m    EOF[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m    docker network create ${var.master_docker_network}[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    touch /usr/local/determined/etc/master.yaml[0m
[30;1m143 | [0m[35m    docker run \[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m    apt-get update[0m
[30;1m134 | [0m[35m    apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    cat << EOF > /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m137 | [0m[35m    ${var.database_ssl_root_cert}[0m
[30;1m138 | [0m[35m    EOF[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m       $(lsb_release -cs) \[0m
[30;1m132 | [0m[35m       stable"[0m
[30;1m133 | [0m[35m    apt-get update[0m
[30;1m134 | [0m[35m    apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    cat << EOF > /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m137 | [0m[35m    ${var.database_ssl_root_cert}[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m       "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m131 | [0m[35m       $(lsb_release -cs) \[0m
[30;1m132 | [0m[35m       stable"[0m
[30;1m133 | [0m[35m    apt-get update[0m
[30;1m134 | [0m[35m    apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    cat << EOF > /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m        curl \[0m
[30;1m126 | [0m[35m        gnupg-agent \[0m
[30;1m127 | [0m[35m        software-properties-common[0m
[30;1m128 | [0m[35m    curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m
[30;1m129 | [0m[35m    add-apt-repository \[0m
[30;1m130 | [0m[35m       "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m131 | [0m[35m       $(lsb_release -cs) \[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m    apt-get install -y \[0m
[30;1m123 | [0m[35m        apt-transport-https \[0m
[30;1m124 | [0m[35m        ca-certificates \[0m
[30;1m125 | [0m[35m        curl \[0m
[30;1m126 | [0m[35m        gnupg-agent \[0m
[30;1m127 | [0m[35m        software-properties-common[0m
[30;1m128 | [0m[35m    curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m121 | [0m[35m    apt-get update[0m
[30;1m122 | [0m[35m    apt-get install -y \[0m
[30;1m123 | [0m[35m        apt-transport-https \[0m
[30;1m124 | [0m[35m        ca-certificates \[0m
[30;1m125 | [0m[35m        curl \[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m    fi[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m121 | [0m[35m    apt-get update[0m
[30;1m122 | [0m[35m    apt-get install -y \[0m
[30;1m123 | [0m[35m        apt-transport-https \[0m
[30;1m124 | [0m[35m        ca-certificates \[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    EOF[0m
[30;1m118 | [0m[35m    fi[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m121 | [0m[35m    apt-get update[0m
[30;1m122 | [0m[35m    apt-get install -y \[0m
[30;1m123 | [0m[35m        apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    EOF[0m
[30;1m118 | [0m[35m    fi[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m121 | [0m[35m    apt-get update[0m
[30;1m122 | [0m[35m    apt-get install -y \[0m
[30;1m123 | [0m[35m        apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m        startup_script: |[0m
[30;1m109 | [0m[35m                        apt-get -y update && apt-get -y install nfs-common[0m
[30;1m110 | [0m[35m                        mkdir -p /mnt/shared_fs[0m
[30;1m111 | [0m[35m                        mount ${var.filestore_address} /mnt/shared_fs[0m
[30;1m112 | [0m[35m                        df -h --type=nfs[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    bind_mounts:[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m    if [ -n "${var.filestore_address}" ]; then[0m
[30;1m107 | [0m[35m      cat << EOF >> /usr/local/determined/etc/master.yaml.context[0m
[30;1m108 | [0m[35m        startup_script: |[0m
[30;1m109 | [0m[35m                        apt-get -y update && apt-get -y install nfs-common[0m
[30;1m110 | [0m[35m                        mkdir -p /mnt/shared_fs[0m
[30;1m111 | [0m[35m                        mount ${var.filestore_address} /mnt/shared_fs[0m
[30;1m112 | [0m[35m                        df -h --type=nfs[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m    if [ -n "${var.filestore_address}" ]; then[0m
[30;1m107 | [0m[35m      cat << EOF >> /usr/local/determined/etc/master.yaml.context[0m
[30;1m108 | [0m[35m        startup_script: |[0m
[30;1m109 | [0m[35m                        apt-get -y update && apt-get -y install nfs-common[0m
[30;1m110 | [0m[35m                        mkdir -p /mnt/shared_fs[0m
[30;1m111 | [0m[35m                        mount ${var.filestore_address} /mnt/shared_fs[0m
[30;1m112 | [0m[35m                        df -h --type=nfs[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m    EOF[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    if [ -n "${var.filestore_address}" ]; then[0m
[30;1m107 | [0m[35m      cat << EOF >> /usr/local/determined/etc/master.yaml.context[0m
[30;1m108 | [0m[35m        startup_script: |[0m
[30;1m109 | [0m[35m                        apt-get -y update && apt-get -y install nfs-common[0m
[30;1m110 | [0m[35m                        mkdir -p /mnt/shared_fs[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m    ${var.master_config_template}[0m
[30;1m35 | [0m[35m    EOF[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    cat << EOF > /usr/local/determined/etc/master.yaml.context[0m
[30;1m38 | [0m[35m    checkpoint_storage:[0m
[30;1m39 | [0m[35m      bucket: "${var.gcs_bucket}"[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m  metadata_startup_script = <<-EOT[0m
[30;1m31 | [0m[35m    mkdir -p /usr/local/determined/etc[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m
[30;1m34 | [0m[35m    ${var.master_config_template}[0m
[30;1m35 | [0m[35m    EOF[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m.hostname[0m
[30;1m190 | [0m[35m  service_account_email = module.service_account.service_account_email[0m
[30;1m191 | [0m[35m  filestore_address = local.filestore_address[0m
[30;1m192 | [0m[35m  gcs_bucket = module.gcs.gcs_bucket[0m
[30;1m193 | [0m[35m  database_hostname = module.database.database_hostname[0m
[30;1m194 | [0m[35m  database_name = module.database.database_name[0m
[30;1m195 | [0m[35m  database_ssl_enabled = var.db_ssl_enabled[0m
[30;1m196 | [0m[35m  database_ssl_root_cert = module.database.database_ssl_root_cert[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m.hostname[0m
[30;1m190 | [0m[35m  service_account_email = module.service_account.service_account_email[0m
[30;1m191 | [0m[35m  filestore_address = local.filestore_address[0m
[30;1m192 | [0m[35m  gcs_bucket = module.gcs.gcs_bucket[0m
[30;1m193 | [0m[35m  database_hostname = module.database.database_hostname[0m
[30;1m194 | [0m[35m  database_name = module.database.database_name[0m
[30;1m195 | [0m[35m  database_ssl_enabled = var.db_ssl_enabled[0m
[30;1m196 | [0m[35m  database_ssl_root_cert = module.database.database_ssl_root_cert[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m/******************************************[0m
[30;1m56 | [0m[35m	Static IP configuration[0m
[30;1m57 | [0m[35m *****************************************/[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mmodule "ip" {[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m/******************************************[0m
[30;1m43 | [0m[35m	Service Account configuration[0m
[30;1m44 | [0m[35m *****************************************/[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mmodule "service_account" {[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/outputs.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m}[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35moutput "SSH-to-Master" {[0m
[30;1m58 | [0m[35m  value = "> To SSH to the Determined master instance, run:\n\n  gcloud compute ssh ${module.compute[0m
[30;1m59 | [0m[35m}[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35moutput "Web-UI" {[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/outputs.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m}[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35moutput "SSH-to-Master" {[0m
[30;1m58 | [0m[35m  value = "> To SSH to the Determined master instance, run:\n\n  gcloud compute ssh ${module.compute[0m
[30;1m59 | [0m[35m}[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35moutput "Web-UI" {[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m693 | [0m[35m        raise api.errors.CorruptTokenCacheException()[0m
[30;1m694 | [0m[35m[0m
[30;1m695 | [0m[35m    # Handle version.[0m
[30;1m696 | [0m[35m    version = store.get("version")[0m
[30;1m697 | [0m[35m    if version != 2:[0m
[30;1m698 | [0m[35m        raise api.errors.CorruptTokenCacheException()[0m
[30;1m699 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m649 | [0m[35m        raise api.errors.CorruptTokenCacheException()[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m    # Handle version.[0m
[30;1m652 | [0m[35m    version = store.get("version")[0m
[30;1m653 | [0m[35m    if version != 1:[0m
[30;1m654 | [0m[35m        raise api.errors.CorruptTokenCacheException()[0m
[30;1m655 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m        # Keep one of every username/token pair.[0m
[30;1m547 | [0m[35m        tokens = {}[0m
[30;1m548 | [0m[35m        for entry in entries:[0m
[30;1m549 | [0m[35m            for user, token in entry.get("tokens", {}).items():[0m
[30;1m550 | [0m[35m                tokens[user] = token[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m        v2_entry: Dict[str, Any] = {"tokens": tokens}[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m526 | [0m[35m    """[0m
[30;1m527 | [0m[35m    v2 scheme is the same as v1 schema but with canonicalized master urls.[0m
[30;1m528 | [0m[35m    """[0m
[30;1m529 | [0m[35m    v1_masters = v1.get("masters", {})[0m
[30;1m530 | [0m[35m[0m
[30;1m531 | [0m[35m    # Build a 1-to-many mapping of canonical master urls to v1 master urls.[0m
[30;1m532 | [0m[35m    canonicals: Dict[str, List[Dict[str, Any]]] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m468 | [0m[35m            if not isinstance(store, dict):[0m
[30;1m469 | [0m[35m                raise api.errors.CorruptTokenCacheException()[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m            version = store.get("version", 0)[0m
[30;1m472 | [0m[35m            if version < 1:[0m
[30;1m473 | [0m[35m                validate_token_store_v0(store)[0m
[30;1m474 | [0m[35m                store = shim_store_v0(store, self.master_address)[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m        return list(self._tokens)[0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35m    def get_token(self, user: str) -> Optional[str]:[0m
[30;1m397 | [0m[35m        token = self._tokens.get(user)[0m
[30;1m398 | [0m[35m        if token is not None:[0m
[30;1m399 | [0m[35m            assert isinstance(token, str), "invalid cache; token must be a string"[0m
[30;1m400 | [0m[35m        return token[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m383 | [0m[35m        assert isinstance(active_user, (str, type(None))), active_user[0m
[30;1m384 | [0m[35m        self._active_user = active_user[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m        tokens = substore.get("tokens", {})[0m
[30;1m387 | [0m[35m        assert isinstance(tokens, dict), tokens[0m
[30;1m388 | [0m[35m        self._tokens = tokens[0m
[30;1m389 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m    def _reconfigure_from_store(self, store: dict) -> None:[0m
[30;1m380 | [0m[35m        substore = store.get("masters", {}).get(self.master_address, {})[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m        active_user = substore.get("active_user")[0m
[30;1m383 | [0m[35m        assert isinstance(active_user, (str, type(None))), active_user[0m
[30;1m384 | [0m[35m        self._active_user = active_user[0m
[30;1m385 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m377 | [0m[35m        self._reconfigure_from_store(store)[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m    def _reconfigure_from_store(self, store: dict) -> None:[0m
[30;1m380 | [0m[35m        substore = store.get("masters", {}).get(self.master_address, {})[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m        active_user = substore.get("active_user")[0m
[30;1m383 | [0m[35m        assert isinstance(active_user, (str, type(None))), active_user[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m377 | [0m[35m        self._reconfigure_from_store(store)[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m    def _reconfigure_from_store(self, store: dict) -> None:[0m
[30;1m380 | [0m[35m        substore = store.get("masters", {}).get(self.master_address, {})[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m        active_user = substore.get("active_user")[0m
[30;1m383 | [0m[35m        assert isinstance(active_user, (str, type(None))), active_user[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m    """[0m
[30;1m340 | [0m[35m    sess = api.Session(master_address, username="ignored", token=token, cert=cert)[0m
[30;1m341 | [0m[35m    try:[0m
[30;1m342 | [0m[35m        r = sess.get("api/v1/me")[0m
[30;1m343 | [0m[35m    except (api.errors.UnauthenticatedException, api.errors.APIException):[0m
[30;1m344 | [0m[35m        return False[0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mdef get_det_session_token_from_env() -> Optional[str]:[0m
[30;1m105 | [0m[35m    return os.environ.get("DET_SESSION_TOKEN")[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mdef login([0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mdef get_det_password_from_env() -> Optional[str]:[0m
[30;1m101 | [0m[35m    return os.environ.get("DET_PASS")[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mdef get_det_session_token_from_env() -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef get_det_user_token_from_env() -> Optional[str]:[0m
[30;1m97 | [0m[35m    return os.environ.get("DET_USER_TOKEN")[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mdef get_det_password_from_env() -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef get_det_username_from_env() -> Optional[str]:[0m
[30;1m93 | [0m[35m    return os.environ.get("DET_USER")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef get_det_user_token_from_env() -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m.hostname[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m    # Extract just hostname:port from the authority section of the url.[0m
[30;1m518 | [0m[35m    port = parsed.port or default_port[0m
[30;1m519 | [0m[35m    netloc = f"{parsed.hostname}:{port}"[0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m    # Discard username, password, query, and fragment.[0m
[30;1m522 | [0m[35m    return parse.urlunparse((parsed.scheme, netloc, parsed.path, "", "", "")).rstrip("/")[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m.hostname[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m    parsed = parse.urlparse(url)[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m    # Extract just hostname:port from the authority section of the url.[0m
[30;1m518 | [0m[35m    port = parsed.port or default_port[0m
[30;1m519 | [0m[35m    netloc = f"{parsed.hostname}:{port}"[0m
[30;1m520 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m438 | [0m[35m            store = self._load_store_file()[0m
[30;1m439 | [0m[35m            substore = store.setdefault("masters", {}).setdefault(self.master_address, {})[0m
[30;1m440 | [0m[35m[0m
[30;1m441 | [0m[35m            # No need for try/finally, because we don't update the file after failures.[0m
[30;1m442 | [0m[35m            yield substore[0m
[30;1m443 | [0m[35m[0m
[30;1m444 | [0m[35m            # Reconfigure our cached variables.[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m65 | [0m[35m        results.append(bad + "password must have at least 8 characters")[0m
[30;1m66 | [0m[35m        ok = False[0m
[30;1m67 | [0m[35m    else:[0m
[30;1m68 | [0m[35m        results.append(good + "password must have at least 8 characters")[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    if not password or re.search(r"[A-Z]", password) is None:[0m
[30;1m71 | [0m[35m        results.append(bad + "password must include an uppercase letter")[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35m        results.append(good + "password cannot be blank")[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if not password or len(password) < 8:[0m
[30;1m65 | [0m[35m        results.append(bad + "password must have at least 8 characters")[0m
[30;1m66 | [0m[35m        ok = False[0m
[30;1m67 | [0m[35m    else:[0m
[30;1m68 | [0m[35m        results.append(good + "password must have at least 8 characters")[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m40 | [0m[35m        - Must be at least 8 characters long.[0m
[30;1m41 | [0m[35m        - Must contain at least one upper-case letter.[0m
[30;1m42 | [0m[35m        - Must contain at least one lower-case letter.[0m
[30;1m43 | [0m[35m        - Must contain at least one number.[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    Args:[0m
[30;1m46 | [0m[35m        password: a password to check.[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m    The complexity requirements are:[0m
[30;1m40 | [0m[35m        - Must be at least 8 characters long.[0m
[30;1m41 | [0m[35m        - Must contain at least one upper-case letter.[0m
[30;1m42 | [0m[35m        - Must contain at least one lower-case letter.[0m
[30;1m43 | [0m[35m        - Must contain at least one number.[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    Args:[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    The complexity requirements are:[0m
[30;1m40 | [0m[35m        - Must be at least 8 characters long.[0m
[30;1m41 | [0m[35m        - Must contain at least one upper-case letter.[0m
[30;1m42 | [0m[35m        - Must contain at least one lower-case letter.[0m
[30;1m43 | [0m[35m        - Must contain at least one number.[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m    """Raises a ValueError if the password does not meet complexity requirements.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    The complexity requirements are:[0m
[30;1m40 | [0m[35m        - Must be at least 8 characters long.[0m
[30;1m41 | [0m[35m        - Must contain at least one upper-case letter.[0m
[30;1m42 | [0m[35m        - Must contain at least one lower-case letter.[0m
[30;1m43 | [0m[35m        - Must contain at least one number.[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35mdef _is_token_valid(master_address: str, token: str, cert: Optional[certs.Cert]) -> bool:[0m
[30;1m336 | [0m[35m    """[0m
[30;1m337 | [0m[35m    Find out whether the given token is valid by attempting to use it[0m
[30;1m338 | [0m[35m    on the "api/v1/me" endpoint.[0m
[30;1m339 | [0m[35m    """[0m
[30;1m340 | [0m[35m    sess = api.Session(master_address, username="ignored", token=token, cert=cert)[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m    This is the login path for nearly all user-facing cases.[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    Unlike ``login``, this function may not send a login request to the master. It will instead[0m
[30;1m192 | [0m[35m    first attempt to find a valid token in the TokenStore, and only if that fails will it post a[0m
[30;1m193 | [0m[35m    login request to the master to generate a new one. As with ``login``, the token is then baked[0m
[30;1m194 | [0m[35m    into a new ``api.Session`` object to sign future communication with master.[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m        return requested_user, password, False[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    # Next highest priority is user/password from environment.[0m
[30;1m158 | [0m[35m    # Watch out! We have to check for DET_USER and DET_PASS, because containers will have DET_USER[0m
[30;1m159 | [0m[35m    # set, but that doesn't overrule the active user in the TokenStore, because if the TokenStore in[0m
[30;1m160 | [0m[35m    # the container has an active user, that means the user has explicitly ran `det user login`[0m
[30;1m161 | [0m[35m    # inside the container.[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/authentication.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m    requests to the master. This token is then baked into a new api.Session object for those future[0m
[30;1m119 | [0m[35m    communications.[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    Used as part of login_with_cache, and also useful in tests where you wish to not affect the[0m
[30;1m122 | [0m[35m    TokenStore.[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/streams/_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m478 | [0m[35m[0m
[30;1m479 | [0m[35m                    # Process the message.[0m
[30;1m480 | [0m[35m                    for k, v in msg.items():[0m
[30;1m481 | [0m[35m                        handler = self.handlers.get(k, None)[0m
[30;1m482 | [0m[35m                        if handler is None:[0m
[30;1m483 | [0m[35m                            raise ValueError(f"unhandled msg: key {k} in {msg}")[0m
[30;1m484 | [0m[35m                        result = handler(v)[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/streams/_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m360 | [0m[35m        # subscription after we send this new subscription.  The reason is that the additional[0m
[30;1m361 | [0m[35m        # messages for the old subscription would mess with the state of our KeyCache objects (from[0m
[30;1m362 | [0m[35m        # which we calculated the since values of the new subscription).  However, the messages from[0m
[30;1m363 | [0m[35m        # our new subscription will be tailored to the state of the KeyCache objects at this moment.[0m
[30;1m364 | [0m[35m        # So effectively, ignoring additional messages from the old subscription protects the state[0m
[30;1m365 | [0m[35m        # of our KeyCache objects.[0m
[30;1m366 | [0m[35m        for k, v in subscribe.items():[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/streams/_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m355 | [0m[35m        subscribe = {k: v._to_wire() for k, v in spec.items()}[0m
[30;1m356 | [0m[35m        # add since info to our initial subscriptions[0m
[30;1m357 | [0m[35m        #[0m
[30;1m358 | [0m[35m        # Note: it is important that we calculate our since values at the moment that we send the[0m
[30;1m359 | [0m[35m        # new subscription, and that we ignore additional messages which arrive for the old[0m
[30;1m360 | [0m[35m        # subscription after we send this new subscription.  The reason is that the additional[0m
[30;1m361 | [0m[35m        # messages for the old subscription would mess with the state of our KeyCache objects (from[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/streams/_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m244 | [0m[35m    state of one or more experiments.[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    The Stream can be iterated over to read events related to subscriptions.  A subscription is set[0m
[30;1m247 | [0m[35m    with .subscribe().  There is only ever one active subscription at a time.  Each call to[0m
[30;1m248 | [0m[35m    .subscribe() causes the stream to yield a Sync(complete=False) message, followed by any number[0m
[30;1m249 | [0m[35m    of subscription-related messages, then a Sync(complete=True) message.  The second Sync indicates[0m
[30;1m250 | [0m[35m    that the client has loaded all state from the Determined master, and additional[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/streams/_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport abc[0m
[30;1m2 | [0m[35mimport collections[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom typing import ([0m
[30;1m6 | [0m[35m    Any,[0m
[30;1m7 | [0m[35m    Callable,[0m
[30;1m8 | [0m[35m    Deque,[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m        timestampBefore=timestamp_before,[0m
[30;1m84 | [0m[35m        timestampAfter=timestamp_after,[0m
[30;1m85 | [0m[35m    )[0m
[30;1m86 | [0m[35m    yield from (logs if tail is None else reversed(list(logs)))[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mdef levels_at_or_above([0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m    timestamp_before: Optional[str] = None,[0m
[30;1m65 | [0m[35m    timestamp_after: Optional[str] = None,[0m
[30;1m66 | [0m[35m) -> Iterable[bindings.v1TaskLogsResponse]:[0m
[30;1m67 | [0m[35m    if sum((head is not None, tail is not None, follow)) > 1:[0m
[30;1m68 | [0m[35m        raise ValueError("at most one of head, tail, or follow may be set")[0m
[30;1m69 | [0m[35m    logs = bindings.get_TaskLogs([0m
[30;1m70 | [0m[35m        session,[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        timestampBefore=timestamp_before,[0m
[30;1m46 | [0m[35m        timestampAfter=timestamp_after,[0m
[30;1m47 | [0m[35m    )[0m
[30;1m48 | [0m[35m    yield from (logs if tail is None else reversed(list(logs)))[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35mdef task_logs([0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    timestamp_after: Optional[str] = None,[0m
[30;1m28 | [0m[35m    search_text: Optional[str] = None,[0m
[30;1m29 | [0m[35m) -> Iterable[bindings.v1TrialLogsResponse]:[0m
[30;1m30 | [0m[35m    if sum((head is not None, tail is not None, follow)) > 1:[0m
[30;1m31 | [0m[35m        raise ValueError("at most one of head, tail, or follow may be set")[0m
[30;1m32 | [0m[35m    logs = bindings.get_TrialLogs([0m
[30;1m33 | [0m[35m        session,[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m891 | [0m[35m                render.format_resources(c["Resources"]),[0m
[30;1m892 | [0m[35m            ][0m
[30;1m893 | [0m[35m            for c in sorted(checkpoints, key=lambda c: (c["TrialID"], c["ReportTime"]))[0m
[30;1m894 | [0m[35m            if "step" in c and c["step"].get("validation")[0m
[30;1m895 | [0m[35m        ][0m
[30;1m896 | [0m[35m[0m
[30;1m897 | [0m[35m        if len(values) != 0:[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m866 | [0m[35m        "save_trial_latest": args.save_trial_latest,[0m
[30;1m867 | [0m[35m    }[0m
[30;1m868 | [0m[35m    if not args.yes:[0m
[30;1m869 | [0m[35m        r = sess.get(f"experiments/{args.experiment_id}/preview_gc", params=policy)[0m
[30;1m870 | [0m[35m        response = r.json()[0m
[30;1m871 | [0m[35m        checkpoints = response["checkpoints"][0m
[30;1m872 | [0m[35m        metric_name = response["metric_name"][0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m        stacklevel=2,[0m
[30;1m287 | [0m[35m    )[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m    common.set_logger(bool(experiment_config.get("debug", False)))[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    with det._local_execution_manager(args.model_def.resolve()):[0m
[30;1m292 | [0m[35m        trial_class = load.trial_class_from_entrypoint(entrypoint)[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m115 | [0m[35m        # Wait for experiment to start and initialize a trial.[0m
[30;1m116 | [0m[35m        runner_state = trials[0].runnerState if trials else None[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        # Update the active_stage by examining the experiment state and trial runner state.[0m
[30;1m119 | [0m[35m        if exp.state == bindings.experimentv1State.COMPLETED:[0m
[30;1m120 | [0m[35m            active_stage = 4[0m
[30;1m121 | [0m[35m        elif runner_state == "checkpointing":[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1352 | [0m[35m                                "--days",[0m
[30;1m1353 | [0m[35m                                type=none_or_int,[0m
[30;1m1354 | [0m[35m                                help="number of days to retain the logs for, from the "[0m
[30;1m1355 | [0m[35m                                "end time of the task, . allowed range: -1 to 32767.",[0m
[30;1m1356 | [0m[35m                            ),[0m
[30;1m1357 | [0m[35m                            cli.Arg([0m
[30;1m1358 | [0m[35m                                "--forever",[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1215 | [0m[35m                    "--smaller-is-better",[0m
[30;1m1216 | [0m[35m                    type=lambda s: util.strtobool(s),[0m
[30;1m1217 | [0m[35m                    default=None,[0m
[30;1m1218 | [0m[35m                    help="The sort order for metrics when using --sort-by. For "[0m
[30;1m1219 | [0m[35m                    "example, 'accuracy' would require passing '--smaller-is-better false'. If "[0m
[30;1m1220 | [0m[35m                    "--sort-by is specified, this argument must be specified.",[0m
[30;1m1221 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1207 | [0m[35m                    "--sort-by",[0m
[30;1m1208 | [0m[35m                    type=str,[0m
[30;1m1209 | [0m[35m                    default=None,[0m
[30;1m1210 | [0m[35m                    help="The name of the validation metric to sort on. Without --sort-by, the "[0m
[30;1m1211 | [0m[35m                    "experiment's searcher metric is assumed. If this argument is specified, "[0m
[30;1m1212 | [0m[35m                    "--smaller-is-better must also be specified.",[0m
[30;1m1213 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1189 | [0m[35m                    "--output-dir",[0m
[30;1m1190 | [0m[35m                    type=str,[0m
[30;1m1191 | [0m[35m                    default="checkpoints",[0m
[30;1m1192 | [0m[35m                    help="Desired top level directory for the checkpoints. "[0m
[30;1m1193 | [0m[35m                    "Checkpoints will be downloaded to "[0m
[30;1m1194 | [0m[35m                    "<output_dir>/<checkpoint_uuid>/<checkpoint_files>.",[0m
[30;1m1195 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m908 | [0m[35m    if args.yes or render.yes_or_no([0m
[30;1m909 | [0m[35m        "Changing the checkpoint garbage collection policy of an "[0m
[30;1m910 | [0m[35m        "experiment may result\n"[0m
[30;1m911 | [0m[35m        "in the unrecoverable deletion of checkpoints.  Do you wish to "[0m
[30;1m912 | [0m[35m        "proceed?"[0m
[30;1m913 | [0m[35m    ):[0m
[30;1m914 | [0m[35m        exp_patch = bindings.v1PatchExperiment([0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m592 | [0m[35m    if not args.forever and not isinstance(args.days, int):[0m
[30;1m593 | [0m[35m        raise cli.CliError([0m
[30;1m594 | [0m[35m            "Please provide an argument to set log retention. --days sets the number of days to"[0m
[30;1m595 | [0m[35m            " retain logs from the end time of the task, eg. `det e set log-retention 1 --days 50`."[0m
[30;1m596 | [0m[35m            " --forever retains logs indefinitely, eg.`det e set log-retention 1 --forever`."[0m
[30;1m597 | [0m[35m        )[0m
[30;1m598 | [0m[35m    elif isinstance(args.days, int) and (args.days < -1 or args.days > 32767):[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m281 | [0m[35m        "setting of the experiment config has also been deprecated, and since --test mode relies "[0m
[30;1m282 | [0m[35m        "on that setting, --test mode will cease to work as soon as you remove max_length.  "[0m
[30;1m283 | [0m[35m        "Additionally, --local mode should no longer be necessary, as you should be able to just "[0m
[30;1m284 | [0m[35m        "invoke your script directly.",[0m
[30;1m285 | [0m[35m        FutureWarning,[0m
[30;1m286 | [0m[35m        stacklevel=2,[0m
[30;1m287 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m    if not det.util.match_legacy_trial_class(entrypoint):[0m
[30;1m272 | [0m[35m        raise NotImplementedError([0m
[30;1m273 | [0m[35m            "Local test mode (--local --test) is only supported for Trial-like entrypoints. "[0m
[30;1m274 | [0m[35m            "Script-like entrypoints are not supported, but maybe you can just invoke your script "[0m
[30;1m275 | [0m[35m            "directly?"[0m
[30;1m276 | [0m[35m        )[0m
[30;1m277 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m    entrypoint = experiment_config["entrypoint"][0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    # --local --test mode only makes sense for the legacy trial entrypoints.  Otherwise the user[0m
[30;1m270 | [0m[35m    # would just run their training script directly.[0m
[30;1m271 | [0m[35m    if not det.util.match_legacy_trial_class(entrypoint):[0m
[30;1m272 | [0m[35m        raise NotImplementedError([0m
[30;1m273 | [0m[35m            "Local test mode (--local --test) is only supported for Trial-like entrypoints. "[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport pathlib[0m
[30;1m6 | [0m[35mimport pprint[0m
[30;1m7 | [0m[35mimport sys[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mimport warnings[0m
[30;1m10 | [0m[35mfrom typing import Any, Dict, Iterable, List, Optional, Sequence, Set, Union[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport tabulate[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/experiment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport numbers[0m
[30;1m5 | [0m[35mimport pathlib[0m
[30;1m6 | [0m[35mimport pprint[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m        print("Delete Successful")[0m
[30;1m151 | [0m[35m        return[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    det_configs["labels"] = dict(det_configs.get("add_label", []))[0m
[30;1m154 | [0m[35m    reserved_labels = {[0m
[30;1m155 | [0m[35m        "determined-master-host",[0m
[30;1m156 | [0m[35m        "determined-master-port",[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m533 | [0m[35m                            "--max-dynamic-agents",[0m
[30;1m534 | [0m[35m                            type=int,[0m
[30;1m535 | [0m[35m                            default=constants.defaults.MAX_DYNAMIC_AGENTS,[0m
[30;1m536 | [0m[35m                            help="maximum number of dynamic agent instances at one time",[0m
[30;1m537 | [0m[35m                        ),[0m
[30;1m538 | [0m[35m                        cli.Arg([0m
[30;1m539 | [0m[35m                            "--min-cpu-platform-master",[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m527 | [0m[35m                            "--min-dynamic-agents",[0m
[30;1m528 | [0m[35m                            type=int,[0m
[30;1m529 | [0m[35m                            default=constants.defaults.MIN_DYNAMIC_AGENTS,[0m
[30;1m530 | [0m[35m                            help="minimum number of dynamic agent instances at one time",[0m
[30;1m531 | [0m[35m                        ),[0m
[30;1m532 | [0m[35m                        cli.Arg([0m
[30;1m533 | [0m[35m                            "--max-dynamic-agents",[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m19 | [0m[35m    def validate(s: str) -> str:[0m
[30;1m20 | [0m[35m        if isinstance(s, str) and len(s) <= 35:[0m
[30;1m21 | [0m[35m            return s[0m
[30;1m22 | [0m[35m        raise argparse.ArgumentTypeError("must be at most 35 characters")[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    return validate[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m503 | [0m[35m                            "--max-agent-starting-period",[0m
[30;1m504 | [0m[35m                            type=str,[0m
[30;1m505 | [0m[35m                            default=constants.defaults.MAX_AGENT_STARTING_PERIOD,[0m
[30;1m506 | [0m[35m                            help="max agent starting time before retrying, e.g. 30m for 30 minutes",[0m
[30;1m507 | [0m[35m                        ),[0m
[30;1m508 | [0m[35m                        cli.Arg([0m
[30;1m509 | [0m[35m                            "--port",[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m496 | [0m[35m                            "--max-idle-agent-period",[0m
[30;1m497 | [0m[35m                            type=str,[0m
[30;1m498 | [0m[35m                            default=constants.defaults.MAX_IDLE_AGENT_PERIOD,[0m
[30;1m499 | [0m[35m                            help="max agent idle time before it is shut down, "[0m
[30;1m500 | [0m[35m                            "e.g. 30m for 30 minutes",[0m
[30;1m501 | [0m[35m                        ),[0m
[30;1m502 | [0m[35m                        cli.Arg([0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m456 | [0m[35m                            "--operation-timeout-period",[0m
[30;1m457 | [0m[35m                            type=str,[0m
[30;1m458 | [0m[35m                            default=constants.defaults.OPERATION_TIMEOUT_PERIOD,[0m
[30;1m459 | [0m[35m                            help="operation timeout before retrying, e.g. 5m for 5 minutes",[0m
[30;1m460 | [0m[35m                        ),[0m
[30;1m461 | [0m[35m                        cli.Arg([0m
[30;1m462 | [0m[35m                            "--master-instance-type",[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m382 | [0m[35m                            "--keypath",[0m
[30;1m383 | [0m[35m                            type=str,[0m
[30;1m384 | [0m[35m                            default=None,[0m
[30;1m385 | [0m[35m                            help="path to service account key if not using default credentials",[0m
[30;1m386 | [0m[35m                        ),[0m
[30;1m387 | [0m[35m                        cli.Arg([0m
[30;1m388 | [0m[35m                            "--network",[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m            )[0m
[30;1m216 | [0m[35m            print([0m
[30;1m217 | [0m[35m                "For details, SSH to master instance and run "[0m
[30;1m218 | [0m[35m                "`sudo journalctl -u google-startup-scripts.service`"[0m
[30;1m219 | [0m[35m                " or check /var/log/cloud-init-output.log."[0m
[30;1m220 | [0m[35m            )[0m
[30;1m221 | [0m[35m            sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35m                )[0m
[30;1m215 | [0m[35m            )[0m
[30;1m216 | [0m[35m            print([0m
[30;1m217 | [0m[35m                "For details, SSH to master instance and run "[0m
[30;1m218 | [0m[35m                "`sudo journalctl -u google-startup-scripts.service`"[0m
[30;1m219 | [0m[35m                " or check /var/log/cloud-init-output.log."[0m
[30;1m220 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m                + " and cluster id to delete the cluster."[0m
[30;1m103 | [0m[35m            )[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m        # TODO: Find a way to get config defaults using CLI Parser Pipeline.[0m
[30;1m106 | [0m[35m        det_configs = {[0m
[30;1m107 | [0m[35m            "no_preflight_checks": False,[0m
[30;1m108 | [0m[35m            "no_wait_for_master": False,[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m        print("Using local state path:", args.local_state_path)[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    # Set the TF_DATA_DIR where Terraform will store its supporting files[0m
[30;1m64 | [0m[35m    env = os.environ.copy()[0m
[30;1m65 | [0m[35m    env["TF_DATA_DIR"] = os.path.join(args.local_state_path, "terraform_data")[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    # Initialize determined configurations.[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/analytics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Segment.io Configuration[0m
[30;1m14 | [0m[35m# https://github.com/segmentio/analytics-python/blob/5d87a9085c18ee25660c8196dd1233100f9b61b6/segmen[0m
[30;1m15 | [0m[35manalytics.write_key = os.environ.get("DET_SEGMENT_API_KEY")[0m
[30;1m16 | [0m[35manalytics.max_retries = 5[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/analytics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35mlogger = logging.getLogger("determined.common")[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35menabled = os.environ.get("DET_SEGMENT_ENABLED") == "true"[0m
[30;1m11 | [0m[35m_cluster_id = os.environ.get("DET_CLUSTER_ID")[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Segment.io Configuration[0m
[30;1m14 | [0m[35m# https://github.com/segmentio/analytics-python/blob/5d87a9085c18ee25660c8196dd1233100f9b61b6/segmen[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/analytics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mlogger = logging.getLogger("determined.common")[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35menabled = os.environ.get("DET_SEGMENT_ENABLED") == "true"[0m
[30;1m11 | [0m[35m_cluster_id = os.environ.get("DET_CLUSTER_ID")[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Segment.io Configuration[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/gcs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m            raise errors.NoDirectStorageAccess("Unable to access cloud checkpoint storage") from e[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        if not found:[0m
[30;1m141 | [0m[35m            raise errors.CheckpointNotFound(f"Did not find checkpoint {path} in GCS")[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    @util.preserve_random_state[0m
[30;1m144 | [0m[35m    def delete(self, storage_id: str, globs: List[str]) -> Dict[str, int]:[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/gcs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    Authentication is currently only supported via the "Application[0m
[30;1m29 | [0m[35m    Default Credentials" method in GCP [1]. Typical configuration:[0m
[30;1m30 | [0m[35m    ensure your VM runs in a service account that has sufficient[0m
[30;1m31 | [0m[35m    permissions to read/write/delete from the GCS bucket where[0m
[30;1m32 | [0m[35m    checkpoints will be stored (this only works when running in GCE).[0m
[30;1m33 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/shared.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m        check.is_in("host_path", config, "shared_fs config is missing host_path")[0m
[30;1m175 | [0m[35m        # Ignore legacy configuration values propagation and container_path.[0m
[30;1m176 | [0m[35m        base_path = _full_storage_path([0m
[30;1m177 | [0m[35m            config["host_path"], config.get("storage_path"), container_path[0m
[30;1m178 | [0m[35m        )[0m
[30;1m179 | [0m[35m        return cls(base_path)[0m
[30;1m180 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/shared.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m283 | [0m[35m            copytree(src, dst, selector=selector)[0m
[30;1m284 | [0m[35m        except FileNotFoundError:[0m
[30;1m285 | [0m[35m            raise errors.CheckpointNotFound([0m
[30;1m286 | [0m[35m                f"Did not find checkpoint {src} in shared_fs storage"[0m
[30;1m287 | [0m[35m            ) from None[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/shared.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m        )[0m
[30;1m210 | [0m[35m        storage_dir = os.path.join(self._base_path, src)[0m
[30;1m211 | [0m[35m        if not os.path.exists(storage_dir):[0m
[30;1m212 | [0m[35m            raise errors.CheckpointNotFound(f"Did not find checkpoint {src} in shared_fs storage")[0m
[30;1m213 | [0m[35m        yield pathlib.Path(storage_dir)[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m    def delete(self, tgt: str, globs: List[str]) -> Dict[str, int]:[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/shared.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m            else:[0m
[30;1m56 | [0m[35m                # If selector is None all files are copied; if selector is not None[0m
[30;1m57 | [0m[35m                # then files are copied according to the selector. Before files[0m
[30;1m58 | [0m[35m                # are copied all top directory structure is created. This ensures[0m
[30;1m59 | [0m[35m                # that copied dirs are not dangling.[0m
[30;1m60 | [0m[35m                if selector is None or selector(src_relpath):[0m
[30;1m61 | [0m[35m                    have_copied = True[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m            # Use posixpath so that we always use forward slashes, even on Windows.[0m
[30;1m89 | [0m[35m            container_blob = posixpath.join(self.container, blob)[0m
[30;1m90 | [0m[35m            blob_dir, blob_base = posixpath.split(container_blob)[0m
[30;1m91 | [0m[35m            self.client.get(blob_dir, blob_base, _dst)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        if not found:[0m
[30;1m94 | [0m[35m            raise errors.CheckpointNotFound(f"Did not find checkpoint {src} in Azure Blob Storage")[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/azure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m            self.client.get(blob_dir, blob_base, _dst)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        if not found:[0m
[30;1m94 | [0m[35m            raise errors.CheckpointNotFound(f"Did not find checkpoint {src} in Azure Blob Storage")[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    @util.preserve_random_state[0m
[30;1m97 | [0m[35m    def delete(self, tgt: str, globs: List[str]) -> Dict[str, int]:[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m        if now < self._check_time:[0m
[30;1m74 | [0m[35m            return[0m
[30;1m75 | [0m[35m        with self._lock:[0m
[30;1m76 | [0m[35m            # Real time check after acquiring lock[0m
[30;1m77 | [0m[35m            if now < self._check_time:[0m
[30;1m78 | [0m[35m                return[0m
[30;1m79 | [0m[35m            self._check_time = now + self._check_every[0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/boto3_credential_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport threading[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom typing import Any[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport boto3[0m
[30;1m8 | [0m[35mfrom botocore import compat, credentials, session[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/metric_writers/pytorch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12 | [0m[35m# importing distutils.version.  We can workaround this by prepopulating the distutils.version[0m
[30;1m13 | [0m[35m# submodule in the distutils module.[0m
[30;1m14 | [0m[35mif version.parse("1.9.0") <= version.parse(torch.__version__) < version.parse("1.11.0"):[0m
[30;1m15 | [0m[35m    # Except, starting with python 3.12 distutils isn't available at all.[0m
[30;1m16 | [0m[35m    try:[0m
[30;1m17 | [0m[35m        import distutils.version  # isort:skip  # noqa: F401[0m
[30;1m18 | [0m[35m    except ImportError:[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m        """[0m
[30;1m374 | [0m[35m        Return the data configuration.[0m
[30;1m375 | [0m[35m        """[0m
[30;1m376 | [0m[35m        return self.get_experiment_config().get("data", {})[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m    def get_experiment_id(self) -> int:[0m
[30;1m379 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m                slots_per_trial=slots_per_trial,[0m
[30;1m90 | [0m[35m                trialname="DeepSpeedTrial",[0m
[30;1m91 | [0m[35m            )[0m
[30;1m92 | [0m[35m            if hparams and hparams.get("global_batch_size", None)[0m
[30;1m93 | [0m[35m            else (None, None)[0m
[30;1m94 | [0m[35m        )[0m
[30;1m95 | [0m[35m        self._hparams = hparams[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m443 | [0m[35m    def _maybe_reset_tbd_writer(self) -> None:[0m
[30;1m444 | [0m[35m        """[0m
[30;1m445 | [0m[35m        Reset (close current file and open a new one) the current writer if the current epoch[0m
[30;1m446 | [0m[35m        second is at least one second greater than the epoch second of the last reset.[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m        The TensorFlow event writer names each event file by the epoch second it is created, so[0m
[30;1m449 | [0m[35m        if events are written quickly in succession (< 1 second apart), they will overwrite each[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m426 | [0m[35m            # without actually importing distutils.version.  We can workaround this by prepopulating[0m
[30;1m427 | [0m[35m            # the distutils.version submodule in the distutils module.[0m
[30;1m428 | [0m[35m            #[0m
[30;1m429 | [0m[35m            # Except, starting with python 3.12 distutils isn't available at all.[0m
[30;1m430 | [0m[35m            try:[0m
[30;1m431 | [0m[35m                import distutils.version  # noqa: F401[0m
[30;1m432 | [0m[35m            except ImportError:[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m216 | [0m[35m        guarantee that an appropriate ``Sampler`` is used that ensures:[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        - When ``shuffle=True``, the shuffle is reproducible.[0m
[30;1m219 | [0m[35m        - The dataset will start at the right location, even after pausing/continuing.[0m
[30;1m220 | [0m[35m        - Proper sharding is used during distributed training.[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        However, there can be cases where either reproducibility of the dataset is not needed or[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m525 | [0m[35m            )[0m
[30;1m526 | [0m[35m        if name not in self.get_hparams():[0m
[30;1m527 | [0m[35m            raise ValueError([0m
[30;1m528 | [0m[35m                "Could not find name '{}' in experiment "[0m
[30;1m529 | [0m[35m                "hyperparameters. Please check your experiment "[0m
[30;1m530 | [0m[35m                "configuration 'hyperparameters' section.".format(name)[0m
[30;1m531 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m402 | [0m[35m        """[0m
[30;1m403 | [0m[35m        This function returns an instance of ``torch.utils.tensorboard.SummaryWriter``[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m        Trials users who wish to log to TensorBoard can use this writer object.[0m
[30;1m406 | [0m[35m        We provide and manage a writer in order to save and upload TensorBoard[0m
[30;1m407 | [0m[35m        files automatically on behalf of the user.[0m
[30;1m408 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    You can use source_ds_dict to overwrite leaf nodes of the base_ds_config.[0m
[30;1m26 | [0m[35m    More precisely, we will iterate depth first into source_ds_dict and if a node corresponds to[0m
[30;1m27 | [0m[35m    a leaf node of base_ds_config, we copy the node value over to base_ds_config.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    Arguments:[0m
[30;1m30 | [0m[35m        base_ds_config (str or Dict): either a path to a DeepSpeed config file or a dictionary.[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    You can use source_ds_dict to overwrite leaf nodes of the base_ds_config.[0m
[30;1m26 | [0m[35m    More precisely, we will iterate depth first into source_ds_dict and if a node corresponds to[0m
[30;1m27 | [0m[35m    a leaf node of base_ds_config, we copy the node value over to base_ds_config.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    Arguments:[0m
[30;1m30 | [0m[35m        base_ds_config (str or Dict): either a path to a DeepSpeed config file or a dictionary.[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m    """Overwrite a base_ds_config with values from a source_ds_dict.[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    You can use source_ds_dict to overwrite leaf nodes of the base_ds_config.[0m
[30;1m26 | [0m[35m    More precisely, we will iterate depth first into source_ds_dict and if a node corresponds to[0m
[30;1m27 | [0m[35m    a leaf node of base_ds_config, we copy the node value over to base_ds_config.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    Arguments:[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport pathlib[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport warnings[0m
[30;1m6 | [0m[35mfrom importlib import util as importutil[0m
[30;1m7 | [0m[35mfrom typing import Any, Dict, List, Optional, Set, Type, Union, cast[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        blobs = container.list_blobs(name_starts_with=prefix)[0m
[30;1m46 | [0m[35m        for blob in blobs:[0m
[30;1m47 | [0m[35m            filepath, mtime = blob["name"], blob["last_modified"][0m
[30;1m48 | [0m[35m            prev_mtime = self._file_records.get(filepath)[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m            if prev_mtime is not None and prev_mtime >= mtime:[0m
[30;1m51 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        account_url = storage_config.get("account_url")[0m
[30;1m19 | [0m[35m        credential = storage_config.get("credential")[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m        if storage_config.get("connection_string"):[0m
[30;1m22 | [0m[35m            self.client = blob.BlobServiceClient.from_connection_string(connection_string)[0m
[30;1m23 | [0m[35m        elif account_url:[0m
[30;1m24 | [0m[35m            self.client = blob.BlobServiceClient(account_url, credential)[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m        connection_string = storage_config.get("connection_string")[0m
[30;1m17 | [0m[35m        container = storage_config.get("container")[0m
[30;1m18 | [0m[35m        account_url = storage_config.get("account_url")[0m
[30;1m19 | [0m[35m        credential = storage_config.get("credential")[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m        if storage_config.get("connection_string"):[0m
[30;1m22 | [0m[35m            self.client = blob.BlobServiceClient.from_connection_string(connection_string)[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m        connection_string = storage_config.get("connection_string")[0m
[30;1m17 | [0m[35m        container = storage_config.get("container")[0m
[30;1m18 | [0m[35m        account_url = storage_config.get("account_url")[0m
[30;1m19 | [0m[35m        credential = storage_config.get("credential")[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m        if storage_config.get("connection_string"):[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m        from azure.storage import blob[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m        connection_string = storage_config.get("connection_string")[0m
[30;1m17 | [0m[35m        container = storage_config.get("container")[0m
[30;1m18 | [0m[35m        account_url = storage_config.get("account_url")[0m
[30;1m19 | [0m[35m        credential = storage_config.get("credential")[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/azure.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m    def __init__(self, storage_config: Dict[str, Any], storage_paths: List[str], local_dir: str):[0m
[30;1m14 | [0m[35m        from azure.storage import blob[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m        connection_string = storage_config.get("connection_string")[0m
[30;1m17 | [0m[35m        container = storage_config.get("container")[0m
[30;1m18 | [0m[35m        account_url = storage_config.get("account_url")[0m
[30;1m19 | [0m[35m        credential = storage_config.get("credential")[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m        "saveExperimentBest", 0[0m
[30;1m244 | [0m[35m    )[0m
[30;1m245 | [0m[35m    checkpointStorage["saveTrialBest"] = helm_values["checkpointStorage"].get("saveTrialBest", 1)[0m
[30;1m246 | [0m[35m    checkpointStorage["saveTrialLatest"] = helm_values["checkpointStorage"].get([0m
[30;1m247 | [0m[35m        "saveTrialLatest", 1[0m
[30;1m248 | [0m[35m    )[0m
[30;1m249 | [0m[35m    checkpointStorage["type"] = "gcs"[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m    checkpointStorage["saveExperimentBest"] = helm_values["checkpointStorage"].get([0m
[30;1m243 | [0m[35m        "saveExperimentBest", 0[0m
[30;1m244 | [0m[35m    )[0m
[30;1m245 | [0m[35m    checkpointStorage["saveTrialBest"] = helm_values["checkpointStorage"].get("saveTrialBest", 1)[0m
[30;1m246 | [0m[35m    checkpointStorage["saveTrialLatest"] = helm_values["checkpointStorage"].get([0m
[30;1m247 | [0m[35m        "saveTrialLatest", 1[0m
[30;1m248 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m    with (helm_dir / "values.yaml").open() as f:[0m
[30;1m240 | [0m[35m        helm_values = util.safe_load_yaml_with_exceptions(f)[0m
[30;1m241 | [0m[35m    checkpointStorage = {}[0m
[30;1m242 | [0m[35m    checkpointStorage["saveExperimentBest"] = helm_values["checkpointStorage"].get([0m
[30;1m243 | [0m[35m        "saveExperimentBest", 0[0m
[30;1m244 | [0m[35m    )[0m
[30;1m245 | [0m[35m    checkpointStorage["saveTrialBest"] = helm_values["checkpointStorage"].get("saveTrialBest", 1)[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    if not pod_spec:[0m
[30;1m20 | [0m[35m        pod_spec = {"apiVersion": "v1", "kind": "Pod"}[0m
[30;1m21 | [0m[35m    pod_spec = cast(Dict[str, Union[Dict, str]], pod_spec)[0m
[30;1m22 | [0m[35m    if not pod_spec.get("spec"):[0m
[30;1m23 | [0m[35m        pod_spec["spec"] = {}[0m
[30;1m24 | [0m[35m    return pod_spec[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mdef make_spec(task_container_defaults: Dict[str, Any], key: str) -> Dict[str, Union[Dict, str]]:[0m
[30;1m18 | [0m[35m    pod_spec = task_container_defaults.get(key)  # type: Optional[Dict][0m
[30;1m19 | [0m[35m    if not pod_spec:[0m
[30;1m20 | [0m[35m        pod_spec = {"apiVersion": "v1", "kind": "Pod"}[0m
[30;1m21 | [0m[35m    pod_spec = cast(Dict[str, Union[Dict, str]], pod_spec)[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m484 | [0m[35m                            help="Enables the priority-based scheduler with preemption on the GPU"[0m
[30;1m485 | [0m[35m                            " Agent Nodepool. If this argument is set, cluster autoscaling is"[0m
[30;1m486 | [0m[35m                            " disabled, and --max-gpu-nodes nodes are statically allocated for the "[0m
[30;1m487 | [0m[35m                            " GPU Agent Node pool at creation time.",[0m
[30;1m488 | [0m[35m                            action="store_true",[0m
[30;1m489 | [0m[35m                        ),[0m
[30;1m490 | [0m[35m                    ],[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m474 | [0m[35m                            " provides priority-based gang scheduling for the GPU Agent Nodepool."[0m
[30;1m475 | [0m[35m                            "If this argument is set, cluster autoscaling is disabled, and"[0m
[30;1m476 | [0m[35m                            " --max-gpu-nodes nodes are statically allocated for the GPU Agent Node"[0m
[30;1m477 | [0m[35m                            " pool at creation time.",[0m
[30;1m478 | [0m[35m                            action="store_true",[0m
[30;1m479 | [0m[35m                        ),[0m
[30;1m480 | [0m[35m                        cli.Arg([0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m335 | [0m[35m        if args.gcs_bucket_name is None:[0m
[30;1m336 | [0m[35m            args.gcs_bucket_name = args.cluster_id + "-checkpoints"[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m        cmd = ["gsutil", "rm", "-r", "gs://{}".format(args.gcs_bucket_name)][0m
[30;1m339 | [0m[35m        subprocess.check_call(cmd, stdout=subprocess.DEVNULL)[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    print("Succesfully deleted GKE Cluster {}".format(args.cluster_id))[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m319 | [0m[35m    )[0m
[30;1m320 | [0m[35m    cmd = ["kubectl", "config", "set-cluster", args.cluster_id][0m
[30;1m321 | [0m[35m    subprocess.check_call(cmd)[0m
[30;1m322 | [0m[35m    cmd = [[0m
[30;1m323 | [0m[35m        "gcloud",[0m
[30;1m324 | [0m[35m        "container",[0m
[30;1m325 | [0m[35m        "clusters",[0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m317 | [0m[35m        ).format(args.cluster_id),[0m
[30;1m318 | [0m[35m        "yellow",[0m
[30;1m319 | [0m[35m    )[0m
[30;1m320 | [0m[35m    cmd = ["kubectl", "config", "set-cluster", args.cluster_id][0m
[30;1m321 | [0m[35m    subprocess.check_call(cmd)[0m
[30;1m322 | [0m[35m    cmd = [[0m
[30;1m323 | [0m[35m        "gcloud",[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m304 | [0m[35m        )[0m
[30;1m305 | [0m[35m    create_cluster(args)[0m
[30;1m306 | [0m[35m    configure_helm(args)[0m
[30;1m307 | [0m[35m    cmd = ["helm", "install", "determined-gke", args.helm_dir][0m
[30;1m308 | [0m[35m    subprocess.check_call(cmd)[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m212 | [0m[35m    if args.multiple_node_pools or args.cpu_only:[0m
[30;1m213 | [0m[35m        create_cpu_nodepool(region, args)[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m    cmd = [[0m
[30;1m216 | [0m[35m        "kubectl",[0m
[30;1m217 | [0m[35m        "apply",[0m
[30;1m218 | [0m[35m        "-f",[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m200 | [0m[35m    ][0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m    if args.multiple_node_pools:[0m
[30;1m203 | [0m[35m        cmd += [[0m
[30;1m204 | [0m[35m            "--node-labels=accelerator_type=cpu",[0m
[30;1m205 | [0m[35m            "--node-taints=gpuAvailable=False:NoSchedule",[0m
[30;1m206 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35mdef create_cpu_nodepool(region: str, args: argparse.Namespace) -> None:[0m
[30;1m184 | [0m[35m    cmd = [[0m
[30;1m185 | [0m[35m        "gcloud",[0m
[30;1m186 | [0m[35m        "container",[0m
[30;1m187 | [0m[35m        "node-pools",[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m176 | [0m[35m        "--node-labels=accelerator_type=gpu",[0m
[30;1m177 | [0m[35m    ][0m
[30;1m178 | [0m[35m    if args.multiple_node_pools:[0m
[30;1m179 | [0m[35m        cmd += ["--node-taints=gpuAvailable=True:NoSchedule"][0m
[30;1m180 | [0m[35m    subprocess.check_call(cmd, stdout=subprocess.DEVNULL)[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m170 | [0m[35m            "--min-nodes=0",[0m
[30;1m171 | [0m[35m            "--max-nodes={}".format(args.max_gpu_nodes),[0m
[30;1m172 | [0m[35m        ][0m
[30;1m173 | [0m[35m    cmd += [[0m
[30;1m174 | [0m[35m        "--machine-type={}".format(args.agent_machine_type),[0m
[30;1m175 | [0m[35m        "--scopes=storage-full,cloud-platform",[0m
[30;1m176 | [0m[35m        "--node-labels=accelerator_type=gpu",[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m    if args.gpu_coscheduler or args.preemption:[0m
[30;1m165 | [0m[35m        cmd += ["--num-nodes={}".format(args.max_gpu_nodes)][0m
[30;1m166 | [0m[35m    else:[0m
[30;1m167 | [0m[35m        cmd += [[0m
[30;1m168 | [0m[35m            "--num-nodes=0",[0m
[30;1m169 | [0m[35m            "--enable-autoscaling",[0m
[30;1m170 | [0m[35m            "--min-nodes=0",[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m162 | [0m[35m        region,[0m
[30;1m163 | [0m[35m    ][0m
[30;1m164 | [0m[35m    if args.gpu_coscheduler or args.preemption:[0m
[30;1m165 | [0m[35m        cmd += ["--num-nodes={}".format(args.max_gpu_nodes)][0m
[30;1m166 | [0m[35m    else:[0m
[30;1m167 | [0m[35m        cmd += [[0m
[30;1m168 | [0m[35m            "--num-nodes=0",[0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35mdef create_gpu_nodepool(region: str, args: argparse.Namespace) -> None:[0m
[30;1m151 | [0m[35m    cmd = [[0m
[30;1m152 | [0m[35m        "gcloud",[0m
[30;1m153 | [0m[35m        "container",[0m
[30;1m154 | [0m[35m        "node-pools",[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m143 | [0m[35m    create_nodepools(region, args)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    if not args.no_managed_bucket:[0m
[30;1m146 | [0m[35m        cmd = ["gsutil", "mb", "gs://{}".format(args.gcs_bucket_name)][0m
[30;1m147 | [0m[35m        subprocess.check_call(cmd, stdout=subprocess.DEVNULL)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35mdef create_cluster(args: argparse.Namespace) -> None:[0m
[30;1m127 | [0m[35m    region = args.zone.rsplit("-", 1)[0][0m
[30;1m128 | [0m[35m    cmd = [[0m
[30;1m129 | [0m[35m        "gcloud",[0m
[30;1m130 | [0m[35m        "container",[0m
[30;1m131 | [0m[35m        "clusters",[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m42 | [0m[35m            cmd += ["zones"][0m
[30;1m43 | [0m[35m        else:[0m
[30;1m44 | [0m[35m            cmd += ["regions"][0m
[30;1m45 | [0m[35m        cmd += ["describe", location][0m
[30;1m46 | [0m[35m        subprocess.check_call(cmd, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)[0m
[30;1m47 | [0m[35m    except subprocess.CalledProcessError:[0m
[30;1m48 | [0m[35m        raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m        if isZone:[0m
[30;1m42 | [0m[35m            cmd += ["zones"][0m
[30;1m43 | [0m[35m        else:[0m
[30;1m44 | [0m[35m            cmd += ["regions"][0m
[30;1m45 | [0m[35m        cmd += ["describe", location][0m
[30;1m46 | [0m[35m        subprocess.check_call(cmd, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)[0m
[30;1m47 | [0m[35m    except subprocess.CalledProcessError:[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m    try:[0m
[30;1m40 | [0m[35m        cmd = ["gcloud", "compute"][0m
[30;1m41 | [0m[35m        if isZone:[0m
[30;1m42 | [0m[35m            cmd += ["zones"][0m
[30;1m43 | [0m[35m        else:[0m
[30;1m44 | [0m[35m            cmd += ["regions"][0m
[30;1m45 | [0m[35m        cmd += ["describe", location][0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mdef validate_location(location: str, isZone: bool = True) -> None:[0m
[30;1m39 | [0m[35m    try:[0m
[30;1m40 | [0m[35m        cmd = ["gcloud", "compute"][0m
[30;1m41 | [0m[35m        if isZone:[0m
[30;1m42 | [0m[35m            cmd += ["zones"][0m
[30;1m43 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m484 | [0m[35m                            help="Enables the priority-based scheduler with preemption on the GPU"[0m
[30;1m485 | [0m[35m                            " Agent Nodepool. If this argument is set, cluster autoscaling is"[0m
[30;1m486 | [0m[35m                            " disabled, and --max-gpu-nodes nodes are statically allocated for the "[0m
[30;1m487 | [0m[35m                            " GPU Agent Node pool at creation time.",[0m
[30;1m488 | [0m[35m                            action="store_true",[0m
[30;1m489 | [0m[35m                        ),[0m
[30;1m490 | [0m[35m                    ],[0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m                        cli.Arg([0m
[30;1m463 | [0m[35m                            "--multiple-node-pools",[0m
[30;1m464 | [0m[35m                            required=False,[0m
[30;1m465 | [0m[35m                            help="flag that indicates multiple node pools should be used - one"[0m
[30;1m466 | [0m[35m                            " for CPU only tasks and one for GPU tasks",[0m
[30;1m467 | [0m[35m                            action="store_true",[0m
[30;1m468 | [0m[35m                        ),[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m457 | [0m[35m                            "--cpu-node-pool-name",[0m
[30;1m458 | [0m[35m                            type=str,[0m
[30;1m459 | [0m[35m                            default=None,[0m
[30;1m460 | [0m[35m                            help="a unique name for the GPU node pool",[0m
[30;1m461 | [0m[35m                        ),[0m
[30;1m462 | [0m[35m                        cli.Arg([0m
[30;1m463 | [0m[35m                            "--multiple-node-pools",[0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m451 | [0m[35m                            "--max-cpu-nodes",[0m
[30;1m452 | [0m[35m                            type=int,[0m
[30;1m453 | [0m[35m                            default=constants.defaults.MAX_CPU_NODES,[0m
[30;1m454 | [0m[35m                            help="maximum number of nodes for the CPU node group",[0m
[30;1m455 | [0m[35m                        ),[0m
[30;1m456 | [0m[35m                        cli.Arg([0m
[30;1m457 | [0m[35m                            "--cpu-node-pool-name",[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m445 | [0m[35m                            "--max-nodes",[0m
[30;1m446 | [0m[35m                            type=int,[0m
[30;1m447 | [0m[35m                            default=constants.defaults.MAX_GPU_NODES,[0m
[30;1m448 | [0m[35m                            help="maximum number of nodes for the GPU node group",[0m
[30;1m449 | [0m[35m                        ),[0m
[30;1m450 | [0m[35m                        cli.Arg([0m
[30;1m451 | [0m[35m                            "--max-cpu-nodes",[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m438 | [0m[35m                            "--machine-type",[0m
[30;1m439 | [0m[35m                            type=str,[0m
[30;1m440 | [0m[35m                            default=constants.defaults.AGENT_MACHINE_TYPE,[0m
[30;1m441 | [0m[35m                            help="machine type to use for agent node group",[0m
[30;1m442 | [0m[35m                        ),[0m
[30;1m443 | [0m[35m                        cli.Arg([0m
[30;1m444 | [0m[35m                            "--max-gpu-nodes",[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m431 | [0m[35m                            "--master-machine-type",[0m
[30;1m432 | [0m[35m                            type=str,[0m
[30;1m433 | [0m[35m                            default=constants.defaults.MASTER_MACHINE_TYPE,[0m
[30;1m434 | [0m[35m                            help="machine type to use for master node group",[0m
[30;1m435 | [0m[35m                        ),[0m
[30;1m436 | [0m[35m                        cli.Arg([0m
[30;1m437 | [0m[35m                            "--agent-machine-type",[0m

[31m--[ [0m[34mMatch #[0m[33m882[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m373 | [0m[35m                            "--gpu-node-pool-name",[0m
[30;1m374 | [0m[35m                            type=str,[0m
[30;1m375 | [0m[35m                            default=None,[0m
[30;1m376 | [0m[35m                            help="a unique name for the GPU node pool",[0m
[30;1m377 | [0m[35m                        ),[0m
[30;1m378 | [0m[35m                        cli.Arg([0m
[30;1m379 | [0m[35m                            "--gcs-bucket-name",[0m

[31m--[ [0m[34mMatch #[0m[33m883[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gke/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m296 | [0m[35m        termcolor.cprint([0m
[30;1m297 | [0m[35m            ([0m
[30;1m298 | [0m[35m                "Autoscaling is not supported with the lightweight coscheduling plugin or with the"[0m
[30;1m299 | [0m[35m                " preemptive priority-based scheduler, and so a GPU node pool with {} nodes will"[0m
[30;1m300 | [0m[35m                " be statically allocated. This can be changed by using the default Kubernetes"[0m
[30;1m301 | [0m[35m                "  scheduler, or specifying a different value for --max-gpu-nodes."[0m
[30;1m302 | [0m[35m            ).format(args.max_gpu_nodes),[0m

[31m--[ [0m[34mMatch #[0m[33m884[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/preflight.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    instance_class = match.group(1).capitalize()[0m
[30;1m43 | [0m[35m    quota_map = SPOT_QUOTA_CODES if spot else ON_DEMAND_QUOTA_CODES[0m
[30;1m44 | [0m[35m    quota_code = quota_map.get(instance_class, quota_map[None])[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    return quota_code[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m885[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/preflight.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m132 | [0m[35m            )[0m
[30;1m133 | [0m[35m        )[0m
[30;1m134 | [0m[35m        print([0m
[30;1m135 | [0m[35m            "You can request a quota increase at "[0m
[30;1m136 | [0m[35m            "https://%s.console.aws.amazon.com/servicequotas/home/services/ec2/quotas"[0m
[30;1m137 | [0m[35m            % boto_session.region_name[0m
[30;1m138 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m886[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/preflight.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m        quota_data = client.get_service_quota(ServiceCode="ec2", QuotaCode=quota_code)[0m
[30;1m53 | [0m[35m        return int(quota_data["Quota"]["Value"])[0m
[30;1m54 | [0m[35m    except exceptions.ClientError as ex:[0m
[30;1m55 | [0m[35m        raise errors.PreflightFailure("failed to fetch service quota: %s" % ex)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m# CloudFront templates use a set of built-in functions such as[0m

[31m--[ [0m[34mMatch #[0m[33m887[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cli.py[0m
   Pattern: [32m.hostname[0m
[30;1m345 | [0m[35m            handle_agent_up,[0m
[30;1m346 | [0m[35m            "Start a Determined agent",[0m
[30;1m347 | [0m[35m            [[0m
[30;1m348 | [0m[35m                cli.Arg("master_host", type=str, help="master hostname"),[0m
[30;1m349 | [0m[35m                cli.Arg([0m
[30;1m350 | [0m[35m                    "--master-port",[0m
[30;1m351 | [0m[35m                    type=int,[0m

[31m--[ [0m[34mMatch #[0m[33m888[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/master_config_inject.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m# This small tool allows to have one single source of truth for the master[0m
[30;1m9 | [0m[35m# config template.[0m
[30;1m10 | [0m[35m# If you need to change the template, edit `injector/master.yaml.tmpl`,[0m
[30;1m11 | [0m[35m# then run this tool to update all the CF files.[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mimport itertools[0m
[30;1m14 | [0m[35mimport pathlib[0m

[31m--[ [0m[34mMatch #[0m[33m889[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m            local_size=int(os.environ["LOCAL_WORLD_SIZE"]),[0m
[30;1m234 | [0m[35m            cross_rank=int(os.environ["GROUP_RANK"]),[0m
[30;1m235 | [0m[35m            cross_size=int(os.environ["GROUP_WORLD_SIZE"]),[0m
[30;1m236 | [0m[35m            chief_ip=chief_ip or os.environ.get("DET_CHIEF_IP"),[0m
[30;1m237 | [0m[35m        )[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m890[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m            local_size=int(os.environ["LOCAL_SIZE"]),[0m
[30;1m214 | [0m[35m            cross_rank=int(os.environ["CROSS_RANK"]),[0m
[30;1m215 | [0m[35m            cross_size=int(os.environ["CROSS_SIZE"]),[0m
[30;1m216 | [0m[35m            chief_ip=chief_ip or os.environ.get("DET_CHIEF_IP"),[0m
[30;1m217 | [0m[35m        )[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m891[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m            local_size=hvd.local_size(),[0m
[30;1m194 | [0m[35m            cross_rank=hvd.cross_rank(),[0m
[30;1m195 | [0m[35m            cross_size=hvd.cross_size(),[0m
[30;1m196 | [0m[35m            chief_ip=chief_ip or os.environ.get("DET_CHIEF_IP"),[0m
[30;1m197 | [0m[35m        )[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m892[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        Presently, the only supported configurations are:[0m
[30;1m250 | [0m[35m           -  MultiMirroredWorkerStrategy, when there are multiple nodes participating in training.[0m
[30;1m251 | [0m[35m           -  Mirrored strategy, when there is one node but multiple GPUs for training.[0m
[30;1m252 | [0m[35m           -  The default strategy otherwise.[0m
[30;1m253 | [0m[35m        """[0m
[30;1m254 | [0m[35m        import tensorflow as tf[0m

[31m--[ [0m[34mMatch #[0m[33m893[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m        Create a DistributedContext using the standard torch distributed environment variables to[0m
[30;1m223 | [0m[35m        determine rank information.[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m        The IP address for the chief worker is required whenever CROSS_SIZE > 1.  The value may[0m
[30;1m226 | [0m[35m        be provided via the chief_ip argument or the DET_CHIEF_IP environment variable.[0m
[30;1m227 | [0m[35m        """[0m
[30;1m228 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m894[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m        Create a ``DistributedContext`` using the standard deepspeed environment variables to[0m
[30;1m203 | [0m[35m        determine rank information.[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m        The IP address for the chief worker is required whenever CROSS_SIZE > 1.  The value may[0m
[30;1m206 | [0m[35m        be provided using the chief_ip argument or the DET_CHIEF_IP environment variable.[0m
[30;1m207 | [0m[35m        """[0m
[30;1m208 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m895[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m           hvd.init()[0m
[30;1m182 | [0m[35m           distributed = DistributedContext.from_horovod(hvd)[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        The IP address for the chief worker is required whenever ``hvd.cross_size() > 1``. The value[0m
[30;1m185 | [0m[35m        may be provided using the ``chief_ip`` argument or the ``DET_CHIEF_IP`` environment[0m
[30;1m186 | [0m[35m        variable.[0m
[30;1m187 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m896[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m                x for x in all_local_chiefs if x is not None and x[0] == self.cross_rank[0m
[30;1m156 | [0m[35m            ][0m
[30;1m157 | [0m[35m            assert len(my_local_chief) == 1, ([0m
[30;1m158 | [0m[35m                f"did not find exactly 1 local_chief for machine {self.cross_rank} "[0m
[30;1m159 | [0m[35m                f"in {all_local_chiefs}"[0m
[30;1m160 | [0m[35m            )[0m
[30;1m161 | [0m[35m            _, pub_url, pull_url = my_local_chief[0][0m

[31m--[ [0m[34mMatch #[0m[33m897[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m     - cross_size: the number of machines in the entire job[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    Additionally, any time that cross_size > 1, you must also provide:[0m
[30;1m29 | [0m[35m     - chief_ip: the ip address to reach the chief worker (where rank==0)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    .. note::[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m898[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m     - cross_rank: the index of this machine in the entire job[0m
[30;1m26 | [0m[35m     - cross_size: the number of machines in the entire job[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    Additionally, any time that cross_size > 1, you must also provide:[0m
[30;1m29 | [0m[35m     - chief_ip: the ip address to reach the chief worker (where rank==0)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    .. note::[0m

[31m--[ [0m[34mMatch #[0m[33m899[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m            "state": s["State"],[0m
[30;1m509 | [0m[35m            "statusCode": s["Status"]["Code"],[0m
[30;1m510 | [0m[35m            "statusMessage": s["Status"]["Message"],[0m
[30;1m511 | [0m[35m            "instanceId": s.get("InstanceId", None),[0m
[30;1m512 | [0m[35m        }[0m
[30;1m513 | [0m[35m        reqs.append(req)[0m
[30;1m514 | [0m[35m    return reqs[0m

[31m--[ [0m[34mMatch #[0m[33m900[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m        print("Agents Terminated")[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    # Third, empty the bucket that was created for this stack.[0m
[30;1m123 | [0m[35m    bucket_name = get_output(stack_name, boto3_session).get([0m
[30;1m124 | [0m[35m        constants.cloudformation.CHECKPOINT_BUCKET[0m
[30;1m125 | [0m[35m    )[0m
[30;1m126 | [0m[35m    if bucket_name:[0m

[31m--[ [0m[34mMatch #[0m[33m901[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        ec2.stop_instances(InstanceIds=[master_id])[0m
[30;1m56 | [0m[35m    except exceptions.ClientError as ex:[0m
[30;1m57 | [0m[35m        if delete:[0m
[30;1m58 | [0m[35m            error_code = ex.response.get("Error", {}).get("Code")[0m
[30;1m59 | [0m[35m            if error_code in DELETE_MASTER_IGNORE_ERRORS:[0m
[30;1m60 | [0m[35m                print([0m
[30;1m61 | [0m[35m                    f"Failed to stop Master Instance: {error_code}. "[0m

[31m--[ [0m[34mMatch #[0m[33m902[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/aws.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        ec2.stop_instances(InstanceIds=[master_id])[0m
[30;1m56 | [0m[35m    except exceptions.ClientError as ex:[0m
[30;1m57 | [0m[35m        if delete:[0m
[30;1m58 | [0m[35m            error_code = ex.response.get("Error", {}).get("Code")[0m
[30;1m59 | [0m[35m            if error_code in DELETE_MASTER_IGNORE_ERRORS:[0m
[30;1m60 | [0m[35m                print([0m
[30;1m61 | [0m[35m                    f"Failed to stop Master Instance: {error_code}. "[0m

[31m--[ [0m[34mMatch #[0m[33m903[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/aws.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m523 | [0m[35m    request). Any requests that do not have an associated instance, cancel[0m
[30;1m524 | [0m[35m    the spot requests.[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m    Returns the list of instance_ids that were deleted so at the end of spot[0m
[30;1m527 | [0m[35m    cleanup, we can wait until all instances have been terminated.[0m
[30;1m528 | [0m[35m    """[0m
[30;1m529 | [0m[35m    spot_reqs = list_spot_requests_for_stack(stack_name, boto3_session)[0m

[31m--[ [0m[34mMatch #[0m[33m904[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m442 | [0m[35mdef check_keypair(name: str, boto3_session: boto3.session.Session) -> bool:[0m
[30;1m443 | [0m[35m    ec2 = boto3_session.client("ec2")[0m
[30;1m444 | [0m[35m[0m
[30;1m445 | [0m[35m    print(f"Checking if the SSH Keypair ({name}) exists:", end=" ")[0m
[30;1m446 | [0m[35m    all_keys = ec2.describe_key_pairs()["KeyPairs"][0m
[30;1m447 | [0m[35m    names = [x["KeyName"] for x in all_keys][0m
[30;1m448 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m905[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/aws.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport sys[0m
[30;1m2 | [0m[35mimport threading[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom typing import Any, Callable, Dict, List, Optional, Tuple[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport boto3[0m
[30;1m7 | [0m[35mimport tqdm[0m

[31m--[ [0m[34mMatch #[0m[33m906[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_checkpoint.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m242 | [0m[35m            if ckpt_dir is None:[0m
[30;1m243 | [0m[35m                raise RuntimeError([0m
[30;1m244 | [0m[35m                    "cannot call .upload(ckpt_dir=None, shard=False), which would result in doing "[0m
[30;1m245 | [0m[35m                    "nothing at all"[0m
[30;1m246 | [0m[35m                )[0m
[30;1m247 | [0m[35m            return self._upload_single(ckpt_dir, metadata, selector=selector)[0m
[30;1m248 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m907[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_checkpoint.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m44 | [0m[35m    prev_key: str,[0m
[30;1m45 | [0m[35m) -> Tuple[Dict[str, Any], Dict[str, Any]]:[0m
[30;1m46 | [0m[35m    for key, metadata in rank_metadata.items():[0m
[30;1m47 | [0m[35m        # First, update key_ranks. We will use it later[0m
[30;1m48 | [0m[35m        if key not in key_ranks:[0m
[30;1m49 | [0m[35m            key_ranks[key] = {"_ranks_": []}[0m
[30;1m50 | [0m[35m        key_ranks[key]["_ranks_"].append(rank)[0m

[31m--[ [0m[34mMatch #[0m[33m908[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_checkpoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35m        In multi-worker scenarios, with the default ``download_mode``[0m
[30;1m611 | [0m[35m        (``LocalWorkersShareDownload``), all workers must call ``restore_path()`` but only the local[0m
[30;1m612 | [0m[35m        chief worker on each node (``distributed.local_rank==0``) actually downloads data.[0m
[30;1m613 | [0m[35m[0m
[30;1m614 | [0m[35m        Example:[0m
[30;1m615 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m909[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_checkpoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m553 | [0m[35m            return[0m
[30;1m554 | [0m[35m[0m
[30;1m555 | [0m[35m        # Deconflict locally-shared directories; if every worker uploads /tmp/ckpt, then only[0m
[30;1m556 | [0m[35m        # the lowest rank on each node will actually upload this directory.[0m
[30;1m557 | [0m[35m        st = os.stat(ckpt_dir)[0m
[30;1m558 | [0m[35m        file_uid = (st.st_dev, st.st_ino)[0m
[30;1m559 | [0m[35m        all_file_uids = self._dist.allgather(file_uid)[0m

[31m--[ [0m[34mMatch #[0m[33m910[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_checkpoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m        # Deconflict locally-shared directories; if multiple ranks (with no selectors) upload[0m
[30;1m305 | [0m[35m        # /tmp/ckpt then only the lowest rank on each node will actually upload this directory.[0m
[30;1m306 | [0m[35m        # If multiple ranks (with selectors) want to upload selected files from /tmp/ckpt, then[0m
[30;1m307 | [0m[35m        # each rank will upload its selected files.[0m
[30;1m308 | [0m[35m        if ckpt_dir is None:[0m

[31m--[ [0m[34mMatch #[0m[33m911[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_checkpoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    ``DownloadMode`` defines the calling behavior of the .download() and the .restore_path() methods[0m
[30;1m22 | [0m[35m    of ``CheckpointContext``.[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    When mode is ``LocalWorkersShareDownload`` (the default), workers on the same physical node (the[0m
[30;1m25 | [0m[35m    same ``distributed.cross_rank``) will share a single downloaded version of the checkpoint.  On[0m
[30;1m26 | [0m[35m    an 8-GPU node, this will frequently result in 8x bandwidth savings.  In this mode, all workers[0m
[30;1m27 | [0m[35m    must call ``.download()`` or ``.restore_path()`` in step.[0m

[31m--[ [0m[34mMatch #[0m[33m912[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/preflight.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m        print(termcolor.colored("Failed to connect to Docker daemon: %s" % ex, "red"))[0m
[30;1m33 | [0m[35m        print([0m
[30;1m34 | [0m[35m            termcolor.colored([0m
[30;1m35 | [0m[35m                "Please ensure that the Docker daemon is running "[0m
[30;1m36 | [0m[35m                "and that the current user has access permissions.",[0m
[30;1m37 | [0m[35m                "red",[0m
[30;1m38 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m913[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/preflight.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    try:[0m
[30;1m30 | [0m[35m        docker.from_env()[0m
[30;1m31 | [0m[35m    except docker.errors.DockerException as ex:[0m
[30;1m32 | [0m[35m        print(termcolor.colored("Failed to connect to Docker daemon: %s" % ex, "red"))[0m
[30;1m33 | [0m[35m        print([0m
[30;1m34 | [0m[35m            termcolor.colored([0m
[30;1m35 | [0m[35m                "Please ensure that the Docker daemon is running "[0m

[31m--[ [0m[34mMatch #[0m[33m914[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/preflight.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m        _print_see_more()[0m
[30;1m26 | [0m[35m        sys.exit(1)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    # Can we talk to the Docker daemon?[0m
[30;1m29 | [0m[35m    try:[0m
[30;1m30 | [0m[35m        docker.from_env()[0m
[30;1m31 | [0m[35m    except docker.errors.DockerException as ex:[0m

[31m--[ [0m[34mMatch #[0m[33m915[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/preflight.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport shutil[0m
[30;1m2 | [0m[35mimport sys[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport docker[0m
[30;1m5 | [0m[35mimport termcolor[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mdef _print_see_more() -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m916[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/workspace.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom typing import Any, Dict, List, Optional, Sequence, cast[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom determined import cli[0m
[30;1m7 | [0m[35mfrom determined.cli import render, user[0m

[31m--[ [0m[34mMatch #[0m[33m917[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_searcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m        logger.debug(f"op.report_progress({length})")[0m
[30;1m121 | [0m[35m        # get the floating point progress[0m
[30;1m122 | [0m[35m        progress = min(1.0, max(0.0, length / self._length))[0m
[30;1m123 | [0m[35m        self._session.post([0m
[30;1m124 | [0m[35m            f"/api/v1/trials/{self._trial_id}/progress",[0m
[30;1m125 | [0m[35m            data=det.util.json_encode({"progress": progress, "is_raw": True}),[0m
[30;1m126 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m918[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_searcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    if "unit" in searcher:[0m
[30;1m46 | [0m[35m        return convert_key(searcher["unit"])[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    length_example = searcher.get("max_length")[0m
[30;1m49 | [0m[35m    if isinstance(length_example, dict) and len(length_example) == 1:[0m
[30;1m50 | [0m[35m        key = next(iter(length_example.keys()))[0m
[30;1m51 | [0m[35m        return convert_key(key)[0m

[31m--[ [0m[34mMatch #[0m[33m919[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_searcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m    searcher = experiment_config.get("searcher", {})[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    def convert_key(key: Any) -> Optional[Unit]:[0m
[30;1m43 | [0m[35m        return {"records": Unit.RECORDS, "epochs": Unit.EPOCHS, "batches": Unit.BATCHES}.get(key)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    if "unit" in searcher:[0m
[30;1m46 | [0m[35m        return convert_key(searcher["unit"])[0m

[31m--[ [0m[34mMatch #[0m[33m920[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_searcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mdef _parse_searcher_units(experiment_config: dict) -> Optional[Unit]:[0m
[30;1m40 | [0m[35m    searcher = experiment_config.get("searcher", {})[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    def convert_key(key: Any) -> Optional[Unit]:[0m
[30;1m43 | [0m[35m        return {"records": Unit.RECORDS, "epochs": Unit.EPOCHS, "batches": Unit.BATCHES}.get(key)[0m

[31m--[ [0m[34mMatch #[0m[33m921[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_searcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35mdef _parse_searcher_max_length(experiment_config: dict) -> Optional[int]:[0m
[30;1m20 | [0m[35m    searcher = experiment_config.get("searcher", {})[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    max_length = searcher.get("max_length")[0m
[30;1m23 | [0m[35m    if max_length is None:[0m
[30;1m24 | [0m[35m        return None[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m922[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_searcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mdef _parse_searcher_max_length(experiment_config: dict) -> Optional[int]:[0m
[30;1m20 | [0m[35m    searcher = experiment_config.get("searcher", {})[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    max_length = searcher.get("max_length")[0m
[30;1m23 | [0m[35m    if max_length is None:[0m

[31m--[ [0m[34mMatch #[0m[33m923[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_searcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m        SearcherOperation is deprecated in 0.38.0, and will be removed in a future version.[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    A ``SearcherOperation`` is a request from the hyperparameter-search logic for the training[0m
[30;1m62 | [0m[35m    script to execute one train-validate-report cycle.[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    Some searchers, such as single, random, or grid, pass only a single ``SearcherOperation`` to[0m
[30;1m65 | [0m[35m    each trial, while others may pass many ``SearcherOperations``.[0m

[31m--[ [0m[34mMatch #[0m[33m924[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m    distributed = distributed or core.DummyDistributedContext()[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    # At present, we only support tensorboards in Trial tasks.[0m
[30;1m288 | [0m[35m    tbd_writer = None[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m    train = None[0m

[31m--[ [0m[34mMatch #[0m[33m925[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m    )[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m# The '*' is because we expect to add parameters to this method.  To keep a backwards-compatible[0m
[30;1m228 | [0m[35m# API, we either need to always append to the parameters (preserving order of positional parameters)[0m
[30;1m229 | [0m[35m# or force users to always use kwargs.  We haven't decided what the right positional arguments are[0m
[30;1m230 | [0m[35m# yet, so the '*' lets us delay that decision until we are ready.[0m

[31m--[ [0m[34mMatch #[0m[33m926[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m                        raise ValueError("only one level of nested is supported")[0m
[30;1m160 | [0m[35m                    aggregated_metrics[k][k1] = aggregated_metrics[k].get(k1, 0) + v1[0m
[30;1m161 | [0m[35m            else:[0m
[30;1m162 | [0m[35m                aggregated_metrics[k] = aggregated_metrics.get(k, 0) + v[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    for k, v in aggregated_metrics.items():[0m
[30;1m165 | [0m[35m        if isinstance(v, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m927[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m                for k1, v1 in v.items():[0m
[30;1m158 | [0m[35m                    if isinstance(v1, dict):[0m
[30;1m159 | [0m[35m                        raise ValueError("only one level of nested is supported")[0m
[30;1m160 | [0m[35m                    aggregated_metrics[k][k1] = aggregated_metrics[k].get(k1, 0) + v1[0m
[30;1m161 | [0m[35m            else:[0m
[30;1m162 | [0m[35m                aggregated_metrics[k] = aggregated_metrics.get(k, 0) + v[0m
[30;1m163 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m928[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m    for sample in metric_samples:[0m
[30;1m154 | [0m[35m        for k, v in sample.items():[0m
[30;1m155 | [0m[35m            if isinstance(v, dict):[0m
[30;1m156 | [0m[35m                aggregated_metrics[k] = aggregated_metrics.get(k, {})[0m
[30;1m157 | [0m[35m                for k1, v1 in v.items():[0m
[30;1m158 | [0m[35m                    if isinstance(v1, dict):[0m
[30;1m159 | [0m[35m                        raise ValueError("only one level of nested is supported")[0m

[31m--[ [0m[34mMatch #[0m[33m929[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m                f"{samples_per_report}."[0m
[30;1m84 | [0m[35m            )[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        # Currently, metrics collected are scoped at the machine level, so we only collect metrics[0m
[30;1m87 | [0m[35m        # on the chief worker of each node.[0m
[30;1m88 | [0m[35m        if self._distributed.local_rank != 0:[0m
[30;1m89 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m930[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35m    def on(self, sampling_interval: int = 1, samples_per_report: int = 10) -> None:[0m
[30;1m55 | [0m[35m        """Turns system profiling functionality on.[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        This method creates two threads, one that collects system metrics at specified time[0m
[30;1m58 | [0m[35m        intervals, and another that ships them to the master.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        These metrics are persisted in the database and can be viewed in the Determined web UI[0m

[31m--[ [0m[34mMatch #[0m[33m931[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m21 | [0m[35mclass ProfilerContext:[0m
[30;1m22 | [0m[35m    """Gives access to the system profiling feature within Determined.[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    It is responsible for collecting system metrics at specified time intervals and reporting[0m
[30;1m25 | [0m[35m    them to the master. When it is turned on, it spawns two threads that run in the background[0m
[30;1m26 | [0m[35m    that collect and send profiling metrics to a Determined master, which are cleaned up when[0m
[30;1m27 | [0m[35m    the ``core.Context`` exits or the profiler is turned off.[0m

[31m--[ [0m[34mMatch #[0m[33m932[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    Supports up to 1 level of nesting. Returns a single merged dictionary where the values are[0m
[30;1m149 | [0m[35m    averaged across all dictionaries in the given list by key.[0m
[30;1m150 | [0m[35m    # TODO (MD-338): find a cleaner way to do this.[0m
[30;1m151 | [0m[35m    """[0m
[30;1m152 | [0m[35m    aggregated_metrics: Dict[str, Any] = {}[0m
[30;1m153 | [0m[35m    for sample in metric_samples:[0m

[31m--[ [0m[34mMatch #[0m[33m933[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m            no-op.[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        Arguments:[0m
[30;1m69 | [0m[35m            sampling_interval: time (in seconds) between each metric collection.[0m
[30;1m70 | [0m[35m            samples_per_report: number of samples to collect before aggregating for report.[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m934[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m    def on(self, sampling_interval: int = 1, samples_per_report: int = 10) -> None:[0m
[30;1m55 | [0m[35m        """Turns system profiling functionality on.[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        This method creates two threads, one that collects system metrics at specified time[0m
[30;1m58 | [0m[35m        intervals, and another that ships them to the master.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        These metrics are persisted in the database and can be viewed in the Determined web UI[0m
[30;1m61 | [0m[35m        for the associated trial.[0m

[31m--[ [0m[34mMatch #[0m[33m935[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mclass ProfilerContext:[0m
[30;1m22 | [0m[35m    """Gives access to the system profiling feature within Determined.[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    It is responsible for collecting system metrics at specified time intervals and reporting[0m
[30;1m25 | [0m[35m    them to the master. When it is turned on, it spawns two threads that run in the background[0m
[30;1m26 | [0m[35m    that collect and send profiling metrics to a Determined master, which are cleaned up when[0m
[30;1m27 | [0m[35m    the ``core.Context`` exits or the profiler is turned off.[0m

[31m--[ [0m[34mMatch #[0m[33m936[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_profiler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport datetime[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom typing import Any, Dict, List, Optional[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport psutil[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m937[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/rbac.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m235 | [0m[35m        return[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    if resp.roles is None or len(resp.roles) != 1:[0m
[30;1m238 | [0m[35m        raise api.errors.BadRequestException(f"could not find role name {args.role_name}")[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m    role = resp.roles[0].role[0m
[30;1m241 | [0m[35m    if role is None:[0m

[31m--[ [0m[34mMatch #[0m[33m938[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        logger.debug("get_experiment_best_validation()")[0m
[30;1m294 | [0m[35m        try:[0m
[30;1m295 | [0m[35m            r = self._session.get([0m
[30;1m296 | [0m[35m                f"/api/v1/experiments/{self._exp_id}/searcher/best_searcher_validation_metric"[0m
[30;1m297 | [0m[35m            )[0m
[30;1m298 | [0m[35m        except errors.NotFoundException:[0m

[31m--[ [0m[34mMatch #[0m[33m939[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m        logger.debug(f"report_progress with progress={progress}")[0m
[30;1m277 | [0m[35m        if progress < 0 or progress > 1:[0m
[30;1m278 | [0m[35m            raise ValueError(f"Progress should be between 0 and 1, not {progress}")[0m
[30;1m279 | [0m[35m        self._session.post([0m
[30;1m280 | [0m[35m            f"/api/v1/trials/{self._trial_id}/progress",[0m
[30;1m281 | [0m[35m            data=det.util.json_encode({"progress": progress, "is_raw": True}),[0m
[30;1m282 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m940[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        body = {"reason": EarlyExitReason(reason).value}[0m
[30;1m255 | [0m[35m        logger.info(f"report_early_exit({reason})")[0m
[30;1m256 | [0m[35m        r = self._session.post([0m
[30;1m257 | [0m[35m            f"/api/v1/trials/{self._trial_id}/early_exit",[0m
[30;1m258 | [0m[35m            data=det.util.json_encode(body),[0m
[30;1m259 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m941[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        # because of the workload sequencer's very specific use of this function.[0m
[30;1m65 | [0m[35m        r = self._session.get(f"/api/v1/trials/{self._trial_id}")[0m
[30;1m66 | [0m[35m        val = r.json()["trial"].get("latestValidation") or {}[0m
[30;1m67 | [0m[35m        steps_completed = val.get("totalBatches")[0m
[30;1m68 | [0m[35m        logger.debug(f"_get_last_validation() -> {steps_completed}")[0m
[30;1m69 | [0m[35m        return steps_completed[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m942[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        # not on trial restart).  However, this bug does not happen to affect the workload sequencer[0m
[30;1m64 | [0m[35m        # because of the workload sequencer's very specific use of this function.[0m
[30;1m65 | [0m[35m        r = self._session.get(f"/api/v1/trials/{self._trial_id}")[0m
[30;1m66 | [0m[35m        val = r.json()["trial"].get("latestValidation") or {}[0m
[30;1m67 | [0m[35m        steps_completed = val.get("totalBatches")[0m
[30;1m68 | [0m[35m        logger.debug(f"_get_last_validation() -> {steps_completed}")[0m
[30;1m69 | [0m[35m        return steps_completed[0m

[31m--[ [0m[34mMatch #[0m[33m943[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        # you report metrics than after (since metrics get archived on first report of new metrics,[0m
[30;1m63 | [0m[35m        # not on trial restart).  However, this bug does not happen to affect the workload sequencer[0m
[30;1m64 | [0m[35m        # because of the workload sequencer's very specific use of this function.[0m
[30;1m65 | [0m[35m        r = self._session.get(f"/api/v1/trials/{self._trial_id}")[0m
[30;1m66 | [0m[35m        val = r.json()["trial"].get("latestValidation") or {}[0m
[30;1m67 | [0m[35m        steps_completed = val.get("totalBatches")[0m
[30;1m68 | [0m[35m        logger.debug(f"_get_last_validation() -> {steps_completed}")[0m

[31m--[ [0m[34mMatch #[0m[33m944[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        body = {"state": status}[0m
[30;1m55 | [0m[35m        logger.debug(f"set_status({status})")[0m
[30;1m56 | [0m[35m        self._session.post(f"/api/v1/trials/{self._trial_id}/runner/metadata", json=body)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    def _get_last_validation(self) -> Optional[int]:[0m
[30;1m59 | [0m[35m        # This is needed by the workload sequencer, but it is not generally stable, because it is[0m

[31m--[ [0m[34mMatch #[0m[33m945[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m            group (string): metrics group name. Can be used to partition metrics[0m
[30;1m178 | [0m[35m                into different logical groups or time series.[0m
[30;1m179 | [0m[35m                "training" and "validation" group names map to built-in training[0m
[30;1m180 | [0m[35m                and validation time series. Note: Group cannot contain ``.`` character.[0m
[30;1m181 | [0m[35m            steps_completed (int): global step number, e.g. the number of batches processed.[0m
[30;1m182 | [0m[35m            metrics (Dict[str, Any]): metrics data dictionary. Must be JSON-serializable.[0m
[30;1m183 | [0m[35m                When reporting metrics with the same ``group`` and ``steps_completed`` values,[0m

[31m--[ [0m[34mMatch #[0m[33m946[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_train.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m        Arguments:[0m
[30;1m177 | [0m[35m            group (string): metrics group name. Can be used to partition metrics[0m
[30;1m178 | [0m[35m                into different logical groups or time series.[0m
[30;1m179 | [0m[35m                "training" and "validation" group names map to built-in training[0m
[30;1m180 | [0m[35m                and validation time series. Note: Group cannot contain ``.`` character.[0m
[30;1m181 | [0m[35m            steps_completed (int): global step number, e.g. the number of batches processed.[0m

[31m--[ [0m[34mMatch #[0m[33m947[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35mdef kill_trial(args: argparse.Namespace) -> None:[0m
[30;1m204 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m205 | [0m[35m    sess.post(f"/api/v1/trials/{args.trial_id}/kill")[0m
[30;1m206 | [0m[35m    print("Killed trial", args.trial_id)[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m948[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m539 | [0m[35m                                    "--days",[0m
[30;1m540 | [0m[35m                                    type=none_or_int,[0m
[30;1m541 | [0m[35m                                    help="number of days to retain the logs for, from the "[0m
[30;1m542 | [0m[35m                                    "end time of the task, . allowed range: -1 to 32767.",[0m
[30;1m543 | [0m[35m                                ),[0m
[30;1m544 | [0m[35m                                cli.Arg([0m
[30;1m545 | [0m[35m                                    "--forever",[0m

[31m--[ [0m[34mMatch #[0m[33m949[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m480 | [0m[35m                        type=cli.string_to_bool,[0m
[30;1m481 | [0m[35m                        metavar="(true|false)",[0m
[30;1m482 | [0m[35m                        default=None,[0m
[30;1m483 | [0m[35m                        help="The sort order for metrics when using --best with --sort-by. For "[0m
[30;1m484 | [0m[35m                        "example, 'accuracy' would require passing '--smaller-is-better false'. If "[0m
[30;1m485 | [0m[35m                        "--sort-by is specified, this argument must be specified.",[0m
[30;1m486 | [0m[35m                    ),[0m

[31m--[ [0m[34mMatch #[0m[33m950[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m470 | [0m[35m                        "--sort-by",[0m
[30;1m471 | [0m[35m                        type=str,[0m
[30;1m472 | [0m[35m                        default=None,[0m
[30;1m473 | [0m[35m                        help="The name of the validation metric to sort on. This argument is only "[0m
[30;1m474 | [0m[35m                        "used with --best. If --best is passed without --sort-by, the "[0m
[30;1m475 | [0m[35m                        "experiment's searcher metric is assumed. If this argument is specified, "[0m
[30;1m476 | [0m[35m                        "--smaller-is-better must also be specified.",[0m

[31m--[ [0m[34mMatch #[0m[33m951[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m341 | [0m[35m        "-f",[0m
[30;1m342 | [0m[35m        "--follow",[0m
[30;1m343 | [0m[35m        action="store_true",[0m
[30;1m344 | [0m[35m        help="follow the logs of a running trial, similar to tail -f",[0m
[30;1m345 | [0m[35m    ),[0m
[30;1m346 | [0m[35m    cli.Group([0m
[30;1m347 | [0m[35m        cli.Arg([0m

[31m--[ [0m[34mMatch #[0m[33m952[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m    if not args.forever and not isinstance(args.days, int):[0m
[30;1m244 | [0m[35m        raise cli.CliError([0m
[30;1m245 | [0m[35m            "Please provide an argument to set log retention. --days sets the number of days to"[0m
[30;1m246 | [0m[35m            " retain logs from the end time of the task, eg. `det t set log-retention 1 --days 50`."[0m
[30;1m247 | [0m[35m            " --forever retains logs indefinitely, eg.`det t set log-retention 1 --forever`."[0m
[30;1m248 | [0m[35m        )[0m
[30;1m249 | [0m[35m    elif isinstance(args.days, int) and (args.days < -1 or args.days > 32767):[0m

[31m--[ [0m[34mMatch #[0m[33m953[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_mpu.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m@dataclasses.dataclass[0m
[30;1m9 | [0m[35mclass ModelParallelUnit:[0m
[30;1m10 | [0m[35m    """[0m
[30;1m11 | [0m[35m    This class contains the functions we expect in order to accurately carry out parallel training.[0m
[30;1m12 | [0m[35m    For custom model parallel training, you need to subclass and override the functions before[0m
[30;1m13 | [0m[35m    passing it to the :class:`~determined.pytorch.deepspeed.DeepSpeedTrialContext` by calling[0m
[30;1m14 | [0m[35m    ``context.wrap_mpu(mpu)``.[0m

[31m--[ [0m[34mMatch #[0m[33m954[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1018 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m
[30;1m1019 | [0m[35m            # checkpoints should only persist batches_trained and epochs_trained[0m
[30;1m1020 | [0m[35m            batches_trained=state.get("steps_completed"),[0m
[30;1m1021 | [0m[35m            epochs_trained=self._get_epoch_idx(state.get("steps_completed")),[0m
[30;1m1022 | [0m[35m        )[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m        assert self.state[0m

[31m--[ [0m[34mMatch #[0m[33m955[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1017 | [0m[35m            step_id=state.get("step_id"),[0m
[30;1m1018 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m
[30;1m1019 | [0m[35m            # checkpoints should only persist batches_trained and epochs_trained[0m
[30;1m1020 | [0m[35m            batches_trained=state.get("steps_completed"),[0m
[30;1m1021 | [0m[35m            epochs_trained=self._get_epoch_idx(state.get("steps_completed")),[0m
[30;1m1022 | [0m[35m        )[0m
[30;1m1023 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m956[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1014 | [0m[35m            trial_id=state.get("trial_id"),[0m
[30;1m1015 | [0m[35m            last_ckpt=state.get("last_ckpt"),[0m
[30;1m1016 | [0m[35m            last_val=state.get("last_val"),[0m
[30;1m1017 | [0m[35m            step_id=state.get("step_id"),[0m
[30;1m1018 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m
[30;1m1019 | [0m[35m            # checkpoints should only persist batches_trained and epochs_trained[0m
[30;1m1020 | [0m[35m            batches_trained=state.get("steps_completed"),[0m

[31m--[ [0m[34mMatch #[0m[33m957[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1013 | [0m[35m        self.state = pytorch._TrialState([0m
[30;1m1014 | [0m[35m            trial_id=state.get("trial_id"),[0m
[30;1m1015 | [0m[35m            last_ckpt=state.get("last_ckpt"),[0m
[30;1m1016 | [0m[35m            last_val=state.get("last_val"),[0m
[30;1m1017 | [0m[35m            step_id=state.get("step_id"),[0m
[30;1m1018 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m
[30;1m1019 | [0m[35m            # checkpoints should only persist batches_trained and epochs_trained[0m

[31m--[ [0m[34mMatch #[0m[33m958[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1012 | [0m[35m[0m
[30;1m1013 | [0m[35m        self.state = pytorch._TrialState([0m
[30;1m1014 | [0m[35m            trial_id=state.get("trial_id"),[0m
[30;1m1015 | [0m[35m            last_ckpt=state.get("last_ckpt"),[0m
[30;1m1016 | [0m[35m            last_val=state.get("last_val"),[0m
[30;1m1017 | [0m[35m            step_id=state.get("step_id"),[0m
[30;1m1018 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m

[31m--[ [0m[34mMatch #[0m[33m959[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1011 | [0m[35m            return[0m
[30;1m1012 | [0m[35m[0m
[30;1m1013 | [0m[35m        self.state = pytorch._TrialState([0m
[30;1m1014 | [0m[35m            trial_id=state.get("trial_id"),[0m
[30;1m1015 | [0m[35m            last_ckpt=state.get("last_ckpt"),[0m
[30;1m1016 | [0m[35m            last_val=state.get("last_val"),[0m
[30;1m1017 | [0m[35m            step_id=state.get("step_id"),[0m

[31m--[ [0m[34mMatch #[0m[33m960[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1006 | [0m[35m            self.state.last_val = self.state.batches_trained[0m
[30;1m1007 | [0m[35m[0m
[30;1m1008 | [0m[35m    def _load_wlsq_state(self, state: Any) -> None:[0m
[30;1m1009 | [0m[35m        if state.get("trial_id") != self.trial_id:[0m
[30;1m1010 | [0m[35m            self.state = pytorch._TrialState(trial_id=self.trial_id)[0m
[30;1m1011 | [0m[35m            return[0m
[30;1m1012 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m961[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m990 | [0m[35m        # Load our state from the checkpoint if we are continuing training after a pause or restart.[0m
[30;1m991 | [0m[35m        # If the trial_id doesn't match our current trial id, we're continuing training a previous[0m
[30;1m992 | [0m[35m        # trial and should start from a fresh state.[0m
[30;1m993 | [0m[35m        if state.get("trial_id") != self.trial_id:[0m
[30;1m994 | [0m[35m            self.state = pytorch._TrialState(trial_id=self.trial_id)[0m
[30;1m995 | [0m[35m            return[0m
[30;1m996 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m962[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m963 | [0m[35m        else:[0m
[30;1m964 | [0m[35m            logger.warning("The checkpoint has no random state to restore.")[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m        callback_state = checkpoint.get("callbacks", {})[0m
[30;1m967 | [0m[35m        for name in self.callbacks:[0m
[30;1m968 | [0m[35m            if name in callback_state:[0m
[30;1m969 | [0m[35m                self.callbacks[name].load_state_dict(callback_state[name])[0m

[31m--[ [0m[34mMatch #[0m[33m963[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m853 | [0m[35m            # We report "batch" and "epoch" only if these keys are not already reported in user[0m
[30;1m854 | [0m[35m            # metrics.[0m
[30;1m855 | [0m[35m            metrics["batches"] = metrics.get("batches", self.state.batches_trained)[0m
[30;1m856 | [0m[35m            metrics["epochs"] = metrics.get("epochs", self.state.epochs_trained)[0m
[30;1m857 | [0m[35m[0m
[30;1m858 | [0m[35m            self.core_context.train.report_validation_metrics([0m
[30;1m859 | [0m[35m                steps_completed=self.state.batches_trained, metrics=metrics[0m

[31m--[ [0m[34mMatch #[0m[33m964[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m            # We report "batch" and "epoch" only if these keys are not already reported in user[0m
[30;1m854 | [0m[35m            # metrics.[0m
[30;1m855 | [0m[35m            metrics["batches"] = metrics.get("batches", self.state.batches_trained)[0m
[30;1m856 | [0m[35m            metrics["epochs"] = metrics.get("epochs", self.state.epochs_trained)[0m
[30;1m857 | [0m[35m[0m
[30;1m858 | [0m[35m            self.core_context.train.report_validation_metrics([0m

[31m--[ [0m[34mMatch #[0m[33m965[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m        # Only report on the chief worker[0m
[30;1m602 | [0m[35m        avg_metrics = metrics.get("avg_metrics", {})[0m
[30;1m603 | [0m[35m        batch_metrics = metrics.get("batch_metrics", [])[0m
[30;1m604 | [0m[35m[0m
[30;1m605 | [0m[35m        assert self.state[0m
[30;1m606 | [0m[35m        if self.context.get_enable_tensorboard_logging():[0m

[31m--[ [0m[34mMatch #[0m[33m966[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m599 | [0m[35m            return {}[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m        # Only report on the chief worker[0m
[30;1m602 | [0m[35m        avg_metrics = metrics.get("avg_metrics", {})[0m
[30;1m603 | [0m[35m        batch_metrics = metrics.get("batch_metrics", [])[0m
[30;1m604 | [0m[35m[0m
[30;1m605 | [0m[35m        assert self.state[0m

[31m--[ [0m[34mMatch #[0m[33m967[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m    ) -> None:[0m
[30;1m125 | [0m[35m        # We use an environment variable to allow users to enable custom initialization routine for[0m
[30;1m126 | [0m[35m        # distributed training since the pre_execute_hook runs before trial initialization.[0m
[30;1m127 | [0m[35m        manual_dist_init = os.environ.get("DET_MANUAL_INIT_DISTRIBUTED")[0m
[30;1m128 | [0m[35m        if not manual_dist_init:[0m
[30;1m129 | [0m[35m            # DeepSpeed's init_distributed handles situations in which only 1 gpu is used and[0m
[30;1m130 | [0m[35m            # also handles multiple calls to init in one process.[0m

[31m--[ [0m[34mMatch #[0m[33m968[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m929 | [0m[35m[0m
[30;1m930 | [0m[35m        if not isinstance(checkpoint, dict):[0m
[30;1m931 | [0m[35m            raise det.errors.InvalidExperimentException([0m
[30;1m932 | [0m[35m                f"Expected checkpoint at {maybe_ckpt} to be a dict "[0m
[30;1m933 | [0m[35m                f"but got {type(checkpoint).__name__}."[0m
[30;1m934 | [0m[35m            )[0m
[30;1m935 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m969[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m        # We define on_shutdown here instead of inside the `for callback in...` loop to ensure we[0m
[30;1m296 | [0m[35m        # don't bind the loop iteration variable `callback`, which would likely cause us to call[0m
[30;1m297 | [0m[35m        # on_trial_shutdown() multiple times for the final callback, and not at all for the others.[0m
[30;1m298 | [0m[35m        def on_shutdown(callback_name: str, on_trial_shutdown: Callable) -> None:[0m
[30;1m299 | [0m[35m            on_trial_shutdown()[0m
[30;1m300 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m970[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        # The data loader is only required on ranks that take the data as input or require[0m
[30;1m166 | [0m[35m        # the data to compute the loss.  There could be intermediate model parallel ranks[0m
[30;1m167 | [0m[35m        # that do not need a data loader at all.[0m
[30;1m168 | [0m[35m        if self.context._mpu.should_build_data_loader:[0m
[30;1m169 | [0m[35m            train_data = self.trial.build_training_data_loader()[0m
[30;1m170 | [0m[35m            if isinstance(train_data, pytorch.DataLoader):[0m

[31m--[ [0m[34mMatch #[0m[33m971[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m            deepspeed.init_distributed(auto_mpi_discovery=False)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        # Set identical random seeds on all training processes.[0m
[30;1m134 | [0m[35m        # When data parallel world size > 1, each data parallel rank will start at a unique[0m
[30;1m135 | [0m[35m        # offset in the dataset, ensuring it's processing a unique[0m
[30;1m136 | [0m[35m        # training batch.[0m
[30;1m137 | [0m[35m        # TODO (Liam): seed data loading workers so that we can configure different seeds for[0m

[31m--[ [0m[34mMatch #[0m[33m972[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        if len(self.context.models) == 0:[0m
[30;1m89 | [0m[35m            raise det.errors.InvalidExperimentException([0m
[30;1m90 | [0m[35m                "Must have at least one model engine. "[0m
[30;1m91 | [0m[35m                "This might be caused by not wrapping your model with wrap_model_engine()"[0m
[30;1m92 | [0m[35m            )[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m973[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1235 | [0m[35m[0m
[30;1m1236 | [0m[35m        If using data parallel training, the batch size should be per GPU batch size.[0m
[30;1m1237 | [0m[35m        If using gradient aggregation, the data loader should return batches with a desired[0m
[30;1m1238 | [0m[35m        micro batch size (most of the time this is the same as ``train_micro_batch_size_per_gpu``).[0m
[30;1m1239 | [0m[35m        """[0m
[30;1m1240 | [0m[35m        pass[0m
[30;1m1241 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m974[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m905 | [0m[35m        return util.is_overridden(self.trial.evaluate_full_dataset, DeepSpeedTrial)[0m
[30;1m906 | [0m[35m[0m
[30;1m907 | [0m[35m    def _load(self, load_path: pathlib.Path) -> None:[0m
[30;1m908 | [0m[35m        # Right now we will load all checkpoint shards on each node regardless of which[0m
[30;1m909 | [0m[35m        # checkpoints are needed.[0m
[30;1m910 | [0m[35m        # TODO (Liam): revisit later to optimize sharded checkpoint loading.[0m
[30;1m911 | [0m[35m        potential_paths = [[0m

[31m--[ [0m[34mMatch #[0m[33m975[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_deepspeed_trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport pathlib[0m
[30;1m8 | [0m[35mimport pickle[0m
[30;1m9 | [0m[35mimport random[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport warnings[0m
[30;1m12 | [0m[35mfrom typing import Any, Callable, Dict, Iterator, List, Optional, Tuple, Type, Union, cast[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport deepspeed[0m

[31m--[ [0m[34mMatch #[0m[33m976[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/lightning/experimental.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35mfrom determined.experimental import core_v2[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# TODO(ilia): Expand the integration.[0m
[30;1m12 | [0m[35mclass DetLogger(ptl_logger.Logger):[0m
[30;1m13 | [0m[35m    def __init__([0m
[30;1m14 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m977[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/lightning/experimental.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mfrom determined.experimental import core_v2[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# TODO(ilia): Expand the integration.[0m
[30;1m12 | [0m[35mclass DetLogger(ptl_logger.Logger):[0m
[30;1m13 | [0m[35m    def __init__([0m
[30;1m14 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m978[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_heartbeat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport sys[0m
[30;1m3 | [0m[35mimport threading[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport types[0m
[30;1m6 | [0m[35mfrom typing import Any, Optional, Union[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom determined.common import api[0m

[31m--[ [0m[34mMatch #[0m[33m979[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/database/outputs.tf[0m
   Pattern: [32m.hostname[0m
[30;1m1 | [0m[35moutput "database_hostname" {[0m
[30;1m2 | [0m[35m  value = google_sql_database_instance.db_instance.private_ip_address[0m
[30;1m3 | [0m[35m}[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m980[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_log_shipper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m            self._ship(msgs)[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    def _ship(self, msgs: List[Dict]) -> None:[0m
[30;1m166 | [0m[35m        self._session.post("task-logs", json=msgs)[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35mclass _UnmanagedTrialLogShipper(_LogShipper):[0m

[31m--[ [0m[34mMatch #[0m[33m981[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_log_shipper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m                break[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m            try:[0m
[30;1m122 | [0m[35m                yield self._queue.get(timeout=timeout)[0m
[30;1m123 | [0m[35m            except queue.Empty:[0m
[30;1m124 | [0m[35m                break[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m982[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_log_shipper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m    def _pop_until_deadline(self, deadline: float) -> Iterator[_QueueElement]:[0m
[30;1m116 | [0m[35m        while True:[0m
[30;1m117 | [0m[35m            timeout = deadline - time.time()[0m
[30;1m118 | [0m[35m            if timeout <= 0:[0m
[30;1m119 | [0m[35m                break[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m983[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_log_shipper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    def _pop_until_deadline(self, deadline: float) -> Iterator[_QueueElement]:[0m
[30;1m116 | [0m[35m        while True:[0m
[30;1m117 | [0m[35m            timeout = deadline - time.time()[0m
[30;1m118 | [0m[35m            if timeout <= 0:[0m
[30;1m119 | [0m[35m                break[0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m984[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_log_shipper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport queue[0m
[30;1m5 | [0m[35mimport sys[0m
[30;1m6 | [0m[35mimport threading[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mimport types[0m
[30;1m9 | [0m[35mfrom typing import Any, Callable, Dict, Iterator, List, Optional, TextIO, Union[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom determined import core[0m

[31m--[ [0m[34mMatch #[0m[33m985[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/ip/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m// Create Static IP[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mresource "google_compute_address" "static_ip" {[0m
[30;1m4 | [0m[35m  name = "det-static-ip-${var.unique_id}"[0m
[30;1m5 | [0m[35m  count = var.create_static_ip == true ? 1 : 0[0m

[31m--[ [0m[34mMatch #[0m[33m986[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/cli.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m        parsed_args = parser.parse_args(args)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        v = vars(parsed_args)[0m
[30;1m201 | [0m[35m        if not v.get("func"):[0m
[30;1m202 | [0m[35m            parser.print_usage()[0m
[30;1m203 | [0m[35m            parser.exit(2, "{}: no subcommand specified\n".format(parser.prog))[0m
[30;1m204 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m987[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/cli.py[0m
   Pattern: [32m.hostname[0m
[30;1m223 | [0m[35m                    ctx = SSL.Context(SSL.TLSv1_2_METHOD)[0m
[30;1m224 | [0m[35m                    conn = SSL.Connection(ctx, socket.socket())[0m
[30;1m225 | [0m[35m                    conn.set_tlsext_host_name(cast(str, addr.hostname).encode())[0m
[30;1m226 | [0m[35m                    conn.connect(cast(Sequence[Union[str, int]], (addr.hostname, addr.port)))[0m
[30;1m227 | [0m[35m                    conn.do_handshake()[0m
[30;1m228 | [0m[35m                    peer_cert_chain = conn.get_peer_cert_chain()[0m
[30;1m229 | [0m[35m                    if peer_cert_chain is None or len(peer_cert_chain) == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m988[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/cli.py[0m
   Pattern: [32m.hostname[0m
[30;1m222 | [0m[35m                try:[0m
[30;1m223 | [0m[35m                    ctx = SSL.Context(SSL.TLSv1_2_METHOD)[0m
[30;1m224 | [0m[35m                    conn = SSL.Connection(ctx, socket.socket())[0m
[30;1m225 | [0m[35m                    conn.set_tlsext_host_name(cast(str, addr.hostname).encode())[0m
[30;1m226 | [0m[35m                    conn.connect(cast(Sequence[Union[str, int]], (addr.hostname, addr.port)))[0m
[30;1m227 | [0m[35m                    conn.do_handshake()[0m
[30;1m228 | [0m[35m                    peer_cert_chain = conn.get_peer_cert_chain()[0m

[31m--[ [0m[34mMatch #[0m[33m989[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35mimport requests[0m
[30;1m13 | [0m[35mimport tabulate[0m
[30;1m14 | [0m[35mimport termcolor[0m
[30;1m15 | [0m[35mfrom OpenSSL import SSL, crypto[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mimport determined as det[0m
[30;1m18 | [0m[35mfrom determined import cli[0m

[31m--[ [0m[34mMatch #[0m[33m990[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_tensorboard_mode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12 | [0m[35m    artifacts written by non-chief workers will not be uploaded at all. This is the[0m
[30;1m13 | [0m[35m    same behavior that existed prior to 0.18.3.[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    In ``MANUAL`` mode no Tensorboard artifacts are written or uploaded at all.[0m
[30;1m16 | [0m[35m    It is entirely up to the user to write their desired metrics and upload[0m
[30;1m17 | [0m[35m    them with calls to :meth:`TrainContext.upload_tensorboard_files()[0m
[30;1m18 | [0m[35m    <determined.core.TrainContext.upload_tensorboard_files>`.[0m

[31m--[ [0m[34mMatch #[0m[33m991[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_tensorboard_mode.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m9 | [0m[35m    metrics to the Tensorboard path (see :meth:`TrainContext.get_tensorboard_path()[0m
[30;1m10 | [0m[35m    <determined.core.TrainContext.get_tensorboard_path>`), and automatically[0m
[30;1m11 | [0m[35m    uploads all of its own tensorboard artifacts to checkpoint storage.  Tensorboard[0m
[30;1m12 | [0m[35m    artifacts written by non-chief workers will not be uploaded at all. This is the[0m
[30;1m13 | [0m[35m    same behavior that existed prior to 0.18.3.[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    In ``MANUAL`` mode no Tensorboard artifacts are written or uploaded at all.[0m

[31m--[ [0m[34mMatch #[0m[33m992[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/checkpoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    values = [[0m
[30;1m78 | [0m[35m        [[0m
[30;1m79 | [0m[35m            c.training.trialId,[0m
[30;1m80 | [0m[35m            c.metadata.get("steps_completed", None),[0m
[30;1m81 | [0m[35m            c.state,[0m
[30;1m82 | [0m[35m            get_validation_metric(c, searcher_metric),[0m
[30;1m83 | [0m[35m            c.uuid,[0m

[31m--[ [0m[34mMatch #[0m[33m993[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/checkpoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m    table = [[0m
[30;1m19 | [0m[35m        ["Experiment ID", checkpoint.training.experiment_id if checkpoint.training else None],[0m
[30;1m20 | [0m[35m        ["Trial ID", checkpoint.training.trial_id if checkpoint.training else None],[0m
[30;1m21 | [0m[35m        ["Steps Completed", checkpoint.metadata.get("steps_completed")],[0m
[30;1m22 | [0m[35m        ["Report Time", render.format_time(checkpoint.report_time)],[0m
[30;1m23 | [0m[35m        ["Checkpoint UUID", checkpoint.uuid],[0m
[30;1m24 | [0m[35m        [[0m

[31m--[ [0m[34mMatch #[0m[33m994[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/user_groups.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m    if args.yes or render.yes_or_no([0m
[30;1m127 | [0m[35m        "Deleting a group will result in an unrecoverable \n"[0m
[30;1m128 | [0m[35m        "deletion of the group along with all the membership  \n"[0m
[30;1m129 | [0m[35m        "information of the group. Do you still wish to proceed? \n"[0m
[30;1m130 | [0m[35m    ):[0m
[30;1m131 | [0m[35m        sess = cli.setup_session(args)[0m
[30;1m132 | [0m[35m        group_id = api.group_name_to_group_id(sess, args.group_name)[0m

[31m--[ [0m[34mMatch #[0m[33m995[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m        "-f",[0m
[30;1m204 | [0m[35m        "--follow",[0m
[30;1m205 | [0m[35m        action="store_true",[0m
[30;1m206 | [0m[35m        help="follow the logs of a running task, similar to tail -f",[0m
[30;1m207 | [0m[35m    ),[0m
[30;1m208 | [0m[35m    cli.Group([0m
[30;1m209 | [0m[35m        cli.output_format_args["json"],[0m

[31m--[ [0m[34mMatch #[0m[33m996[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/token.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m        unauth_session = api.UnauthSession(master=args.master, cert=cli.cert)[0m
[30;1m135 | [0m[35m        auth_headers = {"Authorization": f"Bearer {args.token}"}[0m
[30;1m136 | [0m[35m        user_data = unauth_session.get("/api/v1/me", headers=auth_headers).json()[0m
[30;1m137 | [0m[35m        username = user_data.get("user").get("username")[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        token_store = authentication.TokenStore(args.master)[0m
[30;1m140 | [0m[35m        token_store.set_token(username, args.token)[0m

[31m--[ [0m[34mMatch #[0m[33m997[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/token.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m        unauth_session = api.UnauthSession(master=args.master, cert=cli.cert)[0m
[30;1m135 | [0m[35m        auth_headers = {"Authorization": f"Bearer {args.token}"}[0m
[30;1m136 | [0m[35m        user_data = unauth_session.get("/api/v1/me", headers=auth_headers).json()[0m
[30;1m137 | [0m[35m        username = user_data.get("user").get("username")[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        token_store = authentication.TokenStore(args.master)[0m
[30;1m140 | [0m[35m        token_store.set_token(username, args.token)[0m

[31m--[ [0m[34mMatch #[0m[33m998[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/token.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m    try:[0m
[30;1m134 | [0m[35m        unauth_session = api.UnauthSession(master=args.master, cert=cli.cert)[0m
[30;1m135 | [0m[35m        auth_headers = {"Authorization": f"Bearer {args.token}"}[0m
[30;1m136 | [0m[35m        user_data = unauth_session.get("/api/v1/me", headers=auth_headers).json()[0m
[30;1m137 | [0m[35m        username = user_data.get("user").get("username")[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        token_store = authentication.TokenStore(args.master)[0m

[31m--[ [0m[34mMatch #[0m[33m999[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m        ``auto_ack=False``.[0m
[30;1m255 | [0m[35m        """[0m
[30;1m256 | [0m[35m        logger.debug("acknowledge_preemption_signal()")[0m
[30;1m257 | [0m[35m        self._session.post(f"/api/v1/allocations/{self._allocation_id}/signals/ack_preemption")[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35mclass DummyPreemptContext(PreemptContext):[0m

[31m--[ [0m[34mMatch #[0m[33m1000[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    def _get_preemption(self, longpoll_time: int) -> bool:[0m
[30;1m55 | [0m[35m        logger.debug(f"(_PreemptionWatcher thread) _get_preemption({longpoll_time})")[0m
[30;1m56 | [0m[35m        return ([0m
[30;1m57 | [0m[35m            self._session.get([0m
[30;1m58 | [0m[35m                f"/api/v1/allocations/{self._allocation_id}/signals/preemption",[0m
[30;1m59 | [0m[35m                params={"timeout_seconds": str(longpoll_time)},[0m
[30;1m60 | [0m[35m                timeout=longpoll_time + 10,[0m

[31m--[ [0m[34mMatch #[0m[33m1001[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m135 | [0m[35m    if they should preempt or not.[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m    When mode is ``WorkersAskMaster``, each worker contacts the master independently in order to[0m
[30;1m138 | [0m[35m    decide to preempt or not.  Each worker receives the preemption signal at roughly the same time,[0m
[30;1m139 | [0m[35m    but it becomes your responsibility to tolerate situations where some workers have exited due to[0m
[30;1m140 | [0m[35m    preemption and others have not.[0m
[30;1m141 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1002[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    When mode is ``WorkersAskChief`` (the default), all workers must call ``should_preempt()``[0m
[30;1m129 | [0m[35m    in step.  Only the chief actually communicates with the master, then the chief broadcasts its[0m
[30;1m130 | [0m[35m    decision to all workers.  This guarantees that all workers decide to preempt at the exact same[0m
[30;1m131 | [0m[35m    time.[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    When mode is ``ChiefOnly``, only the chief is allowed to call[0m

[31m--[ [0m[34mMatch #[0m[33m1003[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m        exits with a zero exit code, the master interprets that as a completed task, and the task[0m
[30;1m250 | [0m[35m        does not get rescheduled.[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m        By default, ``acknowledge_preemption_signal()`` is called automatically the first time that[0m
[30;1m253 | [0m[35m        ``should_preempt()`` returns ``True``, unless ``should_preempt()`` is called with[0m
[30;1m254 | [0m[35m        ``auto_ack=False``.[0m
[30;1m255 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1004[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m    def acknowledge_preemption_signal(self) -> None:[0m
[30;1m244 | [0m[35m        """[0m
[30;1m245 | [0m[35m        ``acknowledge_preemption_signal()`` tells the Determined master that you are shutting down,[0m
[30;1m246 | [0m[35m        but you have not finished your work and you expect to be restarted later to complete it.[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m        This is important to tell the master explicitly because otherwise if the python process[0m
[30;1m249 | [0m[35m        exits with a zero exit code, the master interprets that as a completed task, and the task[0m

[31m--[ [0m[34mMatch #[0m[33m1005[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m204 | [0m[35m                signal (but you still want to check the signal for some purpose), then you should[0m
[30;1m205 | [0m[35m                set ``auto_ack`` to ``False``.  Then if you later do decide to comply with the[0m
[30;1m206 | [0m[35m                preemption signal, it is your responsibility to call[0m
[30;1m207 | [0m[35m                ``acknowledge_preemption_signal()`` manually any time before exiting.  Defaults to[0m
[30;1m208 | [0m[35m                ``True``.[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        .. note::[0m

[31m--[ [0m[34mMatch #[0m[33m1006[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35mr for the task to be restarted by the[0m
[30;1m200 | [0m[35m                Determined master after shutting down due to preemption, the task must acknowledge[0m
[30;1m201 | [0m[35m                the preemption signal to the Determined master.  When ``auto_ack`` is ``True`` this[0m
[30;1m202 | [0m[35m                acknowledgement is automatically sent the first time that ``should_preempt()``[0m
[30;1m203 | [0m[35m                returns ``True``.  If you might choose not to exit after receiving the preemption[0m
[30;1m204 | [0m[35m                signal (but you still want to check the signal for some purpose), then you should[0m

[31m--[ [0m[34mMatch #[0m[33m1007[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        self._cond = threading.Condition()[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        # Set daemon=True, since the requests library only supports blocking reads.  Under the hood,[0m
[30;1m48 | [0m[35m        # the requests library uses buffered IO on top of the socket, which means that we can't even[0m
[30;1m49 | [0m[35m        # use select() to know if a read would block; select() won't know that some data is[0m
[30;1m50 | [0m[35m        # available in the buffer.  We would probably have to move to an async-based HTTP library[0m
[30;1m51 | [0m[35m        # to make the PreemptionWatcher properly preemptible.[0m

[31m--[ [0m[34mMatch #[0m[33m1008[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_preempt.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport enum[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport threading[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom typing import Any, Optional[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport requests[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1009[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m147 | [0m[35m    model = model_by_name(sess, args.name)[0m
[30;1m148 | [0m[35m    if args.json:[0m
[30;1m149 | [0m[35m        resp = sess.post([0m
[30;1m150 | [0m[35m            f"/api/v1/models/{model.model_id}/versions",[0m
[30;1m151 | [0m[35m            json={"checkpointUuid": args.uuid},[0m
[30;1m152 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1010[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m97 | [0m[35m    model = model_by_name(sess, args.name)[0m
[30;1m98 | [0m[35m    if args.json:[0m
[30;1m99 | [0m[35m        r = sess.get(f"api/v1/models/{model.model_id}/versions")[0m
[30;1m100 | [0m[35m        data = r.json()[0m
[30;1m101 | [0m[35m        render.print_json(data)[0m
[30;1m102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1011[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/compute/variables.tf[0m
   Pattern: [32m.hostname[0m
[30;1m94 | [0m[35mvariable "gcs_bucket" {[0m
[30;1m95 | [0m[35m}[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35mvariable "database_hostname" {[0m
[30;1m98 | [0m[35m}[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mvariable "db_username" {[0m

[31m--[ [0m[34mMatch #[0m[33m1012[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/master.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    if len(field_masks) == 0:[0m
[30;1m32 | [0m[35m        raise cli.errors.CliError([0m
[30;1m33 | [0m[35m            "Please provide at least one argument to set master config. "[0m
[30;1m34 | [0m[35m            + "Currently, the supported fields are --log.level and --log.color."[0m
[30;1m35 | [0m[35m        )[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1013[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/master.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m        ]),[0m
[30;1m155 | [0m[35m        cli.Cmd("logs", logs, "fetch master logs", [[0m
[30;1m156 | [0m[35m            cli.Arg("-f", "--follow", action="store_true",[0m
[30;1m157 | [0m[35m                help="follow the logs of master, similar to tail -f"),[0m
[30;1m158 | [0m[35m            cli.Arg("--tail", type=int,[0m
[30;1m159 | [0m[35m                help="number of lines to show, counting from the end "[0m
[30;1m160 | [0m[35m                "of the log (default is all)")[0m

[31m--[ [0m[34mMatch #[0m[33m1014[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/master.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m    if args.start is not None and not util.is_protobuf_timestamp(args.start):[0m
[30;1m80 | [0m[35m        raise ValueError("Start time must be RFC-3339, i.e. of the form YYYY-MM-DDThh:mm:ssZ")[0m
[30;1m81 | [0m[35m    if args.end is not None and not util.is_protobuf_timestamp(args.end):[0m
[30;1m82 | [0m[35m        raise ValueError("End time must be RFC-3339, i.e. of the form YYYY-MM-DDThh:mm:ssZ")[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    body = bindings.v1SetClusterMessageRequest([0m
[30;1m85 | [0m[35m        startTime=args.start, endTime=args.end, message=args.message, duration=args.duration[0m

[31m--[ [0m[34mMatch #[0m[33m1015[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/master.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m    if args.message is None:[0m
[30;1m78 | [0m[35m        raise ValueError("Provide a message using the -m flag.")[0m
[30;1m79 | [0m[35m    if args.start is not None and not util.is_protobuf_timestamp(args.start):[0m
[30;1m80 | [0m[35m        raise ValueError("Start time must be RFC-3339, i.e. of the form YYYY-MM-DDThh:mm:ssZ")[0m
[30;1m81 | [0m[35m    if args.end is not None and not util.is_protobuf_timestamp(args.end):[0m
[30;1m82 | [0m[35m        raise ValueError("End time must be RFC-3339, i.e. of the form YYYY-MM-DDThh:mm:ssZ")[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1016[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_metrics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m        """Start the thread and ship metrics in queue to master."""[0m
[30;1m150 | [0m[35m        try:[0m
[30;1m151 | [0m[35m            while True:[0m
[30;1m152 | [0m[35m                msg = self._queue.get()[0m
[30;1m153 | [0m[35m                if msg is None:[0m
[30;1m154 | [0m[35m                    # Received shutdown message, exit.[0m
[30;1m155 | [0m[35m                    return[0m

[31m--[ [0m[34mMatch #[0m[33m1017[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_metrics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m    def _maybe_raise_exception(self) -> None:[0m
[30;1m61 | [0m[35m        """Check the error queue for exceptions and raise if there are any."""[0m
[30;1m62 | [0m[35m        if not self._error_queue.empty():[0m
[30;1m63 | [0m[35m            err_msg = self._error_queue.get(block=False)[0m
[30;1m64 | [0m[35m            logger.error(f"Error reporting metrics: {err_msg}")[0m
[30;1m65 | [0m[35m            raise err_msg[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1018[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/core/_metrics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m            else:[0m
[30;1m83 | [0m[35m                return[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        # Metrics queue is empty, join with timeout to avoid hangs and add logs to help debug.[0m
[30;1m86 | [0m[35m        self._shipper.join(timeout=1)[0m
[30;1m87 | [0m[35m        if self._shipper.is_alive():[0m
[30;1m88 | [0m[35m            logger.info("Waiting for _Shipper thread to finish...")[0m

[31m--[ [0m[34mMatch #[0m[33m1019[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/job.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m            f"Supported commands include: {valid_cmds}."[0m
[30;1m156 | [0m[35m        )[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m    args[replacements.get(operand[0], operand[0])] = operand[1][0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m    return args[0m
[30;1m161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1020[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/job.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m217 | [0m[35m            cli.Cmd([0m
[30;1m218 | [0m[35m                "update-batch",[0m
[30;1m219 | [0m[35m                process_updates,[0m
[30;1m220 | [0m[35m                "batch update jobs",[0m
[30;1m221 | [0m[35m                [[0m
[30;1m222 | [0m[35m                    cli.Arg([0m
[30;1m223 | [0m[35m                        "operation",[0m

[31m--[ [0m[34mMatch #[0m[33m1021[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/job.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m139 | [0m[35m    if len(values) != 2:[0m
[30;1m140 | [0m[35m        raise ValueError([0m
[30;1m141 | [0m[35m            f"Job {values[0]} and its operation have an invalid format. "[0m
[30;1m142 | [0m[35m            f"Please ensure the update is formatted as <jobID>.<operation>=<value>."[0m
[30;1m143 | [0m[35m        )[0m
[30;1m144 | [0m[35m    args["job_id"] = values[0][0m
[30;1m145 | [0m[35m    operand = values[1].split("=")[0m

[31m--[ [0m[34mMatch #[0m[33m1022[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/job.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m110 | [0m[35m    weight: str = "",[0m
[30;1m111 | [0m[35m    resource_pool: str = "",[0m
[30;1m112 | [0m[35m) -> None:[0m
[30;1m113 | [0m[35m    update = bindings.v1QueueControl([0m
[30;1m114 | [0m[35m        jobId=job_id,[0m
[30;1m115 | [0m[35m        priority=int(priority) if priority != "" else None,[0m
[30;1m116 | [0m[35m        weight=int(weight) if weight != "" else None,[0m

[31m--[ [0m[34mMatch #[0m[33m1023[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/job.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35mdef update(args: argparse.Namespace) -> None:[0m
[30;1m89 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m90 | [0m[35m    update = bindings.v1QueueControl([0m
[30;1m91 | [0m[35m        jobId=args.job_id,[0m
[30;1m92 | [0m[35m        priority=args.priority,[0m
[30;1m93 | [0m[35m        weight=args.weight,[0m

[31m--[ [0m[34mMatch #[0m[33m1024[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/render.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35mdef _coloring_enabled() -> bool:[0m
[30;1m267 | [0m[35m    return sys.stdout.isatty() and os.environ.get("DET_CLI_COLORIZE", "").lower() in ("1", "true")[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35mdef print_json(data: Union[str, Any]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1025[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/render.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    spec = inspect.getfullargspec(class_)[0m
[30;1m47 | [0m[35m    init_args = {}[0m
[30;1m48 | [0m[35m    for arg in spec.args[1:]:[0m
[30;1m49 | [0m[35m        transform = transforms.get(arg, lambda x: x)[0m
[30;1m50 | [0m[35m        init_args[arg] = transform(data[arg])[0m
[30;1m51 | [0m[35m    return class_(**init_args)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1026[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/render.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mdef select_values(values: List[Dict[str, Any]], headers: Dict[str, str]) -> List[List[Any]]:[0m
[30;1m38 | [0m[35m    return [[item.get(k, _DEFAULT_VALUE) for k in headers.keys()] for item in values][0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mdef unmarshal([0m

[31m--[ [0m[34mMatch #[0m[33m1027[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/render.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m    keys = inspect.getfullargspec(generic).args[1:][0m
[30;1m91 | [0m[35m    headers = [key.replace("_", " ").title() for key in keys][0m
[30;1m92 | [0m[35m    if len(headers) == 0:[0m
[30;1m93 | [0m[35m        raise ValueError("must have at least one header to display")[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    def _coerce(r: Any) -> Iterable[Any]:[0m
[30;1m96 | [0m[35m        for key in keys:[0m

[31m--[ [0m[34mMatch #[0m[33m1028[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/checkpoint/_checkpoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m        """[0m
[30;1m323 | [0m[35m        local_ckpt_dir.mkdir(parents=True, exist_ok=True)[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        resp = sess.get(f"/checkpoints/{uuid}", headers={"Accept": "application/gzip"}, stream=True)[0m
[30;1m326 | [0m[35m        if not resp.ok:[0m
[30;1m327 | [0m[35m            raise errors.ProxiedDownloadFailed([0m
[30;1m328 | [0m[35m                "unable to download checkpoint from master:", resp.status_code, resp.reason[0m

[31m--[ [0m[34mMatch #[0m[33m1029[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/checkpoint/_checkpoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m        This function assumes the host path of the shared fs exists.[0m
[30;1m167 | [0m[35m        """[0m
[30;1m168 | [0m[35m        host_path = checkpoint_storage["host_path"][0m
[30;1m169 | [0m[35m        storage_path = checkpoint_storage.get("storage_path")[0m
[30;1m170 | [0m[35m        potential_paths = [[0m
[30;1m171 | [0m[35m            pathlib.Path(shared._full_storage_path(host_path, storage_path), self.uuid),[0m
[30;1m172 | [0m[35m            pathlib.Path([0m

[31m--[ [0m[34mMatch #[0m[33m1030[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/checkpoint/_checkpoint.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m244 | [0m[35m            else:[0m
[30;1m245 | [0m[35m                raise ValueError(f"Unknown download mode {mode}")[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m        # As of v0.18.0, we write metadata.json once at upload time.  Checkpoints uploaded prior to[0m
[30;1m248 | [0m[35m        # 0.18.0 will not have a metadata.json present.  Unfortunately, checkpoints earlier than[0m
[30;1m249 | [0m[35m        # 0.17.7 depended on this file existing in order to be loaded.  Therefore, when we detect[0m
[30;1m250 | [0m[35m        # that the metadata.json file is not present, we write it to make sure those checkpoints can[0m

[31m--[ [0m[34mMatch #[0m[33m1031[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/checkpoint/_checkpoint.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m141 | [0m[35m        Note:[0m
[30;1m142 | [0m[35m            All attributes are cached by default.[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m            Some attributes are mutable and may be changed by methods that update these values,[0m
[30;1m145 | [0m[35m            either automatically (eg. :meth:`add_metadata()`) or explicitly with :meth:`reload()`.[0m
[30;1m146 | [0m[35m    """[0m
[30;1m147 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1032[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/checkpoint/_checkpoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m          - :func:`determined.keras.load_model_from_checkpoint_path`[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m        Arguments:[0m
[30;1m200 | [0m[35m            path (string, optional): Top level directory to place the[0m
[30;1m201 | [0m[35m                checkpoint under. If this parameter is not set, the checkpoint will[0m
[30;1m202 | [0m[35m                be downloaded to ``checkpoints/<checkpoint_uuid>`` relative to the[0m
[30;1m203 | [0m[35m                current working directory.[0m

[31m--[ [0m[34mMatch #[0m[33m1033[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/checkpoint/_checkpoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m        self.training: Optional[CheckpointTrainingMetadata] = None[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    def _find_shared_fs_path(self, checkpoint_storage: Dict[str, Any]) -> pathlib.Path:[0m
[30;1m165 | [0m[35m        """Attempt to find the path of the checkpoint if being configured to shared fs.[0m
[30;1m166 | [0m[35m        This function assumes the host path of the shared fs exists.[0m
[30;1m167 | [0m[35m        """[0m
[30;1m168 | [0m[35m        host_path = checkpoint_storage["host_path"][0m

[31m--[ [0m[34mMatch #[0m[33m1034[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m74 | [0m[35m    shell_id = ntsc.expand_uuid_prefixes(sess, args)[0m
[30;1m75 | [0m[35m    shell = sess.get(f"api/v1/shells/{shell_id}").json()["shell"][0m
[30;1m76 | [0m[35m    _open_shell([0m
[30;1m77 | [0m[35m        sess,[0m
[30;1m78 | [0m[35m        shell,[0m

[31m--[ [0m[34mMatch #[0m[33m1035[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35mdef open_shell(args: argparse.Namespace) -> None:[0m
[30;1m53 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m54 | [0m[35m    shell_id = cast(str, ntsc.expand_uuid_prefixes(sess, args))[0m
[30;1m55 | [0m[35m    shell = sess.get(f"api/v1/shells/{shell_id}").json()["shell"][0m
[30;1m56 | [0m[35m    _open_shell([0m
[30;1m57 | [0m[35m        sess,[0m
[30;1m58 | [0m[35m        shell,[0m

[31m--[ [0m[34mMatch #[0m[33m1036[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m188 | [0m[35m            # invoking ssh directly, it behaves the same whether -i has backslashes or not.[0m
[30;1m189 | [0m[35m            unixy_keypath = unixy_keypath.replace("\\", "/")[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        cmd = [[0m
[30;1m192 | [0m[35m            "ssh",[0m
[30;1m193 | [0m[35m            "-o",[0m
[30;1m194 | [0m[35m            f"ProxyCommand={proxy_cmd}",[0m

[31m--[ [0m[34mMatch #[0m[33m1037[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m68 | [0m[35m            "WSL remote-ssh integration is not supported in VSCode, which "[0m
[30;1m69 | [0m[35m            "uses Windows openssh. For Windows VSCode integration, rerun this "[0m
[30;1m70 | [0m[35m            "command in a Windows shell. For PyCharm users, configure the Pycharm "[0m
[30;1m71 | [0m[35m            "ssh command to target the WSL ssh command."[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m74 | [0m[35m    shell_id = ntsc.expand_uuid_prefixes(sess, args)[0m

[31m--[ [0m[34mMatch #[0m[33m1038[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m333 | [0m[35m                    cli.Arg([0m
[30;1m334 | [0m[35m                        "ssh_opts",[0m
[30;1m335 | [0m[35m                        nargs="*",[0m
[30;1m336 | [0m[35m                        help="additional SSH options when connecting to the shell",[0m
[30;1m337 | [0m[35m                    ),[0m
[30;1m338 | [0m[35m                ],[0m
[30;1m339 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1039[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m            cli.Cmd([0m
[30;1m328 | [0m[35m                "show-ssh-command",[0m
[30;1m329 | [0m[35m                show_ssh_command,[0m
[30;1m330 | [0m[35m                "print the ssh command",[0m
[30;1m331 | [0m[35m                [[0m
[30;1m332 | [0m[35m                    cli.Arg("shell_id", help="shell ID"),[0m
[30;1m333 | [0m[35m                    cli.Arg([0m

[31m--[ [0m[34mMatch #[0m[33m1040[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m320 | [0m[35m                    cli.Arg([0m
[30;1m321 | [0m[35m                        "ssh_opts",[0m
[30;1m322 | [0m[35m                        nargs="*",[0m
[30;1m323 | [0m[35m                        help="additional SSH options when connecting to the shell",[0m
[30;1m324 | [0m[35m                    ),[0m
[30;1m325 | [0m[35m                ],[0m
[30;1m326 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1041[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m                    cli.Arg([0m
[30;1m308 | [0m[35m                        "--show-ssh-command",[0m
[30;1m309 | [0m[35m                        action="store_true",[0m
[30;1m310 | [0m[35m                        help="show ssh command (e.g. for use in IDE) when starting the shell",[0m
[30;1m311 | [0m[35m                    ),[0m
[30;1m312 | [0m[35m                ],[0m
[30;1m313 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1042[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m                    cli.Arg([0m
[30;1m303 | [0m[35m                        "ssh_opts",[0m
[30;1m304 | [0m[35m                        nargs="*",[0m
[30;1m305 | [0m[35m                        help="additional SSH options when connecting to the shell",[0m
[30;1m306 | [0m[35m                    ),[0m
[30;1m307 | [0m[35m                    cli.Arg([0m
[30;1m308 | [0m[35m                        "--show-ssh-command",[0m

[31m--[ [0m[34mMatch #[0m[33m1043[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m                    cli.Arg([0m
[30;1m290 | [0m[35m                        "--show-ssh-command",[0m
[30;1m291 | [0m[35m                        action="store_true",[0m
[30;1m292 | [0m[35m                        help="show ssh command (e.g. for use in IDE) when starting the shell",[0m
[30;1m293 | [0m[35m                    ),[0m
[30;1m294 | [0m[35m                ],[0m
[30;1m295 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1044[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m253 | [0m[35m                    cli.Arg([0m
[30;1m254 | [0m[35m                        "ssh_opts",[0m
[30;1m255 | [0m[35m                        nargs="*",[0m
[30;1m256 | [0m[35m                        help="additional SSH options when connecting to the shell",[0m
[30;1m257 | [0m[35m                    ),[0m
[30;1m258 | [0m[35m                    cli.Arg([0m
[30;1m259 | [0m[35m                        "--config-file",[0m

[31m--[ [0m[34mMatch #[0m[33m1045[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m            # Convert the backslashes of the -i argument to ssh to forwardslashes.  This is[0m
[30;1m186 | [0m[35m            # important because when passing the output of ssh_show_command to VSCode, VSCode would[0m
[30;1m187 | [0m[35m            # put backslashes in .ssh/config, which would not be handled correctly by ssh.  When[0m
[30;1m188 | [0m[35m            # invoking ssh directly, it behaves the same whether -i has backslashes or not.[0m
[30;1m189 | [0m[35m            unixy_keypath = unixy_keypath.replace("\\", "/")[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        cmd = [[0m

[31m--[ [0m[34mMatch #[0m[33m1046[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        unixy_keypath = str(keypath)[0m
[30;1m184 | [0m[35m        if sys.platform == "win32":[0m
[30;1m185 | [0m[35m            # Convert the backslashes of the -i argument to ssh to forwardslashes.  This is[0m
[30;1m186 | [0m[35m            # important because when passing the output of ssh_show_command to VSCode, VSCode would[0m
[30;1m187 | [0m[35m            # put backslashes in .ssh/config, which would not be handled correctly by ssh.  When[0m
[30;1m188 | [0m[35m            # invoking ssh directly, it behaves the same whether -i has backslashes or not.[0m

[31m--[ [0m[34mMatch #[0m[33m1047[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m        keyfile.write(shell["privateKey"])[0m
[30;1m159 | [0m[35m        keyfile.flush()[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        # Use determined.cli.tunnel as a portable script for using the HTTP CONNECT mechanism,[0m
[30;1m162 | [0m[35m        # similar to `nc -X CONNECT -x ...` but without any dependency on external binaries.[0m
[30;1m163 | [0m[35m        proxy_cmd = f"{sys.executable} -m determined.cli.tunnel {sess.master} %h"[0m
[30;1m164 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1048[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m    else:[0m
[30;1m109 | [0m[35m        # Avoid using tempfile.NamedTemporaryFile, which does not produce a file that can be opened[0m
[30;1m110 | [0m[35m        # by name on Windows, which prevents the ssh process from reading it.[0m
[30;1m111 | [0m[35m        fd, path = tempfile.mkstemp(text=True)[0m
[30;1m112 | [0m[35m        f = open(fd, "w")[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1049[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m        keyfile = key_path.open("w")[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        if platform.system() == "Windows":[0m
[30;1m98 | [0m[35m            # On Windows, chmod only affects the read-only flag on the file. To emulate the[0m
[30;1m99 | [0m[35m            # actual functionality of chmod, an external library is used for Windows systems.[0m
[30;1m100 | [0m[35m            import oschmod[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1050[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/shell.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m            "WSL remote-ssh integration is not supported in VSCode, which "[0m
[30;1m69 | [0m[35m            "uses Windows openssh. For Windows VSCode integration, rerun this "[0m
[30;1m70 | [0m[35m            "command in a Windows shell. For PyCharm users, configure the Pycharm "[0m
[30;1m71 | [0m[35m            "ssh command to target the WSL ssh command."[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m74 | [0m[35m    shell_id = ntsc.expand_uuid_prefixes(sess, args)[0m

[31m--[ [0m[34mMatch #[0m[33m1051[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    resp = bindings.get_GetMaster(sess)[0m
[30;1m47 | [0m[35m    users_list = d.list_users(active=None if args.all else True)[0m
[30;1m48 | [0m[35m    renderer = FullUser  # type: Any[0m
[30;1m49 | [0m[35m    if resp.to_json().get("rbacEnabled"):[0m
[30;1m50 | [0m[35m        renderer = FullUserNoAdmin[0m
[30;1m51 | [0m[35m    render.render_objects(renderer, users_list)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1052[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m.userInfo[0m
[30;1m279 | [0m[35m            cli.Arg("det_username", help="name of Determined user to link"),[0m
[30;1m280 | [0m[35m            *AGENT_USER_GROUP_ARGS,[0m
[30;1m281 | [0m[35m        ]),[0m
[30;1m282 | [0m[35m        cli.Cmd("whoami", whoami, "print the active user", []),[0m
[30;1m283 | [0m[35m        cli.Cmd("edit", edit, "edit user fields", [[0m
[30;1m284 | [0m[35m            cli.Arg([0m
[30;1m285 | [0m[35m                "target_user",[0m

[31m--[ [0m[34mMatch #[0m[33m1053[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m.userInfo[0m
[30;1m279 | [0m[35m            cli.Arg("det_username", help="name of Determined user to link"),[0m
[30;1m280 | [0m[35m            *AGENT_USER_GROUP_ARGS,[0m
[30;1m281 | [0m[35m        ]),[0m
[30;1m282 | [0m[35m        cli.Cmd("whoami", whoami, "print the active user", []),[0m
[30;1m283 | [0m[35m        cli.Cmd("edit", edit, "edit user fields", [[0m
[30;1m284 | [0m[35m            cli.Arg([0m
[30;1m285 | [0m[35m                "target_user",[0m

[31m--[ [0m[34mMatch #[0m[33m1054[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m.userInfo[0m
[30;1m181 | [0m[35mdef whoami(args: argparse.Namespace) -> None:[0m
[30;1m182 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m183 | [0m[35m    d = client.Determined._from_session(sess)[0m
[30;1m184 | [0m[35m    user = d.whoami()[0m
[30;1m185 | [0m[35m    print("You are logged in as user '{}'".format(user.username))[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1055[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/user.py[0m
   Pattern: [32m.userInfo[0m
[30;1m178 | [0m[35m    d.create_user(username=username, admin=admin, password=password, remote=remote)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35mdef whoami(args: argparse.Namespace) -> None:[0m
[30;1m182 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m183 | [0m[35m    d = client.Determined._from_session(sess)[0m
[30;1m184 | [0m[35m    user = d.whoami()[0m

[31m--[ [0m[34mMatch #[0m[33m1056[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/dev.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m        else:[0m
[30;1m215 | [0m[35m            key = params[idx].name[0m
[30;1m216 | [0m[35m            value = arg[0m
[30;1m217 | [0m[35m        param = params_d.get(key)[0m
[30;1m218 | [0m[35m        if not param:[0m
[30;1m219 | [0m[35m            raise ValueError(f"Unknown argument {key}")[0m
[30;1m220 | [0m[35m        value = parse_param_value(param, value)[0m

[31m--[ [0m[34mMatch #[0m[33m1057[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/dev.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35m        "--globoff",[0m
[30;1m50 | [0m[35m    ][0m
[30;1m51 | [0m[35m    if args.curl_args:[0m
[30;1m52 | [0m[35m        cmd += args.curl_args[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    if args.x:[0m
[30;1m55 | [0m[35m        print(shlex.join(cmd))[0m

[31m--[ [0m[34mMatch #[0m[33m1058[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/dev.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m328 | [0m[35m                    cli.Arg([0m
[30;1m329 | [0m[35m                        "-x", help="display the curl command that will be run", action="store_true"[0m
[30;1m330 | [0m[35m                    ),[0m
[30;1m331 | [0m[35m                    cli.Arg("path", help="relative path to curl (e.g. /api/v1/experiments?x=z)"),[0m
[30;1m332 | [0m[35m                    cli.Arg("curl_args", nargs=argparse.REMAINDER, help="curl arguments"),[0m
[30;1m333 | [0m[35m                ],[0m
[30;1m334 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1059[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/dev.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m                "invoke curl",[0m
[30;1m327 | [0m[35m                [[0m
[30;1m328 | [0m[35m                    cli.Arg([0m
[30;1m329 | [0m[35m                        "-x", help="display the curl command that will be run", action="store_true"[0m
[30;1m330 | [0m[35m                    ),[0m
[30;1m331 | [0m[35m                    cli.Arg("path", help="relative path to curl (e.g. /api/v1/experiments?x=z)"),[0m
[30;1m332 | [0m[35m                    cli.Arg("curl_args", nargs=argparse.REMAINDER, help="curl arguments"),[0m

[31m--[ [0m[34mMatch #[0m[33m1060[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/deployment_types/secure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m    ui_info = "View the Determined UI: " + termcolor.colored("http://localhost:8080", "blue")[0m
[30;1m21 | [0m[35m    ssh_info = "SSH to Determined Master: " + termcolor.colored([0m
[30;1m22 | [0m[35m        "ssh -i  <keypair> ubuntu@{master_ip} -o "[0m
[30;1m23 | [0m[35m        '"proxycommand ssh -W %h:%p -i <keypair> ubuntu@{bastion_ip}"',[0m
[30;1m24 | [0m[35m        "yellow",[0m
[30;1m25 | [0m[35m    )[0m
[30;1m26 | [0m[35m    template = "secure.yaml"[0m

[31m--[ [0m[34mMatch #[0m[33m1061[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/deployment_types/secure.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    bastion_info = ([0m
[30;1m11 | [0m[35m        "To View Determined UI:\n"[0m
[30;1m12 | [0m[35m        "Add Keypair: " + termcolor.colored("ssh-add <keypair>", "yellow") + "\n"[0m
[30;1m13 | [0m[35m        "Open SSH Tunnel through Bastion: "[0m
[30;1m14 | [0m[35m        + termcolor.colored("ssh -N -L 8080:{master_ip}:8080 ubuntu@{bastion_ip}", "yellow")[0m
[30;1m15 | [0m[35m    )[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1062[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/command.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35m        includes=args.include,[0m
[30;1m24 | [0m[35m        workspace_id=workspace_id,[0m
[30;1m25 | [0m[35m    )[0m
[30;1m26 | [0m[35m    cmd = bindings.v1LaunchCommandResponse.from_json(resp).command[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    if args.detach:[0m
[30;1m29 | [0m[35m        print(cmd.id)[0m

[31m--[ [0m[34mMatch #[0m[33m1063[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/_declarative_argparse.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m177 | [0m[35m                metavar = "sub" * depth + "command"[0m
[30;1m178 | [0m[35m                subparsers = parser.add_subparsers(metavar=metavar)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m                # If there are any subcommands at all, also add a `help`[0m
[30;1m181 | [0m[35m                # subcommand.[0m
[30;1m182 | [0m[35m                help_parser = subparsers.add_parser("help", help="show help for this command")[0m
[30;1m183 | [0m[35m                help_parser.set_defaults(func=help_func(parser))[0m

[31m--[ [0m[34mMatch #[0m[33m1064[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/_declarative_argparse.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m140 | [0m[35m    Return a function that prints help for the given parser. Using this doesn't[0m
[30;1m141 | [0m[35m    exit during the call to to `parse_args` itself, which would be ideal, but[0m
[30;1m142 | [0m[35m    only when the function from the `parse_args` result is called. It looks[0m
[30;1m143 | [0m[35m    about the same as long as you do the second right after the first, at[0m
[30;1m144 | [0m[35m    least.[0m
[30;1m145 | [0m[35m    """[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    def inner_func(args: argparse.Namespace) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m1065[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/_declarative_argparse.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m        # positioning of non-Cmd arg descriptions.[0m
[30;1m167 | [0m[35m        return ""[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    # Sort descriptions alphabetically by name before passing them to[0m
[30;1m170 | [0m[35m    # argparse. This ensures that `help` output is sorted[0m
[30;1m171 | [0m[35m    # alphabetically.[0m
[30;1m172 | [0m[35m    description = sorted(description, key=description_sort_key)[0m

[31m--[ [0m[34mMatch #[0m[33m1066[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m@contextlib.contextmanager[0m
[30;1m201 | [0m[35mdef _tunnel_trial(sess: api.Session, trial_id: int, port_map: "Dict[int, int]") -> Iterator[None]:[0m
[30;1m202 | [0m[35m    # TODO(DET-9000): perhaps the tunnel should be able to probe master for service status,[0m
[30;1m203 | [0m[35m    # instead of us explicitly polling for task/trial status.[0m
[30;1m204 | [0m[35m    while True:[0m
[30;1m205 | [0m[35m        resp = bindings.get_GetTrial(sess, trialId=trial_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1067[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport socketserver[0m
[30;1m7 | [0m[35mimport sys[0m
[30;1m8 | [0m[35mimport threading[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom typing import Dict, Iterator, List, Optional[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport lomond[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1068[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/terraform/modules/network/main.tf[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m  provider = google-beta[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m  network                 = local.network_self_link[0m
[30;1m30 | [0m[35m  service                 = "servicenetworking.googleapis.com"[0m
[30;1m31 | [0m[35m  reserved_peering_ranges = [google_compute_global_address.private_ip_address.name][0m
[30;1m32 | [0m[35m}[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1069[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/template.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    w_names = workspace.get_workspace_names(sess)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    for tpl in bindings.get_GetTemplates(sess).templates:[0m
[30;1m27 | [0m[35m        w_name = w_names.get(tpl.workspaceId, "missing workspace")[0m
[30;1m28 | [0m[35m        templates.append(TemplateAll(tpl.name, w_name, _parse_config(tpl.config)))[0m
[30;1m29 | [0m[35m    if args.details:[0m
[30;1m30 | [0m[35m        render.render_objects(TemplateAll, templates, table_fmt="grid")[0m

[31m--[ [0m[34mMatch #[0m[33m1070[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m        else "/tensorboard/{}/events?tail=1".format(task_id)[0m
[30;1m474 | [0m[35m    )[0m
[30;1m475 | [0m[35m    wait_path_url = service_address + wait_path[0m
[30;1m476 | [0m[35m    public_url = os.environ.get("PUBLIC_URL", "/det")[0m
[30;1m477 | [0m[35m    wait_page_url = "{}/wait/{}/{}?eventUrl={}&serviceAddr={}".format([0m
[30;1m478 | [0m[35m        public_url, task_type, task_id, wait_path_url, service_address[0m
[30;1m479 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1071[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m456 | [0m[35m    if workspace_id is not None:[0m
[30;1m457 | [0m[35m        body["workspaceId"] = workspace_id[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m    return sess.post(endpoint, json=body).json()[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m[0m
[30;1m462 | [0m[35mdef make_interactive_task_url([0m

[31m--[ [0m[34mMatch #[0m[33m1072[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m    # Use the entrypoint command line argument if an entrypoint has not already been[0m
[30;1m415 | [0m[35m    # defined by previous settings.[0m
[30;1m416 | [0m[35m    if not config.get("entrypoint") and entrypoint:[0m
[30;1m417 | [0m[35m        config["entrypoint"] = entrypoint[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m    return config[0m

[31m--[ [0m[34mMatch #[0m[33m1073[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35mdef config(args: argparse.Namespace) -> None:[0m
[30;1m298 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m299 | [0m[35m    task_id = expand_uuid_prefixes(sess, args)[0m
[30;1m300 | [0m[35m    res_json = sess.get(f"api/v1/{RemoteTaskNewAPIs[args._command]}/{task_id}").json()[0m
[30;1m301 | [0m[35m    print(render.format_object_as_yaml(res_json["config"]))[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1074[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m    try:[0m
[30;1m290 | [0m[35m        api_full_path = f"api/v1/{RemoteTaskNewAPIs[args._command]}/{task_id}/set_priority"[0m
[30;1m291 | [0m[35m        sess.post(api_full_path, json={"priority": args.priority})[0m
[30;1m292 | [0m[35m        print(termcolor.colored(f"Set priority of {name} {task_id} to {args.priority}", "green"))[0m
[30;1m293 | [0m[35m    except api.errors.APIException as e:[0m
[30;1m294 | [0m[35m        print(termcolor.colored(f"Skipping: {e} ({type(e).__name__})", "red"))[0m

[31m--[ [0m[34mMatch #[0m[33m1075[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35mdef _kill(sess: api.Session, task_type: str, task_id: str) -> None:[0m
[30;1m281 | [0m[35m    sess.post(f"api/v1/{RemoteTaskNewAPIs[task_type]}/{task_id}/kill")[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35mdef set_priority(args: argparse.Namespace) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1076[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m    if not args.all:[0m
[30;1m231 | [0m[35m        params["users"] = [sess.username][0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m    res = sess.get(api_full_path, params=params).json()[api_path][0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m    if args.quiet:[0m
[30;1m236 | [0m[35m        for command in res:[0m

[31m--[ [0m[34mMatch #[0m[33m1077[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35mdef describe(args: argparse.Namespace) -> None:[0m
[30;1m197 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m198 | [0m[35m    task_id = expand_uuid_prefixes(sess, args)[0m
[30;1m199 | [0m[35m    item = sess.get(f"api/v1/{RemoteTaskNewAPIs[args._command]}/{task_id}").json()["command"][0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m    w_names = workspace.get_workspace_names(sess)[0m
[30;1m202 | [0m[35m    if item["state"].startswith("STATE_"):[0m

[31m--[ [0m[34mMatch #[0m[33m1078[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m            )[0m
[30;1m171 | [0m[35m        api_path = RemoteTaskNewAPIs[args._command][0m
[30;1m172 | [0m[35m        api_full_path = "api/v1/{}".format(api_path)[0m
[30;1m173 | [0m[35m        res = sess.get(api_full_path).json()[api_path][0m
[30;1m174 | [0m[35m        all_ids: List[str] = [x["id"] for x in res][0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m        def expand(prefix: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1079[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m"""[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mVOLUME_DESC = """[0m
[30;1m48 | [0m[35mA mount specification in the form of `<host path>:<container path>`. The[0m
[30;1m49 | [0m[35mgiven path on the host machine will be mounted under the given path in[0m
[30;1m50 | [0m[35mthe command container.[0m
[30;1m51 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m1080[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/ntsc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""Shared CLI interface for NTSCs (notebooks, tensorboards, shells, and commands)."""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport argparse[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport collections[0m
[30;1m6 | [0m[35mimport functools[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35mimport operator[0m

[31m--[ [0m[34mMatch #[0m[33m1081[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/version.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m    master_info = {"cluster_id": "", "master_id": "", "version": ""}[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    try:[0m
[30;1m21 | [0m[35m        master_info = sess.get("info").json()[0m
[30;1m22 | [0m[35m        # Most connection errors mean that the master is unreachable, which this function handles.[0m
[30;1m23 | [0m[35m        # An SSL error, however, means it was reachable but something went wrong, so let that error[0m
[30;1m24 | [0m[35m        # propagate out.[0m

[31m--[ [0m[34mMatch #[0m[33m1082[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/version.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m38 | [0m[35m    if not master_version:[0m
[30;1m39 | [0m[35m        print([0m
[30;1m40 | [0m[35m            termcolor.colored([0m
[30;1m41 | [0m[35m                "Master not found at {}. "[0m
[30;1m42 | [0m[35m                "Hint: Remember to set the DET_MASTER environment variable "[0m
[30;1m43 | [0m[35m                "to the correct Determined master IP and port or use the '-m' flag.".format([0m
[30;1m44 | [0m[35m                    args.master[0m

[31m--[ [0m[34mMatch #[0m[33m1083[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/version.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m            termcolor.colored([0m
[30;1m41 | [0m[35m                "Master not found at {}. "[0m
[30;1m42 | [0m[35m                "Hint: Remember to set the DET_MASTER environment variable "[0m
[30;1m43 | [0m[35m                "to the correct Determined master IP and port or use the '-m' flag.".format([0m
[30;1m44 | [0m[35m                    args.master[0m
[30;1m45 | [0m[35m                ),[0m
[30;1m46 | [0m[35m                "yellow",[0m

[31m--[ [0m[34mMatch #[0m[33m1084[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m786 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m787 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m788 | [0m[35m               stable"[0m
[30;1m789 | [0m[35m            apt-get update[0m
[30;1m790 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m793 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m

[31m--[ [0m[34mMatch #[0m[33m1085[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m774 | [0m[35m            EOF[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m777 | [0m[35m            apt-get update[0m
[30;1m778 | [0m[35m            apt-get install -y \[0m
[30;1m779 | [0m[35m                apt-transport-https \[0m
[30;1m780 | [0m[35m                ca-certificates \[0m
[30;1m781 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1086[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m862 | [0m[35m    Value: !Ref Version[0m
[30;1m863 | [0m[35m[0m
[30;1m864 | [0m[35m  DeterminedAddress:[0m
[30;1m865 | [0m[35m    Description: Ip address of Determined Master[0m
[30;1m866 | [0m[35m    Value: !GetAtt MasterInstance.PublicDnsName[0m
[30;1m867 | [0m[35m[0m
[30;1m868 | [0m[35m  MasterPort:[0m

[31m--[ [0m[34mMatch #[0m[33m1087[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m808 | [0m[35m                -c "/usr/bin/determined-gotmpl -i /etc/determined/master.yaml.context /etc/determine[0m
[30;1m809 | [0m[35m            test $? -eq 0 || ( echo "Failed to generate master.yaml" && exit 1 )[0m
[30;1m810 | [0m[35m[0m
[30;1m811 | [0m[35m            docker run \[0m
[30;1m812 | [0m[35m                --name determined-master \[0m
[30;1m813 | [0m[35m                --network determined \[0m
[30;1m814 | [0m[35m                --restart unless-stopped \[0m

[31m--[ [0m[34mMatch #[0m[33m1088[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m799 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m802 | [0m[35m            docker run \[0m
[30;1m803 | [0m[35m                --name determined-master-configurator \[0m
[30;1m804 | [0m[35m                --rm \[0m
[30;1m805 | [0m[35m                -v /usr/local/determined/etc/:/etc/determined/ \[0m

[31m--[ [0m[34mMatch #[0m[33m1089[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m796 | [0m[35m            docker network create determined[0m
[30;1m797 | [0m[35m[0m
[30;1m798 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m799 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m802 | [0m[35m            docker run \[0m

[31m--[ [0m[34mMatch #[0m[33m1090[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m795 | [0m[35m[0m
[30;1m796 | [0m[35m            docker network create determined[0m
[30;1m797 | [0m[35m[0m
[30;1m798 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m799 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m

[31m--[ [0m[34mMatch #[0m[33m1091[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m793 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m794 | [0m[35m            fi[0m
[30;1m795 | [0m[35m[0m
[30;1m796 | [0m[35m            docker network create determined[0m
[30;1m797 | [0m[35m[0m
[30;1m798 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m799 | [0m[35m            docker rm $(docker ps -a -q)[0m

[31m--[ [0m[34mMatch #[0m[33m1092[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m790 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m793 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m794 | [0m[35m            fi[0m
[30;1m795 | [0m[35m[0m
[30;1m796 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m1093[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m787 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m788 | [0m[35m               stable"[0m
[30;1m789 | [0m[35m            apt-get update[0m
[30;1m790 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m793 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m

[31m--[ [0m[34mMatch #[0m[33m1094[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m786 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m787 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m788 | [0m[35m               stable"[0m
[30;1m789 | [0m[35m            apt-get update[0m
[30;1m790 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1095[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m781 | [0m[35m                curl \[0m
[30;1m782 | [0m[35m                gnupg-agent \[0m
[30;1m783 | [0m[35m                software-properties-common[0m
[30;1m784 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m
[30;1m785 | [0m[35m            add-apt-repository \[0m
[30;1m786 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m787 | [0m[35m               $(lsb_release -cs) \[0m

[31m--[ [0m[34mMatch #[0m[33m1096[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m778 | [0m[35m            apt-get install -y \[0m
[30;1m779 | [0m[35m                apt-transport-https \[0m
[30;1m780 | [0m[35m                ca-certificates \[0m
[30;1m781 | [0m[35m                curl \[0m
[30;1m782 | [0m[35m                gnupg-agent \[0m
[30;1m783 | [0m[35m                software-properties-common[0m
[30;1m784 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m

[31m--[ [0m[34mMatch #[0m[33m1097[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m777 | [0m[35m            apt-get update[0m
[30;1m778 | [0m[35m            apt-get install -y \[0m
[30;1m779 | [0m[35m                apt-transport-https \[0m
[30;1m780 | [0m[35m                ca-certificates \[0m
[30;1m781 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1098[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m774 | [0m[35m            EOF[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m777 | [0m[35m            apt-get update[0m
[30;1m778 | [0m[35m            apt-get install -y \[0m
[30;1m779 | [0m[35m                apt-transport-https \[0m
[30;1m780 | [0m[35m                ca-certificates \[0m

[31m--[ [0m[34mMatch #[0m[33m1099[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m773 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m774 | [0m[35m            EOF[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m777 | [0m[35m            apt-get update[0m
[30;1m778 | [0m[35m            apt-get install -y \[0m
[30;1m779 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1100[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m773 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m774 | [0m[35m            EOF[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m777 | [0m[35m            apt-get update[0m
[30;1m778 | [0m[35m            apt-get install -y \[0m
[30;1m779 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1101[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m761 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m762 | [0m[35m                startup_script: |[0m
[30;1m763 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m764 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m765 | [0m[35m                  fi[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m1102[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m705 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m706 | [0m[35m            EOF[0m
[30;1m707 | [0m[35m[0m
[30;1m708 | [0m[35m            cat << EOF > /usr/local/determined/etc/master.yaml.context[0m
[30;1m709 | [0m[35m            checkpoint_storage:[0m
[30;1m710 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m711 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1103[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m701 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m702 | [0m[35m            fi[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m
[30;1m705 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m706 | [0m[35m            EOF[0m
[30;1m707 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1104[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m698 | [0m[35m              scheme=https[0m
[30;1m699 | [0m[35m              port=8443[0m
[30;1m700 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m701 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m702 | [0m[35m            fi[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1105[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m698 | [0m[35m              scheme=https[0m
[30;1m699 | [0m[35m              port=8443[0m
[30;1m700 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m701 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m702 | [0m[35m            fi[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1106[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m697 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m698 | [0m[35m              scheme=https[0m
[30;1m699 | [0m[35m              port=8443[0m
[30;1m700 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m701 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m702 | [0m[35m            fi[0m
[30;1m703 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1107[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m697 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m698 | [0m[35m              scheme=https[0m
[30;1m699 | [0m[35m              port=8443[0m
[30;1m700 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m701 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m702 | [0m[35m            fi[0m
[30;1m703 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1108[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m  GpuEnvImage:[0m
[30;1m214 | [0m[35m    Type: String[0m
[30;1m215 | [0m[35m    Description: Docker image for GPU tasks[0m
[30;1m216 | [0m[35m    Default: ""[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m  LogGroupPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1109[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m  CpuEnvImage:[0m
[30;1m209 | [0m[35m    Type: String[0m
[30;1m210 | [0m[35m    Description: Docker image for CPU tasks[0m
[30;1m211 | [0m[35m    Default: ""[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m  GpuEnvImage:[0m

[31m--[ [0m[34mMatch #[0m[33m1110[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m  AgentReconnectBackoff:[0m
[30;1m194 | [0m[35m    Type: Number[0m
[30;1m195 | [0m[35m    Description: Time between reconnect attempts, with the exception of the first.[0m
[30;1m196 | [0m[35m    Default: 5[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m  AgentConfigFileContents:[0m

[31m--[ [0m[34mMatch #[0m[33m1111[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m  Version:[0m
[30;1m95 | [0m[35m    Type: String[0m
[30;1m96 | [0m[35m    Description: Determined version or commit for master docker image[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m  DBPassword:[0m
[30;1m99 | [0m[35m    Type: String[0m

[31m--[ [0m[34mMatch #[0m[33m1112[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  DockerPass:[0m
[30;1m89 | [0m[35m    Type: String[0m
[30;1m90 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m91 | [0m[35m    Default: ""[0m
[30;1m92 | [0m[35m    NoEcho: true[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1113[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m  DockerUser:[0m
[30;1m84 | [0m[35m    Type: String[0m
[30;1m85 | [0m[35m    Description: Docker user to pull images that need authentication[0m
[30;1m86 | [0m[35m    Default: ""[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  DockerPass:[0m

[31m--[ [0m[34mMatch #[0m[33m1114[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m  AgentImageName:[0m
[30;1m79 | [0m[35m    Type: String[0m
[30;1m80 | [0m[35m    Description: Name of the Docker image to use for the Determined agent[0m
[30;1m81 | [0m[35m    Default: determined-agent[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m  DockerUser:[0m

[31m--[ [0m[34mMatch #[0m[33m1115[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m  MasterImageName:[0m
[30;1m74 | [0m[35m    Type: String[0m
[30;1m75 | [0m[35m    Description: Name of the Docker image to use for the Determined master[0m
[30;1m76 | [0m[35m    Default: determined-master[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m  AgentImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1116[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m  ImageRepoPrefix:[0m
[30;1m69 | [0m[35m    Type: String[0m
[30;1m70 | [0m[35m    Description: Docker image repository to use for determined-master and determined-agent images[0m
[30;1m71 | [0m[35m    Default: determinedai[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m  MasterImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1117[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m  InboundCIDRRange:[0m
[30;1m59 | [0m[35m    Type: String[0m
[30;1m60 | [0m[35m    Description: Ip range for Inbound[0m
[30;1m61 | [0m[35m    Default: 0.0.0.0/0[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m  SubnetId:[0m

[31m--[ [0m[34mMatch #[0m[33m1118[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple-rds.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35mParameters:[0m
[30;1m39 | [0m[35m  Keypair:[0m
[30;1m40 | [0m[35m    Type: AWS::EC2::KeyPair::KeyName[0m
[30;1m41 | [0m[35m    Description: Keypair to SSH[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m  MasterInstanceType:[0m
[30;1m44 | [0m[35m    Type: String[0m
[30;1m45 | [0m[35m    Description: Instance Type of Master[0m

[31m--[ [0m[34mMatch #[0m[33m1119[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/tensorboard.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m123 | [0m[35m                        "--trial-ids",[0m
[30;1m124 | [0m[35m                        nargs=argparse.ONE_OR_MORE,[0m
[30;1m125 | [0m[35m                        type=int,[0m
[30;1m126 | [0m[35m                        help="trial IDs to load into TensorBoard; at most 100 trials are "[0m
[30;1m127 | [0m[35m                        "allowed per TensorBoard instance",[0m
[30;1m128 | [0m[35m                    ),[0m
[30;1m129 | [0m[35m                    cli.workspace.workspace_arg,[0m

[31m--[ [0m[34mMatch #[0m[33m1120[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/tensorboard.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m                        "experiment_ids",[0m
[30;1m114 | [0m[35m                        type=int,[0m
[30;1m115 | [0m[35m                        nargs="*",[0m
[30;1m116 | [0m[35m                        help="experiment IDs to load into TensorBoard. At most 100 trials from "[0m
[30;1m117 | [0m[35m                        "the specified experiment will be loaded into TensorBoard. If the "[0m
[30;1m118 | [0m[35m                        "experiment has more trials, the 100 best-performing trials will "[0m
[30;1m119 | [0m[35m                        "be used.",[0m

[31m--[ [0m[34mMatch #[0m[33m1121[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/project.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom typing import Any, Dict, List, Sequence, Tuple[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom determined import cli[0m
[30;1m6 | [0m[35mfrom determined.cli import render, workspace[0m

[31m--[ [0m[34mMatch #[0m[33m1122[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m933 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m934 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m935 | [0m[35m               stable"[0m
[30;1m936 | [0m[35m            apt-get update[0m
[30;1m937 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m940 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1123[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m921 | [0m[35m            EOF[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m924 | [0m[35m            apt-get update[0m
[30;1m925 | [0m[35m            apt-get install -y \[0m
[30;1m926 | [0m[35m                apt-transport-https \[0m
[30;1m927 | [0m[35m                ca-certificates \[0m
[30;1m928 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1124[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m958 | [0m[35m                -c "/usr/bin/determined-gotmpl -i /etc/determined/master.yaml.context /etc/determine[0m
[30;1m959 | [0m[35m            test $? -eq 0 || ( echo "Failed to generate master.yaml" && exit 1 )[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m            docker run \[0m
[30;1m962 | [0m[35m                --name determined-master \[0m
[30;1m963 | [0m[35m                --network determined \[0m
[30;1m964 | [0m[35m                --restart unless-stopped \[0m

[31m--[ [0m[34mMatch #[0m[33m1125[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m949 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m950 | [0m[35m[0m
[30;1m951 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m952 | [0m[35m            docker run \[0m
[30;1m953 | [0m[35m                --name determined-master-configurator \[0m
[30;1m954 | [0m[35m                --rm \[0m
[30;1m955 | [0m[35m                -v /usr/local/determined/etc/:/etc/determined/ \[0m

[31m--[ [0m[34mMatch #[0m[33m1126[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m946 | [0m[35m            docker network create determined[0m
[30;1m947 | [0m[35m[0m
[30;1m948 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m949 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m950 | [0m[35m[0m
[30;1m951 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m952 | [0m[35m            docker run \[0m

[31m--[ [0m[34mMatch #[0m[33m1127[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m945 | [0m[35m[0m
[30;1m946 | [0m[35m            docker network create determined[0m
[30;1m947 | [0m[35m[0m
[30;1m948 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m949 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m950 | [0m[35m[0m
[30;1m951 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m

[31m--[ [0m[34mMatch #[0m[33m1128[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m943 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m944 | [0m[35m            fi[0m
[30;1m945 | [0m[35m[0m
[30;1m946 | [0m[35m            docker network create determined[0m
[30;1m947 | [0m[35m[0m
[30;1m948 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m949 | [0m[35m            docker rm $(docker ps -a -q)[0m

[31m--[ [0m[34mMatch #[0m[33m1129[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m940 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m943 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m944 | [0m[35m            fi[0m
[30;1m945 | [0m[35m[0m
[30;1m946 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m1130[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m936 | [0m[35m            apt-get update[0m
[30;1m937 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m940 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1131[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m934 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m935 | [0m[35m               stable"[0m
[30;1m936 | [0m[35m            apt-get update[0m
[30;1m937 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m940 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1132[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m933 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m934 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m935 | [0m[35m               stable"[0m
[30;1m936 | [0m[35m            apt-get update[0m
[30;1m937 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m

[31m--[ [0m[34mMatch #[0m[33m1133[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m928 | [0m[35m                curl \[0m
[30;1m929 | [0m[35m                gnupg-agent \[0m
[30;1m930 | [0m[35m                software-properties-common[0m
[30;1m931 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m
[30;1m932 | [0m[35m            add-apt-repository \[0m
[30;1m933 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m934 | [0m[35m               $(lsb_release -cs) \[0m

[31m--[ [0m[34mMatch #[0m[33m1134[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m925 | [0m[35m            apt-get install -y \[0m
[30;1m926 | [0m[35m                apt-transport-https \[0m
[30;1m927 | [0m[35m                ca-certificates \[0m
[30;1m928 | [0m[35m                curl \[0m
[30;1m929 | [0m[35m                gnupg-agent \[0m
[30;1m930 | [0m[35m                software-properties-common[0m
[30;1m931 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m

[31m--[ [0m[34mMatch #[0m[33m1135[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m924 | [0m[35m            apt-get update[0m
[30;1m925 | [0m[35m            apt-get install -y \[0m
[30;1m926 | [0m[35m                apt-transport-https \[0m
[30;1m927 | [0m[35m                ca-certificates \[0m
[30;1m928 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1136[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m921 | [0m[35m            EOF[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m924 | [0m[35m            apt-get update[0m
[30;1m925 | [0m[35m            apt-get install -y \[0m
[30;1m926 | [0m[35m                apt-transport-https \[0m
[30;1m927 | [0m[35m                ca-certificates \[0m

[31m--[ [0m[34mMatch #[0m[33m1137[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m920 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m921 | [0m[35m            EOF[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m924 | [0m[35m            apt-get update[0m
[30;1m925 | [0m[35m            apt-get install -y \[0m
[30;1m926 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1138[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m920 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m921 | [0m[35m            EOF[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m924 | [0m[35m            apt-get update[0m
[30;1m925 | [0m[35m            apt-get install -y \[0m
[30;1m926 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1139[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m908 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m909 | [0m[35m                startup_script: |[0m
[30;1m910 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m911 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m912 | [0m[35m                  fi[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m1140[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m856 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m857 | [0m[35m            EOF[0m
[30;1m858 | [0m[35m[0m
[30;1m859 | [0m[35m            cat << EOF > /usr/local/determined/etc/master.yaml.context[0m
[30;1m860 | [0m[35m            checkpoint_storage:[0m
[30;1m861 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m862 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1141[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m852 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m853 | [0m[35m            fi[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m
[30;1m856 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m857 | [0m[35m            EOF[0m
[30;1m858 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1142[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m849 | [0m[35m              scheme=https[0m
[30;1m850 | [0m[35m              port=8443[0m
[30;1m851 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m852 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m853 | [0m[35m            fi[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1143[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m849 | [0m[35m              scheme=https[0m
[30;1m850 | [0m[35m              port=8443[0m
[30;1m851 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m852 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m853 | [0m[35m            fi[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1144[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m848 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m849 | [0m[35m              scheme=https[0m
[30;1m850 | [0m[35m              port=8443[0m
[30;1m851 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m852 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m853 | [0m[35m            fi[0m
[30;1m854 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1145[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m848 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m849 | [0m[35m              scheme=https[0m
[30;1m850 | [0m[35m              port=8443[0m
[30;1m851 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m852 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m853 | [0m[35m            fi[0m
[30;1m854 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1146[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m  GpuEnvImage:[0m
[30;1m210 | [0m[35m    Type: String[0m
[30;1m211 | [0m[35m    Description: Docker image for GPU tasks[0m
[30;1m212 | [0m[35m    Default: ""[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m  LogGroupPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1147[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m  CpuEnvImage:[0m
[30;1m205 | [0m[35m    Type: String[0m
[30;1m206 | [0m[35m    Description: Docker image for CPU tasks[0m
[30;1m207 | [0m[35m    Default: ""[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m  GpuEnvImage:[0m

[31m--[ [0m[34mMatch #[0m[33m1148[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m  DockerPass:[0m
[30;1m118 | [0m[35m    Type: String[0m
[30;1m119 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m120 | [0m[35m    Default: ""[0m
[30;1m121 | [0m[35m    NoEcho: true[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1149[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m  DockerUser:[0m
[30;1m113 | [0m[35m    Type: String[0m
[30;1m114 | [0m[35m    Description: Docker user to pull images that need authentication[0m
[30;1m115 | [0m[35m    Default: ""[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m  DockerPass:[0m

[31m--[ [0m[34mMatch #[0m[33m1150[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m  AgentImageName:[0m
[30;1m108 | [0m[35m    Type: String[0m
[30;1m109 | [0m[35m    Description: Name of the Docker image to use for the Determined agent[0m
[30;1m110 | [0m[35m    Default: determined-agent[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m  DockerUser:[0m

[31m--[ [0m[34mMatch #[0m[33m1151[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m  MasterImageName:[0m
[30;1m103 | [0m[35m    Type: String[0m
[30;1m104 | [0m[35m    Description: Name of the Docker image to use for the Determined master[0m
[30;1m105 | [0m[35m    Default: determined-master[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m  AgentImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1152[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m  ImageRepoPrefix:[0m
[30;1m98 | [0m[35m    Type: String[0m
[30;1m99 | [0m[35m    Description: Docker image repository to use for determined-master and determined-agent images[0m
[30;1m100 | [0m[35m    Default: determinedai[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m  MasterImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1153[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m  InboundCIDRRange:[0m
[30;1m93 | [0m[35m    Type: String[0m
[30;1m94 | [0m[35m    Description: Ip range for Inbound[0m
[30;1m95 | [0m[35m    Default: 0.0.0.0/0[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m  ImageRepoPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1154[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m    Default: 10.192.20.0/24[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m  PrivateSubnet2CIDR:[0m
[30;1m64 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the private subnet in the second Avai[0m
[30;1m65 | [0m[35m    Type: String[0m
[30;1m66 | [0m[35m    Default: 10.192.21.0/24[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1155[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m    Default: 10.192.10.0/24[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m  PrivateSubnet1CIDR:[0m
[30;1m59 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the private subnet in the first Avail[0m
[30;1m60 | [0m[35m    Type: String[0m
[30;1m61 | [0m[35m    Default: 10.192.20.0/24[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1156[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m    Default: 10.192.0.0/16[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m  PublicSubnetCIDR:[0m
[30;1m54 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the public subnet in the first Availa[0m
[30;1m55 | [0m[35m    Type: String[0m
[30;1m56 | [0m[35m    Default: 10.192.10.0/24[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1157[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/secure.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mParameters:[0m
[30;1m48 | [0m[35m  VpcCIDR:[0m
[30;1m49 | [0m[35m    Description: Please enter the IP range (CIDR notation) for this VPC[0m
[30;1m50 | [0m[35m    Type: String[0m
[30;1m51 | [0m[35m    Default: 10.192.0.0/16[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1158[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m                    "drain": drain_mode,[0m
[30;1m190 | [0m[35m                }[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m            sess.post(path, json=payload)[0m
[30;1m193 | [0m[35m            status = "Disabled" if not enabled else "Enabled"[0m
[30;1m194 | [0m[35m            print(f"{status} agent {agent_id}.", file=sys.stderr)[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1159[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m929 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m930 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m931 | [0m[35m               stable"[0m
[30;1m932 | [0m[35m            apt-get update[0m
[30;1m933 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m936 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1160[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m917 | [0m[35m            EOF[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m920 | [0m[35m            apt-get update[0m
[30;1m921 | [0m[35m            apt-get install -y \[0m
[30;1m922 | [0m[35m                apt-transport-https \[0m
[30;1m923 | [0m[35m                ca-certificates \[0m
[30;1m924 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1161[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1020 | [0m[35m    Value: !Ref Version[0m
[30;1m1021 | [0m[35m[0m
[30;1m1022 | [0m[35m  DeterminedAddress:[0m
[30;1m1023 | [0m[35m    Description: Ip address of Determined Master[0m
[30;1m1024 | [0m[35m    Value: !GetAtt MasterInstance.PublicDnsName[0m
[30;1m1025 | [0m[35m[0m
[30;1m1026 | [0m[35m  MasterPort:[0m

[31m--[ [0m[34mMatch #[0m[33m1162[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m954 | [0m[35m                -c "/usr/bin/determined-gotmpl -i /etc/determined/master.yaml.context /etc/determine[0m
[30;1m955 | [0m[35m            test $? -eq 0 || ( echo "Failed to generate master.yaml" && exit 1 )[0m
[30;1m956 | [0m[35m[0m
[30;1m957 | [0m[35m            docker run \[0m
[30;1m958 | [0m[35m                --name determined-master \[0m
[30;1m959 | [0m[35m                --network determined \[0m
[30;1m960 | [0m[35m                --restart unless-stopped \[0m

[31m--[ [0m[34mMatch #[0m[33m1163[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m945 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m946 | [0m[35m[0m
[30;1m947 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m948 | [0m[35m            docker run \[0m
[30;1m949 | [0m[35m                --name determined-master-configurator \[0m
[30;1m950 | [0m[35m                --rm \[0m
[30;1m951 | [0m[35m                -v /usr/local/determined/etc/:/etc/determined/ \[0m

[31m--[ [0m[34mMatch #[0m[33m1164[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m942 | [0m[35m            docker network create determined[0m
[30;1m943 | [0m[35m[0m
[30;1m944 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m945 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m946 | [0m[35m[0m
[30;1m947 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m948 | [0m[35m            docker run \[0m

[31m--[ [0m[34mMatch #[0m[33m1165[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m            docker network create determined[0m
[30;1m943 | [0m[35m[0m
[30;1m944 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m945 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m946 | [0m[35m[0m
[30;1m947 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m

[31m--[ [0m[34mMatch #[0m[33m1166[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m939 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m940 | [0m[35m            fi[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m            docker network create determined[0m
[30;1m943 | [0m[35m[0m
[30;1m944 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m945 | [0m[35m            docker rm $(docker ps -a -q)[0m

[31m--[ [0m[34mMatch #[0m[33m1167[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m936 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m937 | [0m[35m[0m
[30;1m938 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m939 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m940 | [0m[35m            fi[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m1168[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m932 | [0m[35m            apt-get update[0m
[30;1m933 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m936 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m937 | [0m[35m[0m
[30;1m938 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1169[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m930 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m931 | [0m[35m               stable"[0m
[30;1m932 | [0m[35m            apt-get update[0m
[30;1m933 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m936 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1170[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m929 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m930 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m931 | [0m[35m               stable"[0m
[30;1m932 | [0m[35m            apt-get update[0m
[30;1m933 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m

[31m--[ [0m[34mMatch #[0m[33m1171[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m924 | [0m[35m                curl \[0m
[30;1m925 | [0m[35m                gnupg-agent \[0m
[30;1m926 | [0m[35m                software-properties-common[0m
[30;1m927 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m
[30;1m928 | [0m[35m            add-apt-repository \[0m
[30;1m929 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m930 | [0m[35m               $(lsb_release -cs) \[0m

[31m--[ [0m[34mMatch #[0m[33m1172[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m921 | [0m[35m            apt-get install -y \[0m
[30;1m922 | [0m[35m                apt-transport-https \[0m
[30;1m923 | [0m[35m                ca-certificates \[0m
[30;1m924 | [0m[35m                curl \[0m
[30;1m925 | [0m[35m                gnupg-agent \[0m
[30;1m926 | [0m[35m                software-properties-common[0m
[30;1m927 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m

[31m--[ [0m[34mMatch #[0m[33m1173[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m920 | [0m[35m            apt-get update[0m
[30;1m921 | [0m[35m            apt-get install -y \[0m
[30;1m922 | [0m[35m                apt-transport-https \[0m
[30;1m923 | [0m[35m                ca-certificates \[0m
[30;1m924 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1174[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m917 | [0m[35m            EOF[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m920 | [0m[35m            apt-get update[0m
[30;1m921 | [0m[35m            apt-get install -y \[0m
[30;1m922 | [0m[35m                apt-transport-https \[0m
[30;1m923 | [0m[35m                ca-certificates \[0m

[31m--[ [0m[34mMatch #[0m[33m1175[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m916 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m917 | [0m[35m            EOF[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m920 | [0m[35m            apt-get update[0m
[30;1m921 | [0m[35m            apt-get install -y \[0m
[30;1m922 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1176[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m916 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m917 | [0m[35m            EOF[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m920 | [0m[35m            apt-get update[0m
[30;1m921 | [0m[35m            apt-get install -y \[0m
[30;1m922 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1177[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m900 | [0m[35m                  mkdir -p /mnt/efs[0m
[30;1m901 | [0m[35m                  mount -t efs ${EFSVal}:/ /mnt/efs[0m
[30;1m902 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m903 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m904 | [0m[35m                  fi[0m
[30;1m905 | [0m[35m[0m
[30;1m906 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m1178[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m898 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m899 | [0m[35m                startup_script: |[0m
[30;1m900 | [0m[35m                  mkdir -p /mnt/efs[0m
[30;1m901 | [0m[35m                  mount -t efs ${EFSVal}:/ /mnt/efs[0m
[30;1m902 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m903 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m904 | [0m[35m                  fi[0m

[31m--[ [0m[34mMatch #[0m[33m1179[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m842 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m843 | [0m[35m            EOF[0m
[30;1m844 | [0m[35m[0m
[30;1m845 | [0m[35m            cat << EOF > /usr/local/determined/etc/master.yaml.context[0m
[30;1m846 | [0m[35m            checkpoint_storage:[0m
[30;1m847 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m848 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1180[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m838 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m839 | [0m[35m            fi[0m
[30;1m840 | [0m[35m[0m
[30;1m841 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m
[30;1m842 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m843 | [0m[35m            EOF[0m
[30;1m844 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1181[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m835 | [0m[35m              scheme=https[0m
[30;1m836 | [0m[35m              port=8443[0m
[30;1m837 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m838 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m839 | [0m[35m            fi[0m
[30;1m840 | [0m[35m[0m
[30;1m841 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1182[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m835 | [0m[35m              scheme=https[0m
[30;1m836 | [0m[35m              port=8443[0m
[30;1m837 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m838 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m839 | [0m[35m            fi[0m
[30;1m840 | [0m[35m[0m
[30;1m841 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1183[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m834 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m835 | [0m[35m              scheme=https[0m
[30;1m836 | [0m[35m              port=8443[0m
[30;1m837 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m838 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m839 | [0m[35m            fi[0m
[30;1m840 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1184[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m834 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m835 | [0m[35m              scheme=https[0m
[30;1m836 | [0m[35m              port=8443[0m
[30;1m837 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m838 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m839 | [0m[35m            fi[0m
[30;1m840 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1185[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m  MountEFSId:[0m
[30;1m224 | [0m[35m    Type: String[0m
[30;1m225 | [0m[35m    Description: preexisting EFS ID to mount[0m
[30;1m226 | [0m[35m    Default: ""[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m  InitialUserPassword:[0m
[30;1m229 | [0m[35m    Type: String[0m

[31m--[ [0m[34mMatch #[0m[33m1186[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m  GpuEnvImage:[0m
[30;1m209 | [0m[35m    Type: String[0m
[30;1m210 | [0m[35m    Description: Docker image for GPU tasks[0m
[30;1m211 | [0m[35m    Default: ""[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m  LogGroupPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1187[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m  CpuEnvImage:[0m
[30;1m204 | [0m[35m    Type: String[0m
[30;1m205 | [0m[35m    Description: Docker image for CPU tasks[0m
[30;1m206 | [0m[35m    Default: ""[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m  GpuEnvImage:[0m

[31m--[ [0m[34mMatch #[0m[33m1188[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m  AgentReconnectBackoff:[0m
[30;1m189 | [0m[35m    Type: Number[0m
[30;1m190 | [0m[35m    Description: Time between reconnect attempts, with the exception of the first.[0m
[30;1m191 | [0m[35m    Default: 5[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m  AgentConfigFileContents:[0m

[31m--[ [0m[34mMatch #[0m[33m1189[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m
[30;1m97 | [0m[35m    Type: String[0m
[30;1m98 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m99 | [0m[35m    Default: ""[0m
[30;1m100 | [0m[35m    NoEcho: true[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1190[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m  DockerUser:[0m
[30;1m92 | [0m[35m    Type: String[0m
[30;1m93 | [0m[35m    Description: Docker user to pull images that need authentication[0m
[30;1m94 | [0m[35m    Default: ""[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m

[31m--[ [0m[34mMatch #[0m[33m1191[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m  AgentImageName:[0m
[30;1m87 | [0m[35m    Type: String[0m
[30;1m88 | [0m[35m    Description: Name of the Docker image to use for the Determined agent[0m
[30;1m89 | [0m[35m    Default: determined-agent[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m  DockerUser:[0m

[31m--[ [0m[34mMatch #[0m[33m1192[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m  MasterImageName:[0m
[30;1m82 | [0m[35m    Type: String[0m
[30;1m83 | [0m[35m    Description: Name of the Docker image to use for the Determined master[0m
[30;1m84 | [0m[35m    Default: determined-master[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m  AgentImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1193[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m  ImageRepoPrefix:[0m
[30;1m77 | [0m[35m    Type: String[0m
[30;1m78 | [0m[35m    Description: Docker image repository to use for determined-master and determined-agent images[0m
[30;1m79 | [0m[35m    Default: determinedai[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m  MasterImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1194[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m  InboundCIDRRange:[0m
[30;1m72 | [0m[35m    Type: String[0m
[30;1m73 | [0m[35m    Description: Ip range for Inbound[0m
[30;1m74 | [0m[35m    Default: 0.0.0.0/0[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m  ImageRepoPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1195[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    Default: 10.192.10.0/24[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m  Subnet2CIDR:[0m
[30;1m48 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the public subnet in the second Avail[0m
[30;1m49 | [0m[35m    Type: String[0m
[30;1m50 | [0m[35m    Default: 10.192.11.0/24[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1196[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    Default: 10.192.0.0/16[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m  Subnet1CIDR:[0m
[30;1m43 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the public subnet in the first Availa[0m
[30;1m44 | [0m[35m    Type: String[0m
[30;1m45 | [0m[35m    Default: 10.192.10.0/24[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1197[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/efs.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mParameters:[0m
[30;1m37 | [0m[35m  VpcCIDR:[0m
[30;1m38 | [0m[35m    Description: Please enter the IP range (CIDR notation) for this VPC[0m
[30;1m39 | [0m[35m    Type: String[0m
[30;1m40 | [0m[35m    Default: 10.192.0.0/16[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1198[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    path = ([0m
[30;1m39 | [0m[35m        "api/v1/resources/allocation/aggregated" if args.json else "resources/allocation/aggregated"[0m
[30;1m40 | [0m[35m    )[0m
[30;1m41 | [0m[35m    print_response(sess.get(path, params=params))[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35margs_description: cli.ArgsDescription = [[0m

[31m--[ [0m[34mMatch #[0m[33m1199[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m24 | [0m[35m    params = {"timestamp_after": args.timestamp_after, "timestamp_before": args.timestamp_before}[0m
[30;1m25 | [0m[35m    path = "api/v1/resources/allocation/raw" if args.json else "resources/allocation/raw"[0m
[30;1m26 | [0m[35m    print_response(sess.get(path, params=params))[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mdef aggregated(args: argparse.Namespace) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1200[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m    sess = cli.setup_session(args)[0m
[30;1m17 | [0m[35m    params = {"timestamp_after": args.timestamp_after, "timestamp_before": args.timestamp_before}[0m
[30;1m18 | [0m[35m    path = "resources/allocation/allocations-csv"[0m
[30;1m19 | [0m[35m    print_response(sess.get(path, params=params))[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mdef raw(args: argparse.Namespace) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1201[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/resources.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35m            cli.Cmd([0m
[30;1m51 | [0m[35m                "alloc|ations",[0m
[30;1m52 | [0m[35m                csv,[0m
[30;1m53 | [0m[35m                "get a detailed csv of resource allocation at an allocation level",[0m
[30;1m54 | [0m[35m                [[0m
[30;1m55 | [0m[35m                    cli.Arg("timestamp_after"),[0m
[30;1m56 | [0m[35m                    cli.Arg("timestamp_before"),[0m

[31m--[ [0m[34mMatch #[0m[33m1202[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m729 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m730 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m731 | [0m[35m               stable"[0m
[30;1m732 | [0m[35m            apt-get update[0m
[30;1m733 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m            curl -fsSL https://s3.us-gov-west-1.amazonaws.com/rds-downloads/rds-combined-ca-us-gov-b[0m
[30;1m736 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1203[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m717 | [0m[35m            EOF[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m720 | [0m[35m            apt-get update[0m
[30;1m721 | [0m[35m            apt-get install -y \[0m
[30;1m722 | [0m[35m                apt-transport-https \[0m
[30;1m723 | [0m[35m                ca-certificates \[0m
[30;1m724 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1204[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m808 | [0m[35m    Value: !Ref Version[0m
[30;1m809 | [0m[35m[0m
[30;1m810 | [0m[35m  DeterminedAddress:[0m
[30;1m811 | [0m[35m    Description: Ip address of Determined Master[0m
[30;1m812 | [0m[35m    Value: !GetAtt MasterInstance.PublicDnsName[0m
[30;1m813 | [0m[35m[0m
[30;1m814 | [0m[35m  MasterPort:[0m

[31m--[ [0m[34mMatch #[0m[33m1205[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m754 | [0m[35m                -c "/usr/bin/determined-gotmpl -i /etc/determined/master.yaml.context /etc/determine[0m
[30;1m755 | [0m[35m            test $? -eq 0 || ( echo "Failed to generate master.yaml" && exit 1 )[0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m            docker run \[0m
[30;1m758 | [0m[35m                --name determined-master \[0m
[30;1m759 | [0m[35m                --network determined \[0m
[30;1m760 | [0m[35m                --restart unless-stopped \[0m

[31m--[ [0m[34mMatch #[0m[33m1206[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m745 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m746 | [0m[35m[0m
[30;1m747 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m748 | [0m[35m            docker run \[0m
[30;1m749 | [0m[35m                --name determined-master-configurator \[0m
[30;1m750 | [0m[35m                --rm \[0m
[30;1m751 | [0m[35m                -v /usr/local/determined/etc/:/etc/determined/ \[0m

[31m--[ [0m[34mMatch #[0m[33m1207[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m742 | [0m[35m            docker network create determined[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m745 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m746 | [0m[35m[0m
[30;1m747 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m748 | [0m[35m            docker run \[0m

[31m--[ [0m[34mMatch #[0m[33m1208[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m741 | [0m[35m[0m
[30;1m742 | [0m[35m            docker network create determined[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m745 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m746 | [0m[35m[0m
[30;1m747 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m

[31m--[ [0m[34mMatch #[0m[33m1209[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m739 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m740 | [0m[35m            fi[0m
[30;1m741 | [0m[35m[0m
[30;1m742 | [0m[35m            docker network create determined[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m745 | [0m[35m            docker rm $(docker ps -a -q)[0m

[31m--[ [0m[34mMatch #[0m[33m1210[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m736 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m739 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m740 | [0m[35m            fi[0m
[30;1m741 | [0m[35m[0m
[30;1m742 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m1211[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m732 | [0m[35m            apt-get update[0m
[30;1m733 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m            curl -fsSL https://s3.us-gov-west-1.amazonaws.com/rds-downloads/rds-combined-ca-us-gov-b[0m
[30;1m736 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1212[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m730 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m731 | [0m[35m               stable"[0m
[30;1m732 | [0m[35m            apt-get update[0m
[30;1m733 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m            curl -fsSL https://s3.us-gov-west-1.amazonaws.com/rds-downloads/rds-combined-ca-us-gov-b[0m
[30;1m736 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1213[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m729 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m730 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m731 | [0m[35m               stable"[0m
[30;1m732 | [0m[35m            apt-get update[0m
[30;1m733 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m            curl -fsSL https://s3.us-gov-west-1.amazonaws.com/rds-downloads/rds-combined-ca-us-gov-b[0m

[31m--[ [0m[34mMatch #[0m[33m1214[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m724 | [0m[35m                curl \[0m
[30;1m725 | [0m[35m                gnupg-agent \[0m
[30;1m726 | [0m[35m                software-properties-common[0m
[30;1m727 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m
[30;1m728 | [0m[35m            add-apt-repository \[0m
[30;1m729 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m730 | [0m[35m               $(lsb_release -cs) \[0m

[31m--[ [0m[34mMatch #[0m[33m1215[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m721 | [0m[35m            apt-get install -y \[0m
[30;1m722 | [0m[35m                apt-transport-https \[0m
[30;1m723 | [0m[35m                ca-certificates \[0m
[30;1m724 | [0m[35m                curl \[0m
[30;1m725 | [0m[35m                gnupg-agent \[0m
[30;1m726 | [0m[35m                software-properties-common[0m
[30;1m727 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m

[31m--[ [0m[34mMatch #[0m[33m1216[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m720 | [0m[35m            apt-get update[0m
[30;1m721 | [0m[35m            apt-get install -y \[0m
[30;1m722 | [0m[35m                apt-transport-https \[0m
[30;1m723 | [0m[35m                ca-certificates \[0m
[30;1m724 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1217[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m717 | [0m[35m            EOF[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m720 | [0m[35m            apt-get update[0m
[30;1m721 | [0m[35m            apt-get install -y \[0m
[30;1m722 | [0m[35m                apt-transport-https \[0m
[30;1m723 | [0m[35m                ca-certificates \[0m

[31m--[ [0m[34mMatch #[0m[33m1218[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m716 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m717 | [0m[35m            EOF[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m720 | [0m[35m            apt-get update[0m
[30;1m721 | [0m[35m            apt-get install -y \[0m
[30;1m722 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1219[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m716 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m717 | [0m[35m            EOF[0m
[30;1m718 | [0m[35m[0m
[30;1m719 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m720 | [0m[35m            apt-get update[0m
[30;1m721 | [0m[35m            apt-get install -y \[0m
[30;1m722 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1220[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m704 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m705 | [0m[35m                startup_script: |[0m
[30;1m706 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m707 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m708 | [0m[35m                  fi[0m
[30;1m709 | [0m[35m[0m
[30;1m710 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m1221[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m652 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m653 | [0m[35m            EOF[0m
[30;1m654 | [0m[35m[0m
[30;1m655 | [0m[35m            cat << EOF > /usr/local/determined/etc/master.yaml.context[0m
[30;1m656 | [0m[35m            checkpoint_storage:[0m
[30;1m657 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m658 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1222[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m648 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m649 | [0m[35m            fi[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m
[30;1m652 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m653 | [0m[35m            EOF[0m
[30;1m654 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1223[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m645 | [0m[35m              scheme=https[0m
[30;1m646 | [0m[35m              port=8443[0m
[30;1m647 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m648 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m649 | [0m[35m            fi[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1224[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m645 | [0m[35m              scheme=https[0m
[30;1m646 | [0m[35m              port=8443[0m
[30;1m647 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m648 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m649 | [0m[35m            fi[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1225[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m644 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m645 | [0m[35m              scheme=https[0m
[30;1m646 | [0m[35m              port=8443[0m
[30;1m647 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m648 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m649 | [0m[35m            fi[0m
[30;1m650 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1226[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m644 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m645 | [0m[35m              scheme=https[0m
[30;1m646 | [0m[35m              port=8443[0m
[30;1m647 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m648 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m649 | [0m[35m            fi[0m
[30;1m650 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1227[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m  GpuEnvImage:[0m
[30;1m155 | [0m[35m    Type: String[0m
[30;1m156 | [0m[35m    Description: Docker image for GPU tasks[0m
[30;1m157 | [0m[35m    Default: ""[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m  LogGroupPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1228[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m  CpuEnvImage:[0m
[30;1m150 | [0m[35m    Type: String[0m
[30;1m151 | [0m[35m    Description: Docker image for CPU tasks[0m
[30;1m152 | [0m[35m    Default: ""[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m  GpuEnvImage:[0m

[31m--[ [0m[34mMatch #[0m[33m1229[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m  Version:[0m
[30;1m69 | [0m[35m    Type: String[0m
[30;1m70 | [0m[35m    Description: Determined version or commit for master docker image[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m  DBPassword:[0m
[30;1m73 | [0m[35m    Type: String[0m

[31m--[ [0m[34mMatch #[0m[33m1230[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m  DockerPass:[0m
[30;1m63 | [0m[35m    Type: String[0m
[30;1m64 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m65 | [0m[35m    Default: ""[0m
[30;1m66 | [0m[35m    NoEcho: true[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1231[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m  DockerUser:[0m
[30;1m58 | [0m[35m    Type: String[0m
[30;1m59 | [0m[35m    Description: Docker user to pull images that need authentication[0m
[30;1m60 | [0m[35m    Default: ""[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m  DockerPass:[0m

[31m--[ [0m[34mMatch #[0m[33m1232[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m  AgentImageName:[0m
[30;1m53 | [0m[35m    Type: String[0m
[30;1m54 | [0m[35m    Description: Name of the Docker image to use for the Determined agent[0m
[30;1m55 | [0m[35m    Default: determined-agent[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m  DockerUser:[0m

[31m--[ [0m[34mMatch #[0m[33m1233[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m  MasterImageName:[0m
[30;1m48 | [0m[35m    Type: String[0m
[30;1m49 | [0m[35m    Description: Name of the Docker image to use for the Determined master[0m
[30;1m50 | [0m[35m    Default: determined-master[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m  AgentImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1234[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m  ImageRepoPrefix:[0m
[30;1m43 | [0m[35m    Type: String[0m
[30;1m44 | [0m[35m    Description: Docker image repository to use for determined-master and determined-agent images[0m
[30;1m45 | [0m[35m    Default: determinedai[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m  MasterImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1235[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m  InboundCIDRRange:[0m
[30;1m33 | [0m[35m    Type: String[0m
[30;1m34 | [0m[35m    Description: Ip range for Inbound[0m
[30;1m35 | [0m[35m    Default: 0.0.0.0/0[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m  SubnetId:[0m

[31m--[ [0m[34mMatch #[0m[33m1236[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/govcloud.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35mParameters:[0m
[30;1m13 | [0m[35m  Keypair:[0m
[30;1m14 | [0m[35m    Type: AWS::EC2::KeyPair::KeyName[0m
[30;1m15 | [0m[35m    Description: Keypair to SSH[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m  MasterInstanceType:[0m
[30;1m18 | [0m[35m    Type: String[0m
[30;1m19 | [0m[35m    Description: Instance Type of Master[0m

[31m--[ [0m[34mMatch #[0m[33m1237[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/sso.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mdef list_providers(args: argparse.Namespace) -> None:[0m
[30;1m114 | [0m[35m    sess = cli.unauth_session(args)[0m
[30;1m115 | [0m[35m    master_info = sess.get("info").json()[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    try:[0m
[30;1m118 | [0m[35m        sso_providers = master_info["sso_providers"][0m

[31m--[ [0m[34mMatch #[0m[33m1238[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/sso.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35mdef sso(args: argparse.Namespace) -> None:[0m
[30;1m52 | [0m[35m    sess = cli.unauth_session(args)[0m
[30;1m53 | [0m[35m    master_info = sess.get("info").json()[0m
[30;1m54 | [0m[35m    try:[0m
[30;1m55 | [0m[35m        sso_providers = master_info["sso_providers"][0m
[30;1m56 | [0m[35m    except KeyError:[0m

[31m--[ [0m[34mMatch #[0m[33m1239[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/sso.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mdef handle_token(sess: api.BaseSession, master_url: str, token: str) -> None:[0m
[30;1m17 | [0m[35m    tmp_auth = {"Cookie": "auth={token}".format(token=token)}[0m
[30;1m18 | [0m[35m    me = sess.get("/users/me", headers=tmp_auth).json()[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    token_store = authentication.TokenStore(master_url)[0m
[30;1m21 | [0m[35m    token_store.set_token(me["username"], token)[0m

[31m--[ [0m[34mMatch #[0m[33m1240[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/v1file_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport pathlib[0m
[30;1m3 | [0m[35mimport tarfile[0m
[30;1m4 | [0m[35mfrom typing import Any, Dict[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1241[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m949 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m950 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m951 | [0m[35m               stable"[0m
[30;1m952 | [0m[35m            apt-get update[0m
[30;1m953 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m954 | [0m[35m[0m
[30;1m955 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m956 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1242[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m937 | [0m[35m            EOF[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m940 | [0m[35m            apt-get update[0m
[30;1m941 | [0m[35m            apt-get install -y \[0m
[30;1m942 | [0m[35m                apt-transport-https \[0m
[30;1m943 | [0m[35m                ca-certificates \[0m
[30;1m944 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1243[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1040 | [0m[35m    Value: !Ref Version[0m
[30;1m1041 | [0m[35m[0m
[30;1m1042 | [0m[35m  DeterminedAddress:[0m
[30;1m1043 | [0m[35m    Description: Ip address of Determined Master[0m
[30;1m1044 | [0m[35m    Value: !GetAtt MasterInstance.PublicDnsName[0m
[30;1m1045 | [0m[35m[0m
[30;1m1046 | [0m[35m  MasterPort:[0m

[31m--[ [0m[34mMatch #[0m[33m1244[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m974 | [0m[35m                -c "/usr/bin/determined-gotmpl -i /etc/determined/master.yaml.context /etc/determine[0m
[30;1m975 | [0m[35m            test $? -eq 0 || ( echo "Failed to generate master.yaml" && exit 1 )[0m
[30;1m976 | [0m[35m[0m
[30;1m977 | [0m[35m            docker run \[0m
[30;1m978 | [0m[35m                --name determined-master \[0m
[30;1m979 | [0m[35m                --network determined \[0m
[30;1m980 | [0m[35m                --restart unless-stopped \[0m

[31m--[ [0m[34mMatch #[0m[33m1245[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m965 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m966 | [0m[35m[0m
[30;1m967 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m968 | [0m[35m            docker run \[0m
[30;1m969 | [0m[35m                --name determined-master-configurator \[0m
[30;1m970 | [0m[35m                --rm \[0m
[30;1m971 | [0m[35m                -v /usr/local/determined/etc/:/etc/determined/ \[0m

[31m--[ [0m[34mMatch #[0m[33m1246[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m962 | [0m[35m            docker network create determined[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m965 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m966 | [0m[35m[0m
[30;1m967 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m968 | [0m[35m            docker run \[0m

[31m--[ [0m[34mMatch #[0m[33m1247[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m961 | [0m[35m[0m
[30;1m962 | [0m[35m            docker network create determined[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m965 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m966 | [0m[35m[0m
[30;1m967 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m

[31m--[ [0m[34mMatch #[0m[33m1248[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m959 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m960 | [0m[35m            fi[0m
[30;1m961 | [0m[35m[0m
[30;1m962 | [0m[35m            docker network create determined[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m965 | [0m[35m            docker rm $(docker ps -a -q)[0m

[31m--[ [0m[34mMatch #[0m[33m1249[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m956 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m957 | [0m[35m[0m
[30;1m958 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m959 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m960 | [0m[35m            fi[0m
[30;1m961 | [0m[35m[0m
[30;1m962 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m1250[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m952 | [0m[35m            apt-get update[0m
[30;1m953 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m954 | [0m[35m[0m
[30;1m955 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m956 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m957 | [0m[35m[0m
[30;1m958 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1251[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m950 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m951 | [0m[35m               stable"[0m
[30;1m952 | [0m[35m            apt-get update[0m
[30;1m953 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m954 | [0m[35m[0m
[30;1m955 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m956 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1252[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m949 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m950 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m951 | [0m[35m               stable"[0m
[30;1m952 | [0m[35m            apt-get update[0m
[30;1m953 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m954 | [0m[35m[0m
[30;1m955 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m

[31m--[ [0m[34mMatch #[0m[33m1253[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m944 | [0m[35m                curl \[0m
[30;1m945 | [0m[35m                gnupg-agent \[0m
[30;1m946 | [0m[35m                software-properties-common[0m
[30;1m947 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m
[30;1m948 | [0m[35m            add-apt-repository \[0m
[30;1m949 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m950 | [0m[35m               $(lsb_release -cs) \[0m

[31m--[ [0m[34mMatch #[0m[33m1254[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m941 | [0m[35m            apt-get install -y \[0m
[30;1m942 | [0m[35m                apt-transport-https \[0m
[30;1m943 | [0m[35m                ca-certificates \[0m
[30;1m944 | [0m[35m                curl \[0m
[30;1m945 | [0m[35m                gnupg-agent \[0m
[30;1m946 | [0m[35m                software-properties-common[0m
[30;1m947 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m

[31m--[ [0m[34mMatch #[0m[33m1255[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m940 | [0m[35m            apt-get update[0m
[30;1m941 | [0m[35m            apt-get install -y \[0m
[30;1m942 | [0m[35m                apt-transport-https \[0m
[30;1m943 | [0m[35m                ca-certificates \[0m
[30;1m944 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1256[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m937 | [0m[35m            EOF[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m940 | [0m[35m            apt-get update[0m
[30;1m941 | [0m[35m            apt-get install -y \[0m
[30;1m942 | [0m[35m                apt-transport-https \[0m
[30;1m943 | [0m[35m                ca-certificates \[0m

[31m--[ [0m[34mMatch #[0m[33m1257[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m936 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m937 | [0m[35m            EOF[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m940 | [0m[35m            apt-get update[0m
[30;1m941 | [0m[35m            apt-get install -y \[0m
[30;1m942 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1258[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m936 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m937 | [0m[35m            EOF[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m940 | [0m[35m            apt-get update[0m
[30;1m941 | [0m[35m            apt-get install -y \[0m
[30;1m942 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1259[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m920 | [0m[35m                  mkdir /mnt/fsx[0m
[30;1m921 | [0m[35m                  mount -t lustre -o noatime,flock ${FSxVal} /mnt/fsx[0m
[30;1m922 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m923 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m924 | [0m[35m                  fi[0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m1260[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m918 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m919 | [0m[35m                startup_script: |[0m
[30;1m920 | [0m[35m                  mkdir /mnt/fsx[0m
[30;1m921 | [0m[35m                  mount -t lustre -o noatime,flock ${FSxVal} /mnt/fsx[0m
[30;1m922 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m923 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m924 | [0m[35m                  fi[0m

[31m--[ [0m[34mMatch #[0m[33m1261[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m862 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m863 | [0m[35m            EOF[0m
[30;1m864 | [0m[35m[0m
[30;1m865 | [0m[35m            cat << EOF > /usr/local/determined/etc/master.yaml.context[0m
[30;1m866 | [0m[35m            checkpoint_storage:[0m
[30;1m867 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m868 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1262[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m858 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m859 | [0m[35m            fi[0m
[30;1m860 | [0m[35m[0m
[30;1m861 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m
[30;1m862 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m863 | [0m[35m            EOF[0m
[30;1m864 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1263[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m855 | [0m[35m              scheme=https[0m
[30;1m856 | [0m[35m              port=8443[0m
[30;1m857 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m858 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m859 | [0m[35m            fi[0m
[30;1m860 | [0m[35m[0m
[30;1m861 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1264[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m855 | [0m[35m              scheme=https[0m
[30;1m856 | [0m[35m              port=8443[0m
[30;1m857 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m858 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m859 | [0m[35m            fi[0m
[30;1m860 | [0m[35m[0m
[30;1m861 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1265[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m854 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m855 | [0m[35m              scheme=https[0m
[30;1m856 | [0m[35m              port=8443[0m
[30;1m857 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m858 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m859 | [0m[35m            fi[0m
[30;1m860 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1266[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m854 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m855 | [0m[35m              scheme=https[0m
[30;1m856 | [0m[35m              port=8443[0m
[30;1m857 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m858 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m859 | [0m[35m            fi[0m
[30;1m860 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1267[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m  MountFSxId:[0m
[30;1m224 | [0m[35m    Type: String[0m
[30;1m225 | [0m[35m    Description: preexisting FSx ID to mount[0m
[30;1m226 | [0m[35m    Default: ""[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m  InitialUserPassword:[0m
[30;1m229 | [0m[35m    Type: String[0m

[31m--[ [0m[34mMatch #[0m[33m1268[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m  GpuEnvImage:[0m
[30;1m209 | [0m[35m    Type: String[0m
[30;1m210 | [0m[35m    Description: Docker image for GPU tasks[0m
[30;1m211 | [0m[35m    Default: ""[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m  LogGroupPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1269[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m  CpuEnvImage:[0m
[30;1m204 | [0m[35m    Type: String[0m
[30;1m205 | [0m[35m    Description: Docker image for CPU tasks[0m
[30;1m206 | [0m[35m    Default: ""[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m  GpuEnvImage:[0m

[31m--[ [0m[34mMatch #[0m[33m1270[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m  AgentReconnectBackoff:[0m
[30;1m189 | [0m[35m    Type: Number[0m
[30;1m190 | [0m[35m    Description: Time between reconnect attempts, with the exception of the first.[0m
[30;1m191 | [0m[35m    Default: 5[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m  AgentConfigFileContents:[0m

[31m--[ [0m[34mMatch #[0m[33m1271[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m
[30;1m97 | [0m[35m    Type: String[0m
[30;1m98 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m99 | [0m[35m    Default: ""[0m
[30;1m100 | [0m[35m    NoEcho: true[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1272[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m  DockerUser:[0m
[30;1m92 | [0m[35m    Type: String[0m
[30;1m93 | [0m[35m    Description: Docker user to pull images that need authentication[0m
[30;1m94 | [0m[35m    Default: ""[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m  DockerPass:[0m

[31m--[ [0m[34mMatch #[0m[33m1273[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m  AgentImageName:[0m
[30;1m87 | [0m[35m    Type: String[0m
[30;1m88 | [0m[35m    Description: Name of the Docker image to use for the Determined agent[0m
[30;1m89 | [0m[35m    Default: determined-agent[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m  DockerUser:[0m

[31m--[ [0m[34mMatch #[0m[33m1274[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m  MasterImageName:[0m
[30;1m82 | [0m[35m    Type: String[0m
[30;1m83 | [0m[35m    Description: Name of the Docker image to use for the Determined master[0m
[30;1m84 | [0m[35m    Default: determined-master[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m  AgentImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1275[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m  ImageRepoPrefix:[0m
[30;1m77 | [0m[35m    Type: String[0m
[30;1m78 | [0m[35m    Description: Docker image repository to use for determined-master and determined-agent images[0m
[30;1m79 | [0m[35m    Default: determinedai[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m  MasterImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1276[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m  InboundCIDRRange:[0m
[30;1m72 | [0m[35m    Type: String[0m
[30;1m73 | [0m[35m    Description: Ip range for Inbound[0m
[30;1m74 | [0m[35m    Default: 0.0.0.0/0[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m  ImageRepoPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1277[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    Default: 10.192.10.0/24[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m  Subnet2CIDR:[0m
[30;1m48 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the public subnet in the second Avail[0m
[30;1m49 | [0m[35m    Type: String[0m
[30;1m50 | [0m[35m    Default: 10.192.11.0/24[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1278[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    Default: 10.192.0.0/16[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m  Subnet1CIDR:[0m
[30;1m43 | [0m[35m    Description: Please enter the IP range (CIDR notation) for the public subnet in the first Availa[0m
[30;1m44 | [0m[35m    Type: String[0m
[30;1m45 | [0m[35m    Default: 10.192.10.0/24[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1279[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/fsx.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mParameters:[0m
[30;1m37 | [0m[35m  VpcCIDR:[0m
[30;1m38 | [0m[35m    Description: Please enter the IP range (CIDR notation) for this VPC[0m
[30;1m39 | [0m[35m    Type: String[0m
[30;1m40 | [0m[35m    Default: 10.192.0.0/16[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1280[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m771 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m772 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m773 | [0m[35m               stable"[0m
[30;1m774 | [0m[35m            apt-get update[0m
[30;1m775 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m778 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1281[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m759 | [0m[35m            EOF[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m762 | [0m[35m            apt-get update[0m
[30;1m763 | [0m[35m            apt-get install -y \[0m
[30;1m764 | [0m[35m                apt-transport-https \[0m
[30;1m765 | [0m[35m                ca-certificates \[0m
[30;1m766 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1282[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m850 | [0m[35m    Value: !Ref Version[0m
[30;1m851 | [0m[35m[0m
[30;1m852 | [0m[35m  DeterminedAddress:[0m
[30;1m853 | [0m[35m    Description: Ip address of Determined Master[0m
[30;1m854 | [0m[35m    Value: !GetAtt MasterInstance.PublicDnsName[0m
[30;1m855 | [0m[35m[0m
[30;1m856 | [0m[35m  MasterPort:[0m

[31m--[ [0m[34mMatch #[0m[33m1283[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m796 | [0m[35m                -c "/usr/bin/determined-gotmpl -i /etc/determined/master.yaml.context /etc/determine[0m
[30;1m797 | [0m[35m            test $? -eq 0 || ( echo "Failed to generate master.yaml" && exit 1 )[0m
[30;1m798 | [0m[35m[0m
[30;1m799 | [0m[35m            docker run \[0m
[30;1m800 | [0m[35m                --name determined-master \[0m
[30;1m801 | [0m[35m                --network determined \[0m
[30;1m802 | [0m[35m                --restart unless-stopped \[0m

[31m--[ [0m[34mMatch #[0m[33m1284[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m787 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m788 | [0m[35m[0m
[30;1m789 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m790 | [0m[35m            docker run \[0m
[30;1m791 | [0m[35m                --name determined-master-configurator \[0m
[30;1m792 | [0m[35m                --rm \[0m
[30;1m793 | [0m[35m                -v /usr/local/determined/etc/:/etc/determined/ \[0m

[31m--[ [0m[34mMatch #[0m[33m1285[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m784 | [0m[35m            docker network create determined[0m
[30;1m785 | [0m[35m[0m
[30;1m786 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m787 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m788 | [0m[35m[0m
[30;1m789 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m
[30;1m790 | [0m[35m            docker run \[0m

[31m--[ [0m[34mMatch #[0m[33m1286[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m            docker network create determined[0m
[30;1m785 | [0m[35m[0m
[30;1m786 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m787 | [0m[35m            docker rm $(docker ps -a -q)[0m
[30;1m788 | [0m[35m[0m
[30;1m789 | [0m[35m            touch /usr/local/determined/etc/master.yaml[0m

[31m--[ [0m[34mMatch #[0m[33m1287[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m781 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m782 | [0m[35m            fi[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m            docker network create determined[0m
[30;1m785 | [0m[35m[0m
[30;1m786 | [0m[35m            docker stop $(docker ps -a -q)[0m
[30;1m787 | [0m[35m            docker rm $(docker ps -a -q)[0m

[31m--[ [0m[34mMatch #[0m[33m1288[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m778 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m781 | [0m[35m              echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m782 | [0m[35m            fi[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m            docker network create determined[0m

[31m--[ [0m[34mMatch #[0m[33m1289[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m774 | [0m[35m            apt-get update[0m
[30;1m775 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m778 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m            if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1290[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m772 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m773 | [0m[35m               stable"[0m
[30;1m774 | [0m[35m            apt-get update[0m
[30;1m775 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m
[30;1m778 | [0m[35m              /usr/local/determined/etc/db_ssl_root_cert.pem[0m

[31m--[ [0m[34mMatch #[0m[33m1291[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m771 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m772 | [0m[35m               $(lsb_release -cs) \[0m
[30;1m773 | [0m[35m               stable"[0m
[30;1m774 | [0m[35m            apt-get update[0m
[30;1m775 | [0m[35m            apt-get install -y docker-ce docker-ce-cli containerd.io[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m            curl -fsSL https://www.amazontrust.com/repository/AmazonRootCA1.pem > \[0m

[31m--[ [0m[34mMatch #[0m[33m1292[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m766 | [0m[35m                curl \[0m
[30;1m767 | [0m[35m                gnupg-agent \[0m
[30;1m768 | [0m[35m                software-properties-common[0m
[30;1m769 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m
[30;1m770 | [0m[35m            add-apt-repository \[0m
[30;1m771 | [0m[35m               "deb [arch=amd64] https://download.docker.com/linux/ubuntu \[0m
[30;1m772 | [0m[35m               $(lsb_release -cs) \[0m

[31m--[ [0m[34mMatch #[0m[33m1293[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m763 | [0m[35m            apt-get install -y \[0m
[30;1m764 | [0m[35m                apt-transport-https \[0m
[30;1m765 | [0m[35m                ca-certificates \[0m
[30;1m766 | [0m[35m                curl \[0m
[30;1m767 | [0m[35m                gnupg-agent \[0m
[30;1m768 | [0m[35m                software-properties-common[0m
[30;1m769 | [0m[35m            curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -[0m

[31m--[ [0m[34mMatch #[0m[33m1294[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m762 | [0m[35m            apt-get update[0m
[30;1m763 | [0m[35m            apt-get install -y \[0m
[30;1m764 | [0m[35m                apt-transport-https \[0m
[30;1m765 | [0m[35m                ca-certificates \[0m
[30;1m766 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m1295[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m759 | [0m[35m            EOF[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m762 | [0m[35m            apt-get update[0m
[30;1m763 | [0m[35m            apt-get install -y \[0m
[30;1m764 | [0m[35m                apt-transport-https \[0m
[30;1m765 | [0m[35m                ca-certificates \[0m

[31m--[ [0m[34mMatch #[0m[33m1296[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m758 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m759 | [0m[35m            EOF[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m762 | [0m[35m            apt-get update[0m
[30;1m763 | [0m[35m            apt-get install -y \[0m
[30;1m764 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1297[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m758 | [0m[35m              initial_user_password: "${InitialUserPassword}"[0m
[30;1m759 | [0m[35m            EOF[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m            apt-get remove docker docker-engine docker.io containerd runc[0m
[30;1m762 | [0m[35m            apt-get update[0m
[30;1m763 | [0m[35m            apt-get install -y \[0m
[30;1m764 | [0m[35m                apt-transport-https \[0m

[31m--[ [0m[34mMatch #[0m[33m1298[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m746 | [0m[35m                agent_config_file_contents: ${AgentConfigFileContents}[0m
[30;1m747 | [0m[35m                startup_script: |[0m
[30;1m748 | [0m[35m                  if [ ! -z "${DockerUser}" ] && [ ! -z ${DockerPass} ]; then[0m
[30;1m749 | [0m[35m                    echo "${DockerPass}" | docker login --username "${DockerUser}" --password-stdin[0m
[30;1m750 | [0m[35m                  fi[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m            scheme: $scheme[0m

[31m--[ [0m[34mMatch #[0m[33m1299[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m690 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m691 | [0m[35m            EOF[0m
[30;1m692 | [0m[35m[0m
[30;1m693 | [0m[35m            cat << EOF > /usr/local/determined/etc/master.yaml.context[0m
[30;1m694 | [0m[35m            checkpoint_storage:[0m
[30;1m695 | [0m[35m              bucket: ${CheckpointBucket}[0m
[30;1m696 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1300[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m686 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m687 | [0m[35m            fi[0m
[30;1m688 | [0m[35m[0m
[30;1m689 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m
[30;1m690 | [0m[35m            ${MasterConfigTemplate}[0m
[30;1m691 | [0m[35m            EOF[0m
[30;1m692 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1301[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m683 | [0m[35m              scheme=https[0m
[30;1m684 | [0m[35m              port=8443[0m
[30;1m685 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m686 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m687 | [0m[35m            fi[0m
[30;1m688 | [0m[35m[0m
[30;1m689 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1302[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m683 | [0m[35m              scheme=https[0m
[30;1m684 | [0m[35m              port=8443[0m
[30;1m685 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m686 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m687 | [0m[35m            fi[0m
[30;1m688 | [0m[35m[0m
[30;1m689 | [0m[35m            cat << 'EOF' > /usr/local/determined/etc/master.yaml.tmpl[0m

[31m--[ [0m[34mMatch #[0m[33m1303[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m682 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m683 | [0m[35m              scheme=https[0m
[30;1m684 | [0m[35m              port=8443[0m
[30;1m685 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m686 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m687 | [0m[35m            fi[0m
[30;1m688 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1304[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m682 | [0m[35m            if [ -n "${MasterTLSCert}" ] && [ -n "${MasterTLSKey}" ]; then[0m
[30;1m683 | [0m[35m              scheme=https[0m
[30;1m684 | [0m[35m              port=8443[0m
[30;1m685 | [0m[35m              base64 -d <<<"${MasterTLSCert}" | tee /usr/local/determined/etc/master.crt[0m
[30;1m686 | [0m[35m              base64 -d <<<"${MasterTLSKey}" | tee /usr/local/determined/etc/master.key[0m
[30;1m687 | [0m[35m            fi[0m
[30;1m688 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1305[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m  GpuEnvImage:[0m
[30;1m201 | [0m[35m    Type: String[0m
[30;1m202 | [0m[35m    Description: Docker image for GPU tasks[0m
[30;1m203 | [0m[35m    Default: ""[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m  LogGroupPrefix:[0m

[31m--[ [0m[34mMatch #[0m[33m1306[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m  CpuEnvImage:[0m
[30;1m196 | [0m[35m    Type: String[0m
[30;1m197 | [0m[35m    Description: Docker image for CPU tasks[0m
[30;1m198 | [0m[35m    Default: ""[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m  GpuEnvImage:[0m

[31m--[ [0m[34mMatch #[0m[33m1307[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m  AgentReconnectBackoff:[0m
[30;1m181 | [0m[35m    Type: Number[0m
[30;1m182 | [0m[35m    Description: Time between reconnect attempts, with the exception of the first.[0m
[30;1m183 | [0m[35m    Default: 5[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m  AgentConfigFileContents:[0m

[31m--[ [0m[34mMatch #[0m[33m1308[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m  Version:[0m
[30;1m95 | [0m[35m    Type: String[0m
[30;1m96 | [0m[35m    Description: Determined version or commit for master docker image[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m  DBPassword:[0m
[30;1m99 | [0m[35m    Type: String[0m

[31m--[ [0m[34mMatch #[0m[33m1309[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  DockerPass:[0m
[30;1m89 | [0m[35m    Type: String[0m
[30;1m90 | [0m[35m    Description: Docker password to pull images that need authentication[0m
[30;1m91 | [0m[35m    Default: ""[0m
[30;1m92 | [0m[35m    NoEcho: true[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1310[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m  DockerUser:[0m
[30;1m84 | [0m[35m    Type: String[0m
[30;1m85 | [0m[35m    Description: Docker user to pull images that need authentication[0m
[30;1m86 | [0m[35m    Default: ""[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  DockerPass:[0m

[31m--[ [0m[34mMatch #[0m[33m1311[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m  AgentImageName:[0m
[30;1m79 | [0m[35m    Type: String[0m
[30;1m80 | [0m[35m    Description: Name of the Docker image to use for the Determined agent[0m
[30;1m81 | [0m[35m    Default: determined-agent[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m  DockerUser:[0m

[31m--[ [0m[34mMatch #[0m[33m1312[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m  MasterImageName:[0m
[30;1m74 | [0m[35m    Type: String[0m
[30;1m75 | [0m[35m    Description: Name of the Docker image to use for the Determined master[0m
[30;1m76 | [0m[35m    Default: determined-master[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m  AgentImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1313[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m  ImageRepoPrefix:[0m
[30;1m69 | [0m[35m    Type: String[0m
[30;1m70 | [0m[35m    Description: Docker image repository to use for determined-master and determined-agent images[0m
[30;1m71 | [0m[35m    Default: determinedai[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m  MasterImageName:[0m

[31m--[ [0m[34mMatch #[0m[33m1314[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m  InboundCIDRRange:[0m
[30;1m59 | [0m[35m    Type: String[0m
[30;1m60 | [0m[35m    Description: Ip range for Inbound[0m
[30;1m61 | [0m[35m    Default: 0.0.0.0/0[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m  SubnetId:[0m

[31m--[ [0m[34mMatch #[0m[33m1315[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/templates/simple.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35mParameters:[0m
[30;1m39 | [0m[35m  Keypair:[0m
[30;1m40 | [0m[35m    Type: AWS::EC2::KeyPair::KeyName[0m
[30;1m41 | [0m[35m    Description: Keypair to SSH[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m  MasterInstanceType:[0m
[30;1m44 | [0m[35m    Type: String[0m
[30;1m45 | [0m[35m    Description: Instance Type of Master[0m

[31m--[ [0m[34mMatch #[0m[33m1316[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/tunnel.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mtunnel.py will tunnel a TCP connection to the service (typically a shell) with ID equal to[0m
[30;1m3 | [0m[35mSERVICE_UUID over a WebSocket connection to a Determined master at MASTER_URL.[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport argparse[0m

[31m--[ [0m[34mMatch #[0m[33m1317[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/tunnel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport argparse[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom determined.cli import proxy[0m
[30;1m10 | [0m[35mfrom determined.common import api[0m
[30;1m11 | [0m[35mfrom determined.common.api import authentication, certs[0m

[31m--[ [0m[34mMatch #[0m[33m1318[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/cli/tunnel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mtunnel.py will tunnel a TCP connection to the service (typically a shell) with ID equal to[0m
[30;1m3 | [0m[35mSERVICE_UUID over a WebSocket connection to a Determined master at MASTER_URL.[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1319[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m    #  - disable retries: {"total":0}[0m
[30;1m206 | [0m[35m    #  - shorten the wait times {"total":10,"backoff_factor":0.5,"method_whitelist":false}[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    config_data = os.environ.get("DET_RETRY_CONFIG")[0m
[30;1m209 | [0m[35m    if config_data is not None:[0m
[30;1m210 | [0m[35m        config = json.loads(config_data)[0m
[30;1m211 | [0m[35m        return urllib3.util.retry.Retry(**config)[0m

[31m--[ [0m[34mMatch #[0m[33m1320[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35mdef get_config_path() -> pathlib.Path:[0m
[30;1m184 | [0m[35m    if os.environ.get("DET_DEBUG_CONFIG_PATH"):[0m
[30;1m185 | [0m[35m        return pathlib.Path(os.environ["DET_DEBUG_CONFIG_PATH"])[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    system = platform.system()[0m

[31m--[ [0m[34mMatch #[0m[33m1321[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mdef _get_yaml(default_flow_style: Optional[bool] = None) -> yaml.YAML:[0m
[30;1m38 | [0m[35m    y = _yamls.get(default_flow_style)[0m
[30;1m39 | [0m[35m    if y is None:[0m
[30;1m40 | [0m[35m        y = yaml.YAML(typ="safe", pure=True)[0m
[30;1m41 | [0m[35m        if default_flow_style is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1322[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m    # Protobuf accepts timestamps with or without microseconds.[0m
[30;1m287 | [0m[35m    accepted_formats = ["%Y-%m-%dT%H:%M:%S.%fZ", "%Y-%m-%dT%H:%M:%SZ"][0m
[30;1m288 | [0m[35m    for fmt in accepted_formats:[0m
[30;1m289 | [0m[35m        try:[0m
[30;1m290 | [0m[35m            datetime.datetime.strptime(ts, fmt)[0m
[30;1m291 | [0m[35m        except (ValueError, TypeError):[0m

[31m--[ [0m[34mMatch #[0m[33m1323[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35mdef get_max_retries_config() -> urllib3.util.retry.Retry:[0m
[30;1m201 | [0m[35m    # Allow overriding retry settings when necessary.[0m
[30;1m202 | [0m[35m    # `DET_RETRY_CONFIG` env variable can contain `urllib3` `Retry` parameters,[0m
[30;1m203 | [0m[35m    # encoded as JSON.[0m
[30;1m204 | [0m[35m    # For example:[0m
[30;1m205 | [0m[35m    #  - disable retries: {"total":0}[0m

[31m--[ [0m[34mMatch #[0m[33m1324[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport random[0m
[30;1m9 | [0m[35mimport re[0m
[30;1m10 | [0m[35mimport sys[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mimport warnings[0m
[30;1m13 | [0m[35mfrom typing import ([0m
[30;1m14 | [0m[35m    IO,[0m
[30;1m15 | [0m[35m    Any,[0m

[31m--[ [0m[34mMatch #[0m[33m1325[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/detlomond.py[0m
   Pattern: [32m.hostname[0m
[30;1m60 | [0m[35m        # "HTTPS_PROXY" environment variables. When the "proxies" parameter is not[0m
[30;1m61 | [0m[35m        # specified, the default value is "None".[0m
[30;1m62 | [0m[35m        parsed = parse.urlparse(sess.master)[0m
[30;1m63 | [0m[35m        proxies = {} if request.proxy_bypass(parsed.hostname) else None  # type: ignore[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        # Prepare a session_class for the eventual .connect() method.[0m
[30;1m66 | [0m[35m        self._default_session_class = lambda socket: CustomSSLWebsocketSession(socket, sess.cert)[0m

[31m--[ [0m[34mMatch #[0m[33m1326[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/detlomond.py[0m
   Pattern: [32m.hostname[0m
[30;1m51 | [0m[35m    def __init__(self, sess: api.BaseSession, path: str, **kwargs: Any):[0m
[30;1m52 | [0m[35m        # The "lomond.WebSocket()" function does not honor the "no_proxy" or[0m
[30;1m53 | [0m[35m        # "NO_PROXY" environment variables. To work around that, we check if[0m
[30;1m54 | [0m[35m        # the hostname is in the "no_proxy" or "NO_PROXY" environment variables[0m
[30;1m55 | [0m[35m        # ourselves using the "proxy_bypass()" function, which checks the "no_proxy"[0m
[30;1m56 | [0m[35m        # and "NO_PROXY" environment variables, and returns True if the host does[0m
[30;1m57 | [0m[35m        # not require a proxy server. The "lomond.WebSocket()" function will disable[0m

[31m--[ [0m[34mMatch #[0m[33m1327[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/detlomond.py[0m
   Pattern: [32m.hostname[0m
[30;1m36 | [0m[35m            self.ctx.load_verify_locations(cafile=bundle)[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    def _wrap_socket(self, sock: socket.SocketType, host: str) -> socket.SocketType:[0m
[30;1m39 | [0m[35m        return self.ctx.wrap_socket(sock, server_hostname=self.cert_name or host)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mclass WebSocket(lomond.WebSocket):  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m1328[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/detlomond.py[0m
   Pattern: [32m.hostname[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        bundle = cert.bundle if cert else None[0m
[30;1m29 | [0m[35m        if bundle is False:[0m
[30;1m30 | [0m[35m            self.ctx.check_hostname = False[0m
[30;1m31 | [0m[35m            self.ctx.verify_mode = ssl.CERT_NONE[0m
[30;1m32 | [0m[35m            return[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1329[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/workspace.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m        Arguments:[0m
[30;1m26 | [0m[35m            session: The session to use for API calls.[0m
[30;1m27 | [0m[35m            workspace_id: (Optional) ID of the workspace. If None or not passed, the workspace ID[0m
[30;1m28 | [0m[35m                will be looked up here at initialization.[0m
[30;1m29 | [0m[35m            workspace_name: (Optional) Name of the workspace.[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        Note: Only one of workspace_id or workspace_name should be passed.[0m

[31m--[ [0m[34mMatch #[0m[33m1330[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35m# We subtract one megabyte to account for any message envelope size we may have.[0m
[30;1m18 | [0m[35mMAX_CONTEXT_SIZE = MAX_ENCODED_SIZE - (1 * 1024 * 1024)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# The maximum size of a workload metrics object is capped at 100MB. Metrics[0m
[30;1m21 | [0m[35m# are specified by the model definition and persisted after each workload[0m
[30;1m22 | [0m[35m# training step is completed.[0m
[30;1m23 | [0m[35mMAX_METRICS_SIZE = 100 * (1 << 20)[0m

[31m--[ [0m[34mMatch #[0m[33m1331[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m#  - terraform files generated by `det deploy gcp`, e.g. when user creates[0m
[30;1m35 | [0m[35m#    a cluster from the (tutorial) model def directory.[0m
[30;1m36 | [0m[35m#  - .git and IDE-related content[0m
[30;1m37 | [0m[35m#  - shared_fs, which is the mount point we use for automounted file systems[0m
[30;1m38 | [0m[35m# Users may also define custom .detignore files to ignore arbitrary paths.[0m
[30;1m39 | [0m[35mDEFAULT_DETIGNORE = [[0m
[30;1m40 | [0m[35m    "__pycache__/",[0m

[31m--[ [0m[34mMatch #[0m[33m1332[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m# The maximum size of a model (the sum of the model definition plus any[0m
[30;1m12 | [0m[35m# additional package dependencies). Models are created via HTTP and sent[0m
[30;1m13 | [0m[35m# to agents via WebSockets; we also have to account for the overhead of[0m
[30;1m14 | [0m[35m# base64 encoding. Models are also stored in Postgres but the max[0m
[30;1m15 | [0m[35m# Postgres field size is 1GB, so we ignore that here.[0m
[30;1m16 | [0m[35mMAX_ENCODED_SIZE = (min(MAX_WEBSOCKET_MSG_SIZE, MAX_HTTP_REQUEST_SIZE) // 8) * 6[0m
[30;1m17 | [0m[35m# We subtract one megabyte to account for any message envelope size we may have.[0m

[31m--[ [0m[34mMatch #[0m[33m1333[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m    Note:[0m
[30;1m36 | [0m[35m        All attributes are cached by default.[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        Mutable properties may be changed by methods that update these values either automatically[0m
[30;1m39 | [0m[35m        (eg. :meth:`set_name`, :meth:`set_notes`) or explicitly with :meth:`reload`.[0m
[30;1m40 | [0m[35m    """[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1334[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35mclass ModelSortBy(enum.Enum):[0m
[30;1m154 | [0m[35m    """[0m
[30;1m155 | [0m[35m    Specifies the field to sort a list of models on.[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    Attributes:[0m
[30;1m158 | [0m[35m        NAME[0m

[31m--[ [0m[34mMatch #[0m[33m1335[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m    Attributes:[0m
[30;1m25 | [0m[35m        session: HTTP request session.[0m
[30;1m26 | [0m[35m        model_version: (int) Version number assigned by the registry, starting from 1 and[0m
[30;1m27 | [0m[35m            incrementing each time a new model version is registered.[0m
[30;1m28 | [0m[35m        model_name: (str) Name of the parent model.[0m
[30;1m29 | [0m[35m        checkpoint: (Mutable, Optional[checkpoint.Checkpoint]) Checkpoint associated with this[0m
[30;1m30 | [0m[35m            model version.[0m

[31m--[ [0m[34mMatch #[0m[33m1336[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m    pid_server_cmd = create_hvd_pid_server_cmd(info.allocation_id, len(info.slot_ids))[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    # TODO: remove this (very old) hack when we have a configurable launch layer.[0m
[30;1m167 | [0m[35m    hvd_optional_args = experiment_config.get("data", {}).get("__det_dtrain_args", [])[0m
[30;1m168 | [0m[35m    hvd_optional_args += hvd_args[0m
[30;1m169 | [0m[35m    if debug:[0m
[30;1m170 | [0m[35m        hvd_optional_args += ["--mpi-args=-v --display-map"][0m

[31m--[ [0m[34mMatch #[0m[33m1337[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m    pid_server_cmd = create_hvd_pid_server_cmd(info.allocation_id, len(info.slot_ids))[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    # TODO: remove this (very old) hack when we have a configurable launch layer.[0m
[30;1m167 | [0m[35m    hvd_optional_args = experiment_config.get("data", {}).get("__det_dtrain_args", [])[0m
[30;1m168 | [0m[35m    hvd_optional_args += hvd_args[0m
[30;1m169 | [0m[35m    if debug:[0m
[30;1m170 | [0m[35m        hvd_optional_args += ["--mpi-args=-v --display-map"][0m

[31m--[ [0m[34mMatch #[0m[33m1338[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m        # containers (horovodrun, in this case) have exited.[0m
[30;1m131 | [0m[35m        cert = certs.default_load(info.master_url)[0m
[30;1m132 | [0m[35m        sess = authentication.login_from_task(info.master_url, cert=cert)[0m
[30;1m133 | [0m[35m        sess.post(f"/api/v1/allocations/{info.allocation_id}/resources/{resources_id}/daemon")[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        pid_server_cmd, run_sshd_command = create_sshd_worker_cmd([0m
[30;1m136 | [0m[35m            info.allocation_id, len(info.slot_ids), debug=debug[0m

[31m--[ [0m[34mMatch #[0m[33m1339[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m    # Hack: read the full config.  The experiment config is not a stable API![0m
[30;1m112 | [0m[35m    experiment_config = info.trial._config[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    debug = experiment_config.get("debug", False)[0m
[30;1m115 | [0m[35m    if debug:[0m
[30;1m116 | [0m[35m        logging.getLogger().setLevel(logging.DEBUG)[0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1340[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m            return p.wait()[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    # Hack: get the resources id from the environment.[0m
[30;1m108 | [0m[35m    resources_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m109 | [0m[35m    assert resources_id is not None, "Unable to run with DET_RESOURCES_ID unset"[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    # Hack: read the full config.  The experiment config is not a stable API![0m

[31m--[ [0m[34mMatch #[0m[33m1341[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m262 | [0m[35m            sys.exit(1)[0m
[30;1m263 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m264 | [0m[35m    elif not script:[0m
[30;1m265 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m266 | [0m[35m        parser.print_usage()[0m
[30;1m267 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m268 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1342[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m264 | [0m[35m    elif not script:[0m
[30;1m265 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m266 | [0m[35m        parser.print_usage()[0m
[30;1m267 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m268 | [0m[35m        sys.exit(1)[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    return hvd_args, script, parsed.autohorovod[0m

[31m--[ [0m[34mMatch #[0m[33m1343[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m            sys.exit(1)[0m
[30;1m263 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m264 | [0m[35m    elif not script:[0m
[30;1m265 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m266 | [0m[35m        parser.print_usage()[0m
[30;1m267 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m268 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1344[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m260 | [0m[35m            parser.print_usage()[0m
[30;1m261 | [0m[35m            print("error: extra arguments to --trial:", script, file=sys.stderr)[0m
[30;1m262 | [0m[35m            sys.exit(1)[0m
[30;1m263 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m264 | [0m[35m    elif not script:[0m
[30;1m265 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m266 | [0m[35m        parser.print_usage()[0m

[31m--[ [0m[34mMatch #[0m[33m1345[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    parsed = parser.parse_args(args)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m    script = parsed.script or [][0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m    if parsed.trial is not None:[0m
[30;1m258 | [0m[35m        if script:[0m

[31m--[ [0m[34mMatch #[0m[33m1346[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m    # dtrain if they don't use it.  However, if a user is writing a custom horovod-based training[0m
[30;1m248 | [0m[35m    # script and using this det.launch.horovod module as their launch layer, presumably they are[0m
[30;1m249 | [0m[35m    # already comfortable with horovod and they are not likely to want to pay the code complexity[0m
[30;1m250 | [0m[35m    # cost.  That is why this flag is internal; we don't really expect any users to ever use it.[0m
[30;1m251 | [0m[35m    parser.add_argument("--autohorovod", action="store_true", help=argparse.SUPPRESS)[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    parsed = parser.parse_args(args)[0m

[31m--[ [0m[34mMatch #[0m[33m1347[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m # In Determined-owned training loops, we pay the code complexity cost so that the execution of[0m
[30;1m246 | [0m[35m    # single-slot training stays as simple as possible.  Determined users should not have to pay for[0m
[30;1m247 | [0m[35m    # dtrain if they don't use it.  However, if a user is writing a custom horovod-based training[0m
[30;1m248 | [0m[35m    # script and using this det.launch.horovod module as their launch layer, presumably they are[0m
[30;1m249 | [0m[35m    # already comfortable with horovod and they are not likely to want to pay the code complexity[0m
[30;1m250 | [0m[35m    # cost.  That is why this flag is internal; we don't really expect any users to ever use it.[0m

[31m--[ [0m[34mMatch #[0m[33m1348[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m        "--trial",[0m
[30;1m226 | [0m[35m        help=([0m
[30;1m227 | [0m[35m            "(deprecated) use a Trial class as the entrypoint to training.  When --trial is used, "[0m
[30;1m228 | [0m[35m            "the SCRIPT positional argument must be omitted."[0m
[30;1m229 | [0m[35m        ),[0m
[30;1m230 | [0m[35m    )[0m
[30;1m231 | [0m[35m    # For training scripts.[0m

[31m--[ [0m[34mMatch #[0m[33m1349[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m    parser = argparse.ArgumentParser([0m
[30;1m212 | [0m[35m        usage="%(prog)s [[HVD_OVERRIDES...] --] (--trial TRIAL)|(SCRIPT...)",[0m
[30;1m213 | [0m[35m        description=([0m
[30;1m214 | [0m[35m            "Launch a script under horovodrun on a Determined cluster, with automatic handling of "[0m
[30;1m215 | [0m[35m            "IP addresses, sshd containers, and shutdown mechanics."[0m
[30;1m216 | [0m[35m        ),[0m
[30;1m217 | [0m[35m        epilog=([0m

[31m--[ [0m[34mMatch #[0m[33m1350[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m    # easiest way to get the chief_ip is with container_addrs.[0m
[30;1m121 | [0m[35m    chief_ip = info.container_addrs[0][0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    # Chief IP is set as an environment variable to support nested launch layers[0m
[30;1m124 | [0m[35m    os.environ["DET_CHIEF_IP"] = chief_ip[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    if info.container_rank > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m1351[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport subprocess[0m
[30;1m12 | [0m[35mimport sys[0m
[30;1m13 | [0m[35mimport time[0m
[30;1m14 | [0m[35mimport warnings[0m
[30;1m15 | [0m[35mfrom typing import List, Tuple[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mimport determined as det[0m

[31m--[ [0m[34mMatch #[0m[33m1352[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mautohorovod.py is the default launch layer for Determined.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mIt launches the entrypoint script under horovodrun when slots_per_trial>1, or as a regular[0m
[30;1m5 | [0m[35msubprocess otherwise.[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1353[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/metrics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m            steps_completed=metric_report.totalBatches,[0m
[30;1m44 | [0m[35m            end_time=util.parse_protobuf_timestamp(metric_report.endTime),[0m
[30;1m45 | [0m[35m            metrics=metric_report.metrics[key],[0m
[30;1m46 | [0m[35m            batch_metrics=metric_report.metrics.get("batch_metrics", None),[0m
[30;1m47 | [0m[35m            group=metric_report.group,[0m
[30;1m48 | [0m[35m        )[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1354[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/metrics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m        steps_completed: The number of steps that the trial had completed when the metric was[0m
[30;1m17 | [0m[35m            reported. Most generally, the value passed to a call to report_metrics as[0m
[30;1m18 | [0m[35m            "steps_completed."[0m
[30;1m19 | [0m[35m        end_time: The time when the metric was reported.[0m
[30;1m20 | [0m[35m        metrics: A dict of metrics that the trial reported.[0m
[30;1m21 | [0m[35m        group: The group that the metric was reported under. Usually either "validation" or[0m
[30;1m22 | [0m[35m            "training", but this can be any value passed to master when reporting metrics during[0m

[31m--[ [0m[34mMatch #[0m[33m1355[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/check.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m21 | [0m[35m  check.true(...)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mThe second scheme is generally preferred because it more clearly indicates a[0m
[30;1m24 | [0m[35mmodule dependency at the call site and it reduces diff churn when checks are[0m
[30;1m25 | [0m[35madded or removed.[0m
[30;1m26 | [0m[35m"""[0m
[30;1m27 | [0m[35mfrom typing import Any, Container, Optional, Sized, Tuple, Type, Union[0m

[31m--[ [0m[34mMatch #[0m[33m1356[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/check.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m  check.true(...)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mThe second scheme is generally preferred because it more clearly indicates a[0m
[30;1m24 | [0m[35mmodule dependency at the call site and it reduces diff churn when checks are[0m
[30;1m25 | [0m[35madded or removed.[0m
[30;1m26 | [0m[35m"""[0m
[30;1m27 | [0m[35mfrom typing import Any, Container, Optional, Sized, Tuple, Type, Union[0m

[31m--[ [0m[34mMatch #[0m[33m1357[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/user.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m    Note:[0m
[30;1m28 | [0m[35m        All attributes are cached by default.[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        Mutable properties may be changed by methods that update these values either automatically[0m
[30;1m31 | [0m[35m        (eg. `rename`, `change_display_name`) or explicitly with :meth:`reload()`.[0m
[30;1m32 | [0m[35m    """[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1358[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/callbacks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m323 | [0m[35m            cb.on_epoch_begin(epoch, polylogs(supports_tf_logs))[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    def _corrected_epoch_end(self, epoch: int, logs: Dict) -> None:[0m
[30;1m326 | [0m[35m        """The real on_epoch_end call, which is guaranteed to happen at the right time."""[0m
[30;1m327 | [0m[35m        polylogs = _PolyLogs(logs)[0m
[30;1m328 | [0m[35m        for cb in self.callbacks:[0m
[30;1m329 | [0m[35m            supports_tf_logs = getattr(cb, "_supports_tf_logs", False)[0m

[31m--[ [0m[34mMatch #[0m[33m1359[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/callbacks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m316 | [0m[35m            cb.on_predict_end(polylogs(supports_tf_logs))[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m    def _corrected_epoch_begin(self, epoch: int, logs: Dict) -> None:[0m
[30;1m319 | [0m[35m        """The real on_epoch_begin call, which is guaranteed to happen at the right time."""[0m
[30;1m320 | [0m[35m        polylogs = _PolyLogs(logs)[0m
[30;1m321 | [0m[35m        for cb in self.callbacks:[0m
[30;1m322 | [0m[35m            supports_tf_logs = getattr(cb, "_supports_tf_logs", False)[0m

[31m--[ [0m[34mMatch #[0m[33m1360[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/callbacks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m        on_train_workload_end is called after a chunk of model training.[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m        Parameters:[0m
[30;1m76 | [0m[35m            total_batches_trained:  The number of batches trained at the end of the workload.[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m            logs: a dictionary of training metrics aggregated during this workload.[0m
[30;1m79 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1361[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/callbacks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m60 | [0m[35m        experiment.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        Parameters:[0m
[30;1m63 | [0m[35m            total_batches_trained:  The number of batches trained at the start of the workload.[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m            batches_requested: The number of batches expected to train during the workload.[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1362[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/callbacks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35m       The following behaviors differ between normal Keras operation and Keras[0m
[30;1m24 | [0m[35m       operation within Determined:[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m        * Keras calls on_epoch_end at the end of the training dataset, but Determined calls it[0m
[30;1m27 | [0m[35m          based on the records_per_epoch setting in the experiment config.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m        * Keras calls on_epoch_end with training and validation logs, but Determined does not[0m

[31m--[ [0m[34mMatch #[0m[33m1363[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/callbacks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport pathlib[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport warnings[0m
[30;1m5 | [0m[35mfrom typing import Any, Dict, List, Optional[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport tensorflow as tf[0m

[31m--[ [0m[34mMatch #[0m[33m1364[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m    def add_oauth_client(self, domain: str, name: str) -> oauth2_scim_client.Oauth2ScimClient:[0m
[30;1m508 | [0m[35m        try:[0m
[30;1m509 | [0m[35m            client = self._session.post([0m
[30;1m510 | [0m[35m                "oauth2/clients", json={"domain": domain, "name": name}[0m
[30;1m511 | [0m[35m            ).json()[0m
[30;1m512 | [0m[35m            return oauth2_scim_client.Oauth2ScimClient([0m

[31m--[ [0m[34mMatch #[0m[33m1365[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m494 | [0m[35m    def list_oauth_clients(self) -> Sequence[oauth2_scim_client.Oauth2ScimClient]:[0m
[30;1m495 | [0m[35m        try:[0m
[30;1m496 | [0m[35m            oauth2_scim_clients: List[oauth2_scim_client.Oauth2ScimClient] = [][0m
[30;1m497 | [0m[35m            clients = self._session.get("oauth2/clients").json()[0m
[30;1m498 | [0m[35m            for client in clients:[0m
[30;1m499 | [0m[35m                osc: oauth2_scim_client.Oauth2ScimClient = oauth2_scim_client.Oauth2ScimClient([0m
[30;1m500 | [0m[35m                    name=client["name"], client_id=client["id"], domain=client["domain"][0m

[31m--[ [0m[34mMatch #[0m[33m1366[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m.userInfo[0m
[30;1m117 | [0m[35m        resp = bindings.get_GetUserByUsername(session=self._session, username=user_name)[0m
[30;1m118 | [0m[35m        return user.User._from_bindings(resp.user, self._session)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    def whoami(self) -> user.User:[0m
[30;1m121 | [0m[35m        resp = bindings.get_GetMe(self._session)[0m
[30;1m122 | [0m[35m        return user.User._from_bindings(resp.user, self._session)[0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1367[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m            - Must be at least 8 characters long.[0m
[30;1m84 | [0m[35m            - Must contain at least one upper-case letter.[0m
[30;1m85 | [0m[35m            - Must contain at least one lower-case letter.[0m
[30;1m86 | [0m[35m            - Must contain at least one number.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        Arg:[0m
[30;1m89 | [0m[35m            username: username of the user.[0m

[31m--[ [0m[34mMatch #[0m[33m1368[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m        The complexity requirements are:[0m
[30;1m83 | [0m[35m            - Must be at least 8 characters long.[0m
[30;1m84 | [0m[35m            - Must contain at least one upper-case letter.[0m
[30;1m85 | [0m[35m            - Must contain at least one lower-case letter.[0m
[30;1m86 | [0m[35m            - Must contain at least one number.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        Arg:[0m

[31m--[ [0m[34mMatch #[0m[33m1369[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        The complexity requirements are:[0m
[30;1m83 | [0m[35m            - Must be at least 8 characters long.[0m
[30;1m84 | [0m[35m            - Must contain at least one upper-case letter.[0m
[30;1m85 | [0m[35m            - Must contain at least one lower-case letter.[0m
[30;1m86 | [0m[35m            - Must contain at least one number.[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1370[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m        Otherwise, a password must be set that meets complexity requirements.[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        The complexity requirements are:[0m
[30;1m83 | [0m[35m            - Must be at least 8 characters long.[0m
[30;1m84 | [0m[35m            - Must contain at least one upper-case letter.[0m
[30;1m85 | [0m[35m            - Must contain at least one lower-case letter.[0m
[30;1m86 | [0m[35m            - Must contain at least one number.[0m

[31m--[ [0m[34mMatch #[0m[33m1371[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35m        """Create a new Determined object that uses an existing session.[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        This constructor exists to help the CLI transition to using SDK methods, most of which are[0m
[30;1m65 | [0m[35m        derived from a Determined object at some point in their lifespan.[0m
[30;1m66 | [0m[35m        """[0m
[30;1m67 | [0m[35m        # mypy gives new_det "Any" type, even if cls is annotated[0m
[30;1m68 | [0m[35m        new_det = cls.__new__(cls)  # type: Determined[0m

[31m--[ [0m[34mMatch #[0m[33m1372[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m        Arguments:[0m
[30;1m443 | [0m[35m            sort_by: Which field to sort by. See :class:`~determined.experimental.ModelSortBy`.[0m
[30;1m444 | [0m[35m            order_by: Whether to sort in ascending or descending order. See[0m
[30;1m445 | [0m[35m                :class:`~determined.experimental.OrderBy`.[0m
[30;1m446 | [0m[35m            name: If this parameter is set, models will be filtered to only[0m
[30;1m447 | [0m[35m                include models with names matching this parameter.[0m

[31m--[ [0m[34mMatch #[0m[33m1373[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m440 | [0m[35m        Get a list of all models in the model registry.[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m        Arguments:[0m
[30;1m443 | [0m[35m            sort_by: Which field to sort by. See :class:`~determined.experimental.ModelSortBy`.[0m
[30;1m444 | [0m[35m            order_by: Whether to sort in ascending or descending order. See[0m
[30;1m445 | [0m[35m                :class:`~determined.experimental.OrderBy`.[0m
[30;1m446 | [0m[35m            name: If this parameter is set, models will be filtered to only[0m

[31m--[ [0m[34mMatch #[0m[33m1374[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m235 | [0m[35m        Arguments:[0m
[30;1m236 | [0m[35m            sort_by: Which field to sort by. See[0m
[30;1m237 | [0m[35m                :class:`~determined.experimental.ExperimentSortBy`.[0m
[30;1m238 | [0m[35m            order_by: Whether to sort in ascending or descending order. See[0m
[30;1m239 | [0m[35m                :class:`~determined.experimental.OrderBy`.[0m
[30;1m240 | [0m[35m            name: If this parameter is set, experiments will be filtered to only include those[0m
[30;1m241 | [0m[35m                with names matching this parameter.[0m

[31m--[ [0m[34mMatch #[0m[33m1375[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m        """Get a list of experiments (:class:`~determined.experimental.Experiment`).[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m        Arguments:[0m
[30;1m236 | [0m[35m            sort_by: Which field to sort by. See[0m
[30;1m237 | [0m[35m                :class:`~determined.experimental.ExperimentSortBy`.[0m
[30;1m238 | [0m[35m            order_by: Whether to sort in ascending or descending order. See[0m
[30;1m239 | [0m[35m                :class:`~determined.experimental.OrderBy`.[0m

[31m--[ [0m[34mMatch #[0m[33m1376[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/determined.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m    ) -> user.User:[0m
[30;1m75 | [0m[35m        """Creates a user.[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m        The user's credentials may be managed by a remote service (Enterprise edition only),[0m
[30;1m78 | [0m[35m        in which case the `remote` argument should be set to `true`, and then SSO should be[0m
[30;1m79 | [0m[35m        configured for the user. A remote user has no password and cannot log in except via SSO.[0m
[30;1m80 | [0m[35m        Otherwise, a password must be set that meets complexity requirements.[0m

[31m--[ [0m[34mMatch #[0m[33m1377[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m.userInfo[0m
[30;1m302 | [0m[35mdef whoami() -> User:[0m
[30;1m303 | [0m[35m    """Get the current User."""[0m
[30;1m304 | [0m[35m    assert _determined is not None[0m
[30;1m305 | [0m[35m    return _determined.whoami()[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m# DOES NOT REQUIRE SINGLETON (don't force a login in order to log out).[0m

[31m--[ [0m[34mMatch #[0m[33m1378[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m.userInfo[0m
[30;1m299 | [0m[35m[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m@_require_singleton[0m
[30;1m302 | [0m[35mdef whoami() -> User:[0m
[30;1m303 | [0m[35m    """Get the current User."""[0m
[30;1m304 | [0m[35m    assert _determined is not None[0m
[30;1m305 | [0m[35m    return _determined.whoami()[0m

[31m--[ [0m[34mMatch #[0m[33m1379[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m145 | [0m[35m        password (string, optional): The password associated with the user.[0m
[30;1m146 | [0m[35m        cert_path (string, optional): A path to a custom PEM-encoded certificate,[0m
[30;1m147 | [0m[35m            against which to validate the master.  (default: ``None``)[0m
[30;1m148 | [0m[35m        cert_name (string, optional): The name of the master hostname to use during certificate[0m
[30;1m149 | [0m[35m            validation. Normally this is taken from the master URL, but there may be cases where[0m
[30;1m150 | [0m[35m            the master is exposed on multiple networks that this value might need to be[0m
[30;1m151 | [0m[35m            overridden. (default: ``None``)[0m

[31m--[ [0m[34mMatch #[0m[33m1380[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m259 | [0m[35m        - Must be at least 8 characters long.[0m
[30;1m260 | [0m[35m        - Must contain at least one upper-case letter.[0m
[30;1m261 | [0m[35m        - Must contain at least one lower-case letter.[0m
[30;1m262 | [0m[35m        - Must contain at least one number.[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m    Arg:[0m
[30;1m265 | [0m[35m        username: username of the user.[0m

[31m--[ [0m[34mMatch #[0m[33m1381[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m    The complexity requirements are:[0m
[30;1m259 | [0m[35m        - Must be at least 8 characters long.[0m
[30;1m260 | [0m[35m        - Must contain at least one upper-case letter.[0m
[30;1m261 | [0m[35m        - Must contain at least one lower-case letter.[0m
[30;1m262 | [0m[35m        - Must contain at least one number.[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m    Arg:[0m

[31m--[ [0m[34mMatch #[0m[33m1382[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    The complexity requirements are:[0m
[30;1m259 | [0m[35m        - Must be at least 8 characters long.[0m
[30;1m260 | [0m[35m        - Must contain at least one upper-case letter.[0m
[30;1m261 | [0m[35m        - Must contain at least one lower-case letter.[0m
[30;1m262 | [0m[35m        - Must contain at least one number.[0m
[30;1m263 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1383[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m256 | [0m[35m    Otherwise, a password must be set that meets complexity requirements.[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    The complexity requirements are:[0m
[30;1m259 | [0m[35m        - Must be at least 8 characters long.[0m
[30;1m260 | [0m[35m        - Must contain at least one upper-case letter.[0m
[30;1m261 | [0m[35m        - Must contain at least one lower-case letter.[0m
[30;1m262 | [0m[35m        - Must contain at least one number.[0m

[31m--[ [0m[34mMatch #[0m[33m1384[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    It is often unnecessary to call ``login()``.  If you have configured your environment so that[0m
[30;1m120 | [0m[35m    the Determined CLI works without any extra arguments or environment variables, you should not[0m
[30;1m121 | [0m[35m    have to call ``login()`` at all.[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    If you do need to call ``login()``, it must be called before any calling any other functions[0m
[30;1m124 | [0m[35m    from this module, otherwise it will fail.[0m

[31m--[ [0m[34mMatch #[0m[33m1385[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    Arguments:[0m
[30;1m524 | [0m[35m        sort_by: Which field to sort by. See :class:`~determined.experimental.ModelSortBy`.[0m
[30;1m525 | [0m[35m        order_by: Whether to sort in ascending or descending order. See[0m
[30;1m526 | [0m[35m            :class:`~determined.experimental.OrderBy`.[0m
[30;1m527 | [0m[35m        name: If this parameter is set, models will be filtered to only[0m
[30;1m528 | [0m[35m            include models with names matching this parameter.[0m

[31m--[ [0m[34mMatch #[0m[33m1386[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m521 | [0m[35m    """Get a list of all models in the model registry.[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    Arguments:[0m
[30;1m524 | [0m[35m        sort_by: Which field to sort by. See :class:`~determined.experimental.ModelSortBy`.[0m
[30;1m525 | [0m[35m        order_by: Whether to sort in ascending or descending order. See[0m
[30;1m526 | [0m[35m            :class:`~determined.experimental.OrderBy`.[0m
[30;1m527 | [0m[35m        name: If this parameter is set, models will be filtered to only[0m

[31m--[ [0m[34mMatch #[0m[33m1387[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m    Args:[0m
[30;1m495 | [0m[35m        sort_by: Which field to sort by. See :class:`~determined.experimental.client.ModelSortBy`.[0m
[30;1m496 | [0m[35m        order_by: Whether to sort in ascending or descending order. See[0m
[30;1m497 | [0m[35m            :class:`~determined.experimental.client.OrderBy`.[0m
[30;1m498 | [0m[35m        name: If this parameter is set, models will be filtered to only[0m
[30;1m499 | [0m[35m            include models with names matching this parameter.[0m

[31m--[ [0m[34mMatch #[0m[33m1388[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m492 | [0m[35m    """Get a list of all models in the model registry.[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m    Args:[0m
[30;1m495 | [0m[35m        sort_by: Which field to sort by. See :class:`~determined.experimental.client.ModelSortBy`.[0m
[30;1m496 | [0m[35m        order_by: Whether to sort in ascending or descending order. See[0m
[30;1m497 | [0m[35m            :class:`~determined.experimental.client.OrderBy`.[0m
[30;1m498 | [0m[35m        name: If this parameter is set, models will be filtered to only[0m

[31m--[ [0m[34mMatch #[0m[33m1389[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m250 | [0m[35m) -> User:[0m
[30;1m251 | [0m[35m    """Creates a user.[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    The user's credentials may be managed by a remote service (Enterprise edition only),[0m
[30;1m254 | [0m[35m    in which case the `remote` argument should be set to `true`, and then SSO should be[0m
[30;1m255 | [0m[35m    configured for the user. A remote user has no password and cannot log in except via SSO.[0m
[30;1m256 | [0m[35m    Otherwise, a password must be set that meets complexity requirements.[0m

[31m--[ [0m[34mMatch #[0m[33m1390[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m    Arguments:[0m
[30;1m219 | [0m[35m        sort_by: Which field to sort by. See[0m
[30;1m220 | [0m[35m            :class:`~determined.experimental.ExperimentSortBy`.[0m
[30;1m221 | [0m[35m        order_by: Whether to sort in ascending or descending order. See[0m
[30;1m222 | [0m[35m            :class:`~determined.experimental.OrderBy`.[0m
[30;1m223 | [0m[35m        name: If this parameter is set, experiments will be filtered to only include those[0m
[30;1m224 | [0m[35m            with names matching this parameter.[0m

[31m--[ [0m[34mMatch #[0m[33m1391[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m    """Get a list of experiments (:class:`~determined.experimental.Experiment`).[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    Arguments:[0m
[30;1m219 | [0m[35m        sort_by: Which field to sort by. See[0m
[30;1m220 | [0m[35m            :class:`~determined.experimental.ExperimentSortBy`.[0m
[30;1m221 | [0m[35m        order_by: Whether to sort in ascending or descending order. See[0m
[30;1m222 | [0m[35m            :class:`~determined.experimental.OrderBy`.[0m

[31m--[ [0m[34mMatch #[0m[33m1392[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m        # containers (deepspeed launcher, in this case) have exited.[0m
[30;1m289 | [0m[35m        cert = certs.default_load(info.master_url)[0m
[30;1m290 | [0m[35m        sess = authentication.login_from_task(info.master_url, cert=cert)[0m
[30;1m291 | [0m[35m        sess.post(f"/api/v1/allocations/{info.allocation_id}/resources/{resources_id}/daemon")[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        # Wrap it in a pid_server to ensure that we can't hang if a worker fails.[0m
[30;1m294 | [0m[35m        # This is useful for deepspeed which does not have good error handling for remote processes[0m

[31m--[ [0m[34mMatch #[0m[33m1393[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m    # network interface, if the value of "dtrain_network_interface" under[0m
[30;1m259 | [0m[35m    # "task_container_defaults" has been set in the "master.yaml".[0m
[30;1m260 | [0m[35m    if is_using_cuda() and not is_nccl_socket_ifname_env_var_set():[0m
[30;1m261 | [0m[35m        dtrain_network_interface = os.environ.get("DET_INTER_NODE_NETWORK_INTERFACE", None)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        if dtrain_network_interface is not None and len(dtrain_network_interface) > 0:[0m
[30;1m264 | [0m[35m            os.environ["NCCL_SOCKET_IFNAME"] = dtrain_network_interface[0m

[31m--[ [0m[34mMatch #[0m[33m1394[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m    check_deepspeed_version(multi_machine)[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m    # Hack: get the resources id from the environment.[0m
[30;1m245 | [0m[35m    resources_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m246 | [0m[35m    assert resources_id is not None, "Unable to run with DET_RESOURCES_ID unset"[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m    # The launch layer should provide the chief_ip to the training code, so that the training code[0m

[31m--[ [0m[34mMatch #[0m[33m1395[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m407 | [0m[35m        )[0m
[30;1m408 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m409 | [0m[35m    elif not script:[0m
[30;1m410 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m411 | [0m[35m        parser.print_usage()[0m
[30;1m412 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m413 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1396[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m    logger.debug(f"chief worker calling deepspeed with args: {cmd[1:]} ...")[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m    full_cmd = pid_server_cmd + cmd + pid_client_cmd + log_redirect_cmd + harness_cmd[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m    if not multi_machine:[0m
[30;1m332 | [0m[35m        p = subprocess.Popen(full_cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1397[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    pid_server_cmd = create_pid_server_cmd(info.allocation_id, len(info.slot_ids))[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m    cmd = create_run_command(master_address, hostfile_path)[0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m    pid_client_cmd = create_pid_client_cmd(info.allocation_id)[0m
[30;1m322 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1398[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35mif __name__ == "__main__":[0m
[30;1m419 | [0m[35m    script = parse_args(sys.argv[1:])[0m
[30;1m420 | [0m[35m    sys.exit(main(script))[0m

[31m--[ [0m[34mMatch #[0m[33m1399[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m412 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m413 | [0m[35m        sys.exit(1)[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m    return script[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35mif __name__ == "__main__":[0m
[30;1m419 | [0m[35m    script = parse_args(sys.argv[1:])[0m

[31m--[ [0m[34mMatch #[0m[33m1400[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m409 | [0m[35m    elif not script:[0m
[30;1m410 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m411 | [0m[35m        parser.print_usage()[0m
[30;1m412 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m413 | [0m[35m        sys.exit(1)[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m    return script[0m

[31m--[ [0m[34mMatch #[0m[33m1401[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m407 | [0m[35m        )[0m
[30;1m408 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m409 | [0m[35m    elif not script:[0m
[30;1m410 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m411 | [0m[35m        parser.print_usage()[0m
[30;1m412 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m413 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1402[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m405 | [0m[35m            FutureWarning,[0m
[30;1m406 | [0m[35m            stacklevel=2,[0m
[30;1m407 | [0m[35m        )[0m
[30;1m408 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m409 | [0m[35m    elif not script:[0m
[30;1m410 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m411 | [0m[35m        parser.print_usage()[0m

[31m--[ [0m[34mMatch #[0m[33m1403[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m400 | [0m[35m        warnings.warn([0m
[30;1m401 | [0m[35m            "Support for --trial argument to determined.launch.deepspeed has been deprecated "[0m
[30;1m402 | [0m[35m            "in Determined 0.38.0 and will be removed in a future version.  You can keep your "[0m
[30;1m403 | [0m[35m            "DeepSpeedTrial, but please replace your --trial argument with a script that uses the "[0m
[30;1m404 | [0m[35m            "new det.pytorch.deepspeed.Trainer() to train your DeepSpeedTrial.",[0m
[30;1m405 | [0m[35m            FutureWarning,[0m
[30;1m406 | [0m[35m            stacklevel=2,[0m

[31m--[ [0m[34mMatch #[0m[33m1404[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m389 | [0m[35m    )[0m
[30;1m390 | [0m[35m    parsed = parser.parse_args(args)[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m    script = parsed.script or [][0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m    if parsed.trial is not None:[0m
[30;1m395 | [0m[35m        if script:[0m

[31m--[ [0m[34mMatch #[0m[33m1405[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m377 | [0m[35m        "--trial",[0m
[30;1m378 | [0m[35m        help=([0m
[30;1m379 | [0m[35m            "(deprecated) use a Trial class as the entrypoint to training.  When --trial is used, "[0m
[30;1m380 | [0m[35m            "the SCRIPT positional argument must be omitted."[0m
[30;1m381 | [0m[35m        ),[0m
[30;1m382 | [0m[35m    )[0m
[30;1m383 | [0m[35m    # For training scripts.[0m

[31m--[ [0m[34mMatch #[0m[33m1406[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m368 | [0m[35m    parser = argparse.ArgumentParser([0m
[30;1m369 | [0m[35m        usage="%(prog)s (--trial TRIAL)|(SCRIPT...)",[0m
[30;1m370 | [0m[35m        description=([0m
[30;1m371 | [0m[35m            "Launch a script under deepspeed on a Determined cluster, with automatic handling of "[0m
[30;1m372 | [0m[35m            "IP addresses, sshd containers, and shutdown mechanics."[0m
[30;1m373 | [0m[35m        ),[0m
[30;1m374 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1407[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m338 | [0m[35m    # Set custom PDSH args:[0m
[30;1m339 | [0m[35m    # * bypass strict host checking[0m
[30;1m340 | [0m[35m    # * -p our custom port[0m
[30;1m341 | [0m[35m    # * other args are default ssh args for pdsh[0m
[30;1m342 | [0m[35m    os.environ["PDSH_SSH_ARGS"] = ([0m
[30;1m343 | [0m[35m        "-o PasswordAuthentication=no -o StrictHostKeyChecking=no "[0m
[30;1m344 | [0m[35m        f"-p {constants.DTRAIN_SSH_PORT} -2 -a -x %h"[0m

[31m--[ [0m[34mMatch #[0m[33m1408[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m    log_redirect_cmd = create_log_redirect_cmd()[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    harness_cmd = script[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m    logger.debug(f"chief worker calling deepspeed with args: {cmd[1:]} ...")[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m    full_cmd = pid_server_cmd + cmd + pid_client_cmd + log_redirect_cmd + harness_cmd[0m

[31m--[ [0m[34mMatch #[0m[33m1409[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m264 | [0m[35m            os.environ["NCCL_SOCKET_IFNAME"] = dtrain_network_interface[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m    # In some downstream training code, the hostfile is expected on all nodes so we create the[0m
[30;1m267 | [0m[35m    # hostfile on all nodes here before opening the non-chief node subprocess.  Since we[0m
[30;1m268 | [0m[35m    # use the allocation id to create the hostfile path, we register that path to an environment[0m
[30;1m269 | [0m[35m    # variable for access downstream.  A filelock is used to ensure we do not have clashing writes[0m
[30;1m270 | [0m[35m    # if the hostfile_path is on a shared filesystem.[0m

[31m--[ [0m[34mMatch #[0m[33m1410[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m250 | [0m[35m    # easiest way to get the chief_ip is with container_addrs.[0m
[30;1m251 | [0m[35m    chief_ip = info.container_addrs[0][0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    # Chief IP is set as an environment variable to support nested launch layers[0m
[30;1m254 | [0m[35m    os.environ["DET_CHIEF_IP"] = chief_ip[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    # If the NCCL_SOCKET_IFNAME environment variable wasn't explicitly set by[0m

[31m--[ [0m[34mMatch #[0m[33m1411[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m    raise ValueError([0m
[30;1m228 | [0m[35m        "This launcher is incompatible with deepspeed versions 0.6.1 to 0.6.4 due to an ssh check "[0m
[30;1m229 | [0m[35m        "in the upstream launcher that fails with our setup.  We perform our own ssh check by "[0m
[30;1m230 | [0m[35m        "default and can bypass this ssh check for deepspeed versions >= 0.6.5."[0m
[30;1m231 | [0m[35m    )[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1412[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m226 | [0m[35m        return[0m
[30;1m227 | [0m[35m    raise ValueError([0m
[30;1m228 | [0m[35m        "This launcher is incompatible with deepspeed versions 0.6.1 to 0.6.4 due to an ssh check "[0m
[30;1m229 | [0m[35m        "in the upstream launcher that fails with our setup.  We perform our own ssh check by "[0m
[30;1m230 | [0m[35m        "default and can bypass this ssh check for deepspeed versions >= 0.6.5."[0m
[30;1m231 | [0m[35m    )[0m
[30;1m232 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1413[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m    if deepspeed_version > version.parse("0.6.4"):[0m
[30;1m226 | [0m[35m        return[0m
[30;1m227 | [0m[35m    raise ValueError([0m
[30;1m228 | [0m[35m        "This launcher is incompatible with deepspeed versions 0.6.1 to 0.6.4 due to an ssh check "[0m
[30;1m229 | [0m[35m        "in the upstream launcher that fails with our setup.  We perform our own ssh check by "[0m
[30;1m230 | [0m[35m        "default and can bypass this ssh check for deepspeed versions >= 0.6.5."[0m
[30;1m231 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1414[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35mdef check_deepspeed_version(multi_machine: bool) -> None:[0m
[30;1m218 | [0m[35m    if not multi_machine:[0m
[30;1m219 | [0m[35m        return[0m
[30;1m220 | [0m[35m    # Upstream deepspeed added an ssh check from 0.6.1 onwards that does not have the[0m
[30;1m221 | [0m[35m    # StrictHostKeyChecking=no arg and fails with our agents.  A PR adding a no_ssh_check arg[0m
[30;1m222 | [0m[35m    # to bypass this should land for versions 0.6.5 and onwards.[0m
[30;1m223 | [0m[35m    if deepspeed_version <= version.parse("0.6.0"):[0m

[31m--[ [0m[34mMatch #[0m[33m1415[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m        deepspeed_process_cmd += ["-H", hostfile_path][0m
[30;1m210 | [0m[35m    deepspeed_process_cmd += ["--master_addr", master_address, "--no_python", "--no_local_rank"][0m
[30;1m211 | [0m[35m    if deepspeed_version > version.parse("0.6.4"):[0m
[30;1m212 | [0m[35m        deepspeed_process_cmd.append("--no_ssh_check")  # Bypass deepspeed's ssh check.[0m
[30;1m213 | [0m[35m    deepspeed_process_cmd.append("--")[0m
[30;1m214 | [0m[35m    return deepspeed_process_cmd[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1416[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35mdef create_deepspeed_env_file() -> None:[0m
[30;1m172 | [0m[35m    """Create an env var export file to pass Determined vars to the deepspeed launcher."""[0m
[30;1m173 | [0m[35m    with open(runner.DEEPSPEED_ENVIRONMENT_NAME, "w") as f:[0m
[30;1m174 | [0m[35m        for k, v in filter_env_vars(os.environ).items():[0m
[30;1m175 | [0m[35m            # We need to turn our envvars into shell-escaped strings to export them correctly[0m

[31m--[ [0m[34mMatch #[0m[33m1417[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m        if not any(x.match(k) for x in excludes):[0m
[30;1m161 | [0m[35m            return True[0m
[30;1m162 | [0m[35m        logger.debug([0m
[30;1m163 | [0m[35m            f"Excluding environment variable {k}={v} from training script environment, "[0m
[30;1m164 | [0m[35m            "since it is likely unsafe to share between workers."[0m
[30;1m165 | [0m[35m        )[0m
[30;1m166 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m1418[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m    """[0m
[30;1m138 | [0m[35m    Calculate all non-dangerous environment variables that we can pass to training workers.[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m    By default, the deepspeed launcher only keeps env vars that start with one of the following[0m
[30;1m141 | [0m[35m    ["NCCL", "PYTHON", "MV2", "UCX"].[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    We modify this behavior to include all environment variables except for ones we know to be[0m

[31m--[ [0m[34mMatch #[0m[33m1419[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m    assert len(host_slot_counts) == len(ip_addresses), "don't know slots for each node"[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    trial_runner_hosts = ip_addresses.copy()[0m
[30;1m71 | [0m[35m    # In the single node case, deepspeed doesn't use pdsh so we don't need to launch sshd.[0m
[30;1m72 | [0m[35m    # Instead, the deepspeed launcher will use localhost as the chief worker ip.[0m
[30;1m73 | [0m[35m    if len(ip_addresses) == 1:[0m
[30;1m74 | [0m[35m        trial_runner_hosts[0] = "localhost"[0m

[31m--[ [0m[34mMatch #[0m[33m1420[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport shlex[0m
[30;1m12 | [0m[35mimport subprocess[0m
[30;1m13 | [0m[35mimport sys[0m
[30;1m14 | [0m[35mimport time[0m
[30;1m15 | [0m[35mimport warnings[0m
[30;1m16 | [0m[35mfrom typing import Dict, List, Mapping, Optional[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mimport deepspeed[0m

[31m--[ [0m[34mMatch #[0m[33m1421[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/deepspeed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mdeepspeed.py is the launch layer for DeepSpeedTrial in Determined.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mIt launches the entrypoint script using DeepSpeed's launch process.[0m
[30;1m5 | [0m[35m"""[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport argparse[0m

[31m--[ [0m[34mMatch #[0m[33m1422[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m965 | [0m[35m        """[0m
[30;1m966 | [0m[35m        Return the data configuration.[0m
[30;1m967 | [0m[35m        """[0m
[30;1m968 | [0m[35m        return self.get_experiment_config().get("data", {})[0m
[30;1m969 | [0m[35m[0m
[30;1m970 | [0m[35m    def get_experiment_id(self) -> int:[0m
[30;1m971 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1423[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m874 | [0m[35m            optimizer.synchronize()  # type: ignore[0m
[30;1m875 | [0m[35m[0m
[30;1m876 | [0m[35m        parameters = ([0m
[30;1m877 | [0m[35m            [p for group in optimizer.param_groups for p in group.get("params", [])][0m
[30;1m878 | [0m[35m            if not self._use_apex[0m
[30;1m879 | [0m[35m            else apex.amp.master_params(optimizer)[0m
[30;1m880 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1424[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m466 | [0m[35m        a ``torch.optim.Optimizer`` doesn't store parameter names, and we need the names of[0m
[30;1m467 | [0m[35m        the parameters when mapping parameters to each ``horovod.DistributedOptimizer``.[0m
[30;1m468 | [0m[35m        """[0m
[30;1m469 | [0m[35m        opt_params = {p for group in optimizer.param_groups for p in group.get("params", [])}[0m
[30;1m470 | [0m[35m        return [(name, p) for name, p in self._main_model.named_parameters() if p in opt_params][0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m    def _init_device(self) -> torch.device:[0m

[31m--[ [0m[34mMatch #[0m[33m1425[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m                slots_per_trial=slots_per_trial,[0m
[30;1m74 | [0m[35m                trialname="PyTorchTrial",[0m
[30;1m75 | [0m[35m            )[0m
[30;1m76 | [0m[35m            if hparams and hparams.get("global_batch_size", None)[0m
[30;1m77 | [0m[35m            else (None, None)[0m
[30;1m78 | [0m[35m        )[0m
[30;1m79 | [0m[35m        self._hparams = hparams[0m

[31m--[ [0m[34mMatch #[0m[33m1426[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1030 | [0m[35m    def _maybe_reset_tbd_writer(self) -> None:[0m
[30;1m1031 | [0m[35m        """[0m
[30;1m1032 | [0m[35m        Reset (close current file and open a new one) the current writer if the current epoch[0m
[30;1m1033 | [0m[35m        second is at least one second greater than the epoch second of the last reset.[0m
[30;1m1034 | [0m[35m[0m
[30;1m1035 | [0m[35m        The TensorFlow event writer names each event file by the epoch second it is created, so[0m
[30;1m1036 | [0m[35m        if events are written quickly in succession (< 1 second apart), they will overwrite each[0m

[31m--[ [0m[34mMatch #[0m[33m1427[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1013 | [0m[35m            # without actually importing distutils.version.  We can workaround this by prepopulating[0m
[30;1m1014 | [0m[35m            # the distutils.version submodule in the distutils module.[0m
[30;1m1015 | [0m[35m            #[0m
[30;1m1016 | [0m[35m            # Except, starting with python 3.12 distutils isn't available at all.[0m
[30;1m1017 | [0m[35m            try:[0m
[30;1m1018 | [0m[35m                import distutils.version  # noqa: F401[0m
[30;1m1019 | [0m[35m            except ImportError:[0m

[31m--[ [0m[34mMatch #[0m[33m1428[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m497 | [0m[35m        """Map generated data to the device allocated by the Determined cluster.[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m        All the data in the data loader and the models are automatically moved to the[0m
[30;1m500 | [0m[35m        allocated device. This method aims at providing a function for the data generated[0m
[30;1m501 | [0m[35m        on the fly.[0m
[30;1m502 | [0m[35m        """[0m
[30;1m503 | [0m[35m        return pytorch.to_device(data, self.device, self._to_device_warned_types)[0m

[31m--[ [0m[34mMatch #[0m[33m1429[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m989 | [0m[35m        """[0m
[30;1m990 | [0m[35m        This function returns an instance of ``torch.utils.tensorboard.SummaryWriter``[0m
[30;1m991 | [0m[35m[0m
[30;1m992 | [0m[35m        Trials users who wish to log to TensorBoard can use this writer object.[0m
[30;1m993 | [0m[35m        We provide and manage a writer in order to save and upload TensorBoard[0m
[30;1m994 | [0m[35m        files automatically on behalf of the user.[0m
[30;1m995 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1430[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m580 | [0m[35m  Model(s) to modify/cast.[0m
[30;1m581 | [0m[35m            optimizers (``torch.optim.Optimizer`` or list of ``torch.optim.Optimizer`` s):[0m
[30;1m582 | [0m[35m                Optimizers to modify/cast. REQUIRED for training.[0m
[30;1m583 | [0m[35m            enabled (bool, optional, default=True):  If False, renders all Amp calls no-ops,[0m
[30;1m584 | [0m[35m                so your script should run as if Amp were not present.[0m
[30;1m585 | [0m[35m            opt_level (str, optional, default="O1"):  Pure or mixed precision optimization level.[0m
[30;1m586 | [0m[35m                Accepted values are "O0", "O1", "O2", and "O3", explained in detail above.[0m

[31m--[ [0m[34mMatch #[0m[33m1431[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m            )[0m
[30;1m179 | [0m[35m        if name not in self.get_hparams():[0m
[30;1m180 | [0m[35m            raise ValueError([0m
[30;1m181 | [0m[35m                "Could not find name '{}' in experiment "[0m
[30;1m182 | [0m[35m                "hyperparameters. Please check your experiment "[0m
[30;1m183 | [0m[35m                "configuration 'hyperparameters' section.".format(name)[0m
[30;1m184 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1432[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport contextlib[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport pathlib[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport warnings[0m
[30;1m6 | [0m[35mfrom typing import Any, Callable, Dict, Iterator, List, Optional, Set, Tuple, Type, Union[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport torch[0m

[31m--[ [0m[34mMatch #[0m[33m1433[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1078 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m
[30;1m1079 | [0m[35m            # checkpoints should only persist batches_trained and epochs_trained[0m
[30;1m1080 | [0m[35m            batches_trained=state.get("steps_completed"),[0m
[30;1m1081 | [0m[35m            epochs_trained=self._get_epoch_idx(state.get("steps_completed")),[0m
[30;1m1082 | [0m[35m        )[0m
[30;1m1083 | [0m[35m[0m
[30;1m1084 | [0m[35m        assert self.state[0m

[31m--[ [0m[34mMatch #[0m[33m1434[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1077 | [0m[35m            step_id=state.get("step_id"),[0m
[30;1m1078 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m
[30;1m1079 | [0m[35m            # checkpoints should only persist batches_trained and epochs_trained[0m
[30;1m1080 | [0m[35m            batches_trained=state.get("steps_completed"),[0m
[30;1m1081 | [0m[35m            epochs_trained=self._get_epoch_idx(state.get("steps_completed")),[0m
[30;1m1082 | [0m[35m        )[0m
[30;1m1083 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1435[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1074 | [0m[35m            trial_id=state.get("trial_id"),[0m
[30;1m1075 | [0m[35m            last_ckpt=state.get("last_ckpt"),[0m
[30;1m1076 | [0m[35m            last_val=state.get("last_val"),[0m
[30;1m1077 | [0m[35m            step_id=state.get("step_id"),[0m
[30;1m1078 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m
[30;1m1079 | [0m[35m            # checkpoints should only persist batches_trained and epochs_trained[0m
[30;1m1080 | [0m[35m            batches_trained=state.get("steps_completed"),[0m

[31m--[ [0m[34mMatch #[0m[33m1436[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1073 | [0m[35m        self.state = pytorch._TrialState([0m
[30;1m1074 | [0m[35m            trial_id=state.get("trial_id"),[0m
[30;1m1075 | [0m[35m            last_ckpt=state.get("last_ckpt"),[0m
[30;1m1076 | [0m[35m            last_val=state.get("last_val"),[0m
[30;1m1077 | [0m[35m            step_id=state.get("step_id"),[0m
[30;1m1078 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m
[30;1m1079 | [0m[35m            # checkpoints should only persist batches_trained and epochs_trained[0m

[31m--[ [0m[34mMatch #[0m[33m1437[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1072 | [0m[35m[0m
[30;1m1073 | [0m[35m        self.state = pytorch._TrialState([0m
[30;1m1074 | [0m[35m            trial_id=state.get("trial_id"),[0m
[30;1m1075 | [0m[35m            last_ckpt=state.get("last_ckpt"),[0m
[30;1m1076 | [0m[35m            last_val=state.get("last_val"),[0m
[30;1m1077 | [0m[35m            step_id=state.get("step_id"),[0m
[30;1m1078 | [0m[35m            # steps_completed is a legacy field kept to support loading from older checkpoints.[0m

[31m--[ [0m[34mMatch #[0m[33m1438[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1071 | [0m[35m            return[0m
[30;1m1072 | [0m[35m[0m
[30;1m1073 | [0m[35m        self.state = pytorch._TrialState([0m
[30;1m1074 | [0m[35m            trial_id=state.get("trial_id"),[0m
[30;1m1075 | [0m[35m            last_ckpt=state.get("last_ckpt"),[0m
[30;1m1076 | [0m[35m            last_val=state.get("last_val"),[0m
[30;1m1077 | [0m[35m            step_id=state.get("step_id"),[0m

[31m--[ [0m[34mMatch #[0m[33m1439[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1066 | [0m[35m            self.state.last_val = self.state.batches_trained[0m
[30;1m1067 | [0m[35m[0m
[30;1m1068 | [0m[35m    def _load_wlsq_state(self, state: Any) -> None:[0m
[30;1m1069 | [0m[35m        if state.get("trial_id") != self.trial_id:[0m
[30;1m1070 | [0m[35m            self.state = pytorch._TrialState(trial_id=self.trial_id)[0m
[30;1m1071 | [0m[35m            return[0m
[30;1m1072 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1440[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1050 | [0m[35m        # Load our state from the checkpoint if we are continuing training after a pause or restart.[0m
[30;1m1051 | [0m[35m        # If the trial_id doesn't match our current trial id, we're continuing training a previous[0m
[30;1m1052 | [0m[35m        # trial and should start from a fresh state.[0m
[30;1m1053 | [0m[35m        if state.get("trial_id") != self.trial_id:[0m
[30;1m1054 | [0m[35m            self.state = pytorch._TrialState(trial_id=self.trial_id)[0m
[30;1m1055 | [0m[35m            return[0m
[30;1m1056 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1441[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1024 | [0m[35m        else:[0m
[30;1m1025 | [0m[35m            logger.warning("The checkpoint has no random state to restore.")[0m
[30;1m1026 | [0m[35m[0m
[30;1m1027 | [0m[35m        callback_state = checkpoint.get("callbacks", {})[0m
[30;1m1028 | [0m[35m        for name in self.callbacks:[0m
[30;1m1029 | [0m[35m            if name in callback_state:[0m
[30;1m1030 | [0m[35m                self.callbacks[name].load_state_dict(callback_state[name])[0m

[31m--[ [0m[34mMatch #[0m[33m1442[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m862 | [0m[35m            # We report "batch" and "epoch" only if these keys are not already reported in user[0m
[30;1m863 | [0m[35m            # metrics.[0m
[30;1m864 | [0m[35m            metrics["batches"] = metrics.get("batches", self.state.batches_trained)[0m
[30;1m865 | [0m[35m            metrics["epochs"] = metrics.get("epochs", self.state.epochs_trained)[0m
[30;1m866 | [0m[35m[0m
[30;1m867 | [0m[35m            self.core_context.train.report_validation_metrics([0m
[30;1m868 | [0m[35m                steps_completed=self.state.batches_trained, metrics=metrics[0m

[31m--[ [0m[34mMatch #[0m[33m1443[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m861 | [0m[35m[0m
[30;1m862 | [0m[35m            # We report "batch" and "epoch" only if these keys are not already reported in user[0m
[30;1m863 | [0m[35m            # metrics.[0m
[30;1m864 | [0m[35m            metrics["batches"] = metrics.get("batches", self.state.batches_trained)[0m
[30;1m865 | [0m[35m            metrics["epochs"] = metrics.get("epochs", self.state.epochs_trained)[0m
[30;1m866 | [0m[35m[0m
[30;1m867 | [0m[35m            self.core_context.train.report_validation_metrics([0m

[31m--[ [0m[34mMatch #[0m[33m1444[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m        # We report "batch" and "epoch" only if these keys are not already reported in user[0m
[30;1m200 | [0m[35m        # metrics.[0m
[30;1m201 | [0m[35m        avg_metrics["batches"] = avg_metrics.get("batches", self.state.batches_trained)[0m
[30;1m202 | [0m[35m        avg_metrics["epochs"] = avg_metrics.get("epochs", self.state.epochs_trained)[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        self.core_context.train.report_training_metrics([0m
[30;1m205 | [0m[35m            steps_completed=self.state.batches_trained,[0m

[31m--[ [0m[34mMatch #[0m[33m1445[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m        # We report "batch" and "epoch" only if these keys are not already reported in user[0m
[30;1m200 | [0m[35m        # metrics.[0m
[30;1m201 | [0m[35m        avg_metrics["batches"] = avg_metrics.get("batches", self.state.batches_trained)[0m
[30;1m202 | [0m[35m        avg_metrics["epochs"] = avg_metrics.get("epochs", self.state.epochs_trained)[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        self.core_context.train.report_training_metrics([0m

[31m--[ [0m[34mMatch #[0m[33m1446[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        # Only report on the chief worker[0m
[30;1m186 | [0m[35m        avg_metrics = metrics.get("avg_metrics", {})[0m
[30;1m187 | [0m[35m        batch_metrics = metrics.get("batch_metrics", [])[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m        assert self.state[0m
[30;1m190 | [0m[35m        if self.context.get_enable_tensorboard_logging():[0m

[31m--[ [0m[34mMatch #[0m[33m1447[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m            return {}[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        # Only report on the chief worker[0m
[30;1m186 | [0m[35m        avg_metrics = metrics.get("avg_metrics", {})[0m
[30;1m187 | [0m[35m        batch_metrics = metrics.get("batch_metrics", [])[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m        assert self.state[0m

[31m--[ [0m[34mMatch #[0m[33m1448[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m777 | [0m[35m                        "metrics; "[0m
[30;1m778 | [0m[35m                        f"got {vld_metrics}.",[0m
[30;1m779 | [0m[35m                    )[0m
[30;1m780 | [0m[35m                # TODO: For performance perform -> cpu() only at the end of validation.[0m
[30;1m781 | [0m[35m                batch_metrics.append(pytorch._convert_metrics_to_numpy(vld_metrics))[0m
[30;1m782 | [0m[35m                if self.test_mode:[0m
[30;1m783 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m1449[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m751 | [0m[35m            for callback in self.callbacks.values():[0m
[30;1m752 | [0m[35m                callback.on_validation_epoch_start()[0m
[30;1m753 | [0m[35m[0m
[30;1m754 | [0m[35m            idx = -1  # Later, we'll use this default to see if we've iterated at all.[0m
[30;1m755 | [0m[35m            for idx, batch in enumerate(iter(self.validation_loader)):[0m
[30;1m756 | [0m[35m                if self.context.experimental._auto_to_device:[0m
[30;1m757 | [0m[35m                    batch = self.context.to_device(batch)[0m

[31m--[ [0m[34mMatch #[0m[33m1450[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m693 | [0m[35m                self.context.profiler.step()[0m
[30;1m694 | [0m[35m[0m
[30;1m695 | [0m[35m        if self._should_update_scaler():[0m
[30;1m696 | [0m[35m            # We update the scaler once after train_batch is done because the GradScaler is[0m
[30;1m697 | [0m[35m            # expected to be one-per-training-loop, with one .update() call after all .step(opt)[0m
[30;1m698 | [0m[35m            # calls for that batch are completed [1].[0m
[30;1m699 | [0m[35m            #[0m

[31m--[ [0m[34mMatch #[0m[33m1451[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m        # We define on_shutdown here instead of inside the `for callback in...` loop to ensure we[0m
[30;1m407 | [0m[35m        # don't bind the loop iteration variable `callback`, which would likely cause us to call[0m
[30;1m408 | [0m[35m        # on_trial_shutdown() multiple times for the final callback, and not at all for the others.[0m
[30;1m409 | [0m[35m        def on_shutdown(callback_name: str, on_trial_shutdown: Callable) -> None:[0m
[30;1m410 | [0m[35m            on_trial_shutdown()[0m
[30;1m411 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1452[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m152 | [0m[35m    @classmethod[0m
[30;1m153 | [0m[35m    def _set_random_seeds(cls: Type["_PyTorchTrialController"], seed: int) -> None:[0m
[30;1m154 | [0m[35m        # Set identical random seeds on all training processes.[0m
[30;1m155 | [0m[35m        # When using horovod, each worker will start at a unique[0m
[30;1m156 | [0m[35m        # offset in the dataset, ensuring that it is processing a unique[0m
[30;1m157 | [0m[35m        # training batch.[0m
[30;1m158 | [0m[35m        random.seed(seed)[0m

[31m--[ [0m[34mMatch #[0m[33m1453[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m            )[0m
[30;1m113 | [0m[35m        if len(self.context.optimizers) == 0:[0m
[30;1m114 | [0m[35m            raise det.errors.InvalidExperimentException([0m
[30;1m115 | [0m[35m                "Must have at least one optimizer. "[0m
[30;1m116 | [0m[35m                "This might be caused by not wrapping your optimizer with wrap_optimizer().",[0m
[30;1m117 | [0m[35m            )[0m
[30;1m118 | [0m[35m        self._check_evaluate_implementation()[0m

[31m--[ [0m[34mMatch #[0m[33m1454[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        if len(self.context.models) == 0:[0m
[30;1m109 | [0m[35m            raise det.errors.InvalidExperimentException([0m
[30;1m110 | [0m[35m                "Must have at least one model. "[0m
[30;1m111 | [0m[35m                "This might be caused by not wrapping your model with wrap_model().",[0m
[30;1m112 | [0m[35m            )[0m
[30;1m113 | [0m[35m        if len(self.context.optimizers) == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m1455[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_pytorch_trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport pickle[0m
[30;1m8 | [0m[35mimport random[0m
[30;1m9 | [0m[35mimport sys[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport warnings[0m
[30;1m12 | [0m[35mfrom typing import Any, Callable, Dict, Iterator, List, Optional, Tuple, Type, Union[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport numpy as np[0m

[31m--[ [0m[34mMatch #[0m[33m1456[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m443 | [0m[35m            training = ckpt.training[0m
[30;1m444 | [0m[35m            assert training[0m
[30;1m445 | [0m[35m            metric = training.validation_metrics.get("avgMetrics") or {}[0m
[30;1m446 | [0m[35m            metric = metric.get(sort_by)[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m            # Return a bool here to sort checkpoints that may have no validation metrics.[0m
[30;1m449 | [0m[35m            if reverse:[0m

[31m--[ [0m[34mMatch #[0m[33m1457[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m442 | [0m[35m        def key(ckpt: checkpoint.Checkpoint) -> Any:[0m
[30;1m443 | [0m[35m            training = ckpt.training[0m
[30;1m444 | [0m[35m            assert training[0m
[30;1m445 | [0m[35m            metric = training.validation_metrics.get("avgMetrics") or {}[0m
[30;1m446 | [0m[35m            metric = metric.get(sort_by)[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m            # Return a bool here to sort checkpoints that may have no validation metrics.[0m

[31m--[ [0m[34mMatch #[0m[33m1458[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m432 | [0m[35m                    "no searcher.metric found in experiment config; please provide a sort_by metric"[0m
[30;1m433 | [0m[35m                )[0m
[30;1m434 | [0m[35m            sort_by = searcher_metric[0m
[30;1m435 | [0m[35m            smaller_is_better = config.get("searcher", {}).get("smaller_is_better", True)[0m
[30;1m436 | [0m[35m            order_by = OrderBy.ASC if smaller_is_better else OrderBy.DESC[0m
[30;1m437 | [0m[35m[0m
[30;1m438 | [0m[35m        assert sort_by is not None and order_by is not None, "sort_by and order_by not defined."[0m

[31m--[ [0m[34mMatch #[0m[33m1459[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m432 | [0m[35m                    "no searcher.metric found in experiment config; please provide a sort_by metric"[0m
[30;1m433 | [0m[35m                )[0m
[30;1m434 | [0m[35m            sort_by = searcher_metric[0m
[30;1m435 | [0m[35m            smaller_is_better = config.get("searcher", {}).get("smaller_is_better", True)[0m
[30;1m436 | [0m[35m            order_by = OrderBy.ASC if smaller_is_better else OrderBy.DESC[0m
[30;1m437 | [0m[35m[0m
[30;1m438 | [0m[35m        assert sort_by is not None and order_by is not None, "sort_by and order_by not defined."[0m

[31m--[ [0m[34mMatch #[0m[33m1460[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m            training = checkpoints[0].training[0m
[30;1m427 | [0m[35m            assert training[0m
[30;1m428 | [0m[35m            config = training.experiment_config[0m
[30;1m429 | [0m[35m            searcher_metric = config.get("searcher", {}).get("metric")[0m
[30;1m430 | [0m[35m            if not isinstance(searcher_metric, str):[0m
[30;1m431 | [0m[35m                raise ValueError([0m
[30;1m432 | [0m[35m                    "no searcher.metric found in experiment config; please provide a sort_by metric"[0m

[31m--[ [0m[34mMatch #[0m[33m1461[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m            training = checkpoints[0].training[0m
[30;1m427 | [0m[35m            assert training[0m
[30;1m428 | [0m[35m            config = training.experiment_config[0m
[30;1m429 | [0m[35m            searcher_metric = config.get("searcher", {}).get("metric")[0m
[30;1m430 | [0m[35m            if not isinstance(searcher_metric, str):[0m
[30;1m431 | [0m[35m                raise ValueError([0m
[30;1m432 | [0m[35m                    "no searcher.metric found in experiment config; please provide a sort_by metric"[0m

[31m--[ [0m[34mMatch #[0m[33m1462[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35m        All attributes are cached by default.[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        The :attr:`hparams` and :attr:`summary_metrics` attributes are mutable and may be changed[0m
[30;1m81 | [0m[35m        by methods that update these values, either automatically or explicitly with :meth:`reload`.[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    """[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1463[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35mclass TrialSortBy(enum.Enum):[0m
[30;1m549 | [0m[35m    """[0m
[30;1m550 | [0m[35m    Specifies the field to sort a list of trials on.[0m
[30;1m551 | [0m[35m    """[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m    ID = _tsb.ID.value[0m

[31m--[ [0m[34mMatch #[0m[33m1464[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m445 | [0m[35m            metric = training.validation_metrics.get("avgMetrics") or {}[0m
[30;1m446 | [0m[35m            metric = metric.get(sort_by)[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m            # Return a bool here to sort checkpoints that may have no validation metrics.[0m
[30;1m449 | [0m[35m            if reverse:[0m
[30;1m450 | [0m[35m                return metric is not None, metric[0m
[30;1m451 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1465[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m421 | [0m[35m        if isinstance(sort_by, checkpoint.CheckpointSortBy) or not checkpoints:[0m
[30;1m422 | [0m[35m            return checkpoints[0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35m        # If sort not specified, sort and order default to searcher configs.[0m
[30;1m425 | [0m[35m        if not sort_by:[0m
[30;1m426 | [0m[35m            training = checkpoints[0].training[0m
[30;1m427 | [0m[35m            assert training[0m

[31m--[ [0m[34mMatch #[0m[33m1466[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m421 | [0m[35m        if isinstance(sort_by, checkpoint.CheckpointSortBy) or not checkpoints:[0m
[30;1m422 | [0m[35m            return checkpoints[0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35m        # If sort not specified, sort and order default to searcher configs.[0m
[30;1m425 | [0m[35m        if not sort_by:[0m
[30;1m426 | [0m[35m            training = checkpoints[0].training[0m
[30;1m427 | [0m[35m            assert training[0m

[31m--[ [0m[34mMatch #[0m[33m1467[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m383 | [0m[35m        Arguments:[0m
[30;1m384 | [0m[35m            sort_by (string, :class:`~determined.experimental.CheckpointSortBy`): Which field to[0m
[30;1m385 | [0m[35m                sort by. Strings are assumed to be validation metric names.[0m
[30;1m386 | [0m[35m            order_by (:class:`~determined.experimental.OrderBy`): Whether to sort in[0m
[30;1m387 | [0m[35m                ascending or descending order.[0m
[30;1m388 | [0m[35m        """[0m
[30;1m389 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1468[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m        Arguments:[0m
[30;1m384 | [0m[35m            sort_by (string, :class:`~determined.experimental.CheckpointSortBy`): Which field to[0m
[30;1m385 | [0m[35m                sort by. Strings are assumed to be validation metric names.[0m
[30;1m386 | [0m[35m            order_by (:class:`~determined.experimental.OrderBy`): Whether to sort in[0m
[30;1m387 | [0m[35m                ascending or descending order.[0m
[30;1m388 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1469[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m328 | [0m[35m                in the related experiment configuration searcher field will be[0m
[30;1m329 | [0m[35m                used.[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m            smaller_is_better (bool, optional): Whether to sort the[0m
[30;1m332 | [0m[35m                metric above in ascending or descending order. If ``sort_by`` is unset,[0m
[30;1m333 | [0m[35m                this parameter is ignored. By default, the value of ``smaller_is_better``[0m
[30;1m334 | [0m[35m                from the experiment's configuration is used.[0m

[31m--[ [0m[34mMatch #[0m[33m1470[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m272 | [0m[35m                in the related experiment configuration searcher field will be[0m
[30;1m273 | [0m[35m                used.[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m            smaller_is_better (bool, optional): Whether to sort the[0m
[30;1m276 | [0m[35m                metric above in ascending or descending order. If ``sort_by`` is unset,[0m
[30;1m277 | [0m[35m                this parameter is ignored. By default, the value of ``smaller_is_better``[0m
[30;1m278 | [0m[35m                from the experiment's configuration is used.[0m

[31m--[ [0m[34mMatch #[0m[33m1471[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m        are considered.[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m        Arguments:[0m
[30;1m218 | [0m[35m            sort_by: (Optional) Parameter to sort checkpoints by. Accepts either[0m
[30;1m219 | [0m[35m                ``checkpoint.CheckpointSortBy`` or a string representing a validation metric name.[0m
[30;1m220 | [0m[35m            order_by: (Optional) Order of sorted checkpoints (ascending or descending).[0m
[30;1m221 | [0m[35m            max_results: (Optional) Maximum number of results to return. Defaults to no maximum.[0m

[31m--[ [0m[34mMatch #[0m[33m1472[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m        """[0m
[30;1m139 | [0m[35m        if head is not None and head < 0:[0m
[30;1m140 | [0m[35m            raise ValueError(f"head must be non-negative, got {head}")[0m
[30;1m141 | [0m[35m        if tail is not None and tail < 0:[0m
[30;1m142 | [0m[35m            raise ValueError(f"tail must be non-negative, got {tail}")[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m        if ([0m

[31m--[ [0m[34mMatch #[0m[33m1473[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m        """[0m
[30;1m139 | [0m[35m        if head is not None and head < 0:[0m
[30;1m140 | [0m[35m            raise ValueError(f"head must be non-negative, got {head}")[0m
[30;1m141 | [0m[35m        if tail is not None and tail < 0:[0m
[30;1m142 | [0m[35m            raise ValueError(f"tail must be non-negative, got {tail}")[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m        if ([0m

[31m--[ [0m[34mMatch #[0m[33m1474[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m                the specified string.[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m        """[0m
[30;1m139 | [0m[35m        if head is not None and head < 0:[0m
[30;1m140 | [0m[35m            raise ValueError(f"head must be non-negative, got {head}")[0m
[30;1m141 | [0m[35m        if tail is not None and tail < 0:[0m
[30;1m142 | [0m[35m            raise ValueError(f"tail must be non-negative, got {tail}")[0m

[31m--[ [0m[34mMatch #[0m[33m1475[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m                the specified string.[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m        """[0m
[30;1m139 | [0m[35m        if head is not None and head < 0:[0m
[30;1m140 | [0m[35m            raise ValueError(f"head must be non-negative, got {head}")[0m
[30;1m141 | [0m[35m        if tail is not None and tail < 0:[0m
[30;1m142 | [0m[35m            raise ValueError(f"tail must be non-negative, got {tail}")[0m

[31m--[ [0m[34mMatch #[0m[33m1476[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m                logs after a certain time. Accepts either a string in RFC 3339 format[0m
[30;1m132 | [0m[35m                (eg. ``2021-10-26T23:17:12Z``) or an int representing the epoch second.[0m
[30;1m133 | [0m[35m            sources (List[str], optional): When set, returns only logs originating from specified[0m
[30;1m134 | [0m[35m                node name(s) (eg. ``master`` or ``agent``).[0m
[30;1m135 | [0m[35m            search_text (str, Optional): Filters individual logs to only return logs containing[0m
[30;1m136 | [0m[35m                the specified string.[0m
[30;1m137 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1477[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m                Mutually exclusive with ``head`` and ``tail``.  Defaults to ``False``.[0m
[30;1m115 | [0m[35m            head (int, optional): When set, only fetches the first ``head`` lines.  Mutually[0m
[30;1m116 | [0m[35m                exclusive with ``follow`` and ``tail``.  Defaults to ``None``.[0m
[30;1m117 | [0m[35m            tail (int, optional): When set, only fetches the first ``head`` lines.  Mutually[0m
[30;1m118 | [0m[35m                exclusive with ``follow`` and ``head``.  Defaults to ``None``.[0m
[30;1m119 | [0m[35m            container_ids (List[str], optional): When set, only fetch logs from lines from[0m
[30;1m120 | [0m[35m                specific containers.  Defaults to ``None``.[0m

[31m--[ [0m[34mMatch #[0m[33m1478[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/experimental/trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m        Arguments:[0m
[30;1m113 | [0m[35m            follow (bool, optional): If the iterable should block waiting for new logs to arrive.[0m
[30;1m114 | [0m[35m                Mutually exclusive with ``head`` and ``tail``.  Defaults to ``False``.[0m
[30;1m115 | [0m[35m            head (int, optional): When set, only fetches the first ``head`` lines.  Mutually[0m
[30;1m116 | [0m[35m                exclusive with ``follow`` and ``tail``.  Defaults to ``None``.[0m
[30;1m117 | [0m[35m            tail (int, optional): When set, only fetches the first ``head`` lines.  Mutually[0m
[30;1m118 | [0m[35m                exclusive with ``follow`` and ``head``.  Defaults to ``None``.[0m

[31m--[ [0m[34mMatch #[0m[33m1479[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/wrap_rank.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35mlineend = re.compile(rb"[\r\n]")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m# Duplicated in ship_logs.py.  If you find a bug here, fix it there too.[0m
[30;1m32 | [0m[35mdef read_newlines_or_carriage_returns(fd: io.RawIOBase) -> Iterator[str]:[0m
[30;1m33 | [0m[35m    r"""[0m
[30;1m34 | [0m[35m    Read lines, delineated by either '\n' or '\r.[0m

[31m--[ [0m[34mMatch #[0m[33m1480[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/wrap_rank.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mand stderr of the worker process to the stdout and stderr of the container.  The[0m
[30;1m10 | [0m[35mpurpose of this is to save network bandwidth when launchers like mpirun or[0m
[30;1m11 | [0m[35mhorovodrun are used, as they often are configured to send all logs from worker[0m
[30;1m12 | [0m[35mnodes to the chief node over the network.  This may be disabled with the[0m
[30;1m13 | [0m[35m``--no-redirect-stdio`` flag.[0m
[30;1m14 | [0m[35m"""[0m
[30;1m15 | [0m[35mimport argparse[0m

[31m--[ [0m[34mMatch #[0m[33m1481[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m512 | [0m[35m        pass[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    try:[0m
[30;1m515 | [0m[35m        if new_dict["environment"]["registry_auth"].get("password") is not None:[0m
[30;1m516 | [0m[35m            new_dict["environment"]["registry_auth"]["password"] = mask[0m
[30;1m517 | [0m[35m    except (KeyError, AttributeError):[0m
[30;1m518 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m1482[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m371 | [0m[35m            except Exception:[0m
[30;1m372 | [0m[35m                if time.time() > deadline:[0m
[30;1m373 | [0m[35m                    raise ValueError([0m
[30;1m374 | [0m[35m                        f"Chief machine was unable to connect to sshd on peer machine at "[0m
[30;1m375 | [0m[35m                        f"{peer_addr}:{port}"[0m
[30;1m376 | [0m[35m                    )[0m
[30;1m377 | [0m[35m                time.sleep(0.1)[0m

[31m--[ [0m[34mMatch #[0m[33m1483[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m    # When restarting from checkpoint, it is possible that the code path is already present[0m
[30;1m253 | [0m[35m    # in the checkpoint directory. This happens for EstimatorTrial because we overwrite the[0m
[30;1m254 | [0m[35m    # estimator model directory with the checkpoint folder at the start of training.[0m
[30;1m255 | [0m[35m    if code_path.exists():[0m
[30;1m256 | [0m[35m        rmtree_nfs_safe(str(code_path))[0m
[30;1m257 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1484[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m230 | [0m[35m            # Recurse into dicts.[0m
[30;1m231 | [0m[35m            return {k: jsonable(v) for k, v in obj.items()}[0m
[30;1m232 | [0m[35m        if isinstance(obj, np.ndarray):[0m
[30;1m233 | [0m[35m            # Expand arrays into lists, then recurse.[0m
[30;1m234 | [0m[35m            return jsonable(obj.tolist())[0m
[30;1m235 | [0m[35m        if isinstance(obj, datetime.datetime):[0m
[30;1m236 | [0m[35m            return obj.isoformat()[0m

[31m--[ [0m[34mMatch #[0m[33m1485[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m424 | [0m[35m[0m
[30;1m425 | [0m[35m    try:[0m
[30;1m426 | [0m[35m        children = psutil.Process(p.pid).children(recursive=True)[0m
[30;1m427 | [0m[35m        for cp in children:[0m
[30;1m428 | [0m[35m            cp.send_signal(signum)[0m
[30;1m429 | [0m[35m    except Exception as err:[0m
[30;1m430 | [0m[35m        logger.error(f"{err} trying to forward signal {signum} to children")[0m

[31m--[ [0m[34mMatch #[0m[33m1486[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m361 | [0m[35m            try:[0m
[30;1m362 | [0m[35m                # Connect to a socket to ensure sshd is listening.[0m
[30;1m363 | [0m[35m                sock.connect((peer_addr, port))[0m
[30;1m364 | [0m[35m                # The ssh protocol requires the server to serve an initial greeting.[0m
[30;1m365 | [0m[35m                # Receive part of that greeting to know that sshd is accepting/responding.[0m
[30;1m366 | [0m[35m                data = sock.recv(1)[0m
[30;1m367 | [0m[35m                if not data:[0m

[31m--[ [0m[34mMatch #[0m[33m1487[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m353 | [0m[35m    :param peer_addr: address of machine running SSHD[0m
[30;1m354 | [0m[35m    :param deadline: time to wait until SSHD ready[0m
[30;1m355 | [0m[35m    :param port: port on addresses running SSHD[0m
[30;1m356 | [0m[35m    :return: raises Exception if SSHD connection invalid or timeout on any peer[0m
[30;1m357 | [0m[35m    """[0m
[30;1m358 | [0m[35m    while True:[0m
[30;1m359 | [0m[35m        with socket.socket() as sock:[0m

[31m--[ [0m[34mMatch #[0m[33m1488[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m351 | [0m[35m    Waits for every peer machine to be ready to accept SSHD connections.[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m    :param peer_addr: address of machine running SSHD[0m
[30;1m354 | [0m[35m    :param deadline: time to wait until SSHD ready[0m
[30;1m355 | [0m[35m    :param port: port on addresses running SSHD[0m
[30;1m356 | [0m[35m    :return: raises Exception if SSHD connection invalid or timeout on any peer[0m
[30;1m357 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1489[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m276 | [0m[35m    in_list: List[Any], sorter: Callable[[List[Any]], List[Any]] = sorted[0m
[30;1m277 | [0m[35m) -> Set[Any]:[0m
[30;1m278 | [0m[35m    """[0m
[30;1m279 | [0m[35m    Find and return a set of duplicates from the list.[0m
[30;1m280 | [0m[35m    """[0m
[30;1m281 | [0m[35m    in_list = sorter(in_list)[0m
[30;1m282 | [0m[35m    last_item = None[0m

[31m--[ [0m[34mMatch #[0m[33m1490[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m        rmtree_nfs_safe(str(code_path))[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    # Most models can only be restored from a checkpoint if the original code is present. However,[0m
[30;1m259 | [0m[35m    # since it is rather common that users mount large, non-model files into their working directory[0m
[30;1m260 | [0m[35m    # (like data or their entire HOME directory), when we are training on-cluster we use a[0m
[30;1m261 | [0m[35m    # specially-prepared clean copy of the model rather than the working directory.[0m
[30;1m262 | [0m[35m    #[0m

[31m--[ [0m[34mMatch #[0m[33m1491[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m            # Recurse into dicts.[0m
[30;1m231 | [0m[35m            return {k: jsonable(v) for k, v in obj.items()}[0m
[30;1m232 | [0m[35m        if isinstance(obj, np.ndarray):[0m
[30;1m233 | [0m[35m            # Expand arrays into lists, then recurse.[0m
[30;1m234 | [0m[35m            return jsonable(obj.tolist())[0m
[30;1m235 | [0m[35m        if isinstance(obj, datetime.datetime):[0m
[30;1m236 | [0m[35m            return obj.isoformat()[0m

[31m--[ [0m[34mMatch #[0m[33m1492[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35mdef validate_batch_metrics(batch_metrics: List[Dict[str, Any]]) -> None:[0m
[30;1m159 | [0m[35m    metric_dict = _list_to_dict(batch_metrics)[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    # We expect that all batches have the same set of metrics.[0m
[30;1m162 | [0m[35m    metric_dict_keys = metric_dict.keys()[0m
[30;1m163 | [0m[35m    for idx, metric_dict in zip(range(len(batch_metrics)), batch_metrics):[0m
[30;1m164 | [0m[35m        keys = metric_dict.keys()[0m

[31m--[ [0m[34mMatch #[0m[33m1493[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35mimport socket[0m
[30;1m19 | [0m[35mimport stat[0m
[30;1m20 | [0m[35mimport subprocess[0m
[30;1m21 | [0m[35mimport time[0m
[30;1m22 | [0m[35mimport uuid[0m
[30;1m23 | [0m[35mfrom typing import ([0m
[30;1m24 | [0m[35m    Any,[0m
[30;1m25 | [0m[35m    Callable,[0m

[31m--[ [0m[34mMatch #[0m[33m1494[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        """[0m
[30;1m79 | [0m[35m        Return the data configuration.[0m
[30;1m80 | [0m[35m        """[0m
[30;1m81 | [0m[35m        return self.get_experiment_config().get("data", {})[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def get_experiment_id(self) -> int:[0m
[30;1m84 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1495[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m        """[0m
[30;1m108 | [0m[35m        if name not in self.env.hparams:[0m
[30;1m109 | [0m[35m            raise ValueError([0m
[30;1m110 | [0m[35m                "Could not find name '{}' in experiment "[0m
[30;1m111 | [0m[35m                "hyperparameters. Please check your experiment "[0m
[30;1m112 | [0m[35m                "configuration 'hyperparameters' section.".format(name)[0m
[30;1m113 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1496[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m        Arguments:[0m
[30;1m59 | [0m[35m            config: An experiment config file, in dictionary form.[0m
[30;1m60 | [0m[35m        """[0m
[30;1m61 | [0m[35m        core_context, env = det._make_local_execution_env([0m
[30;1m62 | [0m[35m            managed_training=False,[0m
[30;1m63 | [0m[35m            test_mode=False,[0m
[30;1m64 | [0m[35m            config=config,[0m

[31m--[ [0m[34mMatch #[0m[33m1497[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m        env: det.EnvContext,[0m
[30;1m20 | [0m[35m    ) -> None:[0m
[30;1m21 | [0m[35m        self._core = core_context[0m
[30;1m22 | [0m[35m        self.env = env[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self.distributed = self._core.distributed[0m
[30;1m25 | [0m[35m        self._stop_requested = False[0m
[30;1m26 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1498[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_rbac.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    """[0m
[30;1m92 | [0m[35m    resp = bindings.get_GetMaster(session)[0m
[30;1m93 | [0m[35m    msg = f"{category} '{name}' not found"[0m
[30;1m94 | [0m[35m    if not resp.to_json().get("rbacEnabled"):[0m
[30;1m95 | [0m[35m        return api.errors.NotFoundException(msg)[0m
[30;1m96 | [0m[35m    return api.errors.NotFoundException(msg + ", please check your permissions.")[0m

[31m--[ [0m[34mMatch #[0m[33m1499[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_rbac.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m    resp = bindings.post_GetGroups(session, body=body)[0m
[30;1m66 | [0m[35m    groups = resp.groups[0m
[30;1m67 | [0m[35m    if groups is None or len(groups) != 1 or groups[0].group.groupId is None:[0m
[30;1m68 | [0m[35m        raise api.errors.BadRequestException(f"could not find user group name {group_name}")[0m
[30;1m69 | [0m[35m    return groups[0].group.groupId[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1500[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_rbac.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    if missing_users:[0m
[30;1m57 | [0m[35m        raise api.errors.BadRequestException([0m
[30;1m58 | [0m[35m            f"could not find users for usernames {', '.join(missing_users)}"[0m
[30;1m59 | [0m[35m        )[0m
[30;1m60 | [0m[35m    return user_ids[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1501[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_rbac.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m    for r in resp.roles:[0m
[30;1m12 | [0m[35m        if r.name == role_name and r.roleId is not None:[0m
[30;1m13 | [0m[35m            return r.roleId[0m
[30;1m14 | [0m[35m    raise api.errors.BadRequestException(f"could not find role name {role_name}")[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mdef create_user_assignment_request([0m

[31m--[ [0m[34mMatch #[0m[33m1502[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m        # based only on task logs.[0m
[30;1m408 | [0m[35m        hostname = os.environ.get("HOSTNAME", "")[0m
[30;1m409 | [0m[35m        agent_id = os.environ.get("DET_AGENT_ID", "")[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m
[30;1m412 | [0m[35m        logger.info([0m
[30;1m413 | [0m[35m            f"Running task container on agent_id={agent_id}, hostname={hostname} "[0m

[31m--[ [0m[34mMatch #[0m[33m1503[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m406 | [0m[35m        # Log where we are running and what GPUs are attached so hardware failures can be traced[0m
[30;1m407 | [0m[35m        # based only on task logs.[0m
[30;1m408 | [0m[35m        hostname = os.environ.get("HOSTNAME", "")[0m
[30;1m409 | [0m[35m        agent_id = os.environ.get("DET_AGENT_ID", "")[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m
[30;1m412 | [0m[35m        logger.info([0m

[31m--[ [0m[34mMatch #[0m[33m1504[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m        resources._to_file()[0m
[30;1m406 | [0m[35m        # Log where we are running and what GPUs are attached so hardware failures can be traced[0m
[30;1m407 | [0m[35m        # based only on task logs.[0m
[30;1m408 | [0m[35m        hostname = os.environ.get("HOSTNAME", "")[0m
[30;1m409 | [0m[35m        agent_id = os.environ.get("DET_AGENT_ID", "")[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m

[31m--[ [0m[34mMatch #[0m[33m1505[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35mdef do_proxy(sess: api.Session, allocation_id: str) -> None:[0m
[30;1m330 | [0m[35m    r_type = os.environ.get("DET_RESOURCES_TYPE")[0m
[30;1m331 | [0m[35m    assert r_type, "Unable to complete rendezvous info without DET_RESOURCES_TYPE"[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m    if r_type == RESOURCES_TYPE_DOCKER_CONTAINER:[0m

[31m--[ [0m[34mMatch #[0m[33m1506[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m    if bool(os.environ.get("DET_PROXY_THROUGH_GATEWAY", None)):[0m
[30;1m315 | [0m[35m        return[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    pod_ip_str = os.environ.get("DET_KUBERNETES_POD_IP")[0m
[30;1m318 | [0m[35m    assert pod_ip_str, "Unable to complete rendezvous without DET_KUBERNETES_POD_IP"[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    bindings.post_PostAllocationProxyAddress([0m

[31m--[ [0m[34mMatch #[0m[33m1507[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m    # When using a gateway, we know the static IP in advance so we don't want to tell the[0m
[30;1m312 | [0m[35m    # master the pod IP. Handling this on the master side gets a little tricky with restore.[0m
[30;1m313 | [0m[35m    # For example we send this proxy address before master sends the allocation its address.[0m
[30;1m314 | [0m[35m    if bool(os.environ.get("DET_PROXY_THROUGH_GATEWAY", None)):[0m
[30;1m315 | [0m[35m        return[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    pod_ip_str = os.environ.get("DET_KUBERNETES_POD_IP")[0m

[31m--[ [0m[34mMatch #[0m[33m1508[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35mdef proxy_ifaces() -> List[str]:[0m
[30;1m277 | [0m[35m    # Manual override, for maximum flexibility.[0m
[30;1m278 | [0m[35m    proxy_ifaces = os.environ.get("DET_SLURM_PROXY_IFACE")[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m    if not proxy_ifaces:[0m
[30;1m281 | [0m[35m        return [][0m

[31m--[ [0m[34mMatch #[0m[33m1509[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m    r_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m258 | [0m[35m    assert r_id, "Unable to complete rendezvous info without DET_RESOURCES_ID"[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    r_type = os.environ.get("DET_RESOURCES_TYPE")[0m
[30;1m261 | [0m[35m    assert r_type, "Unable to complete rendezvous info without DET_RESOURCES_TYPE"[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    rendezvous_info = None[0m

[31m--[ [0m[34mMatch #[0m[33m1510[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35mdef do_rendezvous(sess: api.Session, allocation_id: str) -> None:[0m
[30;1m257 | [0m[35m    r_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m258 | [0m[35m    assert r_id, "Unable to complete rendezvous info without DET_RESOURCES_ID"[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    r_type = os.environ.get("DET_RESOURCES_TYPE")[0m

[31m--[ [0m[34mMatch #[0m[33m1511[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35mdef rendezvous_ifaces() -> List[str]:[0m
[30;1m207 | [0m[35m    # First case is a manual override. For maximum flexibility, this can be a comma-delimited list.[0m
[30;1m208 | [0m[35m    rendezvous_iface = os.environ.get("DET_SLURM_RENDEZVOUS_IFACE")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # If it doesn't work, fallback to just eth. Rendezvous over eth is fine since horovod will[0m
[30;1m211 | [0m[35m    # still use DET_INTER_NODE_NETWORK_INTERFACE for everything important, and SSH over IB mostly[0m

[31m--[ [0m[34mMatch #[0m[33m1512[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m    # Tells the Determined Master how many containers are part of the job so[0m
[30;1m186 | [0m[35m    # that it knows how many unique IDs it should expect notifications from[0m
[30;1m187 | [0m[35m    # in order to change the experiment's state from "Pulling" to "Running".[0m
[30;1m188 | [0m[35m    num_peers_str = os.environ.get("SLURM_NPROCS")[0m
[30;1m189 | [0m[35m    assert num_peers_str, "Unable to send container running notification without SLURM_NPROCS"[0m
[30;1m190 | [0m[35m    num_peers = int(num_peers_str)[0m
[30;1m191 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1513[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m# Master can change the state from "Pulling" to "Running".[0m
[30;1m179 | [0m[35mdef send_container_running_notification(sess: api.Session, allocation_id: str) -> None:[0m
[30;1m180 | [0m[35m    # Tells the Determined Master this container's unique ID.[0m
[30;1m181 | [0m[35m    rank_str = os.environ.get("SLURM_PROCID")[0m
[30;1m182 | [0m[35m    assert rank_str, "Unable to send container running notification without SLURM_PROCID"[0m
[30;1m183 | [0m[35m    rank = int(rank_str)[0m
[30;1m184 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1514[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m    pod_ip_str = os.environ.get("DET_KUBERNETES_POD_IP")[0m
[30;1m124 | [0m[35m    assert pod_ip_str, "Unable to rendezvous without DET_KUBERNETES_POD_IP"[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    num_slots_str = os.environ.get("DET_SLOT_IDS")[0m
[30;1m127 | [0m[35m    assert num_slots_str, "Unable to rendezvous without DET_SLOT_IDS"[0m
[30;1m128 | [0m[35m    num_slots = len(json.loads(os.environ["DET_SLOT_IDS"]))[0m
[30;1m129 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1515[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m    assert job_parallelism_str, "Unable to rendezvous without DET_KUBERNETES_JOB_PARALLELISM"[0m
[30;1m121 | [0m[35m    job_parallelism = int(job_parallelism_str)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    pod_ip_str = os.environ.get("DET_KUBERNETES_POD_IP")[0m
[30;1m124 | [0m[35m    assert pod_ip_str, "Unable to rendezvous without DET_KUBERNETES_POD_IP"[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    num_slots_str = os.environ.get("DET_SLOT_IDS")[0m

[31m--[ [0m[34mMatch #[0m[33m1516[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    allocation_id: str,[0m
[30;1m117 | [0m[35m    resources_id: str,[0m
[30;1m118 | [0m[35m) -> "det.RendezvousInfo":[0m
[30;1m119 | [0m[35m    job_parallelism_str = os.environ.get("DET_KUBERNETES_JOB_PARALLELISM")[0m
[30;1m120 | [0m[35m    assert job_parallelism_str, "Unable to rendezvous without DET_KUBERNETES_JOB_PARALLELISM"[0m
[30;1m121 | [0m[35m    job_parallelism = int(job_parallelism_str)[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1517[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    assert num_peers_str, "Unable to complete rendezvous without SLURM_NPROCS"[0m
[30;1m73 | [0m[35m    num_peers = int(num_peers_str)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    num_slots_str = os.environ.get("DET_SLOT_IDS")[0m
[30;1m76 | [0m[35m    assert num_slots_str, "Unable to complete rendezvous without DET_SLOT_IDS"[0m
[30;1m77 | [0m[35m    num_slots = len(json.loads(os.environ["DET_SLOT_IDS"]))[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1518[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m    assert rank_str, "Unable to complete rendezvous without SLURM_PROCID"[0m
[30;1m69 | [0m[35m    rank = int(rank_str)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    num_peers_str = os.environ.get("SLURM_NPROCS")[0m
[30;1m72 | [0m[35m    assert num_peers_str, "Unable to complete rendezvous without SLURM_NPROCS"[0m
[30;1m73 | [0m[35m    num_peers = int(num_peers_str)[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1519[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m    allocation_id: str,[0m
[30;1m65 | [0m[35m    resources_id: str,[0m
[30;1m66 | [0m[35m) -> "det.RendezvousInfo":[0m
[30;1m67 | [0m[35m    rank_str = os.environ.get("SLURM_PROCID")[0m
[30;1m68 | [0m[35m    assert rank_str, "Unable to complete rendezvous without SLURM_PROCID"[0m
[30;1m69 | [0m[35m    rank = int(rank_str)[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1520[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m.hostname[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m
[30;1m412 | [0m[35m        logger.info([0m
[30;1m413 | [0m[35m            f"Running task container on agent_id={agent_id}, hostname={hostname} "[0m
[30;1m414 | [0m[35m            f"with visible GPUs {resources.gpu_uuids}"[0m
[30;1m415 | [0m[35m        )[0m
[30;1m416 | [0m[35m        bindings.post_PostAllocationAcceleratorData([0m

[31m--[ [0m[34mMatch #[0m[33m1521[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m.hostname[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m
[30;1m412 | [0m[35m        logger.info([0m
[30;1m413 | [0m[35m            f"Running task container on agent_id={agent_id}, hostname={hostname} "[0m
[30;1m414 | [0m[35m            f"with visible GPUs {resources.gpu_uuids}"[0m
[30;1m415 | [0m[35m        )[0m
[30;1m416 | [0m[35m        bindings.post_PostAllocationAcceleratorData([0m

[31m--[ [0m[34mMatch #[0m[33m1522[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m.hostname[0m
[30;1m405 | [0m[35m        resources._to_file()[0m
[30;1m406 | [0m[35m        # Log where we are running and what GPUs are attached so hardware failures can be traced[0m
[30;1m407 | [0m[35m        # based only on task logs.[0m
[30;1m408 | [0m[35m        hostname = os.environ.get("HOSTNAME", "")[0m
[30;1m409 | [0m[35m        agent_id = os.environ.get("DET_AGENT_ID", "")[0m
[30;1m410 | [0m[35m        container_id = os.environ.get("DET_CONTAINER_ID", "")[0m
[30;1m411 | [0m[35m        _, accelerator_type = gpu.get_gpus()[0m

[31m--[ [0m[34mMatch #[0m[33m1523[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m        # Ensure all members of the tarball resolve to subdirectories.[0m
[30;1m36 | [0m[35m        for path in context_directory.getnames():[0m
[30;1m37 | [0m[35m            if os.path.relpath(path).startswith("../"):[0m
[30;1m38 | [0m[35m                raise ValueError(f"'{path}' in tarball would expand to a parent directory")[0m
[30;1m39 | [0m[35m        context_directory.extractall(path=constants.MANAGED_TRAINING_MODEL_COPY)[0m
[30;1m40 | [0m[35m        context_directory.extractall(path=".")[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1524[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35mdef set_proxy_address_kubernetes(sess: api.Session, allocation_id: str) -> None:[0m
[30;1m311 | [0m[35m    # When using a gateway, we know the static IP in advance so we don't want to tell the[0m
[30;1m312 | [0m[35m    # master the pod IP. Handling this on the master side gets a little tricky with restore.[0m
[30;1m313 | [0m[35m    # For example we send this proxy address before master sends the allocation its address.[0m
[30;1m314 | [0m[35m    if bool(os.environ.get("DET_PROXY_THROUGH_GATEWAY", None)):[0m

[31m--[ [0m[34mMatch #[0m[33m1525[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m296 | [0m[35m        proxy_ip = socket.gethostbyname(socket.gethostname())[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    # Right now this is just used in 'singularity-over-slurm' mode when singularity is using the[0m
[30;1m299 | [0m[35m    # equivalent of 'host' networking in Docker. When supporting any sort of network virtualization[0m
[30;1m300 | [0m[35m    # (https://sylabs.io/guides/3.0/user-guide/networking.html) this will need some revision.[0m
[30;1m301 | [0m[35m    bindings.post_PostAllocationProxyAddress([0m
[30;1m302 | [0m[35m        sess,[0m

[31m--[ [0m[34mMatch #[0m[33m1526[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m        except ValueError as e:[0m
[30;1m293 | [0m[35m            resolution_error = e[0m
[30;1m294 | [0m[35m    else:[0m
[30;1m295 | [0m[35m        logger.warning(f"falling back to naive proxy ip resolution (error={resolution_error})")[0m
[30;1m296 | [0m[35m        proxy_ip = socket.gethostbyname(socket.gethostname())[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    # Right now this is just used in 'singularity-over-slurm' mode when singularity is using the[0m

[31m--[ [0m[34mMatch #[0m[33m1527[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m    rendezvous_iface = os.environ.get("DET_SLURM_RENDEZVOUS_IFACE")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # If it doesn't work, fallback to just eth. Rendezvous over eth is fine since horovod will[0m
[30;1m211 | [0m[35m    # still use DET_INTER_NODE_NETWORK_INTERFACE for everything important, and SSH over IB mostly[0m
[30;1m212 | [0m[35m    # won't work. On systems where we need this, 'eth' will need to be the proper name.[0m
[30;1m213 | [0m[35m    if not rendezvous_iface:[0m
[30;1m214 | [0m[35m        rendezvous_iface = get_eth_interface_name()[0m

[31m--[ [0m[34mMatch #[0m[33m1528[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m183 | [0m[35m    rank = int(rank_str)[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    # Tells the Determined Master how many containers are part of the job so[0m
[30;1m186 | [0m[35m    # that it knows how many unique IDs it should expect notifications from[0m
[30;1m187 | [0m[35m    # in order to change the experiment's state from "Pulling" to "Running".[0m
[30;1m188 | [0m[35m    num_peers_str = os.environ.get("SLURM_NPROCS")[0m
[30;1m189 | [0m[35m    assert num_peers_str, "Unable to send container running notification without SLURM_NPROCS"[0m

[31m--[ [0m[34mMatch #[0m[33m1529[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m            rendezvous_ip = get_ip_from_interface(rendezvous_iface)[0m
[30;1m83 | [0m[35m            break[0m
[30;1m84 | [0m[35m        except ValueError as e:[0m
[30;1m85 | [0m[35m            logger.warning(f"Unable to resolve ip for {rendezvous_iface}: {str(e)}")[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    # Note, rendezvous must be sorted in rank order.[0m
[30;1m88 | [0m[35m    resp = bindings.post_AllocationAllGather([0m

[31m--[ [0m[34mMatch #[0m[33m1530[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m        # Ensure all members of the tarball resolve to subdirectories.[0m
[30;1m36 | [0m[35m        for path in context_directory.getnames():[0m
[30;1m37 | [0m[35m            if os.path.relpath(path).startswith("../"):[0m
[30;1m38 | [0m[35m                raise ValueError(f"'{path}' in tarball would expand to a parent directory")[0m
[30;1m39 | [0m[35m        context_directory.extractall(path=constants.MANAGED_TRAINING_MODEL_COPY)[0m
[30;1m40 | [0m[35m        context_directory.extractall(path=".")[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1531[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/prep_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport io[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m1532[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24499 | [0m[35m    """Get a snapshot of a metric across all trials at a certain point of[0m
[30;1m24500 | [0m[35m    progress.[0m
[30;1m24501 | [0m[35m[0m
[30;1m24502 | [0m[35m    - batchesProcessed: The point of progress at which to query metrics.[0m
[30;1m24503 | [0m[35m    - experimentId: The id of the experiment.[0m
[30;1m24504 | [0m[35m    - metricName: A metric name.[0m
[30;1m24505 | [0m[35m    - batchesMargin: A range either side of batches_processed to include near-misses.[0m

[31m--[ [0m[34mMatch #[0m[33m1533[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24496 | [0m[35m    metricType: "typing.Optional[v1MetricType]" = None,[0m
[30;1m24497 | [0m[35m    periodSeconds: "typing.Optional[int]" = None,[0m
[30;1m24498 | [0m[35m) -> "typing.Iterable[v1TrialsSnapshotResponse]":[0m
[30;1m24499 | [0m[35m    """Get a snapshot of a metric across all trials at a certain point of[0m
[30;1m24500 | [0m[35m    progress.[0m
[30;1m24501 | [0m[35m[0m
[30;1m24502 | [0m[35m    - batchesProcessed: The point of progress at which to query metrics.[0m

[31m--[ [0m[34mMatch #[0m[33m1534[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23910 | [0m[35m    *,[0m
[30;1m23911 | [0m[35m    body: "v1SetClusterMessageRequest",[0m
[30;1m23912 | [0m[35m) -> None:[0m
[30;1m23913 | [0m[35m    """Set the cluster-wide message shown to users. Only one can be set at at[0m
[30;1m23914 | [0m[35m    time, so any existing message will be disabled.[0m
[30;1m23915 | [0m[35m    """[0m
[30;1m23916 | [0m[35m    _params = None[0m

[31m--[ [0m[34mMatch #[0m[33m1535[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23747 | [0m[35mjust an artifact of using protobuf.[0m
[30;1m23748 | [0m[35m - RESOURCE_ALLOCATION_AGGREGATION_PERIOD_DAILY: Aggregation by day.[0m
[30;1m23749 | [0m[35m - RESOURCE_ALLOCATION_AGGREGATION_PERIOD_MONTHLY: Aggregation by month.[0m
[30;1m23750 | [0m[35m    - startDate: The first day to consider (the exact time is midnight UTC at the beginning[0m
[30;1m23751 | [0m[35mof the day).[0m
[30;1m23752 | [0m[35m    """[0m
[30;1m23753 | [0m[35m    _params = {[0m

[31m--[ [0m[34mMatch #[0m[33m1536[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23739 | [0m[35m) -> "v1ResourceAllocationAggregatedResponse":[0m
[30;1m23740 | [0m[35m    """Get an aggregated view of resource allocation during the given time period.[0m
[30;1m23741 | [0m[35m[0m
[30;1m23742 | [0m[35m    - endDate: The last day to consider (the exact time is midnight UTC at the end of the[0m
[30;1m23743 | [0m[35mday).[0m
[30;1m23744 | [0m[35m    - period: The period over which to perform aggregation.[0m
[30;1m23745 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1537[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23491 | [0m[35m    workloadType: str,[0m
[30;1m23492 | [0m[35m    workspaceId: int,[0m
[30;1m23493 | [0m[35m) -> "v1PutWorkspaceConfigPoliciesResponse":[0m
[30;1m23494 | [0m[35m    """Add or update workspace task config policies.[0m
[30;1m23495 | [0m[35m[0m
[30;1m23496 | [0m[35m    - workloadType: The workload type the config policies apply to: EXPERIMENT or NTSC.[0m
[30;1m23497 | [0m[35m    - workspaceId: The workspace the config policies apply to. Use global API for[0m

[31m--[ [0m[34mMatch #[0m[33m1538[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23364 | [0m[35m    body: "v1PutGlobalConfigPoliciesRequest",[0m
[30;1m23365 | [0m[35m    workloadType: str,[0m
[30;1m23366 | [0m[35m) -> "v1PutGlobalConfigPoliciesResponse":[0m
[30;1m23367 | [0m[35m    """Add or update global task config policies.[0m
[30;1m23368 | [0m[35m[0m
[30;1m23369 | [0m[35m    - workloadType: The workload type the config policies apply to: EXPERIMENT or NTSC.[0m
[30;1m23370 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1539[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23081 | [0m[35m    body: "v1TrialRunnerMetadata",[0m
[30;1m23082 | [0m[35m    trialId: int,[0m
[30;1m23083 | [0m[35m) -> None:[0m
[30;1m23084 | [0m[35m    """For bookkeeping, update trial runner metadata (currently just state).[0m
[30;1m23085 | [0m[35m[0m
[30;1m23086 | [0m[35m    - body: The state for the trial runner.[0m
[30;1m23087 | [0m[35m    - trialId: The id of the trial.[0m

[31m--[ [0m[34mMatch #[0m[33m1540[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22106 | [0m[35m    metricType: "typing.Optional[v1MetricType]" = None,[0m
[30;1m22107 | [0m[35m    periodSeconds: "typing.Optional[int]" = None,[0m
[30;1m22108 | [0m[35m) -> "typing.Iterable[v1MetricBatchesResponse]":[0m
[30;1m22109 | [0m[35m    """Get the milestones (in batches processed) at which a metric is recorded by[0m
[30;1m22110 | [0m[35m    an experiment.[0m
[30;1m22111 | [0m[35m[0m
[30;1m22112 | [0m[35m    - experimentId: The id of the experiment.[0m

[31m--[ [0m[34mMatch #[0m[33m1541[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17398 | [0m[35m    resourcesId: str,[0m
[30;1m17399 | [0m[35m) -> "v1AllocationRendezvousInfoResponse":[0m
[30;1m17400 | [0m[35m    """Gather an allocation's rendezvous info. Blocks until all trial containers[0m
[30;1m17401 | [0m[35m    connect to gather their rendezvous information and responds to them all at[0m
[30;1m17402 | [0m[35m    once.[0m
[30;1m17403 | [0m[35m[0m
[30;1m17404 | [0m[35m    - allocationId: The id of the allocation.[0m
[30;1m17405 | [0m[35m    - resourcesId: The id of the clump of resources.[0m

[31m--[ [0m[34mMatch #[0m[33m1542[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17280 | [0m[35m    body: "v1AllocationAllGatherRequest",[0m
[30;1m17281 | [0m[35m) -> "v1AllocationAllGatherResponse":[0m
[30;1m17282 | [0m[35m    """AllocationAllGather performs an all gather through the master. An[0m
[30;1m17283 | [0m[35m    allocation can only perform once all gather at a time.[0m
[30;1m17284 | [0m[35m[0m
[30;1m17285 | [0m[35m    - allocationId: The ID of the allocation.[0m
[30;1m17286 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1543[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m16543 | [0m[35m        return out[0m
[30;1m16544 | [0m[35m[0m
[30;1m16545 | [0m[35mclass v1UpdateJobQueueRequest(Printable):[0m
[30;1m16546 | [0m[35m    """Request to update the job queue."""[0m
[30;1m16547 | [0m[35m[0m
[30;1m16548 | [0m[35m    def __init__([0m
[30;1m16549 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m1544[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m16519 | [0m[35m[0m
[30;1m16520 | [0m[35mclass v1UpdateGroupResponse(Printable):[0m
[30;1m16521 | [0m[35m    """UpdateGroupResponse is the body of the response for the call[0m
[30;1m16522 | [0m[35m    to update a group and its members.[0m
[30;1m16523 | [0m[35m    """[0m
[30;1m16524 | [0m[35m[0m
[30;1m16525 | [0m[35m    def __init__([0m

[31m--[ [0m[34mMatch #[0m[33m1545[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m16470 | [0m[35m[0m
[30;1m16471 | [0m[35mclass v1UpdateGroupRequest(Printable):[0m
[30;1m16472 | [0m[35m    """UpdateGroupRequest is the body of the request for the call[0m
[30;1m16473 | [0m[35m    to update a group and its members.[0m
[30;1m16474 | [0m[35m    """[0m
[30;1m16475 | [0m[35m    addUsers: "typing.Optional[typing.Sequence[int]]" = None[0m
[30;1m16476 | [0m[35m    name: "typing.Optional[str]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1546[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m13549 | [0m[35m[0m
[30;1m13550 | [0m[35mclass v1ResourcesSummary(Printable):[0m
[30;1m13551 | [0m[35m    """ResourcesSummary provides a summary of the resources comprising what we know[0m
[30;1m13552 | [0m[35m    at the time the allocation is granted, but for k8s it is granted before being[0m
[30;1m13553 | [0m[35m    scheduled so it isn't really much and `agent_devices` are missing for k8s.[0m
[30;1m13554 | [0m[35m    """[0m
[30;1m13555 | [0m[35m    agentDevices: "typing.Optional[typing.Dict[str, ResourcesSummaryDevices]]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1547[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12426 | [0m[35m        return out[0m
[30;1m12427 | [0m[35m[0m
[30;1m12428 | [0m[35mclass v1QueueControl(Printable):[0m
[30;1m12429 | [0m[35m    """Describes a message to control jobs in a queue."""[0m
[30;1m12430 | [0m[35m    aheadOf: "typing.Optional[str]" = None[0m
[30;1m12431 | [0m[35m    behindOf: "typing.Optional[str]" = None[0m
[30;1m12432 | [0m[35m    priority: "typing.Optional[int]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1548[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10778 | [0m[35m    - PERMISSION_TYPE_VIEW_GLOBAL_CONFIG_POLICIES: Ability to view global config policies.[0m
[30;1m10779 | [0m[35m    - PERMISSION_TYPE_VIEW_WORKSPACE_CONFIG_POLICIES: Ability to view workspace config policies.[0m
[30;1m10780 | [0m[35m    - PERMISSION_TYPE_ADMINISTRATE_TOKEN: Ability to administrate other users' tokens.[0m
[30;1m10781 | [0m[35m    - PERMISSION_TYPE_UPDATE_TOKEN: Ability to update one's own token.[0m
[30;1m10782 | [0m[35m    - PERMISSION_TYPE_CREATE_TOKEN: Ability to create one's own token[0m
[30;1m10783 | [0m[35m    - PERMISSION_TYPE_CREATE_OTHER_TOKEN: Ability to create another user's token[0m
[30;1m10784 | [0m[35m    - PERMISSION_TYPE_VIEW_OTHER_TOKEN: Ability to view another user's token[0m

[31m--[ [0m[34mMatch #[0m[33m1549[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10766 | [0m[35m    - PERMISSION_TYPE_UPDATE_TEMPLATES: Ability to update templates.[0m
[30;1m10767 | [0m[35m    - PERMISSION_TYPE_CREATE_TEMPLATES: Ability to create templates.[0m
[30;1m10768 | [0m[35m    - PERMISSION_TYPE_DELETE_TEMPLATES: Ability to delete templates.[0m
[30;1m10769 | [0m[35m    - PERMISSION_TYPE_UPDATE_ROLES: Ability to create and update role definitions.[0m
[30;1m10770 | [0m[35m    - PERMISSION_TYPE_EDIT_WEBHOOKS: Ability to create and delete webhooks.[0m
[30;1m10771 | [0m[35m    - PERMISSION_TYPE_VIEW_WEBHOOKS: Ability to view webhooks.[0m
[30;1m10772 | [0m[35m    - PERMISSION_TYPE_MODIFY_RP_WORKSPACE_BINDINGS: Ability to bind, unbind or overwrite resource po[0m

[31m--[ [0m[34mMatch #[0m[33m1550[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10763 | [0m[35m    - PERMISSION_TYPE_VIEW_EXTERNAL_JOBS: Ability to view external jobs.[0m
[30;1m10764 | [0m[35m    - PERMISSION_TYPE_CONTROL_STRICT_JOB_QUEUE: Ability to control strict job queue.[0m
[30;1m10765 | [0m[35m    - PERMISSION_TYPE_VIEW_TEMPLATES: Ability to view templates.[0m
[30;1m10766 | [0m[35m    - PERMISSION_TYPE_UPDATE_TEMPLATES: Ability to update templates.[0m
[30;1m10767 | [0m[35m    - PERMISSION_TYPE_CREATE_TEMPLATES: Ability to create templates.[0m
[30;1m10768 | [0m[35m    - PERMISSION_TYPE_DELETE_TEMPLATES: Ability to delete templates.[0m
[30;1m10769 | [0m[35m    - PERMISSION_TYPE_UPDATE_ROLES: Ability to create and update role definitions.[0m

[31m--[ [0m[34mMatch #[0m[33m1551[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10761 | [0m[35m    - PERMISSION_TYPE_VIEW_MASTER_CONFIG: Ability to view master configs.[0m
[30;1m10762 | [0m[35m    - PERMISSION_TYPE_UPDATE_MASTER_CONFIG: Ability to update master configs.[0m
[30;1m10763 | [0m[35m    - PERMISSION_TYPE_VIEW_EXTERNAL_JOBS: Ability to view external jobs.[0m
[30;1m10764 | [0m[35m    - PERMISSION_TYPE_CONTROL_STRICT_JOB_QUEUE: Ability to control strict job queue.[0m
[30;1m10765 | [0m[35m    - PERMISSION_TYPE_VIEW_TEMPLATES: Ability to view templates.[0m
[30;1m10766 | [0m[35m    - PERMISSION_TYPE_UPDATE_TEMPLATES: Ability to update templates.[0m
[30;1m10767 | [0m[35m    - PERMISSION_TYPE_CREATE_TEMPLATES: Ability to create templates.[0m

[31m--[ [0m[34mMatch #[0m[33m1552[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10759 | [0m[35m    - PERMISSION_TYPE_UPDATE_AGENTS: Ability to update agents.[0m
[30;1m10760 | [0m[35m    - PERMISSION_TYPE_VIEW_SENSITIVE_AGENT_INFO: Ability to view sensitive subset of agent info.[0m
[30;1m10761 | [0m[35m    - PERMISSION_TYPE_VIEW_MASTER_CONFIG: Ability to view master configs.[0m
[30;1m10762 | [0m[35m    - PERMISSION_TYPE_UPDATE_MASTER_CONFIG: Ability to update master configs.[0m
[30;1m10763 | [0m[35m    - PERMISSION_TYPE_VIEW_EXTERNAL_JOBS: Ability to view external jobs.[0m
[30;1m10764 | [0m[35m    - PERMISSION_TYPE_CONTROL_STRICT_JOB_QUEUE: Ability to control strict job queue.[0m
[30;1m10765 | [0m[35m    - PERMISSION_TYPE_VIEW_TEMPLATES: Ability to view templates.[0m

[31m--[ [0m[34mMatch #[0m[33m1553[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10756 | [0m[35m    - PERMISSION_TYPE_DELETE_OTHER_USER_MODEL_VERSION: Ability to delete another user's model versio[0m
[30;1m10757 | [0m[35m    - PERMISSION_TYPE_VIEW_MASTER_LOGS: Ability to view master logs.[0m
[30;1m10758 | [0m[35m    - PERMISSION_TYPE_VIEW_CLUSTER_USAGE: Ability to view detailed cluster usage info.[0m
[30;1m10759 | [0m[35m    - PERMISSION_TYPE_UPDATE_AGENTS: Ability to update agents.[0m
[30;1m10760 | [0m[35m    - PERMISSION_TYPE_VIEW_SENSITIVE_AGENT_INFO: Ability to view sensitive subset of agent info.[0m
[30;1m10761 | [0m[35m    - PERMISSION_TYPE_VIEW_MASTER_CONFIG: Ability to view master configs.[0m
[30;1m10762 | [0m[35m    - PERMISSION_TYPE_UPDATE_MASTER_CONFIG: Ability to update master configs.[0m

[31m--[ [0m[34mMatch #[0m[33m1554[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10745 | [0m[35m    - PERMISSION_TYPE_UPDATE_PROJECT: Ability to update projects.[0m
[30;1m10746 | [0m[35m    - PERMISSION_TYPE_DELETE_PROJECT: Ability to delete projects.[0m
[30;1m10747 | [0m[35m    - PERMISSION_TYPE_ASSIGN_ROLES: Ability to assign roles to groups / users.[0m
[30;1m10748 | [0m[35m    If assigned at a workspace scope, can only assign roles to that workspace[0m
[30;1m10749 | [0m[35m    scope.[0m
[30;1m10750 | [0m[35m    - PERMISSION_TYPE_VIEW_MODEL_REGISTRY: Ability to view model registry.[0m
[30;1m10751 | [0m[35m    - PERMISSION_TYPE_EDIT_MODEL_REGISTRY: Ability to edit model registry.[0m

[31m--[ [0m[34mMatch #[0m[33m1555[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10742 | [0m[35m    - PERMISSION_TYPE_SET_WORKSPACE_DEFAULT_RESOURCE_POOL: Ability to set workspace default resource[0m
[30;1m10743 | [0m[35m    - PERMISSION_TYPE_CREATE_PROJECT: Ability to create projects.[0m
[30;1m10744 | [0m[35m    - PERMISSION_TYPE_VIEW_PROJECT: Ability to view projects.[0m
[30;1m10745 | [0m[35m    - PERMISSION_TYPE_UPDATE_PROJECT: Ability to update projects.[0m
[30;1m10746 | [0m[35m    - PERMISSION_TYPE_DELETE_PROJECT: Ability to delete projects.[0m
[30;1m10747 | [0m[35m    - PERMISSION_TYPE_ASSIGN_ROLES: Ability to assign roles to groups / users.[0m
[30;1m10748 | [0m[35m    If assigned at a workspace scope, can only assign roles to that workspace[0m

[31m--[ [0m[34mMatch #[0m[33m1556[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10735 | [0m[35m    - PERMISSION_TYPE_UPDATE_GROUP: Ability to create, update, and add / remove users from groups.[0m
[30;1m10736 | [0m[35m    - PERMISSION_TYPE_CREATE_WORKSPACE: Ability to create workspaces.[0m
[30;1m10737 | [0m[35m    - PERMISSION_TYPE_VIEW_WORKSPACE: Ability to view workspace.[0m
[30;1m10738 | [0m[35m    - PERMISSION_TYPE_UPDATE_WORKSPACE: Ability to update workspace.[0m
[30;1m10739 | [0m[35m    - PERMISSION_TYPE_DELETE_WORKSPACE: Ability to delete workspace.[0m
[30;1m10740 | [0m[35m    - PERMISSION_TYPE_SET_WORKSPACE_AGENT_USER_GROUP: Ability to set workspace agent user group conf[0m
[30;1m10741 | [0m[35m    - PERMISSION_TYPE_SET_WORKSPACE_CHECKPOINT_STORAGE_CONFIG: Ability to set workspace checkpoint s[0m

[31m--[ [0m[34mMatch #[0m[33m1557[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10727 | [0m[35meckpoints, trials.[0m
[30;1m10728 | [0m[35m    - PERMISSION_TYPE_VIEW_EXPERIMENT_METADATA: Ability to view experiment's metadata such as experi[0m
[30;1m10729 | [0m[35m    - PERMISSION_TYPE_UPDATE_EXPERIMENT: Ability to update experiment and experiment's lifecycle.[0m
[30;1m10730 | [0m[35m    - PERMISSION_TYPE_UPDATE_EXPERIMENT_METADATA: Ability to update experiment's metadata.[0m
[30;1m10731 | [0m[35m    - PERMISSION_TYPE_DELETE_EXPERIMENT: Ability to delete experiment.[0m
[30;1m10732 | [0m[35m    - PERMISSION_TYPE_CREATE_NSC: Ability to create Notebooks, Shells, and Commands.[0m
[30;1m10733 | [0m[35m    - PERMISSION_TYPE_VIEW_NSC: Ability to view Notebooks, Shells, and Commands.[0m

[31m--[ [0m[34mMatch #[0m[33m1558[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10726 | [0m[35me experiments.[0m
[30;1m10727 | [0m[35m    - PERMISSION_TYPE_VIEW_EXPERIMENT_ARTIFACTS: Ability to view experiment's model code, checkpoint[0m
[30;1m10728 | [0m[35m    - PERMISSION_TYPE_VIEW_EXPERIMENT_METADATA: Ability to view experiment's metadata such as experi[0m
[30;1m10729 | [0m[35m    - PERMISSION_TYPE_UPDATE_EXPERIMENT: Ability to update experiment and experiment's lifecycle.[0m
[30;1m10730 | [0m[35m    - PERMISSION_TYPE_UPDATE_EXPERIMENT_METADATA: Ability to update experiment's metadata.[0m
[30;1m10731 | [0m[35m    - PERMISSION_TYPE_DELETE_EXPERIMENT: Ability to delete experiment.[0m
[30;1m10732 | [0m[35m    - PERMISSION_TYPE_CREATE_NSC: Ability to create Notebooks, Shells, and Commands.[0m

[31m--[ [0m[34mMatch #[0m[33m1559[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10719 | [0m[35m    Permissions on the same object share the thousands place[0m
[30;1m10720 | [0m[35m    value like 2001 and 2002.[0m
[30;1m10721 | [0m[35m    - PERMISSION_TYPE_UNSPECIFIED: The permission type is unknown.[0m
[30;1m10722 | [0m[35m    - PERMISSION_TYPE_ADMINISTRATE_USER: Can create and update other users.[0m
[30;1m10723 | [0m[35m    Allows updating other users passwords making this[0m
[30;1m10724 | [0m[35m    permission give all other permissions effectively.[0m
[30;1m10725 | [0m[35m    - PERMISSION_TYPE_ADMINISTRATE_OAUTH: Ability to manage OAuth clients and settings.[0m

[31m--[ [0m[34mMatch #[0m[33m1560[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10446 | [0m[35m        return out[0m
[30;1m10447 | [0m[35m[0m
[30;1m10448 | [0m[35mclass v1PatchWorkspace(Printable):[0m
[30;1m10449 | [0m[35m    """PatchWorkspace is a partial update to a workspace with all optional fields."""[0m
[30;1m10450 | [0m[35m    agentUserGroup: "typing.Optional[v1AgentUserGroup]" = None[0m
[30;1m10451 | [0m[35m    checkpointStorageConfig: "typing.Optional[typing.Dict[str, typing.Any]]" = None[0m
[30;1m10452 | [0m[35m    clusterNamespaceMeta: "typing.Optional[typing.Dict[str, v1WorkspaceNamespaceMeta]]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1561[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10069 | [0m[35m        return out[0m
[30;1m10070 | [0m[35m[0m
[30;1m10071 | [0m[35mclass v1PatchProject(Printable):[0m
[30;1m10072 | [0m[35m    """PatchProject is a partial update to a project with all optional fields."""[0m
[30;1m10073 | [0m[35m    description: "typing.Optional[str]" = None[0m
[30;1m10074 | [0m[35m    key: "typing.Optional[str]" = None[0m
[30;1m10075 | [0m[35m    name: "typing.Optional[str]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1562[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m9882 | [0m[35m        return out[0m
[30;1m9883 | [0m[35m[0m
[30;1m9884 | [0m[35mclass v1PatchModel(Printable):[0m
[30;1m9885 | [0m[35m    """PatchModel is a partial update to a model with only name required."""[0m
[30;1m9886 | [0m[35m    description: "typing.Optional[str]" = None[0m
[30;1m9887 | [0m[35m    labels: "typing.Optional[typing.Sequence[str]]" = None[0m
[30;1m9888 | [0m[35m    metadata: "typing.Optional[typing.Dict[str, typing.Any]]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1563[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m9749 | [0m[35m        return out[0m
[30;1m9750 | [0m[35m[0m
[30;1m9751 | [0m[35mclass v1PatchExperiment(Printable):[0m
[30;1m9752 | [0m[35m    """PatchExperiment is a partial update to an experiment with only id required."""[0m
[30;1m9753 | [0m[35m    checkpointStorage: "typing.Optional[PatchExperimentPatchCheckpointStorage]" = None[0m
[30;1m9754 | [0m[35m    description: "typing.Optional[str]" = None[0m
[30;1m9755 | [0m[35m    labels: "typing.Optional[typing.Sequence[str]]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1564[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2920 | [0m[35m[0m
[30;1m2921 | [0m[35mclass v1CreateGroupResponse(Printable):[0m
[30;1m2922 | [0m[35m    """CreateGroupResponse is the body of the response for the call[0m
[30;1m2923 | [0m[35m    to update a group and its members.[0m
[30;1m2924 | [0m[35m    """[0m
[30;1m2925 | [0m[35m[0m
[30;1m2926 | [0m[35m    def __init__([0m

[31m--[ [0m[34mMatch #[0m[33m1565[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24433 | [0m[35m    periodSeconds: "typing.Optional[int]" = None,[0m
[30;1m24434 | [0m[35m    startBatches: "typing.Optional[int]" = None,[0m
[30;1m24435 | [0m[35m) -> "typing.Iterable[v1TrialsSampleResponse]":[0m
[30;1m24436 | [0m[35m    """Get a sample of the metrics over time for a sample of the trials.[0m
[30;1m24437 | [0m[35m[0m
[30;1m24438 | [0m[35m    - experimentId: The id of the experiment.[0m
[30;1m24439 | [0m[35m    - metricName: A metric name.[0m

[31m--[ [0m[34mMatch #[0m[33m1566[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23775 | [0m[35m    timestampAfter: str,[0m
[30;1m23776 | [0m[35m    timestampBefore: str,[0m
[30;1m23777 | [0m[35m) -> "v1ResourceAllocationRawResponse":[0m
[30;1m23778 | [0m[35m    """Get a detailed view of resource allocation during the given time period.[0m
[30;1m23779 | [0m[35m[0m
[30;1m23780 | [0m[35m    - timestampAfter: The start of the period to consider.[0m
[30;1m23781 | [0m[35m    - timestampBefore: The end of the period to consider.[0m

[31m--[ [0m[34mMatch #[0m[33m1567[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23747 | [0m[35mjust an artifact of using protobuf.[0m
[30;1m23748 | [0m[35m - RESOURCE_ALLOCATION_AGGREGATION_PERIOD_DAILY: Aggregation by day.[0m
[30;1m23749 | [0m[35m - RESOURCE_ALLOCATION_AGGREGATION_PERIOD_MONTHLY: Aggregation by month.[0m
[30;1m23750 | [0m[35m    - startDate: The first day to consider (the exact time is midnight UTC at the beginning[0m
[30;1m23751 | [0m[35mof the day).[0m
[30;1m23752 | [0m[35m    """[0m
[30;1m23753 | [0m[35m    _params = {[0m

[31m--[ [0m[34mMatch #[0m[33m1568[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23739 | [0m[35m) -> "v1ResourceAllocationAggregatedResponse":[0m
[30;1m23740 | [0m[35m    """Get an aggregated view of resource allocation during the given time period.[0m
[30;1m23741 | [0m[35m[0m
[30;1m23742 | [0m[35m    - endDate: The last day to consider (the exact time is midnight UTC at the end of the[0m
[30;1m23743 | [0m[35mday).[0m
[30;1m23744 | [0m[35m    - period: The period over which to perform aggregation.[0m
[30;1m23745 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1569[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23737 | [0m[35m    period: "v1ResourceAllocationAggregationPeriod",[0m
[30;1m23738 | [0m[35m    startDate: str,[0m
[30;1m23739 | [0m[35m) -> "v1ResourceAllocationAggregatedResponse":[0m
[30;1m23740 | [0m[35m    """Get an aggregated view of resource allocation during the given time period.[0m
[30;1m23741 | [0m[35m[0m
[30;1m23742 | [0m[35m    - endDate: The last day to consider (the exact time is midnight UTC at the end of the[0m
[30;1m23743 | [0m[35mday).[0m

[31m--[ [0m[34mMatch #[0m[33m1570[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21477 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m21478 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m21479 | [0m[35m    - pinned: Limit the workspaces to those with pinned status by the current user.[0m
[30;1m21480 | [0m[35m    - sortBy: Sort the workspaces by the given field.[0m
[30;1m21481 | [0m[35m[0m
[30;1m21482 | [0m[35m - SORT_BY_UNSPECIFIED: Returns workspaces in an unsorted list.[0m
[30;1m21483 | [0m[35m - SORT_BY_ID: Returns workspaces sorted by id.[0m

[31m--[ [0m[34mMatch #[0m[33m1571[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21417 | [0m[35m    - sortBy: Sort the projects by the given field.[0m
[30;1m21418 | [0m[35m[0m
[30;1m21419 | [0m[35m - SORT_BY_UNSPECIFIED: Returns projects in an unsorted list.[0m
[30;1m21420 | [0m[35m - SORT_BY_CREATION_TIME: Returns projects sorted by time that they were created.[0m
[30;1m21421 | [0m[35m - SORT_BY_LAST_EXPERIMENT_START_TIME: Returns projects sorted by most recent start of an experiment[0m
[30;1m21422 | [0m[35m - SORT_BY_NAME: Returns projects sorted by name.[0m
[30;1m21423 | [0m[35m - SORT_BY_DESCRIPTION: Returns projects sorted by description.[0m

[31m--[ [0m[34mMatch #[0m[33m1572[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21414 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m21415 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m21416 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m21417 | [0m[35m    - sortBy: Sort the projects by the given field.[0m
[30;1m21418 | [0m[35m[0m
[30;1m21419 | [0m[35m - SORT_BY_UNSPECIFIED: Returns projects in an unsorted list.[0m
[30;1m21420 | [0m[35m - SORT_BY_CREATION_TIME: Returns projects sorted by time that they were created.[0m

[31m--[ [0m[34mMatch #[0m[33m1573[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21242 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m21243 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m21244 | [0m[35m    - roleIdAssignedDirectlyToUser: Filter by roles id assigned directly to user for EE.[0m
[30;1m21245 | [0m[35m    - sortBy: Sort users by the given field.[0m
[30;1m21246 | [0m[35m[0m
[30;1m21247 | [0m[35m - SORT_BY_UNSPECIFIED: Returns users in an unsorted list.[0m
[30;1m21248 | [0m[35m - SORT_BY_DISPLAY_NAME: Returns users sorted by display name.[0m

[31m--[ [0m[34mMatch #[0m[33m1574[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21120 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m21121 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m21122 | [0m[35m    - removeDeletedCheckpoints: Remove deleted checkpoints.[0m
[30;1m21123 | [0m[35m    - sortKey: Sort workloads by batches, a training metric, or a validation metric.[0m
[30;1m21124 | [0m[35m    """[0m
[30;1m21125 | [0m[35m    _params = {[0m
[30;1m21126 | [0m[35m        "filter": filter.value if filter is not None else None,[0m

[31m--[ [0m[34mMatch #[0m[33m1575[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20849 | [0m[35m - SORT_BY_STATE: Returns checkpoints sorted by state.[0m
[30;1m20850 | [0m[35m - SORT_BY_SEARCHER_METRIC: Returns checkpoints sorted by the experiment's `searcher.metric`[0m
[30;1m20851 | [0m[35mconfiguration setting.[0m
[30;1m20852 | [0m[35m    - sortByMetric: Sort by custom validation metric name.[0m
[30;1m20853 | [0m[35m    - states: Limit the checkpoints to those that match the states.[0m
[30;1m20854 | [0m[35m[0m
[30;1m20855 | [0m[35m - STATE_UNSPECIFIED: The state of the checkpoint is unknown.[0m

[31m--[ [0m[34mMatch #[0m[33m1576[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20839 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m20840 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m20841 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m20842 | [0m[35m    - sortByAttr: Sort by preset checkpoint attribute.[0m
[30;1m20843 | [0m[35m[0m
[30;1m20844 | [0m[35m - SORT_BY_UNSPECIFIED: Returns checkpoints in an unsorted list.[0m
[30;1m20845 | [0m[35m - SORT_BY_UUID: Returns checkpoints sorted by UUID.[0m

[31m--[ [0m[34mMatch #[0m[33m1577[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20689 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m20690 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m20691 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m20692 | [0m[35m    - sortBy: Sort tensorboards by the given field.[0m
[30;1m20693 | [0m[35m[0m
[30;1m20694 | [0m[35m - SORT_BY_UNSPECIFIED: Returns tensorboards in an unsorted list.[0m
[30;1m20695 | [0m[35m - SORT_BY_ID: Returns tensorboards sorted by id.[0m

[31m--[ [0m[34mMatch #[0m[33m1578[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20613 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m20614 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m20615 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m20616 | [0m[35m    - sortBy: Sort templates by the given field.[0m
[30;1m20617 | [0m[35m[0m
[30;1m20618 | [0m[35m - SORT_BY_UNSPECIFIED: Returns templates in an unsorted list.[0m
[30;1m20619 | [0m[35m - SORT_BY_NAME: Returns templates sorted by name.[0m

[31m--[ [0m[34mMatch #[0m[33m1579[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20358 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m20359 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m20360 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m20361 | [0m[35m    - sortBy: Sort shells by the given field.[0m
[30;1m20362 | [0m[35m[0m
[30;1m20363 | [0m[35m - SORT_BY_UNSPECIFIED: Returns shells in an unsorted list.[0m
[30;1m20364 | [0m[35m - SORT_BY_ID: Returns shells sorted by id.[0m

[31m--[ [0m[34mMatch #[0m[33m1580[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19996 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m19997 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m19998 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m19999 | [0m[35m    - sortBy: Sort notebooks by the given field.[0m
[30;1m20000 | [0m[35m[0m
[30;1m20001 | [0m[35m - SORT_BY_UNSPECIFIED: Returns notebooks in an unsorted list.[0m
[30;1m20002 | [0m[35m - SORT_BY_ID: Returns notebooks sorted by id.[0m

[31m--[ [0m[34mMatch #[0m[33m1581[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19906 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m19907 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m19908 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m19909 | [0m[35m    - sortBy: Sort the models by the given field.[0m
[30;1m19910 | [0m[35m[0m
[30;1m19911 | [0m[35m - SORT_BY_UNSPECIFIED: Returns models in an unsorted list.[0m
[30;1m19912 | [0m[35m - SORT_BY_NAME: Returns models sorted by name.[0m

[31m--[ [0m[34mMatch #[0m[33m1582[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19846 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m19847 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m19848 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m19849 | [0m[35m    - sortBy: Sort the model versions by the given field.[0m
[30;1m19850 | [0m[35m[0m
[30;1m19851 | [0m[35m - SORT_BY_UNSPECIFIED: Returns model versions in an unsorted list.[0m
[30;1m19852 | [0m[35m - SORT_BY_VERSION: Returns model versions sorted by version number.[0m

[31m--[ [0m[34mMatch #[0m[33m1583[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19172 | [0m[35m    - projectId: Limit experiments to those within a specified project, or 0 for all[0m
[30;1m19173 | [0m[35mprojects.[0m
[30;1m19174 | [0m[35m    - showTrialData: whether to surface trial specific data from the best trial.[0m
[30;1m19175 | [0m[35m    - sortBy: Sort experiments by the given field.[0m
[30;1m19176 | [0m[35m[0m
[30;1m19177 | [0m[35m - SORT_BY_UNSPECIFIED: Returns experiments in an unsorted list.[0m
[30;1m19178 | [0m[35m - SORT_BY_ID: Returns experiments sorted by id.[0m

[31m--[ [0m[34mMatch #[0m[33m1584[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19037 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m19038 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m19039 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m19040 | [0m[35m    - sortBy: Sort trials by the given field.[0m
[30;1m19041 | [0m[35m[0m
[30;1m19042 | [0m[35m - SORT_BY_UNSPECIFIED: Returns trials in an unsorted list.[0m
[30;1m19043 | [0m[35m - SORT_BY_ID: Returns trials sorted by id.[0m

[31m--[ [0m[34mMatch #[0m[33m1585[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18958 | [0m[35m - SORT_BY_STATE: Returns checkpoints sorted by state.[0m
[30;1m18959 | [0m[35m - SORT_BY_SEARCHER_METRIC: Returns checkpoints sorted by the experiment's `searcher.metric`[0m
[30;1m18960 | [0m[35mconfiguration setting.[0m
[30;1m18961 | [0m[35m    - sortByMetric: Sort by custom validation metric name.[0m
[30;1m18962 | [0m[35m    - states: Limit the checkpoints to those that match the states.[0m
[30;1m18963 | [0m[35m[0m
[30;1m18964 | [0m[35m - STATE_UNSPECIFIED: The state of the checkpoint is unknown.[0m

[31m--[ [0m[34mMatch #[0m[33m1586[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18948 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m18949 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m18950 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m18951 | [0m[35m    - sortByAttr: Sort by preset checkpoint attribute.[0m
[30;1m18952 | [0m[35m[0m
[30;1m18953 | [0m[35m - SORT_BY_UNSPECIFIED: Returns checkpoints in an unsorted list.[0m
[30;1m18954 | [0m[35m - SORT_BY_UUID: Returns checkpoints sorted by UUID.[0m

[31m--[ [0m[34mMatch #[0m[33m1587[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18866 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m18867 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m18868 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m18869 | [0m[35m    - sortBy: Sort commands by the given field.[0m
[30;1m18870 | [0m[35m[0m
[30;1m18871 | [0m[35m - SORT_BY_UNSPECIFIED: Returns commands in an unsorted list.[0m
[30;1m18872 | [0m[35m - SORT_BY_ID: Returns commands sorted by id.[0m

[31m--[ [0m[34mMatch #[0m[33m1588[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18696 | [0m[35m - ORDER_BY_UNSPECIFIED: Returns records in no specific order.[0m
[30;1m18697 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m18698 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m18699 | [0m[35m    - sortBy: Sort agents by the given field.[0m
[30;1m18700 | [0m[35m[0m
[30;1m18701 | [0m[35m - SORT_BY_UNSPECIFIED: Returns agents in an unsorted list.[0m
[30;1m18702 | [0m[35m - SORT_BY_ID: Returns agents sorted by id.[0m

[31m--[ [0m[34mMatch #[0m[33m1589[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18594 | [0m[35m - ORDER_BY_ASC: Returns records in ascending order.[0m
[30;1m18595 | [0m[35m - ORDER_BY_DESC: Returns records in descending order.[0m
[30;1m18596 | [0m[35m    - showInactive: Filter by active status.[0m
[30;1m18597 | [0m[35m    - sortBy: Sort token info by the given field.[0m
[30;1m18598 | [0m[35m[0m
[30;1m18599 | [0m[35m - SORT_BY_UNSPECIFIED: Returns token info in an unsorted list.[0m
[30;1m18600 | [0m[35m - SORT_BY_USER_ID: Returns token info sorted by user id.[0m

[31m--[ [0m[34mMatch #[0m[33m1590[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17800 | [0m[35m    timeSeriesFilter_timeRange_lte: "typing.Optional[str]" = None,[0m
[30;1m17801 | [0m[35m    trialIds: "typing.Optional[typing.Sequence[int]]" = None,[0m
[30;1m17802 | [0m[35m) -> "v1CompareTrialsResponse":[0m
[30;1m17803 | [0m[35m    """Return a downsampled time series of metrics from multiple trials to compare[0m
[30;1m17804 | [0m[35m    them side-by-side.[0m
[30;1m17805 | [0m[35m[0m
[30;1m17806 | [0m[35m    - endBatches: Sample from metrics before this batch number.[0m

[31m--[ [0m[34mMatch #[0m[33m1591[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17343 | [0m[35m    the allocation is preempted.[0m
[30;1m17344 | [0m[35m[0m
[30;1m17345 | [0m[35m    - allocationId: The id of the allocation.[0m
[30;1m17346 | [0m[35m    - timeoutSeconds: The timeout in seconds.[0m
[30;1m17347 | [0m[35m    """[0m
[30;1m17348 | [0m[35m    _params = {[0m
[30;1m17349 | [0m[35m        "timeoutSeconds": timeoutSeconds,[0m

[31m--[ [0m[34mMatch #[0m[33m1592[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17339 | [0m[35m) -> "v1AllocationPreemptionSignalResponse":[0m
[30;1m17340 | [0m[35m    """Long poll preemption signals for the given allocation. If the allocation[0m
[30;1m17341 | [0m[35m    has been preempted when called, it will return so immediately. Otherwise,[0m
[30;1m17342 | [0m[35m    the connection will be kept open until the timeout is reached or[0m
[30;1m17343 | [0m[35m    the allocation is preempted.[0m
[30;1m17344 | [0m[35m[0m
[30;1m17345 | [0m[35m    - allocationId: The id of the allocation.[0m

[31m--[ [0m[34mMatch #[0m[33m1593[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14781 | [0m[35m        return out[0m
[30;1m14782 | [0m[35m[0m
[30;1m14783 | [0m[35mclass v1Shell(Printable):[0m
[30;1m14784 | [0m[35m    """Shell is an ssh server in a containerized environment."""[0m
[30;1m14785 | [0m[35m    addresses: "typing.Optional[typing.Sequence[typing.Dict[str, typing.Any]]]" = None[0m
[30;1m14786 | [0m[35m    agentUserGroup: "typing.Optional[typing.Dict[str, typing.Any]]" = None[0m
[30;1m14787 | [0m[35m    container: "typing.Optional[v1Container]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1594[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14245 | [0m[35m        if not isinstance(projectId, Unset):[0m
[30;1m14246 | [0m[35m            self.projectId = projectId[0m
[30;1m14247 | [0m[35m        if not isinstance(sort, Unset):[0m
[30;1m14248 | [0m[35m            self.sort = sort[0m
[30;1m14249 | [0m[35m[0m
[30;1m14250 | [0m[35m    @classmethod[0m
[30;1m14251 | [0m[35m    def from_json(cls, obj: Json) -> "v1SearchRunsRequest":[0m
[30;1m14252 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m

[31m--[ [0m[34mMatch #[0m[33m1595[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14088 | [0m[35m        if not isinstance(projectId, Unset):[0m
[30;1m14089 | [0m[35m            self.projectId = projectId[0m
[30;1m14090 | [0m[35m        if not isinstance(sort, Unset):[0m
[30;1m14091 | [0m[35m            self.sort = sort[0m
[30;1m14092 | [0m[35m[0m
[30;1m14093 | [0m[35m    @classmethod[0m
[30;1m14094 | [0m[35m    def from_json(cls, obj: Json) -> "v1SearchExperimentsRequest":[0m
[30;1m14095 | [0m[35m        kwargs: "typing.Dict[str, typing.Any]" = {[0m

[31m--[ [0m[34mMatch #[0m[33m1596[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13549 | [0m[35m[0m
[30;1m13550 | [0m[35mclass v1ResourcesSummary(Printable):[0m
[30;1m13551 | [0m[35m    """ResourcesSummary provides a summary of the resources comprising what we know[0m
[30;1m13552 | [0m[35m    at the time the allocation is granted, but for k8s it is granted before being[0m
[30;1m13553 | [0m[35m    scheduled so it isn't really much and `agent_devices` are missing for k8s.[0m
[30;1m13554 | [0m[35m    """[0m
[30;1m13555 | [0m[35m    agentDevices: "typing.Optional[typing.Dict[str, ResourcesSummaryDevices]]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1597[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7053 | [0m[35mclass v1GetWorkspaceProjectsRequestSortBy(DetEnum):[0m
[30;1m7054 | [0m[35m    """Sort associated projects by the given field.[0m
[30;1m7055 | [0m[35m    - SORT_BY_UNSPECIFIED: Returns projects in an unsorted list.[0m
[30;1m7056 | [0m[35m    - SORT_BY_CREATION_TIME: Returns projects sorted by time that they were created.[0m
[30;1m7057 | [0m[35m    - SORT_BY_LAST_EXPERIMENT_START_TIME: Returns projects sorted by most recent start of an experim[0m
[30;1m7058 | [0m[35m    - SORT_BY_NAME: Returns projects sorted by name.[0m
[30;1m7059 | [0m[35m    - SORT_BY_DESCRIPTION: Returns projects sorted by description.[0m

[31m--[ [0m[34mMatch #[0m[33m1598[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4600 | [0m[35m    """[0m
[30;1m4601 | [0m[35m    UNSPECIFIED = "SORT_BY_UNSPECIFIED"[0m
[30;1m4602 | [0m[35m    ID = "SORT_BY_ID"[0m
[30;1m4603 | [0m[35m    TIME = "SORT_BY_TIME"[0m
[30;1m4604 | [0m[35m[0m
[30;1m4605 | [0m[35mclass v1GetAgentsResponse(Printable):[0m
[30;1m4606 | [0m[35m    """Response to GetAgentsRequest."""[0m

[31m--[ [0m[34mMatch #[0m[33m1599[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4130 | [0m[35m        return out[0m
[30;1m4131 | [0m[35m[0m
[30;1m4132 | [0m[35mclass v1FileNode(Printable):[0m
[30;1m4133 | [0m[35m    """File node is one node of file in experiment model definition file tree."""[0m
[30;1m4134 | [0m[35m    contentLength: "typing.Optional[int]" = None[0m
[30;1m4135 | [0m[35m    contentType: "typing.Optional[str]" = None[0m
[30;1m4136 | [0m[35m    files: "typing.Optional[typing.Sequence[v1FileNode]]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1600[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4130 | [0m[35m        return out[0m
[30;1m4131 | [0m[35m[0m
[30;1m4132 | [0m[35mclass v1FileNode(Printable):[0m
[30;1m4133 | [0m[35m    """File node is one node of file in experiment model definition file tree."""[0m
[30;1m4134 | [0m[35m    contentLength: "typing.Optional[int]" = None[0m
[30;1m4135 | [0m[35m    contentType: "typing.Optional[str]" = None[0m
[30;1m4136 | [0m[35m    files: "typing.Optional[typing.Sequence[v1FileNode]]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1601[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3089 | [0m[35m        values: "typing.Union[typing.Dict[str, typing.Any], None, Unset]" = _unset,[0m
[30;1m3090 | [0m[35m    ):[0m
[30;1m3091 | [0m[35m        self.batches = batches[0m
[30;1m3092 | [0m[35m        self.time = time[0m
[30;1m3093 | [0m[35m        if not isinstance(epoch, Unset):[0m
[30;1m3094 | [0m[35m            self.epoch = epoch[0m
[30;1m3095 | [0m[35m        if not isinstance(values, Unset):[0m
[30;1m3096 | [0m[35m            self.values = values[0m

[31m--[ [0m[34mMatch #[0m[33m1602[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2555 | [0m[35m        return out[0m
[30;1m2556 | [0m[35m[0m
[30;1m2557 | [0m[35mclass v1Container(Printable):[0m
[30;1m2558 | [0m[35m    """Container is a Docker container that is either scheduled to run or is[0m
[30;1m2559 | [0m[35m    currently running on a set of slots.[0m
[30;1m2560 | [0m[35m    """[0m
[30;1m2561 | [0m[35m    devices: "typing.Optional[typing.Sequence[v1Device]]" = None[0m

[31m--[ [0m[34mMatch #[0m[33m1603[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m666 | [0m[35m    - STATE_PULLING: The task's base image is being pulled from the Docker registry.[0m
[30;1m667 | [0m[35m    - STATE_STARTING: The image has been pulled and the task is being started, but the task is[0m
[30;1m668 | [0m[35m    not ready yet.[0m
[30;1m669 | [0m[35m    - STATE_RUNNING: The service in the task is running.[0m
[30;1m670 | [0m[35m    - STATE_TERMINATED: The task has exited or has been aborted.[0m
[30;1m671 | [0m[35m    - STATE_TERMINATING: The task has begun to exit.[0m
[30;1m672 | [0m[35m    - STATE_WAITING: The task is waiting on something to complete.[0m

[31m--[ [0m[34mMatch #[0m[33m1604[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m663 | [0m[35mclass taskv1State(DetEnum):[0m
[30;1m664 | [0m[35m    """The current state of the task.[0m
[30;1m665 | [0m[35m    - STATE_UNSPECIFIED: The task state is unknown.[0m
[30;1m666 | [0m[35m    - STATE_PULLING: The task's base image is being pulled from the Docker registry.[0m
[30;1m667 | [0m[35m    - STATE_STARTING: The image has been pulled and the task is being started, but the task is[0m
[30;1m668 | [0m[35m    not ready yet.[0m
[30;1m669 | [0m[35m    - STATE_RUNNING: The service in the task is running.[0m

[31m--[ [0m[34mMatch #[0m[33m1605[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m383 | [0m[35m    - STATE_PULLING: The container's base image is being pulled from the Docker registry.[0m
[30;1m384 | [0m[35m    - STATE_STARTING: The image has been built and the container is being started, but the[0m
[30;1m385 | [0m[35m    service in the container is not ready yet.[0m
[30;1m386 | [0m[35m    - STATE_RUNNING: The service in the container is able to accept requests.[0m
[30;1m387 | [0m[35m    - STATE_TERMINATED: The container has completely exited or the container has been aborted prior[0m
[30;1m388 | [0m[35m    to getting assigned.[0m
[30;1m389 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1606[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m382 | [0m[35m    - STATE_ASSIGNED: The container has been assigned to an agent but has not started yet.[0m
[30;1m383 | [0m[35m    - STATE_PULLING: The container's base image is being pulled from the Docker registry.[0m
[30;1m384 | [0m[35m    - STATE_STARTING: The image has been built and the container is being started, but the[0m
[30;1m385 | [0m[35m    service in the container is not ready yet.[0m
[30;1m386 | [0m[35m    - STATE_RUNNING: The service in the container is able to accept requests.[0m
[30;1m387 | [0m[35m    - STATE_TERMINATED: The container has completely exited or the container has been aborted prior[0m
[30;1m388 | [0m[35m    to getting assigned.[0m

[31m--[ [0m[34mMatch #[0m[33m1607[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/bindings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m380 | [0m[35m    """The current state of the container.[0m
[30;1m381 | [0m[35m    - STATE_UNSPECIFIED: The container state is unknown.[0m
[30;1m382 | [0m[35m    - STATE_ASSIGNED: The container has been assigned to an agent but has not started yet.[0m
[30;1m383 | [0m[35m    - STATE_PULLING: The container's base image is being pulled from the Docker registry.[0m
[30;1m384 | [0m[35m    - STATE_STARTING: The image has been built and the container is being started, but the[0m
[30;1m385 | [0m[35m    service in the container is not ready yet.[0m
[30;1m386 | [0m[35m    - STATE_RUNNING: The service in the container is able to accept requests.[0m

[31m--[ [0m[34mMatch #[0m[33m1608[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined-0.38.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35mTo install the CLI:[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m```bash[0m
[30;1m135 | [0m[35mpip install determined[0m
[30;1m136 | [0m[35m```[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35mThen use `det deploy` to start the Determined cluster locally, or on cloud services like AWS and GCP[0m

[31m--[ [0m[34mMatch #[0m[33m1609[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        optimizations_config = self.env.experiment_config.get_optimizations_config()[0m
[30;1m56 | [0m[35m        self._aggregation_frequency = cast(int, optimizations_config.get("aggregation_frequency"))[0m
[30;1m57 | [0m[35m        self._average_aggregated_gradients = cast([0m
[30;1m58 | [0m[35m            bool, optimizations_config.get("average_aggregated_gradients")[0m
[30;1m59 | [0m[35m        )[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        self._optimizers = []  # type: List[tf.keras.optimizers.Optimizer][0m

[31m--[ [0m[34mMatch #[0m[33m1610[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        self.train_config = None  # type: Optional[TFKerasTrainConfig][0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        optimizations_config = self.env.experiment_config.get_optimizations_config()[0m
[30;1m56 | [0m[35m        self._aggregation_frequency = cast(int, optimizations_config.get("aggregation_frequency"))[0m
[30;1m57 | [0m[35m        self._average_aggregated_gradients = cast([0m
[30;1m58 | [0m[35m            bool, optimizations_config.get("average_aggregated_gradients")[0m
[30;1m59 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1611[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m214 | [0m[35m                        specified(since targets will be obtained from x).[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m                    validation_data: Data on which to evaluate the loss and any model metrics[0m
[30;1m217 | [0m[35m                        at the end of each epoch. The model will not be trained on this data.[0m
[30;1m218 | [0m[35m                        validation_data will override validation_split. validation_data could be:[0m
[30;1m219 | [0m[35m                        1) tuple (x_val, y_val) of Numpy arrays[0m
[30;1m220 | [0m[35m                        2) tuple (x_val, y_val, val_sample_weights) of Numpy arrays[0m

[31m--[ [0m[34mMatch #[0m[33m1612[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m        master_url = user_requested_master or get_default_master_url()[0m
[30;1m90 | [0m[35m        master_url = canonicalize_master_url(master_url)[0m
[30;1m91 | [0m[35m    """[0m
[30;1m92 | [0m[35m    return os.environ.get("DET_MASTER", os.environ.get("DET_MASTER_ADDR", "localhost:8080"))[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mdef read_paginated([0m

[31m--[ [0m[34mMatch #[0m[33m1613[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m        master_url = user_requested_master or get_default_master_url()[0m
[30;1m90 | [0m[35m        master_url = canonicalize_master_url(master_url)[0m
[30;1m91 | [0m[35m    """[0m
[30;1m92 | [0m[35m    return os.environ.get("DET_MASTER", os.environ.get("DET_MASTER_ADDR", "localhost:8080"))[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mdef read_paginated([0m

[31m--[ [0m[34mMatch #[0m[33m1614[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m.hostname[0m
[30;1m72 | [0m[35m        )[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    port = parsed.port or default_port[0m
[30;1m75 | [0m[35m    netloc = f"{parsed.hostname}:{port}"[0m
[30;1m76 | [0m[35m    return parse.urlunparse((parsed.scheme, netloc, parsed.path, "", "", "")).rstrip("/")[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1615[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m.hostname[0m
[30;1m63 | [0m[35m    parsed = parse.urlparse(url)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    if not parsed.hostname:[0m
[30;1m66 | [0m[35m        raise ValueError(f"invalid master url {url}; master url must contain a nonempty hostname")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    if parsed.username or parsed.password or parsed.query or parsed.fragment:[0m
[30;1m69 | [0m[35m        raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m1616[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m.hostname[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    parsed = parse.urlparse(url)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    if not parsed.hostname:[0m
[30;1m66 | [0m[35m        raise ValueError(f"invalid master url {url}; master url must contain a nonempty hostname")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    if parsed.username or parsed.password or parsed.query or parsed.fragment:[0m

[31m--[ [0m[34mMatch #[0m[33m1617[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_util.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m40 | [0m[35m      - explicit scheme[0m
[30;1m41 | [0m[35m      - nonempty host[0m
[30;1m42 | [0m[35m      - explicit port[0m
[30;1m43 | [0m[35m      - path does not end in a '/', if it is present at all[0m
[30;1m44 | [0m[35m      - no username, password, query, or fragment[0m
[30;1m45 | [0m[35m      - a full url can be trivially formed a la f"{master_url}/path/to/resource"[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1618[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m413 | [0m[35m        network communication before the final ``cross_slot_reduce()``.[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m        An additional reason for using the ``det.pytorch.MetricReducer`` is for flexibility of the[0m
[30;1m416 | [0m[35m        update mechanism, which is completely user-defined when subclassing ``MetricReducer``.[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m        For the full details and a code example, see: :class:`~determined.pytorch.MetricReducer`.[0m
[30;1m419 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1619[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m408 | [0m[35m        **MetricReducer objects: the advanced API**[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m        The primary motivation for passing a ``det.pytorch.MetricReducer`` as the reducer is[0m
[30;1m411 | [0m[35m        performance. ``det.pytorch.MetricReducer`` allows the user more control in how values are[0m
[30;1m412 | [0m[35m        stored and exposes a ``per_slot_reduce()`` call which lets users minimize the cost of the[0m
[30;1m413 | [0m[35m        network communication before the final ``cross_slot_reduce()``.[0m
[30;1m414 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1620[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m        The primary motivation for passing a function as the reducer is simplicity. Metrics from[0m
[30;1m364 | [0m[35m        all batches will be buffered in memory and passed over the network before they are reduced[0m
[30;1m365 | [0m[35m        all at once. This introduces some overhead, but it is likely unnoticeable for scalar[0m
[30;1m366 | [0m[35m        metrics or on validation datasets of small or medium size.  This single function strategy[0m
[30;1m367 | [0m[35m        can be useful for quick prototyping or for calculating metrics that are difficult[0m
[30;1m368 | [0m[35m        or impossible to calculate incrementally.[0m

[31m--[ [0m[34mMatch #[0m[33m1621[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m65 | [0m[35m    by exposing these steps to users:[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m       -  Step 1 is defined by the user; it is not part of the interface.  This flexibility[0m
[30;1m68 | [0m[35m          gives the user full control when gathering individual values for reduction.[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m       -  Step 2 is the MetricReducer.per_slot_reduce() interface.[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1622[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m491 | [0m[35m                        "wrapped by a call to wrap_reducer() with name set but it returned a "[0m
[30;1m492 | [0m[35m                        "dict anyway.  Please leave name=None (the default value) if you wish "[0m
[30;1m493 | [0m[35m                        "to return a dict of multiple metrics or return a single metric (not "[0m
[30;1m494 | [0m[35m                        "a dict) if you wish to return a single named metric."[0m
[30;1m495 | [0m[35m                    )[0m
[30;1m496 | [0m[35m                metrics[wrapped.name] = reduced[0m
[30;1m497 | [0m[35m        return metrics[0m

[31m--[ [0m[34mMatch #[0m[33m1623[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m489 | [0m[35m                    raise AssertionError([0m
[30;1m490 | [0m[35m                        f"The custom reduction MetricReducer {type(wrapped.reducer).__name__} was "[0m
[30;1m491 | [0m[35m                        "wrapped by a call to wrap_reducer() with name set but it returned a "[0m
[30;1m492 | [0m[35m                        "dict anyway.  Please leave name=None (the default value) if you wish "[0m
[30;1m493 | [0m[35m                        "to return a dict of multiple metrics or return a single metric (not "[0m
[30;1m494 | [0m[35m                        "a dict) if you wish to return a single named metric."[0m
[30;1m495 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m1624[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m484 | [0m[35m                            "wrapped by a call to wrap_reducer() with name set but it returned a "[0m
[30;1m485 | [0m[35m                            "dict anyway.  Please leave name=None (the default value) if you wish "[0m
[30;1m486 | [0m[35m                            "to return a dict of multiple metrics or return a single metric (not "[0m
[30;1m487 | [0m[35m                            "a dict) if you wish to return a single named metric."[0m
[30;1m488 | [0m[35m                        )[0m
[30;1m489 | [0m[35m                    raise AssertionError([0m
[30;1m490 | [0m[35m                        f"The custom reduction MetricReducer {type(wrapped.reducer).__name__} was "[0m

[31m--[ [0m[34mMatch #[0m[33m1625[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m482 | [0m[35m                        raise AssertionError([0m
[30;1m483 | [0m[35m                            f"The custom reduction function {wrapped.reducer.fn.__name__}() was "[0m
[30;1m484 | [0m[35m                            "wrapped by a call to wrap_reducer() with name set but it returned a "[0m
[30;1m485 | [0m[35m                            "dict anyway.  Please leave name=None (the default value) if you wish "[0m
[30;1m486 | [0m[35m                            "to return a dict of multiple metrics or return a single metric (not "[0m
[30;1m487 | [0m[35m                            "a dict) if you wish to return a single named metric."[0m
[30;1m488 | [0m[35m                        )[0m

[31m--[ [0m[34mMatch #[0m[33m1626[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m466 | [0m[35m                        f"The custom reduction MetricReducer {type(wrapped.reducer).__name__} was "[0m
[30;1m467 | [0m[35m                        "wrapped by a call to wrap_reducer() with name=None but it did not return "[0m
[30;1m468 | [0m[35m                        f"return a dict (it returned a {type(reduced).__name__}).  Please "[0m
[30;1m469 | [0m[35m                        "set name if you wish to return a single metric or return a dictionary "[0m
[30;1m470 | [0m[35m                        "mapping names to metrics if you with to return multiple metrics from "[0m
[30;1m471 | [0m[35m                        "a single reducer."[0m
[30;1m472 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m1627[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_reducer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m458 | [0m[35m                            f"The custom reduction function {wrapped.reducer.fn.__name__}() was "[0m
[30;1m459 | [0m[35m                            "wrapped by a call to wrap_reducer() with name=None but it did not "[0m
[30;1m460 | [0m[35m                            f"return a dict (it returned a {type(reduced).__name__}).  Please set "[0m
[30;1m461 | [0m[35m                            "name if you wish to return a single metric or return a dictionary "[0m
[30;1m462 | [0m[35m                            "mapping names to metrics if you with to return multiple metrics from "[0m
[30;1m463 | [0m[35m                            "a single reducer."[0m
[30;1m464 | [0m[35m                        )[0m

[31m--[ [0m[34mMatch #[0m[33m1628[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m        assert logs[0m
[30;1m287 | [0m[35m        metrics = {**logs}[0m
[30;1m288 | [0m[35m        metrics["epochs"] = metrics.get("epochs", self._epoch + 1)[0m
[30;1m289 | [0m[35m        metrics["batches"] = metrics.get("batches", self._steps_completed)[0m
[30;1m290 | [0m[35m        self._core.train.report_metrics("validation", self._steps_completed, metrics)[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m        # Remember how many batches we trained, for next time.[0m

[31m--[ [0m[34mMatch #[0m[33m1629[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m        assert logs[0m
[30;1m287 | [0m[35m        metrics = {**logs}[0m
[30;1m288 | [0m[35m        metrics["epochs"] = metrics.get("epochs", self._epoch + 1)[0m
[30;1m289 | [0m[35m        metrics["batches"] = metrics.get("batches", self._steps_completed)[0m
[30;1m290 | [0m[35m        self._core.train.report_metrics("validation", self._steps_completed, metrics)[0m
[30;1m291 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1630[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m            # Filter out the validation logs.[0m
[30;1m231 | [0m[35m            metrics = {k: v for k, v in logs.items() if not k.startswith("val_")}[0m
[30;1m232 | [0m[35m            metrics["epochs"] = metrics.get("epochs", epoch + 1)[0m
[30;1m233 | [0m[35m            metrics["batches"] = metrics.get("batches", self._steps_completed)[0m
[30;1m234 | [0m[35m            self._core.train.report_metrics("training", self._steps_completed, metrics)[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        # Report progress.[0m

[31m--[ [0m[34mMatch #[0m[33m1631[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m            assert logs[0m
[30;1m230 | [0m[35m            # Filter out the validation logs.[0m
[30;1m231 | [0m[35m            metrics = {k: v for k, v in logs.items() if not k.startswith("val_")}[0m
[30;1m232 | [0m[35m            metrics["epochs"] = metrics.get("epochs", epoch + 1)[0m
[30;1m233 | [0m[35m            metrics["batches"] = metrics.get("batches", self._steps_completed)[0m
[30;1m234 | [0m[35m            self._core.train.report_metrics("training", self._steps_completed, metrics)[0m
[30;1m235 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1632[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m            metrics = {k: v for k, v in logs.items() if k not in ("batch", "size")}[0m
[30;1m211 | [0m[35m            # Add epochs and batches.[0m
[30;1m212 | [0m[35m            metrics["epochs"] = metrics.get("epochs", self._epoch + 1)[0m
[30;1m213 | [0m[35m            metrics["batches"] = metrics.get("batches", self._steps_completed)[0m
[30;1m214 | [0m[35m            self._core.train.report_metrics("training", self._steps_completed, metrics)[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m        # Print progress.[0m

[31m--[ [0m[34mMatch #[0m[33m1633[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m            # Skip non-metrics data from logs.[0m
[30;1m210 | [0m[35m            metrics = {k: v for k, v in logs.items() if k not in ("batch", "size")}[0m
[30;1m211 | [0m[35m            # Add epochs and batches.[0m
[30;1m212 | [0m[35m            metrics["epochs"] = metrics.get("epochs", self._epoch + 1)[0m
[30;1m213 | [0m[35m            metrics["batches"] = metrics.get("batches", self._steps_completed)[0m
[30;1m214 | [0m[35m            self._core.train.report_metrics("training", self._steps_completed, metrics)[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1634[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m    # Mask the inherited ProgbarLogger behavior that we don't actually want.[0m
[30;1m112 | [0m[35m    def set_params(self, params: Dict[str, Any]) -> None:[0m
[30;1m113 | [0m[35m        callbacks.Callback.set_params(self, params)[0m
[30;1m114 | [0m[35m        self._is_verbose = bool(params.get("verbose", 0) != 0)[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    # Mask the inherited ProgbarLogger behavior that we don't actually want.[0m
[30;1m117 | [0m[35m    def on_predict_begin(self, logs: Optional[Dict[str, Any]]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1635[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m52 | [0m[35m        train_metrics_report_period: Either the string ``"epoch"`` or a number of batches to wait[0m
[30;1m53 | [0m[35m            between reporting training metrics to Determined master.  Default: ``"epoch"``.[0m
[30;1m54 | [0m[35m        checkpoint_epochs: Save every N epochs.  Checkpoints are always saved when training is[0m
[30;1m55 | [0m[35m            preempted, or at the end of training.  A value of `0` means to only save at those times.[0m
[30;1m56 | [0m[35m            Default: 1.[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    See also:[0m

[31m--[ [0m[34mMatch #[0m[33m1636[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m52 | [0m[35m        train_metrics_report_period: Either the string ``"epoch"`` or a number of batches to wait[0m
[30;1m53 | [0m[35m            between reporting training metrics to Determined master.  Default: ``"epoch"``.[0m
[30;1m54 | [0m[35m        checkpoint_epochs: Save every N epochs.  Checkpoints are always saved when training is[0m
[30;1m55 | [0m[35m            preempted, or at the end of training.  A value of `0` means to only save at those times.[0m
[30;1m56 | [0m[35m            Default: 1.[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    See also:[0m

[31m--[ [0m[34mMatch #[0m[33m1637[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_callback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m            self._save(epoch)[0m
[30;1m244 | [0m[35m            self._last_ckpt_epoch = epoch[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        # Check for preemption.  Checkpointing time can be non-negligible, so we check for[0m
[30;1m247 | [0m[35m        # preemption here after possibly saving a checkpoint.  If we didn't save a checkpoint but we[0m
[30;1m248 | [0m[35m        # did get preempted, we'll catch that in the checkpoint fallback in on_train_end().[0m
[30;1m249 | [0m[35m        if self._core.preempt.should_preempt():[0m

[31m--[ [0m[34mMatch #[0m[33m1638[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/certs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        maybe_shim_old_cert_store(old_path, store_path, master_url)[0m
[30;1m214 | [0m[35m        cert_pem = cert_store.get_cert(master_url)[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m    env_name = os.environ.get("DET_MASTER_CERT_NAME")[0m
[30;1m217 | [0m[35m    if env_name == "":[0m
[30;1m218 | [0m[35m        env_name = None[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1639[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/certs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m        return Cert(cert_pem=cert_pem, noverify=explicit_noverify, name=explicit_cert_name)[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    # Let any environment variable for CERT_FILE override the default store.[0m
[30;1m195 | [0m[35m    env_path = os.environ.get("DET_MASTER_CERT_FILE")[0m
[30;1m196 | [0m[35m    noverify = False[0m
[30;1m197 | [0m[35m    cert_pem = None[0m
[30;1m198 | [0m[35m    if env_path:[0m

[31m--[ [0m[34mMatch #[0m[33m1640[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/certs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m            return None[0m
[30;1m132 | [0m[35m        # Technically this doesn't have to be modfiable, but it is unlikely to matter.[0m
[30;1m133 | [0m[35m        with self._persistent_store() as store:[0m
[30;1m134 | [0m[35m            return store.get(url)[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    def set_cert(self, url: str, cert_pem: str) -> None:[0m
[30;1m137 | [0m[35m        with self._persistent_store() as store:[0m

[31m--[ [0m[34mMatch #[0m[33m1641[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/certs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m115 | [0m[35m        with filelock.FileLock(lock):[0m
[30;1m116 | [0m[35m            store = self._load_store_file()[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m            # No need for try/finally, because we don't update the file after failures.[0m
[30;1m119 | [0m[35m            yield store[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m            with temp.open("w") as f:[0m

[31m--[ [0m[34mMatch #[0m[33m1642[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m972 | [0m[35m        # Inject batches and epochs into validation metrics.[0m
[30;1m973 | [0m[35m        # (this is after batches and possibly epochs have been updated)[0m
[30;1m974 | [0m[35m        metrics["batches"] = metrics.get("batches", self.multiplexer.state.total_batches)[0m
[30;1m975 | [0m[35m        metrics["epochs"] = metrics.get("epochs", self.multiplexer.state.epoch)[0m
[30;1m976 | [0m[35m[0m
[30;1m977 | [0m[35m        self.metric_writer.on_validation_step_end(self.steps_completed, metrics)[0m
[30;1m978 | [0m[35m        self.upload_tb_files()[0m

[31m--[ [0m[34mMatch #[0m[33m1643[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m971 | [0m[35m[0m
[30;1m972 | [0m[35m        # Inject batches and epochs into validation metrics.[0m
[30;1m973 | [0m[35m        # (this is after batches and possibly epochs have been updated)[0m
[30;1m974 | [0m[35m        metrics["batches"] = metrics.get("batches", self.multiplexer.state.total_batches)[0m
[30;1m975 | [0m[35m        metrics["epochs"] = metrics.get("epochs", self.multiplexer.state.epoch)[0m
[30;1m976 | [0m[35m[0m
[30;1m977 | [0m[35m        self.metric_writer.on_validation_step_end(self.steps_completed, metrics)[0m

[31m--[ [0m[34mMatch #[0m[33m1644[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m895 | [0m[35m        final_metrics["batches"] = final_metrics.get([0m
[30;1m896 | [0m[35m            "batches", self.multiplexer.state.total_batches[0m
[30;1m897 | [0m[35m        )[0m
[30;1m898 | [0m[35m        final_metrics["epochs"] = final_metrics.get("epochs", self.multiplexer.state.epoch)[0m
[30;1m899 | [0m[35m[0m
[30;1m900 | [0m[35m        self.multiplexer._train_workload_end(final_metrics)[0m
[30;1m901 | [0m[35m        self._stop_training_check()[0m

[31m--[ [0m[34mMatch #[0m[33m1645[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m892 | [0m[35m[0m
[30;1m893 | [0m[35m        # Inject batches and epochs into avg metrics.[0m
[30;1m894 | [0m[35m        # (this is after batches and possibly epochs have been updated)[0m
[30;1m895 | [0m[35m        final_metrics["batches"] = final_metrics.get([0m
[30;1m896 | [0m[35m            "batches", self.multiplexer.state.total_batches[0m
[30;1m897 | [0m[35m        )[0m
[30;1m898 | [0m[35m        final_metrics["epochs"] = final_metrics.get("epochs", self.multiplexer.state.epoch)[0m

[31m--[ [0m[34mMatch #[0m[33m1646[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    def on_test_batch_end(self, batch: int, logs: Optional[Dict] = None) -> None:[0m
[30;1m145 | [0m[35m        super().on_test_batch_end(batch, logs)[0m
[30;1m146 | [0m[35m        assert isinstance(logs, dict)[0m
[30;1m147 | [0m[35m        self.test_inputs += logs.get([0m
[30;1m148 | [0m[35m            "size", self.trial_controller.context.get_per_slot_batch_size()[0m
[30;1m149 | [0m[35m        )[0m
[30;1m150 | [0m[35m        self.test_batches += 1[0m

[31m--[ [0m[34mMatch #[0m[33m1647[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m        # handles the case where logs is not present (see BaseLogger callback).  I (rb) can't[0m
[30;1m133 | [0m[35m        # figure out where that would originate from, so we will include reasonable fallback[0m
[30;1m134 | [0m[35m        # behavior for that case.[0m
[30;1m135 | [0m[35m        num_inputs = logs.get("size", self.trial_controller.context.get_per_slot_batch_size())[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        self.trial_controller._post_train_batch_end(num_inputs, logs)[0m
[30;1m138 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1648[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1027 | [0m[35m        """[0m
[30;1m1028 | [0m[35m        Initializes a trial using the provided ``context``.[0m
[30;1m1029 | [0m[35m[0m
[30;1m1030 | [0m[35m        This method should typically be overridden by trial definitions: at minimum,[0m
[30;1m1031 | [0m[35m        it is important to store ``context`` as an instance variable so that[0m
[30;1m1032 | [0m[35m        it can be accessed by other methods of the trial class. This can also be a[0m
[30;1m1033 | [0m[35m        convenient place to initialize other state that is shared between methods.[0m

[31m--[ [0m[34mMatch #[0m[33m1649[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1008 | [0m[35m[0m
[30;1m1009 | [0m[35m    Trials default to using eager execution with TensorFlow 2.x but not with[0m
[30;1m1010 | [0m[35m    TensorFlow 1.x. To override the default behavior, call the appropriate[0m
[30;1m1011 | [0m[35m    function at the top of your code. For example, if you want to disable[0m
[30;1m1012 | [0m[35m    eager execution while using TensorFlow 2.x, call[0m
[30;1m1013 | [0m[35m    ``tf.compat.v1.disable_eager_execution`` after your import statements.[0m
[30;1m1014 | [0m[35m    If you are using TensorFlow 1.x in eager mode, please add[0m

[31m--[ [0m[34mMatch #[0m[33m1650[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m946 | [0m[35m        if self.context.distributed.size > 1:[0m
[30;1m947 | [0m[35m            # Use a global ZMQ barrier here because we have observed cases where hvd.allreduce[0m
[30;1m948 | [0m[35m            # may hang when called minutes apart by different workers which may happen if[0m
[30;1m949 | [0m[35m            # workers complete evaluation at different speeds.[0m
[30;1m950 | [0m[35m            hvd = horovod.hvd[0m
[30;1m951 | [0m[35m            _ = self.context.distributed.gather(None)[0m
[30;1m952 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1651[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m885 | [0m[35m            self.train_workload_inputs = self._convert_possible_tensor(self.train_workload_inputs)[0m
[30;1m886 | [0m[35m[0m
[30;1m887 | [0m[35m        # Return only the latest metrics, which is the running average for all trained batches in[0m
[30;1m888 | [0m[35m        # the step (Keras does not report individual logs, only running averages at any point).[0m
[30;1m889 | [0m[35m        final_metrics = self.train_workload_metrics[-1][0m
[30;1m890 | [0m[35m        if self.env.experiment_config.average_training_metrics_enabled():[0m
[30;1m891 | [0m[35m            final_metrics = self._allreduce_logs(final_metrics)[0m

[31m--[ [0m[34mMatch #[0m[33m1652[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m875 | [0m[35m        if self.train_response_func is None:[0m
[30;1m876 | [0m[35m            raise AssertionError([0m
[30;1m877 | [0m[35m                "train_response_func is not set.  This should not be possible; please file an "[0m
[30;1m878 | [0m[35m                "issue at github.com/determined-ai/determined so we can fix this bug."[0m
[30;1m879 | [0m[35m            )[0m
[30;1m880 | [0m[35m[0m
[30;1m881 | [0m[35m        if self.context.distributed.size > 1:[0m

[31m--[ [0m[34mMatch #[0m[33m1653[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m745 | [0m[35m[0m
[30;1m746 | [0m[35m            # A special side-effect of converting the keras sequence to a generator and passing[0m
[30;1m747 | [0m[35m            # steps explicitly is that keras will exit our generator after N steps and the[0m
[30;1m748 | [0m[35m            # Sequence.on_epoch_end() that normally runs after the last yield won't run at all[0m
[30;1m749 | [0m[35m            # because the fit loop will call next() exactly `steps` times.  So we try to match the[0m
[30;1m750 | [0m[35m            # exact keras behavior by manually calling on_epoch_end() here.[0m
[30;1m751 | [0m[35m            self.validation_data.on_epoch_end()[0m

[31m--[ [0m[34mMatch #[0m[33m1654[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m492 | [0m[35m            hvd = horovod.hvd[0m
[30;1m493 | [0m[35m            callbacks_list = [hvd.callbacks.BroadcastGlobalVariablesCallback(0)] + callbacks_list[0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m        # The remainder of Determined control logic is done with a custom callbacks.CallbackList[0m
[30;1m496 | [0m[35m        self.callback_list = callbacks.CallbackList(callbacks_list)[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m        # Disable timing of callbacks in some versions of keras. This can fail in some corner-cases[0m

[31m--[ [0m[34mMatch #[0m[33m1655[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m488 | [0m[35m[0m
[30;1m489 | [0m[35m        if self.context.distributed.size > 1:[0m
[30;1m490 | [0m[35m            # Horovod synchronization of initial variables should happen even before we enter our[0m
[30;1m491 | [0m[35m            # control loop, in case we have an initial validation requested.[0m
[30;1m492 | [0m[35m            hvd = horovod.hvd[0m
[30;1m493 | [0m[35m            callbacks_list = [hvd.callbacks.BroadcastGlobalVariablesCallback(0)] + callbacks_list[0m
[30;1m494 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1656[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m        # Standard post-callback from the real configure_callbacks().[0m
[30;1m461 | [0m[35m        # Note that we are not including BaseLogger since it is only for averaging metrics over an[0m
[30;1m462 | [0m[35m        # entire epoch, and we don't report any metrics in on_epoch_end at all.[0m
[30;1m463 | [0m[35m        self.model.history = det_callbacks._DeterminedHistory()[0m
[30;1m464 | [0m[35m        callbacks_list = callbacks_list + [self.model.history][0m
[30;1m465 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1657[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m202 | [0m[35m    @classmethod[0m
[30;1m203 | [0m[35m    def _set_random_seeds(cls: Type["TFKerasTrialController"], seed: int) -> None:[0m
[30;1m204 | [0m[35m        # Set identical random seeds on all training processes. When using horovod, each worker will[0m
[30;1m205 | [0m[35m        # start at a unique offset in the dataset, ensuring it's processing a unique training batch.[0m
[30;1m206 | [0m[35m        random.seed(seed)[0m
[30;1m207 | [0m[35m        np.random.seed(seed)[0m
[30;1m208 | [0m[35m        tf.compat.v1.set_random_seed(seed)[0m

[31m--[ [0m[34mMatch #[0m[33m1658[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1008 | [0m[35m[0m
[30;1m1009 | [0m[35m    Trials default to using eager execution with TensorFlow 2.x but not with[0m
[30;1m1010 | [0m[35m    TensorFlow 1.x. To override the default behavior, call the appropriate[0m
[30;1m1011 | [0m[35m    function at the top of your code. For example, if you want to disable[0m
[30;1m1012 | [0m[35m    eager execution while using TensorFlow 2.x, call[0m
[30;1m1013 | [0m[35m    ``tf.compat.v1.disable_eager_execution`` after your import statements.[0m
[30;1m1014 | [0m[35m    If you are using TensorFlow 1.x in eager mode, please add[0m

[31m--[ [0m[34mMatch #[0m[33m1659[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m602 | [0m[35m        self._load_optimizers_weights(load_path.joinpath("determined-keras-optimizer-weights.h5"))[0m
[30;1m603 | [0m[35m[0m
[30;1m604 | [0m[35m    def _load(self, load_path: pathlib.Path) -> None:[0m
[30;1m605 | [0m[35m        # Find model code path, we check multiple naming conventions for backwards compatibility.[0m
[30;1m606 | [0m[35m        if load_path.joinpath("determined-keras-model.h5").exists():[0m
[30;1m607 | [0m[35m            self._load_model_and_optimizer_weights_v2(load_path)[0m
[30;1m608 | [0m[35m        elif load_path.joinpath("determined-keras-optimizer-weights.h5").exists():[0m

[31m--[ [0m[34mMatch #[0m[33m1660[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tf_keras_trial.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport pickle[0m
[30;1m7 | [0m[35mimport random[0m
[30;1m8 | [0m[35mimport sys[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mimport warnings[0m
[30;1m11 | [0m[35mfrom typing import Any, Dict, List, Optional, Tuple, Type, cast[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mimport h5py[0m

[31m--[ [0m[34mMatch #[0m[33m1661[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        # Use persistent session or create a new single-use one.[0m
[30;1m148 | [0m[35m        session = self._http_session or self._make_http_session()[0m
[30;1m149 | [0m[35m        try:[0m
[30;1m150 | [0m[35m            r = session.request([0m
[30;1m151 | [0m[35m                method=method,[0m
[30;1m152 | [0m[35m                url=f"{self.master}/{relpath}",[0m
[30;1m153 | [0m[35m                params=params,[0m

[31m--[ [0m[34mMatch #[0m[33m1662[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m       with api.Session(...) as session:[0m
[30;1m93 | [0m[35m           # Each request within the context re-uses the same HTTP connection.[0m
[30;1m94 | [0m[35m           session.get(...)[0m
[30;1m95 | [0m[35m           session.get(...)[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    """[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1663[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m    .. code:: python[0m
[30;1m91 | [0m[35m       with api.Session(...) as session:[0m
[30;1m92 | [0m[35m           # Each request within the context re-uses the same HTTP connection.[0m
[30;1m93 | [0m[35m           session.get(...)[0m
[30;1m94 | [0m[35m           session.get(...)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1664[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m       session = api.Session(...)[0m
[30;1m85 | [0m[35m       # Each request opens and closes a new HTTP connection.[0m
[30;1m86 | [0m[35m       session.get(...)[0m
[30;1m87 | [0m[35m       session.get(...)[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    Example of use as a context manager:[0m
[30;1m90 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1665[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m       session = api.Session(...)[0m
[30;1m84 | [0m[35m       # Each request opens and closes a new HTTP connection.[0m
[30;1m85 | [0m[35m       session.get(...)[0m
[30;1m86 | [0m[35m       session.get(...)[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    Example of use as a context manager:[0m

[31m--[ [0m[34mMatch #[0m[33m1666[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m        error = json_resp.get("error")[0m
[30;1m57 | [0m[35m        if "message" in error:[0m
[30;1m58 | [0m[35m            return str(error.get("message"))[0m
[30;1m59 | [0m[35m        return str(error.get("error"))[0m
[30;1m60 | [0m[35m    except Exception:[0m
[30;1m61 | [0m[35m        return ""[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1667[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        # Look here first then fallback to {"error": {"error": "..."}} if there is no message.[0m
[30;1m56 | [0m[35m        error = json_resp.get("error")[0m
[30;1m57 | [0m[35m        if "message" in error:[0m
[30;1m58 | [0m[35m            return str(error.get("message"))[0m
[30;1m59 | [0m[35m        return str(error.get("error"))[0m
[30;1m60 | [0m[35m    except Exception:[0m
[30;1m61 | [0m[35m        return ""[0m

[31m--[ [0m[34mMatch #[0m[33m1668[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        # Try getting GRPC error description if message does not exist.[0m
[30;1m54 | [0m[35m        # GRPC errors can have an optional {"error": {"message": "..."}} field.[0m
[30;1m55 | [0m[35m        # Look here first then fallback to {"error": {"error": "..."}} if there is no message.[0m
[30;1m56 | [0m[35m        error = json_resp.get("error")[0m
[30;1m57 | [0m[35m        if "message" in error:[0m
[30;1m58 | [0m[35m            return str(error.get("message"))[0m
[30;1m59 | [0m[35m        return str(error.get("error"))[0m

[31m--[ [0m[34mMatch #[0m[33m1669[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35mdef _get_error_str(r: requests.models.Response) -> str:[0m
[30;1m47 | [0m[35m    try:[0m
[30;1m48 | [0m[35m        json_resp = _json.loads(r.text)[0m
[30;1m49 | [0m[35m        mes = json_resp.get("message")[0m
[30;1m50 | [0m[35m        if mes is not None:[0m
[30;1m51 | [0m[35m            return str(mes)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1670[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m345 | [0m[35m    def cert_verify(self, conn: Any, url: Any, verify: Any, cert: Any) -> None:[0m
[30;1m346 | [0m[35m        super().cert_verify(conn, url, verify, cert)  # type: ignore[0m
[30;1m347 | [0m[35m        # Set the server_hostname value of the urllib3 connection.[0m
[30;1m348 | [0m[35m        conn.assert_hostname = self.server_hostname[0m

[31m--[ [0m[34mMatch #[0m[33m1671[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m345 | [0m[35m    def cert_verify(self, conn: Any, url: Any, verify: Any, cert: Any) -> None:[0m
[30;1m346 | [0m[35m        super().cert_verify(conn, url, verify, cert)  # type: ignore[0m
[30;1m347 | [0m[35m        # Set the server_hostname value of the urllib3 connection.[0m
[30;1m348 | [0m[35m        conn.assert_hostname = self.server_hostname[0m

[31m--[ [0m[34mMatch #[0m[33m1672[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    def cert_verify(self, conn: Any, url: Any, verify: Any, cert: Any) -> None:[0m
[30;1m346 | [0m[35m        super().cert_verify(conn, url, verify, cert)  # type: ignore[0m
[30;1m347 | [0m[35m        # Set the server_hostname value of the urllib3 connection.[0m
[30;1m348 | [0m[35m        conn.assert_hostname = self.server_hostname[0m

[31m--[ [0m[34mMatch #[0m[33m1673[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    def __init__(self, server_hostname: Optional[str], **kwargs: Any) -> None:[0m
[30;1m342 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m343 | [0m[35m        self.server_hostname = server_hostname[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    def cert_verify(self, conn: Any, url: Any, verify: Any, cert: Any) -> None:[0m
[30;1m346 | [0m[35m        super().cert_verify(conn, url, verify, cert)  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m1674[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    def __init__(self, server_hostname: Optional[str], **kwargs: Any) -> None:[0m
[30;1m342 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m343 | [0m[35m        self.server_hostname = server_hostname[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    def cert_verify(self, conn: Any, url: Any, verify: Any, cert: Any) -> None:[0m
[30;1m346 | [0m[35m        super().cert_verify(conn, url, verify, cert)  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m1675[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m338 | [0m[35m    (i.e. custom TLS certificates, private IP addresses).[0m
[30;1m339 | [0m[35m    """[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    def __init__(self, server_hostname: Optional[str], **kwargs: Any) -> None:[0m
[30;1m342 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m343 | [0m[35m        self.server_hostname = server_hostname[0m
[30;1m344 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1676[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m334 | [0m[35mclass _HTTPSAdapter(adapters.HTTPAdapter):[0m
[30;1m335 | [0m[35m    """Overrides the hostname checked against for TLS verification.[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m    This is used when the request address specified does not match its DNS resolved hostname[0m
[30;1m338 | [0m[35m    (i.e. custom TLS certificates, private IP addresses).[0m
[30;1m339 | [0m[35m    """[0m
[30;1m340 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1677[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35mclass _HTTPSAdapter(adapters.HTTPAdapter):[0m
[30;1m335 | [0m[35m    """Overrides the hostname checked against for TLS verification.[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m    This is used when the request address specified does not match its DNS resolved hostname[0m
[30;1m338 | [0m[35m    (i.e. custom TLS certificates, private IP addresses).[0m

[31m--[ [0m[34mMatch #[0m[33m1678[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m    def _make_http_session(self) -> requests.Session:[0m
[30;1m309 | [0m[35m        return _make_requests_session([0m
[30;1m310 | [0m[35m            server_hostname=self.cert.name if self.cert else None,[0m
[30;1m311 | [0m[35m            verify=self.cert.bundle if self.cert else None,[0m
[30;1m312 | [0m[35m            max_retries=self._max_retries,[0m
[30;1m313 | [0m[35m            headers={self.AUTH_HEADER: f"Bearer {self.token}"},[0m

[31m--[ [0m[34mMatch #[0m[33m1679[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    def _make_http_session(self) -> requests.Session:[0m
[30;1m270 | [0m[35m        return _make_requests_session([0m
[30;1m271 | [0m[35m            server_hostname=self.cert.name if self.cert else None,[0m
[30;1m272 | [0m[35m            verify=self.cert.bundle if self.cert else None,[0m
[30;1m273 | [0m[35m            max_retries=self._max_retries,[0m
[30;1m274 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1680[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m        verify = True[0m
[30;1m34 | [0m[35m    requests_session = requests.Session()[0m
[30;1m35 | [0m[35m    requests_session.mount([0m
[30;1m36 | [0m[35m        "https://", _HTTPSAdapter(server_hostname=server_hostname, max_retries=max_retries)[0m
[30;1m37 | [0m[35m    )[0m
[30;1m38 | [0m[35m    requests_session.mount("http://", adapters.HTTPAdapter(max_retries=max_retries))[0m
[30;1m39 | [0m[35m    requests_session.verify = verify[0m

[31m--[ [0m[34mMatch #[0m[33m1681[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m        verify = True[0m
[30;1m34 | [0m[35m    requests_session = requests.Session()[0m
[30;1m35 | [0m[35m    requests_session.mount([0m
[30;1m36 | [0m[35m        "https://", _HTTPSAdapter(server_hostname=server_hostname, max_retries=max_retries)[0m
[30;1m37 | [0m[35m    )[0m
[30;1m38 | [0m[35m    requests_session.mount("http://", adapters.HTTPAdapter(max_retries=max_retries))[0m
[30;1m39 | [0m[35m    requests_session.verify = verify[0m

[31m--[ [0m[34mMatch #[0m[33m1682[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m.hostname[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef _make_requests_session([0m
[30;1m27 | [0m[35m    server_hostname: Optional[str] = None,[0m
[30;1m28 | [0m[35m    verify: Optional[Union[str, bool]] = None,[0m
[30;1m29 | [0m[35m    max_retries: Optional[GeneralizedRetry] = None,[0m
[30;1m30 | [0m[35m    headers: Optional[Dict[str, Any]] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m1683[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m335 | [0m[35m    """Overrides the hostname checked against for TLS verification.[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m    This is used when the request address specified does not match its DNS resolved hostname[0m
[30;1m338 | [0m[35m    (i.e. custom TLS certificates, private IP addresses).[0m
[30;1m339 | [0m[35m    """[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    def __init__(self, server_hostname: Optional[str], **kwargs: Any) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1684[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35mDEFAULT_MAX_RETRIES = urllib3.util.retry.Retry([0m
[30;1m20 | [0m[35m    total=5,[0m
[30;1m21 | [0m[35m    backoff_factor=0.5,  # {backoff factor} * (2 ** ({number of total retries} - 1))[0m
[30;1m22 | [0m[35m    status_forcelist=[502, 503, 504],  # Bad Gateway, Service Unavailable, Gateway Timeout[0m
[30;1m23 | [0m[35m)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef _make_requests_session([0m

[31m--[ [0m[34mMatch #[0m[33m1685[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/_session.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35mDEFAULT_MAX_RETRIES = urllib3.util.retry.Retry([0m
[30;1m20 | [0m[35m    total=5,[0m
[30;1m21 | [0m[35m    backoff_factor=0.5,  # {backoff factor} * (2 ** ({number of total retries} - 1))[0m
[30;1m22 | [0m[35m    status_forcelist=[502, 503, 504],  # Bad Gateway, Service Unavailable, Gateway Timeout[0m
[30;1m23 | [0m[35m)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1686[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/metric.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35m    if not validation or not validation["metrics"]:[0m
[30;1m6 | [0m[35m        return None[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m    return validation["metrics"].get("validation_metrics", {}).get(metric_name)[0m

[31m--[ [0m[34mMatch #[0m[33m1687[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/api/metric.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35m    if not validation or not validation["metrics"]:[0m
[30;1m6 | [0m[35m        return None[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m    return validation["metrics"].get("validation_metrics", {}).get(metric_name)[0m

[31m--[ [0m[34mMatch #[0m[33m1688[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_enqueuer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m        """Periodically conduct a health check while waiting on workers"""[0m
[30;1m320 | [0m[35m        while True:[0m
[30;1m321 | [0m[35m            try:[0m
[30;1m322 | [0m[35m                return self.answers.get(timeout=5)[0m
[30;1m323 | [0m[35m            except multiprocessing.queues.Empty:  # type: ignore[0m
[30;1m324 | [0m[35m                self.health_check()[0m
[30;1m325 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1689[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_enqueuer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m        return threading.Thread[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m    def get_answer(self) -> Any:[0m
[30;1m306 | [0m[35m        return self.answers.get()[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35mclass _MultiprocessingEnqueuer(_ParallelEnqueuer):[0m

[31m--[ [0m[34mMatch #[0m[33m1690[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_enqueuer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    try:[0m
[30;1m164 | [0m[35m        while True:[0m
[30;1m165 | [0m[35m            query = queries.get()[0m
[30;1m166 | [0m[35m            if query is None:[0m
[30;1m167 | [0m[35m                return[0m
[30;1m168 | [0m[35m            i, order = query[0m

[31m--[ [0m[34mMatch #[0m[33m1691[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_enqueuer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m42 | [0m[35m        check.gt_eq([0m
[30;1m43 | [0m[35m            length,[0m
[30;1m44 | [0m[35m            num_shards,[0m
[30;1m45 | [0m[35m            "please provide a Sequence that has at least as many batches as the number of slots "[0m
[30;1m46 | [0m[35m            "used for training",[0m
[30;1m47 | [0m[35m        )[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1692[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/directory.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m        )[0m
[30;1m58 | [0m[35m        storage_dir = os.path.join(self._base_path, src)[0m
[30;1m59 | [0m[35m        if not os.path.exists(storage_dir):[0m
[30;1m60 | [0m[35m            raise errors.CheckpointNotFound(f"Did not find checkpoint {src} in 'directory' storage")[0m
[30;1m61 | [0m[35m        yield pathlib.Path(storage_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m1693[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_load.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m            metadata = json.load(f)[0m
[30;1m77 | [0m[35m        framework = metadata.get("framework", "")[0m
[30;1m78 | [0m[35m        is_tf = framework.startswith("tensorflow") or "tensorflow_version" in metadata[0m
[30;1m79 | [0m[35m        save_format = metadata.get("format")[0m
[30;1m80 | [0m[35m        is_keras = save_format not in ("saved_weights", "h5")[0m
[30;1m81 | [0m[35m        if not is_tf or not is_keras:[0m
[30;1m82 | [0m[35m            logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1694[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_load.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        # Checkpoint.download().[0m
[30;1m75 | [0m[35m        with metadata_path.open() as f:[0m
[30;1m76 | [0m[35m            metadata = json.load(f)[0m
[30;1m77 | [0m[35m        framework = metadata.get("framework", "")[0m
[30;1m78 | [0m[35m        is_tf = framework.startswith("tensorflow") or "tensorflow_version" in metadata[0m
[30;1m79 | [0m[35m        save_format = metadata.get("format")[0m
[30;1m80 | [0m[35m        is_keras = save_format not in ("saved_weights", "h5")[0m

[31m--[ [0m[34mMatch #[0m[33m1695[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_load.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m89 | [0m[35m            # This is how tf.keras models were saved prior to Determined 0.13.8.[0m
[30;1m90 | [0m[35m            filename = "determined-keras-model.h5"[0m
[30;1m91 | [0m[35m        else:[0m
[30;1m92 | [0m[35m            raise AssertionError("Unknown checkpoint format at {}".format(str(ckpt_dir)))[0m
[30;1m93 | [0m[35m        experiment_config = metadata["experiment_config"][0m
[30;1m94 | [0m[35m        hparams = metadata["hparams"][0m
[30;1m95 | [0m[35m        # When this format was in use, all entrypoints were trial classes.[0m

[31m--[ [0m[34mMatch #[0m[33m1696[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_load.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    The return type is a TensorFlow AutoTrackable object.[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    Arguments:[0m
[30;1m34 | [0m[35m        path (string): Top level directory to load the checkpoint from.[0m
[30;1m35 | [0m[35m        tags (list string, optional): Specifies which tags are loaded from[0m
[30;1m36 | [0m[35m            the TensorFlow SavedModel. See documentation for `tf.compat.v1.saved_model.load_v2[0m
[30;1m37 | [0m[35m            <https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/saved_model/load_v2>`_.[0m

[31m--[ [0m[34mMatch #[0m[33m1697[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/azure_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass AzureStorageClient(object):[0m
[30;1m15 | [0m[35m    """Connects to an Azure Blob Storage service account."""[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def __init__([0m
[30;1m18 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m1698[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/ipc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m543 | [0m[35m        return self.start()[0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35m    def __exit__(self, e_type: type, e_val: Exception, _: Any) -> None:[0m
[30;1m546 | [0m[35m        # A "graceful" exit is either no exception at all, or a sys.exit(0).[0m
[30;1m547 | [0m[35m        self.close(graceful=e_type is None or isinstance(e_val, SystemExit) and e_val.code == 0)[0m
[30;1m548 | [0m[35m[0m
[30;1m549 | [0m[35m    def keep_alive(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1699[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/ipc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m264 | [0m[35m    except ValueError:[0m
[30;1m265 | [0m[35m        pass[0m
[30;1m266 | [0m[35m    raise ValueError([0m
[30;1m267 | [0m[35m        "'{addr}' is not a valid address spec; it should be a path to a unix socket (with at least "[0m
[30;1m268 | [0m[35m        "one '/'), a host:port string, or a port number"[0m
[30;1m269 | [0m[35m    )[0m
[30;1m270 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1700[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/ipc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport signal[0m
[30;1m5 | [0m[35mimport socket[0m
[30;1m6 | [0m[35mimport subprocess[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom typing import Any, Callable, Dict, List, Optional, Tuple, Union[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport determined as det[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1701[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m            except ConnectionError:[0m
[30;1m52 | [0m[35m                pass[0m
[30;1m53 | [0m[35m            else:[0m
[30;1m54 | [0m[35m                if r.headers.get("Server", "").lower() == "minio":[0m
[30;1m55 | [0m[35m                    self._use_minio_workaround = True[0m
[30;1m56 | [0m[35m                    logger.info([0m
[30;1m57 | [0m[35m                        "MinIO backend detected.  To work around a boto3 bug, empty directories"[0m

[31m--[ [0m[34mMatch #[0m[33m1702[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m        self._use_minio_workaround = False[0m
[30;1m48 | [0m[35m        if endpoint_url is not None:[0m
[30;1m49 | [0m[35m            try:[0m
[30;1m50 | [0m[35m                r = requests.get(endpoint_url)[0m
[30;1m51 | [0m[35m            except ConnectionError:[0m
[30;1m52 | [0m[35m                pass[0m
[30;1m53 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1703[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/s3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m            raise errors.NoDirectStorageAccess("Unable to access cloud checkpoint storage") from e[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        if not found:[0m
[30;1m140 | [0m[35m            raise errors.CheckpointNotFound(f"Did not find {prefix} in S3")[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    @util.preserve_random_state[0m
[30;1m143 | [0m[35m    def delete(self, tgt: str, globs: List[str]) -> Dict[str, int]:[0m

[31m--[ [0m[34mMatch #[0m[33m1704[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/harness.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m52 | [0m[35m    # the lowest layers of the harness code; it's too large of an object to be easily mockable,[0m
[30;1m53 | [0m[35m    # which is part of why building local training mode has always been a challenge.[0m
[30;1m54 | [0m[35m    #[0m
[30;1m55 | [0m[35m    # A better pattern is to pass in exactly the information that is necessary at each layer.  We[0m
[30;1m56 | [0m[35m    # will use that pattern for the future high-level APIs, but it's not worth refactoring e.g. the[0m
[30;1m57 | [0m[35m    # TFKerasTrialController or EstimatorTrialController to add that functionality, so for now we[0m
[30;1m58 | [0m[35m    # continue with the legacy strategy.[0m

[31m--[ [0m[34mMatch #[0m[33m1705[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/harness.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    # TFKerasTrialController or EstimatorTrialController to add that functionality, so for now we[0m
[30;1m58 | [0m[35m    # continue with the legacy strategy.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    env = det.EnvContext([0m
[30;1m61 | [0m[35m        master_url=info.master_url,[0m
[30;1m62 | [0m[35m        master_cert_file=info.master_cert_file,[0m
[30;1m63 | [0m[35m        master_cert_name=info.master_cert_name,[0m

[31m--[ [0m[34mMatch #[0m[33m1706[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_trainer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m    """[0m
[30;1m254 | [0m[35m    time_metric = exp_conf["searcher"].get("time_metric")[0m
[30;1m255 | [0m[35m    if time_metric is not None:[0m
[30;1m256 | [0m[35m        max_time = exp_conf["searcher"].get("max_time")[0m
[30;1m257 | [0m[35m        assert max_time, "`searcher.max_time` not configured"[0m
[30;1m258 | [0m[35m        if time_metric == "batches":[0m
[30;1m259 | [0m[35m            if not isinstance(max_length, pytorch.Batch) or max_length.value != max_time:[0m

[31m--[ [0m[34mMatch #[0m[33m1707[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_trainer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m    the experiment config. We check that the `max_length` passed to `fit()` matches the experiment[0m
[30;1m252 | [0m[35m    config and log warnings if it doesn't.[0m
[30;1m253 | [0m[35m    """[0m
[30;1m254 | [0m[35m    time_metric = exp_conf["searcher"].get("time_metric")[0m
[30;1m255 | [0m[35m    if time_metric is not None:[0m
[30;1m256 | [0m[35m        max_time = exp_conf["searcher"].get("max_time")[0m
[30;1m257 | [0m[35m        assert max_time, "`searcher.max_time` not configured"[0m

[31m--[ [0m[34mMatch #[0m[33m1708[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_trainer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m            searcher_metric_name = self._info.trial._config["searcher"]["metric"][0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m            steps_completed = int(self._info.trial._steps_completed)[0m
[30;1m186 | [0m[35m            global_batch_size = self._info.trial.hparams.get("global_batch_size", None)[0m
[30;1m187 | [0m[35m            if global_batch_size:[0m
[30;1m188 | [0m[35m                global_batch_size = int(global_batch_size)[0m
[30;1m189 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1709[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_trainer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35mdef _set_random_seeds(seed: int) -> None:[0m
[30;1m307 | [0m[35m    # Set identical random seeds on all training processes.[0m
[30;1m308 | [0m[35m    # When doing distributed training, each worker will start at a unique[0m
[30;1m309 | [0m[35m    # offset in the dataset, ensuring that it is processing a unique[0m
[30;1m310 | [0m[35m    # training batch.[0m
[30;1m311 | [0m[35m    random.seed(seed)[0m

[31m--[ [0m[34mMatch #[0m[33m1710[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_trainer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m                ``Batch(100)`` would report every 100 batches, while ``Batch([5, 30, 45])`` would[0m
[30;1m113 | [0m[35m                report after every 5th, 30th, and 45th batch.[0m
[30;1m114 | [0m[35m            checkpoint_policy: Controls how Determined performs checkpoints after validation[0m
[30;1m115 | [0m[35m                operations, if at all. Should be set to one of the following values:[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m                    best (default): A checkpoint will be taken after every validation operation[0m
[30;1m118 | [0m[35m                        that performs better than all previous validations for this experiment.[0m

[31m--[ [0m[34mMatch #[0m[33m1711[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_trainer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m296 | [0m[35m        return core.DistributedContext.from_torch_distributed()[0m
[30;1m297 | [0m[35m    elif info and (len(info.container_addrs) > 1 or len(info.slot_ids) > 1):[0m
[30;1m298 | [0m[35m        raise ValueError([0m
[30;1m299 | [0m[35m            "In multi-slot managed cluster training, you must wrap your training script with a "[0m
[30;1m300 | [0m[35m            "distributed launch layer such as determined.launch.torch_distributed or "[0m
[30;1m301 | [0m[35m            "determined.launch.horovod."[0m
[30;1m302 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1712[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_trainer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mclass Trainer:[0m
[30;1m19 | [0m[35m    """[0m
[30;1m20 | [0m[35m    ``pytorch.Trainer`` is an abstraction on top of a vanilla PyTorch training loop that handles[0m
[30;1m21 | [0m[35m    many training details under-the-hood, and exposes APIs for configuring training-related features[0m
[30;1m22 | [0m[35m    such as automatic checkpointing, validation, profiling, metrics reporting, etc.[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1713[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m        if "tensorboard_path" in config:[0m
[30;1m66 | [0m[35m            config["storage_path"] = config.get("tensorboard_path", None)[0m
[30;1m67 | [0m[35m        else:[0m
[30;1m68 | [0m[35m            config["storage_path"] = config.get("checkpoint_path", None)[0m
[30;1m69 | [0m[35m    elif identifier == "azure":[0m
[30;1m70 | [0m[35m        if not ("connection_string" in config or "account_url" in config):[0m
[30;1m71 | [0m[35m            raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m1714[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m    # storage_path.[0m
[30;1m64 | [0m[35m    if identifier == "shared_fs" and "storage_path" not in config:[0m
[30;1m65 | [0m[35m        if "tensorboard_path" in config:[0m
[30;1m66 | [0m[35m            config["storage_path"] = config.get("tensorboard_path", None)[0m
[30;1m67 | [0m[35m        else:[0m
[30;1m68 | [0m[35m            config["storage_path"] = config.get("checkpoint_path", None)[0m
[30;1m69 | [0m[35m    elif identifier == "azure":[0m

[31m--[ [0m[34mMatch #[0m[33m1715[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m        if already_exiting:[0m
[30;1m352 | [0m[35m            return[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m        if response.get("stop_requested"):[0m
[30;1m355 | [0m[35m            raise ShouldExit()[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35m        self.check_for_preemption()[0m

[31m--[ [0m[34mMatch #[0m[33m1716[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m            metrics=metrics,[0m
[30;1m315 | [0m[35m        )[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m        if response.get("stop_requested"):[0m
[30;1m318 | [0m[35m            raise ShouldExit()[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m        if not self.checkpoint_is_current():[0m

[31m--[ [0m[34mMatch #[0m[33m1717[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m        else:[0m
[30;1m234 | [0m[35m            raise ValueError(f"unrecognized searcher op unit: {self._unit}")[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        if response.get("stop_requested"):[0m
[30;1m237 | [0m[35m            # Exit after reporting metrics.[0m
[30;1m238 | [0m[35m            raise ShouldExit()[0m
[30;1m239 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1718[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m            raise ShouldExit()[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        metrics = response.get("metrics", {}).get("avg_metrics", {})[0m
[30;1m216 | [0m[35m        batch_metrics = response.get("metrics", {}).get("batch_metrics", [])[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        self.state.steps_completed += num_batches[0m
[30;1m219 | [0m[35m        self.state.step_id += 1[0m

[31m--[ [0m[34mMatch #[0m[33m1719[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m            raise ShouldExit()[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        metrics = response.get("metrics", {}).get("avg_metrics", {})[0m
[30;1m216 | [0m[35m        batch_metrics = response.get("metrics", {}).get("batch_metrics", [])[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        self.state.steps_completed += num_batches[0m
[30;1m219 | [0m[35m        self.state.step_id += 1[0m

[31m--[ [0m[34mMatch #[0m[33m1720[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m            self.core_context.train.report_early_exit(core.EarlyExitReason.INVALID_HP)[0m
[30;1m213 | [0m[35m            raise ShouldExit()[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        metrics = response.get("metrics", {}).get("avg_metrics", {})[0m
[30;1m216 | [0m[35m        batch_metrics = response.get("metrics", {}).get("batch_metrics", [])[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        self.state.steps_completed += num_batches[0m

[31m--[ [0m[34mMatch #[0m[33m1721[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m            self.core_context.train.report_early_exit(core.EarlyExitReason.INVALID_HP)[0m
[30;1m213 | [0m[35m            raise ShouldExit()[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        metrics = response.get("metrics", {}).get("avg_metrics", {})[0m
[30;1m216 | [0m[35m        batch_metrics = response.get("metrics", {}).get("batch_metrics", [])[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        self.state.steps_completed += num_batches[0m

[31m--[ [0m[34mMatch #[0m[33m1722[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        # Load our state from the checkpoint if we are continuing training after a pause or restart.[0m
[30;1m153 | [0m[35m        # If the trial_id doesn't match our current trial id, we're continuing training a previous[0m
[30;1m154 | [0m[35m        # trial and the state in the checkpoint should be discarded.[0m
[30;1m155 | [0m[35m        if state.get("trial_id") != self._trial_id:[0m
[30;1m156 | [0m[35m            return[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        self.state = self.SavableState(**state)[0m

[31m--[ [0m[34mMatch #[0m[33m1723[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m                    "in epoch units."[0m
[30;1m129 | [0m[35m                )[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        if env.experiment_config.get_min_validation_period().get("epochs") is not None:[0m
[30;1m132 | [0m[35m            if self.records_per_epoch is None:[0m
[30;1m133 | [0m[35m                raise ValueError([0m
[30;1m134 | [0m[35m                    "records_per_epoch must be specified if min_validation_period is configured "[0m

[31m--[ [0m[34mMatch #[0m[33m1724[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m        # precalculated periods, in batches[0m
[30;1m122 | [0m[35m        self.records_per_epoch = env.experiment_config.get_records_per_epoch()[0m
[30;1m123 | [0m[35m        self.global_batch_size = global_batch_size[0m
[30;1m124 | [0m[35m        if env.experiment_config.get_min_checkpoint_period().get("epochs") is not None:[0m
[30;1m125 | [0m[35m            if self.records_per_epoch is None:[0m
[30;1m126 | [0m[35m                raise ValueError([0m
[30;1m127 | [0m[35m                    "records_per_epoch must be specified if min_checkpoint_period is configured "[0m

[31m--[ [0m[34mMatch #[0m[33m1725[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        self.want_initial_val = self.env.experiment_config.get("perform_initial_validation", False)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        self.ckpt_policy = self.env.experiment_config.get("checkpoint_policy", "best")[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        self.state = self.SavableState(trial_id=self._trial_id)[0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1726[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        self.val_from_previous_run = self.core_context.train._get_last_validation()[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        self.want_initial_val = self.env.experiment_config.get("perform_initial_validation", False)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        self.ckpt_policy = self.env.experiment_config.get("checkpoint_policy", "best")[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1727[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m        global_batch_size: int,[0m
[30;1m94 | [0m[35m    ) -> None:[0m
[30;1m95 | [0m[35m        self.core_context = core_context[0m
[30;1m96 | [0m[35m        self.env = env[0m
[30;1m97 | [0m[35m        self._run_id = env.trial_run_id[0m
[30;1m98 | [0m[35m        self._trial_id = int(env.det_trial_id)[0m
[30;1m99 | [0m[35m        self._allocation_id = env.allocation_id[0m
[30;1m100 | [0m[35m        self._exp_id = int(env.det_experiment_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1728[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m329 | [0m[35m    def checkpoint(self, already_exiting: bool) -> WorkloadGenerator:[0m
[30;1m330 | [0m[35m        self.core_context.train.set_status("checkpointing")[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m        # Update the last_ckpt now so it can be captured by get_state() after we yield.[0m
[30;1m333 | [0m[35m        self.state.last_ckpt = self.state.steps_completed[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m        wkld = workload.Workload([0m

[31m--[ [0m[34mMatch #[0m[33m1729[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/layers/_workload_sequencer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    This Workload stream (and the whole WorkloadSequencer) is only even needed[0m
[30;1m69 | [0m[35m    for reverse-compatibility with the old TrialControllers that we don't care[0m
[30;1m70 | [0m[35m    to update (TFKerasTrial and EstimatorTrial).[0m
[30;1m71 | [0m[35m    """[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    class SavableState:[0m

[31m--[ [0m[34mMatch #[0m[33m1730[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m334 | [0m[35m    if isinstance(data, tuple):[0m
[30;1m335 | [0m[35m        if len(data) == 0:[0m
[30;1m336 | [0m[35m            raise ValueError([0m
[30;1m337 | [0m[35m                "`PyTorchTrial` must have at least one `np.ndarray` or `torch.Tensor` in it's tuple"[0m
[30;1m338 | [0m[35m                " of inputs."[0m
[30;1m339 | [0m[35m            )[0m
[30;1m340 | [0m[35m        return len(data[0])[0m

[31m--[ [0m[34mMatch #[0m[33m1731[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m327 | [0m[35m    if isinstance(data, list):[0m
[30;1m328 | [0m[35m        if len(data) == 0:[0m
[30;1m329 | [0m[35m            raise ValueError([0m
[30;1m330 | [0m[35m                "`PyTorchTrial` must have at least one `np.ndarray` or `torch.Tensor` in it's list "[0m
[30;1m331 | [0m[35m                "of inputs."[0m
[30;1m332 | [0m[35m            )[0m
[30;1m333 | [0m[35m        return len(data[0])[0m

[31m--[ [0m[34mMatch #[0m[33m1732[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m320 | [0m[35m    if isinstance(data, dict):[0m
[30;1m321 | [0m[35m        if len(data) == 0:[0m
[30;1m322 | [0m[35m            raise ValueError([0m
[30;1m323 | [0m[35m                "`PyTorchTrial` must have at least one `np.ndarray` or `torch.Tensor` in it's dict "[0m
[30;1m324 | [0m[35m                "of inputs."[0m
[30;1m325 | [0m[35m            )[0m
[30;1m326 | [0m[35m        return len(next(iter(data.values())))[0m

[31m--[ [0m[34mMatch #[0m[33m1733[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m72 | [0m[35m        sampler (Sampler, optional): defines the strategy to draw samples from[0m
[30;1m73 | [0m[35m            the dataset. If specified, :attr:`shuffle` must be ``False``.[0m
[30;1m74 | [0m[35m        batch_sampler (Sampler, optional): like :attr:`sampler`, but returns a batch of[0m
[30;1m75 | [0m[35m            indices at a time. Mutually exclusive with :attr:`batch_size`,[0m
[30;1m76 | [0m[35m            :attr:`shuffle`, :attr:`sampler`, and :attr:`drop_last`.[0m
[30;1m77 | [0m[35m        num_workers (int, optional): how many subprocesses to use for data[0m
[30;1m78 | [0m[35m            loading. ``0`` means that the data will be loaded in the main process.[0m

[31m--[ [0m[34mMatch #[0m[33m1734[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m68 | [0m[35m        dataset (Dataset): dataset from which to load the data.[0m
[30;1m69 | [0m[35m        batch_size (int, optional): how many samples per batch to load (default: ``1``).[0m
[30;1m70 | [0m[35m        shuffle (bool, optional): set to ``True`` to have the data reshuffled[0m
[30;1m71 | [0m[35m            at every epoch (default: ``False``).[0m
[30;1m72 | [0m[35m        sampler (Sampler, optional): defines the strategy to draw samples from[0m
[30;1m73 | [0m[35m            the dataset. If specified, :attr:`shuffle` must be ``False``.[0m
[30;1m74 | [0m[35m        batch_sampler (Sampler, optional): like :attr:`sampler`, but returns a batch of[0m

[31m--[ [0m[34mMatch #[0m[33m1735[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m44 | [0m[35m        "det.pytorch.DataLoader is a drop-in replacement for torch.utils.data.DataLoader "[0m
[30;1m45 | [0m[35m        "but which offers easy and transparent reproducibility in Determined experiments. "[0m
[30;1m46 | [0m[35m        "It is highly recommended that you use det.pytorch.DataLoader if possible.  If "[0m
[30;1m47 | [0m[35m        f"not, you can disable this check by calling {disable_repro_check_method} at some point "[0m
[30;1m48 | [0m[35m        "in your trial's __init__() method."[0m
[30;1m49 | [0m[35m    )[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1736[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m311 | [0m[35m    """[0m
[30;1m312 | [0m[35m    Calculate length of data input.[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m    Accepts np.ndarray, torch.tensor, dictionary, or list. Recursively traverses the tree to find[0m
[30;1m315 | [0m[35m    the first np.ndarray or torch.Tensor and calculates the length of it. Assumes that every "leaf"[0m
[30;1m316 | [0m[35m    of the data structure is batched to the same length.[0m
[30;1m317 | [0m[35m    """[0m
[30;1m318 | [0m[35m    if isinstance(data, (np.ndarray, torch.Tensor)):[0m

[31m--[ [0m[34mMatch #[0m[33m1737[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m        self.num_workers = num_workers[0m
[30;1m173 | [0m[35m        self.prefetch_factor = prefetch_factor[0m
[30;1m174 | [0m[35m        self.pin_memory = pin_memory[0m
[30;1m175 | [0m[35m        self.timeout = timeout[0m
[30;1m176 | [0m[35m        self.worker_init_fn = worker_init_fn[0m
[30;1m177 | [0m[35m        self.multiprocessing_context = multiprocessing_context[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m        if sampler is not None and shuffle:[0m

[31m--[ [0m[34mMatch #[0m[33m1738[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m                "use num_workers=0 to disable multiprocessing."[0m
[30;1m153 | [0m[35m            )[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        if timeout < 0:[0m
[30;1m156 | [0m[35m            raise ValueError("timeout option should be non-negative")[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        if num_workers == 0 and prefetch_factor is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1739[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m            if the dataset size is not divisible by the batch size. If ``False`` and[0m
[30;1m89 | [0m[35m            the size of dataset is not divisible by the batch size, then the last batch[0m
[30;1m90 | [0m[35m            will be smaller. (default: ``False``)[0m
[30;1m91 | [0m[35m        timeout (numeric, optional): if positive, the timeout value for collecting a batch[0m
[30;1m92 | [0m[35m            from workers. Should always be non-negative. (default: ``0``)[0m
[30;1m93 | [0m[35m        worker_init_fn (callable, optional): If not ``None``, this will be called on each[0m
[30;1m94 | [0m[35m            worker subprocess with the worker id (an int in ``[0, num_workers - 1]``) as[0m

[31m--[ [0m[34mMatch #[0m[33m1740[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m            if the dataset size is not divisible by the batch size. If ``False`` and[0m
[30;1m89 | [0m[35m            the size of dataset is not divisible by the batch size, then the last batch[0m
[30;1m90 | [0m[35m            will be smaller. (default: ``False``)[0m
[30;1m91 | [0m[35m        timeout (numeric, optional): if positive, the timeout value for collecting a batch[0m
[30;1m92 | [0m[35m            from workers. Should always be non-negative. (default: ``0``)[0m
[30;1m93 | [0m[35m        worker_init_fn (callable, optional): If not ``None``, this will be called on each[0m
[30;1m94 | [0m[35m            worker subprocess with the worker id (an int in ``[0, num_workers - 1]``) as[0m

[31m--[ [0m[34mMatch #[0m[33m1741[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/metric_writers/callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m    def _maybe_reset(self) -> None:[0m
[30;1m82 | [0m[35m        """[0m
[30;1m83 | [0m[35m        Reset (close current file and open a new one) the current writer if the current epoch[0m
[30;1m84 | [0m[35m        second is at least one second greater than the epoch second of the last reset.[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        The TensorFlow event writer names each event file by the epoch second it is created, so[0m
[30;1m87 | [0m[35m        if events are written quickly in succession (< 1 second apart), they will overwrite each[0m

[31m--[ [0m[34mMatch #[0m[33m1742[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/metric_writers/callback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport abc[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom typing import TYPE_CHECKING, Any, Dict, List, Optional, Union[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom determined import util[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1743[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m    def run(self) -> None:[0m
[30;1m271 | [0m[35m        while True:[0m
[30;1m272 | [0m[35m            try:[0m
[30;1m273 | [0m[35m                filepath = self._work_queue.get(block=True)[0m
[30;1m274 | [0m[35m                self._fetcher._fetch(filepath, self._new_file_callback)[0m
[30;1m275 | [0m[35m            except Exception as e:[0m
[30;1m276 | [0m[35m                logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1744[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    tensorboard_url = get_tensorboard_url()[0m
[30;1m92 | [0m[35m    try:[0m
[30;1m93 | [0m[35m        # Attempt HTTP request to Tensorboard.[0m
[30;1m94 | [0m[35m        res = requests.get(tensorboard_url)[0m
[30;1m95 | [0m[35m        res.raise_for_status()[0m
[30;1m96 | [0m[35m        return True[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1745[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    if bucket is None:[0m
[30;1m36 | [0m[35m        return[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    endpoint_url = os.environ.get("DET_S3_ENDPOINT_URL")[0m
[30;1m39 | [0m[35m    client = boto3.client("s3", endpoint_url=endpoint_url)[0m
[30;1m40 | [0m[35m    bucket_location = client.get_bucket_location(Bucket=bucket)[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1746[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mdef set_s3_region() -> None:[0m
[30;1m34 | [0m[35m    bucket = os.environ.get("AWS_BUCKET")[0m
[30;1m35 | [0m[35m    if bucket is None:[0m
[30;1m36 | [0m[35m        return[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1747[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m192 | [0m[35m        self._num_fetched_files = 0[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    def on_file_fetched(self) -> None:[0m
[30;1m195 | [0m[35m        """Runs on each callback from a fetcher to update the state.[0m
[30;1m196 | [0m[35m        We delay signalling the READY_SIGNAL to give TensorBoard a moment[0m
[30;1m197 | [0m[35m        to do its internal book keeping and prevent the "no data"[0m
[30;1m198 | [0m[35m        issues we were previously seeing when signalling ready immediately[0m

[31m--[ [0m[34mMatch #[0m[33m1748[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m51 | [0m[35mdef get_tensorboard_args(tb_version: str, tfevents_dir: str, add_args: List[str]) -> List[str]:[0m
[30;1m52 | [0m[35m    """Build tensorboard startup args.[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    Args are added and deprecated at the mercy of tensorboard; all of the below are necessary to[0m
[30;1m55 | [0m[35m    support versions 1.14, 2.4, and 2.5[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    - Tensorboard 2+ no longer exposes all ports. Must pass in "--bind_all" to expose localhost[0m

[31m--[ [0m[34mMatch #[0m[33m1749[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m167 | [0m[35m                while True:[0m
[30;1m168 | [0m[35m                    raise_if_dead(tensorboard_process)[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m                    # Check if we have reached a timeout without downloading any files[0m
[30;1m171 | [0m[35m                    if tb_fetch_manager.get_num_fetched_files() == 0:[0m
[30;1m172 | [0m[35m                        if time.time() > stop_time:[0m
[30;1m173 | [0m[35m                            raise RuntimeError("No new files were fetched before the timeout.")[0m

[31m--[ [0m[34mMatch #[0m[33m1750[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/tensorboard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport sys[0m
[30;1m7 | [0m[35mimport tempfile[0m
[30;1m8 | [0m[35mimport threading[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom typing import Any, Callable, Dict, List[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport boto3[0m
[30;1m13 | [0m[35mimport requests[0m

[31m--[ [0m[34mMatch #[0m[33m1751[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/metric_writers/tensorflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Optional, Set, Union[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport numpy as np[0m
[30;1m5 | [0m[35mimport tensorflow[0m

[31m--[ [0m[34mMatch #[0m[33m1752[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m        """[0m
[30;1m330 | [0m[35m        if self.task_type != "TRIAL":[0m
[30;1m331 | [0m[35m            return {}[0m
[30;1m332 | [0m[35m        return self.trial._config.get("data", {})[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m    @property[0m
[30;1m335 | [0m[35m    def trial(self) -> TrialInfo:[0m

[31m--[ [0m[34mMatch #[0m[33m1753[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m            # Optional info:[0m
[30;1m284 | [0m[35m            master_cert_name=os.environ.get("DET_MASTER_CERT_NAME"),[0m
[30;1m285 | [0m[35m            master_cert_file=os.environ.get("DET_MASTER_CERT_FILE"),[0m
[30;1m286 | [0m[35m            latest_checkpoint=os.environ.get("DET_LATEST_CHECKPOINT"),[0m
[30;1m287 | [0m[35m            # Separate info objects:[0m
[30;1m288 | [0m[35m            trial_info=TrialInfo._from_file(),[0m
[30;1m289 | [0m[35m            rendezvous_info=RendezvousInfo._from_file(),[0m

[31m--[ [0m[34mMatch #[0m[33m1754[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m            task_type=os.environ["DET_TASK_TYPE"],[0m
[30;1m283 | [0m[35m            # Optional info:[0m
[30;1m284 | [0m[35m            master_cert_name=os.environ.get("DET_MASTER_CERT_NAME"),[0m
[30;1m285 | [0m[35m            master_cert_file=os.environ.get("DET_MASTER_CERT_FILE"),[0m
[30;1m286 | [0m[35m            latest_checkpoint=os.environ.get("DET_LATEST_CHECKPOINT"),[0m
[30;1m287 | [0m[35m            # Separate info objects:[0m
[30;1m288 | [0m[35m            trial_info=TrialInfo._from_file(),[0m

[31m--[ [0m[34mMatch #[0m[33m1755[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m281 | [0m[35m            session_token=os.environ["DET_SESSION_TOKEN"],[0m
[30;1m282 | [0m[35m            task_type=os.environ["DET_TASK_TYPE"],[0m
[30;1m283 | [0m[35m            # Optional info:[0m
[30;1m284 | [0m[35m            master_cert_name=os.environ.get("DET_MASTER_CERT_NAME"),[0m
[30;1m285 | [0m[35m            master_cert_file=os.environ.get("DET_MASTER_CERT_FILE"),[0m
[30;1m286 | [0m[35m            latest_checkpoint=os.environ.get("DET_LATEST_CHECKPOINT"),[0m
[30;1m287 | [0m[35m            # Separate info objects:[0m

[31m--[ [0m[34mMatch #[0m[33m1756[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m            steps_completed=int(os.environ["DET_STEPS_COMPLETED"]),[0m
[30;1m121 | [0m[35m            trial_run_id=int(os.environ["DET_TRIAL_RUN_ID"]),[0m
[30;1m122 | [0m[35m            debug=experiment_config.get("debug", False),[0m
[30;1m123 | [0m[35m            inter_node_network_interface=os.environ.get("DET_INTER_NODE_NETWORK_INTERFACE"),[0m
[30;1m124 | [0m[35m        )[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    def _to_file(self, path: str = DEFAULT_TRIAL_INFO_PATH) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1757[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m            config=experiment_config,[0m
[30;1m120 | [0m[35m            steps_completed=int(os.environ["DET_STEPS_COMPLETED"]),[0m
[30;1m121 | [0m[35m            trial_run_id=int(os.environ["DET_TRIAL_RUN_ID"]),[0m
[30;1m122 | [0m[35m            debug=experiment_config.get("debug", False),[0m
[30;1m123 | [0m[35m            inter_node_network_interface=os.environ.get("DET_INTER_NODE_NETWORK_INTERFACE"),[0m
[30;1m124 | [0m[35m        )[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1758[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mdef getenv_int(key: str) -> Optional[int]:[0m
[30;1m15 | [0m[35m    val = os.environ.get(key)[0m
[30;1m16 | [0m[35m    return val if val is None else int(val)[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1759[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m204 | [0m[35m        master_cert_name: Optional[str] = None,[0m
[30;1m205 | [0m[35m        master_cert_file: Optional[str] = None,[0m
[30;1m206 | [0m[35m        latest_checkpoint: Optional[str] = None,[0m
[30;1m207 | [0m[35m        # Information which is generated within a container at runtime.[0m
[30;1m208 | [0m[35m        trial_info: Optional[TrialInfo] = None,[0m
[30;1m209 | [0m[35m        rendezvous_info: Optional[RendezvousInfo] = None,[0m
[30;1m210 | [0m[35m        resources_info: Optional[ResourcesInfo] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m1760[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m        # have always been and will always be user-defined.[0m
[30;1m96 | [0m[35m        self._config = config[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        # rb: These fields are private because I am pretty confident that we need to find better[0m
[30;1m99 | [0m[35m        # ways to pass them around the system.  But for now, they're passed in as environment[0m
[30;1m100 | [0m[35m        # variables and for now we have to be able to handle that.[0m
[30;1m101 | [0m[35m        # TODO: decide if we really want to track steps_completed for users or not.[0m

[31m--[ [0m[34mMatch #[0m[33m1761[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_info.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m    def _to_file(self, path: str = DEFAULT_RENDEZVOUS_INFO_PATH) -> None:[0m
[30;1m43 | [0m[35m        """[0m
[30;1m44 | [0m[35m        to_file writes the RendezvousInfo to a well-known location in a Determined container.  This[0m
[30;1m45 | [0m[35m        is called automatically early in the lifetime of a container, so user code can always expect[0m
[30;1m46 | [0m[35m        this file to be written before user code runs.[0m
[30;1m47 | [0m[35m        """[0m
[30;1m48 | [0m[35m        with open(path, "w") as f:[0m
[30;1m49 | [0m[35m            json.dump(vars(self), f)[0m

[31m--[ [0m[34mMatch #[0m[33m1762[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/common/storage/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m65 | [0m[35m        """[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        # Set umask to 0 in order that the storage dir allows future containers of any owner to[0m
[30;1m68 | [0m[35m        # create new checkpoints. Administrators wishing to control the permissions more[0m
[30;1m69 | [0m[35m        # specifically should just create the storage path themselves; this will not interfere.[0m
[30;1m70 | [0m[35m        old_umask = os.umask(0)[0m
[30;1m71 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1763[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_tensorboard_callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35m    def __init__(self, *args: Any, **kwargs: Any):[0m
[30;1m12 | [0m[35m        warnings.warn([0m
[30;1m13 | [0m[35m            "det.keras.TFKerasTensorBoard is a deprecated name for "[0m
[30;1m14 | [0m[35m            "det.keras.callbacks.TensorBoard, please update your code.",[0m
[30;1m15 | [0m[35m            FutureWarning,[0m
[30;1m16 | [0m[35m            stacklevel=2,[0m
[30;1m17 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1764[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_import.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m114 | [0m[35m            # Remove anything imported from local directory[0m
[30;1m115 | [0m[35m            for m in modules_from_dir(localpath):[0m
[30;1m116 | [0m[35m                popped_modules[m] = sys.modules.pop(m)[0m
[30;1m117 | [0m[35m    # Inject path at front of sys.path.[0m
[30;1m118 | [0m[35m    sys.path = [os.path.abspath(path)] + sys.path[0m
[30;1m119 | [0m[35m    # Include a Finder that prevents found files from creating __pycache__ files.[0m
[30;1m120 | [0m[35m    old_meta_path = sys.meta_path[0m

[31m--[ [0m[34mMatch #[0m[33m1765[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_import.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    """List any sys.modules that were imported from a given path."""[0m
[30;1m42 | [0m[35m    abspath = os.path.abspath(path)[0m
[30;1m43 | [0m[35m    keys_to_pop = set()[0m
[30;1m44 | [0m[35m    # sort items before processing, so we always see x before x.y before x.y.z[0m
[30;1m45 | [0m[35m    for k, v in sorted(sys.modules.items()):[0m
[30;1m46 | [0m[35m        if v is None:[0m
[30;1m47 | [0m[35m            # cached miss in sys.modules[0m

[31m--[ [0m[34mMatch #[0m[33m1766[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/tensorflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mif __name__ == "__main__":[0m
[30;1m101 | [0m[35m    port, script = parse_args(sys.argv[1:])[0m
[30;1m102 | [0m[35m    sys.exit(main(port, script))[0m

[31m--[ [0m[34mMatch #[0m[33m1767[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/tensorflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m    if not full_script:[0m
[30;1m92 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m93 | [0m[35m        parser.print_usage()[0m
[30;1m94 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m95 | [0m[35m        sys.exit(1)[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    return parsed.port, full_script[0m

[31m--[ [0m[34mMatch #[0m[33m1768[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/tensorflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m    full_script = parsed.script + extra_script[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    if not full_script:[0m
[30;1m92 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m93 | [0m[35m        parser.print_usage()[0m
[30;1m94 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m95 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1769[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/tensorflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35mdef parse_args(args: List[str]) -> Tuple[int, List[str]]:[0m
[30;1m58 | [0m[35m    parser = argparse.ArgumentParser([0m
[30;1m59 | [0m[35m        usage="%(prog)s [--port PORT] [--] SCRIPT...",[0m
[30;1m60 | [0m[35m        description="Launch a script for tensorflow training on a Determined cluster.",[0m
[30;1m61 | [0m[35m        epilog=([0m
[30;1m62 | [0m[35m            "This launcher automatically injects a TF_CONFIG environment variable suitable for "[0m
[30;1m63 | [0m[35m            "MirroredStrategy or MultiWorkerMirroredStrategy when multiple nodes and or GPUs are "[0m

[31m--[ [0m[34mMatch #[0m[33m1770[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/tensorflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        # (no point in prefixing every log line with "rank=0")[0m
[30;1m46 | [0m[35m        log_wrapper = [][0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    launch_cmd = log_wrapper + script[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    logger.debug(f"Tensorflow launching with: {launch_cmd}")[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    p = subprocess.Popen(launch_cmd, env=env)[0m

[31m--[ [0m[34mMatch #[0m[33m1771[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/tensorflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m    assert info is not None, "must be run on-cluster"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    chief_ip = info.container_addrs[0][0m
[30;1m33 | [0m[35m    env = {**os.environ, "DET_CHIEF_IP": chief_ip}[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    if len(info.container_addrs) > 1:[0m
[30;1m36 | [0m[35m        # Multi-node training means MultiWorkerMirroredStrategy.[0m

[31m--[ [0m[34mMatch #[0m[33m1772[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/tensorflow.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m89 | [0m[35m    full_script = parsed.script + extra_script[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    if not full_script:[0m
[30;1m92 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m93 | [0m[35m        parser.print_usage()[0m
[30;1m94 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m95 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1773[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_load.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m            num_gpus=len(container_gpus),[0m
[30;1m267 | [0m[35m            exp_conf=config,[0m
[30;1m268 | [0m[35m            aggregation_frequency=int([0m
[30;1m269 | [0m[35m                config.get_optimizations_config().get("aggregation_frequency", 1)[0m
[30;1m270 | [0m[35m            ),[0m
[30;1m271 | [0m[35m            steps_completed=0,[0m
[30;1m272 | [0m[35m            managed_training=managed_training,[0m

[31m--[ [0m[34mMatch #[0m[33m1774[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_load.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m        )[0m
[30;1m255 | [0m[35m        use_gpu, container_gpus, slot_ids = det._get_gpus(limit_gpus=False)[0m
[30;1m256 | [0m[35m        fp16_compression = bool([0m
[30;1m257 | [0m[35m            config.get_optimizations_config().get("gradient_compression", False)[0m
[30;1m258 | [0m[35m        )[0m
[30;1m259 | [0m[35m        average_aggregated_gradients = bool(config.average_training_metrics_enabled())[0m
[30;1m260 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1775[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_load.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m        # Checkpoint.download().[0m
[30;1m142 | [0m[35m        with metadata_path.open() as f:[0m
[30;1m143 | [0m[35m            metadata = json.load(f)[0m
[30;1m144 | [0m[35m        is_torch = metadata.get("framework", "").startswith("torch")[0m
[30;1m145 | [0m[35m        has_torch_version = "torch_version" in metadata[0m
[30;1m146 | [0m[35m        # Older metadata layout contained torch_version and tensorflow_version[0m
[30;1m147 | [0m[35m        # as keys. Eventually, we should drop support for the older format.[0m

[31m--[ [0m[34mMatch #[0m[33m1776[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_load.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m        hparams = load_data["hparams"][0m
[30;1m132 | [0m[35m        trial_cls_spec = load_data["trial_cls_spec"][0m
[30;1m133 | [0m[35m        is_trainer = load_data.get("is_trainer", False)[0m
[30;1m134 | [0m[35m        trial_in_main = load_data.get("trial_in_main", False)[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    elif metadata_path.exists():[0m
[30;1m137 | [0m[35m        # PyTorchTrial.build_model() was an old api that was disallowed after 0.14.0.  There's a[0m

[31m--[ [0m[34mMatch #[0m[33m1777[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_load.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m        experiment_config = load_data["experiment_config"][0m
[30;1m131 | [0m[35m        hparams = load_data["hparams"][0m
[30;1m132 | [0m[35m        trial_cls_spec = load_data["trial_cls_spec"][0m
[30;1m133 | [0m[35m        is_trainer = load_data.get("is_trainer", False)[0m
[30;1m134 | [0m[35m        trial_in_main = load_data.get("trial_in_main", False)[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    elif metadata_path.exists():[0m

[31m--[ [0m[34mMatch #[0m[33m1778[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_load.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m        if module == "":[0m
[30;1m171 | [0m[35m            raise ValueError([0m
[30;1m172 | [0m[35m                f"Unable to load trial class {qualname}, which was defined in the entrypoint "[0m
[30;1m173 | [0m[35m                "script, but the entrypoint script did not appear to be an importable module. "[0m
[30;1m174 | [0m[35m                "Define your Trial class in an importable module instead."[0m
[30;1m175 | [0m[35m            )[0m
[30;1m176 | [0m[35m        logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1779[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_load.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m    The return value will be a restored instance of the subclass PyTorchTrial you used for training.[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    Arguments:[0m
[30;1m86 | [0m[35m        path (string): Top level directory to load the checkpoint from.[0m
[30;1m87 | [0m[35m        trial_class (optional): Provide your PyTorchTrial class to be loaded.  Only necessary if[0m
[30;1m88 | [0m[35m            the automatic import logic is insufficient.[0m
[30;1m89 | [0m[35m        trial_kwargs (optional): Additional keyword arguments to be passed to your PyTorchTrial[0m

[31m--[ [0m[34mMatch #[0m[33m1780[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m            page_count += 1[0m
[30;1m45 | [0m[35m            for s3_obj in page.get("Contents", []):[0m
[30;1m46 | [0m[35m                filepath, mdatetime = s3_obj["Key"], s3_obj["LastModified"][0m
[30;1m47 | [0m[35m                prev_mdatetime = self._file_records.get(filepath)[0m
[30;1m48 | [0m[35m                if prev_mdatetime is not None and prev_mdatetime >= mdatetime:[0m
[30;1m49 | [0m[35m                    continue[0m
[30;1m50 | [0m[35m                self._file_records[filepath] = mdatetime[0m

[31m--[ [0m[34mMatch #[0m[33m1781[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        page_count = 0[0m
[30;1m43 | [0m[35m        for page in page_iterator:[0m
[30;1m44 | [0m[35m            page_count += 1[0m
[30;1m45 | [0m[35m            for s3_obj in page.get("Contents", []):[0m
[30;1m46 | [0m[35m                filepath, mdatetime = s3_obj["Key"], s3_obj["LastModified"][0m
[30;1m47 | [0m[35m                prev_mdatetime = self._file_records.get(filepath)[0m
[30;1m48 | [0m[35m                if prev_mdatetime is not None and prev_mdatetime >= mdatetime:[0m

[31m--[ [0m[34mMatch #[0m[33m1782[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m            "s3",[0m
[30;1m23 | [0m[35m            endpoint_url=storage_config.get("endpoint_url"),[0m
[30;1m24 | [0m[35m            aws_access_key_id=storage_config.get("access_key"),[0m
[30;1m25 | [0m[35m            aws_secret_access_key=storage_config.get("secret_key"),[0m
[30;1m26 | [0m[35m        )[0m
[30;1m27 | [0m[35m        self.client = self.s3.meta.client[0m
[30;1m28 | [0m[35m        self.bucket_name = str(storage_config["bucket"])[0m

[31m--[ [0m[34mMatch #[0m[33m1783[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m        self.s3 = boto3.resource([0m
[30;1m22 | [0m[35m            "s3",[0m
[30;1m23 | [0m[35m            endpoint_url=storage_config.get("endpoint_url"),[0m
[30;1m24 | [0m[35m            aws_access_key_id=storage_config.get("access_key"),[0m
[30;1m25 | [0m[35m            aws_secret_access_key=storage_config.get("secret_key"),[0m
[30;1m26 | [0m[35m        )[0m
[30;1m27 | [0m[35m        self.client = self.s3.meta.client[0m

[31m--[ [0m[34mMatch #[0m[33m1784[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        boto3_credential_manager.initialize_boto3_credential_providers()[0m
[30;1m21 | [0m[35m        self.s3 = boto3.resource([0m
[30;1m22 | [0m[35m            "s3",[0m
[30;1m23 | [0m[35m            endpoint_url=storage_config.get("endpoint_url"),[0m
[30;1m24 | [0m[35m            aws_access_key_id=storage_config.get("access_key"),[0m
[30;1m25 | [0m[35m            aws_secret_access_key=storage_config.get("secret_key"),[0m
[30;1m26 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1785[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m        metrics, metric_type = self._get_metrics(logs)[0m
[30;1m173 | [0m[35m        logger.debug(f"on_log metrics, global_step {state.global_step}", metrics)[0m
[30;1m174 | [0m[35m        metrics["batches"] = metrics.get("batches", state.global_step)[0m
[30;1m175 | [0m[35m        metrics["epochs"] = metrics.get("epochs", state.epoch)[0m
[30;1m176 | [0m[35m        if metric_type == TRAIN:[0m
[30;1m177 | [0m[35m            # Prevents reporting metrics for the same step twice. This happens after[0m
[30;1m178 | [0m[35m            # training is completed and average training metrics are reported with[0m

[31m--[ [0m[34mMatch #[0m[33m1786[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m            return[0m
[30;1m172 | [0m[35m        metrics, metric_type = self._get_metrics(logs)[0m
[30;1m173 | [0m[35m        logger.debug(f"on_log metrics, global_step {state.global_step}", metrics)[0m
[30;1m174 | [0m[35m        metrics["batches"] = metrics.get("batches", state.global_step)[0m
[30;1m175 | [0m[35m        metrics["epochs"] = metrics.get("epochs", state.epoch)[0m
[30;1m176 | [0m[35m        if metric_type == TRAIN:[0m
[30;1m177 | [0m[35m            # Prevents reporting metrics for the same step twice. This happens after[0m

[31m--[ [0m[34mMatch #[0m[33m1787[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m                "field.  searcher.max_length is deprecated; please remove it and rely "[0m
[30;1m112 | [0m[35m                f"on {len_arg} instead to avoid ambiguous training specifications."[0m
[30;1m113 | [0m[35m            )[0m
[30;1m114 | [0m[35m        elif isinstance(cfg.get("max_length"), dict):[0m
[30;1m115 | [0m[35m            # Legacy searcher config; max_length must match provided args.[0m
[30;1m116 | [0m[35m            search_unit, search_len = next(iter(cfg["max_length"].items()))[0m
[30;1m117 | [0m[35m            if (search_unit, search_len) != (args_unit, args_len):[0m

[31m--[ [0m[34mMatch #[0m[33m1788[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m            args_len = args.num_train_epochs[0m
[30;1m105 | [0m[35m            len_arg = "--num_train_epochs"[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        if isinstance(cfg.get("max_length"), int):[0m
[30;1m108 | [0m[35m            # Legacy searcher config (unitless).  Has never been supported, actually.[0m
[30;1m109 | [0m[35m            raise ValueError([0m
[30;1m110 | [0m[35m                "HF trainer no longer respects the deprecated searcher.max_length "[0m

[31m--[ [0m[34mMatch #[0m[33m1789[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m            searcher_config = self.info.trial._config["searcher"][0m
[30;1m61 | [0m[35m            self._check_searcher_config(searcher_config, args)[0m
[30;1m62 | [0m[35m            self.searcher_metric = searcher_config["metric"][0m
[30;1m63 | [0m[35m            self.time_metric = searcher_config.get("time_metric")[0m
[30;1m64 | [0m[35m            # Don't allow filtering of the searcher or time_metric metrics.[0m
[30;1m65 | [0m[35m            if self.filter_metrics:[0m
[30;1m66 | [0m[35m                self.filter_metrics.append(self.searcher_metric)[0m

[31m--[ [0m[34mMatch #[0m[33m1790[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m267 | [0m[35m        **kwargs: Any,[0m
[30;1m268 | [0m[35m    ) -> None:[0m
[30;1m269 | [0m[35m        if state.is_world_process_zero and args.max_steps > -1:[0m
[30;1m270 | [0m[35m            # There needs to be at least 1% increase in progress to report progress (maximum 100[0m
[30;1m271 | [0m[35m            # report_progress API calls in per trial).[0m
[30;1m272 | [0m[35m            progress = state.global_step / args.max_steps[0m
[30;1m273 | [0m[35m            percent = int(progress * 100)[0m

[31m--[ [0m[34mMatch #[0m[33m1791[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m133 | [0m[35m                raise ValueError([0m
[30;1m134 | [0m[35m                    "HF trainer units does not match configured the max_time configured for "[0m
[30;1m135 | [0m[35m                    f"{name} searcher ({args_unit}={args_len} != {search_unit}={search_len}.  "[0m
[30;1m136 | [0m[35m                    f"Please update one of the searcher.max_time config field or the {len_arg} "[0m
[30;1m137 | [0m[35m                    "to match the other."[0m
[30;1m138 | [0m[35m                )[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1792[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m67 | [0m[35m                if self.time_metric:[0m
[30;1m68 | [0m[35m                    self.filter_metrics.append(self.time_metric)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        # Undocumented workarounds in case forcing the checkpoint and validations at the end of[0m
[30;1m71 | [0m[35m        # non-preempted training is a bad idea somehow.[0m
[30;1m72 | [0m[35m        self._force_final_save = True[0m
[30;1m73 | [0m[35m        self._force_final_evaluate = True[0m

[31m--[ [0m[34mMatch #[0m[33m1793[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m            control.should_training_stop = True[0m
[30;1m206 | [0m[35m            # Don't set control.should_save now, or it can trigger multiple saves, if we trigger[0m
[30;1m207 | [0m[35m            # in a training on_log and arrive here again in an evaluate on_log.  We would not cause[0m
[30;1m208 | [0m[35m            # that to happen, but other callbacks could, such as if it were just naturally time for[0m
[30;1m209 | [0m[35m            # an evaluation.  So just let the save-at-end logic handle it.[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    def _get_metrics(self, logs: Dict[str, Any]) -> Tuple[Dict[str, Any], str]:[0m

[31m--[ [0m[34mMatch #[0m[33m1794[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m        if not search_ok and not time_ok:[0m
[30;1m144 | [0m[35m            raise ValueError([0m
[30;1m145 | [0m[35m                f"Searcher metric '{self.searcher_metric}' set by searcher.metric config field "[0m
[30;1m146 | [0m[35m                f"and time metric '{self.time_metric}' from searcher.time_metric config field are "[0m
[30;1m147 | [0m[35m                "both missing; you must emit those metrics for the hyperparameter search to work."[0m
[30;1m148 | [0m[35m            )[0m
[30;1m149 | [0m[35m        if not search_ok:[0m

[31m--[ [0m[34mMatch #[0m[33m1795[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/transformers/_hf_callback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m            )[0m
[30;1m84 | [0m[35m            return[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        # To resume DeepSpeed, each node requires ALL sharded model/optimizer states,[0m
[30;1m87 | [0m[35m        # so we can skip using selector and just download all files.[0m
[30;1m88 | [0m[35m        self.core_context.checkpoint.download(latest_checkpoint, args.output_dir)[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1796[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/gcs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        for blob in blobs:[0m
[30;1m33 | [0m[35m            filepath, mtime = blob.name, blob.updated[0m
[30;1m34 | [0m[35m            prev_mtime = self._file_records.get(filepath)[0m
[30;1m35 | [0m[35m            if prev_mtime is not None and prev_mtime >= mtime:[0m
[30;1m36 | [0m[35m                continue[0m
[30;1m37 | [0m[35m            self._file_records[filepath] = mtime[0m

[31m--[ [0m[34mMatch #[0m[33m1797[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22 | [0m[35m        has an updated timestamp from when it was last fetched.[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        Arguments:[0m
[30;1m25 | [0m[35m            storage_path (str): Path at a remote location to iterate over[0m
[30;1m26 | [0m[35m            new_file_callback (Callable, optional): Callback function that[0m
[30;1m27 | [0m[35m                is fired each time a new file is fetched[0m
[30;1m28 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1798[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m        Arguments:[0m
[30;1m36 | [0m[35m            filepath (str): Filepath as a string of the file's remote location[0m
[30;1m37 | [0m[35m            new_file_callback (Callable, optional): Callback function that[0m
[30;1m38 | [0m[35m                is fired each time a new file is fetched[0m
[30;1m39 | [0m[35m        """[0m
[30;1m40 | [0m[35m        pass[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1799[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m        Arguments:[0m
[30;1m25 | [0m[35m            storage_path (str): Path at a remote location to iterate over[0m
[30;1m26 | [0m[35m            new_file_callback (Callable, optional): Callback function that[0m
[30;1m27 | [0m[35m                is fired each time a new file is fetched[0m
[30;1m28 | [0m[35m        """[0m
[30;1m29 | [0m[35m        pass[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1800[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/horovod.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m            "--fusion-threshold-mb",[0m
[30;1m113 | [0m[35m            str(optimizations.get("tensor_fusion_threshold")),[0m
[30;1m114 | [0m[35m            "--cycle-time-ms",[0m
[30;1m115 | [0m[35m            str(optimizations.get("tensor_fusion_cycle_time")),[0m
[30;1m116 | [0m[35m        ][0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    # Prevent horovod from auto-tuning these parameters.[0m

[31m--[ [0m[34mMatch #[0m[33m1801[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/horovod.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m    else:[0m
[30;1m111 | [0m[35m        performance_args = [[0m
[30;1m112 | [0m[35m            "--fusion-threshold-mb",[0m
[30;1m113 | [0m[35m            str(optimizations.get("tensor_fusion_threshold")),[0m
[30;1m114 | [0m[35m            "--cycle-time-ms",[0m
[30;1m115 | [0m[35m            str(optimizations.get("tensor_fusion_cycle_time")),[0m
[30;1m116 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m1802[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/horovod.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m    check.check_in("tensor_fusion_threshold", optimizations)[0m
[30;1m102 | [0m[35m    check.check_in("tensor_fusion_cycle_time", optimizations)[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    if optimizations.get("auto_tune_tensor_fusion"):[0m
[30;1m105 | [0m[35m        performance_args = [[0m
[30;1m106 | [0m[35m            "--autotune",[0m
[30;1m107 | [0m[35m            "--autotune-log-file",[0m

[31m--[ [0m[34mMatch #[0m[33m1803[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/horovod.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m        Declare the required type of horovod and give a unique reason as to why it is required.[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        The reason makes for clear error reporting if require_horovod_type() is called a second[0m
[30;1m33 | [0m[35m        time but with a different type.[0m
[30;1m34 | [0m[35m        """[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        known_types = {"tensorflow", "tensorflow.keras", "torch"}[0m

[31m--[ [0m[34mMatch #[0m[33m1804[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef build(storage_config: Dict[str, Any], paths: List[str], local_dir: str) -> Fetcher:[0m
[30;1m27 | [0m[35m    storage_type = storage_config.get("type")[0m
[30;1m28 | [0m[35m    if storage_type not in _FETCHERS:[0m
[30;1m29 | [0m[35m        raise ValueError(f"checkpoint_storage type '{storage_type}' is not supported")[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1805[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_experimental.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m        """[0m
[30;1m65 | [0m[35m        Prevent the PyTorchTrialController from automatically moving batched data to device.[0m
[30;1m66 | [0m[35m        Call this if you want to override the default behavior of moving all items of a list,[0m
[30;1m67 | [0m[35m        tuple, and/or dict to the GPU. Then, you can control how data is moved to the GPU directly[0m
[30;1m68 | [0m[35m        in the ``train_batch`` and ``evaluate_batch`` methods of your PyTorchTrial definition.[0m
[30;1m69 | [0m[35m        You should call context.to_device on primitive data types that you do want to move to GPU[0m
[30;1m70 | [0m[35m        as in the example below.[0m

[31m--[ [0m[34mMatch #[0m[33m1806[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_experimental.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m45 | [0m[35m        guarantee that an appropriate ``Sampler`` is used that ensures:[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        - When ``shuffle=True``, the shuffle is reproducible.[0m
[30;1m48 | [0m[35m        - The dataset will start at the right location, even after pausing/continuing.[0m
[30;1m49 | [0m[35m        - Proper sharding is used during distributed training.[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        However, there may be cases where either reproducibility of the dataset is not needed or[0m

[31m--[ [0m[34mMatch #[0m[33m1807[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_experimental.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        In those cases, you may call ``disable_dataset_reproducibility_checks()`` and you will be[0m
[30;1m55 | [0m[35m        free to return any ``torch.utils.data.DataLoader`` you like.  Dataset reproducibility will[0m
[30;1m56 | [0m[35m        still be possible, but it will be your responsibility.  If desired, you may find the[0m
[30;1m57 | [0m[35m        ``Sampler`` classes in :mod:`determined.pytorch.samplers` to be helpful.[0m
[30;1m58 | [0m[35m        """[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1808[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/keras/_data.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m    def __getitem__([0m
[30;1m126 | [0m[35m        self, index: int[0m
[30;1m127 | [0m[35m    ) -> Union[Tuple[ArrayLike, ArrayLike], Tuple[ArrayLike, ArrayLike, np.ndarray]]:[0m
[30;1m128 | [0m[35m        # Gets batch at position index.[0m
[30;1m129 | [0m[35m        start = index * self.batch_size[0m
[30;1m130 | [0m[35m        # The end is not `(index + 1) * self.batch_size` if the[0m
[30;1m131 | [0m[35m        # last batch is not a full `self.batch_size`[0m

[31m--[ [0m[34mMatch #[0m[33m1809[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/samplers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m227 | [0m[35m    .. warning::[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m       Always prefer ReproducibleShuffleSampler over this class when possible.  The reason is that[0m
[30;1m230 | [0m[35m       shuffling at the batch level results in a superior shuffle, where the contents of each[0m
[30;1m231 | [0m[35m       batch are varied between epochs, rather than just the order of batches.[0m
[30;1m232 | [0m[35m    """[0m
[30;1m233 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1810[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_callback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m        the trial is complete; it may just be paused or preempted by a higher-priority task.[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        .. warning::[0m
[30;1m45 | [0m[35m            This callback runs each time a Trial shuts down gracefully to come off the cluster.[0m
[30;1m46 | [0m[35m            This callback does not mean that the Trial is done training.  Additionally, if the trial[0m
[30;1m47 | [0m[35m            is killed the container will be destroyed without this callback running.[0m
[30;1m48 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1811[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        return self.get("optimizations", {})[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def get_checkpoint_storage(self) -> Dict[str, Any]:[0m
[30;1m64 | [0m[35m        return self.get("checkpoint_storage", {})[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def get_entrypoint(self) -> Union[str, List[str]]:[0m
[30;1m67 | [0m[35m        entrypoint = self["entrypoint"][0m

[31m--[ [0m[34mMatch #[0m[33m1812[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m        """[0m
[30;1m59 | [0m[35m        Return the optimizations configuration.[0m
[30;1m60 | [0m[35m        """[0m
[30;1m61 | [0m[35m        return self.get("optimizations", {})[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def get_checkpoint_storage(self) -> Dict[str, Any]:[0m
[30;1m64 | [0m[35m        return self.get("checkpoint_storage", {})[0m

[31m--[ [0m[34mMatch #[0m[33m1813[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m        return searcher_metric[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    def get_min_checkpoint_period(self) -> Dict:[0m
[30;1m53 | [0m[35m        min_checkpoint_period = self.get("min_checkpoint_period", {})[0m
[30;1m54 | [0m[35m        assert isinstance(min_checkpoint_period, dict)[0m
[30;1m55 | [0m[35m        return min_checkpoint_period[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1814[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        return min_validation_period[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    def get_searcher_metric(self) -> str:[0m
[30;1m45 | [0m[35m        searcher_metric = self.get("searcher", {}).get("metric")[0m
[30;1m46 | [0m[35m        assert isinstance([0m
[30;1m47 | [0m[35m            searcher_metric, str[0m
[30;1m48 | [0m[35m        ), f"searcher metric ({searcher_metric}) is not a string"[0m

[31m--[ [0m[34mMatch #[0m[33m1815[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        return min_validation_period[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    def get_searcher_metric(self) -> str:[0m
[30;1m45 | [0m[35m        searcher_metric = self.get("searcher", {}).get("metric")[0m
[30;1m46 | [0m[35m        assert isinstance([0m
[30;1m47 | [0m[35m            searcher_metric, str[0m
[30;1m48 | [0m[35m        ), f"searcher metric ({searcher_metric}) is not a string"[0m

[31m--[ [0m[34mMatch #[0m[33m1816[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        return int(records_per_epoch) if records_per_epoch is not None else None[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    def get_min_validation_period(self) -> Dict:[0m
[30;1m40 | [0m[35m        min_validation_period = self.get("min_validation_period", {})[0m
[30;1m41 | [0m[35m        assert isinstance(min_validation_period, dict)[0m
[30;1m42 | [0m[35m        return min_validation_period[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1817[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        return bool(self.get("profiling", {}).get("sync_timings", True))[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def get_records_per_epoch(self) -> Optional[int]:[0m
[30;1m36 | [0m[35m        records_per_epoch = self.get("records_per_epoch")[0m
[30;1m37 | [0m[35m        return int(records_per_epoch) if records_per_epoch is not None else None[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    def get_min_validation_period(self) -> Dict:[0m

[31m--[ [0m[34mMatch #[0m[33m1818[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        return self["profiling"]["begin_on_batch"], self["profiling"].get("end_after_batch", None)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    def profiling_sync_timings(self) -> bool:[0m
[30;1m33 | [0m[35m        return bool(self.get("profiling", {}).get("sync_timings", True))[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def get_records_per_epoch(self) -> Optional[int]:[0m
[30;1m36 | [0m[35m        records_per_epoch = self.get("records_per_epoch")[0m

[31m--[ [0m[34mMatch #[0m[33m1819[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        return self["profiling"]["begin_on_batch"], self["profiling"].get("end_after_batch", None)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    def profiling_sync_timings(self) -> bool:[0m
[30;1m33 | [0m[35m        return bool(self.get("profiling", {}).get("sync_timings", True))[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def get_records_per_epoch(self) -> Optional[int]:[0m
[30;1m36 | [0m[35m        records_per_epoch = self.get("records_per_epoch")[0m

[31m--[ [0m[34mMatch #[0m[33m1820[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m        if not self.profiling_enabled():[0m
[30;1m28 | [0m[35m            return 0, 0[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        return self["profiling"]["begin_on_batch"], self["profiling"].get("end_after_batch", None)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    def profiling_sync_timings(self) -> bool:[0m
[30;1m33 | [0m[35m        return bool(self.get("profiling", {}).get("sync_timings", True))[0m

[31m--[ [0m[34mMatch #[0m[33m1821[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m        return int(self.get("reproducibility", {}).get("experiment_seed", 0))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def profiling_enabled(self) -> bool:[0m
[30;1m24 | [0m[35m        return bool(self.get("profiling", {}).get("enabled", False))[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def profiling_interval(self) -> Tuple[int, Optional[int]]:[0m
[30;1m27 | [0m[35m        if not self.profiling_enabled():[0m

[31m--[ [0m[34mMatch #[0m[33m1822[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m        return int(self.get("reproducibility", {}).get("experiment_seed", 0))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def profiling_enabled(self) -> bool:[0m
[30;1m24 | [0m[35m        return bool(self.get("profiling", {}).get("enabled", False))[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def profiling_interval(self) -> Tuple[int, Optional[int]]:[0m
[30;1m27 | [0m[35m        if not self.profiling_enabled():[0m

[31m--[ [0m[34mMatch #[0m[33m1823[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        return int(self["resources"]["slots_per_trial"])[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    def experiment_seed(self) -> int:[0m
[30;1m21 | [0m[35m        return int(self.get("reproducibility", {}).get("experiment_seed", 0))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def profiling_enabled(self) -> bool:[0m
[30;1m24 | [0m[35m        return bool(self.get("profiling", {}).get("enabled", False))[0m

[31m--[ [0m[34mMatch #[0m[33m1824[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        return int(self["resources"]["slots_per_trial"])[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    def experiment_seed(self) -> int:[0m
[30;1m21 | [0m[35m        return int(self.get("reproducibility", {}).get("experiment_seed", 0))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def profiling_enabled(self) -> bool:[0m
[30;1m24 | [0m[35m        return bool(self.get("profiling", {}).get("enabled", False))[0m

[31m--[ [0m[34mMatch #[0m[33m1825[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m6 | [0m[35m        return bool(self.get("debug", False))[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m    def scheduling_unit(self) -> int:[0m
[30;1m9 | [0m[35m        return int(self.get("scheduling_unit", 100))[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    def native_parallel_enabled(self) -> bool:[0m
[30;1m12 | [0m[35m        return bool(self["resources"]["native_parallel"])[0m

[31m--[ [0m[34mMatch #[0m[33m1826[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_experiment_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mclass ExperimentConfig(dict):[0m
[30;1m5 | [0m[35m    def debug_enabled(self) -> bool:[0m
[30;1m6 | [0m[35m        return bool(self.get("debug", False))[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m    def scheduling_unit(self) -> int:[0m
[30;1m9 | [0m[35m        return int(self.get("scheduling_unit", 100))[0m

[31m--[ [0m[34mMatch #[0m[33m1827[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/core_v2/_core_v2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m257 | [0m[35m    checkpoint_storage: Optional[Union[str, Dict[str, Any]]] = None,[0m
[30;1m258 | [0m[35m    preempt_mode: core.PreemptMode = core.PreemptMode.WorkersAskChief,[0m
[30;1m259 | [0m[35m    tensorboard_mode: core.TensorboardMode = core.TensorboardMode.AUTO,[0m
[30;1m260 | [0m[35m    # resume: bool = True  # TODO(ilia): optionally control resume behaviour.[0m
[30;1m261 | [0m[35m) -> None:[0m
[30;1m262 | [0m[35m    """[0m
[30;1m263 | [0m[35m    Core V2 initializer in the singleton style.[0m

[31m--[ [0m[34mMatch #[0m[33m1828[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/gcs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    Authentication is currently only supported via the "Application[0m
[30;1m20 | [0m[35m    Default Credentials" method in GCP [1]. Typical configuration:[0m
[30;1m21 | [0m[35m    ensure your VM runs in a service account that has sufficient[0m
[30;1m22 | [0m[35m    permissions to read/write/delete from the GCS bucket where[0m
[30;1m23 | [0m[35m    checkpoints will be stored (this only works when running in GCE).[0m
[30;1m24 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1829[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    def run(self) -> None:[0m
[30;1m171 | [0m[35m        while True:[0m
[30;1m172 | [0m[35m            path_info_list = self._work_queue.get()[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m            # None is the sentinel value[0m
[30;1m175 | [0m[35m            # to signal the thread to exit[0m

[31m--[ [0m[34mMatch #[0m[33m1830[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m        mangler: Callable[[pathlib.Path, int], pathlib.Path] = lambda p, __: p,[0m
[30;1m94 | [0m[35m        rank: int = 0,[0m
[30;1m95 | [0m[35m    ) -> None:[0m
[30;1m96 | [0m[35m        # Only sync a maximum of once per second to play nice with cloud storage request quotas.[0m
[30;1m97 | [0m[35m        if time.time() - self.last_sync < 1:[0m
[30;1m98 | [0m[35m            return[0m
[30;1m99 | [0m[35m        self._sync(selector, mangler, rank)[0m

[31m--[ [0m[34mMatch #[0m[33m1831[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport pathlib[0m
[30;1m5 | [0m[35mimport queue[0m
[30;1m6 | [0m[35mimport threading[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom typing import Any, Callable, List[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom determined import tensorboard[0m
[30;1m11 | [0m[35mfrom determined.common import util[0m

[31m--[ [0m[34mMatch #[0m[33m1832[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m560 | [0m[35m                cli.Arg([0m
[30;1m561 | [0m[35m                    "--max-dynamic-agents",[0m
[30;1m562 | [0m[35m                    type=int,[0m
[30;1m563 | [0m[35m                    help="maximum number of dynamic agent instances at one time",[0m
[30;1m564 | [0m[35m                ),[0m
[30;1m565 | [0m[35m                cli.Arg([0m
[30;1m566 | [0m[35m                    "--spot",[0m

[31m--[ [0m[34mMatch #[0m[33m1833[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m555 | [0m[35m                cli.Arg([0m
[30;1m556 | [0m[35m                    "--min-dynamic-agents",[0m
[30;1m557 | [0m[35m                    type=int,[0m
[30;1m558 | [0m[35m                    help="minimum number of dynamic agent instances at one time",[0m
[30;1m559 | [0m[35m                ),[0m
[30;1m560 | [0m[35m                cli.Arg([0m
[30;1m561 | [0m[35m                    "--max-dynamic-agents",[0m

[31m--[ [0m[34mMatch #[0m[33m1834[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m703 | [0m[35m                cli.Arg([0m
[30;1m704 | [0m[35m                    "--genai-shared-fs-mount-path",[0m
[30;1m705 | [0m[35m                    type=str,[0m
[30;1m706 | [0m[35m                    help="Specifies the path to mount the shared filesystem used for datasets in"[0m
[30;1m707 | [0m[35m                    + " GenAI. Defaults to `/run/determined/workdir/shared_fs`",[0m
[30;1m708 | [0m[35m                ),[0m
[30;1m709 | [0m[35m                cli.Arg([0m

[31m--[ [0m[34mMatch #[0m[33m1835[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m698 | [0m[35m                    "--genai-version",[0m
[30;1m699 | [0m[35m                    type=str,[0m
[30;1m700 | [0m[35m                    help="Specifies the version of GenAI to install. The value must be a valid"[0m
[30;1m701 | [0m[35m                    + " GenAI tag available on Docker Hub.",[0m
[30;1m702 | [0m[35m                ),[0m
[30;1m703 | [0m[35m                cli.Arg([0m
[30;1m704 | [0m[35m                    "--genai-shared-fs-mount-path",[0m

[31m--[ [0m[34mMatch #[0m[33m1836[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m498 | [0m[35m                cli.Arg([0m
[30;1m499 | [0m[35m                    "--inbound-cidr",[0m
[30;1m500 | [0m[35m                    type=str,[0m
[30;1m501 | [0m[35m                    help="inbound IP Range in CIDR format",[0m
[30;1m502 | [0m[35m                ),[0m
[30;1m503 | [0m[35m                cli.Arg([0m
[30;1m504 | [0m[35m                    "--agent-subnet-id",[0m

[31m--[ [0m[34mMatch #[0m[33m1837[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m344 | [0m[35m                )[0m
[30;1m345 | [0m[35m            )[0m
[30;1m346 | [0m[35m            raise cli.CliError([0m
[30;1m347 | [0m[35m                "For details, SSH to master instance and check /var/log/cloud-init-output.log."[0m
[30;1m348 | [0m[35m            )[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m    print("Determined Deployment Successful")[0m

[31m--[ [0m[34mMatch #[0m[33m1838[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m329 | [0m[35m                )[0m
[30;1m330 | [0m[35m            )[0m
[30;1m331 | [0m[35m            raise cli.CliError([0m
[30;1m332 | [0m[35m                "For details, SSH to master instance and check /var/log/cloud-init-output.log."[0m
[30;1m333 | [0m[35m            )[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m    if args.deployment_type == constants.deployment_types.GENAI:[0m

[31m--[ [0m[34mMatch #[0m[33m1839[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/aws/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport getpass[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport pathlib[0m
[30;1m6 | [0m[35mimport re[0m

[31m--[ [0m[34mMatch #[0m[33m1840[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/launch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    assert info.task_type == "TRIAL", f'must be run with task_type="TRIAL", not "{info.task_type}"'[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    # Hack: get the resources id from the environment.[0m
[30;1m72 | [0m[35m    resources_id = os.environ.get("DET_RESOURCES_ID")[0m
[30;1m73 | [0m[35m    assert resources_id is not None, "Unable to run with DET_RESOURCES_ID unset"[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    # Hack: read the full config.  The experiment config is not a stable API![0m

[31m--[ [0m[34mMatch #[0m[33m1841[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/launch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    # Signals we want to forward from wrapper process to the child[0m
[30;1m47 | [0m[35m    sig_names = ["SIGINT", "SIGTERM", "SIGHUP", "SIGUSR1", "SIGUSR2", "SIGWINCH", "SIGBREAK"][0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    if os.environ.get("DET_RESOURCES_TYPE") == prep_container.RESOURCES_TYPE_SLURM_JOB:[0m
[30;1m50 | [0m[35m        # SLURM sends SIGTERM to notify of pending preemption, so we register a custom[0m
[30;1m51 | [0m[35m        # handler to intercept it in the chief rank, and ignore in others.   We invoke[0m
[30;1m52 | [0m[35m        # trigger_preemption to cause a checkpoint and clean exit (given enough time).[0m

[31m--[ [0m[34mMatch #[0m[33m1842[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/launch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        # Notify the master that we need to be preempted[0m
[30;1m24 | [0m[35m        cert = certs.default_load(info.master_url)[0m
[30;1m25 | [0m[35m        sess = authentication.login_from_task(info.master_url, cert=cert)[0m
[30;1m26 | [0m[35m        sess.post(f"/api/v1/allocations/{info.allocation_id}/signals/pending_preemption")[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mdef launch(experiment_config: det.ExperimentConfig) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m1843[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/core_v2/_core_context_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    storage_manager = core._get_storage_manager(checkpoint_storage)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    if checkpoint_storage is None and not unmanaged:[0m
[30;1m76 | [0m[35m        checkpoint_storage = info.trial._config.get("checkpoint_storage")[0m
[30;1m77 | [0m[35m    # TODO(ilia): When checkpoint_storage is not specified, do this instead:[0m
[30;1m78 | [0m[35m    # - if on-cluster: try using cluster storage, then appdirs[0m
[30;1m79 | [0m[35m    # - off-cluster: appdirs.[0m

[31m--[ [0m[34mMatch #[0m[33m1844[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/core_v2/_core_context_v2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m            run_prepare_response.storageId,[0m
[30;1m155 | [0m[35m        )[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # At present, detached mode does not support preemption.[0m
[30;1m158 | [0m[35m        preempt = core.DummyPreemptContext(distributed, preempt_mode)[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m        if unmanaged:[0m

[31m--[ [0m[34mMatch #[0m[33m1845[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/core_v2/_core_context_v2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m60 | [0m[35m    # not anymore.[0m
[30;1m61 | [0m[35m    distributed = distributed or core.DummyDistributedContext()[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    # At present, we only support tensorboards in Trial tasks.[0m
[30;1m64 | [0m[35m    tbd_writer = None[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    metrics = None[0m

[31m--[ [0m[34mMatch #[0m[33m1846[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m            )[0m
[30;1m165 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m166 | [0m[35m    elif not script:[0m
[30;1m167 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m168 | [0m[35m        parser.print_usage()[0m
[30;1m169 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m170 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1847[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m    ][0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    cmd.extend(override_args)[0m
[30;1m39 | [0m[35m    return cmd[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef create_log_redirect_cmd() -> List[str]:[0m
[30;1m43 | [0m[35m    return [[0m

[31m--[ [0m[34mMatch #[0m[33m1848[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m16 | [0m[35mdef create_launch_cmd([0m
[30;1m17 | [0m[35m    num_nodes: int, proc_per_node: int, node_rank: int, master_addr: str, override_args: List[str][0m
[30;1m18 | [0m[35m) -> List[str]:[0m
[30;1m19 | [0m[35m    cmd = [[0m
[30;1m20 | [0m[35m        "python3",[0m
[30;1m21 | [0m[35m        "-m",[0m
[30;1m22 | [0m[35m        "torch.distributed.run",[0m

[31m--[ [0m[34mMatch #[0m[33m1849[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35mif __name__ == "__main__":[0m
[30;1m176 | [0m[35m    override_args, script = parse_args(sys.argv[1:])[0m
[30;1m177 | [0m[35m    sys.exit(main(override_args, script))[0m

[31m--[ [0m[34mMatch #[0m[33m1850[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m170 | [0m[35m        sys.exit(1)[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    return override_args, script[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35mif __name__ == "__main__":[0m
[30;1m176 | [0m[35m    override_args, script = parse_args(sys.argv[1:])[0m

[31m--[ [0m[34mMatch #[0m[33m1851[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m    elif not script:[0m
[30;1m167 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m168 | [0m[35m        parser.print_usage()[0m
[30;1m169 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m170 | [0m[35m        sys.exit(1)[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    return override_args, script[0m

[31m--[ [0m[34mMatch #[0m[33m1852[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m            )[0m
[30;1m165 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m166 | [0m[35m    elif not script:[0m
[30;1m167 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m168 | [0m[35m        parser.print_usage()[0m
[30;1m169 | [0m[35m        print("error: empty script is not allowed", file=sys.stderr)[0m
[30;1m170 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1853[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m                FutureWarning,[0m
[30;1m163 | [0m[35m                stacklevel=2,[0m
[30;1m164 | [0m[35m            )[0m
[30;1m165 | [0m[35m        script = det.util.legacy_trial_entrypoint_to_script(parsed.trial)[0m
[30;1m166 | [0m[35m    elif not script:[0m
[30;1m167 | [0m[35m        # There needs to be at least one script argument.[0m
[30;1m168 | [0m[35m        parser.print_usage()[0m

[31m--[ [0m[34mMatch #[0m[33m1854[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m157 | [0m[35m            warnings.warn([0m
[30;1m158 | [0m[35m                "Support for --trial argument to determined.launch.torch_distributed has been "[0m
[30;1m159 | [0m[35m                "deprecated in Determined 0.38.0 and will be removed in a future version.  You can "[0m
[30;1m160 | [0m[35m                "keep your PyTorchTrial, but please replace your --trial argument with a script "[0m
[30;1m161 | [0m[35m                "that uses the det.pytorch.Trainer() to train your PyTorchTrial.",[0m
[30;1m162 | [0m[35m                FutureWarning,[0m
[30;1m163 | [0m[35m                stacklevel=2,[0m

[31m--[ [0m[34mMatch #[0m[33m1855[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m    )[0m
[30;1m142 | [0m[35m    parsed = parser.parse_args(args)[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    script = parsed.script or [][0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    if parsed.trial is not None:[0m
[30;1m147 | [0m[35m        if script:[0m

[31m--[ [0m[34mMatch #[0m[33m1856[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m        "--trial",[0m
[30;1m130 | [0m[35m        help=([0m
[30;1m131 | [0m[35m            "(deprecated) use a Trial class as the entrypoint to training.  When --trial is used, "[0m
[30;1m132 | [0m[35m            "the SCRIPT positional argument must be omitted."[0m
[30;1m133 | [0m[35m        ),[0m
[30;1m134 | [0m[35m    )[0m
[30;1m135 | [0m[35m    # For training scripts.[0m

[31m--[ [0m[34mMatch #[0m[33m1857[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    parser = argparse.ArgumentParser([0m
[30;1m119 | [0m[35m        usage="%(prog)s [[TORCH_OVERRIDES...] --] (--trial TRIAL)|(SCRIPT...)",[0m
[30;1m120 | [0m[35m        description=("Launch a script under pytorch distributed on a Determined cluster"),[0m
[30;1m121 | [0m[35m        epilog=([0m
[30;1m122 | [0m[35m            "TORCH_OVERRIDES may be a list of arguments to pass directly to "[0m
[30;1m123 | [0m[35m            "torch.distributed.launch to override the values set by Determined automatically.  "[0m

[31m--[ [0m[34mMatch #[0m[33m1858[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/launch/torch_distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m    pid_server_cmd = create_pid_server_cmd(info.allocation_id, len(info.slot_ids))[0m
[30;1m99 | [0m[35m    pid_client_cmd = create_pid_client_cmd(info.allocation_id)[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    launch_cmd = pid_server_cmd + torch_distributed_cmd + pid_client_cmd + log_redirect_cmd + script[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    logger.debug(f"Torch distributed launching with: {launch_cmd}")[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    p = subprocess.Popen(launch_cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1859[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_execution.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m            config, checkpoint_dir, managed_training=managed_training, test_mode=test_mode[0m
[30;1m189 | [0m[35m        )[0m
[30;1m190 | [0m[35m    )[0m
[30;1m191 | [0m[35m    hparams = hparams or _generate_random_hparam_values(config.get("hyperparameters", {}))[0m
[30;1m192 | [0m[35m    use_gpu, container_gpus, slot_ids = _get_gpus(limit_gpus)[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    env = det.EnvContext([0m

[31m--[ [0m[34mMatch #[0m[33m1860[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_execution.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m            "hyperparameters": _generate_random_hparam_values([0m
[30;1m109 | [0m[35m                config_test.get("hyperparameters", {})[0m
[30;1m110 | [0m[35m            ),[0m
[30;1m111 | [0m[35m            "resources": config_test.get("resources", {"slots_per_trial": 1}),[0m
[30;1m112 | [0m[35m            "max_restarts": 0,[0m
[30;1m113 | [0m[35m        }[0m
[30;1m114 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1861[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_execution.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m                "max_length": {"batches": 1},[0m
[30;1m107 | [0m[35m            },[0m
[30;1m108 | [0m[35m            "hyperparameters": _generate_random_hparam_values([0m
[30;1m109 | [0m[35m                config_test.get("hyperparameters", {})[0m
[30;1m110 | [0m[35m            ),[0m
[30;1m111 | [0m[35m            "resources": config_test.get("resources", {"slots_per_trial": 1}),[0m
[30;1m112 | [0m[35m            "max_restarts": 0,[0m

[31m--[ [0m[34mMatch #[0m[33m1862[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_execution.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m            "scheduling_unit": 1,[0m
[30;1m96 | [0m[35m            "min_validation_period": {"batches": 1},[0m
[30;1m97 | [0m[35m            "checkpoint_storage": {[0m
[30;1m98 | [0m[35m                **config_test.get("checkpoint_storage", {}),[0m
[30;1m99 | [0m[35m                "save_experiment_best": 0,[0m
[30;1m100 | [0m[35m                "save_trial_best": 0,[0m
[30;1m101 | [0m[35m                "save_trial_latest": 0,[0m

[31m--[ [0m[34mMatch #[0m[33m1863[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_execution.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m    config_test.update([0m
[30;1m91 | [0m[35m        {[0m
[30;1m92 | [0m[35m            "description": "[test-mode] {}".format([0m
[30;1m93 | [0m[35m                config_test.get("description", str(uuid.uuid4()))[0m
[30;1m94 | [0m[35m            ),[0m
[30;1m95 | [0m[35m            "scheduling_unit": 1,[0m
[30;1m96 | [0m[35m            "min_validation_period": {"batches": 1},[0m

[31m--[ [0m[34mMatch #[0m[33m1864[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m) -> Tuple[Type[det.LegacyTrial], det.TrialContext]:[0m
[30;1m260 | [0m[35m    with _local_execution_manager(context_dir):[0m
[30;1m261 | [0m[35m        trial_class = load.trial_class_from_entrypoint(trial_cls_spec)[0m
[30;1m262 | [0m[35m        core_context, env = _make_local_execution_env([0m
[30;1m263 | [0m[35m            managed_training=managed_training,[0m
[30;1m264 | [0m[35m            test_mode=False,[0m
[30;1m265 | [0m[35m            config=config,[0m

[31m--[ [0m[34mMatch #[0m[33m1865[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    core_context = core._dummy_init(tensorboard_path=tensorboard_path)[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m    return core_context, env[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m@contextlib.contextmanager[0m
[30;1m224 | [0m[35mdef _local_execution_manager(context_dir: pathlib.Path) -> Iterator:[0m

[31m--[ [0m[34mMatch #[0m[33m1866[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m    hparams = hparams or _generate_random_hparam_values(config.get("hyperparameters", {}))[0m
[30;1m192 | [0m[35m    use_gpu, container_gpus, slot_ids = _get_gpus(limit_gpus)[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    env = det.EnvContext([0m
[30;1m195 | [0m[35m        master_url="",[0m
[30;1m196 | [0m[35m        master_cert_file=None,[0m
[30;1m197 | [0m[35m        master_cert_name=None,[0m

[31m--[ [0m[34mMatch #[0m[33m1867[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/fetchers/shared.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m            for file in files:[0m
[30;1m26 | [0m[35m                filepath = posixpath.join(root, file)[0m
[30;1m27 | [0m[35m                mtime = os.path.getmtime(filepath)[0m
[30;1m28 | [0m[35m                prev_mdatetime = self._file_records.get(filepath)[0m
[30;1m29 | [0m[35m                mdatetime = datetime.datetime.fromtimestamp(mtime)[0m
[30;1m30 | [0m[35m                if prev_mdatetime is not None and prev_mdatetime >= mdatetime:[0m
[30;1m31 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m1868[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        return bool(os.environ.get(self.TORCH, None))[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def use_deepspeed(self) -> bool:[0m
[30;1m27 | [0m[35m        return bool(os.environ.get(self.DEEPSPEED, None))[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mclass TrialController(metaclass=abc.ABCMeta):[0m

[31m--[ [0m[34mMatch #[0m[33m1869[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m        return bool(os.environ.get(self.HOROVOD, None))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def use_torch(self) -> bool:[0m
[30;1m24 | [0m[35m        return bool(os.environ.get(self.TORCH, None))[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def use_deepspeed(self) -> bool:[0m
[30;1m27 | [0m[35m        return bool(os.environ.get(self.DEEPSPEED, None))[0m

[31m--[ [0m[34mMatch #[0m[33m1870[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m    TORCH = "USE_TORCH_DISTRIBUTED"[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    def use_horovod(self) -> bool:[0m
[30;1m21 | [0m[35m        return bool(os.environ.get(self.HOROVOD, None))[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def use_torch(self) -> bool:[0m
[30;1m24 | [0m[35m        return bool(os.environ.get(self.TORCH, None))[0m

[31m--[ [0m[34mMatch #[0m[33m1871[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    ) -> None:[0m
[30;1m42 | [0m[35m        self.context = context[0m
[30;1m43 | [0m[35m        self.env = env[0m
[30;1m44 | [0m[35m        # The only time that workloads should be non-None here is unit tests or test mode.[0m
[30;1m45 | [0m[35m        self.workloads = workloads[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        distributed_backend = _DistributedBackend()[0m

[31m--[ [0m[34mMatch #[0m[33m1872[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m        workloads: Optional[workload.Stream] = None,[0m
[30;1m41 | [0m[35m    ) -> None:[0m
[30;1m42 | [0m[35m        self.context = context[0m
[30;1m43 | [0m[35m        self.env = env[0m
[30;1m44 | [0m[35m        # The only time that workloads should be non-None here is unit tests or test mode.[0m
[30;1m45 | [0m[35m        self.workloads = workloads[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        distributed_backend = _DistributedBackend()[0m

[31m--[ [0m[34mMatch #[0m[33m1873[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/_trial_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m87 | [0m[35m    @abc.abstractmethod[0m
[30;1m88 | [0m[35m    def run(self) -> None:[0m
[30;1m89 | [0m[35m        """[0m
[30;1m90 | [0m[35m        The main control loop for executing user code.[0m
[30;1m91 | [0m[35m        """[0m
[30;1m92 | [0m[35m        pass[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1874[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m402 | [0m[35m    for blob in blobs:[0m
[30;1m403 | [0m[35m        json_data_string = blob.download_as_string()[0m
[30;1m404 | [0m[35m        json_data = json.loads(json_data_string)[0m
[30;1m405 | [0m[35m        if json_data.get("resources"):[0m
[30;1m406 | [0m[35m            cluster_list.append([blob.name[:-16]])[0m
[30;1m407 | [0m[35m    cluster_json = {"Clusters": [dict(zip(cluster_list[0], row)) for row in cluster_list[1:]]}[0m
[30;1m408 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1875[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m389 | [0m[35m        name = blob.name[:-16][0m
[30;1m390 | [0m[35m        json_data_string = blob.download_as_string()[0m
[30;1m391 | [0m[35m        json_data = json.loads(json_data_string)[0m
[30;1m392 | [0m[35m        if json_data.get("resources") and name == cluster_id:[0m
[30;1m393 | [0m[35m            return True[0m
[30;1m394 | [0m[35m    return False[0m
[30;1m395 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1876[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m370 | [0m[35m    bucket_name = project_id + "-determined-deploy"[0m
[30;1m371 | [0m[35m    storage_service = discovery.build("storage", "v1")[0m
[30;1m372 | [0m[35m    try:[0m
[30;1m373 | [0m[35m        storage_service.buckets().get(bucket=bucket_name).execute()[0m
[30;1m374 | [0m[35m    except google_errors.HttpError as err:[0m
[30;1m375 | [0m[35m        if err.resp.status == 404:[0m
[30;1m376 | [0m[35m            request_body = {[0m

[31m--[ [0m[34mMatch #[0m[33m1877[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m[0m
[30;1m357 | [0m[35mdef set_gcp_credentials_env(tf_vars: Dict) -> None:[0m
[30;1m358 | [0m[35m    keypath = tf_vars.get("keypath")[0m
[30;1m359 | [0m[35m    if keypath:[0m
[30;1m360 | [0m[35m        os.environ["GOOGLE_APPLICATION_CREDENTIALS"] = keypath[0m
[30;1m361 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1878[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35mdef master_name(tf_vars: Dict) -> str:[0m
[30;1m257 | [0m[35m    """Construct master name for provided Terraform deployment."""[0m
[30;1m258 | [0m[35m    return f"det-master-{tf_vars.get('cluster_id')}-{tf_vars.get('det_version_key')}"[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35mdef stop_master(compute: Any, tf_vars: Dict) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1879[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35mdef master_name(tf_vars: Dict) -> str:[0m
[30;1m257 | [0m[35m    """Construct master name for provided Terraform deployment."""[0m
[30;1m258 | [0m[35m    return f"det-master-{tf_vars.get('cluster_id')}-{tf_vars.get('det_version_key')}"[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35mdef stop_master(compute: Any, tf_vars: Dict) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1880[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m    """Stop instance with given name (resource ID)."""[0m
[30;1m249 | [0m[35m    return ([0m
[30;1m250 | [0m[35m        compute.instances()[0m
[30;1m251 | [0m[35m        .stop(project=tf_vars.get("project_id"), zone=tf_vars.get("zone"), instance=instance_name)[0m
[30;1m252 | [0m[35m        .execute()[0m
[30;1m253 | [0m[35m    )[0m
[30;1m254 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1881[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m    """Stop instance with given name (resource ID)."""[0m
[30;1m249 | [0m[35m    return ([0m
[30;1m250 | [0m[35m        compute.instances()[0m
[30;1m251 | [0m[35m        .stop(project=tf_vars.get("project_id"), zone=tf_vars.get("zone"), instance=instance_name)[0m
[30;1m252 | [0m[35m        .execute()[0m
[30;1m253 | [0m[35m    )[0m
[30;1m254 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1882[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m    """Terminate instance with given name (resource ID)."""[0m
[30;1m240 | [0m[35m    return ([0m
[30;1m241 | [0m[35m        compute.instances()[0m
[30;1m242 | [0m[35m        .delete(project=tf_vars.get("project_id"), zone=tf_vars.get("zone"), instance=instance_name)[0m
[30;1m243 | [0m[35m        .execute()[0m
[30;1m244 | [0m[35m    )[0m
[30;1m245 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1883[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m    """Terminate instance with given name (resource ID)."""[0m
[30;1m240 | [0m[35m    return ([0m
[30;1m241 | [0m[35m        compute.instances()[0m
[30;1m242 | [0m[35m        .delete(project=tf_vars.get("project_id"), zone=tf_vars.get("zone"), instance=instance_name)[0m
[30;1m243 | [0m[35m        .execute()[0m
[30;1m244 | [0m[35m    )[0m
[30;1m245 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1884[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m    """Get list of instances for this deployment matching the given filter."""[0m
[30;1m210 | [0m[35m    result = ([0m
[30;1m211 | [0m[35m        compute.instances()[0m
[30;1m212 | [0m[35m        .list(project=tf_vars.get("project_id"), zone=tf_vars.get("zone"), filter=filter_expr)[0m
[30;1m213 | [0m[35m        .execute()[0m
[30;1m214 | [0m[35m    )[0m
[30;1m215 | [0m[35m    return result["items"] if "items" in result else [][0m

[31m--[ [0m[34mMatch #[0m[33m1885[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m    """Get list of instances for this deployment matching the given filter."""[0m
[30;1m210 | [0m[35m    result = ([0m
[30;1m211 | [0m[35m        compute.instances()[0m
[30;1m212 | [0m[35m        .list(project=tf_vars.get("project_id"), zone=tf_vars.get("zone"), filter=filter_expr)[0m
[30;1m213 | [0m[35m        .execute()[0m
[30;1m214 | [0m[35m    )[0m
[30;1m215 | [0m[35m    return result["items"] if "items" in result else [][0m

[31m--[ [0m[34mMatch #[0m[33m1886[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m                    compute.zoneOperations()[0m
[30;1m188 | [0m[35m                    .get([0m
[30;1m189 | [0m[35m                        project=tf_vars.get("project_id"),[0m
[30;1m190 | [0m[35m                        zone=tf_vars.get("zone"),[0m
[30;1m191 | [0m[35m                        operation=operation,[0m
[30;1m192 | [0m[35m                    )[0m
[30;1m193 | [0m[35m                    .execute()[0m

[31m--[ [0m[34mMatch #[0m[33m1887[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m                result = ([0m
[30;1m187 | [0m[35m                    compute.zoneOperations()[0m
[30;1m188 | [0m[35m                    .get([0m
[30;1m189 | [0m[35m                        project=tf_vars.get("project_id"),[0m
[30;1m190 | [0m[35m                        zone=tf_vars.get("zone"),[0m
[30;1m191 | [0m[35m                        operation=operation,[0m
[30;1m192 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m1888[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m            if statuses[i] is None:[0m
[30;1m186 | [0m[35m                result = ([0m
[30;1m187 | [0m[35m                    compute.zoneOperations()[0m
[30;1m188 | [0m[35m                    .get([0m
[30;1m189 | [0m[35m                        project=tf_vars.get("project_id"),[0m
[30;1m190 | [0m[35m                        zone=tf_vars.get("zone"),[0m
[30;1m191 | [0m[35m                        operation=operation,[0m

[31m--[ [0m[34mMatch #[0m[33m1889[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        ][0m
[30;1m157 | [0m[35m        state_data_json = subprocess.check_output(command, env=env, cwd=terraform_dir(configs))[0m
[30;1m158 | [0m[35m        state_data = json.loads(state_data_json)[0m
[30;1m159 | [0m[35m        return state_data.get("outputs", {}).get(variable_name, {}).get("value")[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    state_file_path = os.path.join(configs["local_state_path"], TF_STATE_FILE)[0m
[30;1m162 | [0m[35m    command = [[0m

[31m--[ [0m[34mMatch #[0m[33m1890[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        ][0m
[30;1m157 | [0m[35m        state_data_json = subprocess.check_output(command, env=env, cwd=terraform_dir(configs))[0m
[30;1m158 | [0m[35m        state_data = json.loads(state_data_json)[0m
[30;1m159 | [0m[35m        return state_data.get("outputs", {}).get(variable_name, {}).get("value")[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    state_file_path = os.path.join(configs["local_state_path"], TF_STATE_FILE)[0m
[30;1m162 | [0m[35m    command = [[0m

[31m--[ [0m[34mMatch #[0m[33m1891[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        ][0m
[30;1m157 | [0m[35m        state_data_json = subprocess.check_output(command, env=env, cwd=terraform_dir(configs))[0m
[30;1m158 | [0m[35m        state_data = json.loads(state_data_json)[0m
[30;1m159 | [0m[35m        return state_data.get("outputs", {}).get(variable_name, {}).get("value")[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    state_file_path = os.path.join(configs["local_state_path"], TF_STATE_FILE)[0m
[30;1m162 | [0m[35m    command = [[0m

[31m--[ [0m[34mMatch #[0m[33m1892[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35mdef terraform_output(configs: Dict, env: Dict, variable_name: str) -> Any:[0m
[30;1m151 | [0m[35m    if configs.get("tf_state_gcs_bucket_name"):[0m
[30;1m152 | [0m[35m        command = [[0m
[30;1m153 | [0m[35m            "terraform",[0m
[30;1m154 | [0m[35m            "state",[0m

[31m--[ [0m[34mMatch #[0m[33m1893[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m        terraform_dir(configs),[0m
[30;1m111 | [0m[35m    )[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    state_bucket = configs.get("tf_state_gcs_bucket_name")[0m
[30;1m114 | [0m[35m    if state_bucket:[0m
[30;1m115 | [0m[35m        with (pathlib.Path(terraform_dir(configs)) / "override.tf").open("w") as fout:[0m
[30;1m116 | [0m[35m            fout.write(TF_GCS_CONFIG % (state_bucket, configs["cluster_id"]))[0m

[31m--[ [0m[34mMatch #[0m[33m1894[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    Persist variables to Terraform state directory.  These variables are used[0m
[30;1m74 | [0m[35m    on apply / plan, and are required for deprovisioning.[0m
[30;1m75 | [0m[35m    """[0m
[30;1m76 | [0m[35m    det_version = configs.get("det_version")[0m
[30;1m77 | [0m[35m    if not det_version or not isinstance(det_version, str):[0m
[30;1m78 | [0m[35m        print("ERROR: Determined version missing or invalid")[0m
[30;1m79 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m1895[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef deploy(configs: Dict, env: Dict, variables_to_exclude: List, dry_run: bool = False) -> None:[0m
[30;1m36 | [0m[35m    set_validate_gcp_credentials(configs)[0m
[30;1m37 | [0m[35m    if not configs.get("no_preflight_checks"):[0m
[30;1m38 | [0m[35m        preflight.check_quota(configs)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    terraform_init(configs, env)[0m

[31m--[ [0m[34mMatch #[0m[33m1896[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m        time.sleep(5)[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    # We don't have success for all operations and have run out of time[0m
[30;1m205 | [0m[35m    return False[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35mdef list_instances(compute: Any, tf_vars: Dict, filter_expr: str) -> Any:[0m

[31m--[ [0m[34mMatch #[0m[33m1897[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m    ][0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    # `terraform output` can take state file path, but it doesn't like[0m
[30;1m171 | [0m[35m    # TF_DATA_DIR env variable.[0m
[30;1m172 | [0m[35m    env_sanitized = {k: v for (k, v) in env.items() if k != "TF_DATA_DIR"}[0m
[30;1m173 | [0m[35m    json_value = subprocess.check_output(command, env=env_sanitized)[0m
[30;1m174 | [0m[35m    return json.loads(json_value)[0m

[31m--[ [0m[34mMatch #[0m[33m1898[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/gcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport shutil[0m
[30;1m5 | [0m[35mimport subprocess[0m
[30;1m6 | [0m[35mimport sys[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom typing import Any, Dict, List, Optional[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport tabulate[0m
[30;1m11 | [0m[35mimport termcolor[0m

[31m--[ [0m[34mMatch #[0m[33m1899[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/shared.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22 | [0m[35m        self.shared_fs_base = self.storage_path.joinpath(self.sync_path)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        # Set umask to 0 in order that the storage dir allows future containers of any owner to[0m
[30;1m25 | [0m[35m        # create new checkpoints. Administrators wishing to control the permissions more[0m
[30;1m26 | [0m[35m        # specifically should just create the storage path themselves; this will not interfere.[0m
[30;1m27 | [0m[35m        old_umask = os.umask(0)[0m
[30;1m28 | [0m[35m        self.shared_fs_base.mkdir(parents=True, exist_ok=True, mode=0o777)[0m

[31m--[ [0m[34mMatch #[0m[33m1900[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/preflight.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m            compute = discovery.build("compute", "v1")[0m
[30;1m28 | [0m[35m            r = ([0m
[30;1m29 | [0m[35m                compute.regions()[0m
[30;1m30 | [0m[35m                .get(project=configs["project_id"], region=configs["region"])[0m
[30;1m31 | [0m[35m                .execute()[0m
[30;1m32 | [0m[35m            )[0m
[30;1m33 | [0m[35m        except google_errors.Error as ex:[0m

[31m--[ [0m[34mMatch #[0m[33m1901[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/gcp/preflight.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m        quota_code = mapping[configs["gpu_type"]][0m
[30;1m41 | [0m[35m        quota = next((q for q in r["quotas"] if q["metric"] == quota_code), None)[0m
[30;1m42 | [0m[35m        if quota is None:[0m
[30;1m43 | [0m[35m            raise errors.PreflightFailure("can't find quota metric %s" % quota_code)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        gpu_quota = quota["limit"] - quota["usage"][0m
[30;1m46 | [0m[35m        gpu_required = configs["gpu_num"] * configs["max_dynamic_agents"][0m

[31m--[ [0m[34mMatch #[0m[33m1902[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m            checkpoint_config["container"],[0m
[30;1m128 | [0m[35m            checkpoint_config.get("connection_string", None),[0m
[30;1m129 | [0m[35m            checkpoint_config.get("access_url", None),[0m
[30;1m130 | [0m[35m            checkpoint_config.get("credential", None),[0m
[30;1m131 | [0m[35m            base_path,[0m
[30;1m132 | [0m[35m            sync_path,[0m
[30;1m133 | [0m[35m            async_upload=async_upload,[0m

[31m--[ [0m[34mMatch #[0m[33m1903[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m        return azure.AzureTensorboardManager([0m
[30;1m127 | [0m[35m            checkpoint_config["container"],[0m
[30;1m128 | [0m[35m            checkpoint_config.get("connection_string", None),[0m
[30;1m129 | [0m[35m            checkpoint_config.get("access_url", None),[0m
[30;1m130 | [0m[35m            checkpoint_config.get("credential", None),[0m
[30;1m131 | [0m[35m            base_path,[0m
[30;1m132 | [0m[35m            sync_path,[0m

[31m--[ [0m[34mMatch #[0m[33m1904[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m            )[0m
[30;1m126 | [0m[35m        return azure.AzureTensorboardManager([0m
[30;1m127 | [0m[35m            checkpoint_config["container"],[0m
[30;1m128 | [0m[35m            checkpoint_config.get("connection_string", None),[0m
[30;1m129 | [0m[35m            checkpoint_config.get("access_url", None),[0m
[30;1m130 | [0m[35m            checkpoint_config.get("credential", None),[0m
[30;1m131 | [0m[35m            base_path,[0m

[31m--[ [0m[34mMatch #[0m[33m1905[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        )[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    elif type_name == "azure":[0m
[30;1m121 | [0m[35m        if not checkpoint_config.get("connection_string") and checkpoint_config.get("access_url"):[0m
[30;1m122 | [0m[35m            raise ValueError([0m
[30;1m123 | [0m[35m                """At least one of [connection_string, account_url] must be specified for Azure[0m
[30;1m124 | [0m[35m                 Tensorboard Manager, but none were."""[0m

[31m--[ [0m[34mMatch #[0m[33m1906[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        )[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    elif type_name == "azure":[0m
[30;1m121 | [0m[35m        if not checkpoint_config.get("connection_string") and checkpoint_config.get("access_url"):[0m
[30;1m122 | [0m[35m            raise ValueError([0m
[30;1m123 | [0m[35m                """At least one of [connection_string, account_url] must be specified for Azure[0m
[30;1m124 | [0m[35m                 Tensorboard Manager, but none were."""[0m

[31m--[ [0m[34mMatch #[0m[33m1907[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            checkpoint_config.get("access_key", None),[0m
[30;1m111 | [0m[35m            checkpoint_config.get("secret_key", None),[0m
[30;1m112 | [0m[35m            checkpoint_config.get("endpoint_url", None),[0m
[30;1m113 | [0m[35m            checkpoint_config.get("prefix", None),[0m
[30;1m114 | [0m[35m            base_path,[0m
[30;1m115 | [0m[35m            sync_path,[0m
[30;1m116 | [0m[35m            async_upload=async_upload,[0m

[31m--[ [0m[34mMatch #[0m[33m1908[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m            checkpoint_config["bucket"],[0m
[30;1m110 | [0m[35m            checkpoint_config.get("access_key", None),[0m
[30;1m111 | [0m[35m            checkpoint_config.get("secret_key", None),[0m
[30;1m112 | [0m[35m            checkpoint_config.get("endpoint_url", None),[0m
[30;1m113 | [0m[35m            checkpoint_config.get("prefix", None),[0m
[30;1m114 | [0m[35m            base_path,[0m
[30;1m115 | [0m[35m            sync_path,[0m

[31m--[ [0m[34mMatch #[0m[33m1909[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m        return s3.S3TensorboardManager([0m
[30;1m109 | [0m[35m            checkpoint_config["bucket"],[0m
[30;1m110 | [0m[35m            checkpoint_config.get("access_key", None),[0m
[30;1m111 | [0m[35m            checkpoint_config.get("secret_key", None),[0m
[30;1m112 | [0m[35m            checkpoint_config.get("endpoint_url", None),[0m
[30;1m113 | [0m[35m            checkpoint_config.get("prefix", None),[0m
[30;1m114 | [0m[35m            base_path,[0m

[31m--[ [0m[34mMatch #[0m[33m1910[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    elif type_name == "s3":[0m
[30;1m108 | [0m[35m        return s3.S3TensorboardManager([0m
[30;1m109 | [0m[35m            checkpoint_config["bucket"],[0m
[30;1m110 | [0m[35m            checkpoint_config.get("access_key", None),[0m
[30;1m111 | [0m[35m            checkpoint_config.get("secret_key", None),[0m
[30;1m112 | [0m[35m            checkpoint_config.get("endpoint_url", None),[0m
[30;1m113 | [0m[35m            checkpoint_config.get("prefix", None),[0m

[31m--[ [0m[34mMatch #[0m[33m1911[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m    elif type_name == "gcs":[0m
[30;1m98 | [0m[35m        return gcs.GCSTensorboardManager([0m
[30;1m99 | [0m[35m            checkpoint_config["bucket"],[0m
[30;1m100 | [0m[35m            checkpoint_config.get("prefix", None),[0m
[30;1m101 | [0m[35m            base_path,[0m
[30;1m102 | [0m[35m            sync_path,[0m
[30;1m103 | [0m[35m            async_upload=async_upload,[0m

[31m--[ [0m[34mMatch #[0m[33m1912[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    if type_name == "shared_fs":[0m
[30;1m78 | [0m[35m        host_path = checkpoint_config["host_path"][0m
[30;1m79 | [0m[35m        storage_path = checkpoint_config.get("storage_path")[0m
[30;1m80 | [0m[35m        return shared.SharedFSTensorboardManager([0m
[30;1m81 | [0m[35m            shared_storage._full_storage_path(host_path, storage_path, container_path),[0m
[30;1m82 | [0m[35m            base_path,[0m

[31m--[ [0m[34mMatch #[0m[33m1913[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    if isinstance(checkpoint_config, str):[0m
[30;1m60 | [0m[35m        checkpoint_config = shared_storage._shortcut_to_config(checkpoint_config)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    type_name = checkpoint_config.get("type")[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    if not type_name:[0m
[30;1m65 | [0m[35m        raise TypeError("Missing 'type' parameter of storage configuration")[0m

[31m--[ [0m[34mMatch #[0m[33m1914[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    allocation_id = os.environ.get("DET_ALLOCATION_ID", "")[0m
[30;1m32 | [0m[35m    rank = get_rank_if_horovod_process_else_return_zero()[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    if checkpoint_config.get("base_path"):[0m
[30;1m35 | [0m[35m        base_path = pathlib.Path(checkpoint_config["base_path"])[0m
[30;1m36 | [0m[35m    else:[0m
[30;1m37 | [0m[35m        base_path = pathlib.Path("/", "tmp")[0m

[31m--[ [0m[34mMatch #[0m[33m1915[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/build.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef get_base_path(checkpoint_config: Dict[str, Any]) -> pathlib.Path:[0m
[30;1m31 | [0m[35m    allocation_id = os.environ.get("DET_ALLOCATION_ID", "")[0m
[30;1m32 | [0m[35m    rank = get_rank_if_horovod_process_else_return_zero()[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    if checkpoint_config.get("base_path"):[0m

[31m--[ [0m[34mMatch #[0m[33m1916[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/_native.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    if pytorch and issubclass(trial_class, pytorch.PyTorchTrial):[0m
[30;1m48 | [0m[35m        with pytorch.init([0m
[30;1m49 | [0m[35m            hparams=config.get("hyperparameters", {}), enable_tensorboard_logging=False[0m
[30;1m50 | [0m[35m        ) as pytorch_trial_context:[0m
[30;1m51 | [0m[35m            pytorch_trial_context._exp_conf = config[0m
[30;1m52 | [0m[35m            pytorch_trial_inst = trial_class(pytorch_trial_context)[0m

[31m--[ [0m[34mMatch #[0m[33m1917[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/experimental/_native.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        return[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    with tempfile.TemporaryDirectory() as checkpoint_dir:[0m
[30;1m65 | [0m[35m        core_context, env = det._make_local_execution_env([0m
[30;1m66 | [0m[35m            managed_training=True,[0m
[30;1m67 | [0m[35m            test_mode=True,[0m
[30;1m68 | [0m[35m            config=config,[0m

[31m--[ [0m[34mMatch #[0m[33m1918[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m541 | [0m[35m    # Fallback on agent config for options not specified as flags.[0m
[30;1m542 | [0m[35m    environment = {}[0m
[30;1m543 | [0m[35m    if agent_name == AGENT_NAME_DEFAULT:[0m
[30;1m544 | [0m[35m        agent_name = agent_conf.get("agent_id", agent_name)[0m
[30;1m545 | [0m[35m    else:[0m
[30;1m546 | [0m[35m        environment["DET_AGENT_ID"] = agent_name[0m
[30;1m547 | [0m[35m    environment["DET_MASTER_PORT"] = str(master_port)[0m

[31m--[ [0m[34mMatch #[0m[33m1919[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m497 | [0m[35m    def docker_logs(container_name: str) -> None:[0m
[30;1m498 | [0m[35m        client = docker_client()[0m
[30;1m499 | [0m[35m        try:[0m
[30;1m500 | [0m[35m            container = client.containers.get(container_name)[0m
[30;1m501 | [0m[35m        except docker.errors.NotFound:[0m
[30;1m502 | [0m[35m            return[0m
[30;1m503 | [0m[35m        log_stream = container.logs(stream=follow)[0m

[31m--[ [0m[34mMatch #[0m[33m1920[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m    _kill_containers([db_name])[0m
[30;1m421 | [0m[35m    if delete_volume:[0m
[30;1m422 | [0m[35m        try:[0m
[30;1m423 | [0m[35m            volume = client.volumes.get(volume_name)[0m
[30;1m424 | [0m[35m            print(f"Removing db volume {volume_name}")[0m
[30;1m425 | [0m[35m            volume.remove()[0m
[30;1m426 | [0m[35m        except docker.errors.NotFound:[0m

[31m--[ [0m[34mMatch #[0m[33m1921[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m                sess = authentication.login([0m
[30;1m319 | [0m[35m                    f"http://localhost:{port}", "admin", generated_user_password[0m
[30;1m320 | [0m[35m                ).with_retry(util.get_max_retries_config())[0m
[30;1m321 | [0m[35m                sess.get("/api/v1/me")[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m                # No exception was raised, so this generated password is the way to log in.[0m
[30;1m324 | [0m[35m                print([0m

[31m--[ [0m[34mMatch #[0m[33m1922[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m    storage_info = master_conf.get("checkpoint_storage", {})[0m
[30;1m212 | [0m[35m    final_storage_host_path = storage_info.get("host_path")[0m
[30;1m213 | [0m[35m    container_storage_path = ([0m
[30;1m214 | [0m[35m        storage_info.get("container_path") or constants.SHARED_FS_CONTAINER_PATH[0m
[30;1m215 | [0m[35m    )[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m    if final_storage_host_path is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1923[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # Ensure checkpoint storage directory exists.[0m
[30;1m211 | [0m[35m    storage_info = master_conf.get("checkpoint_storage", {})[0m
[30;1m212 | [0m[35m    final_storage_host_path = storage_info.get("host_path")[0m
[30;1m213 | [0m[35m    container_storage_path = ([0m
[30;1m214 | [0m[35m        storage_info.get("container_path") or constants.SHARED_FS_CONTAINER_PATH[0m
[30;1m215 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1924[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        make_temp_conf = True[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # Ensure checkpoint storage directory exists.[0m
[30;1m211 | [0m[35m    storage_info = master_conf.get("checkpoint_storage", {})[0m
[30;1m212 | [0m[35m    final_storage_host_path = storage_info.get("host_path")[0m
[30;1m213 | [0m[35m    container_storage_path = ([0m
[30;1m214 | [0m[35m        storage_info.get("container_path") or constants.SHARED_FS_CONTAINER_PATH[0m

[31m--[ [0m[34mMatch #[0m[33m1925[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    try:[0m
[30;1m186 | [0m[35m        authentication.check_password_complexity([0m
[30;1m187 | [0m[35m            master_conf["security"].get("initial_user_password")[0m
[30;1m188 | [0m[35m        )[0m
[30;1m189 | [0m[35m    except ValueError:[0m
[30;1m190 | [0m[35m        random_password_characters = string.ascii_uppercase + string.ascii_lowercase + string.digits[0m

[31m--[ [0m[34mMatch #[0m[33m1926[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m        master_conf = MASTER_CONF_DEFAULT[0m
[30;1m176 | [0m[35m        make_temp_conf = True[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    if master_conf.get("security") is None:[0m
[30;1m179 | [0m[35m        master_conf["security"] = {}[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    if initial_user_password is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1927[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m    """[0m
[30;1m136 | [0m[35m    print(f"Waiting for {container_name}...")[0m
[30;1m137 | [0m[35m    client = docker_client()[0m
[30;1m138 | [0m[35m    container = client.containers.get(container_name)[0m
[30;1m139 | [0m[35m    start_time = time.time()[0m
[30;1m140 | [0m[35m    while time.time() - start_time < timeout:[0m
[30;1m141 | [0m[35m        inspect = client.api.inspect_container(container.name)[0m

[31m--[ [0m[34mMatch #[0m[33m1928[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m397 | [0m[35m            "interval": 1000000,[0m
[30;1m398 | [0m[35m        },[0m
[30;1m399 | [0m[35m        network=network_name,[0m
[30;1m400 | [0m[35m        hostname="determined-db",[0m
[30;1m401 | [0m[35m    )[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1929[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m308 | [0m[35m            device_requests=None,[0m
[30;1m309 | [0m[35m            ports={"8080": f"{port}"},[0m
[30;1m310 | [0m[35m            network=NETWORK_NAME,[0m
[30;1m311 | [0m[35m            hostname="determined-master",[0m
[30;1m312 | [0m[35m        )[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m        _wait_for_master(f"http://localhost:{port}", cluster_name)[0m

[31m--[ [0m[34mMatch #[0m[33m1930[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m596 | [0m[35m    client = docker_client()[0m
[30;1m597 | [0m[35m    containers = client.containers.list(all=True, filters=filters)[0m
[30;1m598 | [0m[35m    for container in containers:[0m
[30;1m599 | [0m[35m        # Docker will match container names containing the string instead of strictly matching.[0m
[30;1m600 | [0m[35m        if names and container.name not in names:[0m
[30;1m601 | [0m[35m            continue[0m
[30;1m602 | [0m[35m        print(f"Stopping {container.name}")[0m

[31m--[ [0m[34mMatch #[0m[33m1931[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35mdef db_up(name: str, password: str, network_name: str, cluster_name: str, volume_name: str) -> None:[0m
[30;1m381 | [0m[35m    print(f"Creating {name}...")[0m
[30;1m382 | [0m[35m    env = {"PGUSER": "postgres", "POSTGRES_DB": "determined", "POSTGRES_PASSWORD": password}[0m
[30;1m383 | [0m[35m    client = docker_client()[0m
[30;1m384 | [0m[35m    client.containers.run([0m
[30;1m385 | [0m[35m        image="postgres:10.14",[0m

[31m--[ [0m[34mMatch #[0m[33m1932[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m333 | [0m[35m                    # getpass raises this warning instead of an exception if it can't find the[0m
[30;1m334 | [0m[35m                    # terminal, which almost always means we're not going to be able to receive[0m
[30;1m335 | [0m[35m                    # a password interactively and securely, so should abort quickly rather[0m
[30;1m336 | [0m[35m                    # than time out.[0m
[30;1m337 | [0m[35m                    with warnings.catch_warnings():[0m
[30;1m338 | [0m[35m                        warnings.filterwarnings(action="error", category=getpass.GetPassWarning)[0m
[30;1m339 | [0m[35m                        prompt = ([0m

[31m--[ [0m[34mMatch #[0m[33m1933[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m330 | [0m[35m                try:[0m
[30;1m331 | [0m[35m                    if not sys.stdin.isatty() or sys.stdin.closed:[0m
[30;1m332 | [0m[35m                        raise EOFError[0m
[30;1m333 | [0m[35m                    # getpass raises this warning instead of an exception if it can't find the[0m
[30;1m334 | [0m[35m                    # terminal, which almost always means we're not going to be able to receive[0m
[30;1m335 | [0m[35m                    # a password interactively and securely, so should abort quickly rather[0m
[30;1m336 | [0m[35m                    # than time out.[0m

[31m--[ [0m[34mMatch #[0m[33m1934[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m236 | [0m[35m    # This is always true by now, but mypy needs help.[0m
[30;1m237 | [0m[35m    assert master_config_path is not None[0m
[30;1m238 | [0m[35m    restart_policy = "unless-stopped" if autorestart else "no"[0m
[30;1m239 | [0m[35m    env = {[0m
[30;1m240 | [0m[35m        "DET_MASTER_HTTP_PORT": str(port),[0m
[30;1m241 | [0m[35m        "DET_DB_PASSWORD": db_password,[0m
[30;1m242 | [0m[35m        "DET_LOG_INFO": "info",[0m

[31m--[ [0m[34mMatch #[0m[33m1935[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mdef _wait_for_container(container_name: str, timeout: int = 100) -> None:[0m
[30;1m132 | [0m[35m    """[0m
[30;1m133 | [0m[35m    Waits for a Docker container's healthcheck (specified when the container is run) to reach a[0m
[30;1m134 | [0m[35m    "healthy" status.[0m
[30;1m135 | [0m[35m    """[0m
[30;1m136 | [0m[35m    print(f"Waiting for {container_name}...")[0m

[31m--[ [0m[34mMatch #[0m[33m1936[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        return "host.docker.internal"[0m
[30;1m105 | [0m[35m    else:[0m
[30;1m106 | [0m[35m        # On non-macOS, host.docker.internal does not exist. Instead, grab the source IP[0m
[30;1m107 | [0m[35m        # address we would use if we had to talk to the internet. The sed command[0m
[30;1m108 | [0m[35m        # searches the first line of its input for "src" and prints the first field[0m
[30;1m109 | [0m[35m        # after that.[0m
[30;1m110 | [0m[35m        proxy_addr_args = ["ip", "route", "get", "8.8.8.8"][0m

[31m--[ [0m[34mMatch #[0m[33m1937[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m        # address of this VM.[0m
[30;1m104 | [0m[35m        return "host.docker.internal"[0m
[30;1m105 | [0m[35m    else:[0m
[30;1m106 | [0m[35m        # On non-macOS, host.docker.internal does not exist. Instead, grab the source IP[0m
[30;1m107 | [0m[35m        # address we would use if we had to talk to the internet. The sed command[0m
[30;1m108 | [0m[35m        # searches the first line of its input for "src" and prints the first field[0m
[30;1m109 | [0m[35m        # after that.[0m
[30;1m110 | [0m[35m        proxy_addr_args = ["ip", "route", "get", "8.8.8.8"][0m

[31m--[ [0m[34mMatch #[0m[33m1938[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m    # docker host. As a work-around, force agents to report their IP address as the[0m
[30;1m100 | [0m[35m    # IP address of the host machine.[0m
[30;1m101 | [0m[35m    if "darwin" in sys.platform:[0m
[30;1m102 | [0m[35m        # On macOS, docker runs in a VM and host.docker.internal points to the IP[0m
[30;1m103 | [0m[35m        # address of this VM.[0m
[30;1m104 | [0m[35m        return "host.docker.internal"[0m
[30;1m105 | [0m[35m    else:[0m
[30;1m106 | [0m[35m        # On non-macOS, host.docker.internal does not exist. Instead, grab the source IP[0m

[31m--[ [0m[34mMatch #[0m[33m1939[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m    # docker host. As a work-around, force agents to report their IP address as the[0m
[30;1m100 | [0m[35m    # IP address of the host machine.[0m
[30;1m101 | [0m[35m    if "darwin" in sys.platform:[0m
[30;1m102 | [0m[35m        # On macOS, docker runs in a VM and host.docker.internal points to the IP[0m
[30;1m103 | [0m[35m        # address of this VM.[0m
[30;1m104 | [0m[35m        return "host.docker.internal"[0m
[30;1m105 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m1940[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m    # docker containers. This breaks down when running in a docker compose[0m
[30;1m98 | [0m[35m    # environment, because the address of the agent is not the address of the[0m
[30;1m99 | [0m[35m    # docker host. As a work-around, force agents to report their IP address as the[0m
[30;1m100 | [0m[35m    # IP address of the host machine.[0m
[30;1m101 | [0m[35m    if "darwin" in sys.platform:[0m
[30;1m102 | [0m[35m        # On macOS, docker runs in a VM and host.docker.internal points to the IP[0m
[30;1m103 | [0m[35m        # address of this VM.[0m

[31m--[ [0m[34mMatch #[0m[33m1941[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m    # ports, and it uses the IP address of the agent as a way to address spawned[0m
[30;1m97 | [0m[35m    # docker containers. This breaks down when running in a docker compose[0m
[30;1m98 | [0m[35m    # environment, because the address of the agent is not the address of the[0m
[30;1m99 | [0m[35m    # docker host. As a work-around, force agents to report their IP address as the[0m
[30;1m100 | [0m[35m    # IP address of the host machine.[0m
[30;1m101 | [0m[35m    if "darwin" in sys.platform:[0m
[30;1m102 | [0m[35m        # On macOS, docker runs in a VM and host.docker.internal points to the IP[0m

[31m--[ [0m[34mMatch #[0m[33m1942[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m    # ports, and it uses the IP address of the agent as a way to address spawned[0m
[30;1m97 | [0m[35m    # docker containers. This breaks down when running in a docker compose[0m
[30;1m98 | [0m[35m    # environment, because the address of the agent is not the address of the[0m
[30;1m99 | [0m[35m    # docker host. As a work-around, force agents to report their IP address as the[0m
[30;1m100 | [0m[35m    # IP address of the host machine.[0m
[30;1m101 | [0m[35m    if "darwin" in sys.platform:[0m
[30;1m102 | [0m[35m        # On macOS, docker runs in a VM and host.docker.internal points to the IP[0m

[31m--[ [0m[34mMatch #[0m[33m1943[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35mdef get_proxy_addr() -> str:[0m
[30;1m95 | [0m[35m    # The Determined proxying code relies on docker port-mapping container ports to host[0m
[30;1m96 | [0m[35m    # ports, and it uses the IP address of the agent as a way to address spawned[0m
[30;1m97 | [0m[35m    # docker containers. This breaks down when running in a docker compose[0m
[30;1m98 | [0m[35m    # environment, because the address of the agent is not the address of the[0m
[30;1m99 | [0m[35m    # docker host. As a work-around, force agents to report their IP address as the[0m
[30;1m100 | [0m[35m    # IP address of the host machine.[0m

[31m--[ [0m[34mMatch #[0m[33m1944[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35mdef get_proxy_addr() -> str:[0m
[30;1m95 | [0m[35m    # The Determined proxying code relies on docker port-mapping container ports to host[0m
[30;1m96 | [0m[35m    # ports, and it uses the IP address of the agent as a way to address spawned[0m
[30;1m97 | [0m[35m    # docker containers. This breaks down when running in a docker compose[0m
[30;1m98 | [0m[35m    # environment, because the address of the agent is not the address of the[0m
[30;1m99 | [0m[35m    # docker host. As a work-around, force agents to report their IP address as the[0m
[30;1m100 | [0m[35m    # IP address of the host machine.[0m

[31m--[ [0m[34mMatch #[0m[33m1945[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35mdef get_proxy_addr() -> str:[0m
[30;1m95 | [0m[35m    # The Determined proxying code relies on docker port-mapping container ports to host[0m
[30;1m96 | [0m[35m    # ports, and it uses the IP address of the agent as a way to address spawned[0m
[30;1m97 | [0m[35m    # docker containers. This breaks down when running in a docker compose[0m
[30;1m98 | [0m[35m    # environment, because the address of the agent is not the address of the[0m
[30;1m99 | [0m[35m    # docker host. As a work-around, force agents to report their IP address as the[0m

[31m--[ [0m[34mMatch #[0m[33m1946[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35mdef get_proxy_addr() -> str:[0m
[30;1m95 | [0m[35m    # The Determined proxying code relies on docker port-mapping container ports to host[0m
[30;1m96 | [0m[35m    # ports, and it uses the IP address of the agent as a way to address spawned[0m
[30;1m97 | [0m[35m    # docker containers. This breaks down when running in a docker compose[0m
[30;1m98 | [0m[35m    # environment, because the address of the agent is not the address of the[0m

[31m--[ [0m[34mMatch #[0m[33m1947[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m    return _docker_client[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m# Patch the Docker library to support device requests, since it has yet to support them natively[0m
[30;1m71 | [0m[35m# (see https://github.com/docker/docker-py/issues/2395).[0m
[30;1m72 | [0m[35mdef _patch_docker_for_device_requests() -> None:[0m
[30;1m73 | [0m[35m    _old_create_container_args = docker.models.containers._create_container_args[0m

[31m--[ [0m[34mMatch #[0m[33m1948[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35mOSS_EDITION = "determined"[0m
[30;1m35 | [0m[35mENTERPRISE_EDITION = "hpe-mlde"[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m# This object, when included in the host config in a container creation request, tells Docker to[0m
[30;1m38 | [0m[35m# expose all host GPUs inside a container.[0m
[30;1m39 | [0m[35mGPU_DEVICE_REQUEST = {"Driver": "nvidia", "Count": -1, "Capabilities": [["gpu", "utility"]]}[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1949[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35mfrom typing import Any, Callable, Dict, Generator, List, Optional, Sequence, Type[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mimport appdirs[0m
[30;1m19 | [0m[35mimport docker[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mfrom determined.common import api, constants, util[0m
[30;1m22 | [0m[35mfrom determined.common.api import authentication[0m
[30;1m23 | [0m[35mfrom determined.deploy import errors, healthcheck[0m

[31m--[ [0m[34mMatch #[0m[33m1950[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/local/cluster_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport sys[0m
[30;1m12 | [0m[35mimport tempfile[0m
[30;1m13 | [0m[35mimport threading[0m
[30;1m14 | [0m[35mimport time[0m
[30;1m15 | [0m[35mimport warnings[0m
[30;1m16 | [0m[35mfrom typing import Any, Callable, Dict, Generator, List, Optional, Sequence, Type[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mimport appdirs[0m

[31m--[ [0m[34mMatch #[0m[33m1951[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35mtry:[0m
[30;1m28 | [0m[35m    # Attempt to get the version from the package metadata. This should[0m
[30;1m29 | [0m[35m    # exist if using a built distribution (i.e. for most users), which[0m
[30;1m30 | [0m[35m    # includes pip editable installations.[0m
[30;1m31 | [0m[35m    __version__ = metadata.version(__name__)[0m
[30;1m32 | [0m[35mexcept metadata.PackageNotFoundError:[0m
[30;1m33 | [0m[35m    __version__ = "2!0.0.0+unknown"[0m

[31m--[ [0m[34mMatch #[0m[33m1952[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_lr_scheduler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m                   It is up to the user to decide when to call scheduler.step(),[0m
[30;1m64 | [0m[35m                   and whether to pass any arguments.[0m
[30;1m65 | [0m[35m            frequency:[0m
[30;1m66 | [0m[35m                Sets the frequency at which the batch and epoch step modes get triggered.[0m
[30;1m67 | [0m[35m        """[0m
[30;1m68 | [0m[35m        if not isinstance(step_mode, LRScheduler.StepMode):[0m
[30;1m69 | [0m[35m            raise TypeError(f"step_mode must be an LRScheduler.StepMode. Got {type(step_mode)}.")[0m

[31m--[ [0m[34mMatch #[0m[33m1953[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_lr_scheduler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m59 | [0m[35m                   If the option ``frequency`` is set to some value N, Determined will step the LR[0m
[30;1m60 | [0m[35m                   scheduler every N optimizer steps.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m                4. ``MANUAL_STEP``: Determined will not call scheduler.step() at all.[0m
[30;1m63 | [0m[35m                   It is up to the user to decide when to call scheduler.step(),[0m
[30;1m64 | [0m[35m                   and whether to pass any arguments.[0m
[30;1m65 | [0m[35m            frequency:[0m

[31m--[ [0m[34mMatch #[0m[33m1954[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/_lr_scheduler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10 | [0m[35m    This wrapper fulfills two main functions:[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    1. Save and restore the learning rate when a trial is paused, preempted, etc.[0m
[30;1m13 | [0m[35m    2. Step the learning rate scheduler at the configured frequency[0m
[30;1m14 | [0m[35m       (e.g., every batch or every epoch).[0m
[30;1m15 | [0m[35m    """[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1955[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/experimental/_torch_batch_process.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m267 | [0m[35m    batch_size: int,[0m
[30;1m268 | [0m[35m    dataset_len: int,[0m
[30;1m269 | [0m[35m) -> None:[0m
[30;1m270 | [0m[35m    # TODO: update after searcher context removal to report to master[0m
[30;1m271 | [0m[35m    records_processed = batch_idx * total_worker * batch_size[0m
[30;1m272 | [0m[35m    completion_rate = records_processed / dataset_len[0m
[30;1m273 | [0m[35m    searcher_op.report_progress(completion_rate)[0m

[31m--[ [0m[34mMatch #[0m[33m1956[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/experimental/_torch_batch_process.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35m        dataloader_iterator = iter(dataloader)[0m
[30;1m465 | [0m[35m[0m
[30;1m466 | [0m[35m        # Enumerate over dataloader directly may cause some workers to iterate for 1 more time[0m
[30;1m467 | [0m[35m        # than others when drop_last = False. If those workers synchronize on the last batch_idx,[0m
[30;1m468 | [0m[35m        # they would hang forever as other workers never hit that last batch_idx.[0m
[30;1m469 | [0m[35m        # To avoid the issue, we calculate and take the ceiling of the iteration count to ensure[0m
[30;1m470 | [0m[35m        # all workers iterate for the same number of times.[0m

[31m--[ [0m[34mMatch #[0m[33m1957[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/experimental/_torch_batch_process.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m    info = det.get_cluster_info()[0m
[30;1m173 | [0m[35m    if info and (len(info.container_addrs) > 1 or len(info.slot_ids) > 1):[0m
[30;1m174 | [0m[35m        raise ValueError([0m
[30;1m175 | [0m[35m            "In multi-slot managed cluster training, you must wrap your training script with a "[0m
[30;1m176 | [0m[35m            "distributed launch layer such as determined.launch.torch_distributed"[0m
[30;1m177 | [0m[35m        )[0m
[30;1m178 | [0m[35m    return None[0m

[31m--[ [0m[34mMatch #[0m[33m1958[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/experimental/_torch_batch_process.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m            group (string): metrics group name. Can be used to partition metrics[0m
[30;1m104 | [0m[35m                into different logical groups or time series.[0m
[30;1m105 | [0m[35m                "training" and "validation" group names map to built-in training[0m
[30;1m106 | [0m[35m                and validation time series. Note: Group cannot contain ``.`` character.[0m
[30;1m107 | [0m[35m            steps_completed (int): global step number, e.g. the number of batches processed.[0m
[30;1m108 | [0m[35m            metrics (Dict[str, Any]): metrics data dictionary. Must be JSON-serializable.[0m
[30;1m109 | [0m[35m                When reporting metrics with the same ``group`` and ``steps_completed`` values,[0m

[31m--[ [0m[34mMatch #[0m[33m1959[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/experimental/_torch_batch_process.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        Arguments:[0m
[30;1m103 | [0m[35m            group (string): metrics group name. Can be used to partition metrics[0m
[30;1m104 | [0m[35m                into different logical groups or time series.[0m
[30;1m105 | [0m[35m                "training" and "validation" group names map to built-in training[0m
[30;1m106 | [0m[35m                and validation time series. Note: Group cannot contain ``.`` character.[0m
[30;1m107 | [0m[35m            steps_completed (int): global step number, e.g. the number of batches processed.[0m

[31m--[ [0m[34mMatch #[0m[33m1960[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/tensorboard/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mdef find_tb_files(base_dir: pathlib.Path) -> List[pathlib.Path]:[0m
[30;1m42 | [0m[35m    """[0m
[30;1m43 | [0m[35m    Recursively searches through base_dir and subdirectories to find files[0m
[30;1m44 | [0m[35m    needed by Tensorboard, currently matching by filenames and extensions.[0m
[30;1m45 | [0m[35m    This method is used to sync files generated during training to persistent storage.[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1961[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m    if distributed_backend.use_deepspeed():[0m
[30;1m253 | [0m[35m        # We use an environment variable to allow users to enable custom initialization routine for[0m
[30;1m254 | [0m[35m        # distributed training since the pre_execute_hook runs before trial initialization.[0m
[30;1m255 | [0m[35m        manual_dist_init = os.environ.get("DET_MANUAL_INIT_DISTRIBUTED")[0m
[30;1m256 | [0m[35m        if not manual_dist_init:[0m
[30;1m257 | [0m[35m            deepspeed.init_distributed(auto_mpi_discovery=False)[0m
[30;1m258 | [0m[35m        return core.DistributedContext.from_deepspeed()[0m

[31m--[ [0m[34mMatch #[0m[33m1962[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m    """[0m
[30;1m220 | [0m[35m    time_metric = exp_conf["searcher"].get("time_metric")[0m
[30;1m221 | [0m[35m    if time_metric is not None:[0m
[30;1m222 | [0m[35m        max_time = exp_conf["searcher"].get("max_time")[0m
[30;1m223 | [0m[35m        assert max_time, "`searcher.max_time` not configured"[0m
[30;1m224 | [0m[35m        if time_metric == "batches":[0m
[30;1m225 | [0m[35m            if not isinstance(max_length, pytorch.Batch) or max_length.value != max_time:[0m

[31m--[ [0m[34mMatch #[0m[33m1963[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m    the experiment config. We check that the `max_length` passed to `fit()` matches the experiment[0m
[30;1m218 | [0m[35m    config and log warnings if it doesn't.[0m
[30;1m219 | [0m[35m    """[0m
[30;1m220 | [0m[35m    time_metric = exp_conf["searcher"].get("time_metric")[0m
[30;1m221 | [0m[35m    if time_metric is not None:[0m
[30;1m222 | [0m[35m        max_time = exp_conf["searcher"].get("max_time")[0m
[30;1m223 | [0m[35m        assert max_time, "`searcher.max_time` not configured"[0m

[31m--[ [0m[34mMatch #[0m[33m1964[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m            smaller_is_better = bool(self._info.trial._config["searcher"]["smaller_is_better"])[0m
[30;1m150 | [0m[35m            searcher_metric_name = self._info.trial._config["searcher"]["metric"][0m
[30;1m151 | [0m[35m            steps_completed = int(self._info.trial._steps_completed)[0m
[30;1m152 | [0m[35m            global_batch_size = self._info.trial.hparams.get("global_batch_size", None)[0m
[30;1m153 | [0m[35m            if global_batch_size:[0m
[30;1m154 | [0m[35m                global_batch_size = int(global_batch_size)[0m
[30;1m155 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1965[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35mdef _set_random_seeds(seed: int) -> None:[0m
[30;1m268 | [0m[35m    # Set identical random seeds on all training processes.[0m
[30;1m269 | [0m[35m    # When doing distributed training, each worker will start at a unique[0m
[30;1m270 | [0m[35m    # offset in the dataset, ensuring that it is processing a unique[0m
[30;1m271 | [0m[35m    # training batch.[0m
[30;1m272 | [0m[35m    random.seed(seed)[0m

[31m--[ [0m[34mMatch #[0m[33m1966[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m79 | [0m[35m                ``Batch(100)`` would report every 100 batches, while ``Batch([5, 30, 45])`` would[0m
[30;1m80 | [0m[35m                report after every 5th, 30th, and 45th batch.[0m
[30;1m81 | [0m[35m            checkpoint_policy: Controls how Determined performs checkpoints after validation[0m
[30;1m82 | [0m[35m                operations, if at all. Should be set to one of the following values:[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m                    best (default): A checkpoint will be taken after every validation operation[0m
[30;1m85 | [0m[35m                        that performs better than all previous validations for this experiment.[0m

[31m--[ [0m[34mMatch #[0m[33m1967[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m258 | [0m[35m        return core.DistributedContext.from_deepspeed()[0m
[30;1m259 | [0m[35m    elif info and (len(info.container_addrs) > 1 or len(info.slot_ids) > 1):[0m
[30;1m260 | [0m[35m        raise ValueError([0m
[30;1m261 | [0m[35m            "In multi-slot managed cluster training, you must wrap your training script with a "[0m
[30;1m262 | [0m[35m            "distributed launch layer such as determined.launch.deepspeed."[0m
[30;1m263 | [0m[35m        )[0m
[30;1m264 | [0m[35m    return None[0m

[31m--[ [0m[34mMatch #[0m[33m1968[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/pytorch/deepspeed/_trainer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mclass Trainer:[0m
[30;1m21 | [0m[35m    """[0m
[30;1m22 | [0m[35m    ``pytorch.deepspeed.Trainer`` is an abstraction on top of a  DeepSpeed training loop[0m
[30;1m23 | [0m[35m    that handles many training details under-the-hood, and exposes APIs for configuring[0m
[30;1m24 | [0m[35m    training-related features such as automatic checkpointing, validation, profiling,[0m
[30;1m25 | [0m[35m    metrics reporting, etc.[0m

[31m--[ [0m[34mMatch #[0m[33m1969[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/exec/pid_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35mdef read_action(opt: str, val: str) -> Optional[signal.Signals]:[0m
[30;1m10 | [0m[35m    if val.lower() == "wait":[0m
[30;1m11 | [0m[35m        return None[0m
[30;1m12 | [0m[35m    out = {s.name.lower(): s for s in signal.Signals}.get(val.lower())[0m
[30;1m13 | [0m[35m    if out is None:[0m
[30;1m14 | [0m[35m        raise ValueError([0m
[30;1m15 | [0m[35m            f"{opt} argument '{val}' is not valid; it should be a signal name ('SIGTERM', "[0m

[31m--[ [0m[34mMatch #[0m[33m1970[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/healthcheck.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m    try:[0m
[30;1m56 | [0m[35m        while time.time() - start_time < timeout:[0m
[30;1m57 | [0m[35m            try:[0m
[30;1m58 | [0m[35m                r = sess.get("genai/api/v1/workspaces")[0m
[30;1m59 | [0m[35m                if r.status_code == requests.codes.ok:[0m
[30;1m60 | [0m[35m                    _ = r.json()[0m
[30;1m61 | [0m[35m                    return[0m

[31m--[ [0m[34mMatch #[0m[33m1971[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/healthcheck.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        while time.time() - start_time < timeout:[0m
[30;1m24 | [0m[35m            try:[0m
[30;1m25 | [0m[35m                sess = api.UnauthSession(master_url, cert=cert)[0m
[30;1m26 | [0m[35m                r = sess.get("info")[0m
[30;1m27 | [0m[35m                if r.status_code == requests.codes.ok:[0m
[30;1m28 | [0m[35m                    return[0m
[30;1m29 | [0m[35m            except api.errors.MasterNotFoundException:[0m

[31m--[ [0m[34mMatch #[0m[33m1972[0m[34m of [0m[33m1972[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/determined/deploy/healthcheck.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Optional[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport requests[0m
[30;1m5 | [0m[35m[0m

1972 matches found.
