[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom asusrouter.modules.data import AsusData, AsusDataState[0m
[30;1m14 | [0m[35mfrom asusrouter.modules.endpoint import data_get[0m
[30;1m15 | [0m[35mfrom asusrouter.modules.openvpn import AsusOVPNClient, AsusOVPNServer[0m
[30;1m16 | [0m[35mfrom asusrouter.tools.cleaners import clean_dict, clean_dict_key_prefix[0m
[30;1m17 | [0m[35mfrom asusrouter.tools.converters import safe_int[0m
[30;1m18 | [0m[35mfrom asusrouter.tools.readers import merge_dicts[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m    ("wl{}_wme"),[0m
[30;1m103 | [0m[35m    ("wl{}_wme_bss_disable", safe_bool),[0m
[30;1m104 | [0m[35m    ("wl{}_wpa_gtk_rekey"),[0m
[30;1m105 | [0m[35m    ("wl{}_wpa_psk"),  # Password[0m
[30;1m106 | [0m[35m    ("wl{}_wps_mode"),[0m
[30;1m107 | [0m[35m][0m
[30;1m108 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    vpn: dict[AsusData, Any] = {[0m
[30;1m164 | [0m[35m        AsusData.OPENVPN_CLIENT: data.get("client"),[0m
[30;1m165 | [0m[35m        AsusData.OPENVPN_SERVER: data.get("server"),[0m
[30;1m166 | [0m[35m    }[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    return vpn[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m161 | [0m[35m    """Process VPN data."""[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    vpn: dict[AsusData, Any] = {[0m
[30;1m164 | [0m[35m        AsusData.OPENVPN_CLIENT: data.get("client"),[0m
[30;1m165 | [0m[35m        AsusData.OPENVPN_SERVER: data.get("server"),[0m
[30;1m166 | [0m[35m    }[0m
[30;1m167 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m6 | [0m[35mfrom typing import Any[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom asusrouter.modules.data import AsusData[0m
[30;1m9 | [0m[35mfrom asusrouter.modules.openvpn import AsusOVPNClient, AsusOVPNServer[0m
[30;1m10 | [0m[35mfrom asusrouter.tools.cleaners import clean_content[0m
[30;1m11 | [0m[35mfrom asusrouter.tools.converters import safe_int[0m
[30;1m12 | [0m[35mfrom asusrouter.tools.readers import read_as_snake_case, read_js_variables[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook_const.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35mMAP_VPNC_WIREGUARD = ([0m
[30;1m123 | [0m[35m    ("enable", "state", safe_bool),[0m
[30;1m124 | [0m[35m    ("nat", "nat", safe_bool),[0m
[30;1m125 | [0m[35m    ("priv", "private_key"),[0m
[30;1m126 | [0m[35m    ("addr", "address"),[0m
[30;1m127 | [0m[35m    ("dns", "dns", safe_bool),[0m
[30;1m128 | [0m[35m    ("mtu", "mtu", safe_int),[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook_const.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m    ("wgs_nat6", "nat6", safe_bool),[0m
[30;1m107 | [0m[35m    ("wgs_psk", "psk", safe_bool),[0m
[30;1m108 | [0m[35m    ("wgs_alive", "keep_alive", safe_int),[0m
[30;1m109 | [0m[35m    ("wgs_priv", "private_key"),[0m
[30;1m110 | [0m[35m    ("wgs_pub", "public_key"),[0m
[30;1m111 | [0m[35m    ("get_wgsc_status", "status"),[0m
[30;1m112 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook_const.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m    ("vpn_server_cipher", "cipher"),[0m
[30;1m40 | [0m[35m    ("vpn_server_digest", "digest"),[0m
[30;1m41 | [0m[35m    ("vpn_server_comp", "compression"),[0m
[30;1m42 | [0m[35m    ("vpn_server_igncrt", "password_only", safe_bool),[0m
[30;1m43 | [0m[35m    ("vpn_server_crypt", "auth_mode"),[0m
[30;1m44 | [0m[35m    ("vpn_server_hmac", "hmac"),[0m
[30;1m45 | [0m[35m    ("vpn_server_sn", "subnet"),[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m86 | [0m[35m        "--password",[0m
[30;1m87 | [0m[35m        type=str,[0m
[30;1m88 | [0m[35m        default="admin",[0m
[30;1m89 | [0m[35m        help="The password for the router. Default: `admin`.",[0m
[30;1m90 | [0m[35m    )[0m
[30;1m91 | [0m[35m    parser.add_argument([0m
[30;1m92 | [0m[35m        "-s",[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m    )[0m
[30;1m84 | [0m[35m    parser.add_argument([0m
[30;1m85 | [0m[35m        "-p",[0m
[30;1m86 | [0m[35m        "--password",[0m
[30;1m87 | [0m[35m        type=str,[0m
[30;1m88 | [0m[35m        default="admin",[0m
[30;1m89 | [0m[35m        help="The password for the router. Default: `admin`.",[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m            router = AsusRouter([0m
[30;1m28 | [0m[35m                hostname=args.host,[0m
[30;1m29 | [0m[35m                username=args.username,[0m
[30;1m30 | [0m[35m                password=args.password,[0m
[30;1m31 | [0m[35m                use_ssl=args.ssl,[0m
[30;1m32 | [0m[35m                session=session,[0m
[30;1m33 | [0m[35m                dumpback=dump.dump,[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/__main__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m            router = AsusRouter([0m
[30;1m28 | [0m[35m                hostname=args.host,[0m
[30;1m29 | [0m[35m                username=args.username,[0m
[30;1m30 | [0m[35m                password=args.password,[0m
[30;1m31 | [0m[35m                use_ssl=args.ssl,[0m
[30;1m32 | [0m[35m                session=session,[0m
[30;1m33 | [0m[35m                dumpback=dump.dump,[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m947 | [0m[35m            connection = Connection([0m
[30;1m948 | [0m[35m                hostname="localhost",[0m
[30;1m949 | [0m[35m                username="user",[0m
[30;1m950 | [0m[35m                password="pass",[0m
[30;1m951 | [0m[35m            )[0m
[30;1m952 | [0m[35m[0m
[30;1m953 | [0m[35m            # Set the initial state of `_connected`[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m906 | [0m[35m            connection = Connection([0m
[30;1m907 | [0m[35m                hostname="localhost",[0m
[30;1m908 | [0m[35m                username="user",[0m
[30;1m909 | [0m[35m                password="pass",[0m
[30;1m910 | [0m[35m            )[0m
[30;1m911 | [0m[35m[0m
[30;1m912 | [0m[35m            # Set the initial state[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m804 | [0m[35m        connection = Connection([0m
[30;1m805 | [0m[35m            hostname="localhost",[0m
[30;1m806 | [0m[35m            username="user",[0m
[30;1m807 | [0m[35m            password="pass",[0m
[30;1m808 | [0m[35m        )[0m
[30;1m809 | [0m[35m[0m
[30;1m810 | [0m[35m        # Set the initial connection state[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m679 | [0m[35m        connection = Connection([0m
[30;1m680 | [0m[35m            hostname="localhost",[0m
[30;1m681 | [0m[35m            username="user",[0m
[30;1m682 | [0m[35m            password="pass",[0m
[30;1m683 | [0m[35m        )[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m        # Mock the _make_request method[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m531 | [0m[35m        connection = Connection([0m
[30;1m532 | [0m[35m            hostname="localhost",[0m
[30;1m533 | [0m[35m            username="user",[0m
[30;1m534 | [0m[35m            password="pass",[0m
[30;1m535 | [0m[35m        )[0m
[30;1m536 | [0m[35m[0m
[30;1m537 | [0m[35m        # Set the initial connection state[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m448 | [0m[35m        connection = Connection([0m
[30;1m449 | [0m[35m            hostname="localhost",[0m
[30;1m450 | [0m[35m            username="user",[0m
[30;1m451 | [0m[35m            password="pass",[0m
[30;1m452 | [0m[35m        )[0m
[30;1m453 | [0m[35m[0m
[30;1m454 | [0m[35m        # Set the initial connection state[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m357 | [0m[35m        connection = Connection([0m
[30;1m358 | [0m[35m            hostname="localhost",[0m
[30;1m359 | [0m[35m            username="user",[0m
[30;1m360 | [0m[35m            password="pass",[0m
[30;1m361 | [0m[35m            timeout=30,[0m
[30;1m362 | [0m[35m        )[0m
[30;1m363 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m324 | [0m[35m        connection = Connection([0m
[30;1m325 | [0m[35m            hostname="localhost",[0m
[30;1m326 | [0m[35m            username="user",[0m
[30;1m327 | [0m[35m            password="pass",[0m
[30;1m328 | [0m[35m        )[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m        # Mock the session[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m285 | [0m[35m        connection = Connection([0m
[30;1m286 | [0m[35m            hostname="localhost",[0m
[30;1m287 | [0m[35m            username="user",[0m
[30;1m288 | [0m[35m            password="pass",[0m
[30;1m289 | [0m[35m            timeout=30,[0m
[30;1m290 | [0m[35m        )[0m
[30;1m291 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m266 | [0m[35m            # Verify that the connection object is initialized correctly[0m
[30;1m267 | [0m[35m            assert connection._hostname == hostname[0m
[30;1m268 | [0m[35m            assert connection._username == username[0m
[30;1m269 | [0m[35m            assert connection._password == password[0m
[30;1m270 | [0m[35m            assert connection._port == port[0m
[30;1m271 | [0m[35m            assert connection._ssl == use_ssl[0m
[30;1m272 | [0m[35m            assert connection._session == session[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m266 | [0m[35m            # Verify that the connection object is initialized correctly[0m
[30;1m267 | [0m[35m            assert connection._hostname == hostname[0m
[30;1m268 | [0m[35m            assert connection._username == username[0m
[30;1m269 | [0m[35m            assert connection._password == password[0m
[30;1m270 | [0m[35m            assert connection._port == port[0m
[30;1m271 | [0m[35m            assert connection._ssl == use_ssl[0m
[30;1m272 | [0m[35m            assert connection._session == session[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m249 | [0m[35m            connection = await Connection.create([0m
[30;1m250 | [0m[35m                hostname=hostname,[0m
[30;1m251 | [0m[35m                username=username,[0m
[30;1m252 | [0m[35m                password=password,[0m
[30;1m253 | [0m[35m                port=port,[0m
[30;1m254 | [0m[35m                use_ssl=use_ssl,[0m
[30;1m255 | [0m[35m                session=session,[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m249 | [0m[35m            connection = await Connection.create([0m
[30;1m250 | [0m[35m                hostname=hostname,[0m
[30;1m251 | [0m[35m                username=username,[0m
[30;1m252 | [0m[35m                password=password,[0m
[30;1m253 | [0m[35m                port=port,[0m
[30;1m254 | [0m[35m                use_ssl=use_ssl,[0m
[30;1m255 | [0m[35m                session=session,[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m238 | [0m[35m            # Define test parameters[0m
[30;1m239 | [0m[35m            hostname = "localhost"[0m
[30;1m240 | [0m[35m            username = "user"[0m
[30;1m241 | [0m[35m            password = "pass"[0m
[30;1m242 | [0m[35m            port = 8080[0m
[30;1m243 | [0m[35m            use_ssl = True[0m
[30;1m244 | [0m[35m            session = Mock()[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m212 | [0m[35m            connection = Connection([0m
[30;1m213 | [0m[35m                hostname="localhost",[0m
[30;1m214 | [0m[35m                username="user",[0m
[30;1m215 | [0m[35m                password="pass",[0m
[30;1m216 | [0m[35m                port=8080,[0m
[30;1m217 | [0m[35m                use_ssl=True,[0m
[30;1m218 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m182 | [0m[35m            connection = Connection([0m
[30;1m183 | [0m[35m                hostname="localhost",[0m
[30;1m184 | [0m[35m                username="user",[0m
[30;1m185 | [0m[35m                password="pass",[0m
[30;1m186 | [0m[35m                port=8080,[0m
[30;1m187 | [0m[35m                use_ssl=True,[0m
[30;1m188 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m166 | [0m[35m        # Ensure that instances do not interfere with each other[0m
[30;1m167 | [0m[35m        assert conn1._hostname != conn2._hostname[0m
[30;1m168 | [0m[35m        assert conn1._username != conn2._username[0m
[30;1m169 | [0m[35m        assert conn1._password != conn2._password[0m
[30;1m170 | [0m[35m        assert conn1._port != conn2._port[0m
[30;1m171 | [0m[35m        assert conn1._ssl != conn2._ssl[0m
[30;1m172 | [0m[35m        assert conn1._timeout != conn2._timeout[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m166 | [0m[35m        # Ensure that instances do not interfere with each other[0m
[30;1m167 | [0m[35m        assert conn1._hostname != conn2._hostname[0m
[30;1m168 | [0m[35m        assert conn1._username != conn2._username[0m
[30;1m169 | [0m[35m        assert conn1._password != conn2._password[0m
[30;1m170 | [0m[35m        assert conn1._port != conn2._port[0m
[30;1m171 | [0m[35m        assert conn1._ssl != conn2._ssl[0m
[30;1m172 | [0m[35m        assert conn1._timeout != conn2._timeout[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m            conn2,[0m
[30;1m155 | [0m[35m            hostname="localhost2",[0m
[30;1m156 | [0m[35m            username="user2",[0m
[30;1m157 | [0m[35m            password="pass2",[0m
[30;1m158 | [0m[35m            port=9090,[0m
[30;1m159 | [0m[35m            use_ssl=False,[0m
[30;1m160 | [0m[35m            session=None,[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m            conn1,[0m
[30;1m143 | [0m[35m            hostname="localhost1",[0m
[30;1m144 | [0m[35m            username="user1",[0m
[30;1m145 | [0m[35m            password="pass1",[0m
[30;1m146 | [0m[35m            port=8080,[0m
[30;1m147 | [0m[35m            use_ssl=True,[0m
[30;1m148 | [0m[35m            session=None,[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m        conn2 = Connection([0m
[30;1m132 | [0m[35m            hostname="localhost2",[0m
[30;1m133 | [0m[35m            username="user2",[0m
[30;1m134 | [0m[35m            password="pass2",[0m
[30;1m135 | [0m[35m            port=9090,[0m
[30;1m136 | [0m[35m            use_ssl=False,[0m
[30;1m137 | [0m[35m            timeout=1,[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m123 | [0m[35m        conn1 = Connection([0m
[30;1m124 | [0m[35m            hostname="localhost1",[0m
[30;1m125 | [0m[35m            username="user1",[0m
[30;1m126 | [0m[35m            password="pass1",[0m
[30;1m127 | [0m[35m            port=8080,[0m
[30;1m128 | [0m[35m            use_ssl=True,[0m
[30;1m129 | [0m[35m            timeout=None,[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m            conn,[0m
[30;1m107 | [0m[35m            hostname=hostname,[0m
[30;1m108 | [0m[35m            username=username,[0m
[30;1m109 | [0m[35m            password=password,[0m
[30;1m110 | [0m[35m            port=port,[0m
[30;1m111 | [0m[35m            use_ssl=use_ssl,[0m
[30;1m112 | [0m[35m            session=session,[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m            conn,[0m
[30;1m107 | [0m[35m            hostname=hostname,[0m
[30;1m108 | [0m[35m            username=username,[0m
[30;1m109 | [0m[35m            password=password,[0m
[30;1m110 | [0m[35m            port=port,[0m
[30;1m111 | [0m[35m            use_ssl=use_ssl,[0m
[30;1m112 | [0m[35m            session=session,[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m93 | [0m[35m        conn = Connection([0m
[30;1m94 | [0m[35m            hostname=hostname,[0m
[30;1m95 | [0m[35m            username=username,[0m
[30;1m96 | [0m[35m            password=password,[0m
[30;1m97 | [0m[35m            port=port,[0m
[30;1m98 | [0m[35m            use_ssl=use_ssl,[0m
[30;1m99 | [0m[35m            session=session,[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m93 | [0m[35m        conn = Connection([0m
[30;1m94 | [0m[35m            hostname=hostname,[0m
[30;1m95 | [0m[35m            username=username,[0m
[30;1m96 | [0m[35m            password=password,[0m
[30;1m97 | [0m[35m            port=port,[0m
[30;1m98 | [0m[35m            use_ssl=use_ssl,[0m
[30;1m99 | [0m[35m            session=session,[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m        mock_new_session: Mock,[0m
[30;1m81 | [0m[35m        hostname: str,[0m
[30;1m82 | [0m[35m        username: str,[0m
[30;1m83 | [0m[35m        password: str,[0m
[30;1m84 | [0m[35m        port: int,[0m
[30;1m85 | [0m[35m        use_ssl: bool,[0m
[30;1m86 | [0m[35m        session: Optional[Mock],[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m        assert isinstance(conn._connection_lock, asyncio.Lock)[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    @pytest.mark.parametrize([0m
[30;1m65 | [0m[35m        "hostname, username, password, port, use_ssl, session, timeout,"[0m
[30;1m66 | [0m[35m        "dumpback",[0m
[30;1m67 | [0m[35m        [[0m
[30;1m68 | [0m[35m            ("localhost", "user", "pass", None, False, None, None, None),[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        assert conn._hostname == hostname[0m
[30;1m52 | [0m[35m        assert conn._username == username[0m
[30;1m53 | [0m[35m        assert conn._password == password[0m
[30;1m54 | [0m[35m        assert conn._port == (port or (8443 if use_ssl else 80))[0m
[30;1m55 | [0m[35m        assert conn._ssl == use_ssl[0m
[30;1m56 | [0m[35m        assert conn._session == (session or mock_new_session.return_value)[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        assert conn._hostname == hostname[0m
[30;1m52 | [0m[35m        assert conn._username == username[0m
[30;1m53 | [0m[35m        assert conn._password == password[0m
[30;1m54 | [0m[35m        assert conn._port == (port or (8443 if use_ssl else 80))[0m
[30;1m55 | [0m[35m        assert conn._ssl == use_ssl[0m
[30;1m56 | [0m[35m        assert conn._session == (session or mock_new_session.return_value)[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m38 | [0m[35m        conn: Connection,[0m
[30;1m39 | [0m[35m        hostname: str,[0m
[30;1m40 | [0m[35m        username: str,[0m
[30;1m41 | [0m[35m        password: str,[0m
[30;1m42 | [0m[35m        port: Optional[int],[0m
[30;1m43 | [0m[35m        use_ssl: bool,[0m
[30;1m44 | [0m[35m        session: Optional[Mock],[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    username = "user"[0m
[30;1m29 | [0m[35m    password = "pass"[0m
[30;1m30 | [0m[35m    payload, headers = generate_credentials(username, password)[0m
[30;1m31 | [0m[35m    assert payload == "login_authorization=dXNlcjpwYXNz"[0m
[30;1m32 | [0m[35m    assert headers == {"user-agent": "asusrouter--DUTUtil-"}[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m    """Test the `generate_credentials`."""[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    username = "user"[0m
[30;1m29 | [0m[35m    password = "pass"[0m
[30;1m30 | [0m[35m    payload, headers = generate_credentials(username, password)[0m
[30;1m31 | [0m[35m    assert payload == "login_authorization=dXNlcjpwYXNz"[0m
[30;1m32 | [0m[35m    assert headers == {"user-agent": "asusrouter--DUTUtil-"}[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m36 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m37 | [0m[35m    username="admin",               #required[0m
[30;1m38 | [0m[35m    password="password",            #required[0m
[30;1m39 | [0m[35m    use_ssl=True,                   #optional[0m
[30;1m40 | [0m[35m    session=session,                #optional[0m
[30;1m41 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m36 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m37 | [0m[35m    username="admin",               #required[0m
[30;1m38 | [0m[35m    password="password",            #required[0m
[30;1m39 | [0m[35m    use_ssl=True,                   #optional[0m
[30;1m40 | [0m[35m    session=session,                #optional[0m
[30;1m41 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m## Usage[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mOnce installed, you can import the `AsusRouter` class from the module. Example shows the default par[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m```python[0m
[30;1m25 | [0m[35mimport aiohttp[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m63 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m64 | [0m[35m    username="admin",               #required[0m
[30;1m65 | [0m[35m    password="password",            #required[0m
[30;1m66 | [0m[35m    use_ssl=True,                   #optional[0m
[30;1m67 | [0m[35m    session=session,                #optional[0m
[30;1m68 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m63 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m64 | [0m[35m    username="admin",               #required[0m
[30;1m65 | [0m[35m    password="password",            #required[0m
[30;1m66 | [0m[35m    use_ssl=True,                   #optional[0m
[30;1m67 | [0m[35m    session=session,                #optional[0m
[30;1m68 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m## Usage[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mOnce installed, you can import the `AsusRouter` class from the module. Example shows the default par[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m```python[0m
[30;1m52 | [0m[35mimport aiohttp[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/state.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m49 | [0m[35m    BLOCK_ALL = AsusBlockAll[0m
[30;1m50 | [0m[35m    CONNECTION = ConnectionState[0m
[30;1m51 | [0m[35m    LED = AsusLED[0m
[30;1m52 | [0m[35m    OPENVPN_CLIENT = AsusOVPNClient[0m
[30;1m53 | [0m[35m    OPENVPN_SERVER = AsusOVPNServer[0m
[30;1m54 | [0m[35m    PARENTAL_CONTROL = AsusParentalControl[0m
[30;1m55 | [0m[35m    PC_RULE = ParentalControlRule[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/state.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35mfrom asusrouter.tools.converters import get_enum_key_by_value[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mfrom .led import AsusLED[0m
[30;1m30 | [0m[35mfrom .openvpn import AsusOVPNClient, AsusOVPNServer[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m_LOGGER = logging.getLogger(__name__)[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m282 | [0m[35m                        AsusState.WIREGUARD_CLIENT, AsusData.VPNC[0m
[30;1m283 | [0m[35m                    )[0m
[30;1m284 | [0m[35m                    add_conditional_data_alias([0m
[30;1m285 | [0m[35m                        AsusData.OPENVPN_CLIENT, AsusData.VPNC[0m
[30;1m286 | [0m[35m                    )[0m
[30;1m287 | [0m[35m                    add_conditional_data_alias([0m
[30;1m288 | [0m[35m                        AsusData.WIREGUARD_CLIENT, AsusData.VPNC[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m276 | [0m[35m                _LOGGER.debug("Adding conditional rules for stock firmware")[0m
[30;1m277 | [0m[35m                if fw_388 < firmware:[0m
[30;1m278 | [0m[35m                    add_conditional_state([0m
[30;1m279 | [0m[35m                        AsusState.OPENVPN_CLIENT, AsusData.VPNC[0m
[30;1m280 | [0m[35m                    )[0m
[30;1m281 | [0m[35m                    add_conditional_state([0m
[30;1m282 | [0m[35m                        AsusState.WIREGUARD_CLIENT, AsusData.VPNC[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        self._connection = await Connection.create([0m
[30;1m130 | [0m[35m            hostname=self._hostname,[0m
[30;1m131 | [0m[35m            username=self._username,[0m
[30;1m132 | [0m[35m            password=self._password,[0m
[30;1m133 | [0m[35m            port=self._port,[0m
[30;1m134 | [0m[35m            use_ssl=self._use_ssl,[0m
[30;1m135 | [0m[35m            session=self._session,[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        self._connection = await Connection.create([0m
[30;1m130 | [0m[35m            hostname=self._hostname,[0m
[30;1m131 | [0m[35m            username=self._username,[0m
[30;1m132 | [0m[35m            password=self._password,[0m
[30;1m133 | [0m[35m            port=self._port,[0m
[30;1m134 | [0m[35m            use_ssl=self._use_ssl,[0m
[30;1m135 | [0m[35m            session=self._session,[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m111 | [0m[35m        # Create an empty connection and save the credentials[0m
[30;1m112 | [0m[35m        self._connection: Optional[Connection] = None[0m
[30;1m113 | [0m[35m        self._username = username[0m
[30;1m114 | [0m[35m        self._password = password[0m
[30;1m115 | [0m[35m        self._port = port[0m
[30;1m116 | [0m[35m        self._use_ssl = use_ssl[0m
[30;1m117 | [0m[35m        self._session = session[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m111 | [0m[35m        # Create an empty connection and save the credentials[0m
[30;1m112 | [0m[35m        self._connection: Optional[Connection] = None[0m
[30;1m113 | [0m[35m        self._username = username[0m
[30;1m114 | [0m[35m        self._password = password[0m
[30;1m115 | [0m[35m        self._port = port[0m
[30;1m116 | [0m[35m        self._use_ssl = use_ssl[0m
[30;1m117 | [0m[35m        self._session = session[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m        self,[0m
[30;1m81 | [0m[35m        hostname: str,[0m
[30;1m82 | [0m[35m        username: str,[0m
[30;1m83 | [0m[35m        password: str,[0m
[30;1m84 | [0m[35m        port: Optional[int] = None,[0m
[30;1m85 | [0m[35m        use_ssl: bool = False,[0m
[30;1m86 | [0m[35m        cache_time: Optional[float] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m7 | [0m[35mfrom typing import Any, Awaitable, Callable, Optional[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom asusrouter.modules.data import AsusData, AsusDataState[0m
[30;1m10 | [0m[35mfrom asusrouter.modules.openvpn import AsusOVPNClient[0m
[30;1m11 | [0m[35mfrom asusrouter.modules.wireguard import AsusWireGuardClient[0m
[30;1m12 | [0m[35mfrom asusrouter.tools.converters import get_arguments[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m63 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m64 | [0m[35m    username="admin",               #required[0m
[30;1m65 | [0m[35m    password="password",            #required[0m
[30;1m66 | [0m[35m    use_ssl=True,                   #optional[0m
[30;1m67 | [0m[35m    session=session,                #optional[0m
[30;1m68 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m63 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m64 | [0m[35m    username="admin",               #required[0m
[30;1m65 | [0m[35m    password="password",            #required[0m
[30;1m66 | [0m[35m    use_ssl=True,                   #optional[0m
[30;1m67 | [0m[35m    session=session,                #optional[0m
[30;1m68 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m## Usage[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mOnce installed, you can import the `AsusRouter` class from the module. Example shows the default par[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m```python[0m
[30;1m52 | [0m[35mimport aiohttp[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m35 | [0m[35m    """Generate credentials for connection"""[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    auth = f"{username}:{password}".encode("ascii")[0m
[30;1m38 | [0m[35m    logintoken = base64.b64encode(auth).decode("ascii")[0m
[30;1m39 | [0m[35m    payload = f"login_authorization={logintoken}"[0m
[30;1m40 | [0m[35m    headers = {"user-agent": USER_AGENT}[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m6 | [0m[35mfrom __future__ import annotations[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport asyncio[0m
[30;1m9 | [0m[35mimport base64[0m
[30;1m10 | [0m[35mimport json[0m
[30;1m11 | [0m[35mimport logging[0m
[30;1m12 | [0m[35mfrom typing import Any, Awaitable, Callable, Optional, Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m            # Convert the response to JSON[0m
[30;1m228 | [0m[35m            content = json.loads(resp_content)[0m
[30;1m229 | [0m[35m            # Get the auth_token value from the headers[0m
[30;1m230 | [0m[35m            self._token = content.get("asus_token")[0m
[30;1m231 | [0m[35m            if not self._token:[0m
[30;1m232 | [0m[35m                _LOGGER.error("No token received")[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m            # Generate payload and header for login request[0m
[30;1m200 | [0m[35m            payload, headers = generate_credentials([0m
[30;1m201 | [0m[35m                self._username, self._password[0m
[30;1m202 | [0m[35m            )[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m            # Request authotization[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        connection = cls([0m
[30;1m130 | [0m[35m            hostname=hostname,[0m
[30;1m131 | [0m[35m            username=username,[0m
[30;1m132 | [0m[35m            password=password,[0m
[30;1m133 | [0m[35m            port=port,[0m
[30;1m134 | [0m[35m            use_ssl=use_ssl,[0m
[30;1m135 | [0m[35m            session=session,[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m        connection = cls([0m
[30;1m130 | [0m[35m            hostname=hostname,[0m
[30;1m131 | [0m[35m            username=username,[0m
[30;1m132 | [0m[35m            password=password,[0m
[30;1m133 | [0m[35m            port=port,[0m
[30;1m134 | [0m[35m            use_ssl=use_ssl,[0m
[30;1m135 | [0m[35m            session=session,[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m117 | [0m[35m        cls,[0m
[30;1m118 | [0m[35m        hostname: str,[0m
[30;1m119 | [0m[35m        username: str,[0m
[30;1m120 | [0m[35m        password: str,[0m
[30;1m121 | [0m[35m        port: Optional[int] = None,[0m
[30;1m122 | [0m[35m        use_ssl: bool = False,[0m
[30;1m123 | [0m[35m        session: Optional[aiohttp.ClientSession] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m        # Hostname and credentials[0m
[30;1m71 | [0m[35m        self._hostname = hostname[0m
[30;1m72 | [0m[35m        self._username = username[0m
[30;1m73 | [0m[35m        self._password = password[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m        # Set the port and protocol based on the input[0m
[30;1m76 | [0m[35m        self._http = "https" if use_ssl else "http"[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m        # Hostname and credentials[0m
[30;1m71 | [0m[35m        self._hostname = hostname[0m
[30;1m72 | [0m[35m        self._username = username[0m
[30;1m73 | [0m[35m        self._password = password[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m        # Set the port and protocol based on the input[0m
[30;1m76 | [0m[35m        self._http = "https" if use_ssl else "http"[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m        self,[0m
[30;1m50 | [0m[35m        hostname: str,[0m
[30;1m51 | [0m[35m        username: str,[0m
[30;1m52 | [0m[35m        password: str,[0m
[30;1m53 | [0m[35m        port: Optional[int] = None,[0m
[30;1m54 | [0m[35m        use_ssl: bool = False,[0m
[30;1m55 | [0m[35m        session: Optional[aiohttp.ClientSession] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m) -> Tuple[str, dict[str, str]]:[0m
[30;1m35 | [0m[35m    """Generate credentials for connection"""[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    auth = f"{username}:{password}".encode("ascii")[0m
[30;1m38 | [0m[35m    logintoken = base64.b64encode(auth).decode("ascii")[0m
[30;1m39 | [0m[35m    payload = f"login_authorization={logintoken}"[0m
[30;1m40 | [0m[35m    headers = {"user-agent": USER_AGENT}[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mdef generate_credentials([0m
[30;1m33 | [0m[35m    username: str, password: str[0m
[30;1m34 | [0m[35m) -> Tuple[str, dict[str, str]]:[0m
[30;1m35 | [0m[35m    """Generate credentials for connection"""[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m516 | [0m[35m                "id": safe_int(part[2]),[0m
[30;1m517 | [0m[35m                "name": safe_return(part[0]),[0m
[30;1m518 | [0m[35m                "login": safe_return(part[3]),[0m
[30;1m519 | [0m[35m                "password": safe_return(part[4]),[0m
[30;1m520 | [0m[35m                "active": safe_bool(part[5]),[0m
[30;1m521 | [0m[35m                "vpnc_unit": vpnc_unit,[0m
[30;1m522 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m503 | [0m[35m            if client == str():[0m
[30;1m504 | [0m[35m                continue[0m
[30;1m505 | [0m[35m            part = client.split(">")[0m
[30;1m506 | [0m[35m            # Format: name, type, id, login, password, active, vpnc_id, ?, ?, ?, ?, `Web`[0m
[30;1m507 | [0m[35m            if len(part) < 7:[0m
[30;1m508 | [0m[35m                continue[0m
[30;1m509 | [0m[35m            vpnc_id = safe_int(part[6])[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m142 | [0m[35m    # VPNC[0m
[30;1m143 | [0m[35m    if "vpnc_clientlist" in data:[0m
[30;1m144 | [0m[35m        vpnc, vpnc_clientlist = process_vpnc(data)[0m
[30;1m145 | [0m[35m        state[AsusData.OPENVPN_CLIENT] = vpnc[AsusVPNType.OPENVPN][0m
[30;1m146 | [0m[35m        state[AsusData.VPNC] = vpnc[0m
[30;1m147 | [0m[35m        state[AsusData.VPNC_CLIENTLIST] = vpnc_clientlist[0m
[30;1m148 | [0m[35m        state[AsusData.WIREGUARD_CLIENT] = vpnc[AsusVPNType.WIREGUARD][0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m            # Get server data[0m
[30;1m285 | [0m[35m            # We define default state as 0, since it's not always present[0m
[30;1m286 | [0m[35m            server_state = AsusOVPNServer([0m
[30;1m287 | [0m[35m                safe_int(vpnmap.get(f"server{num}_state"), default=0)[0m
[30;1m288 | [0m[35m            )[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m            # Assign server data[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m            client_state = AsusOVPNClient([0m
[30;1m267 | [0m[35m                safe_int(vpnmap.get(f"client{num}_state"), default=0)[0m
[30;1m268 | [0m[35m            )[0m
[30;1m269 | [0m[35m            client_errno = safe_int(vpnmap.get(f"client{num}_errno"))[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m            # Assign client data[0m
[30;1m272 | [0m[35m            vpn["client"][num] = {[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m            # Get client data[0m
[30;1m265 | [0m[35m            # We define default state as 0, since it's not always present[0m
[30;1m266 | [0m[35m            client_state = AsusOVPNClient([0m
[30;1m267 | [0m[35m                safe_int(vpnmap.get(f"client{num}_state"), default=0)[0m
[30;1m268 | [0m[35m            )[0m
[30;1m269 | [0m[35m            client_errno = safe_int(vpnmap.get(f"client{num}_errno"))[0m
[30;1m270 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m        "client": {},[0m
[30;1m252 | [0m[35m        "server": {},[0m
[30;1m253 | [0m[35m    }[0m
[30;1m254 | [0m[35m    vpnmap = devicemap.get("vpn")[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    if vpnmap:[0m
[30;1m257 | [0m[35m        # There are only 5 clients actually in the current firmware[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m226 | [0m[35m    # but keep the previous value to avoid regular changes[0m
[30;1m227 | [0m[35m    sys = devicemap.get("sys")[0m
[30;1m228 | [0m[35m    if sys:[0m
[30;1m229 | [0m[35m        uptime_str = sys.get("uptimeStr")[0m
[30;1m230 | [0m[35m        if uptime_str:[0m
[30;1m231 | [0m[35m            time = read_uptime_string(uptime_str)[0m
[30;1m232 | [0m[35m            if time:[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m    # Since precision is 1 second, could be that old and new are 1 sec different.[0m
[30;1m225 | [0m[35m    # In this case, we should not change the boot time,[0m
[30;1m226 | [0m[35m    # but keep the previous value to avoid regular changes[0m
[30;1m227 | [0m[35m    sys = devicemap.get("sys")[0m
[30;1m228 | [0m[35m    if sys:[0m
[30;1m229 | [0m[35m        uptime_str = sys.get("uptimeStr")[0m
[30;1m230 | [0m[35m        if uptime_str:[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m    devicemap = data[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    # Boot time[0m
[30;1m193 | [0m[35m    prev_boottime_object: Optional[AsusDataState] = history.get(AsusData.BOOTTIME)[0m
[30;1m194 | [0m[35m    prev_boottime = prev_boottime_object.data if prev_boottime_object else None[0m
[30;1m195 | [0m[35m    boottime, reboot = process_boottime(devicemap, prev_boottime)[0m
[30;1m196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m        # Go through the input values and fill the dict[0m
[30;1m121 | [0m[35m        for input_value in input_values:[0m
[30;1m122 | [0m[35m            # Get the input group data[0m
[30;1m123 | [0m[35m            xml_input_group = xml_content.get(input_group)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m            # If the input group data is None, skip this iteration[0m
[30;1m126 | [0m[35m            if xml_input_group is None:[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # Parse the XML data[0m
[30;1m34 | [0m[35m    try:[0m
[30;1m35 | [0m[35m        xml_content: dict[str, Any] = xmltodict.parse(content).get("devicemap", {})[0m
[30;1m36 | [0m[35m        if not xml_content:[0m
[30;1m37 | [0m[35m            _LOGGER.debug("Received empty devicemap XML")[0m
[30;1m38 | [0m[35m            return devicemap[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m                boottime["datetime"] = time[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m                if prev_boottime and "datetime" in prev_boottime:[0m
[30;1m236 | [0m[35m                    delta = time - prev_boottime["datetime"][0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m                    # Check for reboot[0m
[30;1m239 | [0m[35m                    if abs(delta.seconds) >= 2 and delta.seconds >= 0:[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m        if uptime_str:[0m
[30;1m231 | [0m[35m            time = read_uptime_string(uptime_str)[0m
[30;1m232 | [0m[35m            if time:[0m
[30;1m233 | [0m[35m                boottime["datetime"] = time[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m                if prev_boottime and "datetime" in prev_boottime:[0m
[30;1m236 | [0m[35m                    delta = time - prev_boottime["datetime"][0m
[30;1m237 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m    if sys:[0m
[30;1m229 | [0m[35m        uptime_str = sys.get("uptimeStr")[0m
[30;1m230 | [0m[35m        if uptime_str:[0m
[30;1m231 | [0m[35m            time = read_uptime_string(uptime_str)[0m
[30;1m232 | [0m[35m            if time:[0m
[30;1m233 | [0m[35m                boottime["datetime"] = time[0m
[30;1m234 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m    # Devicemap - just the data itself[0m
[30;1m190 | [0m[35m    devicemap = data[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    # Boot time[0m
[30;1m193 | [0m[35m    prev_boottime_object: Optional[AsusDataState] = history.get(AsusData.BOOTTIME)[0m
[30;1m194 | [0m[35m    prev_boottime = prev_boottime_object.data if prev_boottime_object else None[0m
[30;1m195 | [0m[35m    boottime, reboot = process_boottime(devicemap, prev_boottime)[0m
[30;1m196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m        api_value["service"],[0m
[30;1m218 | [0m[35m        arguments=api_value["callback_arguments"],[0m
[30;1m219 | [0m[35m        apply=True,[0m
[30;1m220 | [0m[35m        expect_modify=kwargs.get("expect_modify", False),[0m
[30;1m221 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m    }[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # Get the service and callback arguments for the given api_type[0m
[30;1m211 | [0m[35m    api_value = api_values.get(api_type)[0m
[30;1m212 | [0m[35m    if not api_value:[0m
[30;1m213 | [0m[35m        return False[0m
[30;1m214 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m212 | [0m[35m    if not api_value:[0m
[30;1m213 | [0m[35m        return False[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m    # Call the service[0m
[30;1m216 | [0m[35m    return await callback([0m
[30;1m217 | [0m[35m        api_value["service"],[0m
[30;1m218 | [0m[35m        arguments=api_value["callback_arguments"],[0m
[30;1m219 | [0m[35m        apply=True,[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m        },[0m
[30;1m208 | [0m[35m    }[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # Get the service and callback arguments for the given api_type[0m
[30;1m211 | [0m[35m    api_value = api_values.get(api_type)[0m
[30;1m212 | [0m[35m    if not api_value:[0m
[30;1m213 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m    if api_type is None or api_id is None:[0m
[30;1m191 | [0m[35m        return False[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    # Define the service and callback arguments for each api_type[0m
[30;1m194 | [0m[35m    api_values = {[0m
[30;1m195 | [0m[35m        "wlan": {[0m
[30;1m196 | [0m[35m            "service": "restart_wireless",[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m    ("wl{}_closed", safe_bool),[0m
[30;1m64 | [0m[35m    ("wl{}_crypto"),[0m
[30;1m65 | [0m[35m    ("wl{}_expire", safe_int),  # Expire time in s[0m
[30;1m66 | [0m[35m    ("wl{}_expire_tmp", safe_int),  # Expire time left in s[0m
[30;1m67 | [0m[35m    ("wl{}_gn_wbl_enable"),[0m
[30;1m68 | [0m[35m    ("wl{}_gn_wbl_rule"),[0m
[30;1m69 | [0m[35m    ("wl{}_gn_wbl_type"),[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m    ("wl{}_bw_ul", safe_int),  # Bandwidth limit upload[0m
[30;1m63 | [0m[35m    ("wl{}_closed", safe_bool),[0m
[30;1m64 | [0m[35m    ("wl{}_crypto"),[0m
[30;1m65 | [0m[35m    ("wl{}_expire", safe_int),  # Expire time in s[0m
[30;1m66 | [0m[35m    ("wl{}_expire_tmp", safe_int),  # Expire time left in s[0m
[30;1m67 | [0m[35m    ("wl{}_gn_wbl_enable"),[0m
[30;1m68 | [0m[35m    ("wl{}_gn_wbl_rule"),[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wlan.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m181 | [0m[35m    state: AsusWLAN,[0m
[30;1m182 | [0m[35m    **kwargs: Any,[0m
[30;1m183 | [0m[35m) -> bool:[0m
[30;1m184 | [0m[35m    """Set the parental control state."""[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    # Get the arguments[0m
[30;1m187 | [0m[35m    api_type, api_id = get_arguments(("api_type", "api_id"), **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        temperature["cpu"] = variables.get("curr_coreTmp_cpu")[0m
[30;1m56 | [0m[35m    # If there is curr_cpuTemp[0m
[30;1m57 | [0m[35m    elif "curr_cpuTemp" in variables:[0m
[30;1m58 | [0m[35m        temperature["cpu"] = variables.get("curr_cpuTemp")[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    # Convert the temperature values to float or remove them if they have "disabled"[0m
[30;1m61 | [0m[35m    temperature = {[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m    # Read CPU temperature[0m
[30;1m53 | [0m[35m    # If there is curr_coreTmp_cpu[0m
[30;1m54 | [0m[35m    if "curr_coreTmp_cpu" in variables:[0m
[30;1m55 | [0m[35m        temperature["cpu"] = variables.get("curr_coreTmp_cpu")[0m
[30;1m56 | [0m[35m    # If there is curr_cpuTemp[0m
[30;1m57 | [0m[35m    elif "curr_cpuTemp" in variables:[0m
[30;1m58 | [0m[35m        temperature["cpu"] = variables.get("curr_cpuTemp")[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_wl0_raw")[0m
[30;1m43 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_wl1_raw")[0m
[30;1m44 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_wl2_raw")[0m
[30;1m45 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_wl3_raw")[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    # Clean the temperature values from `&deg;C`[0m
[30;1m48 | [0m[35m    for key, value in temperature.items():[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    elif "curr_coreTmp_wl0_raw" in variables:[0m
[30;1m42 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_wl0_raw")[0m
[30;1m43 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_wl1_raw")[0m
[30;1m44 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_wl2_raw")[0m
[30;1m45 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_wl3_raw")[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    # Clean the temperature values from `&deg;C`[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m    # If there is curr_coreTmp_wl0_raw, we have type 3[0m
[30;1m41 | [0m[35m    elif "curr_coreTmp_wl0_raw" in variables:[0m
[30;1m42 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_wl0_raw")[0m
[30;1m43 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_wl1_raw")[0m
[30;1m44 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_wl2_raw")[0m
[30;1m45 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_wl3_raw")[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_3_raw")[0m
[30;1m40 | [0m[35m    # If there is curr_coreTmp_wl0_raw, we have type 3[0m
[30;1m41 | [0m[35m    elif "curr_coreTmp_wl0_raw" in variables:[0m
[30;1m42 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_wl0_raw")[0m
[30;1m43 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_wl1_raw")[0m
[30;1m44 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_wl2_raw")[0m
[30;1m45 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_wl3_raw")[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_0_raw")[0m
[30;1m37 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_1_raw")[0m
[30;1m38 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_2_raw")[0m
[30;1m39 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_3_raw")[0m
[30;1m40 | [0m[35m    # If there is curr_coreTmp_wl0_raw, we have type 3[0m
[30;1m41 | [0m[35m    elif "curr_coreTmp_wl0_raw" in variables:[0m
[30;1m42 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_wl0_raw")[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    elif "curr_coreTmp_0_raw" in variables:[0m
[30;1m36 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_0_raw")[0m
[30;1m37 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_1_raw")[0m
[30;1m38 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_2_raw")[0m
[30;1m39 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_3_raw")[0m
[30;1m40 | [0m[35m    # If there is curr_coreTmp_wl0_raw, we have type 3[0m
[30;1m41 | [0m[35m    elif "curr_coreTmp_wl0_raw" in variables:[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m    # If there is curr_coreTmp_0_raw, we have type 2[0m
[30;1m35 | [0m[35m    elif "curr_coreTmp_0_raw" in variables:[0m
[30;1m36 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_0_raw")[0m
[30;1m37 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_1_raw")[0m
[30;1m38 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_2_raw")[0m
[30;1m39 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_3_raw")[0m
[30;1m40 | [0m[35m    # If there is curr_coreTmp_wl0_raw, we have type 3[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_52_raw")[0m
[30;1m34 | [0m[35m    # If there is curr_coreTmp_0_raw, we have type 2[0m
[30;1m35 | [0m[35m    elif "curr_coreTmp_0_raw" in variables:[0m
[30;1m36 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_0_raw")[0m
[30;1m37 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_1_raw")[0m
[30;1m38 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_2_raw")[0m
[30;1m39 | [0m[35m        temperature[Wlan.FREQ_6G] = variables.get("curr_coreTmp_3_raw")[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m    if "curr_coreTmp_5_raw" in variables:[0m
[30;1m31 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_2_raw")[0m
[30;1m32 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_5_raw")[0m
[30;1m33 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_52_raw")[0m
[30;1m34 | [0m[35m    # If there is curr_coreTmp_0_raw, we have type 2[0m
[30;1m35 | [0m[35m    elif "curr_coreTmp_0_raw" in variables:[0m
[30;1m36 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_0_raw")[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m    # If there is curr_coreTmp_5_raw, we have type 1[0m
[30;1m30 | [0m[35m    if "curr_coreTmp_5_raw" in variables:[0m
[30;1m31 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_2_raw")[0m
[30;1m32 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_5_raw")[0m
[30;1m33 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_52_raw")[0m
[30;1m34 | [0m[35m    # If there is curr_coreTmp_0_raw, we have type 2[0m
[30;1m35 | [0m[35m    elif "curr_coreTmp_0_raw" in variables:[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/temperature.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    # Read WLAN temperatures[0m
[30;1m29 | [0m[35m    # If there is curr_coreTmp_5_raw, we have type 1[0m
[30;1m30 | [0m[35m    if "curr_coreTmp_5_raw" in variables:[0m
[30;1m31 | [0m[35m        temperature[Wlan.FREQ_2G] = variables.get("curr_coreTmp_2_raw")[0m
[30;1m32 | [0m[35m        temperature[Wlan.FREQ_5G] = variables.get("curr_coreTmp_5_raw")[0m
[30;1m33 | [0m[35m        temperature[Wlan.FREQ_5G2] = variables.get("curr_coreTmp_52_raw")[0m
[30;1m34 | [0m[35m    # If there is curr_coreTmp_0_raw, we have type 2[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m            "service": state.value,[0m
[30;1m205 | [0m[35m            "arguments": kwargs.get("arguments", {}),[0m
[30;1m206 | [0m[35m            "apply": True,[0m
[30;1m207 | [0m[35m            "expect_modify": kwargs.get("expect_modify", False),[0m
[30;1m208 | [0m[35m        },[0m
[30;1m209 | [0m[35m    )[0m
[30;1m210 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        state,[0m
[30;1m203 | [0m[35m        {[0m
[30;1m204 | [0m[35m            "service": state.value,[0m
[30;1m205 | [0m[35m            "arguments": kwargs.get("arguments", {}),[0m
[30;1m206 | [0m[35m            "apply": True,[0m
[30;1m207 | [0m[35m            "expect_modify": kwargs.get("expect_modify", False),[0m
[30;1m208 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m        state = repl_state[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m    # Get the arguments for the callback function based on the state[0m
[30;1m201 | [0m[35m    callback_args = STATE_MAP.get([0m
[30;1m202 | [0m[35m        state,[0m
[30;1m203 | [0m[35m        {[0m
[30;1m204 | [0m[35m            "service": state.value,[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m    START_WEBS_UPGRADE = ([0m
[30;1m126 | [0m[35m        "start_webs_upgrade"  # Start firmware upgrade from the web[0m
[30;1m127 | [0m[35m    )[0m
[30;1m128 | [0m[35m    START_WEBS_UPDATE = "start_webs_update"  # Check for firmware update[0m
[30;1m129 | [0m[35m    START_WRS = "start_wrs"[0m
[30;1m130 | [0m[35m    STOP_AURARGB = "stop_aurargb"  # Aura RGB[0m
[30;1m131 | [0m[35m    STOP_LOGGER = "stop_logger"[0m
[30;1m132 | [0m[35m    STOP_OPENVPND = "stop_openvpnd"  # Stop OpenVPN server[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m    RESTART_DNSMASQ = "restart_dnsmasq"  # DNS[0m
[30;1m74 | [0m[35m    RESTART_DNSQD = "restart_dnsqd"  #[0m
[30;1m75 | [0m[35m    RESTART_FIREWALL = "restart_firewall"  # Firewall[0m
[30;1m76 | [0m[35m    RESTART_FTPD = "restart_ftpd"  # FTP server[0m
[30;1m77 | [0m[35m    RESTART_FTPSAMBA = "restart_ftpsamba"[0m
[30;1m78 | [0m[35m    RESTART_HTTPD = "restart_httpd"  # Web server[0m
[30;1m79 | [0m[35m    RESTART_KEY_GUARD = "restart_key_guard"[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m47 | [0m[35m    AURA_RESTART = "restart_ledg"  # Restart Aura RGB[0m
[30;1m48 | [0m[35m    # ---------------------[0m
[30;1m49 | [0m[35m    # Firmware[0m
[30;1m50 | [0m[35m    FIRMWARE_CHECK = "firmware_check"  # Check for firmware update[0m
[30;1m51 | [0m[35m    # Firmware upgrade will upgrade the firmware to the latest version[0m
[30;1m52 | [0m[35m    # if available. The firmware file is downloaded from the Asus server.[0m
[30;1m53 | [0m[35m    # After the download, the router will reboot and install the firmware.[0m
[30;1m54 | [0m[35m    FIRMWARE_UPGRADE = "firmware_upgrade"  # Firmware upgrade[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m16 | [0m[35m    services depends on the router model and firmware version.[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    Some services might not be tested and might not work as expected. Use with[0m
[30;1m19 | [0m[35m    caution and at your own risk."""[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    # ---------------------[0m
[30;1m22 | [0m[35m    # DISCLAIMER: Migration to the new format[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m        },[0m
[30;1m209 | [0m[35m    )[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    # Run the service[0m
[30;1m212 | [0m[35m    return await callback(**callback_args)[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m}[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m# Map AsusSystem special cases to service calls[0m
[30;1m153 | [0m[35mSTATE_MAP: dict[AsusSystem, dict[str, Any]] = {[0m
[30;1m154 | [0m[35m    AsusSystem.AIMESH_REBOOT: {[0m
[30;1m155 | [0m[35m        "service": None,[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m    RESTART_NFCM = "restart_nfcm"[0m
[30;1m88 | [0m[35m    RESTART_OAM = "restart_oam"[0m
[30;1m89 | [0m[35m    RESTART_OPENVPND = "restart_openvpnd"  # OpenVPN daemon[0m
[30;1m90 | [0m[35m    RESTART_QOS = "restart_qos"  # Quality of Service (QoS)[0m
[30;1m91 | [0m[35m    RESTART_ROUTERBOOST = "restart_routerboost"[0m
[30;1m92 | [0m[35m    RESTART_SAMBA = "restart_samba"  # Samba file sharing[0m
[30;1m93 | [0m[35m    RESTART_SETTINGS_WEBDAV = "restart_settings_webdav"  # WebDAV[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m    RESTART_DNSMASQ = "restart_dnsmasq"  # DNS[0m
[30;1m74 | [0m[35m    RESTART_DNSQD = "restart_dnsqd"  #[0m
[30;1m75 | [0m[35m    RESTART_FIREWALL = "restart_firewall"  # Firewall[0m
[30;1m76 | [0m[35m    RESTART_FTPD = "restart_ftpd"  # FTP server[0m
[30;1m77 | [0m[35m    RESTART_FTPSAMBA = "restart_ftpsamba"[0m
[30;1m78 | [0m[35m    RESTART_HTTPD = "restart_httpd"  # Web server[0m
[30;1m79 | [0m[35m    RESTART_KEY_GUARD = "restart_key_guard"[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/system.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m    # The old format will be deprecated and removed in a future version.[0m
[30;1m31 | [0m[35m    # Please, only add new actions in the new format.[0m
[30;1m32 | [0m[35m    #[0m
[30;1m33 | [0m[35m    # All the old actions will be migrated to the new format with time[0m
[30;1m34 | [0m[35m    # (and updates in the corresponding modules). Any deprecated actions[0m
[30;1m35 | [0m[35m    # with a new format should be added to the `AsusSystemDeprecated` dict.[0m
[30;1m36 | [0m[35m    #[0m
[30;1m37 | [0m[35m    # Check the AiMesh for an example of the new format.[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wireguard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        (AsusWireGuardServer, AsusWireGuardServer.OFF): "restart_wgs;restart_dnsmasq",[0m
[30;1m73 | [0m[35m    }[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    service = service_map.get((type(state), state))[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    if not service:[0m
[30;1m78 | [0m[35m        _LOGGER.debug("Unknown state %s", state)[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wireguard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m    }[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    # Get the expect_modify argument[0m
[30;1m65 | [0m[35m    expect_modify = kwargs.get("expect_modify", False)[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    # Get the correct service call[0m
[30;1m68 | [0m[35m    service_map: dict[Any, str] = {[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wireguard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    arguments = kwargs.get("arguments", {})[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # Get the id from arguments[0m
[30;1m34 | [0m[35m    wlan_id = arguments.get("id") if arguments else kwargs.get("id")[0m
[30;1m35 | [0m[35m    if wlan_id is None:[0m
[30;1m36 | [0m[35m        wlan_id = 1[0m
[30;1m37 | [0m[35m        _LOGGER.debug("Using default id 1")[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wireguard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    arguments = kwargs.get("arguments", {})[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # Get the id from arguments[0m
[30;1m34 | [0m[35m    wlan_id = arguments.get("id") if arguments else kwargs.get("id")[0m
[30;1m35 | [0m[35m    if wlan_id is None:[0m
[30;1m36 | [0m[35m        wlan_id = 1[0m
[30;1m37 | [0m[35m        _LOGGER.debug("Using default id 1")[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wireguard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35mdef _get_arguments(**kwargs: Any) -> Optional[int]:[0m
[30;1m29 | [0m[35m    """Get the arguments from kwargs."""[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    arguments = kwargs.get("arguments", {})[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # Get the id from arguments[0m
[30;1m34 | [0m[35m    wlan_id = arguments.get("id") if arguments else kwargs.get("id")[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wireguard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m        _LOGGER.debug("Unknown state %s", state)[0m
[30;1m79 | [0m[35m        return False[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    # Call the service[0m
[30;1m82 | [0m[35m    return await callback([0m
[30;1m83 | [0m[35m        service=service,[0m
[30;1m84 | [0m[35m        arguments=callback_arguments,[0m
[30;1m85 | [0m[35m        apply=True,[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wireguard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        (AsusWireGuardServer, AsusWireGuardServer.OFF): "restart_wgs;restart_dnsmasq",[0m
[30;1m73 | [0m[35m    }[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    service = service_map.get((type(state), state))[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    if not service:[0m
[30;1m78 | [0m[35m        _LOGGER.debug("Unknown state %s", state)[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/wireguard.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m    # Get the expect_modify argument[0m
[30;1m65 | [0m[35m    expect_modify = kwargs.get("expect_modify", False)[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    # Get the correct service call[0m
[30;1m68 | [0m[35m    service_map: dict[Any, str] = {[0m
[30;1m69 | [0m[35m        (AsusWireGuardClient, AsusWireGuardClient.ON): f"start_wgc {wlan_id}",[0m
[30;1m70 | [0m[35m        (AsusWireGuardClient, AsusWireGuardClient.OFF): f"stop_wgc {wlan_id}",[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/sysinfo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    # Load average info[0m
[30;1m92 | [0m[35m    load_avg_info = {}[0m
[30;1m93 | [0m[35m    load_avg_data = data.get("cpu_stats_arr")[0m
[30;1m94 | [0m[35m    if load_avg_data:[0m
[30;1m95 | [0m[35m        load_avg_info = {[0m
[30;1m96 | [0m[35m            1: safe_float(load_avg_data[0]),[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/sysinfo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    # Memory info[0m
[30;1m58 | [0m[35m    memory_info = {}[0m
[30;1m59 | [0m[35m    memory_data = data.get("mem_stats_arr")[0m
[30;1m60 | [0m[35m    if memory_data:[0m
[30;1m61 | [0m[35m        # Before 388.7[0m
[30;1m62 | [0m[35m        # JFFS data is presented as a string of `XX.xx / YY.yy MB`[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/sysinfo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    # Connections info[0m
[30;1m48 | [0m[35m    connections_info = {}[0m
[30;1m49 | [0m[35m    connections_data = data.get("conn_stats_arr")[0m
[30;1m50 | [0m[35m    if connections_data:[0m
[30;1m51 | [0m[35m        connections_info = {[0m
[30;1m52 | [0m[35m            "total": safe_int(connections_data[0]),[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/sysinfo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    wlan_info = {}[0m
[30;1m36 | [0m[35m    i = 0[0m
[30;1m37 | [0m[35m    while wlan_data := data.get(f"wlc_{i}_arr"):[0m
[30;1m38 | [0m[35m        name = WLAN_TYPE.get(i, Wlan.UNKNOWN)[0m
[30;1m39 | [0m[35m        wlan_info[name] = {[0m
[30;1m40 | [0m[35m            "client_associated": safe_int(wlan_data[0]),[0m
[30;1m41 | [0m[35m            "client_authorized": safe_int(wlan_data[1]),[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/sysinfo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m    # WLAN info[0m
[30;1m35 | [0m[35m    wlan_info = {}[0m
[30;1m36 | [0m[35m    i = 0[0m
[30;1m37 | [0m[35m    while wlan_data := data.get(f"wlc_{i}_arr"):[0m
[30;1m38 | [0m[35m        name = WLAN_TYPE.get(i, Wlan.UNKNOWN)[0m
[30;1m39 | [0m[35m        wlan_info[name] = {[0m
[30;1m40 | [0m[35m            "client_associated": safe_int(wlan_data[0]),[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    vpn: dict[AsusData, Any] = {[0m
[30;1m164 | [0m[35m        AsusData.OPENVPN_CLIENT: data.get("client"),[0m
[30;1m165 | [0m[35m        AsusData.OPENVPN_SERVER: data.get("server"),[0m
[30;1m166 | [0m[35m    }[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    return vpn[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m    """Process VPN data."""[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    vpn: dict[AsusData, Any] = {[0m
[30;1m164 | [0m[35m        AsusData.OPENVPN_CLIENT: data.get("client"),[0m
[30;1m165 | [0m[35m        AsusData.OPENVPN_SERVER: data.get("server"),[0m
[30;1m166 | [0m[35m    }[0m
[30;1m167 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m                    vpn[party][num][add_key] = search_value[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m            # Read remote[0m
[30;1m57 | [0m[35m            search_value = vpn[party][num].get("remote")[0m
[30;1m58 | [0m[35m            if search_value:[0m
[30;1m59 | [0m[35m                vpn[party][num]["remote"] = read_ovpn_remote(search_value)[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m            # Read additional data[0m
[30;1m51 | [0m[35m            for add_key in ("ip", "rip"):[0m
[30;1m52 | [0m[35m                search_value = values.get(f"vpn_{party}{num}_{add_key}")[0m
[30;1m53 | [0m[35m                if search_value and search_value not in _TO_IGNORE:[0m
[30;1m54 | [0m[35m                    vpn[party][num][add_key] = search_value[0m
[30;1m55 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m                if not value:[0m
[30;1m145 | [0m[35m                    break[0m
[30;1m146 | [0m[35m                if flag:[0m
[30;1m147 | [0m[35m                    cut = value[1].split(",")[0m
[30;1m148 | [0m[35m                    array = {k: v for k, v in zip(keys, cut)}[0m
[30;1m149 | [0m[35m                    ovpn_server[key_new].append(array)[0m
[30;1m150 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m            content = content.replace(f"HEADER,{key_old},", "USED-")[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m            ovpn_server[key_new] = [][0m
[30;1m142 | [0m[35m            # Find values[0m
[30;1m143 | [0m[35m            while value := re.search(f"{key_old},(.*?)(?=>)", content):[0m
[30;1m144 | [0m[35m                if not value:[0m
[30;1m145 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/vpn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m        if key_old in content:[0m
[30;1m128 | [0m[35m            flag = False[0m
[30;1m129 | [0m[35m            keys = [][0m
[30;1m130 | [0m[35m            # Find headers[0m
[30;1m131 | [0m[35m            header = re.search(f"HEADER,{key_old},(.*?)(?=>)", content)[0m
[30;1m132 | [0m[35m            if header:[0m
[30;1m133 | [0m[35m                keys_raw = header[1].split(",")[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    temp = data.split("_")[0m
[30;1m158 | [0m[35m    return {[0m
[30;1m159 | [0m[35m        "connection_type": CONNECTION_TYPE.get(temp[0]) or 0,[0m
[30;1m160 | [0m[35m        "guest": safe_int(temp[1], 0) if len(temp) > 1 else 0,[0m
[30;1m161 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m        parent=parent,[0m
[30;1m141 | [0m[35m        type=node_type,[0m
[30;1m142 | [0m[35m        level=level,[0m
[30;1m143 | [0m[35m        config=data.get("config"),[0m
[30;1m144 | [0m[35m    )[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m        ip=data.get("ip"),[0m
[30;1m136 | [0m[35m        fw=data.get("fwver", None),[0m
[30;1m137 | [0m[35m        fw_new=safe_return(data.get("newfwver")),[0m
[30;1m138 | [0m[35m        mac=data.get("mac", None),[0m
[30;1m139 | [0m[35m        ap=ap,[0m
[30;1m140 | [0m[35m        parent=parent,[0m
[30;1m141 | [0m[35m        type=node_type,[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m        product_id=data.get("product_id"),[0m
[30;1m135 | [0m[35m        ip=data.get("ip"),[0m
[30;1m136 | [0m[35m        fw=data.get("fwver", None),[0m
[30;1m137 | [0m[35m        fw_new=safe_return(data.get("newfwver")),[0m
[30;1m138 | [0m[35m        mac=data.get("mac", None),[0m
[30;1m139 | [0m[35m        ap=ap,[0m
[30;1m140 | [0m[35m        parent=parent,[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m        model=data.get("ui_model_name", data.get("model_name", None)),[0m
[30;1m134 | [0m[35m        product_id=data.get("product_id"),[0m
[30;1m135 | [0m[35m        ip=data.get("ip"),[0m
[30;1m136 | [0m[35m        fw=data.get("fwver", None),[0m
[30;1m137 | [0m[35m        fw_new=safe_return(data.get("newfwver")),[0m
[30;1m138 | [0m[35m        mac=data.get("mac", None),[0m
[30;1m139 | [0m[35m        ap=ap,[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m        alias=data.get("alias", None),[0m
[30;1m133 | [0m[35m        model=data.get("ui_model_name", data.get("model_name", None)),[0m
[30;1m134 | [0m[35m        product_id=data.get("product_id"),[0m
[30;1m135 | [0m[35m        ip=data.get("ip"),[0m
[30;1m136 | [0m[35m        fw=data.get("fwver", None),[0m
[30;1m137 | [0m[35m        fw_new=safe_return(data.get("newfwver")),[0m
[30;1m138 | [0m[35m        mac=data.get("mac", None),[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m        status=safe_bool(data.get("online", 0)) or False,[0m
[30;1m132 | [0m[35m        alias=data.get("alias", None),[0m
[30;1m133 | [0m[35m        model=data.get("ui_model_name", data.get("model_name", None)),[0m
[30;1m134 | [0m[35m        product_id=data.get("product_id"),[0m
[30;1m135 | [0m[35m        ip=data.get("ip"),[0m
[30;1m136 | [0m[35m        fw=data.get("fwver", None),[0m
[30;1m137 | [0m[35m        fw_new=safe_return(data.get("newfwver")),[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m    return AiMeshDevice([0m
[30;1m131 | [0m[35m        status=safe_bool(data.get("online", 0)) or False,[0m
[30;1m132 | [0m[35m        alias=data.get("alias", None),[0m
[30;1m133 | [0m[35m        model=data.get("ui_model_name", data.get("model_name", None)),[0m
[30;1m134 | [0m[35m        product_id=data.get("product_id"),[0m
[30;1m135 | [0m[35m        ip=data.get("ip"),[0m
[30;1m136 | [0m[35m        fw=data.get("fwver", None),[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m    return AiMeshDevice([0m
[30;1m131 | [0m[35m        status=safe_bool(data.get("online", 0)) or False,[0m
[30;1m132 | [0m[35m        alias=data.get("alias", None),[0m
[30;1m133 | [0m[35m        model=data.get("ui_model_name", data.get("model_name", None)),[0m
[30;1m134 | [0m[35m        product_id=data.get("product_id"),[0m
[30;1m135 | [0m[35m        ip=data.get("ip"),[0m
[30;1m136 | [0m[35m        fw=data.get("fwver", None),[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    return AiMeshDevice([0m
[30;1m131 | [0m[35m        status=safe_bool(data.get("online", 0)) or False,[0m
[30;1m132 | [0m[35m        alias=data.get("alias", None),[0m
[30;1m133 | [0m[35m        model=data.get("ui_model_name", data.get("model_name", None)),[0m
[30;1m134 | [0m[35m        product_id=data.get("product_id"),[0m
[30;1m135 | [0m[35m        ip=data.get("ip"),[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m    node_type = "router" if level == 0 else "node"[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    return AiMeshDevice([0m
[30;1m131 | [0m[35m        status=safe_bool(data.get("online", 0)) or False,[0m
[30;1m132 | [0m[35m        alias=data.get("alias", None),[0m
[30;1m133 | [0m[35m        model=data.get("ui_model_name", data.get("model_name", None)),[0m
[30;1m134 | [0m[35m        product_id=data.get("product_id"),[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m            # Stop the loop since we found the parent[0m
[30;1m125 | [0m[35m            break[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    level = safe_int(data.get("level", "0"))[0m
[30;1m128 | [0m[35m    node_type = "router" if level == 0 else "node"[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    return AiMeshDevice([0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m            parent["connection"] = CONST_AP[el][0m
[30;1m120 | [0m[35m            parent["mac"] = data[f"pap{el}"][0m
[30;1m121 | [0m[35m            parent["rssi"] = safe_return(data.get(f"rssi{el}"))[0m
[30;1m122 | [0m[35m            parent["ssid"] = safe_return(data.get(f"pap{el}_ssid"))[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m            # Stop the loop since we found the parent[0m
[30;1m125 | [0m[35m            break[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        if f"pap{el}" in data and data[f"pap{el}"] is not str():[0m
[30;1m119 | [0m[35m            parent["connection"] = CONST_AP[el][0m
[30;1m120 | [0m[35m            parent["mac"] = data[f"pap{el}"][0m
[30;1m121 | [0m[35m            parent["rssi"] = safe_return(data.get(f"rssi{el}"))[0m
[30;1m122 | [0m[35m            parent["ssid"] = safe_return(data.get(f"pap{el}_ssid"))[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m            # Stop the loop since we found the parent[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m                    "mac": mac,[0m
[30;1m93 | [0m[35m                    "node": node,[0m
[30;1m94 | [0m[35m                    "online": True,[0m
[30;1m95 | [0m[35m                    "rssi": client_list[node][connection][mac].get([0m
[30;1m96 | [0m[35m                        "rssi", None[0m
[30;1m97 | [0m[35m                    ),[0m
[30;1m98 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m                    "connection_type": convert.get("connection_type"),[0m
[30;1m88 | [0m[35m                    "guest": convert.get("guest"),[0m
[30;1m89 | [0m[35m                    "ip": safe_return([0m
[30;1m90 | [0m[35m                        client_list[node][connection][mac].get("ip", None)[0m
[30;1m91 | [0m[35m                    ),[0m
[30;1m92 | [0m[35m                    "mac": mac,[0m
[30;1m93 | [0m[35m                    "node": node,[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m            for mac in client_list[node][connection]:[0m
[30;1m86 | [0m[35m                description = {[0m
[30;1m87 | [0m[35m                    "connection_type": convert.get("connection_type"),[0m
[30;1m88 | [0m[35m                    "guest": convert.get("guest"),[0m
[30;1m89 | [0m[35m                    "ip": safe_return([0m
[30;1m90 | [0m[35m                        client_list[node][connection][mac].get("ip", None)[0m
[30;1m91 | [0m[35m                    ),[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m            convert = process_connection(connection)[0m
[30;1m85 | [0m[35m            for mac in client_list[node][connection]:[0m
[30;1m86 | [0m[35m                description = {[0m
[30;1m87 | [0m[35m                    "connection_type": convert.get("connection_type"),[0m
[30;1m88 | [0m[35m                    "guest": convert.get("guest"),[0m
[30;1m89 | [0m[35m                    "ip": safe_return([0m
[30;1m90 | [0m[35m                        client_list[node][connection][mac].get("ip", None)[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    # Client list[0m
[30;1m80 | [0m[35m    clients = {}[0m
[30;1m81 | [0m[35m    client_list = data.get("get_allclientlist", [{}])[0][0m
[30;1m82 | [0m[35m    for node in client_list:[0m
[30;1m83 | [0m[35m        for connection in client_list[node]:[0m
[30;1m84 | [0m[35m            convert = process_connection(connection)[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    # AiMesh nodes state[0m
[30;1m73 | [0m[35m    state[AsusData.AIMESH] = {[0m
[30;1m74 | [0m[35m        node.mac: node[0m
[30;1m75 | [0m[35m        for device in data.get("get_cfg_clientlist", [[]])[0][0m
[30;1m76 | [0m[35m        for node in [process_aimesh_node(device)][0m
[30;1m77 | [0m[35m    }[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35mdef process_aimesh_node(data: dict[str, Any]) -> AiMeshDevice:[0m
[30;1m107 | [0m[35m    """Process AiMesh node data."""[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    # Get the list of WLAN APs[0m
[30;1m110 | [0m[35m    ap = {}[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m    # Client list[0m
[30;1m80 | [0m[35m    clients = {}[0m
[30;1m81 | [0m[35m    client_list = data.get("get_allclientlist", [{}])[0][0m
[30;1m82 | [0m[35m    for node in client_list:[0m
[30;1m83 | [0m[35m        for connection in client_list[node]:[0m
[30;1m84 | [0m[35m            convert = process_connection(connection)[0m
[30;1m85 | [0m[35m            for mac in client_list[node][connection]:[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m    state[AsusData.AIMESH] = {[0m
[30;1m74 | [0m[35m        node.mac: node[0m
[30;1m75 | [0m[35m        for device in data.get("get_cfg_clientlist", [[]])[0][0m
[30;1m76 | [0m[35m        for node in [process_aimesh_node(device)][0m
[30;1m77 | [0m[35m    }[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    # Client list[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/onboarding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    # AiMesh nodes state[0m
[30;1m73 | [0m[35m    state[AsusData.AIMESH] = {[0m
[30;1m74 | [0m[35m        node.mac: node[0m
[30;1m75 | [0m[35m        for device in data.get("get_cfg_clientlist", [[]])[0][0m
[30;1m76 | [0m[35m        for node in [process_aimesh_node(device)][0m
[30;1m77 | [0m[35m    }[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m        if port_state is True:[0m
[30;1m138 | [0m[35m            modem = True[0m
[30;1m139 | [0m[35m        # If any other device is connected, mark as connected[0m
[30;1m140 | [0m[35m        port_devices = values.get("devices")[0m
[30;1m141 | [0m[35m        if port_devices is not None:[0m
[30;1m142 | [0m[35m            port_state = True[0m
[30;1m143 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m            port_type = PortType.SFPP[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    # Port state[0m
[30;1m131 | [0m[35m    port_state = safe_bool(values.get("is_on"))[0m
[30;1m132 | [0m[35m    # For USB ports, the state is 1 only when a modem is connected[0m
[30;1m133 | [0m[35m    modem = False[0m
[30;1m134 | [0m[35m    port_devices = None[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    # Special ports[0m
[30;1m126 | [0m[35m    if max_rate == PortSpeed.LINK_10000:[0m
[30;1m127 | [0m[35m        if port_capabilities.get(PortCapability.SFPP) is True:[0m
[30;1m128 | [0m[35m            port_type = PortType.SFPP[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    # Port state[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    # Get the rates. Set to 0 if not available[0m
[30;1m110 | [0m[35m    link_rate = safe_int(values.get("link_rate"), default=0)[0m
[30;1m111 | [0m[35m    max_rate = safe_int(values.get("max_rate"), default=0)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    if link_enum is not None:[0m
[30;1m114 | [0m[35m        link_rate = get_enum_key_by_value([0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    link_enum: Any = PORT_TYPE2LINK.get(port_type)[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    # Get the rates. Set to 0 if not available[0m
[30;1m110 | [0m[35m    link_rate = safe_int(values.get("link_rate"), default=0)[0m
[30;1m111 | [0m[35m    max_rate = safe_int(values.get("max_rate"), default=0)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    if link_enum is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m            break[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    # Get the correct link enum[0m
[30;1m107 | [0m[35m    link_enum: Any = PORT_TYPE2LINK.get(port_type)[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    # Get the rates. Set to 0 if not available[0m
[30;1m110 | [0m[35m    link_rate = safe_int(values.get("link_rate"), default=0)[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m    # Get the port type[0m
[30;1m100 | [0m[35m    port_type = PortType.UNKNOWN[0m
[30;1m101 | [0m[35m    for pcap, ptype in PORT_CAP2TYPE.items():[0m
[30;1m102 | [0m[35m        if port_capabilities.get(pcap) is True:[0m
[30;1m103 | [0m[35m            port_type = ptype[0m
[30;1m104 | [0m[35m            break[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    # Get the capabilities of the port[0m
[30;1m95 | [0m[35m    port_capabilities = int_as_capabilities([0m
[30;1m96 | [0m[35m        safe_int(values.get("cap")), PortCapability[0m
[30;1m97 | [0m[35m    )[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    # Get the port type[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35mdef process_node_info(data: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m68 | [0m[35m    """Process node info data."""[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    node_info = data.get("node_info", {})[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    if not node_info:[0m
[30;1m73 | [0m[35m        return {}[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    state[AsusData.NODE_INFO] = process_node_info(data)[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    # Port info[0m
[30;1m44 | [0m[35m    port_info = data.get("port_info", {})[0m
[30;1m45 | [0m[35m    if port_info:[0m
[30;1m46 | [0m[35m        for mac, info in port_info.items():[0m
[30;1m47 | [0m[35m            ports[mac] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m    nodes = {}[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    for mac, info in node_info.items():[0m
[30;1m78 | [0m[35m        # Save the node info[0m
[30;1m79 | [0m[35m        nodes[mac] = info[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    return nodes[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mdef process_node_info(data: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m68 | [0m[35m    """Process node info data."""[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    node_info = data.get("node_info", {})[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/port_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    state: dict[AsusData, Any] = {}[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    # Node info[0m
[30;1m41 | [0m[35m    state[AsusData.NODE_INFO] = process_node_info(data)[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    # Port info[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/ethernet_ports.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # Get the port id and link rate[0m
[30;1m64 | [0m[35m        port_id = safe_int(port[3:])[0m
[30;1m65 | [0m[35m        link_rate = PORT_SPEED.get(value)[0m
[30;1m66 | [0m[35m        # Save the port info[0m
[30;1m67 | [0m[35m        ports[port_type][port_id] = {[0m
[30;1m68 | [0m[35m            "state": link_rate not in (PortSpeed.LINK_DOWN, PortSpeed.UNKNOWN),[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/ethernet_ports.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        PortType.WAN: {},[0m
[30;1m34 | [0m[35m    }[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    port_speed = data.get("portSpeed")[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    if port_speed is None:[0m
[30;1m39 | [0m[35m        return {[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/port_forwarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        service=service,[0m
[30;1m54 | [0m[35m        arguments=arguments,[0m
[30;1m55 | [0m[35m        apply=True,[0m
[30;1m56 | [0m[35m        expect_modify=kwargs.get("expect_modify", False),[0m
[30;1m57 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/port_forwarding.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m    state: AsusPortForwarding,[0m
[30;1m37 | [0m[35m    **kwargs: Any,[0m
[30;1m38 | [0m[35m) -> bool:[0m
[30;1m39 | [0m[35m    """Set the parental control state."""[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    # Check if state is available and valid[0m
[30;1m42 | [0m[35m    if not isinstance(state, AsusPortForwarding) or not state.value in (0, 1):[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/port_forwarding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    # Get the correct service call[0m
[30;1m49 | [0m[35m    service = "restart_firewall"[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # Call the service[0m
[30;1m52 | [0m[35m    return await callback([0m
[30;1m53 | [0m[35m        service=service,[0m
[30;1m54 | [0m[35m        arguments=arguments,[0m
[30;1m55 | [0m[35m        apply=True,[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/port_forwarding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m    arguments = {KEY_PORT_FORWARDING_STATE: 1 if state == AsusPortForwarding.ON else 0}[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    # Get the correct service call[0m
[30;1m49 | [0m[35m    service = "restart_firewall"[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # Call the service[0m
[30;1m52 | [0m[35m    return await callback([0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/port_forwarding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    arguments = {KEY_PORT_FORWARDING_STATE: 1 if state == AsusPortForwarding.ON else 0}[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    # Get the correct service call[0m
[30;1m49 | [0m[35m    service = "restart_firewall"[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # Call the service[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    }[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    # Check the current firmware[0m
[30;1m80 | [0m[35m    _current = data.get("firmware")[0m
[30;1m81 | [0m[35m    firmware["current"] = _current[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    # Check if the stable firmware is available[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m            "flag": safe_int(data.get("sig_state_flag")),[0m
[30;1m73 | [0m[35m        },[0m
[30;1m74 | [0m[35m        "hndwr": {[0m
[30;1m75 | [0m[35m            "status": safe_int(data.get("hndwr_status")),[0m
[30;1m76 | [0m[35m        },[0m
[30;1m77 | [0m[35m    }[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m            "upgrade": safe_int(data.get("sig_state_upgrade")),[0m
[30;1m70 | [0m[35m            "version": clean_string(data.get("sig_ver")),[0m
[30;1m71 | [0m[35m            "error": safe_int(data.get("sig_state_error")),[0m
[30;1m72 | [0m[35m            "flag": safe_int(data.get("sig_state_flag")),[0m
[30;1m73 | [0m[35m        },[0m
[30;1m74 | [0m[35m        "hndwr": {[0m
[30;1m75 | [0m[35m            "status": safe_int(data.get("hndwr_status")),[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m            "update": safe_int(data.get("sig_state_update")),[0m
[30;1m69 | [0m[35m            "upgrade": safe_int(data.get("sig_state_upgrade")),[0m
[30;1m70 | [0m[35m            "version": clean_string(data.get("sig_ver")),[0m
[30;1m71 | [0m[35m            "error": safe_int(data.get("sig_state_error")),[0m
[30;1m72 | [0m[35m            "flag": safe_int(data.get("sig_state_flag")),[0m
[30;1m73 | [0m[35m        },[0m
[30;1m74 | [0m[35m        "hndwr": {[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        "sig": {[0m
[30;1m68 | [0m[35m            "update": safe_int(data.get("sig_state_update")),[0m
[30;1m69 | [0m[35m            "upgrade": safe_int(data.get("sig_state_upgrade")),[0m
[30;1m70 | [0m[35m            "version": clean_string(data.get("sig_ver")),[0m
[30;1m71 | [0m[35m            "error": safe_int(data.get("sig_state_error")),[0m
[30;1m72 | [0m[35m            "flag": safe_int(data.get("sig_state_flag")),[0m
[30;1m73 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        },[0m
[30;1m67 | [0m[35m        "sig": {[0m
[30;1m68 | [0m[35m            "update": safe_int(data.get("sig_state_update")),[0m
[30;1m69 | [0m[35m            "upgrade": safe_int(data.get("sig_state_upgrade")),[0m
[30;1m70 | [0m[35m            "version": clean_string(data.get("sig_ver")),[0m
[30;1m71 | [0m[35m            "error": safe_int(data.get("sig_state_error")),[0m
[30;1m72 | [0m[35m            "flag": safe_int(data.get("sig_state_flag")),[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m            "upgrade": safe_int(data.get("cfg_upgrade")),[0m
[30;1m66 | [0m[35m        },[0m
[30;1m67 | [0m[35m        "sig": {[0m
[30;1m68 | [0m[35m            "update": safe_int(data.get("sig_state_update")),[0m
[30;1m69 | [0m[35m            "upgrade": safe_int(data.get("sig_state_upgrade")),[0m
[30;1m70 | [0m[35m            "version": clean_string(data.get("sig_ver")),[0m
[30;1m71 | [0m[35m            "error": safe_int(data.get("sig_state_error")),[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        },[0m
[30;1m63 | [0m[35m        "cfg": {[0m
[30;1m64 | [0m[35m            "check": safe_int(data.get("cfg_check")),[0m
[30;1m65 | [0m[35m            "upgrade": safe_int(data.get("cfg_upgrade")),[0m
[30;1m66 | [0m[35m        },[0m
[30;1m67 | [0m[35m        "sig": {[0m
[30;1m68 | [0m[35m            "update": safe_int(data.get("sig_state_update")),[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m            "level": safe_int(data.get("webs_state_level")),[0m
[30;1m62 | [0m[35m        },[0m
[30;1m63 | [0m[35m        "cfg": {[0m
[30;1m64 | [0m[35m            "check": safe_int(data.get("cfg_check")),[0m
[30;1m65 | [0m[35m            "upgrade": safe_int(data.get("cfg_upgrade")),[0m
[30;1m66 | [0m[35m        },[0m
[30;1m67 | [0m[35m        "sig": {[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m                safe_int(data.get("webs_state_flag")),[0m
[30;1m59 | [0m[35m                default_value=UNKNOWN_MEMBER,[0m
[30;1m60 | [0m[35m            ),[0m
[30;1m61 | [0m[35m            "level": safe_int(data.get("webs_state_level")),[0m
[30;1m62 | [0m[35m        },[0m
[30;1m63 | [0m[35m        "cfg": {[0m
[30;1m64 | [0m[35m            "check": safe_int(data.get("cfg_check")),[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m            ),[0m
[30;1m56 | [0m[35m            "flag": safe_enum([0m
[30;1m57 | [0m[35m                WebsFlag,[0m
[30;1m58 | [0m[35m                safe_int(data.get("webs_state_flag")),[0m
[30;1m59 | [0m[35m                default_value=UNKNOWN_MEMBER,[0m
[30;1m60 | [0m[35m            ),[0m
[30;1m61 | [0m[35m            "level": safe_int(data.get("webs_state_level")),[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m            "required": Firmware(data.get("webs_state_REQinfo", "")).safe(),[0m
[30;1m51 | [0m[35m            "error": safe_enum([0m
[30;1m52 | [0m[35m                WebsError,[0m
[30;1m53 | [0m[35m                safe_int(data.get("webs_state_error")),[0m
[30;1m54 | [0m[35m                default_value=UNKNOWN_MEMBER,[0m
[30;1m55 | [0m[35m            ),[0m
[30;1m56 | [0m[35m            "flag": safe_enum([0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m            ),[0m
[30;1m48 | [0m[35m            "available": _available,[0m
[30;1m49 | [0m[35m            "available_beta": _available_beta,[0m
[30;1m50 | [0m[35m            "required": Firmware(data.get("webs_state_REQinfo", "")).safe(),[0m
[30;1m51 | [0m[35m            "error": safe_enum([0m
[30;1m52 | [0m[35m                WebsError,[0m
[30;1m53 | [0m[35m                safe_int(data.get("webs_state_error")),[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m            ),[0m
[30;1m43 | [0m[35m            "upgrade": safe_enum([0m
[30;1m44 | [0m[35m                WebsUpgrade,[0m
[30;1m45 | [0m[35m                safe_int(data.get("webs_state_upgrade")),[0m
[30;1m46 | [0m[35m                default=WebsUpgrade.INACTIVE,[0m
[30;1m47 | [0m[35m            ),[0m
[30;1m48 | [0m[35m            "available": _available,[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        "webs": {[0m
[30;1m38 | [0m[35m            "update": safe_enum([0m
[30;1m39 | [0m[35m                WebsUpdate,[0m
[30;1m40 | [0m[35m                safe_int(data.get("webs_state_update")),[0m
[30;1m41 | [0m[35m                default=WebsUpdate.UNKNOWN,[0m
[30;1m42 | [0m[35m            ),[0m
[30;1m43 | [0m[35m            "upgrade": safe_enum([0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    # Stay on the safe side with Enums[0m
[30;1m26 | [0m[35m    # since the endpoint can provide empty strings[0m
[30;1m27 | [0m[35m    _available = Firmware(data.get("webs_state_info", "")).safe()[0m
[30;1m28 | [0m[35m    _available_beta = Firmware(data.get("webs_state_info_beta", "")).safe()[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # Load all the static data[0m
[30;1m31 | [0m[35m    firmware: dict[str, Any] = {[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/firmware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    # Stay on the safe side with Enums[0m
[30;1m26 | [0m[35m    # since the endpoint can provide empty strings[0m
[30;1m27 | [0m[35m    _available = Firmware(data.get("webs_state_info", "")).safe()[0m
[30;1m28 | [0m[35m    _available_beta = Firmware(data.get("webs_state_info_beta", "")).safe()[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # Load all the static data[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m    """Extract value from the data dict and update the data dict."""[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    # Get the value[0m
[30;1m170 | [0m[35m    value = data.get(key, None)[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    # Remove the value from the data dict[0m
[30;1m173 | [0m[35m    data.pop(key, None)[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35mdef data_get(data: dict[str, Any], key: str) -> Optional[Any]:[0m
[30;1m167 | [0m[35m    """Extract value from the data dict and update the data dict."""[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    # Get the value[0m
[30;1m170 | [0m[35m    value = data.get(key, None)[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m66 | [0m[35mclass EndpointNoCheck(str, Enum):[0m
[30;1m67 | [0m[35m    """Endpoints that should not be checked for availability."""[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    # AURA control / RGB[0m
[30;1m70 | [0m[35m    AURA = "set_ledg.cgi"[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35mclass EndpointTools(str, Enum):[0m
[30;1m58 | [0m[35m    """Tools endpoints."""[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    # AURA control / RGB[0m
[30;1m61 | [0m[35m    AURA = "set_ledg.cgi"[0m
[30;1m62 | [0m[35m    # Network tools: ping, jitter, loss[0m
[30;1m63 | [0m[35m    NETWORK = "netool.cgi"[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    # Try again later error[0m
[30;1m58 | [0m[35m    if error == AccessError.TRY_AGAIN:[0m
[30;1m59 | [0m[35m        timeout = message.get("remaining_lock_time")[0m
[30;1m60 | [0m[35m        if timeout:[0m
[30;1m61 | [0m[35m            attributes["timeout"] = int(timeout)[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/error.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    _LOGGER.debug("Access error message: %s", message)[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    # Get error code[0m
[30;1m44 | [0m[35m    error_status = int(message.get("error_status") or -999)[0m
[30;1m45 | [0m[35m    try:[0m
[30;1m46 | [0m[35m        error = AccessError(error_status)[0m
[30;1m47 | [0m[35m    except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/error.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    # Try again later error[0m
[30;1m58 | [0m[35m    if error == AccessError.TRY_AGAIN:[0m
[30;1m59 | [0m[35m        timeout = message.get("remaining_lock_time")[0m
[30;1m60 | [0m[35m        if timeout:[0m
[30;1m61 | [0m[35m            attributes["timeout"] = int(timeout)[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aimesh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    ap: dict[str, Any] | None = None[0m
[30;1m28 | [0m[35m    # Parent AiMesh: pap2g, rssi2g, pap2g_ssid, pap5g, rssi5g, pap5g_ssid, pap6g, rssi6g, pap6g_ssid[0m
[30;1m29 | [0m[35m    parent: dict[str, Any] | None = None[0m
[30;1m30 | [0m[35m    # Node state[0m
[30;1m31 | [0m[35m    type: str | None = None[0m
[30;1m32 | [0m[35m    level: int | None = None[0m
[30;1m33 | [0m[35m    config: dict[str, Any] | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/converters.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m        if not isinstance(arg, str):[0m
[30;1m106 | [0m[35m            continue[0m
[30;1m107 | [0m[35m        # Get the arg and save to found_args[0m
[30;1m108 | [0m[35m        arg_value = arguments.get(arg) if arguments else kwargs.get(arg)[0m
[30;1m109 | [0m[35m        found_args.append(arg_value)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    if len(found_args) == 1:[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/converters.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m        if not isinstance(arg, str):[0m
[30;1m106 | [0m[35m            continue[0m
[30;1m107 | [0m[35m        # Get the arg and save to found_args[0m
[30;1m108 | [0m[35m        arg_value = arguments.get(arg) if arguments else kwargs.get(arg)[0m
[30;1m109 | [0m[35m        found_args.append(arg_value)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    if len(found_args) == 1:[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/converters.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m    if not isinstance(args, tuple):[0m
[30;1m97 | [0m[35m        args = (args,)[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    arguments = kwargs.get("arguments", {})[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    found_args: list[Optional[Any]] = [][0m
[30;1m102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/converters.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35mdef safe_time_from_delta(content: str) -> datetime:[0m
[30;1m434 | [0m[35m    """Transform time delta to the date in the past."""[0m
[30;1m435 | [0m[35m[0m
[30;1m436 | [0m[35m    return datetime.now(timezone.utc).replace([0m
[30;1m437 | [0m[35m        microsecond=0, tzinfo=timezone.utc[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/converters.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m    diff = current - previous if current > previous else 0.0[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m    return diff / time_delta[0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35mdef safe_time_from_delta(content: str) -> datetime:[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/converters.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m425 | [0m[35m    if time_delta is None or time_delta == 0.0:[0m
[30;1m426 | [0m[35m        return 0.0[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m    diff = current - previous if current > previous else 0.0[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m    return diff / time_delta[0m
[30;1m431 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/__main__.py[0m
   Pattern: [32m.hostname[0m
[30;1m72 | [0m[35m        "--host",[0m
[30;1m73 | [0m[35m        type=str,[0m
[30;1m74 | [0m[35m        required=True,[0m
[30;1m75 | [0m[35m        help="The hostname / ip address of the router.",[0m
[30;1m76 | [0m[35m    )[0m
[30;1m77 | [0m[35m    parser.add_argument([0m
[30;1m78 | [0m[35m        "-u",[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/__main__.py[0m
   Pattern: [32m.hostname[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m            # Create the router[0m
[30;1m27 | [0m[35m            router = AsusRouter([0m
[30;1m28 | [0m[35m                hostname=args.host,[0m
[30;1m29 | [0m[35m                username=args.username,[0m
[30;1m30 | [0m[35m                password=args.password,[0m
[30;1m31 | [0m[35m                use_ssl=args.ssl,[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        "--host",[0m
[30;1m73 | [0m[35m        type=str,[0m
[30;1m74 | [0m[35m        required=True,[0m
[30;1m75 | [0m[35m        help="The hostname / ip address of the router.",[0m
[30;1m76 | [0m[35m    )[0m
[30;1m77 | [0m[35m    parser.add_argument([0m
[30;1m78 | [0m[35m        "-u",[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m945 | [0m[35m        ) as mock_new_session:[0m
[30;1m946 | [0m[35m            # Create a Connection[0m
[30;1m947 | [0m[35m            connection = Connection([0m
[30;1m948 | [0m[35m                hostname="localhost",[0m
[30;1m949 | [0m[35m                username="user",[0m
[30;1m950 | [0m[35m                password="pass",[0m
[30;1m951 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m904 | [0m[35m        ) as mock_new_session:[0m
[30;1m905 | [0m[35m            # Create a Connection[0m
[30;1m906 | [0m[35m            connection = Connection([0m
[30;1m907 | [0m[35m                hostname="localhost",[0m
[30;1m908 | [0m[35m                username="user",[0m
[30;1m909 | [0m[35m                password="pass",[0m
[30;1m910 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m        # Create a Connection[0m
[30;1m804 | [0m[35m        connection = Connection([0m
[30;1m805 | [0m[35m            hostname="localhost",[0m
[30;1m806 | [0m[35m            username="user",[0m
[30;1m807 | [0m[35m            password="pass",[0m
[30;1m808 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m677 | [0m[35m[0m
[30;1m678 | [0m[35m        # Create a Connection[0m
[30;1m679 | [0m[35m        connection = Connection([0m
[30;1m680 | [0m[35m            hostname="localhost",[0m
[30;1m681 | [0m[35m            username="user",[0m
[30;1m682 | [0m[35m            password="pass",[0m
[30;1m683 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m        # Create a Connection[0m
[30;1m531 | [0m[35m        connection = Connection([0m
[30;1m532 | [0m[35m            hostname="localhost",[0m
[30;1m533 | [0m[35m            username="user",[0m
[30;1m534 | [0m[35m            password="pass",[0m
[30;1m535 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m        # Create a Connection[0m
[30;1m448 | [0m[35m        connection = Connection([0m
[30;1m449 | [0m[35m            hostname="localhost",[0m
[30;1m450 | [0m[35m            username="user",[0m
[30;1m451 | [0m[35m            password="pass",[0m
[30;1m452 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m        # Create a Connection[0m
[30;1m357 | [0m[35m        connection = Connection([0m
[30;1m358 | [0m[35m            hostname="localhost",[0m
[30;1m359 | [0m[35m            username="user",[0m
[30;1m360 | [0m[35m            password="pass",[0m
[30;1m361 | [0m[35m            timeout=30,[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m        # Create a Connection[0m
[30;1m324 | [0m[35m        connection = Connection([0m
[30;1m325 | [0m[35m            hostname="localhost",[0m
[30;1m326 | [0m[35m            username="user",[0m
[30;1m327 | [0m[35m            password="pass",[0m
[30;1m328 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        # Create a Connection[0m
[30;1m285 | [0m[35m        connection = Connection([0m
[30;1m286 | [0m[35m            hostname="localhost",[0m
[30;1m287 | [0m[35m            username="user",[0m
[30;1m288 | [0m[35m            password="pass",[0m
[30;1m289 | [0m[35m            timeout=30,[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m264 | [0m[35m            assert isinstance(connection, Connection)[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m            # Verify that the connection object is initialized correctly[0m
[30;1m267 | [0m[35m            assert connection._hostname == hostname[0m
[30;1m268 | [0m[35m            assert connection._username == username[0m
[30;1m269 | [0m[35m            assert connection._password == password[0m
[30;1m270 | [0m[35m            assert connection._port == port[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m264 | [0m[35m            assert isinstance(connection, Connection)[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m            # Verify that the connection object is initialized correctly[0m
[30;1m267 | [0m[35m            assert connection._hostname == hostname[0m
[30;1m268 | [0m[35m            assert connection._username == username[0m
[30;1m269 | [0m[35m            assert connection._password == password[0m
[30;1m270 | [0m[35m            assert connection._port == port[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m            # Call the create method[0m
[30;1m249 | [0m[35m            connection = await Connection.create([0m
[30;1m250 | [0m[35m                hostname=hostname,[0m
[30;1m251 | [0m[35m                username=username,[0m
[30;1m252 | [0m[35m                password=password,[0m
[30;1m253 | [0m[35m                port=port,[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m            # Call the create method[0m
[30;1m249 | [0m[35m            connection = await Connection.create([0m
[30;1m250 | [0m[35m                hostname=hostname,[0m
[30;1m251 | [0m[35m                username=username,[0m
[30;1m252 | [0m[35m                password=password,[0m
[30;1m253 | [0m[35m                port=port,[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m236 | [0m[35m            Connection, "async_connect", new_callable=AsyncMock[0m
[30;1m237 | [0m[35m        ) as mock_connect:[0m
[30;1m238 | [0m[35m            # Define test parameters[0m
[30;1m239 | [0m[35m            hostname = "localhost"[0m
[30;1m240 | [0m[35m            username = "user"[0m
[30;1m241 | [0m[35m            password = "pass"[0m
[30;1m242 | [0m[35m            port = 8080[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m210 | [0m[35m        ):[0m
[30;1m211 | [0m[35m            # Create a Connection[0m
[30;1m212 | [0m[35m            connection = Connection([0m
[30;1m213 | [0m[35m                hostname="localhost",[0m
[30;1m214 | [0m[35m                username="user",[0m
[30;1m215 | [0m[35m                password="pass",[0m
[30;1m216 | [0m[35m                port=8080,[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m180 | [0m[35m        ) as mock_connect:[0m
[30;1m181 | [0m[35m            # Create a Connection[0m
[30;1m182 | [0m[35m            connection = Connection([0m
[30;1m183 | [0m[35m                hostname="localhost",[0m
[30;1m184 | [0m[35m                username="user",[0m
[30;1m185 | [0m[35m                password="pass",[0m
[30;1m186 | [0m[35m                port=8080,[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m164 | [0m[35m        )[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m        # Ensure that instances do not interfere with each other[0m
[30;1m167 | [0m[35m        assert conn1._hostname != conn2._hostname[0m
[30;1m168 | [0m[35m        assert conn1._username != conn2._username[0m
[30;1m169 | [0m[35m        assert conn1._password != conn2._password[0m
[30;1m170 | [0m[35m        assert conn1._port != conn2._port[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m164 | [0m[35m        )[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m        # Ensure that instances do not interfere with each other[0m
[30;1m167 | [0m[35m        assert conn1._hostname != conn2._hostname[0m
[30;1m168 | [0m[35m        assert conn1._username != conn2._username[0m
[30;1m169 | [0m[35m        assert conn1._password != conn2._password[0m
[30;1m170 | [0m[35m        assert conn1._port != conn2._port[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m152 | [0m[35m        )[0m
[30;1m153 | [0m[35m        self._assert_connection([0m
[30;1m154 | [0m[35m            conn2,[0m
[30;1m155 | [0m[35m            hostname="localhost2",[0m
[30;1m156 | [0m[35m            username="user2",[0m
[30;1m157 | [0m[35m            password="pass2",[0m
[30;1m158 | [0m[35m            port=9090,[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m140 | [0m[35m        # Test the Connections[0m
[30;1m141 | [0m[35m        self._assert_connection([0m
[30;1m142 | [0m[35m            conn1,[0m
[30;1m143 | [0m[35m            hostname="localhost1",[0m
[30;1m144 | [0m[35m            username="user1",[0m
[30;1m145 | [0m[35m            password="pass1",[0m
[30;1m146 | [0m[35m            port=8080,[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m129 | [0m[35m            timeout=None,[0m
[30;1m130 | [0m[35m        )[0m
[30;1m131 | [0m[35m        conn2 = Connection([0m
[30;1m132 | [0m[35m            hostname="localhost2",[0m
[30;1m133 | [0m[35m            username="user2",[0m
[30;1m134 | [0m[35m            password="pass2",[0m
[30;1m135 | [0m[35m            port=9090,[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        # Create two Connection[0m
[30;1m123 | [0m[35m        conn1 = Connection([0m
[30;1m124 | [0m[35m            hostname="localhost1",[0m
[30;1m125 | [0m[35m            username="user1",[0m
[30;1m126 | [0m[35m            password="pass1",[0m
[30;1m127 | [0m[35m            port=8080,[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m104 | [0m[35m        # Test the Connection[0m
[30;1m105 | [0m[35m        self._assert_connection([0m
[30;1m106 | [0m[35m            conn,[0m
[30;1m107 | [0m[35m            hostname=hostname,[0m
[30;1m108 | [0m[35m            username=username,[0m
[30;1m109 | [0m[35m            password=password,[0m
[30;1m110 | [0m[35m            port=port,[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m104 | [0m[35m        # Test the Connection[0m
[30;1m105 | [0m[35m        self._assert_connection([0m
[30;1m106 | [0m[35m            conn,[0m
[30;1m107 | [0m[35m            hostname=hostname,[0m
[30;1m108 | [0m[35m            username=username,[0m
[30;1m109 | [0m[35m            password=password,[0m
[30;1m110 | [0m[35m            port=port,[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        # Create a Connection[0m
[30;1m93 | [0m[35m        conn = Connection([0m
[30;1m94 | [0m[35m            hostname=hostname,[0m
[30;1m95 | [0m[35m            username=username,[0m
[30;1m96 | [0m[35m            password=password,[0m
[30;1m97 | [0m[35m            port=port,[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        # Create a Connection[0m
[30;1m93 | [0m[35m        conn = Connection([0m
[30;1m94 | [0m[35m            hostname=hostname,[0m
[30;1m95 | [0m[35m            username=username,[0m
[30;1m96 | [0m[35m            password=password,[0m
[30;1m97 | [0m[35m            port=port,[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m78 | [0m[35m    def test_init([0m
[30;1m79 | [0m[35m        self,[0m
[30;1m80 | [0m[35m        mock_new_session: Mock,[0m
[30;1m81 | [0m[35m        hostname: str,[0m
[30;1m82 | [0m[35m        username: str,[0m
[30;1m83 | [0m[35m        password: str,[0m
[30;1m84 | [0m[35m        port: int,[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m62 | [0m[35m        assert isinstance(conn._connection_lock, asyncio.Lock)[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    @pytest.mark.parametrize([0m
[30;1m65 | [0m[35m        "hostname, username, password, port, use_ssl, session, timeout,"[0m
[30;1m66 | [0m[35m        "dumpback",[0m
[30;1m67 | [0m[35m        [[0m
[30;1m68 | [0m[35m            ("localhost", "user", "pass", None, False, None, None, None),[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m48 | [0m[35m    ) -> None:[0m
[30;1m49 | [0m[35m        """Test the Connection object."""[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        assert conn._hostname == hostname[0m
[30;1m52 | [0m[35m        assert conn._username == username[0m
[30;1m53 | [0m[35m        assert conn._password == password[0m
[30;1m54 | [0m[35m        assert conn._port == (port or (8443 if use_ssl else 80))[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m48 | [0m[35m    ) -> None:[0m
[30;1m49 | [0m[35m        """Test the Connection object."""[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        assert conn._hostname == hostname[0m
[30;1m52 | [0m[35m        assert conn._username == username[0m
[30;1m53 | [0m[35m        assert conn._password == password[0m
[30;1m54 | [0m[35m        assert conn._port == (port or (8443 if use_ssl else 80))[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m36 | [0m[35m    def _assert_connection([0m
[30;1m37 | [0m[35m        self,[0m
[30;1m38 | [0m[35m        conn: Connection,[0m
[30;1m39 | [0m[35m        hostname: str,[0m
[30;1m40 | [0m[35m        username: str,[0m
[30;1m41 | [0m[35m        password: str,[0m
[30;1m42 | [0m[35m        port: Optional[int],[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m            )[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m            # Verify that aiohttp.ClientSession was called[0m
[30;1m310 | [0m[35m            # with the correct timeout[0m
[30;1m311 | [0m[35m            mock_client_session.assert_called_once_with([0m
[30;1m312 | [0m[35m                connector=mock_tcp_connector.return_value,[0m
[30;1m313 | [0m[35m                timeout=aiohttp.ClientTimeout(total=connection._timeout),[0m
[30;1m314 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m            assert connection._port == port[0m
[30;1m271 | [0m[35m            assert connection._ssl == use_ssl[0m
[30;1m272 | [0m[35m            assert connection._session == session[0m
[30;1m273 | [0m[35m            assert connection._timeout == timeout[0m
[30;1m274 | [0m[35m            assert connection._dumpback == dumpback[0m
[30;1m275 | [0m[35m            assert connection._token is None[0m
[30;1m276 | [0m[35m            assert connection._header is None[0m
[30;1m277 | [0m[35m            assert connection._connected is False[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m            port = 8080[0m
[30;1m243 | [0m[35m            use_ssl = True[0m
[30;1m244 | [0m[35m            session = Mock()[0m
[30;1m245 | [0m[35m            timeout = 15[0m
[30;1m246 | [0m[35m            dumpback = Mock()[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m            # Call the create method[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/tests/test_connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        assert conn._port == (port or (8443 if use_ssl else 80))[0m
[30;1m55 | [0m[35m        assert conn._ssl == use_ssl[0m
[30;1m56 | [0m[35m        assert conn._session == (session or mock_new_session.return_value)[0m
[30;1m57 | [0m[35m        assert conn._timeout == timeout[0m
[30;1m58 | [0m[35m        assert conn._dumpback == dumpback[0m
[30;1m59 | [0m[35m        assert conn._token is None[0m
[30;1m60 | [0m[35m        assert conn._header is None[0m
[30;1m61 | [0m[35m        assert conn._connected is False[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/firmware.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mclass WebsUpdate(Enum):[0m
[30;1m44 | [0m[35m    """Webs Update status."""[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    UNKNOWN = -999[0m
[30;1m47 | [0m[35m    ACTIVE = 0[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/legacy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m            port_external = rule.port_external[0m
[30;1m27 | [0m[35m        ip = str()[0m
[30;1m28 | [0m[35m        if rule.ip_address is not None and rule.ip_address != "None":[0m
[30;1m29 | [0m[35m            ip = rule.ip_address[0m
[30;1m30 | [0m[35m        port = str()[0m
[30;1m31 | [0m[35m        if rule.port is not None and rule.port != "None":[0m
[30;1m32 | [0m[35m            port = rule.port[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/legacy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m        port_external = str()[0m
[30;1m25 | [0m[35m        if rule.port_external is not None and rule.port_external != "None":[0m
[30;1m26 | [0m[35m            port_external = rule.port_external[0m
[30;1m27 | [0m[35m        ip = str()[0m
[30;1m28 | [0m[35m        if rule.ip_address is not None and rule.ip_address != "None":[0m
[30;1m29 | [0m[35m            ip = rule.ip_address[0m
[30;1m30 | [0m[35m        port = str()[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/devicemap_const.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""Constants for the devicemap endpoint module."""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# These values are just stored directly in this order in the corresponding node[0m
[30;1m4 | [0m[35m# Format: (output_group, input_group, [input_values])[0m
[30;1m5 | [0m[35mDEVICEMAP_BY_INDEX = [[0m
[30;1m6 | [0m[35m    ("wan", "wan", ["status", "sbstatus", "auxstatus"]),[0m
[30;1m7 | [0m[35m    ("wan0", "first_wan", ["status", "sbstatus", "auxstatus"]),[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m    print(aura["effect"])[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m    # Get number of zones from the Static effect length[0m
[30;1m312 | [0m[35m    _effect_static = aura["effect"].get(AsusAuraColor.STATIC)[0m
[30;1m313 | [0m[35m    aura["zones"] = len(_effect_static) if _effect_static else 0[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m    return aura[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m        aura["state"] = False[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m    # Active effect[0m
[30;1m295 | [0m[35m    active_effect = aura["effect"].get(aura["scheme"].value)[0m
[30;1m296 | [0m[35m    if active_effect:[0m
[30;1m297 | [0m[35m        _active_brightness = 0[0m
[30;1m298 | [0m[35m        for i, color in enumerate(active_effect):[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m    aura = {[0m
[30;1m283 | [0m[35m        "state": safe_bool(data.get("AllLED")),[0m
[30;1m284 | [0m[35m        "night_mode": safe_bool(data.get("ledg_night_mode")),[0m
[30;1m285 | [0m[35m        "scheme": get_scheme("ledg_scheme"),[0m
[30;1m286 | [0m[35m        "scheme_prev": get_scheme("ledg_scheme_old"),[0m
[30;1m287 | [0m[35m        "effect": effect,[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m    }[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m    aura = {[0m
[30;1m283 | [0m[35m        "state": safe_bool(data.get("AllLED")),[0m
[30;1m284 | [0m[35m        "night_mode": safe_bool(data.get("ledg_night_mode")),[0m
[30;1m285 | [0m[35m        "scheme": get_scheme("ledg_scheme"),[0m
[30;1m286 | [0m[35m        "scheme_prev": get_scheme("ledg_scheme_old"),[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    def get_scheme(key: str) -> AsusAura:[0m
[30;1m261 | [0m[35m        """Get the scheme from the data."""[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        scheme_value = data.get(key)[0m
[30;1m264 | [0m[35m        _scheme_value = safe_int(scheme_value)[0m
[30;1m265 | [0m[35m        _scheme_enum = safe_enum(AsusAura, _scheme_value, default_value=-999)[0m
[30;1m266 | [0m[35m        scheme: AsusAura = ([0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m    state_number = AsusAuraColor[state.name].value[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    # Get the previous colors / fallback to the default color[0m
[30;1m225 | [0m[35m    colors = aura_state.get("effect", {}).get([0m
[30;1m226 | [0m[35m        state_number, get_default_aura_color(zones)[0m
[30;1m227 | [0m[35m    )[0m
[30;1m228 | [0m[35m    # Convert to ColorRGBB if needed[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m    state_number = AsusAuraColor[state.name].value[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    # Get the previous colors / fallback to the default color[0m
[30;1m225 | [0m[35m    colors = aura_state.get("effect", {}).get([0m
[30;1m226 | [0m[35m        state_number, get_default_aura_color(zones)[0m
[30;1m227 | [0m[35m    )[0m
[30;1m228 | [0m[35m    # Convert to ColorRGBB if needed[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    # Get the current router state[0m
[30;1m195 | [0m[35m    aura_state = ([0m
[30;1m196 | [0m[35m        kwargs.get("router_state", {}).get(AsusData.AURA, AsusDataState).data[0m
[30;1m197 | [0m[35m    )[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    # Get the arguments[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    # Get the current router state[0m
[30;1m195 | [0m[35m    aura_state = ([0m
[30;1m196 | [0m[35m        kwargs.get("router_state", {}).get(AsusData.AURA, AsusDataState).data[0m
[30;1m197 | [0m[35m    )[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    # Get the arguments[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m    """Set the Aura state."""[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    # Get the identity[0m
[30;1m187 | [0m[35m    identity: AsusDevice = kwargs.get("identity", AsusDevice())[0m
[30;1m188 | [0m[35m    # Get the number of zones[0m
[30;1m189 | [0m[35m    zones = identity.aura_zone[0m
[30;1m190 | [0m[35m    if zones < 1:[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m    if current_scheme is not None and is_valid_scheme(current_scheme):[0m
[30;1m100 | [0m[35m        return AsusAura(current_scheme)[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    prev_scheme = safe_int(aura_state.get("scheme_prev"))[0m
[30;1m103 | [0m[35m    if prev_scheme is not None and is_valid_scheme(prev_scheme):[0m
[30;1m104 | [0m[35m        return AsusAura(prev_scheme)[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m        ][0m
[30;1m96 | [0m[35m        return scheme in valid_schemes[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    current_scheme = safe_int(aura_state.get("scheme"))[0m
[30;1m99 | [0m[35m    if current_scheme is not None and is_valid_scheme(current_scheme):[0m
[30;1m100 | [0m[35m        return AsusAura(current_scheme)[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/aura.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m        "ledg_rgb": color_to_use,[0m
[30;1m248 | [0m[35m    }[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m    # Run the service[0m
[30;1m251 | [0m[35m    return await callback([0m
[30;1m252 | [0m[35m        endpoint=EndpointTools.AURA,[0m
[30;1m253 | [0m[35m        commands=arguments,[0m
[30;1m254 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/homeassistant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    for sensor in data:[0m
[30;1m117 | [0m[35m        for sensor_id in data[sensor]:[0m
[30;1m118 | [0m[35m            for sensor_type in sensor_map.get(sensor, []):[0m
[30;1m119 | [0m[35m                sensors.append(f"{sensor}_{sensor_id}_{sensor_type}")[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    return sensors[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/homeassistant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35mdef convert_to_ha_sensors_group(data: dict[str, Any]) -> list[str]:[0m
[30;1m125 | [0m[35m    """Convert the top level of data to the list of sensors."""[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    return list_from_dict(data)[0m
[30;1m128 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/data_finder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35mASUSDATA_ENDPOINT_APPEND = {[0m
[30;1m174 | [0m[35m    Endpoint.PORT_STATUS: {[0m
[30;1m175 | [0m[35m        # Request status of the ports for the whole AiMesh network[0m
[30;1m176 | [0m[35m        # This will save time and requests, since we then cache the data[0m
[30;1m177 | [0m[35m        # in most cases[0m
[30;1m178 | [0m[35m        "node_mac": "all",[0m
[30;1m179 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # Regex to find each IP address in a string of IP addresses[0m
[30;1m45 | [0m[35m    regex = r"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"[0m
[30;1m46 | [0m[35m    # Find all IP addresses in the string[0m
[30;1m47 | [0m[35m    matches = re.findall(regex, data)[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    return matches[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # Regex to find each IP address in a string of IP addresses[0m
[30;1m45 | [0m[35m    regex = r"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"[0m
[30;1m46 | [0m[35m    # Find all IP addresses in the string[0m
[30;1m47 | [0m[35m    matches = re.findall(regex, data)[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    return matches[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35mdef read_dns_ip_address(data: str) -> list[str]:[0m
[30;1m42 | [0m[35m    """Read DNS record and return the list of IP addresses."""[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # Regex to find each IP address in a string of IP addresses[0m
[30;1m45 | [0m[35m    regex = r"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"[0m
[30;1m46 | [0m[35m    # Find all IP addresses in the string[0m
[30;1m47 | [0m[35m    matches = re.findall(regex, data)[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35mdef read_dns_ip_address(data: str) -> list[str]:[0m
[30;1m42 | [0m[35m    """Read DNS record and return the list of IP addresses."""[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # Regex to find each IP address in a string of IP addresses[0m
[30;1m45 | [0m[35m    regex = r"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"[0m
[30;1m46 | [0m[35m    # Find all IP addresses in the string[0m
[30;1m47 | [0m[35m    matches = re.findall(regex, data)[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35mdef read_dns_ip_address(data: str) -> list[str]:[0m
[30;1m42 | [0m[35m    """Read DNS record and return the list of IP addresses."""[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # Regex to find each IP address in a string of IP addresses[0m
[30;1m45 | [0m[35m    regex = r"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"[0m
[30;1m46 | [0m[35m    # Find all IP addresses in the string[0m
[30;1m47 | [0m[35m    matches = re.findall(regex, data)[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mdef read_dns_ip_address(data: str) -> list[str]:[0m
[30;1m42 | [0m[35m    """Read DNS record and return the list of IP addresses."""[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # Regex to find each IP address in a string of IP addresses[0m
[30;1m45 | [0m[35m    regex = r"(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m    if data == "manual":[0m
[30;1m35 | [0m[35m        return IPAddressType.STATIC[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    # If the IP address type is not found, return the UNKNOWN type[0m
[30;1m38 | [0m[35m    return IPAddressType.UNKNOWN[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m    if data:[0m
[30;1m26 | [0m[35m        data = data.lower()[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    # Find the IP address type in the IPAddressType enum by value[0m
[30;1m29 | [0m[35m    for ip_address_type in IPAddressType:[0m
[30;1m30 | [0m[35m        if ip_address_type.value == data:[0m
[30;1m31 | [0m[35m            return ip_address_type[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m    if data:[0m
[30;1m26 | [0m[35m        data = data.lower()[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    # Find the IP address type in the IPAddressType enum by value[0m
[30;1m29 | [0m[35m    for ip_address_type in IPAddressType:[0m
[30;1m30 | [0m[35m        if ip_address_type.value == data:[0m
[30;1m31 | [0m[35m            return ip_address_type[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/ip_address.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mdef read_ip_address_type(data: Optional[str]) -> IPAddressType:[0m
[30;1m21 | [0m[35m    """Read IP address type from data string."""[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    data = clean_string(data)[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m        return ConnectionState.DISCONNECTED[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m    # If we have support for AiMesh but no node, client is disconnected[0m
[30;1m300 | [0m[35m    aimesh = kwargs.get("aimesh", False)[0m
[30;1m301 | [0m[35m    if aimesh is True and connection.node is None:[0m
[30;1m302 | [0m[35m        return ConnectionState.DISCONNECTED[0m
[30;1m303 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m            # Get the search key and converter(s)[0m
[30;1m229 | [0m[35m            key_to_find, converters = safe_unpack_key(pair)[0m
[30;1m230 | [0m[35m            # Get the value from the data[0m
[30;1m231 | [0m[35m            item = data.get(key_to_find)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m            # Process the value if it's an actual value[0m
[30;1m234 | [0m[35m            if item is not None and item != str():[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m338 | [0m[35m        # This comes from the device itself and cannot be fixed from AsusRouter side[0m
[30;1m339 | [0m[35m        if connection.since is not None and history.since is not None:[0m
[30;1m340 | [0m[35m            diff = abs((history.since - connection.since).total_seconds())[0m
[30;1m341 | [0m[35m            if diff < 10:[0m
[30;1m342 | [0m[35m                connection.since = history.since[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m    return connection[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m        # Fix the oscillating connection time ignore any value less than 10 seconds[0m
[30;1m338 | [0m[35m        # This comes from the device itself and cannot be fixed from AsusRouter side[0m
[30;1m339 | [0m[35m        if connection.since is not None and history.since is not None:[0m
[30;1m340 | [0m[35m            diff = abs((history.since - connection.since).total_seconds())[0m
[30;1m341 | [0m[35m            if diff < 10:[0m
[30;1m342 | [0m[35m                connection.since = history.since[0m
[30;1m343 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m    if isinstance(connection, AsusClientConnectionWlan) and isinstance([0m
[30;1m335 | [0m[35m        history, AsusClientConnectionWlan[0m
[30;1m336 | [0m[35m    ):[0m
[30;1m337 | [0m[35m        # Fix the oscillating connection time ignore any value less than 10 seconds[0m
[30;1m338 | [0m[35m        # This comes from the device itself and cannot be fixed from AsusRouter side[0m
[30;1m339 | [0m[35m        if connection.since is not None and history.since is not None:[0m
[30;1m340 | [0m[35m            diff = abs((history.since - connection.since).total_seconds())[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m    # We keep values set by the user:[0m
[30;1m315 | [0m[35m    # - internet mode[0m
[30;1m316 | [0m[35m    # - ip method[0m
[30;1m317 | [0m[35m    # - ip address if ip method is static[0m
[30;1m318 | [0m[35m    return AsusClientConnection([0m
[30;1m319 | [0m[35m        type=ConnectionType.DISCONNECTED,[0m
[30;1m320 | [0m[35m        ip_address=connection.ip_address[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m    # We keep values set by the user:[0m
[30;1m315 | [0m[35m    # - internet mode[0m
[30;1m316 | [0m[35m    # - ip method[0m
[30;1m317 | [0m[35m    # - ip address if ip method is static[0m
[30;1m318 | [0m[35m    return AsusClientConnection([0m
[30;1m319 | [0m[35m        type=ConnectionType.DISCONNECTED,[0m
[30;1m320 | [0m[35m        ip_address=connection.ip_address[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m    # We keep values set by the user:[0m
[30;1m315 | [0m[35m    # - internet mode[0m
[30;1m316 | [0m[35m    # - ip method[0m
[30;1m317 | [0m[35m    # - ip address if ip method is static[0m
[30;1m318 | [0m[35m    return AsusClientConnection([0m
[30;1m319 | [0m[35m        type=ConnectionType.DISCONNECTED,[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m) -> ConnectionState:[0m
[30;1m289 | [0m[35m    """Process client state."""[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    # If no IP address or type is disconnected, it's disconnected[0m
[30;1m292 | [0m[35m    if connection.ip_address is None or connection.type == ConnectionType.DISCONNECTED:[0m
[30;1m293 | [0m[35m        return ConnectionState.DISCONNECTED[0m
[30;1m294 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    node: Optional[str] = None[0m
[30;1m49 | [0m[35m    online: bool = False[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # Is an AiMesh node[0m
[30;1m52 | [0m[35m    aimesh: Optional[bool] = None[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m@dataclass[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35msession = aiohttp.ClientSession(loop=loop)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m36 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m37 | [0m[35m    username="admin",               #required[0m
[30;1m38 | [0m[35m    password="password",            #required[0m
[30;1m39 | [0m[35m    use_ssl=True,                   #optional[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m### WiFi 4 | 802.11n[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m| Model                                                           | Status       | Tested firmware |[0m
[30;1m158 | [0m[35m| --------------------------------------------------------------- | ------------ | --------------- |[0m
[30;1m159 | [0m[35m| [RT-N66U](https://asusrouter.vaskivskyi.com/devices/RT-N66U.md) | 💚 Confirmed |                 |[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m"nofollow sponsored" target="_blank">find it</a> |[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m### WiFi 5 | 802.11ac[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m| Model                                                                                     | Status[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mdel                                                                                          | Statu[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35mref="https://amzn.to/48F5wiB" rel="nofollow sponsored" target="_blank">find it</a> |[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m### WiFi 6e | 802.11axe[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m| Model                                                                           | Status          [0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35mdisconnect())[0m
[30;1m52 | [0m[35mloop.run_until_complete(session.close())[0m
[30;1m53 | [0m[35m```[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m## Supported devices[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35mAsusRouter supports virtually every AsusWRT-powered device.[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m### WiFi 7 | 802.11be[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m| Model                                                                           | Status          [0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m# Create aiohttp session[0m
[30;1m33 | [0m[35msession = aiohttp.ClientSession(loop=loop)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m36 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m37 | [0m[35m    username="admin",               #required[0m
[30;1m38 | [0m[35m    password="password",            #required[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mInstallation of the latest release is available from PyPI:[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m```[0m
[30;1m17 | [0m[35mpip install asusrouter[0m
[30;1m18 | [0m[35m```[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m## Usage[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m60 | [0m[35msession = aiohttp.ClientSession(loop=loop)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m63 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m64 | [0m[35m    username="admin",               #required[0m
[30;1m65 | [0m[35m    password="password",            #required[0m
[30;1m66 | [0m[35m    use_ssl=True,                   #optional[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m### WiFi 4 | 802.11n[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m| Model                                                           | Status       | Tested firmware |[0m
[30;1m185 | [0m[35m| --------------------------------------------------------------- | ------------ | --------------- |[0m
[30;1m186 | [0m[35m| [RT-N66U](https://asusrouter.vaskivskyi.com/devices/RT-N66U.md) | 💚 Confirmed |                 |[0m
[30;1m187 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m"nofollow sponsored" target="_blank">find it</a> |[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m### WiFi 5 | 802.11ac[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m| Model                                                                                     | Status[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mdel                                                                                          | Statu[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35mref="https://amzn.to/48F5wiB" rel="nofollow sponsored" target="_blank">find it</a> |[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m### WiFi 6e | 802.11axe[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m| Model                                                                           | Status          [0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35mdisconnect())[0m
[30;1m79 | [0m[35mloop.run_until_complete(session.close())[0m
[30;1m80 | [0m[35m```[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m## Supported devices[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mAsusRouter supports virtually every AsusWRT-powered device.[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m### WiFi 7 | 802.11be[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m| Model                                                                           | Status          [0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m# Create aiohttp session[0m
[30;1m60 | [0m[35msession = aiohttp.ClientSession(loop=loop)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m63 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m64 | [0m[35m    username="admin",               #required[0m
[30;1m65 | [0m[35m    password="password",            #required[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mInstallation of the latest release is available from PyPI:[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m```[0m
[30;1m44 | [0m[35mpip install asusrouter[0m
[30;1m45 | [0m[35m```[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m## Usage[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/state.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m        if getattr(submodule, "REQUIRE_STATE", False):[0m
[30;1m158 | [0m[35m            kwargs["extra_param"] = kwargs.get("router_state")[0m
[30;1m159 | [0m[35m        if getattr(submodule, "REQUIRE_IDENTITY", False):[0m
[30;1m160 | [0m[35m            kwargs["extra_param"] = kwargs.get("identity")[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m        # Call the function with the determined parameters[0m
[30;1m163 | [0m[35m        return await submodule.set_state([0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/state.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m    if submodule and _has_method(submodule, "set_state"):[0m
[30;1m156 | [0m[35m        # Determine the extra parameter[0m
[30;1m157 | [0m[35m        if getattr(submodule, "REQUIRE_STATE", False):[0m
[30;1m158 | [0m[35m            kwargs["extra_param"] = kwargs.get("router_state")[0m
[30;1m159 | [0m[35m        if getattr(submodule, "REQUIRE_IDENTITY", False):[0m
[30;1m160 | [0m[35m            kwargs["extra_param"] = kwargs.get("identity")[0m
[30;1m161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/state.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m        AsusState, type(state), default=AsusState.NONE[0m
[30;1m99 | [0m[35m    )[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    return AsusStateMap.get(asus_state)[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mdef _get_module_name(state: AsusState) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/color.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    # Calculate the average color components[0m
[30;1m33 | [0m[35m    num_colors = len(colors)[0m
[30;1m34 | [0m[35m    red = sum(color.r for color in colors) // num_colors[0m
[30;1m35 | [0m[35m    green = sum(color.g for color in colors) // num_colors[0m
[30;1m36 | [0m[35m    blue = sum(color.b for color in colors) // num_colors[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m730 | [0m[35m                # Check that we are not fetching this data already[0m
[30;1m731 | [0m[35m[0m
[30;1m732 | [0m[35m                # Add the request from kwargs[0m
[30;1m733 | [0m[35m                kw_request = kwargs.get("request", {})[0m
[30;1m734 | [0m[35m                if isinstance(kw_request, dict):[0m
[30;1m735 | [0m[35m                    for key, value in kw_request.items():[0m
[30;1m736 | [0m[35m                        request += f"{key}={value};"[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m645 | [0m[35m            match device:[0m
[30;1m646 | [0m[35m                case None:[0m
[30;1m647 | [0m[35m                    if isinstance(state, dict):[0m
[30;1m648 | [0m[35m                        return state.get(own_mac, {})[0m
[30;1m649 | [0m[35m                    return state[0m
[30;1m650 | [0m[35m                case "all":[0m
[30;1m651 | [0m[35m                    return state[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m640 | [0m[35m            own_mac = self._identity.mac if self._identity else None[0m
[30;1m641 | [0m[35m[0m
[30;1m642 | [0m[35m            # Get the device selected[0m
[30;1m643 | [0m[35m            device = kwargs.get("device", None)[0m
[30;1m644 | [0m[35m[0m
[30;1m645 | [0m[35m            match device:[0m
[30;1m646 | [0m[35m                case None:[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m545 | [0m[35m            return transform_network([0m
[30;1m546 | [0m[35m                data,[0m
[30;1m547 | [0m[35m                self._identity.services if self._identity else [],[0m
[30;1m548 | [0m[35m                self._state.get(AsusData.NETWORK),[0m
[30;1m549 | [0m[35m                model=self._identity.model if self._identity else None,[0m
[30;1m550 | [0m[35m            )[0m
[30;1m551 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m532 | [0m[35m            _LOGGER.debug("Transforming clients data")[0m
[30;1m533 | [0m[35m            return transform_clients([0m
[30;1m534 | [0m[35m                data,[0m
[30;1m535 | [0m[35m                self._state.get(AsusData.CLIENTS),[0m
[30;1m536 | [0m[35m                aimesh=self._identity.aimesh if self._identity else False,[0m
[30;1m537 | [0m[35m            )[0m
[30;1m538 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m        # Check if endpoints are available[0m
[30;1m509 | [0m[35m        for endpoint in data_map.endpoint:[0m
[30;1m510 | [0m[35m            # Check endpoint availability in identity[0m
[30;1m511 | [0m[35m            if self._identity.endpoints and self._identity.endpoints.get([0m
[30;1m512 | [0m[35m                endpoint[0m
[30;1m513 | [0m[35m            ) in ([0m
[30;1m514 | [0m[35m                False,[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m499 | [0m[35m        data_map = ASUSDATA_MAP.get(datatype)[0m
[30;1m500 | [0m[35m        # Consider aliases[0m
[30;1m501 | [0m[35m        while isinstance(data_map, AsusData):[0m
[30;1m502 | [0m[35m            data_map = ASUSDATA_MAP.get(data_map)[0m
[30;1m503 | [0m[35m        # Check if we have a map[0m
[30;1m504 | [0m[35m        if not isinstance(data_map, AsusDataFinder):[0m
[30;1m505 | [0m[35m            _LOGGER.debug("No map found for %s", datatype)[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m496 | [0m[35m            return None[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m        # Get the map[0m
[30;1m499 | [0m[35m        data_map = ASUSDATA_MAP.get(datatype)[0m
[30;1m500 | [0m[35m        # Consider aliases[0m
[30;1m501 | [0m[35m        while isinstance(data_map, AsusData):[0m
[30;1m502 | [0m[35m            data_map = ASUSDATA_MAP.get(data_map)[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m447 | [0m[35m            ) from ex[0m
[30;1m448 | [0m[35m[0m
[30;1m449 | [0m[35m        # Check if we need to drop the connection[0m
[30;1m450 | [0m[35m        run_service = result.get("run_service", None)[0m
[30;1m451 | [0m[35m        if run_service in ("restart_httpd", "reboot"):[0m
[30;1m452 | [0m[35m            await self._async_drop_connection()[0m
[30;1m453 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m            "Triggered method async_api_query: %s | %s", endpoint, payload[0m
[30;1m394 | [0m[35m        )[0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35m        request_type = ENDPOINT_FORCE_REQUEST.get(endpoint, RequestType.POST)[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35m        return await self._connection.async_query([0m
[30;1m399 | [0m[35m            endpoint, payload, request_type=request_type[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m        ):[0m
[30;1m369 | [0m[35m            flags = state_flags.data[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m        if flags.get("reboot", False) is True:[0m
[30;1m372 | [0m[35m            _LOGGER.debug("Reboot flag is set")[0m
[30;1m373 | [0m[35m            await self._async_handle_reboot()[0m
[30;1m374 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m        flags: dict[str, bool] = {}[0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m        state_flags = self._state.get(AsusData.FLAGS)[0m
[30;1m366 | [0m[35m        if isinstance(state_flags, AsusDataState) and isinstance([0m
[30;1m367 | [0m[35m            state_flags.data, dict[0m
[30;1m368 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        _LOGGER.debug("Triggered method _async_handle_reboot")[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m        led_state = self._state.get(AsusData.LED)[0m
[30;1m214 | [0m[35m        if led_state and led_state.data:[0m
[30;1m215 | [0m[35m            _LOGGER.debug("Restoring LED state")[0m
[30;1m216 | [0m[35m            await keep_state([0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m.hostname[0m
[30;1m127 | [0m[35m        _LOGGER.debug("Triggered method async_init_connection")[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        self._connection = await Connection.create([0m
[30;1m130 | [0m[35m            hostname=self._hostname,[0m
[30;1m131 | [0m[35m            username=self._username,[0m
[30;1m132 | [0m[35m            password=self._password,[0m
[30;1m133 | [0m[35m            port=self._port,[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m.hostname[0m
[30;1m127 | [0m[35m        _LOGGER.debug("Triggered method async_init_connection")[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        self._connection = await Connection.create([0m
[30;1m130 | [0m[35m            hostname=self._hostname,[0m
[30;1m131 | [0m[35m            username=self._username,[0m
[30;1m132 | [0m[35m            password=self._password,[0m
[30;1m133 | [0m[35m            port=self._port,[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m.hostname[0m
[30;1m95 | [0m[35m        self._cache_time = cache_time or DEFAULT_CACHE_TIME[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # Set the host[0m
[30;1m98 | [0m[35m        self._hostname: str = hostname[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # Set the device identity[0m
[30;1m101 | [0m[35m        self._identity: Optional[AsusDevice] = None[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m.hostname[0m
[30;1m95 | [0m[35m        self._cache_time = cache_time or DEFAULT_CACHE_TIME[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # Set the host[0m
[30;1m98 | [0m[35m        self._hostname: str = hostname[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # Set the device identity[0m
[30;1m101 | [0m[35m        self._identity: Optional[AsusDevice] = None[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m.hostname[0m
[30;1m89 | [0m[35m    ):  # pylint: disable=too-many-arguments[0m
[30;1m90 | [0m[35m        """Initialize the interface."""[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        _LOGGER.debug("Initializing a new interface to `%s`", hostname)[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        # Set the cache time[0m
[30;1m95 | [0m[35m        self._cache_time = cache_time or DEFAULT_CACHE_TIME[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m.hostname[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    def __init__([0m
[30;1m80 | [0m[35m        self,[0m
[30;1m81 | [0m[35m        hostname: str,[0m
[30;1m82 | [0m[35m        username: str,[0m
[30;1m83 | [0m[35m        password: str,[0m
[30;1m84 | [0m[35m        port: Optional[int] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m772 | [0m[35m                value = self._transform_data(key, value)[0m
[30;1m773 | [0m[35m                # Save the data[0m
[30;1m774 | [0m[35m                result[key] = value[0m
[30;1m775 | [0m[35m                # Update the state[0m
[30;1m776 | [0m[35m                if key not in self._state:[0m
[30;1m777 | [0m[35m                    self._state[key] = AsusDataState()[0m
[30;1m778 | [0m[35m                self._state[key].update(value)[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m        # Firmware[0m
[30;1m602 | [0m[35m        if datatype == AsusData.FIRMWARE:[0m
[30;1m603 | [0m[35m            # Check if update is available[0m
[30;1m604 | [0m[35m            firmware = self._state[AsusData.FIRMWARE].data[0m
[30;1m605 | [0m[35m            if firmware and firmware["state"] is True:[0m
[30;1m606 | [0m[35m                # Get release notes[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m918 | [0m[35m                save_state([0m
[30;1m919 | [0m[35m                    state, self._state, self._needed_time, self._last_id[0m
[30;1m920 | [0m[35m                )[0m
[30;1m921 | [0m[35m                # Reset the needed time and last id[0m
[30;1m922 | [0m[35m                self._needed_time = None[0m
[30;1m923 | [0m[35m                self._last_id = None[0m
[30;1m924 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m809 | [0m[35m[0m
[30;1m810 | [0m[35m        _LOGGER.debug("Triggered method async_run_service")[0m
[30;1m811 | [0m[35m[0m
[30;1m812 | [0m[35m        # Run the service[0m
[30;1m813 | [0m[35m        result, self._needed_time, self._last_id = await async_call_service([0m
[30;1m814 | [0m[35m            self.async_api_command,[0m
[30;1m815 | [0m[35m            service,[0m
[30;1m816 | [0m[35m            arguments,[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m682 | [0m[35m[0m
[30;1m683 | [0m[35m        # Check if we have the data already and not forcing a refresh[0m
[30;1m684 | [0m[35m        if self._state[datatype].data and not force:[0m
[30;1m685 | [0m[35m            # Check if the data is younger than the cache time[0m
[30;1m686 | [0m[35m            if datetime.now(timezone.utc) - self._state[[0m
[30;1m687 | [0m[35m                datatype[0m
[30;1m688 | [0m[35m            ].timestamp < timedelta(seconds=self._cache_time):[0m
[30;1m689 | [0m[35m                _LOGGER.debug([0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m        self._flags: Flag = Flag()[0m
[30;1m106 | [0m[35m        # Time for change to take effect before available to fetch[0m
[30;1m107 | [0m[35m        self._needed_time: Optional[int] = None[0m
[30;1m108 | [0m[35m        # ID from the last called service[0m
[30;1m109 | [0m[35m        self._last_id: Optional[int] = None[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        # Create an empty connection and save the credentials[0m
[30;1m112 | [0m[35m        self._connection: Optional[Connection] = None[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m        # Set the flags[0m
[30;1m105 | [0m[35m        self._flags: Flag = Flag()[0m
[30;1m106 | [0m[35m        # Time for change to take effect before available to fetch[0m
[30;1m107 | [0m[35m        self._needed_time: Optional[int] = None[0m
[30;1m108 | [0m[35m        # ID from the last called service[0m
[30;1m109 | [0m[35m        self._last_id: Optional[int] = None[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/asusrouter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        _LOGGER.debug("Initializing a new interface to `%s`", hostname)[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        # Set the cache time[0m
[30;1m95 | [0m[35m        self._cache_time = cache_time or DEFAULT_CACHE_TIME[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # Set the host[0m
[30;1m98 | [0m[35m        self._hostname: str = hostname[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m    """Read the parental control data."""[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m    # If no data is provided, return empty list[0m
[30;1m244 | [0m[35m    if data.get(KEY_PC_MAC) == data.get(KEY_PC_TYPE):[0m
[30;1m245 | [0m[35m        return {}[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    # The data is split in 4 strings. Each data value is split in the string[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m    """Read the parental control data."""[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m    # If no data is provided, return empty list[0m
[30;1m244 | [0m[35m    if data.get(KEY_PC_MAC) == data.get(KEY_PC_TYPE):[0m
[30;1m245 | [0m[35m        return {}[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    # The data is split in 4 strings. Each data value is split in the string[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35mdef read_pc_string(key: str, data: dict[str, str]) -> list[str]:[0m
[30;1m235 | [0m[35m    """Read the parental control string."""[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    return data.get(key, "").split("&#62")[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35mdef read_pc_rules(data: dict[str, str]) -> dict[str, ParentalControlRule]:[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m    current_rules = ([0m
[30;1m127 | [0m[35m        kwargs.get("router_state", {})[0m
[30;1m128 | [0m[35m        .get(AsusData.PARENTAL_CONTROL, AsusDataState(data={}))[0m
[30;1m129 | [0m[35m        .data.get("rules", {})[0m
[30;1m130 | [0m[35m    )[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    # Get rule action[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m    # Get the current rules[0m
[30;1m126 | [0m[35m    current_rules = ([0m
[30;1m127 | [0m[35m        kwargs.get("router_state", {})[0m
[30;1m128 | [0m[35m        .get(AsusData.PARENTAL_CONTROL, AsusDataState(data={}))[0m
[30;1m129 | [0m[35m        .data.get("rules", {})[0m
[30;1m130 | [0m[35m    )[0m
[30;1m131 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    # Get the current rules[0m
[30;1m126 | [0m[35m    current_rules = ([0m
[30;1m127 | [0m[35m        kwargs.get("router_state", {})[0m
[30;1m128 | [0m[35m        .get(AsusData.PARENTAL_CONTROL, AsusDataState(data={}))[0m
[30;1m129 | [0m[35m        .data.get("rules", {})[0m
[30;1m130 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m        service=service,[0m
[30;1m108 | [0m[35m        arguments=service_arguments,[0m
[30;1m109 | [0m[35m        apply=True,[0m
[30;1m110 | [0m[35m        expect_modify=kwargs.get("expect_modify", False),[0m
[30;1m111 | [0m[35m    )[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35mdef write_pc_rules(rules: dict[str, ParentalControlRule]) -> dict[str, str]:[0m
[30;1m271 | [0m[35m    """Write the parental control data."""[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m    # If no rules are provided, return empty dict[0m
[30;1m274 | [0m[35m    if not rules:[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35mdef read_pc_rules(data: dict[str, str]) -> dict[str, ParentalControlRule]:[0m
[30;1m241 | [0m[35m    """Read the parental control data."""[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m    # If no data is provided, return empty list[0m
[30;1m244 | [0m[35m    if data.get(KEY_PC_MAC) == data.get(KEY_PC_TYPE):[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35mdef read_pc_string(key: str, data: dict[str, str]) -> list[str]:[0m
[30;1m235 | [0m[35m    """Read the parental control string."""[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    return data.get(key, "").split("&#62")[0m
[30;1m238 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35mdef check_rule(rule: Optional[ParentalControlRule]) -> Optional[ParentalControlRule]:[0m
[30;1m157 | [0m[35m    """Check the parental control rule."""[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m    # Check if rule is available[0m
[30;1m160 | [0m[35m    if not isinstance(rule, ParentalControlRule):[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    # Get rule action[0m
[30;1m133 | [0m[35m    # If the rule is not available, we need to add it[0m
[30;1m134 | [0m[35m    # update can also be handled as add[0m
[30;1m135 | [0m[35m    action = add_rule[0m
[30;1m136 | [0m[35m    if rule.type == PCRuleType.REMOVE:[0m
[30;1m137 | [0m[35m        action = remove_rule[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35m    rule: ParentalControlRule,[0m
[30;1m117 | [0m[35m    **kwargs: Any,[0m
[30;1m118 | [0m[35m) -> bool:[0m
[30;1m119 | [0m[35m    """Set the parental control rule."""[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    # Check if rule is available[0m
[30;1m122 | [0m[35m    if not isinstance(rule, ParentalControlRule):[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m    state: AsusParentalControl | AsusBlockAll | ParentalControlRule,[0m
[30;1m78 | [0m[35m    **kwargs: Any,[0m
[30;1m79 | [0m[35m) -> bool:[0m
[30;1m80 | [0m[35m    """Set the parental control state."""[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    # Check if we need to set a rule[0m
[30;1m83 | [0m[35m    if isinstance(state, ParentalControlRule):[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mclass AsusParentalControl(IntEnum):[0m
[30;1m60 | [0m[35m    """Asus parental control state."""[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    UNKNOWN = -999[0m
[30;1m63 | [0m[35m    OFF = 0[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m@dataclass[0m
[30;1m50 | [0m[35mclass ParentalControlRule:[0m
[30;1m51 | [0m[35m    """Parental control rule class."""[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    mac: Optional[str] = None[0m
[30;1m54 | [0m[35m    name: str = ""[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mclass PCRuleType(IntEnum):[0m
[30;1m40 | [0m[35m    """Parental control rule type."""[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    UNKNOWN = -999[0m
[30;1m43 | [0m[35m    REMOVE = -1  # pseudo type to remove a rule[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""Parental control module."""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m    # Get the correct service call[0m
[30;1m146 | [0m[35m    service = "restart_firewall"[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    # Call the service[0m
[30;1m149 | [0m[35m    return await callback([0m
[30;1m150 | [0m[35m        service=service,[0m
[30;1m151 | [0m[35m        arguments=service_arguments,[0m
[30;1m152 | [0m[35m        apply=True,[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m    service_arguments = write_pc_rules(current_rules)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    # Get the correct service call[0m
[30;1m146 | [0m[35m    service = "restart_firewall"[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    # Call the service[0m
[30;1m149 | [0m[35m    return await callback([0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m    # Convert the rules to service arguments[0m
[30;1m143 | [0m[35m    service_arguments = write_pc_rules(current_rules)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    # Get the correct service call[0m
[30;1m146 | [0m[35m    service = "restart_firewall"[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    # Call the service[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m    # Perform the action[0m
[30;1m140 | [0m[35m    current_rules = action(current_rules, rule)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    # Convert the rules to service arguments[0m
[30;1m143 | [0m[35m    service_arguments = write_pc_rules(current_rules)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    # Get the correct service call[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m    # Get the correct service call[0m
[30;1m103 | [0m[35m    service = "restart_firewall"[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Call the service[0m
[30;1m106 | [0m[35m    return await callback([0m
[30;1m107 | [0m[35m        service=service,[0m
[30;1m108 | [0m[35m        arguments=service_arguments,[0m
[30;1m109 | [0m[35m        apply=True,[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m            service_arguments = {KEY_PC_BLOCK_ALL: 1 if state == AsusBlockAll.ON else 0}[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    # Get the correct service call[0m
[30;1m103 | [0m[35m    service = "restart_firewall"[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Call the service[0m
[30;1m106 | [0m[35m    return await callback([0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m        case a if isinstance(a, AsusBlockAll):[0m
[30;1m100 | [0m[35m            service_arguments = {KEY_PC_BLOCK_ALL: 1 if state == AsusBlockAll.ON else 0}[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    # Get the correct service call[0m
[30;1m103 | [0m[35m    service = "restart_firewall"[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Call the service[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/parental_control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m    UNKNOWN = -999[0m
[30;1m43 | [0m[35m    REMOVE = -1  # pseudo type to remove a rule[0m
[30;1m44 | [0m[35m    DISABLE = 0[0m
[30;1m45 | [0m[35m    TIME = 1[0m
[30;1m46 | [0m[35m    BLOCK = 2[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m    if client_id not in vpnc_data[search_type]:[0m
[30;1m236 | [0m[35m        return None[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m    return vpnc_data[search_type][client_id].get("vpnc_unit")[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m        callback=callback,[0m
[30;1m179 | [0m[35m        state=vpnc_state,[0m
[30;1m180 | [0m[35m        vpnc_unit=vpnc_unit,[0m
[30;1m181 | [0m[35m        expect_modify=kwargs.get("expect_modify", False),[0m
[30;1m182 | [0m[35m        router_state=router_state,[0m
[30;1m183 | [0m[35m    )[0m
[30;1m184 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m    )[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m    # Convert state[0m
[30;1m175 | [0m[35m    vpnc_state = OTHER_STATE_MAPPING.get(state)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    return await set_state_vpnc([0m
[30;1m178 | [0m[35m        callback=callback,[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    # Clientlist is needed to update the state (all clients are in the list).[0m
[30;1m167 | [0m[35m    # If not available, we cannot update the state.[0m
[30;1m168 | [0m[35m    vpnc_data = router_state.get(AsusData.VPNC, AsusDataState()).data[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    vpnc_unit = _find_vpnc_unit([0m
[30;1m171 | [0m[35m        vpnc_data=vpnc_data, client_type=state, client_id=vpn_id[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m        return False[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    # Get the raw state from router[0m
[30;1m164 | [0m[35m    router_state = kwargs.get("router_state", {})[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    # Clientlist is needed to update the state (all clients are in the list).[0m
[30;1m167 | [0m[35m    # If not available, we cannot update the state.[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        service=service,[0m
[30;1m128 | [0m[35m        arguments=service_arguments,[0m
[30;1m129 | [0m[35m        apply=True,[0m
[30;1m130 | [0m[35m        expect_modify=kwargs.get("expect_modify", False),[0m
[30;1m131 | [0m[35m    )[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m        return False[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Get service and binary state[0m
[30;1m106 | [0m[35m    service, binary_state = VPNC_STATE_MAPPING.get(state, (None, None))[0m
[30;1m107 | [0m[35m    if service is None:[0m
[30;1m108 | [0m[35m        _LOGGER.debug("Unknown state %s", state)[0m
[30;1m109 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    # Clientlist is needed to update the state (all clients are in the list).[0m
[30;1m99 | [0m[35m    # If not available, we cannot update the state.[0m
[30;1m100 | [0m[35m    vpnc_clientlist = router_state.get(AsusData.VPNC_CLIENTLIST, AsusDataState()).data[0m
[30;1m101 | [0m[35m    if not vpnc_clientlist or vpnc_clientlist == "":[0m
[30;1m102 | [0m[35m        _LOGGER.debug("No VPN Fusion client list found in router state")[0m
[30;1m103 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m    service_arguments: dict[str, Any] = {"vpnc_unit": vpnc_unit}[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    # Get the raw state from router[0m
[30;1m96 | [0m[35m    router_state = kwargs.get("router_state", {})[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    # Clientlist is needed to update the state (all clients are in the list).[0m
[30;1m99 | [0m[35m    # If not available, we cannot update the state.[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m    router_state = kwargs.get("router_state", {})[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    # Clientlist is needed to update the state (all clients are in the list).[0m
[30;1m167 | [0m[35m    # If not available, we cannot update the state.[0m
[30;1m168 | [0m[35m    vpnc_data = router_state.get(AsusData.VPNC, AsusDataState()).data[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    vpnc_unit = _find_vpnc_unit([0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m163 | [0m[35m    # Get the raw state from router[0m
[30;1m164 | [0m[35m    router_state = kwargs.get("router_state", {})[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    # Clientlist is needed to update the state (all clients are in the list).[0m
[30;1m167 | [0m[35m    # If not available, we cannot update the state.[0m
[30;1m168 | [0m[35m    vpnc_data = router_state.get(AsusData.VPNC, AsusDataState()).data[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m108 | [0m[35m        _LOGGER.debug("Unknown state %s", state)[0m
[30;1m109 | [0m[35m        return False[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    # Update the clientlist[0m
[30;1m112 | [0m[35m    vpnc_clientlist = _get_argument_clientlist(vpnc_clientlist, vpnc_unit, binary_state)[0m
[30;1m113 | [0m[35m    if not vpnc_clientlist:[0m
[30;1m114 | [0m[35m        _LOGGER.debug("Something went wrong with creating a new clientlist")[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m96 | [0m[35m    router_state = kwargs.get("router_state", {})[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    # Clientlist is needed to update the state (all clients are in the list).[0m
[30;1m99 | [0m[35m    # If not available, we cannot update the state.[0m
[30;1m100 | [0m[35m    vpnc_clientlist = router_state.get(AsusData.VPNC_CLIENTLIST, AsusDataState()).data[0m
[30;1m101 | [0m[35m    if not vpnc_clientlist or vpnc_clientlist == "":[0m
[30;1m102 | [0m[35m        _LOGGER.debug("No VPN Fusion client list found in router state")[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m    # Get the raw state from router[0m
[30;1m96 | [0m[35m    router_state = kwargs.get("router_state", {})[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    # Clientlist is needed to update the state (all clients are in the list).[0m
[30;1m99 | [0m[35m    # If not available, we cannot update the state.[0m
[30;1m100 | [0m[35m    vpnc_clientlist = router_state.get(AsusData.VPNC_CLIENTLIST, AsusDataState()).data[0m
[30;1m101 | [0m[35m    if not vpnc_clientlist or vpnc_clientlist == "":[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m        service_arguments,[0m
[30;1m123 | [0m[35m    )[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    # Call the service[0m
[30;1m126 | [0m[35m    return await callback([0m
[30;1m127 | [0m[35m        service=service,[0m
[30;1m128 | [0m[35m        arguments=service_arguments,[0m
[30;1m129 | [0m[35m        apply=True,[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Get service and binary state[0m
[30;1m106 | [0m[35m    service, binary_state = VPNC_STATE_MAPPING.get(state, (None, None))[0m
[30;1m107 | [0m[35m    if service is None:[0m
[30;1m108 | [0m[35m        _LOGGER.debug("Unknown state %s", state)[0m
[30;1m109 | [0m[35m        return False[0m
[30;1m110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m        _LOGGER.debug("No VPN Fusion client list found in router state")[0m
[30;1m103 | [0m[35m        return False[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Get service and binary state[0m
[30;1m106 | [0m[35m    service, binary_state = VPNC_STATE_MAPPING.get(state, (None, None))[0m
[30;1m107 | [0m[35m    if service is None:[0m
[30;1m108 | [0m[35m        _LOGGER.debug("Unknown state %s", state)[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m        _LOGGER.debug("No VPN Fusion unit found in arguments")[0m
[30;1m90 | [0m[35m        return False[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    # Service arguments[0m
[30;1m93 | [0m[35m    service_arguments: dict[str, Any] = {"vpnc_unit": vpnc_unit}[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    # Get the raw state from router[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m                    "Unknown state %s. Cannot find proper handler", state.name[0m
[30;1m61 | [0m[35m                )[0m
[30;1m62 | [0m[35m            except AttributeError:[0m
[30;1m63 | [0m[35m                _LOGGER.debug("Unknown state %s. Cannot find proper handler", state)[0m
[30;1m64 | [0m[35m            return False[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/vpnc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m        case _:[0m
[30;1m58 | [0m[35m            try:[0m
[30;1m59 | [0m[35m                _LOGGER.debug([0m
[30;1m60 | [0m[35m                    "Unknown state %s. Cannot find proper handler", state.name[0m
[30;1m61 | [0m[35m                )[0m
[30;1m62 | [0m[35m            except AttributeError:[0m
[30;1m63 | [0m[35m                _LOGGER.debug("Unknown state %s. Cannot find proper handler", state)[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/readers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    """Get the content type from the headers"""[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    # Get the content type from the headers[0m
[30;1m92 | [0m[35m    content_type = headers.get("content-type", "").split(";")[0].strip()[0m
[30;1m93 | [0m[35m    # Find the content type in ContentType enum and return correct ContentType enum[0m
[30;1m94 | [0m[35m    for content_type_enum in ContentType:[0m
[30;1m95 | [0m[35m        if content_type_enum.value == content_type:[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/readers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m139 | [0m[35m    if not content:[0m
[30;1m140 | [0m[35m        return {}[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    # Random control characters to avoid json errors[0m
[30;1m143 | [0m[35m    for symbol in RANDOM_SYMBOLS:[0m
[30;1m144 | [0m[35m        content = content.replace(symbol, "")[0m
[30;1m145 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/tools/readers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    # Get the content type from the headers[0m
[30;1m92 | [0m[35m    content_type = headers.get("content-type", "").split(";")[0].strip()[0m
[30;1m93 | [0m[35m    # Find the content type in ContentType enum and return correct ContentType enum[0m
[30;1m94 | [0m[35m    for content_type_enum in ContentType:[0m
[30;1m95 | [0m[35m        if content_type_enum.value == content_type:[0m
[30;1m96 | [0m[35m            return content_type_enum[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/data_transform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    for mac, client in data.items():[0m
[30;1m82 | [0m[35m        if readable_mac(mac):[0m
[30;1m83 | [0m[35m            # Check client history[0m
[30;1m84 | [0m[35m            client_history = history.data.get(mac) if history and history.data else None[0m
[30;1m85 | [0m[35m            # Process the client[0m
[30;1m86 | [0m[35m            clients[mac] = process_client(client, client_history, **kwargs)[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/data_transform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m            }[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    # Get the model if available[0m
[30;1m58 | [0m[35m    model = kwargs.get("model", None)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    # Check if we have 5GHz2 available in the network data[0m
[30;1m61 | [0m[35m    if "5ghz2" in network:[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/data_transform.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m    # Add usb network if not available[0m
[30;1m41 | [0m[35m    if not "usb" in network:[0m
[30;1m42 | [0m[35m        # Check history[0m
[30;1m43 | [0m[35m        usb_history = history.data.get("usb") if history and history.data else None[0m
[30;1m44 | [0m[35m        # Revert to history if available[0m
[30;1m45 | [0m[35m        if usb_history:[0m
[30;1m46 | [0m[35m            network["usb"] = usb_history[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/data_transform.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m    service_keys = {"dualwan": "dualwan", "wanbonding": "aggregation"}[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    for service, key in service_keys.items():[0m
[30;1m136 | [0m[35m        if service not in services:[0m
[30;1m137 | [0m[35m            wan.pop(key, None)[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    return wan[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m    # Clients from nmpClient[0m
[30;1m271 | [0m[35m    clients_historic = {[0m
[30;1m272 | [0m[35m        mac: description[0m
[30;1m273 | [0m[35m        for mac, description in data.get("nmpClient", [{}])[0].items()[0m
[30;1m274 | [0m[35m        if readable_mac(mac)[0m
[30;1m275 | [0m[35m    }[0m
[30;1m276 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m    # Clients from Networkmapd[0m
[30;1m264 | [0m[35m    clients = {[0m
[30;1m265 | [0m[35m        mac: description[0m
[30;1m266 | [0m[35m        for mac, description in data.get("fromNetworkmapd", [{}])[0].items()[0m
[30;1m267 | [0m[35m        if readable_mac(mac)[0m
[30;1m268 | [0m[35m    }[0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m        for mac, client in wlan_list.items():[0m
[30;1m242 | [0m[35m            if not readable_mac(mac):[0m
[30;1m243 | [0m[35m                continue[0m
[30;1m244 | [0m[35m            rssi = client.get("rssi")[0m
[30;1m245 | [0m[35m            if mac in output:[0m
[30;1m246 | [0m[35m                output[mac]["isWL"] = wid[0m
[30;1m247 | [0m[35m                output[mac]["rssi"] = rssi[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m    """Read legacy wlan list to the output dict."""[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m    for wlan, wid in LEGACY_WLAN.items():[0m
[30;1m237 | [0m[35m        wlan_list = data.get(f"wlList_{wlan}")[0m
[30;1m238 | [0m[35m        if not wlan_list:[0m
[30;1m239 | [0m[35m            continue[0m
[30;1m240 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m    """Read legacy wlan info to the output dict."""[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m    for wlan in LEGACY_WLAN:[0m
[30;1m209 | [0m[35m        wlan_info = data.get(f"wlListInfo_{wlan}")[0m
[30;1m210 | [0m[35m        if not wlan_info:[0m
[30;1m211 | [0m[35m            continue[0m
[30;1m212 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m    # Wlan info[0m
[30;1m66 | [0m[35m    read_legacy_wlan_info(clients, data)[0m
[30;1m67 | [0m[35m    # nmpClient[0m
[30;1m68 | [0m[35m    read_legacy_nmpclient(clients, data.get("nmpClient"))[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    # Just so that we don't need to process it anyhow special[0m
[30;1m71 | [0m[35m    # This will be compatible with the new format[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    # Networkmap[0m
[30;1m60 | [0m[35m    read_legacy_networmap(clients, data.get("fromNetworkmapd"))[0m
[30;1m61 | [0m[35m    # Staticlist[0m
[30;1m62 | [0m[35m    read_legacy_staticlist(clients, data.get("staticList"))[0m
[30;1m63 | [0m[35m    # Wlan list[0m
[30;1m64 | [0m[35m    read_legacy_wlan_list(clients, data)[0m
[30;1m65 | [0m[35m    # Wlan info[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m    data = read_legacy_as_json(content)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    # Networkmap[0m
[30;1m60 | [0m[35m    read_legacy_networmap(clients, data.get("fromNetworkmapd"))[0m
[30;1m61 | [0m[35m    # Staticlist[0m
[30;1m62 | [0m[35m    read_legacy_staticlist(clients, data.get("staticList"))[0m
[30;1m63 | [0m[35m    # Wlan list[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m    # Step 6 - replace `customList` with `"customList"`[0m
[30;1m105 | [0m[35m    data = data.replace("customList", '"customList"')[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    # Step 7 - find `"wlList_2g": \[[.*]\]` as well as `"wlList_5g": \[[.*]\]` and `"wlList_5g_2": \[0m
[30;1m108 | [0m[35m    # and replace them with `"wlList_2g": {[.*]}` as well as `"wlList_5g": {[.*]}` and `"wlList_5g_2[0m
[30;1m109 | [0m[35m    # Keep the content inside the brackets as is[0m
[30;1m110 | [0m[35m    # Stop the regex search on the first occurence of the `]` so that we don't match the last `]`[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m    data = parse.unquote(data)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    # Step 5 - replace the keys by the regex[0m
[30;1m101 | [0m[35m    # Find all `, [a-zA-Z0-9_]+:` where [a-zA-Z0-9_]+ is the key and add `"` around the key[0m
[30;1m102 | [0m[35m    data = re.sub(r", ?([a-zA-Z0-9_]+):", r',"\1":', data)[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    # Step 6 - replace `customList` with `"customList"`[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35mdef process(data: dict[str, Any]) -> dict[AsusData, Any]:[0m
[30;1m259 | [0m[35m    """Process the update clients data."""[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    state: dict[AsusData, Any] = {}[0m
[30;1m262 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35m    try:[0m
[30;1m117 | [0m[35m        return read_json_content(data)[0m
[30;1m118 | [0m[35m    except JSONDecodeError:[0m
[30;1m119 | [0m[35m        _LOGGER.debug("Failed to read legacy update clients data")[0m
[30;1m120 | [0m[35m        return {}[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35mdef read_legacy_as_json(content: str) -> dict[str, Any]:[0m
[30;1m76 | [0m[35m    """Read update clients data from legacy firmwares as JSON."""[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    # Step 0 - replace all `'` with `"`[0m
[30;1m79 | [0m[35m    data = content.replace("'", '"')[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mdef read_legacy(content: str) -> dict[str, Any]:[0m
[30;1m53 | [0m[35m    """Read update clients data from legacy firmwares."""[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    clients: dict[str, Any] = {}[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m            _LOGGER.debug("Reading legacy update clients data")[0m
[30;1m37 | [0m[35m            return read_legacy(match.group(1))[0m
[30;1m38 | [0m[35m        # Modern firmware[0m
[30;1m39 | [0m[35m        _LOGGER.debug("Reading modern update clients data")[0m
[30;1m40 | [0m[35m        content = ([0m
[30;1m41 | [0m[35m            match.group(1)[0m
[30;1m42 | [0m[35m            .replace("fromNetworkmapd", '"fromNetworkmapd"')[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m    if match:[0m
[30;1m34 | [0m[35m        # Old firmwares have a different format[0m
[30;1m35 | [0m[35m        if "staticList" in match.group(1):[0m
[30;1m36 | [0m[35m            _LOGGER.debug("Reading legacy update clients data")[0m
[30;1m37 | [0m[35m            return read_legacy(match.group(1))[0m
[30;1m38 | [0m[35m        # Modern firmware[0m
[30;1m39 | [0m[35m        _LOGGER.debug("Reading modern update clients data")[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/update_clients.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef read(content: str) -> dict[str, Any]:[0m
[30;1m26 | [0m[35m    """Read update clients data"""[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    update_clients: dict[str, Any] = {}[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/openvpn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m        service=service,[0m
[30;1m108 | [0m[35m        arguments=service_arguments,[0m
[30;1m109 | [0m[35m        apply=True,[0m
[30;1m110 | [0m[35m        expect_modify=kwargs.get("expect_modify", False),[0m
[30;1m111 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/openvpn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m            ),[0m
[30;1m88 | [0m[35m            AsusOVPNServer.OFF: "stop_openvpnd;restart_samba;restart_dnsmasq;",[0m
[30;1m89 | [0m[35m        }[0m
[30;1m90 | [0m[35m        service = service_map.get(state) if isinstance(state, AsusOVPNServer) else None[0m
[30;1m91 | [0m[35m        service_arguments["VPNServer_enable"] = ([0m
[30;1m92 | [0m[35m            "1" if state == AsusOVPNServer.ON else "0"[0m
[30;1m93 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/openvpn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m            (AsusOVPNServer, AsusOVPNServer.ON): f"start_vpnserver{vpn_id}",[0m
[30;1m80 | [0m[35m            (AsusOVPNServer, AsusOVPNServer.OFF): f"stop_vpnserver{vpn_id}",[0m
[30;1m81 | [0m[35m        }[0m
[30;1m82 | [0m[35m        service = service_map.get((type(state), state))[0m
[30;1m83 | [0m[35m    else:[0m
[30;1m84 | [0m[35m        service_map = {[0m
[30;1m85 | [0m[35m            AsusOVPNServer.ON: ([0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/openvpn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m        service_arguments,[0m
[30;1m103 | [0m[35m    )[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Run the service[0m
[30;1m106 | [0m[35m    return await callback([0m
[30;1m107 | [0m[35m        service=service,[0m
[30;1m108 | [0m[35m        arguments=service_arguments,[0m
[30;1m109 | [0m[35m        apply=True,[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/openvpn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m            ),[0m
[30;1m88 | [0m[35m            AsusOVPNServer.OFF: "stop_openvpnd;restart_samba;restart_dnsmasq;",[0m
[30;1m89 | [0m[35m        }[0m
[30;1m90 | [0m[35m        service = service_map.get(state) if isinstance(state, AsusOVPNServer) else None[0m
[30;1m91 | [0m[35m        service_arguments["VPNServer_enable"] = ([0m
[30;1m92 | [0m[35m            "1" if state == AsusOVPNServer.ON else "0"[0m
[30;1m93 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/openvpn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m            (AsusOVPNServer, AsusOVPNServer.ON): f"start_vpnserver{vpn_id}",[0m
[30;1m80 | [0m[35m            (AsusOVPNServer, AsusOVPNServer.OFF): f"stop_vpnserver{vpn_id}",[0m
[30;1m81 | [0m[35m        }[0m
[30;1m82 | [0m[35m        service = service_map.get((type(state), state))[0m
[30;1m83 | [0m[35m    else:[0m
[30;1m84 | [0m[35m        service_map = {[0m
[30;1m85 | [0m[35m            AsusOVPNServer.ON: ([0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/openvpn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    service_map: dict[Any, str][0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    # Get the correct service call[0m
[30;1m70 | [0m[35m    # This will be firmware dependent[0m
[30;1m71 | [0m[35m    if ([0m
[30;1m72 | [0m[35m        not identity[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m60 | [0m[35msession = aiohttp.ClientSession(loop=loop)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m63 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m64 | [0m[35m    username="admin",               #required[0m
[30;1m65 | [0m[35m    password="password",            #required[0m
[30;1m66 | [0m[35m    use_ssl=True,                   #optional[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m### WiFi 4 | 802.11n[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m| Model                                                           | Status       | Tested firmware |[0m
[30;1m185 | [0m[35m| --------------------------------------------------------------- | ------------ | --------------- |[0m
[30;1m186 | [0m[35m| [RT-N66U](https://asusrouter.vaskivskyi.com/devices/RT-N66U.md) | 💚 Confirmed |                 |[0m
[30;1m187 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m"nofollow sponsored" target="_blank">find it</a> |[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m### WiFi 5 | 802.11ac[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m| Model                                                                                     | Status[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mdel                                                                                          | Statu[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35mref="https://amzn.to/48F5wiB" rel="nofollow sponsored" target="_blank">find it</a> |[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m### WiFi 6e | 802.11axe[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m| Model                                                                           | Status          [0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35mdisconnect())[0m
[30;1m79 | [0m[35mloop.run_until_complete(session.close())[0m
[30;1m80 | [0m[35m```[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m## Supported devices[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mAsusRouter supports virtually every AsusWRT-powered device.[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m### WiFi 7 | 802.11be[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m| Model                                                                           | Status          [0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m# Create aiohttp session[0m
[30;1m60 | [0m[35msession = aiohttp.ClientSession(loop=loop)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mrouter = AsusRouter(                #required - both IP and URL supported[0m
[30;1m63 | [0m[35m    hostname="router.my.address",   #required[0m
[30;1m64 | [0m[35m    username="admin",               #required[0m
[30;1m65 | [0m[35m    password="password",            #required[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35mInstallation of the latest release is available from PyPI:[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m```[0m
[30;1m44 | [0m[35mpip install asusrouter[0m
[30;1m45 | [0m[35m```[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m## Usage[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m    if endpoints[Endpoint.ONBOARDING] is True:[0m
[30;1m226 | [0m[35m        onboarding = process_onboarding([0m
[30;1m227 | [0m[35m            read_onboarding(contents[Endpoint.ONBOARDING])[0m
[30;1m228 | [0m[35m        ).get(AsusData.AIMESH, {})[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m    return (endpoints, onboarding)[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m    if not identity.get("mac"):[0m
[30;1m178 | [0m[35m        if identity.get("lan_mac"):[0m
[30;1m179 | [0m[35m            identity["mac"] = identity["lan_mac"][0m
[30;1m180 | [0m[35m        elif identity.get("wan_mac"):[0m
[30;1m181 | [0m[35m            identity["mac"] = identity["wan_mac"][0m
[30;1m182 | [0m[35m    # Remove extra MACs[0m
[30;1m183 | [0m[35m    identity.pop("lan_mac")[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    # MAC (for some Merlin firmwares missing label_mac)[0m
[30;1m177 | [0m[35m    if not identity.get("mac"):[0m
[30;1m178 | [0m[35m        if identity.get("lan_mac"):[0m
[30;1m179 | [0m[35m            identity["mac"] = identity["lan_mac"][0m
[30;1m180 | [0m[35m        elif identity.get("wan_mac"):[0m
[30;1m181 | [0m[35m            identity["mac"] = identity["wan_mac"][0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m    identity = clean_dict(identity)[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    # MAC (for some Merlin firmwares missing label_mac)[0m
[30;1m177 | [0m[35m    if not identity.get("mac"):[0m
[30;1m178 | [0m[35m        if identity.get("lan_mac"):[0m
[30;1m179 | [0m[35m            identity["mac"] = identity["lan_mac"][0m
[30;1m180 | [0m[35m        elif identity.get("wan_mac"):[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m    identity["endpoints"][EndpointTools.AURA] = identity.get("aura", False)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # Check onboarding to get nice model name[0m
[30;1m129 | [0m[35m    this_device = onboarding.get(identity["mac"])[0m
[30;1m130 | [0m[35m    if isinstance(this_device, AiMeshDevice):[0m
[30;1m131 | [0m[35m        identity["model"] = this_device.model[0m
[30;1m132 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/identity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m    identity["endpoints"] = endpoints[0m
[30;1m124 | [0m[35m    _LOGGER.debug("Endpoints checked")[0m
[30;1m125 | [0m[35m    # Manually assign Aura endpoint value[0m
[30;1m126 | [0m[35m    identity["endpoints"][EndpointTools.AURA] = identity.get("aura", False)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # Check onboarding to get nice model name[0m
[30;1m129 | [0m[35m    this_device = onboarding.get(identity["mac"])[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/identity.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m    return AsusDevice(**identity)[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m# UPDATE THIS METHOD[0m
[30;1m148 | [0m[35mdef _read_nvram(data: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m149 | [0m[35m    """Read the NVRAM identity data."""[0m
[30;1m150 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/identity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m    # Manually assign Aura endpoint value[0m
[30;1m126 | [0m[35m    identity["endpoints"][EndpointTools.AURA] = identity.get("aura", False)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # Check onboarding to get nice model name[0m
[30;1m129 | [0m[35m    this_device = onboarding.get(identity["mac"])[0m
[30;1m130 | [0m[35m    if isinstance(this_device, AiMeshDevice):[0m
[30;1m131 | [0m[35m        identity["model"] = this_device.model[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m        payload_to_send = quote(payload) if payload else None[0m
[30;1m399 | [0m[35m[0m
[30;1m400 | [0m[35m        # Send the request[0m
[30;1m401 | [0m[35m        async with self._session.request([0m
[30;1m402 | [0m[35m            request_type.value,[0m
[30;1m403 | [0m[35m            url,[0m
[30;1m404 | [0m[35m            data=payload_to_send if request_type == RequestType.POST else None,[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m            # Convert the response to JSON[0m
[30;1m228 | [0m[35m            content = json.loads(resp_content)[0m
[30;1m229 | [0m[35m            # Get the auth_token value from the headers[0m
[30;1m230 | [0m[35m            self._token = content.get("asus_token")[0m
[30;1m231 | [0m[35m            if not self._token:[0m
[30;1m232 | [0m[35m                _LOGGER.error("No token received")[0m
[30;1m233 | [0m[35m                return False[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m432 | [0m[35m        if not self._connected:[0m
[30;1m433 | [0m[35m            return[0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35m        _LOGGER.debug("Resetting connection to %s", self._hostname)[0m
[30;1m436 | [0m[35m[0m
[30;1m437 | [0m[35m        self._connected = False[0m
[30;1m438 | [0m[35m        self._token = None[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m387 | [0m[35m            headers = self._header[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m        # Generate the url[0m
[30;1m390 | [0m[35m        url = f"{self._http}://{self._hostname}:{self._port}/{endpoint.value}"[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m        # Add get parameters if needed[0m
[30;1m393 | [0m[35m        if request_type == RequestType.GET and payload:[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m        # Send the request[0m
[30;1m355 | [0m[35m        _LOGGER.debug([0m
[30;1m356 | [0m[35m            "Sending `%s` request to `%s`", request_type, self._hostname[0m
[30;1m357 | [0m[35m        )[0m
[30;1m358 | [0m[35m        return await self._send_request([0m
[30;1m359 | [0m[35m            endpoint, payload, headers, request_type[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m        # If not connected, try to connect[0m
[30;1m344 | [0m[35m        if not self._connected:[0m
[30;1m345 | [0m[35m            _LOGGER.debug("Not connected to %s. Connecting...", self._hostname)[0m
[30;1m346 | [0m[35m            await self.async_connect()[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # If still not connected, raise an error[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m315 | [0m[35m            ) from ex[0m
[30;1m316 | [0m[35m        except (aiohttp.ClientConnectionError, aiohttp.ClientOSError) as ex:[0m
[30;1m317 | [0m[35m            raise AsusRouterConnectionError([0m
[30;1m318 | [0m[35m                f"Cannot connect to `{self._hostname}` on port "[0m
[30;1m319 | [0m[35m                f"`{self._port}`. Failed in `_send_request` with error: `{ex}`"[0m
[30;1m320 | [0m[35m            ) from ex[0m
[30;1m321 | [0m[35m        except (asyncio.TimeoutError, asyncio.CancelledError) as ex:[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m310 | [0m[35m        except aiohttp.ClientConnectorError as ex:[0m
[30;1m311 | [0m[35m            self.reset_connection()[0m
[30;1m312 | [0m[35m            raise AsusRouterConnectionError([0m
[30;1m313 | [0m[35m                f"Cannot connect to `{self._hostname}` on port "[0m
[30;1m314 | [0m[35m                f"`{self._port}`. Failed in `_send_request` with error: `{ex}`"[0m
[30;1m315 | [0m[35m            ) from ex[0m
[30;1m316 | [0m[35m        except (aiohttp.ClientConnectionError, aiohttp.ClientOSError) as ex:[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m264 | [0m[35m            return True[0m
[30;1m265 | [0m[35m        except AsusRouterError as ex:[0m
[30;1m266 | [0m[35m            _LOGGER.debug([0m
[30;1m267 | [0m[35m                "Error while disconnecting from %s: %s", self._hostname, ex[0m
[30;1m268 | [0m[35m            )[0m
[30;1m269 | [0m[35m            return False[0m
[30;1m270 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m260 | [0m[35m        except AsusRouterLogoutError:[0m
[30;1m261 | [0m[35m            # Loged out successfully[0m
[30;1m262 | [0m[35m            self.reset_connection()[0m
[30;1m263 | [0m[35m            _LOGGER.debug("Disconnected from %s", self._hostname)[0m
[30;1m264 | [0m[35m            return True[0m
[30;1m265 | [0m[35m        except AsusRouterError as ex:[0m
[30;1m266 | [0m[35m            _LOGGER.debug([0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m        # Check that we are connected[0m
[30;1m253 | [0m[35m        if not self._connected:[0m
[30;1m254 | [0m[35m            _LOGGER.debug("Not connected to %s", self._hostname)[0m
[30;1m255 | [0m[35m            return True[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m        # Request logout[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m247 | [0m[35m    async def async_disconnect(self) -> bool:[0m
[30;1m248 | [0m[35m        """Disconnect from the device."""[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        _LOGGER.debug("Initializing disconnection from %s", self._hostname)[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m        # Check that we are connected[0m
[30;1m253 | [0m[35m        if not self._connected:[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m            # Mark as connected[0m
[30;1m242 | [0m[35m            self._connected = True[0m
[30;1m243 | [0m[35m            _LOGGER.debug("Connected to %s", self._hostname)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m            return True[0m
[30;1m246 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m219 | [0m[35m            except Exception as ex:  # pylint: disable=broad-except[0m
[30;1m220 | [0m[35m                _LOGGER.debug([0m
[30;1m221 | [0m[35m                    "Unexpected error while connecting to %s: %s",[0m
[30;1m222 | [0m[35m                    self._hostname,[0m
[30;1m223 | [0m[35m                    ex,[0m
[30;1m224 | [0m[35m                )[0m
[30;1m225 | [0m[35m                raise ex[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m193 | [0m[35m        _lock = lock or self._connection_lock[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m        async with _lock:[0m
[30;1m196 | [0m[35m            _LOGGER.debug("Initializing connection to %s", self._hostname)[0m
[30;1m197 | [0m[35m            self._connected = False[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m            # Generate payload and header for login request[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m187 | [0m[35m        # Check that we are connected[0m
[30;1m188 | [0m[35m        # so that we don't try to go through lock again[0m
[30;1m189 | [0m[35m        if self._connected:[0m
[30;1m190 | [0m[35m            _LOGGER.debug("Already connected to %s", self._hostname)[0m
[30;1m191 | [0m[35m            return True[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        _lock = lock or self._connection_lock[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m175 | [0m[35m            )[0m
[30;1m176 | [0m[35m            return True[0m
[30;1m177 | [0m[35m        except asyncio.TimeoutError:[0m
[30;1m178 | [0m[35m            _LOGGER.error("Connection to %s timed out", self._hostname)[0m
[30;1m179 | [0m[35m            return False[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    async def _async_connect_with_lock([0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m127 | [0m[35m        """Factory method to create and initialize a connection."""[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        connection = cls([0m
[30;1m130 | [0m[35m            hostname=hostname,[0m
[30;1m131 | [0m[35m            username=username,[0m
[30;1m132 | [0m[35m            password=password,[0m
[30;1m133 | [0m[35m            port=port,[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m127 | [0m[35m        """Factory method to create and initialize a connection."""[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        connection = cls([0m
[30;1m130 | [0m[35m            hostname=hostname,[0m
[30;1m131 | [0m[35m            username=username,[0m
[30;1m132 | [0m[35m            password=password,[0m
[30;1m133 | [0m[35m            port=port,[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m115 | [0m[35m    @classmethod[0m
[30;1m116 | [0m[35m    async def create([0m
[30;1m117 | [0m[35m        cls,[0m
[30;1m118 | [0m[35m        hostname: str,[0m
[30;1m119 | [0m[35m        username: str,[0m
[30;1m120 | [0m[35m        password: str,[0m
[30;1m121 | [0m[35m        port: Optional[int] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m68 | [0m[35m        self._timeout: int = timeout or DEFAULT_TIMEOUT[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        # Hostname and credentials[0m
[30;1m71 | [0m[35m        self._hostname = hostname[0m
[30;1m72 | [0m[35m        self._username = username[0m
[30;1m73 | [0m[35m        self._password = password[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m68 | [0m[35m        self._timeout: int = timeout or DEFAULT_TIMEOUT[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        # Hostname and credentials[0m
[30;1m71 | [0m[35m        self._hostname = hostname[0m
[30;1m72 | [0m[35m        self._username = username[0m
[30;1m73 | [0m[35m        self._password = password[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m58 | [0m[35m    ):[0m
[30;1m59 | [0m[35m        """Initialize connection."""[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        _LOGGER.debug("Initializing a new connection to `%s`", hostname)[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # Initialize parameters for connection[0m
[30;1m64 | [0m[35m        self._token: Optional[str] = None[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m.hostname[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    def __init__(  # pylint: disable=too-many-arguments[0m
[30;1m49 | [0m[35m        self,[0m
[30;1m50 | [0m[35m        hostname: str,[0m
[30;1m51 | [0m[35m        username: str,[0m
[30;1m52 | [0m[35m        password: str,[0m
[30;1m53 | [0m[35m        port: Optional[int] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35m        self._manage_session = True[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        # Timeout for the session[0m
[30;1m149 | [0m[35m        timeout = aiohttp.ClientTimeout(total=self._timeout)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        # Create the session[0m
[30;1m152 | [0m[35m        return aiohttp.ClientSession([0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m        # If we create a new session, we will manage it[0m
[30;1m146 | [0m[35m        self._manage_session = True[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        # Timeout for the session[0m
[30;1m149 | [0m[35m        timeout = aiohttp.ClientTimeout(total=self._timeout)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        # Create the session[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        self._header: Optional[dict[str, str]] = None[0m
[30;1m66 | [0m[35m        self._connected: bool = False[0m
[30;1m67 | [0m[35m        self._connection_lock: asyncio.Lock = asyncio.Lock()[0m
[30;1m68 | [0m[35m        self._timeout: int = timeout or DEFAULT_TIMEOUT[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        # Hostname and credentials[0m
[30;1m71 | [0m[35m        self._hostname = hostname[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mfrom __future__ import annotations[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport asyncio[0m
[30;1m9 | [0m[35mimport base64[0m
[30;1m10 | [0m[35mimport json[0m
[30;1m11 | [0m[35mimport logging[0m
[30;1m12 | [0m[35mfrom typing import Any, Awaitable, Callable, Optional, Tuple[0m
[30;1m13 | [0m[35mfrom urllib.parse import quote[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m    if value is None:[0m
[30;1m77 | [0m[35m        value = 0[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    return CONNECTION_TYPE.get(value, ConnectionType.WIRED)[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    ALLOW = "allow"[0m
[30;1m54 | [0m[35m    BLOCK = "block"[0m
[30;1m55 | [0m[35m    TIME = "time"[0m
[30;1m56 | [0m[35m    UNKNOWN = "unknown"[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m        """Update the state."""[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m        self.data = data[0m
[30;1m80 | [0m[35m        # Set timestamp to the current utc time[0m
[30;1m81 | [0m[35m        self.timestamp = datetime.now(timezone.utc)[0m
[30;1m82 | [0m[35m        # Set to inactive[0m
[30;1m83 | [0m[35m        self.stop()[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        return (True, needed_time, last_id)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    if expect_modify:[0m
[30;1m71 | [0m[35m        return (safe_bool(result.get("modify")) or False, needed_time, last_id)[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    return (True, needed_time, last_id)[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        needed_time = 5[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    # Special services that won't return any result[0m
[30;1m67 | [0m[35m    if arguments.get("action_mode") == "update_client_list":[0m
[30;1m68 | [0m[35m        return (True, needed_time, last_id)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    if expect_modify:[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m    last_id = result.get("id") or arguments.get("id")[0m
[30;1m58 | [0m[35m    last_id = safe_int(last_id)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    needed_time = safe_int(result.get("restart_needed_time"))[0m
[30;1m61 | [0m[35m    # For all the services with setting ID we better wait[0m
[30;1m62 | [0m[35m    # before we will get actual state change[0m
[30;1m63 | [0m[35m    if needed_time is None and last_id is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        "Service `%s` run with arguments `%s`. Result: `%s`", service, arguments, result[0m
[30;1m55 | [0m[35m    )[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    last_id = result.get("id") or arguments.get("id")[0m
[30;1m58 | [0m[35m    last_id = safe_int(last_id)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    needed_time = safe_int(result.get("restart_needed_time"))[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        "Service `%s` run with arguments `%s`. Result: `%s`", service, arguments, result[0m
[30;1m55 | [0m[35m    )[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    last_id = result.get("id") or arguments.get("id")[0m
[30;1m58 | [0m[35m    last_id = safe_int(last_id)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    needed_time = safe_int(result.get("restart_needed_time"))[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    if service is not None:[0m
[30;1m48 | [0m[35m        # Check if the service is run[0m
[30;1m49 | [0m[35m        run_service = result.get("run_service", None)[0m
[30;1m50 | [0m[35m        if run_service != service:[0m
[30;1m51 | [0m[35m            raise AsusRouterServiceError(f"Service not run. Raw result: {result}")[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        raise ex[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    if service is not None:[0m
[30;1m48 | [0m[35m        # Check if the service is run[0m
[30;1m49 | [0m[35m        run_service = result.get("run_service", None)[0m
[30;1m50 | [0m[35m        if run_service != service:[0m
[30;1m51 | [0m[35m            raise AsusRouterServiceError(f"Service not run. Raw result: {result}")[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    except Exception as ex:  # pylint: disable=broad-except[0m
[30;1m45 | [0m[35m        raise ex[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    if service is not None:[0m
[30;1m48 | [0m[35m        # Check if the service is run[0m
[30;1m49 | [0m[35m        run_service = result.get("run_service", None)[0m
[30;1m50 | [0m[35m        if run_service != service:[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    # Service call provided[0m
[30;1m27 | [0m[35m    if service is not None:[0m
[30;1m28 | [0m[35m        commands["rc_service"] = service[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # Check arguments[0m
[30;1m31 | [0m[35m    if not arguments:[0m
[30;1m32 | [0m[35m        arguments = {}[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m    commands = {}[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    # Service call provided[0m
[30;1m27 | [0m[35m    if service is not None:[0m
[30;1m28 | [0m[35m        commands["rc_service"] = service[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # Check arguments[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m    # Generate commands[0m
[30;1m24 | [0m[35m    commands = {}[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    # Service call provided[0m
[30;1m27 | [0m[35m    if service is not None:[0m
[30;1m28 | [0m[35m        commands["rc_service"] = service[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/led.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        return False[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # Get the sysinfo[0m
[30;1m52 | [0m[35m    sysinfo = identity.endpoints.get(Endpoint.SYSINFO)[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    # Only when LEDs are off and if sysinfo is available[0m
[30;1m55 | [0m[35m    if not sysinfo or state == AsusLED.ON:[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/led.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m) -> bool:[0m
[30;1m43 | [0m[35m    """Keep the LED state."""[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    identity = kwargs.get("identity")[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    # Check if identity is available and if endpoints are defined[0m
[30;1m48 | [0m[35m    if identity is None or not identity.endpoints:[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/led.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        service="start_ctrl_led",[0m
[30;1m32 | [0m[35m        arguments=arguments,[0m
[30;1m33 | [0m[35m        apply=True,[0m
[30;1m34 | [0m[35m        expect_modify=kwargs.get("expect_modify", False),[0m
[30;1m35 | [0m[35m    )[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/led.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m    # Prepare the arguments[0m
[30;1m27 | [0m[35m    arguments = {"led_val": state.value}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    # Run the service[0m
[30;1m30 | [0m[35m    return await callback([0m
[30;1m31 | [0m[35m        service="start_ctrl_led",[0m
[30;1m32 | [0m[35m        arguments=arguments,[0m
[30;1m33 | [0m[35m        apply=True,[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m    # Data preprocessing[0m
[30;1m757 | [0m[35m    _dataratedown = remove_units(dsl_info.get("dsllog_dataratedown"))[0m
[30;1m758 | [0m[35m    _datarateup = remove_units(dsl_info.get("dsllog_datarateup"))[0m
[30;1m759 | [0m[35m[0m
[30;1m760 | [0m[35m    dsl["datarate"] = {[0m
[30;1m761 | [0m[35m        "down": safe_int(_dataratedown, 0),[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m754 | [0m[35m    dsl: dict[str, Any] = {}[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m    # Data preprocessing[0m
[30;1m757 | [0m[35m    _dataratedown = remove_units(dsl_info.get("dsllog_dataratedown"))[0m
[30;1m758 | [0m[35m    _datarateup = remove_units(dsl_info.get("dsllog_datarateup"))[0m
[30;1m759 | [0m[35m[0m
[30;1m760 | [0m[35m    dsl["datarate"] = {[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m735 | [0m[35m            info[key.format(index)[4:]] = ([0m
[30;1m736 | [0m[35m                method(data.get(key.format(index)))[0m
[30;1m737 | [0m[35m                if method[0m
[30;1m738 | [0m[35m                else data.get(key.format(index))[0m
[30;1m739 | [0m[35m            )[0m
[30;1m740 | [0m[35m        wlan[interface.value] = info[0m
[30;1m741 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m733 | [0m[35m        for pair in MAP_WLAN:[0m
[30;1m734 | [0m[35m            key, method = safe_unpack_key(pair)[0m
[30;1m735 | [0m[35m            info[key.format(index)[4:]] = ([0m
[30;1m736 | [0m[35m                method(data.get(key.format(index)))[0m
[30;1m737 | [0m[35m                if method[0m
[30;1m738 | [0m[35m                else data.get(key.format(index))[0m
[30;1m739 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m711 | [0m[35m            for client in status:[0m
[30;1m712 | [0m[35m                if client.get("index") in wireguard["clients"]:[0m
[30;1m713 | [0m[35m                    wireguard["clients"][client.get("index")]["state"] = ([0m
[30;1m714 | [0m[35m                        ConnectionState(client.get("status"))[0m
[30;1m715 | [0m[35m                    )[0m
[30;1m716 | [0m[35m[0m
[30;1m717 | [0m[35m    # Remove the `status` value[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m710 | [0m[35m        if status:[0m
[30;1m711 | [0m[35m            for client in status:[0m
[30;1m712 | [0m[35m                if client.get("index") in wireguard["clients"]:[0m
[30;1m713 | [0m[35m                    wireguard["clients"][client.get("index")]["state"] = ([0m
[30;1m714 | [0m[35m                        ConnectionState(client.get("status"))[0m
[30;1m715 | [0m[35m                    )[0m
[30;1m716 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m709 | [0m[35m        status = wireguard["status"].get("client_status")[0m
[30;1m710 | [0m[35m        if status:[0m
[30;1m711 | [0m[35m            for client in status:[0m
[30;1m712 | [0m[35m                if client.get("index") in wireguard["clients"]:[0m
[30;1m713 | [0m[35m                    wireguard["clients"][client.get("index")]["state"] = ([0m
[30;1m714 | [0m[35m                        ConnectionState(client.get("status"))[0m
[30;1m715 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m706 | [0m[35m            wireguard["clients"][num] = client[0m
[30;1m707 | [0m[35m[0m
[30;1m708 | [0m[35m    if "status" in wireguard:[0m
[30;1m709 | [0m[35m        status = wireguard["status"].get("client_status")[0m
[30;1m710 | [0m[35m        if status:[0m
[30;1m711 | [0m[35m            for client in status:[0m
[30;1m712 | [0m[35m                if client.get("index") in wireguard["clients"]:[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m699 | [0m[35m        client = {}[0m
[30;1m700 | [0m[35m        for keys in MAP_WIREGUARD_CLIENT:[0m
[30;1m701 | [0m[35m            key, key_to_use, method = safe_unpack_keys(keys)[0m
[30;1m702 | [0m[35m            state_value = data.get(f"wgs1_c{num}_{key}")[0m
[30;1m703 | [0m[35m            if state_value:[0m
[30;1m704 | [0m[35m                client[key_to_use] = run_method(state_value, method)[0m
[30;1m705 | [0m[35m        if client:[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m689 | [0m[35m    # Server data[0m
[30;1m690 | [0m[35m    for keys in MAP_WIREGUARD_SERVER:[0m
[30;1m691 | [0m[35m        key, key_to_use, method = safe_unpack_keys(keys)[0m
[30;1m692 | [0m[35m        state_value = data.get(key)[0m
[30;1m693 | [0m[35m        if state_value:[0m
[30;1m694 | [0m[35m            wireguard[key_to_use] = run_method(state_value, method)[0m
[30;1m695 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m645 | [0m[35m[0m
[30;1m646 | [0m[35m    # Check state on links[0m
[30;1m647 | [0m[35m    for num in (0, 1):[0m
[30;1m648 | [0m[35m        if wan[num].get("link") == ConnectionState.DISCONNECTED:[0m
[30;1m649 | [0m[35m            wan[num]["state"] = ConnectionStatus.DISCONNECTED[0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m    # WAN aggregation[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m            interface[extra_key] = {}[0m
[30;1m632 | [0m[35m            for keys in MAP_WAN_ITEM_X:[0m
[30;1m633 | [0m[35m                key, key_to_use, method = safe_unpack_keys(keys)[0m
[30;1m634 | [0m[35m                state_value = data.get(f"wan{num}_{extra}{key}")[0m
[30;1m635 | [0m[35m                if state_value is not None:[0m
[30;1m636 | [0m[35m                    interface[extra_key][key_to_use] = run_method([0m
[30;1m637 | [0m[35m                        state_value, method[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m624 | [0m[35m        interface = {}[0m
[30;1m625 | [0m[35m        for keys in MAP_WAN_ITEM:[0m
[30;1m626 | [0m[35m            key, key_to_use, method = safe_unpack_keys(keys)[0m
[30;1m627 | [0m[35m            state_value = data.get(f"wan{num}_{key}")[0m
[30;1m628 | [0m[35m            if state_value is not None:[0m
[30;1m629 | [0m[35m                interface[key_to_use] = run_method(state_value, method)[0m
[30;1m630 | [0m[35m        for extra, extra_key in zip(("", "x"), ("main", "extra")):[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m615 | [0m[35m    wan["internet"] = {}[0m
[30;1m616 | [0m[35m    for keys in MAP_WAN:[0m
[30;1m617 | [0m[35m        key, key_to_use, method = safe_unpack_keys(keys)[0m
[30;1m618 | [0m[35m        state_value = data.get(key)[0m
[30;1m619 | [0m[35m        if state_value is not None:[0m
[30;1m620 | [0m[35m            wan["internet"][key_to_use] = run_method(state_value, method)[0m
[30;1m621 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m597 | [0m[35m        client = {}[0m
[30;1m598 | [0m[35m        for keys in MAP_VPNC_WIREGUARD:[0m
[30;1m599 | [0m[35m            key, key_to_use, method = safe_unpack_keys(keys)[0m
[30;1m600 | [0m[35m            state_value = data.get(f"wgc{num}_{key}")[0m
[30;1m601 | [0m[35m            if state_value:[0m
[30;1m602 | [0m[35m                client[key_to_use] = run_method(state_value, method)[0m
[30;1m603 | [0m[35m        if client:[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m523 | [0m[35m            vpnc_unit += 1[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m    # Get clients status[0m
[30;1m526 | [0m[35m    get_vpnc_status = data.get("get_vpnc_status")[0m
[30;1m527 | [0m[35m    if get_vpnc_status:[0m
[30;1m528 | [0m[35m        clients = get_vpnc_status.split("<")[0m
[30;1m529 | [0m[35m        for client in clients:[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m    # Get client list[0m
[30;1m494 | [0m[35m    vpnc_clientlist = ([0m
[30;1m495 | [0m[35m        data.get("vpnc_clientlist", "")[0m
[30;1m496 | [0m[35m        .replace("&#62", ">")[0m
[30;1m497 | [0m[35m        .replace("&#60", "<")[0m
[30;1m498 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m    # If the last step is a result, then the test is finished[0m
[30;1m479 | [0m[35m    # and we already have all the data[0m
[30;1m480 | [0m[35m    if last_step.get("type") != "result":[0m
[30;1m481 | [0m[35m        return {}[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m    return last_step[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m448 | [0m[35m    # convert bandwidth from Bps to bps[0m
[30;1m449 | [0m[35m    for speed in ("download", "upload"):[0m
[30;1m450 | [0m[35m        if speed in speedtest:[0m
[30;1m451 | [0m[35m            speedtest[speed]["bandwidth"] = 8 * speedtest[speed].get([0m
[30;1m452 | [0m[35m                "bandwidth", 0[0m
[30;1m453 | [0m[35m            )[0m
[30;1m454 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m        speedtest[key] = value[0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m    # Convert the timestamp to UTC[0m
[30;1m440 | [0m[35m    speedtest["timestamp"] = safe_datetime(speedtest.get("timestamp"))[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m    # Rename servers list[0m
[30;1m443 | [0m[35m    if "download" in speedtest:[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m    # Convert the data[0m
[30;1m421 | [0m[35m    for keys in MAP_SPEEDTEST:[0m
[30;1m422 | [0m[35m        key, key_to_use, method = safe_unpack_keys(keys)[0m
[30;1m423 | [0m[35m        state_value = data.get(key)[0m
[30;1m424 | [0m[35m        if state_value:[0m
[30;1m425 | [0m[35m            speedtest[key_to_use] = run_method(state_value, method)[0m
[30;1m426 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m403 | [0m[35m    ram = {[0m
[30;1m404 | [0m[35m        "free": safe_int(memory_usage.get("mem_free")),[0m
[30;1m405 | [0m[35m        "total": safe_int(memory_usage.get("mem_total")),[0m
[30;1m406 | [0m[35m        "used": safe_int(memory_usage.get("mem_used")),[0m
[30;1m407 | [0m[35m    }[0m
[30;1m408 | [0m[35m    # Calculate usage in percents[0m
[30;1m409 | [0m[35m    if "used" in ram and "total" in ram:[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m402 | [0m[35m    # Populate RAM with known values[0m
[30;1m403 | [0m[35m    ram = {[0m
[30;1m404 | [0m[35m        "free": safe_int(memory_usage.get("mem_free")),[0m
[30;1m405 | [0m[35m        "total": safe_int(memory_usage.get("mem_total")),[0m
[30;1m406 | [0m[35m        "used": safe_int(memory_usage.get("mem_used")),[0m
[30;1m407 | [0m[35m    }[0m
[30;1m408 | [0m[35m    # Calculate usage in percents[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m    # Populate RAM with known values[0m
[30;1m403 | [0m[35m    ram = {[0m
[30;1m404 | [0m[35m        "free": safe_int(memory_usage.get("mem_free")),[0m
[30;1m405 | [0m[35m        "total": safe_int(memory_usage.get("mem_total")),[0m
[30;1m406 | [0m[35m        "used": safe_int(memory_usage.get("mem_used")),[0m
[30;1m407 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m369 | [0m[35m    )[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m    # Rules[0m
[30;1m372 | [0m[35m    pf_list = data.get(KEY_PORT_FORWARDING_LIST)[0m
[30;1m373 | [0m[35m    if pf_list:[0m
[30;1m374 | [0m[35m        rules = [][0m
[30;1m375 | [0m[35m        rule_list = pf_list.split("&#60")[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m    # State[0m
[30;1m367 | [0m[35m    port_forwarding["state"] = AsusPortForwarding([0m
[30;1m368 | [0m[35m        safe_int(data.get(KEY_PORT_FORWARDING_STATE), default=-999)[0m
[30;1m369 | [0m[35m    )[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m    # Rules[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m    # Block all[0m
[30;1m351 | [0m[35m    parental_control["block_all"] = AsusBlockAll([0m
[30;1m352 | [0m[35m        safe_int(data.get(KEY_PC_BLOCK_ALL), default=-999)[0m
[30;1m353 | [0m[35m    )[0m
[30;1m354 | [0m[35m[0m
[30;1m355 | [0m[35m    # Rules[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    # State[0m
[30;1m346 | [0m[35m    parental_control["state"] = AsusParentalControl([0m
[30;1m347 | [0m[35m        safe_int(data.get(KEY_PC_STATE), default=-999)[0m
[30;1m348 | [0m[35m    )[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m    # Block all[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m            server[key_to_use] = run_method(state_value, method)[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m    # Clients[0m
[30;1m332 | [0m[35m    clients = server.get("clients", "")[0m
[30;1m333 | [0m[35m    clients = clients.replace("&#62", ">").replace("&#60", "<")[0m
[30;1m334 | [0m[35m    clients = clients[1:-1].split("><")[0m
[30;1m335 | [0m[35m    server["clients"] = clients[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m    # Server data[0m
[30;1m325 | [0m[35m    for keys in MAP_OVPN_SERVER_388:[0m
[30;1m326 | [0m[35m        key, key_to_use, method = safe_unpack_keys(keys)[0m
[30;1m327 | [0m[35m        state_value = data.get(key)[0m
[30;1m328 | [0m[35m        if state_value:[0m
[30;1m329 | [0m[35m            server[key_to_use] = run_method(state_value, method)[0m
[30;1m330 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m306 | [0m[35m        data = {}[0m
[30;1m307 | [0m[35m        for traffic_type in ("rx", "tx"):[0m
[30;1m308 | [0m[35m            # Convert string with HEX value to int[0m
[30;1m309 | [0m[35m            value = safe_int(raw.get(f"{key}_{traffic_type}"), base=16)[0m
[30;1m310 | [0m[35m            # Check that value is integer[0m
[30;1m311 | [0m[35m            if isinstance(value, int):[0m
[30;1m312 | [0m[35m                data[traffic_type] = value[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m        # Calculate speed for each traffic type[0m
[30;1m282 | [0m[35m        for traffic_type, traffic_value in network[interface].items():[0m
[30;1m283 | [0m[35m            prev_traffic_value = prev_network[interface].get(traffic_type)[0m
[30;1m284 | [0m[35m            # Calculate speed only if previous value is available[0m
[30;1m285 | [0m[35m            if prev_traffic_value:[0m
[30;1m286 | [0m[35m                interface_speed[f"{traffic_type}_speed"] = 8 * safe_speed([0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m                info[key.format(f"{index}.{gid}")[6:]] = ([0m
[30;1m238 | [0m[35m                    method(data.get(key.format(f"{index}.{gid}")))[0m
[30;1m239 | [0m[35m                    if method[0m
[30;1m240 | [0m[35m                    else data.get(key.format(f"{index}.{gid}"))[0m
[30;1m241 | [0m[35m                )[0m
[30;1m242 | [0m[35m            gwlan[f"{interface.value}_{gid}"] = info[0m
[30;1m243 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m            for pair in MAP_GWLAN:[0m
[30;1m236 | [0m[35m                key, method = safe_unpack_key(pair)[0m
[30;1m237 | [0m[35m                info[key.format(f"{index}.{gid}")[6:]] = ([0m
[30;1m238 | [0m[35m                    method(data.get(key.format(f"{index}.{gid}")))[0m
[30;1m239 | [0m[35m                    if method[0m
[30;1m240 | [0m[35m                    else data.get(key.format(f"{index}.{gid}"))[0m
[30;1m241 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m    if "ookla_state" in data:[0m
[30;1m138 | [0m[35m        speedtest = process_speedtest(data)[0m
[30;1m139 | [0m[35m        state[AsusData.SPEEDTEST_RESULT] = speedtest.get("result")[0m
[30;1m140 | [0m[35m        state[AsusData.SPEEDTEST] = speedtest.get("data")[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    # VPNC[0m
[30;1m143 | [0m[35m    if "vpnc_clientlist" in data:[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    # Speedtest[0m
[30;1m137 | [0m[35m    if "ookla_state" in data:[0m
[30;1m138 | [0m[35m        speedtest = process_speedtest(data)[0m
[30;1m139 | [0m[35m        state[AsusData.SPEEDTEST_RESULT] = speedtest.get("result")[0m
[30;1m140 | [0m[35m        state[AsusData.SPEEDTEST] = speedtest.get("data")[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    # VPNC[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    # RAM[0m
[30;1m132 | [0m[35m    if "memory_usage" in data:[0m
[30;1m133 | [0m[35m        memory_usage = data.get("memory_usage", {})[0m
[30;1m134 | [0m[35m        state[AsusData.RAM] = process_ram(memory_usage) if memory_usage else {}[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    # Speedtest[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    # Network[0m
[30;1m108 | [0m[35m    if "netdev" in data:[0m
[30;1m109 | [0m[35m        prev_network: Optional[AsusDataState] = history.get(AsusData.NETWORK)[0m
[30;1m110 | [0m[35m        netdev = data.get("netdev")[0m
[30;1m111 | [0m[35m        state[AsusData.NETWORK] = ([0m
[30;1m112 | [0m[35m            process_network(netdev, prev_network)[0m
[30;1m113 | [0m[35m            if netdev[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    # Network[0m
[30;1m108 | [0m[35m    if "netdev" in data:[0m
[30;1m109 | [0m[35m        prev_network: Optional[AsusDataState] = history.get(AsusData.NETWORK)[0m
[30;1m110 | [0m[35m        netdev = data.get("netdev")[0m
[30;1m111 | [0m[35m        state[AsusData.NETWORK] = ([0m
[30;1m112 | [0m[35m            process_network(netdev, prev_network)[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m    # LED[0m
[30;1m102 | [0m[35m    if "led_val" in data:[0m
[30;1m103 | [0m[35m        state[AsusData.LED] = {[0m
[30;1m104 | [0m[35m            "state": AsusLED(safe_int(data.get("led_val"), default=-999))[0m
[30;1m105 | [0m[35m        }[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    # Network[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m    # CPU[0m
[30;1m81 | [0m[35m    if "cpu_usage" in data:[0m
[30;1m82 | [0m[35m        cpu_usage = data.get("cpu_usage", {})[0m
[30;1m83 | [0m[35m        prev_cpu: Optional[AsusDataState] = history.get(AsusData.CPU)[0m
[30;1m84 | [0m[35m        state[AsusData.CPU] = ([0m
[30;1m85 | [0m[35m            process_cpu(cpu_usage, prev_cpu)[0m
[30;1m86 | [0m[35m            if cpu_usage[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    # CPU[0m
[30;1m81 | [0m[35m    if "cpu_usage" in data:[0m
[30;1m82 | [0m[35m        cpu_usage = data.get("cpu_usage", {})[0m
[30;1m83 | [0m[35m        prev_cpu: Optional[AsusDataState] = history.get(AsusData.CPU)[0m
[30;1m84 | [0m[35m        state[AsusData.CPU] = ([0m
[30;1m85 | [0m[35m            process_cpu(cpu_usage, prev_cpu)[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35mdef process_parental_control(data: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m341 | [0m[35m    """Process parental control data."""[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m    parental_control: dict[str, Any] = {}[0m
[30;1m344 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m292 | [0m[35m            # Otherwise, set speed to 0[0m
[30;1m293 | [0m[35m            interface_speed[f"{traffic_type}_speed"] = 0.0[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m        # Update interface with speed values[0m
[30;1m296 | [0m[35m        network[interface].update(interface_speed)[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    return network[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m212 | [0m[35m            "total": int(raw[f"cpu{core}_total"]),[0m
[30;1m213 | [0m[35m            "used": int(raw[f"cpu{core}_usage"]),[0m
[30;1m214 | [0m[35m        }[0m
[30;1m215 | [0m[35m        # Update the total[0m
[30;1m216 | [0m[35m        cpu["total"]["total"] += cpu[core]["total"][0m
[30;1m217 | [0m[35m        cpu["total"]["used"] += cpu[core]["used"][0m
[30;1m218 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m    if "vpn_serverx_clientlist" in data:[0m
[30;1m121 | [0m[35m        state[AsusData.OPENVPN_SERVER] = process_openvpn_server(data)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    # Parental control[0m
[30;1m124 | [0m[35m    if KEY_PC_STATE in data:[0m
[30;1m125 | [0m[35m        state[AsusData.PARENTAL_CONTROL] = process_parental_control(data)[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    # Port forwarding[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m531[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/asusrouter-1.14.0/asusrouter/modules/endpoint/hook.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m671 | [0m[35m        else:[0m
[30;1m672 | [0m[35m            wan["dualwan"]["state"] = True[0m
[30;1m673 | [0m[35m[0m
[30;1m674 | [0m[35m    # Assign main IP address[0m
[30;1m675 | [0m[35m    wan["internet"]["ip_address"] = wan[wan["internet"]["unit"]]["main"][[0m
[30;1m676 | [0m[35m        "ip_address"[0m
[30;1m677 | [0m[35m    ][0m

531 matches found.
