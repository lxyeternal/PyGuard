[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m58 | [0m[35m                        DOMAIN\username for authentication, leave empty for[0m
[30;1m59 | [0m[35m                        anonymous authentication[0m
[30;1m60 | [0m[35m  -p PASSWORD, --password PASSWORD[0m
[30;1m61 | [0m[35m                        Password or LM:NTLM hash, will prompt if not specified[0m
[30;1m62 | [0m[35m  -at {NTLM,SIMPLE}, --authtype {NTLM,SIMPLE}[0m
[30;1m63 | [0m[35m                        Authentication type (NTLM or SIMPLE, default: NTLM)[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m  -u USERNAME, --user USERNAME[0m
[30;1m58 | [0m[35m                        DOMAIN\username for authentication, leave empty for[0m
[30;1m59 | [0m[35m                        anonymous authentication[0m
[30;1m60 | [0m[35m  -p PASSWORD, --password PASSWORD[0m
[30;1m61 | [0m[35m                        Password or LM:NTLM hash, will prompt if not specified[0m
[30;1m62 | [0m[35m  -at {NTLM,SIMPLE}, --authtype {NTLM,SIMPLE}[0m
[30;1m63 | [0m[35m                        Authentication type (NTLM or SIMPLE, default: NTLM)[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m  -u USERNAME, --user USERNAME[0m
[30;1m58 | [0m[35m                        DOMAIN\username for authentication, leave empty for[0m
[30;1m59 | [0m[35m                        anonymous authentication[0m
[30;1m60 | [0m[35m  -p PASSWORD, --password PASSWORD[0m
[30;1m61 | [0m[35m                        Password or LM:NTLM hash, will prompt if not specified[0m
[30;1m62 | [0m[35m  -at {NTLM,SIMPLE}, --authtype {NTLM,SIMPLE}[0m
[30;1m63 | [0m[35m                        Authentication type (NTLM or SIMPLE, default: NTLM)[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m  -u USERNAME, --user USERNAME[0m
[30;1m58 | [0m[35m                        DOMAIN\username for authentication, leave empty for[0m
[30;1m59 | [0m[35m                        anonymous authentication[0m
[30;1m60 | [0m[35m  -p PASSWORD, --password PASSWORD[0m
[30;1m61 | [0m[35m                        Password or LM:NTLM hash, will prompt if not specified[0m
[30;1m62 | [0m[35m  -at {NTLM,SIMPLE}, --authtype {NTLM,SIMPLE}[0m
[30;1m63 | [0m[35m                        Authentication type (NTLM or SIMPLE, default: NTLM)[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mHelp can be obtained with the -h switch:[0m
[30;1m41 | [0m[35m```[0m
[30;1m42 | [0m[35musage: ldapdomaindump.py [-h] [-u USERNAME] [-p PASSWORD] [-at {NTLM,SIMPLE}][0m
[30;1m43 | [0m[35m                         [-o DIRECTORY] [--no-html] [--no-json] [--no-grep][0m
[30;1m44 | [0m[35m                         [--grouped-json] [-d DELIMITER] [-r] [-n DNS_SERVER][0m
[30;1m45 | [0m[35m                         [-m][0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m- *domain_groups*: List of groups in the domain[0m
[30;1m18 | [0m[35m- *domain_users*: List of users in the domain[0m
[30;1m19 | [0m[35m- *domain_computers*: List of computer accounts in the domain[0m
[30;1m20 | [0m[35m- *domain_policy*: Domain policy such as password requirements and lockout policy[0m
[30;1m21 | [0m[35m- *domain_trusts*: Incoming and outgoing domain trusts, and their properties[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mAs well as two grouped files:[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mThe tool was designed with the following goals in mind:[0m
[30;1m12 | [0m[35m- Easy overview of all users/groups/computers/policies in the domain[0m
[30;1m13 | [0m[35m- Authentication both via username and password, as with NTLM hashes (requires ldap3 >=1.3.1)[0m
[30;1m14 | [0m[35m- Possibility to run the tool with an existing authenticated connection to an LDAP service, allowing[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mThe tool outputs several files containing an overview of objects in the domain:[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m21 | [0m[35m# SOFTWARE.[0m
[30;1m22 | [0m[35m#[0m
[30;1m23 | [0m[35m####################[0m
[30;1m24 | [0m[35mimport sys, os, re, codecs, json, argparse, getpass, base64[0m
[30;1m25 | [0m[35m# import class and constants[0m
[30;1m26 | [0m[35mfrom datetime import datetime, timedelta[0m
[30;1m27 | [0m[35mfrom urllib.parse import quote_plus[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m940 | [0m[35m    s = Server(args.host, get_info=ALL)[0m
[30;1m941 | [0m[35m    log_info('Connecting to host...')[0m
[30;1m942 | [0m[35m[0m
[30;1m943 | [0m[35m    c = Connection(s, user=args.user, password=args.password, authentication=authentication)[0m
[30;1m944 | [0m[35m    log_info('Binding to host')[0m
[30;1m945 | [0m[35m    # perform the Bind operation[0m
[30;1m946 | [0m[35m    if not c.bind():[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m940 | [0m[35m    s = Server(args.host, get_info=ALL)[0m
[30;1m941 | [0m[35m    log_info('Connecting to host...')[0m
[30;1m942 | [0m[35m[0m
[30;1m943 | [0m[35m    c = Connection(s, user=args.user, password=args.password, authentication=authentication)[0m
[30;1m944 | [0m[35m    log_info('Binding to host')[0m
[30;1m945 | [0m[35m    # perform the Bind operation[0m
[30;1m946 | [0m[35m    if not c.bind():[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m935 | [0m[35m        if args.password is None:[0m
[30;1m936 | [0m[35m            args.password = getpass.getpass()[0m
[30;1m937 | [0m[35m    else:[0m
[30;1m938 | [0m[35m        log_info('Connecting as anonymous user, dumping will probably fail. Consider specifying a us[0m
[30;1m939 | [0m[35m    # define the server and the connection[0m
[30;1m940 | [0m[35m    s = Server(args.host, get_info=ALL)[0m
[30;1m941 | [0m[35m    log_info('Connecting to host...')[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m933 | [0m[35m            log_warn('Username must include a domain, use: DOMAIN\\username')[0m
[30;1m934 | [0m[35m            sys.exit(1)[0m
[30;1m935 | [0m[35m        if args.password is None:[0m
[30;1m936 | [0m[35m            args.password = getpass.getpass()[0m
[30;1m937 | [0m[35m    else:[0m
[30;1m938 | [0m[35m        log_info('Connecting as anonymous user, dumping will probably fail. Consider specifying a us[0m
[30;1m939 | [0m[35m    # define the server and the connection[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m932 | [0m[35m        if not '\\' in args.user:[0m
[30;1m933 | [0m[35m            log_warn('Username must include a domain, use: DOMAIN\\username')[0m
[30;1m934 | [0m[35m            sys.exit(1)[0m
[30;1m935 | [0m[35m        if args.password is None:[0m
[30;1m936 | [0m[35m            args.password = getpass.getpass()[0m
[30;1m937 | [0m[35m    else:[0m
[30;1m938 | [0m[35m        log_info('Connecting as anonymous user, dumping will probably fail. Consider specifying a us[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m922 | [0m[35m    #Do we really need grouped json files?[0m
[30;1m923 | [0m[35m    cnf.groupedjson = args.grouped_json[0m
[30;1m924 | [0m[35m[0m
[30;1m925 | [0m[35m    #Prompt for password if not set[0m
[30;1m926 | [0m[35m    authentication = None[0m
[30;1m927 | [0m[35m    if args.user is not None:[0m
[30;1m928 | [0m[35m        if args.authtype == 'SIMPLE':[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m875 | [0m[35mt connection string to connect to (use ldaps:// to use SSL)")[0m
[30;1m876 | [0m[35m    parser.add_argument("-u", "--user", type=str, metavar='USERNAME', help="DOMAIN\\username for aut[0m
[30;1m877 | [0m[35m    parser.add_argument("-p", "--password", type=str, metavar='PASSWORD', help="Password or LM:NTLM [0m
[30;1m878 | [0m[35m    parser.add_argument("-at", "--authtype", type=str, choices=['NTLM', 'SIMPLE'], default='NTLM', h[0m
[30;1m879 | [0m[35m[0m
[30;1m880 | [0m[35m    #Output parameters[0m
[30;1m881 | [0m[35m    outputgroup = parser.add_argument_group("Output options")[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m875 | [0m[35mr ldap://host:port connection string to connect to (use ldaps:// to use SSL)")[0m
[30;1m876 | [0m[35m    parser.add_argument("-u", "--user", type=str, metavar='USERNAME', help="DOMAIN\\username for aut[0m
[30;1m877 | [0m[35m    parser.add_argument("-p", "--password", type=str, metavar='PASSWORD', help="Password or LM:NTLM [0m
[30;1m878 | [0m[35m    parser.add_argument("-at", "--authtype", type=str, choices=['NTLM', 'SIMPLE'], default='NTLM', h[0m
[30;1m879 | [0m[35m[0m
[30;1m880 | [0m[35m    #Output parameters[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m875 | [0m[35mHOSTNAME', help="Hostname/ip or ldap://host:port connection string to connect to (use ldaps:// to us[0m
[30;1m876 | [0m[35m    parser.add_argument("-u", "--user", type=str, metavar='USERNAME', help="DOMAIN\\username for aut[0m
[30;1m877 | [0m[35m    parser.add_argument("-p", "--password", type=str, metavar='PASSWORD', help="Password or LM:NTLM [0m
[30;1m878 | [0m[35m    parser.add_argument("-at", "--authtype", type=str, choices=['NTLM', 'SIMPLE'], default='NTLM', h[0m
[30;1m879 | [0m[35m[0m
[30;1m880 | [0m[35m    #Output parameters[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m448 | [0m[35m            cn = cn.replace('\\'+c, c)[0m
[30;1m449 | [0m[35m        return cn[0m
[30;1m450 | [0m[35m[0m
[30;1m451 | [0m[35m    #Convert password max age (in 100 nanoseconds), to days[0m
[30;1m452 | [0m[35m    def nsToDays(self, length):[0m
[30;1m453 | [0m[35m        # ldap3 >= 2.6 returns timedelta[0m
[30;1m454 | [0m[35m        if isinstance(length, timedelta):[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m                     'minPwdAge':'Min password age',[0m
[30;1m111 | [0m[35m                     'minPwdLength':'Min password length',[0m
[30;1m112 | [0m[35m                     'pwdHistoryLength':'Password history length',[0m
[30;1m113 | [0m[35m                     'pwdProperties':'Password properties',[0m
[30;1m114 | [0m[35m                     'ms-DS-MachineAccountQuota':'Machine Account Quota',[0m
[30;1m115 | [0m[35m                     'flatName':'NETBIOS Domain name'}[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m109 | [0m[35m                     'maxPwdAge':'Max password age',[0m
[30;1m110 | [0m[35m                     'minPwdAge':'Min password age',[0m
[30;1m111 | [0m[35m                     'minPwdLength':'Min password length',[0m
[30;1m112 | [0m[35m                     'pwdHistoryLength':'Password history length',[0m
[30;1m113 | [0m[35m                     'pwdProperties':'Password properties',[0m
[30;1m114 | [0m[35m                     'ms-DS-MachineAccountQuota':'Machine Account Quota',[0m
[30;1m115 | [0m[35m                     'flatName':'NETBIOS Domain name'}[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m                     'lockoutThreshold':'Lockout Threshold',[0m
[30;1m109 | [0m[35m                     'maxPwdAge':'Max password age',[0m
[30;1m110 | [0m[35m                     'minPwdAge':'Min password age',[0m
[30;1m111 | [0m[35m                     'minPwdLength':'Min password length',[0m
[30;1m112 | [0m[35m                     'pwdHistoryLength':'Password history length',[0m
[30;1m113 | [0m[35m                     'pwdProperties':'Password properties',[0m
[30;1m114 | [0m[35m                     'ms-DS-MachineAccountQuota':'Machine Account Quota',[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m                     'lockoutDuration':'Lockout Duration',[0m
[30;1m108 | [0m[35m                     'lockoutThreshold':'Lockout Threshold',[0m
[30;1m109 | [0m[35m                     'maxPwdAge':'Max password age',[0m
[30;1m110 | [0m[35m                     'minPwdAge':'Min password age',[0m
[30;1m111 | [0m[35m                     'minPwdLength':'Min password length',[0m
[30;1m112 | [0m[35m                     'pwdHistoryLength':'Password history length',[0m
[30;1m113 | [0m[35m                     'pwdProperties':'Password properties',[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m                     'lockOutObservationWindow':'Lockout time window',[0m
[30;1m107 | [0m[35m                     'lockoutDuration':'Lockout Duration',[0m
[30;1m108 | [0m[35m                     'lockoutThreshold':'Lockout Threshold',[0m
[30;1m109 | [0m[35m                     'maxPwdAge':'Max password age',[0m
[30;1m110 | [0m[35m                     'minPwdAge':'Min password age',[0m
[30;1m111 | [0m[35m                     'minPwdLength':'Min password length',[0m
[30;1m112 | [0m[35m                     'pwdHistoryLength':'Password history length',[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m             'PASSWORD_NO_CLEAR_CHANGE': 0x04,[0m
[30;1m64 | [0m[35m             'LOCKOUT_ADMINS': 0x08,[0m
[30;1m65 | [0m[35m             'PASSWORD_STORE_CLEARTEXT': 0x10,[0m
[30;1m66 | [0m[35m             'REFUSE_PASSWORD_CHANGE': 0x20}[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m# Domain trust flags[0m
[30;1m69 | [0m[35m# From: https://msdn.microsoft.com/en-us/library/cc223779.aspx[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m             'PASSWORD_NO_ANON_CHANGE': 0x02,[0m
[30;1m63 | [0m[35m             'PASSWORD_NO_CLEAR_CHANGE': 0x04,[0m
[30;1m64 | [0m[35m             'LOCKOUT_ADMINS': 0x08,[0m
[30;1m65 | [0m[35m             'PASSWORD_STORE_CLEARTEXT': 0x10,[0m
[30;1m66 | [0m[35m             'REFUSE_PASSWORD_CHANGE': 0x20}[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m# Domain trust flags[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m# Password policy flags[0m
[30;1m61 | [0m[35mpwd_flags = {'PASSWORD_COMPLEX':0x01,[0m
[30;1m62 | [0m[35m             'PASSWORD_NO_ANON_CHANGE': 0x02,[0m
[30;1m63 | [0m[35m             'PASSWORD_NO_CLEAR_CHANGE': 0x04,[0m
[30;1m64 | [0m[35m             'LOCKOUT_ADMINS': 0x08,[0m
[30;1m65 | [0m[35m             'PASSWORD_STORE_CLEARTEXT': 0x10,[0m
[30;1m66 | [0m[35m             'REFUSE_PASSWORD_CHANGE': 0x20}[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# Password policy flags[0m
[30;1m61 | [0m[35mpwd_flags = {'PASSWORD_COMPLEX':0x01,[0m
[30;1m62 | [0m[35m             'PASSWORD_NO_ANON_CHANGE': 0x02,[0m
[30;1m63 | [0m[35m             'PASSWORD_NO_CLEAR_CHANGE': 0x04,[0m
[30;1m64 | [0m[35m             'LOCKOUT_ADMINS': 0x08,[0m
[30;1m65 | [0m[35m             'PASSWORD_STORE_CLEARTEXT': 0x10,[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m58 | [0m[35m            }[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# Password policy flags[0m
[30;1m61 | [0m[35mpwd_flags = {'PASSWORD_COMPLEX':0x01,[0m
[30;1m62 | [0m[35m             'PASSWORD_NO_ANON_CHANGE': 0x02,[0m
[30;1m63 | [0m[35m             'PASSWORD_NO_CLEAR_CHANGE': 0x04,[0m
[30;1m64 | [0m[35m             'LOCKOUT_ADMINS': 0x08,[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m             'PARTIAL_SECRETS_ACCOUNT': 0x04000000[0m
[30;1m58 | [0m[35m            }[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# Password policy flags[0m
[30;1m61 | [0m[35mpwd_flags = {'PASSWORD_COMPLEX':0x01,[0m
[30;1m62 | [0m[35m             'PASSWORD_NO_ANON_CHANGE': 0x02,[0m
[30;1m63 | [0m[35m             'PASSWORD_NO_CLEAR_CHANGE': 0x04,[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m             'NOT_DELEGATED': 0x00100000,[0m
[30;1m53 | [0m[35m             'USE_DES_KEY_ONLY': 0x00200000,[0m
[30;1m54 | [0m[35m             'DONT_REQ_PREAUTH': 0x00400000,[0m
[30;1m55 | [0m[35m             'PASSWORD_EXPIRED': 0x00800000,[0m
[30;1m56 | [0m[35m             'TRUSTED_TO_AUTH_FOR_DELEGATION': 0x01000000,[0m
[30;1m57 | [0m[35m             'PARTIAL_SECRETS_ACCOUNT': 0x04000000[0m
[30;1m58 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35m             'ACCOUNT_LOCKED':0x00000010,[0m
[30;1m43 | [0m[35m             'PASSWD_NOTREQD':0x00000020,[0m
[30;1m44 | [0m[35m             'PASSWD_CANT_CHANGE': 0x00000040,[0m
[30;1m45 | [0m[35m             'PASSWORD_STORE_CLEARTEXT': 0x00000080,[0m
[30;1m46 | [0m[35m             'NORMAL_ACCOUNT': 0x00000200,[0m
[30;1m47 | [0m[35m             'WORKSTATION_ACCOUNT':0x00001000,[0m
[30;1m48 | [0m[35m             'SERVER_TRUST_ACCOUNT': 0x00002000,[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m140 | [0m[35m            groups = json.load(f)[0m
[30;1m141 | [0m[35m        pretty = PrettyOuput()[0m
[30;1m142 | [0m[35m        dc = pretty.domain_info(domain)[0m
[30;1m143 | [0m[35m        pretty.password_complexity(domain)[0m
[30;1m144 | [0m[35m        pretty.user_info(users, dc.upper())[0m
[30;1m145 | [0m[35m        pretty.groups_info(groups, dc.upper())[0m
[30;1m146 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m
[30;1m71 | [0m[35m        print("")[0m
[30;1m72 | [0m[35m        print("\t[+] Maximum password age:", self.convert(data[0]['attributes']['maxPwdAge'][0]))[0m
[30;1m73 | [0m[35m        print("\t[+] Minimum password age:", self.convert(data[0]['attributes']['minPwdAge'][0]))[0m
[30;1m74 | [0m[35m        print("\t[+] Reset Account Lockout Counter:", self.convert(data[0]['attributes']['lockoutDur[0m
[30;1m75 | [0m[35m        print("\t[+] Account Lockout Threshold:", data[0]['attributes']['lockoutThreshold'][0])[0m
[30;1m76 | [0m[35m        print("\t[+] Forced Log off Time:", self.convert(data[0]['attributes']['forceLogoff'][0]))[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m
[30;1m71 | [0m[35m        print("")[0m
[30;1m72 | [0m[35m        print("\t[+] Maximum password age:", self.convert(data[0]['attributes']['maxPwdAge'][0]))[0m
[30;1m73 | [0m[35m        print("\t[+] Minimum password age:", self.convert(data[0]['attributes']['minPwdAge'][0]))[0m
[30;1m74 | [0m[35m        print("\t[+] Reset Account Lockout Counter:", self.convert(data[0]['attributes']['lockoutDur[0m
[30;1m75 | [0m[35m        print("\t[+] Account Lockout Threshold:", data[0]['attributes']['lockoutThreshold'][0])[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m
[30;1m71 | [0m[35m        print("")[0m
[30;1m72 | [0m[35m        print("\t[+] Maximum password age:", self.convert(data[0]['attributes']['maxPwdAge'][0]))[0m
[30;1m73 | [0m[35m        print("\t[+] Minimum password age:", self.convert(data[0]['attributes']['minPwdAge'][0]))[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m
[30;1m71 | [0m[35m        print("")[0m
[30;1m72 | [0m[35m        print("\t[+] Maximum password age:", self.convert(data[0]['attributes']['maxPwdAge'][0]))[0m
[30;1m73 | [0m[35m        print("\t[+] Minimum password age:", self.convert(data[0]['attributes']['minPwdAge'][0]))[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m
[30;1m71 | [0m[35m        print("")[0m
[30;1m72 | [0m[35m        print("\t[+] Maximum password age:", self.convert(data[0]['attributes']['maxPwdAge'][0]))[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m
[30;1m71 | [0m[35m        print("")[0m
[30;1m72 | [0m[35m        print("\t[+] Maximum password age:", self.convert(data[0]['attributes']['maxPwdAge'][0]))[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m
[30;1m71 | [0m[35m        print("")[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m
[30;1m71 | [0m[35m        print("")[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m
[30;1m70 | [0m[35m        print("\t\t[+] Domain Password Complex:", password_properties[5])[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m        print("\t[+] Password Complexity Flags:", password_properties)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m        print("\t[+] Password Complexity Flags:", password_properties)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m
[30;1m69 | [0m[35m        print("\t\t[+] Domain Password No Anon Change:", password_properties[4])[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m        password_properties = self.d2b(data[0]['attributes']['pwdProperties'][0])[0m
[30;1m63 | [0m[35m        print("\t[+] Password Complexity Flags:", password_properties)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m        password_properties = self.d2b(data[0]['attributes']['pwdProperties'][0])[0m
[30;1m63 | [0m[35m        print("\t[+] Password Complexity Flags:", password_properties)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m
[30;1m67 | [0m[35m        print("\t\t[+] Domain Password Lockout Admins:", password_properties[2])[0m
[30;1m68 | [0m[35m        print("\t\t[+] Domain Password No Clear Change:", password_properties[3])[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m        print("\t[+] Password history length:", data[0]['attributes']['pwdHistoryLength'][0])[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        password_properties = self.d2b(data[0]['attributes']['pwdProperties'][0])[0m
[30;1m63 | [0m[35m        print("\t[+] Password Complexity Flags:", password_properties)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m60 | [0m[35m        print("\t[+] Password history length:", data[0]['attributes']['pwdHistoryLength'][0])[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        password_properties = self.d2b(data[0]['attributes']['pwdProperties'][0])[0m
[30;1m63 | [0m[35m        print("\t[+] Password Complexity Flags:", password_properties)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m
[30;1m66 | [0m[35m        print("\t\t[+] Domain Password Store Cleartext:", password_properties[1])[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m        print("\t[+] Minimum password length: ", data[0]['attributes']['instanceType'][0])[0m
[30;1m60 | [0m[35m        print("\t[+] Password history length:", data[0]['attributes']['pwdHistoryLength'][0])[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        password_properties = self.d2b(data[0]['attributes']['pwdProperties'][0])[0m
[30;1m63 | [0m[35m        print("\t[+] Password Complexity Flags:", password_properties)[0m
[30;1m64 | [0m[35m        print("")[0m
[30;1m65 | [0m[35m        print("\t\t[+] Domain Refuse Password Change:", password_properties[0])[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        print("[+] Password Info for Domain:", data[0]['attributes']['dc'][0].upper())[0m
[30;1m59 | [0m[35m        print("\t[+] Minimum password length: ", data[0]['attributes']['instanceType'][0])[0m
[30;1m60 | [0m[35m        print("\t[+] Password history length:", data[0]['attributes']['pwdHistoryLength'][0])[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        password_properties = self.d2b(data[0]['attributes']['pwdProperties'][0])[0m
[30;1m63 | [0m[35m        print("\t[+] Password Complexity Flags:", password_properties)[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m    ''')[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        print("[+] Password Info for Domain:", data[0]['attributes']['dc'][0].upper())[0m
[30;1m59 | [0m[35m        print("\t[+] Minimum password length: ", data[0]['attributes']['instanceType'][0])[0m
[30;1m60 | [0m[35m        print("\t[+] Password history length:", data[0]['attributes']['pwdHistoryLength'][0])[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        password_properties = self.d2b(data[0]['attributes']['pwdProperties'][0])[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m    +-----------------------------------------+[0m
[30;1m56 | [0m[35m    ''')[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        print("[+] Password Info for Domain:", data[0]['attributes']['dc'][0].upper())[0m
[30;1m59 | [0m[35m        print("\t[+] Minimum password length: ", data[0]['attributes']['instanceType'][0])[0m
[30;1m60 | [0m[35m        print("\t[+] Password history length:", data[0]['attributes']['pwdHistoryLength'][0])[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        print('''[0m
[30;1m53 | [0m[35m    +-----------------------------------------+[0m
[30;1m54 | [0m[35m    | Password Policy Information             |[0m
[30;1m55 | [0m[35m    +-----------------------------------------+[0m
[30;1m56 | [0m[35m    ''')[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m            result += "{0} minute ".format(mins)[0m
[30;1m48 | [0m[35m        return result[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    def password_complexity(self, data):[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        print('''[0m
[30;1m53 | [0m[35m    +-----------------------------------------+[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m95 | [0m[35me attribute should be resolved to an IPv4 address. [0m
[30;1m96 | [0m[35mWhile this can be very useful, the DNSHostName attribute is not automatically updated. When the AD D[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m### Minimizing network and memory usage[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mDependencies can be installed manually with `pip install ldap3 dnspython future`, but should in most[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mThe ldapdomaindump package can be installed with `python setup.py install` from the git source, or f[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m## Usage[0m
[30;1m35 | [0m[35mThere are 3 ways to use the tool:[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m## Dependencies and installation[0m
[30;1m28 | [0m[35mRequires [ldap3](https://github.com/cannatag/ldap3) > 2.0 and [dnspython](https://github.com/rthalle[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mDependencies can be installed manually with `pip install ldap3 dnspython future`, but should in most[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mThe ldapdomaindump package can be installed with `python setup.py install` from the git source, or f[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m## Dependencies and installation[0m
[30;1m28 | [0m[35mRequires [ldap3](https://github.com/cannatag/ldap3) > 2.0 and [dnspython](https://github.com/rthalle[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mDependencies can be installed manually with `pip install ldap3 dnspython future`, but should in most[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mThe ldapdomaindump package can be installed with `python setup.py install` from the git source, or f[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35mimport dns.resolver[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m# User account control flags[0m
[30;1m40 | [0m[35m# From: https://blogs.technet.microsoft.com/askpfeplat/2014/01/15/understanding-the-useraccountcontr[0m
[30;1m41 | [0m[35muac_flags = {'ACCOUNT_DISABLED':0x00000002,[0m
[30;1m42 | [0m[35m             'ACCOUNT_LOCKED':0x00000010,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m950 | [0m[35m    log_success('Bind OK')[0m
[30;1m951 | [0m[35m    log_info('Starting domain dump')[0m
[30;1m952 | [0m[35m    #Create domaindumper object[0m
[30;1m953 | [0m[35m    dd = domainDumper(s, c, cnf)[0m
[30;1m954 | [0m[35m[0m
[30;1m955 | [0m[35m    #Do the actual dumping[0m
[30;1m956 | [0m[35m    dd.domainDump()[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m797 | [0m[35m    #Generate report with just a table of all users[0m
[30;1m798 | [0m[35m    def generateUsersReport(self, dd):[0m
[30;1m799 | [0m[35m        #Copy dd to this object, to be able to reference it[0m
[30;1m800 | [0m[35m        self.dd = dd[0m
[30;1m801 | [0m[35m        dd.mapGroupsIdsToDns()[0m
[30;1m802 | [0m[35m        if self.config.outputhtml:[0m
[30;1m803 | [0m[35m            html = self.generateHtmlTable(dd.users, self.userattributes, 'Domain users')[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m796 | [0m[35m[0m
[30;1m797 | [0m[35m    #Generate report with just a table of all users[0m
[30;1m798 | [0m[35m    def generateUsersReport(self, dd):[0m
[30;1m799 | [0m[35m        #Copy dd to this object, to be able to reference it[0m
[30;1m800 | [0m[35m        self.dd = dd[0m
[30;1m801 | [0m[35m        dd.mapGroupsIdsToDns()[0m
[30;1m802 | [0m[35m        if self.config.outputhtml:[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m317 | [0m[35m                ip = 'error.NOHOSTNAME'[0m
[30;1m318 | [0m[35m            #Construct a custom attribute as workaround[0m
[30;1m319 | [0m[35m            ipatt = attribute.Attribute(ipdef, computer, None)[0m
[30;1m320 | [0m[35m            ipatt.__dict__['_response'] = ip[0m
[30;1m321 | [0m[35m            ipatt.__dict__['raw_values'] = [ip][0m
[30;1m322 | [0m[35m            ipatt.__dict__['values'] = [ip][0m
[30;1m323 | [0m[35m            #Add the attribute to the entry's dictionary[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m            except dns.resolver.Timeout:[0m
[30;1m315 | [0m[35m                ip = 'error.TIMEOUT'[0m
[30;1m316 | [0m[35m            except (LDAPAttributeError, LDAPCursorError):[0m
[30;1m317 | [0m[35m                ip = 'error.NOHOSTNAME'[0m
[30;1m318 | [0m[35m            #Construct a custom attribute as workaround[0m
[30;1m319 | [0m[35m            ipatt = attribute.Attribute(ipdef, computer, None)[0m
[30;1m320 | [0m[35m            ipatt.__dict__['_response'] = ip[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m312 | [0m[35m            except dns.resolver.NXDOMAIN:[0m
[30;1m313 | [0m[35m                ip = 'error.NXDOMAIN'[0m
[30;1m314 | [0m[35m            except dns.resolver.Timeout:[0m
[30;1m315 | [0m[35m                ip = 'error.TIMEOUT'[0m
[30;1m316 | [0m[35m            except (LDAPAttributeError, LDAPCursorError):[0m
[30;1m317 | [0m[35m                ip = 'error.NOHOSTNAME'[0m
[30;1m318 | [0m[35m            #Construct a custom attribute as workaround[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m310 | [0m[35m                answers = dnsresolver.query(computer.dNSHostName.values[0], 'A')[0m
[30;1m311 | [0m[35m                ip = str(answers.response.answer[0][0])[0m
[30;1m312 | [0m[35m            except dns.resolver.NXDOMAIN:[0m
[30;1m313 | [0m[35m                ip = 'error.NXDOMAIN'[0m
[30;1m314 | [0m[35m            except dns.resolver.Timeout:[0m
[30;1m315 | [0m[35m                ip = 'error.TIMEOUT'[0m
[30;1m316 | [0m[35m            except (LDAPAttributeError, LDAPCursorError):[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m        for computer in self.computers:[0m
[30;1m309 | [0m[35m            try:[0m
[30;1m310 | [0m[35m                answers = dnsresolver.query(computer.dNSHostName.values[0], 'A')[0m
[30;1m311 | [0m[35m                ip = str(answers.response.answer[0][0])[0m
[30;1m312 | [0m[35m            except dns.resolver.NXDOMAIN:[0m
[30;1m313 | [0m[35m                ip = 'error.NXDOMAIN'[0m
[30;1m314 | [0m[35m            except dns.resolver.Timeout:[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m            return False[0m
[30;1m299 | [0m[35m[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m    #Lookup all computer DNS names to get their IP[0m
[30;1m302 | [0m[35m    def lookupComputerDnsNames(self):[0m
[30;1m303 | [0m[35m        dnsresolver = dns.resolver.Resolver()[0m
[30;1m304 | [0m[35m        dnsresolver.lifetime = 2[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m147 | [0m[35m        self.grepsplitchar = '\t'[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        #Other settings[0m
[30;1m150 | [0m[35m        self.lookuphostnames = False #Look up hostnames of computers to get their IP address[0m
[30;1m151 | [0m[35m        self.dnsserver = '' #Addres of the DNS server to use, if not specified default DNS will be u[0m
[30;1m152 | [0m[35m        self.minimal = False #Only query minimal list of attributes[0m
[30;1m153 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m                     'whenCreated':'Created on',[0m
[30;1m104 | [0m[35m                     'whenChanged':'Changed on',[0m
[30;1m105 | [0m[35m                     'IPv4':'IPv4 Address',[0m
[30;1m106 | [0m[35m                     'lockOutObservationWindow':'Lockout time window',[0m
[30;1m107 | [0m[35m                     'lockoutDuration':'Lockout Duration',[0m
[30;1m108 | [0m[35m                     'lockoutThreshold':'Lockout Threshold',[0m
[30;1m109 | [0m[35m                     'maxPwdAge':'Max password age',[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m# SOFTWARE.[0m
[30;1m22 | [0m[35m#[0m
[30;1m23 | [0m[35m####################[0m
[30;1m24 | [0m[35mimport sys, os, re, codecs, json, argparse, getpass, base64[0m
[30;1m25 | [0m[35m# import class and constants[0m
[30;1m26 | [0m[35mfrom datetime import datetime, timedelta[0m
[30;1m27 | [0m[35mfrom urllib.parse import quote_plus[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/convert.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m176 | [0m[35m        logger.error('No domain_groups.json files were specified. Need at least one to perform conve[0m
[30;1m177 | [0m[35m        return[0m
[30;1m178 | [0m[35m    if len(converter.user_files) == 0:[0m
[30;1m179 | [0m[35m        logger.error('No domain_users.json files were specified. Need at least one to perform conver[0m
[30;1m180 | [0m[35m        return[0m
[30;1m181 | [0m[35m    logger.debug('Mapping groups...')[0m
[30;1m182 | [0m[35m    converter.build_mappings()[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/convert.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m173 | [0m[35m    converter = BloodHoundConverter()[0m
[30;1m174 | [0m[35m    converter.parse_files(args.files)[0m
[30;1m175 | [0m[35m    if len(converter.group_files) == 0:[0m
[30;1m176 | [0m[35m        logger.error('No domain_groups.json files were specified. Need at least one to perform conve[0m
[30;1m177 | [0m[35m        return[0m
[30;1m178 | [0m[35m    if len(converter.user_files) == 0:[0m
[30;1m179 | [0m[35m        logger.error('No domain_users.json files were specified. Need at least one to perform conver[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m            print("group:[" + group['attributes']['name'][0] + "]")[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        for group in groups:[0m
[30;1m114 | [0m[35m            if group['attributes'].get('member'):[0m
[30;1m115 | [0m[35m                users = re.findall(r"^CN=([\w\s\-\_\{\}\.\$\#]+)", '\n'.join(group['attributes']['me[0m
[30;1m116 | [0m[35m                if users:[0m
[30;1m117 | [0m[35m                    print("\n[+] Getting domain group memberships:")[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m    +------------------------+[0m
[30;1m94 | [0m[35m    ''')[0m
[30;1m95 | [0m[35m        for user in users:[0m
[30;1m96 | [0m[35m            desc = user['attributes'].get('description')[0] if user['attributes'].get('description')[0m
[30;1m97 | [0m[35m            print("Account: " + dc + "\\" + user['attributes']['sAMAccountName'][0] + "\tName: " + u[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        print("")[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m    +------------------------+[0m
[30;1m94 | [0m[35m    ''')[0m
[30;1m95 | [0m[35m        for user in users:[0m
[30;1m96 | [0m[35m            desc = user['attributes'].get('description')[0] if user['attributes'].get('description')[0m
[30;1m97 | [0m[35m            print("Account: " + dc + "\\" + user['attributes']['sAMAccountName'][0] + "\tName: " + u[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        print("")[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m            return time[0m
[30;1m24 | [0m[35m        if time == 0:[0m
[30;1m25 | [0m[35m            return "None"[0m
[30;1m26 | [0m[35m        if time == -9223372036854775808:[0m
[30;1m27 | [0m[35m            return "Not Set"[0m
[30;1m28 | [0m[35m        sec = abs(time) // 10000000[0m
[30;1m29 | [0m[35m        days = sec // 86400[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    def convert(self, time):[0m
[30;1m22 | [0m[35m        if isinstance(time, str):[0m
[30;1m23 | [0m[35m            return time[0m
[30;1m24 | [0m[35m        if time == 0:[0m
[30;1m25 | [0m[35m            return "None"[0m
[30;1m26 | [0m[35m        if time == -9223372036854775808:[0m
[30;1m27 | [0m[35m            return "Not Set"[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    def convert(self, time):[0m
[30;1m22 | [0m[35m        if isinstance(time, str):[0m
[30;1m23 | [0m[35m            return time[0m
[30;1m24 | [0m[35m        if time == 0:[0m
[30;1m25 | [0m[35m            return "None"[0m
[30;1m26 | [0m[35m        if time == -9223372036854775808:[0m
[30;1m27 | [0m[35m            return "Not Set"[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m80[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ldapdomaindump-0.10.0/ldapdomaindump/pretty.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35mimport os.path[0m
[30;1m4 | [0m[35mimport re[0m
[30;1m5 | [0m[35mfrom time import strftime, gmtime[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mclass PrettyOuput():[0m
[30;1m8 | [0m[35m[0m

80 matches found.
