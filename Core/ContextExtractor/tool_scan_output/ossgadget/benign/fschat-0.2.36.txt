[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora_t5.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m121 | [0m[35m    world_size = int(os.environ.get("WORLD_SIZE", 1))[0m
[30;1m122 | [0m[35m    ddp = world_size != 1[0m
[30;1m123 | [0m[35m    if lora_args.q_lora:[0m
[30;1m124 | [0m[35m        device_map = {"": int(os.environ.get("LOCAL_RANK") or 0)} if ddp else None[0m
[30;1m125 | [0m[35m        if len(training_args.fsdp) > 0 or deepspeed.is_deepspeed_zero3_enabled():[0m
[30;1m126 | [0m[35m            logging.warning([0m
[30;1m127 | [0m[35m                "FSDP and ZeRO3 are both currently incompatible with QLoRA."[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora_t5.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m118 | [0m[35m    ) = parser.parse_args_into_dataclasses()[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    device_map = None[0m
[30;1m121 | [0m[35m    world_size = int(os.environ.get("WORLD_SIZE", 1))[0m
[30;1m122 | [0m[35m    ddp = world_size != 1[0m
[30;1m123 | [0m[35m    if lora_args.q_lora:[0m
[30;1m124 | [0m[35m        device_map = {"": int(os.environ.get("LOCAL_RANK") or 0)} if ddp else None[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m                ret["token_num"] = all_token_num[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m            if base64_encode == "base64":[0m
[30;1m279 | [0m[35m                out_embeddings = self.__encode_base64(normalized_embeddings)[0m
[30;1m280 | [0m[35m            else:[0m
[30;1m281 | [0m[35m                out_embeddings = normalized_embeddings.tolist()[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m178 | [0m[35m    def __encode_base64(self, embeddings: torch.Tensor) -> List[str]:[0m
[30;1m179 | [0m[35m        embeddings = embeddings.cpu()[0m
[30;1m180 | [0m[35m        return [[0m
[30;1m181 | [0m[35m            base64.b64encode(e.numpy().tobytes()).decode("utf-8") for e in embeddings[0m
[30;1m182 | [0m[35m        ][0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    @torch.inference_mode()[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m2 | [0m[35mA model worker that executes the model.[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35mimport argparse[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport gc[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m335 | [0m[35m    if dtype is not None:  # Overwrite dtype if it is provided in the arguments.[0m
[30;1m336 | [0m[35m        kwargs["torch_dtype"] = dtype[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m    if os.environ.get("FASTCHAT_USE_MODELSCOPE", "False").lower() == "true":[0m
[30;1m339 | [0m[35m        # download model from ModelScope hub,[0m
[30;1m340 | [0m[35m        # lazy import so that modelscope is not required for normal use.[0m
[30;1m341 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m47 | [0m[35m# Check an environment variable to check if we should be sharing Peft model[0m
[30;1m48 | [0m[35m# weights.  When false we treat all Peft models as separate.[0m
[30;1m49 | [0m[35mpeft_share_base_weights = ([0m
[30;1m50 | [0m[35m    os.environ.get("PEFT_SHARE_BASE_WEIGHTS", "false").lower() == "true"[0m
[30;1m51 | [0m[35m)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mANTHROPIC_MODEL_LIST = ([0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m496 | [0m[35m    finish_tstamp = time.time()[0m
[30;1m497 | [0m[35m    logger.info(f"{output}")[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m    # We load the image because gradio accepts base64 but that increases file size by ~1.33x[0m
[30;1m500 | [0m[35m    loaded_images = [load_image(image) for image in images][0m
[30;1m501 | [0m[35m    images_hash = [hashlib.md5(image.tobytes()).hexdigest() for image in loaded_images][0m
[30;1m502 | [0m[35m    for image, hash_str in zip(loaded_images, images_hash):[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m850 | [0m[35m    parser.add_argument([0m
[30;1m851 | [0m[35m        "--gradio-auth-path",[0m
[30;1m852 | [0m[35m        type=str,[0m
[30;1m853 | [0m[35m        help='Set the gradio authentication file path. The file should contain one or more user:pass[0m
[30;1m854 | [0m[35m    )[0m
[30;1m855 | [0m[35m    parser.add_argument([0m
[30;1m856 | [0m[35m        "--gradio-root-path",[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_vision_api.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m76 | [0m[35m    print(completion.choices[0].message.content)[0m
[30;1m77 | [0m[35m    print("=" * 25)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    # Image using base64 image url[0m
[30;1m80 | [0m[35m    completion = openai.chat.completions.create([0m
[30;1m81 | [0m[35m        model=model,[0m
[30;1m82 | [0m[35m        messages=[[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_vision_api.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mdef test_chat_completion(model):[0m
[30;1m43 | [0m[35m    image_url = "https://picsum.photos/seed/picsum/1024/1024"[0m
[30;1m44 | [0m[35m    base64_image_url = f"data:image/jpeg;base64,{encode_image(image_url)}"[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    # No Image[0m
[30;1m47 | [0m[35m    completion = openai.chat.completions.create([0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_vision_api.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    buffered = BytesIO()[0m
[30;1m30 | [0m[35m    image.save(buffered, format="PNG")[0m
[30;1m31 | [0m[35m    img_b64_str = base64.b64encode(buffered.getvalue()).decode("utf-8")[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    return img_b64_str[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_vision_api.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mdef encode_image(image):[0m
[30;1m17 | [0m[35m    import base64[0m
[30;1m18 | [0m[35m    from io import BytesIO[0m
[30;1m19 | [0m[35m    import requests[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m339 | [0m[35m                if type(msg) is tuple:[0m
[30;1m340 | [0m[35m                    msg, image = msg[0m
[30;1m341 | [0m[35m                    img_b64_str = image[0]  # Only one image on gradio at one time[0m
[30;1m342 | [0m[35m                    img_str = f'<img src="data:image/jpeg;base64,{img_b64_str}" alt="user upload ima[0m
[30;1m343 | [0m[35m                    msg = img_str + msg.replace("<image>\n", "").strip()[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m                ret.append([msg, None])[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        buffered = BytesIO()[0m
[30;1m329 | [0m[35m        image.save(buffered, format="PNG")[0m
[30;1m330 | [0m[35m        img_b64_str = base64.b64encode(buffered.getvalue()).decode()[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m        return img_b64_str[0m
[30;1m333 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m307 | [0m[35m                response = requests.get(image)[0m
[30;1m308 | [0m[35m                image = Image.open(BytesIO(response.content)).convert("RGB")[0m
[30;1m309 | [0m[35m            elif "base64" in image:[0m
[30;1m310 | [0m[35m                # OpenAI format is: data:image/jpeg;base64,{base64_encoded_image_str}[0m
[30;1m311 | [0m[35m                return image.split(",")[1][0m
[30;1m312 | [0m[35m            else:[0m
[30;1m313 | [0m[35m                image = Image.open(image).convert("RGB")[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m306 | [0m[35m            if image.startswith("http://") or image.startswith("https://"):[0m
[30;1m307 | [0m[35m                response = requests.get(image)[0m
[30;1m308 | [0m[35m                image = Image.open(BytesIO(response.content)).convert("RGB")[0m
[30;1m309 | [0m[35m            elif "base64" in image:[0m
[30;1m310 | [0m[35m                # OpenAI format is: data:image/jpeg;base64,{base64_encoded_image_str}[0m
[30;1m311 | [0m[35m                return image.split(",")[1][0m
[30;1m312 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m297 | [0m[35m        self.messages[-1][1] = message[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m    def convert_image_to_base64(self, image):[0m
[30;1m300 | [0m[35m        """Given an image, return the base64 encoded image string."""[0m
[30;1m301 | [0m[35m        from PIL import Image[0m
[30;1m302 | [0m[35m        import requests[0m
[30;1m303 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m5 | [0m[35mIf you have any changes in mind, please contribute back so the community can benefit collectively an[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport base64[0m
[30;1m9 | [0m[35mimport dataclasses[0m
[30;1m10 | [0m[35mfrom enum import auto, IntEnum[0m
[30;1m11 | [0m[35mfrom io import BytesIO[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m377 | [0m[35m        image_file = image_file.split(",")[1][0m
[30;1m378 | [0m[35m        image = Image.open(BytesIO(base64.b64decode(image_file)))[0m
[30;1m379 | [0m[35m    else:[0m
[30;1m380 | [0m[35m        image = Image.open(BytesIO(base64.b64decode(image_file)))[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m    return image[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m373 | [0m[35m        image = Image.open(image_file)[0m
[30;1m374 | [0m[35m    elif image_file.startswith("data:"):[0m
[30;1m375 | [0m[35m        image_file = image_file.split(",")[1][0m
[30;1m376 | [0m[35m        image = Image.open(BytesIO(base64.b64decode(image_file)))[0m
[30;1m377 | [0m[35m    else:[0m
[30;1m378 | [0m[35m        image = Image.open(BytesIO(base64.b64decode(image_file)))[0m
[30;1m379 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35mfrom asyncio import AbstractEventLoop[0m
[30;1m5 | [0m[35mfrom io import BytesIO[0m
[30;1m6 | [0m[35mimport base64[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35mimport logging[0m
[30;1m9 | [0m[35mimport logging.handlers[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35mdef parse_gradio_auth_creds(filename: str):[0m
[30;1m287 | [0m[35m    """Parse a username:password file for gradio authorization."""[0m
[30;1m288 | [0m[35m    gradio_auth_creds = [][0m
[30;1m289 | [0m[35m    with open(filename, "r", encoding="utf8") as file:[0m
[30;1m290 | [0m[35m        for line in file.readlines():[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/api_provider.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m313 | [0m[35m    api_base=None,[0m
[30;1m314 | [0m[35m):[0m
[30;1m315 | [0m[35m    # get keys and needed values[0m
[30;1m316 | [0m[35m    ai2_key = api_key or os.environ.get("AI2_API_KEY")[0m
[30;1m317 | [0m[35m    api_base = api_base or "https://inferd.allen.ai/api/v1/infer"[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m    # Make requests[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server_multi.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m212 | [0m[35m    parser.add_argument([0m
[30;1m213 | [0m[35m        "--gradio-auth-path",[0m
[30;1m214 | [0m[35m        type=str,[0m
[30;1m215 | [0m[35m        help='Set the gradio authentication file path. The file should contain one or more user:pass[0m
[30;1m216 | [0m[35m        default=None,[0m
[30;1m217 | [0m[35m    )[0m
[30;1m218 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m119 | [0m[35m    world_size = int(os.environ.get("WORLD_SIZE", 1))[0m
[30;1m120 | [0m[35m    ddp = world_size != 1[0m
[30;1m121 | [0m[35m    if lora_args.q_lora:[0m
[30;1m122 | [0m[35m        device_map = {"": int(os.environ.get("LOCAL_RANK") or 0)} if ddp else None[0m
[30;1m123 | [0m[35m        if len(training_args.fsdp) > 0 or deepspeed.is_deepspeed_zero3_enabled():[0m
[30;1m124 | [0m[35m            logging.warning([0m
[30;1m125 | [0m[35m                "FSDP and ZeRO3 are both currently incompatible with QLoRA."[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m116 | [0m[35m        replace_llama_attn_with_flash_attn()[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    device_map = None[0m
[30;1m119 | [0m[35m    world_size = int(os.environ.get("WORLD_SIZE", 1))[0m
[30;1m120 | [0m[35m    ddp = world_size != 1[0m
[30;1m121 | [0m[35m    if lora_args.q_lora:[0m
[30;1m122 | [0m[35m        device_map = {"": int(os.environ.get("LOCAL_RANK") or 0)} if ddp else None[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m919 | [0m[35m        allow_headers=args.allowed_headers,[0m
[30;1m920 | [0m[35m    )[0m
[30;1m921 | [0m[35m    app_settings.controller_address = args.controller_address[0m
[30;1m922 | [0m[35m    app_settings.api_keys = args.api_keys[0m
[30;1m923 | [0m[35m[0m
[30;1m924 | [0m[35m    logger.info(f"args: {args}")[0m
[30;1m925 | [0m[35m    return args[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m919 | [0m[35m        allow_headers=args.allowed_headers,[0m
[30;1m920 | [0m[35m    )[0m
[30;1m921 | [0m[35m    app_settings.controller_address = args.controller_address[0m
[30;1m922 | [0m[35m    app_settings.api_keys = args.api_keys[0m
[30;1m923 | [0m[35m[0m
[30;1m924 | [0m[35m    logger.info(f"args: {args}")[0m
[30;1m925 | [0m[35m    return args[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m127 | [0m[35m            )[0m
[30;1m128 | [0m[35m        return token[0m
[30;1m129 | [0m[35m    else:[0m
[30;1m130 | [0m[35m        # api_keys not set; allow all[0m
[30;1m131 | [0m[35m        return None[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m113 | [0m[35m    auth: Optional[HTTPAuthorizationCredentials] = Depends(get_bearer_token),[0m
[30;1m114 | [0m[35m) -> str:[0m
[30;1m115 | [0m[35m    if app_settings.api_keys:[0m
[30;1m116 | [0m[35m        if auth is None or (token := auth.credentials) not in app_settings.api_keys:[0m
[30;1m117 | [0m[35m            raise HTTPException([0m
[30;1m118 | [0m[35m                status_code=401,[0m
[30;1m119 | [0m[35m                detail={[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m112 | [0m[35masync def check_api_key([0m
[30;1m113 | [0m[35m    auth: Optional[HTTPAuthorizationCredentials] = Depends(get_bearer_token),[0m
[30;1m114 | [0m[35m) -> str:[0m
[30;1m115 | [0m[35m    if app_settings.api_keys:[0m
[30;1m116 | [0m[35m        if auth is None or (token := auth.credentials) not in app_settings.api_keys:[0m
[30;1m117 | [0m[35m            raise HTTPException([0m
[30;1m118 | [0m[35m                status_code=401,[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35mclass AppSettings(BaseSettings):[0m
[30;1m101 | [0m[35m    # The address of the model controller.[0m
[30;1m102 | [0m[35m    controller_address: str = "http://localhost:21001"[0m
[30;1m103 | [0m[35m    api_keys: Optional[List[str]] = None[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35mapp_settings = AppSettings()[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora_t5.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m    world_size = int(os.environ.get("WORLD_SIZE", 1))[0m
[30;1m122 | [0m[35m    ddp = world_size != 1[0m
[30;1m123 | [0m[35m    if lora_args.q_lora:[0m
[30;1m124 | [0m[35m        device_map = {"": int(os.environ.get("LOCAL_RANK") or 0)} if ddp else None[0m
[30;1m125 | [0m[35m        if len(training_args.fsdp) > 0 or deepspeed.is_deepspeed_zero3_enabled():[0m
[30;1m126 | [0m[35m            logging.warning([0m
[30;1m127 | [0m[35m                "FSDP and ZeRO3 are both currently incompatible with QLoRA."[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora_t5.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m    ) = parser.parse_args_into_dataclasses()[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    device_map = None[0m
[30;1m121 | [0m[35m    world_size = int(os.environ.get("WORLD_SIZE", 1))[0m
[30;1m122 | [0m[35m    ddp = world_size != 1[0m
[30;1m123 | [0m[35m    if lora_args.q_lora:[0m
[30;1m124 | [0m[35m        device_map = {"": int(os.environ.get("LOCAL_RANK") or 0)} if ddp else None[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora_t5.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m#    Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m5 | [0m[35m#    you may not use this file except in compliance with the License.[0m
[30;1m6 | [0m[35m#    You may obtain a copy of the License at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m#        http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m#    Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/topic_clustering.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m    if args.embeddings_file is None:[0m
[30;1m250 | [0m[35m        embeddings = get_embeddings(texts, args.model, args.batch_size)[0m
[30;1m251 | [0m[35m        if args.save_embeddings:[0m
[30;1m252 | [0m[35m            # allow saving embedding to save time and money[0m
[30;1m253 | [0m[35m            torch.save(embeddings, "embeddings.pt")[0m
[30;1m254 | [0m[35m    else:[0m
[30;1m255 | [0m[35m        embeddings = torch.load(args.embeddings_file)[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/topic_clustering.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m    clusterer = hdbscan.HDBSCAN(min_cluster_size=10)[0m
[30;1m153 | [0m[35m    labels = torch.from_numpy(clusterer.fit_predict(embeddings))[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    # Sort labels[0m
[30;1m156 | [0m[35m    classes, counts = np.unique(labels, return_counts=True)[0m
[30;1m157 | [0m[35m    indices = np.argsort(counts)[::-1][0m
[30;1m158 | [0m[35m    classes = [classes[i] for i in indices][0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/topic_clustering.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m    clustering_model.fit(embeddings)[0m
[30;1m130 | [0m[35m    labels = torch.from_numpy(clustering_model.labels_)[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    # Sort labels[0m
[30;1m133 | [0m[35m    classes, counts = np.unique(labels, return_counts=True)[0m
[30;1m134 | [0m[35m    indices = np.argsort(counts)[::-1][0m
[30;1m135 | [0m[35m    classes = [classes[i] for i in indices][0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/topic_clustering.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m    centers = torch.from_numpy(clustering_model.cluster_centers_)[0m
[30;1m112 | [0m[35m    labels = torch.from_numpy(clustering_model.labels_)[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    # Sort labels[0m
[30;1m115 | [0m[35m    classes, counts = np.unique(labels, return_counts=True)[0m
[30;1m116 | [0m[35m    indices = np.argsort(counts)[::-1][0m
[30;1m117 | [0m[35m    classes = [classes[i] for i in indices][0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/topic_clustering.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport pickle[0m
[30;1m10 | [0m[35mimport string[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mimport numpy as np[0m
[30;1m14 | [0m[35mfrom sentence_transformers import SentenceTransformer[0m
[30;1m15 | [0m[35mfrom sentence_transformers.util import cos_sim[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m            input_ids = encoding["input_ids"].to(self.device)[0m
[30;1m213 | [0m[35m            attention_mask = input_ids != tokenizer.pad_token_id[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m            base64_encode = params.get("encoding_format", None)[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m            if self.embed_in_truncate:[0m
[30;1m218 | [0m[35m                embedding, token_num = self.__process_embed_chunk([0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m            data = model_output.encoder_last_hidden_state[0m
[30;1m161 | [0m[35m        else:[0m
[30;1m162 | [0m[35m            model_output = self.model(input_ids, output_hidden_states=True)[0m
[30;1m163 | [0m[35m            if model_type_dict.get("is_chatglm"):[0m
[30;1m164 | [0m[35m                data = model_output.hidden_states[-1].transpose(0, 1)[0m
[30;1m165 | [0m[35m            else:[0m
[30;1m166 | [0m[35m                data = model_output.hidden_states[-1][0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m                data = model_output.last_hidden_state[0m
[30;1m156 | [0m[35m            else:[0m
[30;1m157 | [0m[35m                data = model_output[0][0m
[30;1m158 | [0m[35m        elif model_type_dict.get("is_t5"):[0m
[30;1m159 | [0m[35m            model_output = self.model(input_ids, decoder_input_ids=input_ids)[0m
[30;1m160 | [0m[35m            data = model_output.encoder_last_hidden_state[0m
[30;1m161 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m    def __process_embed_chunk(self, input_ids, attention_mask, **model_type_dict):[0m
[30;1m152 | [0m[35m        if model_type_dict.get("is_bert"):[0m
[30;1m153 | [0m[35m            model_output = self.model(input_ids)[0m
[30;1m154 | [0m[35m            if model_type_dict.get("is_robert"):[0m
[30;1m155 | [0m[35m                data = model_output.last_hidden_state[0m
[30;1m156 | [0m[35m            else:[0m
[30;1m157 | [0m[35m                data = model_output[0][0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m        return json.loads(x[:-1].decode())[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    def __process_embed_chunk(self, input_ids, attention_mask, **model_type_dict):[0m
[30;1m152 | [0m[35m        if model_type_dict.get("is_bert"):[0m
[30;1m153 | [0m[35m            model_output = self.model(input_ids)[0m
[30;1m154 | [0m[35m            if model_type_dict.get("is_robert"):[0m
[30;1m155 | [0m[35m                data = model_output.last_hidden_state[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/model_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mA model worker that executes the model.[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35mimport argparse[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport gc[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mfrom typing import List, Optional[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/dataset_release_scripts/lmsys_chat_1m/compute_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mfrom pytz import timezone[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport kaleido[0m
[30;1m13 | [0m[35mimport numpy as np[0m
[30;1m14 | [0m[35mimport pandas as pd[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_vision.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m            )[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        with gr.Accordion([0m
[30;1m60 | [0m[35m            f"üîç Expand to see the descriptions of {len(models)} models", open=False[0m
[30;1m61 | [0m[35m        ):[0m
[30;1m62 | [0m[35m            model_description_md = get_model_description_md(models)[0m
[30;1m63 | [0m[35m            gr.Markdown(model_description_md, elem_id="model_description_markdown")[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_vision.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m            )[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        with gr.Accordion([0m
[30;1m60 | [0m[35m            f"üîç Expand to see the descriptions of {len(models)} models", open=False[0m
[30;1m61 | [0m[35m        ):[0m
[30;1m62 | [0m[35m            model_description_md = get_model_description_md(models)[0m
[30;1m63 | [0m[35m            gr.Markdown(model_description_md, elem_id="model_description_markdown")[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m    return controller.worker_api_get_status()[0m
[30;1m346 | [0m[35m[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m@app.get("/test_connection")[0m
[30;1m349 | [0m[35masync def worker_api_get_status(request: Request):[0m
[30;1m350 | [0m[35m    return "success"[0m
[30;1m351 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m340 | [0m[35m    return StreamingResponse(generator)[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m@app.post("/worker_get_status")[0m
[30;1m344 | [0m[35masync def worker_api_get_status(request: Request):[0m
[30;1m345 | [0m[35m    return controller.worker_api_get_status()[0m
[30;1m346 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m    return {"exist": exist}[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m@app.post("/worker_generate_stream")[0m
[30;1m337 | [0m[35masync def worker_api_generate_stream(request: Request):[0m
[30;1m338 | [0m[35m    params = await request.json()[0m
[30;1m339 | [0m[35m    generator = controller.worker_api_generate_stream(params)[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35m    return {"address": addr}[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m@app.post("/receive_heart_beat")[0m
[30;1m330 | [0m[35masync def receive_heart_beat(request: Request):[0m
[30;1m331 | [0m[35m    data = await request.json()[0m
[30;1m332 | [0m[35m    exist = controller.receive_heart_beat(data["worker_name"], data["queue_length"])[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m    return {"models": models}[0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m@app.post("/get_worker_address")[0m
[30;1m323 | [0m[35masync def get_worker_address(request: Request):[0m
[30;1m324 | [0m[35m    data = await request.json()[0m
[30;1m325 | [0m[35m    addr = controller.get_worker_address(data["model"])[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m    return {"models": models}[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m@app.post("/list_language_models")[0m
[30;1m317 | [0m[35masync def list_language_models():[0m
[30;1m318 | [0m[35m    models = controller.list_language_models()[0m
[30;1m319 | [0m[35m    return {"models": models}[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m    return {"models": models}[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m@app.post("/list_multimodal_models")[0m
[30;1m311 | [0m[35masync def list_multimodal_models():[0m
[30;1m312 | [0m[35m    models = controller.list_multimodal_models()[0m
[30;1m313 | [0m[35m    return {"models": models}[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m    models = controller.refresh_all_workers()[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m@app.post("/list_models")[0m
[30;1m305 | [0m[35masync def list_models():[0m
[30;1m306 | [0m[35m    models = controller.list_models()[0m
[30;1m307 | [0m[35m    return {"models": models}[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m    )[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m@app.post("/refresh_all_workers")[0m
[30;1m300 | [0m[35masync def refresh_all_workers():[0m
[30;1m301 | [0m[35m    models = controller.refresh_all_workers()[0m
[30;1m302 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m        data["worker_name"],[0m
[30;1m293 | [0m[35m        data["check_heart_beat"],[0m
[30;1m294 | [0m[35m        data.get("worker_status", None),[0m
[30;1m295 | [0m[35m        data.get("multimodal", False),[0m
[30;1m296 | [0m[35m    )[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m    controller.register_worker([0m
[30;1m292 | [0m[35m        data["worker_name"],[0m
[30;1m293 | [0m[35m        data["check_heart_beat"],[0m
[30;1m294 | [0m[35m        data.get("worker_status", None),[0m
[30;1m295 | [0m[35m        data.get("multimodal", False),[0m
[30;1m296 | [0m[35m    )[0m
[30;1m297 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35mapp = FastAPI()[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m@app.post("/register_worker")[0m
[30;1m289 | [0m[35masync def register_worker(request: Request):[0m
[30;1m290 | [0m[35m    data = await request.json()[0m
[30;1m291 | [0m[35m    controller.register_worker([0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m            yield self.handle_no_worker(params)[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m        try:[0m
[30;1m272 | [0m[35m            response = requests.post([0m
[30;1m273 | [0m[35m                worker_addr + "/worker_generate_stream",[0m
[30;1m274 | [0m[35m                json=params,[0m
[30;1m275 | [0m[35m                stream=True,[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    def get_worker_status(self, worker_name: str):[0m
[30;1m105 | [0m[35m        try:[0m
[30;1m106 | [0m[35m            r = requests.post(worker_name + "/worker_get_status", timeout=5)[0m
[30;1m107 | [0m[35m        except requests.exceptions.RequestException as e:[0m
[30;1m108 | [0m[35m            logger.error(f"Get status fails: {worker_name}, {e}")[0m
[30;1m109 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mimport json[0m
[30;1m10 | [0m[35mimport logging[0m
[30;1m11 | [0m[35mimport os[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mfrom typing import List, Union[0m
[30;1m14 | [0m[35mimport threading[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom fastapi import FastAPI, Request[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2122 | [0m[35m        return "yuan2" in model_path.lower()[0m
[30;1m2123 | [0m[35m[0m
[30;1m2124 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m2125 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m2126 | [0m[35m        # from_pretrained_kwargs["torch_dtype"] = torch.bfloat16[0m
[30;1m2127 | [0m[35m        tokenizer = LlamaTokenizer.from_pretrained([0m
[30;1m2128 | [0m[35m            model_path,[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1912 | [0m[35m        )[0m
[30;1m1913 | [0m[35m[0m
[30;1m1914 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1915 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1916 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1917 | [0m[35m            model_path,[0m
[30;1m1918 | [0m[35m            use_fast=self.use_fast_tokenizer,[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1878 | [0m[35m        return bool(re.search(r"vigogne|vigostral", model_path, re.I))[0m
[30;1m1879 | [0m[35m[0m
[30;1m1880 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1881 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1882 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1883 | [0m[35m            model_path,[0m
[30;1m1884 | [0m[35m            use_fast=self.use_fast_tokenizer,[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1851 | [0m[35m        return "chinese-alpaca" in model_path.lower()[0m
[30;1m1852 | [0m[35m[0m
[30;1m1853 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1854 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1855 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1856 | [0m[35m            model_path,[0m
[30;1m1857 | [0m[35m            trust_remote_code=True,[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1826 | [0m[35m        return "llama2-chinese" in model_path.lower()[0m
[30;1m1827 | [0m[35m[0m
[30;1m1828 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1829 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1830 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1831 | [0m[35m            model_path,[0m
[30;1m1832 | [0m[35m            trust_remote_code=True,[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1792 | [0m[35m        return "aquila" in model_path.lower()[0m
[30;1m1793 | [0m[35m[0m
[30;1m1794 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1795 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1796 | [0m[35m        model = AutoModelForCausalLM.from_pretrained([0m
[30;1m1797 | [0m[35m            model_path,[0m
[30;1m1798 | [0m[35m            low_cpu_mem_usage=True,[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1759 | [0m[35m        return "e5-" in model_path.lower()[0m
[30;1m1760 | [0m[35m[0m
[30;1m1761 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1762 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1763 | [0m[35m        model = AutoModel.from_pretrained([0m
[30;1m1764 | [0m[35m            model_path,[0m
[30;1m1765 | [0m[35m            **from_pretrained_kwargs,[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1728 | [0m[35m        return "bge" in model_path.lower()[0m
[30;1m1729 | [0m[35m[0m
[30;1m1730 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1731 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1732 | [0m[35m        model = AutoModel.from_pretrained([0m
[30;1m1733 | [0m[35m            model_path,[0m
[30;1m1734 | [0m[35m            **from_pretrained_kwargs,[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1683 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1684 | [0m[35m        from transformers.generation import GenerationConfig[0m
[30;1m1685 | [0m[35m[0m
[30;1m1686 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1687 | [0m[35m        config = AutoConfig.from_pretrained([0m
[30;1m1688 | [0m[35m            model_path,[0m
[30;1m1689 | [0m[35m            trust_remote_code=True,[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1600 | [0m[35m        )[0m
[30;1m1601 | [0m[35m[0m
[30;1m1602 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1603 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1604 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1605 | [0m[35m            model_path, use_fast=self.use_fast_tokenizer, revision=revision[0m
[30;1m1606 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1561 | [0m[35m        )[0m
[30;1m1562 | [0m[35m[0m
[30;1m1563 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1564 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1565 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1566 | [0m[35m            model_path, use_fast=self.use_fast_tokenizer, revision=revision[0m
[30;1m1567 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1461 | [0m[35m        return "internlm" in model_path.lower()[0m
[30;1m1462 | [0m[35m[0m
[30;1m1463 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1464 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1465 | [0m[35m        model = AutoModelForCausalLM.from_pretrained([0m
[30;1m1466 | [0m[35m            model_path,[0m
[30;1m1467 | [0m[35m            low_cpu_mem_usage=True,[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1425 | [0m[35m        return "xgen" in model_path.lower()[0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1428 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1429 | [0m[35m        model = AutoModelForCausalLM.from_pretrained([0m
[30;1m1430 | [0m[35m            model_path,[0m
[30;1m1431 | [0m[35m            low_cpu_mem_usage=True,[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1397 | [0m[35m        return "baichuan" in model_path.lower()[0m
[30;1m1398 | [0m[35m[0m
[30;1m1399 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1400 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1401 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1402 | [0m[35m            model_path, trust_remote_code=True, revision=revision[0m
[30;1m1403 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1372 | [0m[35m        return "tigerbot" in model_path.lower()[0m
[30;1m1373 | [0m[35m[0m
[30;1m1374 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1375 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1376 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1377 | [0m[35m            model_path,[0m
[30;1m1378 | [0m[35m            trust_remote_code=True,[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1339 | [0m[35m        return "falcon" in model_path.lower() and "chat" not in model_path.lower()[0m
[30;1m1340 | [0m[35m[0m
[30;1m1341 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1342 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1343 | [0m[35m        # Strongly suggest using bf16, which is recommended by the author of Falcon[0m
[30;1m1344 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained(model_path, revision=revision)[0m
[30;1m1345 | [0m[35m        model = AutoModelForCausalLM.from_pretrained([0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1282 | [0m[35m        return "guanaco" in model_path.lower()[0m
[30;1m1283 | [0m[35m[0m
[30;1m1284 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1285 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1286 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1287 | [0m[35m            model_path, use_fast=self.use_fast_tokenizer, revision=revision[0m
[30;1m1288 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1193 | [0m[35m        return "redpajama-incite" in model_path.lower()[0m
[30;1m1194 | [0m[35m[0m
[30;1m1195 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m1196 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1197 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained(model_path, revision=revision)[0m
[30;1m1198 | [0m[35m        model = AutoModelForCausalLM.from_pretrained([0m
[30;1m1199 | [0m[35m            model_path,[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1033 | [0m[35m        from fastchat.model.rwkv_model import RwkvModel[0m
[30;1m1034 | [0m[35m[0m
[30;1m1035 | [0m[35m        model = RwkvModel(model_path)[0m
[30;1m1036 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m1037 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m1038 | [0m[35m            "EleutherAI/pythia-160m", revision=revision[0m
[30;1m1039 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m980 | [0m[35m        return "mpt" in model_path and not "airoboros" in model_path[0m
[30;1m981 | [0m[35m[0m
[30;1m982 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m983 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m984 | [0m[35m        model = AutoModelForCausalLM.from_pretrained([0m
[30;1m985 | [0m[35m            model_path,[0m
[30;1m986 | [0m[35m            low_cpu_mem_usage=True,[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m876 | [0m[35m        return "dolly-v2" in model_path.lower()[0m
[30;1m877 | [0m[35m[0m
[30;1m878 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m879 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m880 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained(model_path, revision=revision)[0m
[30;1m881 | [0m[35m        model = AutoModelForCausalLM.from_pretrained([0m
[30;1m882 | [0m[35m            model_path,[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m856 | [0m[35m        return "codegeex" in model_path.lower()[0m
[30;1m857 | [0m[35m[0m
[30;1m858 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m859 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m860 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m861 | [0m[35m            model_path, trust_remote_code=True, revision=revision[0m
[30;1m862 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m823 | [0m[35m        return "chatglm" in model_path.lower()[0m
[30;1m824 | [0m[35m[0m
[30;1m825 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m826 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m827 | [0m[35m        if "chatglm3" in model_path.lower():[0m
[30;1m828 | [0m[35m            tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m829 | [0m[35m                model_path,[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m781 | [0m[35m        )[0m
[30;1m782 | [0m[35m[0m
[30;1m783 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m784 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m785 | [0m[35m        tokenizer = T5Tokenizer.from_pretrained(model_path, revision=revision)[0m
[30;1m786 | [0m[35m        model = AutoModelForSeq2SeqLM.from_pretrained([0m
[30;1m787 | [0m[35m            model_path,[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m751 | [0m[35m        return "longchat" in model_path.lower()[0m
[30;1m752 | [0m[35m[0m
[30;1m753 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m754 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m        # Apply monkey patch, TODO(Dacheng): Add flash attention support[0m
[30;1m757 | [0m[35m        config = AutoConfig.from_pretrained(model_path, revision=revision)[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m682 | [0m[35m        return "vicuna" in model_path.lower()[0m
[30;1m683 | [0m[35m[0m
[30;1m684 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m685 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m686 | [0m[35m        tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m687 | [0m[35m            model_path, use_fast=self.use_fast_tokenizer, revision=revision[0m
[30;1m688 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m335 | [0m[35m    if dtype is not None:  # Overwrite dtype if it is provided in the arguments.[0m
[30;1m336 | [0m[35m        kwargs["torch_dtype"] = dtype[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m    if os.environ.get("FASTCHAT_USE_MODELSCOPE", "False").lower() == "true":[0m
[30;1m339 | [0m[35m        # download model from ModelScope hub,[0m
[30;1m340 | [0m[35m        # lazy import so that modelscope is not required for normal use.[0m
[30;1m341 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        return True[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    def load_model(self, model_path: str, from_pretrained_kwargs: dict):[0m
[30;1m86 | [0m[35m        revision = from_pretrained_kwargs.get("revision", "main")[0m
[30;1m87 | [0m[35m        try:[0m
[30;1m88 | [0m[35m            tokenizer = AutoTokenizer.from_pretrained([0m
[30;1m89 | [0m[35m                model_path,[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m# Check an environment variable to check if we should be sharing Peft model[0m
[30;1m48 | [0m[35m# weights.  When false we treat all Peft models as separate.[0m
[30;1m49 | [0m[35mpeft_share_base_weights = ([0m
[30;1m50 | [0m[35m    os.environ.get("PEFT_SHARE_BASE_WEIGHTS", "false").lower() == "true"[0m
[30;1m51 | [0m[35m)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mANTHROPIC_MODEL_LIST = ([0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1648 | [0m[35mclass QwenChatAdapter(BaseModelAdapter):[0m
[30;1m1649 | [0m[35m    """The model adapter for Qwen/Qwen-7B-Chat[0m
[30;1m1650 | [0m[35m    To run this model, you need to ensure additional flash attention installation:[0m
[30;1m1651 | [0m[35m    ``` bash[0m
[30;1m1652 | [0m[35m    git clone https://github.com/Dao-AILab/flash-attention[0m
[30;1m1653 | [0m[35m    cd flash-attention && pip install .[0m
[30;1m1654 | [0m[35m    pip install csrc/layer_norm[0m
[30;1m1655 | [0m[35m    pip install csrc/rotary[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m139 | [0m[35m    """Get a model adapter for a model_path."""[0m
[30;1m140 | [0m[35m    model_path_basename = os.path.basename(os.path.normpath(model_path))[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    # Try the basename of model_path at first[0m
[30;1m143 | [0m[35m    for adapter in model_adapters:[0m
[30;1m144 | [0m[35m        if adapter.match(model_path_basename) and type(adapter) != BaseModelAdapter:[0m
[30;1m145 | [0m[35m            return adapter[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1652 | [0m[35m    git clone https://github.com/Dao-AILab/flash-attention[0m
[30;1m1653 | [0m[35m    cd flash-attention && pip install .[0m
[30;1m1654 | [0m[35m    pip install csrc/layer_norm[0m
[30;1m1655 | [0m[35m    pip install csrc/rotary[0m
[30;1m1656 | [0m[35m    ```[0m
[30;1m1657 | [0m[35m[0m
[30;1m1658 | [0m[35m    Since from 2.0, the following change happened[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1651 | [0m[35m    ``` bash[0m
[30;1m1652 | [0m[35m    git clone https://github.com/Dao-AILab/flash-attention[0m
[30;1m1653 | [0m[35m    cd flash-attention && pip install .[0m
[30;1m1654 | [0m[35m    pip install csrc/layer_norm[0m
[30;1m1655 | [0m[35m    pip install csrc/rotary[0m
[30;1m1656 | [0m[35m    ```[0m
[30;1m1657 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1650 | [0m[35m    To run this model, you need to ensure additional flash attention installation:[0m
[30;1m1651 | [0m[35m    ``` bash[0m
[30;1m1652 | [0m[35m    git clone https://github.com/Dao-AILab/flash-attention[0m
[30;1m1653 | [0m[35m    cd flash-attention && pip install .[0m
[30;1m1654 | [0m[35m    pip install csrc/layer_norm[0m
[30;1m1655 | [0m[35m    pip install csrc/rotary[0m
[30;1m1656 | [0m[35m    ```[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1649 | [0m[35m    """The model adapter for Qwen/Qwen-7B-Chat[0m
[30;1m1650 | [0m[35m    To run this model, you need to ensure additional flash attention installation:[0m
[30;1m1651 | [0m[35m    ``` bash[0m
[30;1m1652 | [0m[35m    git clone https://github.com/Dao-AILab/flash-attention[0m
[30;1m1653 | [0m[35m    cd flash-attention && pip install .[0m
[30;1m1654 | [0m[35m    pip install csrc/layer_norm[0m
[30;1m1655 | [0m[35m    pip install csrc/rotary[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1648 | [0m[35mclass QwenChatAdapter(BaseModelAdapter):[0m
[30;1m1649 | [0m[35m    """The model adapter for Qwen/Qwen-7B-Chat[0m
[30;1m1650 | [0m[35m    To run this model, you need to ensure additional flash attention installation:[0m
[30;1m1651 | [0m[35m    ``` bash[0m
[30;1m1652 | [0m[35m    git clone https://github.com/Dao-AILab/flash-attention[0m
[30;1m1653 | [0m[35m    cd flash-attention && pip install .[0m
[30;1m1654 | [0m[35m    pip install csrc/layer_norm[0m
[30;1m1655 | [0m[35m    pip install csrc/rotary[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_adapter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m345 | [0m[35m                model_path = snapshot_download(model_id=model_path, revision=revision)[0m
[30;1m346 | [0m[35m        except ImportError as e:[0m
[30;1m347 | [0m[35m            warnings.warn([0m
[30;1m348 | [0m[35m                "Use model from www.modelscope.cn need pip install modelscope"[0m
[30;1m349 | [0m[35m            )[0m
[30;1m350 | [0m[35m            raise e[0m
[30;1m351 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m293 | [0m[35mpip3 install -e ".[train]"[0m
[30;1m294 | [0m[35m```[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m- You can use the following command to train Vicuna-7B with 4 x A100 (40GB). Update `--model_name_or[0m
[30;1m297 | [0m[35m```bash[0m
[30;1m298 | [0m[35mtorchrun --nproc_per_node=4 --master_port=20001 fastchat/train/train_mem.py \[0m
[30;1m299 | [0m[35m    --model_name_or_path meta-llama/Llama-2-7b-hf \[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m267 | [0m[35m## Evaluation[0m
[30;1m268 | [0m[35mWe use MT-bench, a set of challenging multi-turn open-ended questions to evaluate models. [0m
[30;1m269 | [0m[35mTo automate the evaluation process, we prompt strong LLMs like GPT-4 to act as judges and assess the[0m
[30;1m270 | [0m[35mSee instructions for running MT-bench at [fastchat/llm_judge](fastchat/llm_judge).[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35mMT-bench is the new recommended way to benchmark your models. If you are still looking for the old 8[0m
[30;1m273 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m237 | [0m[35mIf the models do not show up, try to reboot the gradio web server.[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m#### (Optional): Advanced Features, Scalability, Third Party UI[0m
[30;1m240 | [0m[35m- You can register multiple model workers to a single controller, which can be used for serving a si[0m
[30;1m241 | [0m[35m```[0m
[30;1m242 | [0m[35m# worker 0[0m
[30;1m243 | [0m[35mCUDA_VISIBLE_DEVICES=0 python3 -m fastchat.serve.model_worker --model-path lmsys/vicuna-7b-v1.5 --co[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m## Citation[0m
[30;1m338 | [0m[35mThe code (training, serving, and evaluation) in this repository is mostly developed for or derived f[0m
[30;1m339 | [0m[35mPlease cite it if you find the repository helpful.[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m```[0m
[30;1m342 | [0m[35m@misc{zheng2023judging,[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m331 | [0m[35mstChat-T5) and use LoRA are in [docs/training.md](docs/training.md).[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m### Fine-tuning on Any Cloud with SkyPilot[0m
[30;1m334 | [0m[35m[SkyPilot](https://github.com/skypilot-org/skypilot) is a framework built by UC Berkeley for easily [0m
[30;1m335 | [0m[35mFind SkyPilot documentation [here](https://github.com/skypilot-org/skypilot/tree/master/llm/vicuna) [0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m## Citation[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m## API[0m
[30;1m255 | [0m[35m### OpenAI-Compatible RESTful APIs & SDK[0m
[30;1m256 | [0m[35mFastChat provides OpenAI-compatible APIs for its supported models, so you can use FastChat as a loca[0m
[30;1m257 | [0m[35mThe FastChat server is compatible with both [openai-python](https://github.com/openai/openai-python)[0m
[30;1m258 | [0m[35mThe REST API is capable of being executed from Google Colab free tier, as demonstrated in the [FastC[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m2. Install Package[0m
[30;1m62 | [0m[35m```bash[0m
[30;1m63 | [0m[35mpip3 install --upgrade pip  # enable PEP 660 support[0m
[30;1m64 | [0m[35mpip3 install -e ".[model_worker,webui]"[0m
[30;1m65 | [0m[35m```[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m### Method 2: From source[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m1. Clone this repository and navigate to the FastChat folder[0m
[30;1m51 | [0m[35m```bash[0m
[30;1m52 | [0m[35mgit clone https://github.com/lm-sys/FastChat.git[0m
[30;1m53 | [0m[35mcd FastChat[0m
[30;1m54 | [0m[35m```[0m
[30;1m55 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m## Install[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m### Method 1: With pip[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m```bash[0m
[30;1m45 | [0m[35mpip3 install "fschat[model_worker,webui]"[0m
[30;1m46 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/dataset_release_scripts/lmsys_chat_1m/approve_all.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35mfor u in a.json():[0m
[30;1m9 | [0m[35m    user = u["user"]["user"][0m
[30;1m10 | [0m[35m    url = "https://huggingface.co/api/datasets/lmsys/lmsys-chat-1m/user-access-request/grant"[0m
[30;1m11 | [0m[35m    ret = requests.post(url, headers=headers, json={"user": user})[0m
[30;1m12 | [0m[35m    print(user, ret.status_code)[0m
[30;1m13 | [0m[35m    assert ret.status_code == 200[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/dataset_release_scripts/lmsys_chat_1m/approve_all.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3 | [0m[35mheaders = {"authorization": "Bearer hf_XXX"}[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35murl = "https://huggingface.co/api/datasets/lmsys/lmsys-chat-1m/user-access-request/pending"[0m
[30;1m6 | [0m[35ma = requests.get(url, headers=headers)[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfor u in a.json():[0m
[30;1m9 | [0m[35m    user = u["user"]["user"][0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/llama2_flash_attn_monkey_patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m    cuda_major, cuda_minor = torch.cuda.get_device_capability()[0m
[30;1m134 | [0m[35m    if cuda_major < 8:[0m
[30;1m135 | [0m[35m        warnings.warn([0m
[30;1m136 | [0m[35m            "Flash attention is only supported on A100 or H100 GPU during training due to head dim >[0m
[30;1m137 | [0m[35m            "ref: https://github.com/HazyResearch/flash-attention/issues/190#issuecomment-1523359593[0m
[30;1m138 | [0m[35m        )[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m31 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m32 | [0m[35m    stop_token_ids.append(tokenizer.eos_token_id)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    inputs = tokenizer(prompt, return_tensors="pt").to(model.device)[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m31 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m32 | [0m[35m    stop_token_ids.append(tokenizer.eos_token_id)[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m31 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m32 | [0m[35m    stop_token_ids.append(tokenizer.eos_token_id)[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m31 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", None)[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    prompt = params["prompt"][0m
[30;1m23 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m):[0m
[30;1m22 | [0m[35m    prompt = params["prompt"][0m
[30;1m23 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m            if content is None:[0m
[30;1m81 | [0m[35m                content = ""[0m
[30;1m82 | [0m[35m        except Exception as e:[0m
[30;1m83 | [0m[35m            content = chunk.choices[0].delta.get("content", "")[0m
[30;1m84 | [0m[35m        print(content, end="", flush=True)[0m
[30;1m85 | [0m[35m    print()[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m        except openai.APIError as e:[0m
[30;1m146 | [0m[35m            print(f"Embedding error: {e}")[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    print("===== Test curl =====")[0m
[30;1m149 | [0m[35m    test_openai_curl()[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m    )[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    run_cmd([0m
[30;1m116 | [0m[35m        """[0m
[30;1m117 | [0m[35mcurl http://localhost:8000/v1/embeddings \[0m
[30;1m118 | [0m[35m  -H "Content-Type: application/json" \[0m
[30;1m119 | [0m[35m  -d '{[0m
[30;1m120 | [0m[35m    "model": "vicuna-7b-v1.5",[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m    )[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    run_cmd([0m
[30;1m103 | [0m[35m        """[0m
[30;1m104 | [0m[35mcurl http://localhost:8000/v1/completions \[0m
[30;1m105 | [0m[35m  -H "Content-Type: application/json" \[0m
[30;1m106 | [0m[35m  -d '{[0m
[30;1m107 | [0m[35m    "model": "vicuna-7b-v1.5",[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m    run_cmd("curl http://localhost:8000/v1/models")[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    run_cmd([0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35mcurl http://localhost:8000/v1/chat/completions \[0m
[30;1m94 | [0m[35m  -H "Content-Type: application/json" \[0m
[30;1m95 | [0m[35m  -d '{[0m
[30;1m96 | [0m[35m    "model": "vicuna-7b-v1.5",[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/tag_openai_moderation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m6 | [0m[35mimport json[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport openai[0m
[30;1m11 | [0m[35mimport requests[0m
[30;1m12 | [0m[35mfrom tqdm import tqdm[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/gen_model_answer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        )[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    if use_ray:[0m
[30;1m70 | [0m[35m        ray.get(ans_handles)[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m@torch.inference_mode()[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/gen_model_answer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport random[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport shortuuid[0m
[30;1m13 | [0m[35mimport torch[0m
[30;1m14 | [0m[35mfrom tqdm import tqdm[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_exllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    generator.set_stop_conditions(params.get("stop_token_ids", None) or [])[0m
[30;1m37 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    input_ids = generator.tokenizer.encode(prompt)[0m
[30;1m40 | [0m[35m    prompt_tokens = input_ids.shape[-1][0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_exllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    generator.set_stop_conditions(params.get("stop_token_ids", None) or [])[0m
[30;1m37 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    input_ids = generator.tokenizer.encode(prompt)[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_exllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    settings.token_repetition_penalty = float(params.get("repetition_penalty", 1.15))[0m
[30;1m32 | [0m[35m    settings.disallow_tokens(generator.tokenizer, [generator.tokenizer.eos_token_id])[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    generator.set_stop_conditions(params.get("stop_token_ids", None) or [])[0m
[30;1m37 | [0m[35m    echo = bool(params.get("echo", True))[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_exllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    settings.temperature = float(params.get("temperature", 0.85))[0m
[30;1m29 | [0m[35m    settings.top_k = int(params.get("top_k", 50))[0m
[30;1m30 | [0m[35m    settings.top_p = float(params.get("top_p", 0.8))[0m
[30;1m31 | [0m[35m    settings.token_repetition_penalty = float(params.get("repetition_penalty", 1.15))[0m
[30;1m32 | [0m[35m    settings.disallow_tokens(generator.tokenizer, [generator.tokenizer.eos_token_id])[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_exllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    settings.temperature = float(params.get("temperature", 0.85))[0m
[30;1m29 | [0m[35m    settings.top_k = int(params.get("top_k", 50))[0m
[30;1m30 | [0m[35m    settings.top_p = float(params.get("top_p", 0.8))[0m
[30;1m31 | [0m[35m    settings.token_repetition_penalty = float(params.get("repetition_penalty", 1.15))[0m
[30;1m32 | [0m[35m    settings.disallow_tokens(generator.tokenizer, [generator.tokenizer.eos_token_id])[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_exllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    settings = ExLlamaV2Sampler.Settings()[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    settings.temperature = float(params.get("temperature", 0.85))[0m
[30;1m29 | [0m[35m    settings.top_k = int(params.get("top_k", 50))[0m
[30;1m30 | [0m[35m    settings.top_p = float(params.get("top_p", 0.8))[0m
[30;1m31 | [0m[35m    settings.token_repetition_penalty = float(params.get("repetition_penalty", 1.15))[0m
[30;1m32 | [0m[35m    settings.disallow_tokens(generator.tokenizer, [generator.tokenizer.eos_token_id])[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_exllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    generator = ExLlamaV2StreamingGenerator(model.model, model.cache, tokenizer)[0m
[30;1m26 | [0m[35m    settings = ExLlamaV2Sampler.Settings()[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    settings.temperature = float(params.get("temperature", 0.85))[0m
[30;1m29 | [0m[35m    settings.top_k = int(params.get("top_k", 50))[0m
[30;1m30 | [0m[35m    settings.top_p = float(params.get("top_p", 0.8))[0m
[30;1m31 | [0m[35m    settings.token_repetition_penalty = float(params.get("repetition_penalty", 1.15))[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_xfastertransformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m    # top_p = float(params.get("top_p", 1.0))[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 4096))[0m
[30;1m26 | [0m[35m    echo = params.get("echo", True)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    inputs = tokenizer([0m
[30;1m29 | [0m[35m        prompt, return_tensors="pt", padding=model.config.padding[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_xfastertransformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    # temperature = float(params.get("temperature", 1.0))[0m
[30;1m23 | [0m[35m    # top_p = float(params.get("top_p", 1.0))[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 4096))[0m
[30;1m26 | [0m[35m    echo = params.get("echo", True)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    inputs = tokenizer([0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_xfastertransformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    # unused now, and placehold for future.[0m
[30;1m22 | [0m[35m    # temperature = float(params.get("temperature", 1.0))[0m
[30;1m23 | [0m[35m    # top_p = float(params.get("top_p", 1.0))[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 4096))[0m
[30;1m26 | [0m[35m    echo = params.get("echo", True)[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_xfastertransformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    # unused now, and placehold for future.[0m
[30;1m22 | [0m[35m    # temperature = float(params.get("temperature", 1.0))[0m
[30;1m23 | [0m[35m    # top_p = float(params.get("top_p", 1.0))[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 4096))[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_xfastertransformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m    judge_sent_end=False,[0m
[30;1m17 | [0m[35m):[0m
[30;1m18 | [0m[35m    prompt = params["prompt"][0m
[30;1m19 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    # unused now, and placehold for future.[0m
[30;1m22 | [0m[35m    # temperature = float(params.get("temperature", 1.0))[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/elo_analysis.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m    for i, model in enumerate(models):[0m
[30;1m152 | [0m[35m        rank = i + 1[0m
[30;1m153 | [0m[35m        minfo = get_model_info(model)[0m
[30;1m154 | [0m[35m        emoji = emoji_dict.get(rank, "")[0m
[30;1m155 | [0m[35m        md += f"| {rank} | {emoji} [{model}]({minfo.link}) | {rating[model]:.0f} | {minfo.descriptio[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    return md[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/elo_analysis.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m    Y[df["winner"] == "model_a"] = 1.0[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    # one tie => one A win + one B win[0m
[30;1m75 | [0m[35m    # find tie + tie (both bad) index[0m
[30;1m76 | [0m[35m    tie_idx = (df["winner"] == "tie") | (df["winner"] == "tie (bothbad)")[0m
[30;1m77 | [0m[35m    tie_idx[len(tie_idx) // 2 :] = False[0m
[30;1m78 | [0m[35m    Y[tie_idx] = 1.0[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/elo_analysis.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m358 | [0m[35m    pretty_print_elo_rating(results["elo_rating_online"])[0m
[30;1m359 | [0m[35m    print("# Median")[0m
[30;1m360 | [0m[35m    pretty_print_elo_rating(results["elo_rating_final"])[0m
[30;1m361 | [0m[35m    print(f"last update : {results['last_updated_datetime']}")[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m    last_updated_tstamp = results["last_updated_tstamp"][0m
[30;1m364 | [0m[35m    cutoff_date = datetime.datetime.fromtimestamp([0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/elo_analysis.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m257 | [0m[35m    battles = battles[battles["anony"]].reset_index(drop=True)[0m
[30;1m258 | [0m[35m    battles_no_ties = battles[~battles["winner"].str.contains("tie")][0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    # Online update[0m
[30;1m261 | [0m[35m    elo_rating_online = compute_elo(battles)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    if rating_system == "bt":[0m
[30;1m264 | [0m[35m        bootstrap_df = get_bootstrap_result([0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m        ret = preprocess([0m
[30;1m226 | [0m[35m            [self.raw_data[i]["conversations"]],[0m
[30;1m227 | [0m[35m            self.tokenizer,[0m
[30;1m228 | [0m[35m            systems=[self.raw_data[i].get("system", "")],[0m
[30;1m229 | [0m[35m        )[0m
[30;1m230 | [0m[35m        ret = dict([0m
[30;1m231 | [0m[35m            input_ids=ret["input_ids"][0],[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        super(SupervisedDataset, self).__init__()[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m        rank0_print("Formatting inputs...")[0m
[30;1m187 | [0m[35m        systems = [example.get("system", "") for example in raw_data][0m
[30;1m188 | [0m[35m        sources = [example["conversations"] for example in raw_data][0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m        data_dict = preprocess(sources, tokenizer, systems=systems)[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m            ).get()[0m
[30;1m170 | [0m[35m            targets = p.apply_async([0m
[30;1m171 | [0m[35m                mask_targets, (conversations, targets, tokenizer, conv)[0m
[30;1m172 | [0m[35m            ).get()[0m
[30;1m173 | [0m[35m            p.close()[0m
[30;1m174 | [0m[35m            p.join()[0m
[30;1m175 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m            ).get()[0m
[30;1m167 | [0m[35m            input_ids, targets = p.apply_async([0m
[30;1m168 | [0m[35m                tokenize_conversations, (conversations, tokenizer)[0m
[30;1m169 | [0m[35m            ).get()[0m
[30;1m170 | [0m[35m            targets = p.apply_async([0m
[30;1m171 | [0m[35m                mask_targets, (conversations, targets, tokenizer, conv)[0m
[30;1m172 | [0m[35m            ).get()[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m        with Pool() as p:[0m
[30;1m161 | [0m[35m            conversations, conv = p.apply_async([0m
[30;1m162 | [0m[35m                apply_prompt_template, (sources, systems)[0m
[30;1m163 | [0m[35m            ).get()[0m
[30;1m164 | [0m[35m            input_ids, targets = p.apply_async([0m
[30;1m165 | [0m[35m                tokenize_conversations, (conversations, tokenizer)[0m
[30;1m166 | [0m[35m            ).get()[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35mdef preprocess(sources, tokenizer: transformers.PreTrainedTokenizer, **kwargs) -> Dict:[0m
[30;1m152 | [0m[35m    systems = None if not kwargs else kwargs.get("systems", None)[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m    # If the data volume is small, process it directly in the main thread[0m
[30;1m155 | [0m[35m    if len(sources) <= 1000:[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_baichuan.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m#    Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m6 | [0m[35m#    you may not use this file except in compliance with the License.[0m
[30;1m7 | [0m[35m#    You may obtain a copy of the License at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m#        http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m#    Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/data/prepare_all.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m        f"python3 -m fastchat.data.extract_single_round --in {prefix}_clean_lang_split_identity.json[0m
[30;1m37 | [0m[35m    ][0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    for cmd in cmd_list:[0m
[30;1m40 | [0m[35m        ret = run_cmd(cmd)[0m
[30;1m41 | [0m[35m        if ret != 0:[0m
[30;1m42 | [0m[35m            exit(ret)[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m    if model_api_dict is None:[0m
[30;1m394 | [0m[35m        # Query worker address[0m
[30;1m395 | [0m[35m        ret = requests.post([0m
[30;1m396 | [0m[35m            controller_url + "/get_worker_address", json={"model": model_name}[0m
[30;1m397 | [0m[35m        )[0m
[30;1m398 | [0m[35m        worker_addr = ret.json()["address"][0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35mdef is_limit_reached(model_name, ip):[0m
[30;1m345 | [0m[35m    monitor_url = "http://localhost:9090"[0m
[30;1m346 | [0m[35m    try:[0m
[30;1m347 | [0m[35m        ret = requests.get([0m
[30;1m348 | [0m[35m            f"{monitor_url}/is_limit_reached?model={model_name}&user_id={ip}", timeout=1[0m
[30;1m349 | [0m[35m        )[0m
[30;1m350 | [0m[35m        obj = ret.json()[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m        gen_params["images"] = images[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m    # Stream output[0m
[30;1m331 | [0m[35m    response = requests.post([0m
[30;1m332 | [0m[35m        worker_addr + "/worker_generate_stream",[0m
[30;1m333 | [0m[35m        headers=headers,[0m
[30;1m334 | [0m[35m        json=gen_params,[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m    # Sort models and add descriptions[0m
[30;1m166 | [0m[35m    priority = {k: f"___{i:03d}" for i, k in enumerate(model_info)}[0m
[30;1m167 | [0m[35m    models.sort(key=lambda x: priority.get(x, x))[0m
[30;1m168 | [0m[35m    visible_models.sort(key=lambda x: priority.get(x, x))[0m
[30;1m169 | [0m[35m    logger.info(f"All models: {models}")[0m
[30;1m170 | [0m[35m    logger.info(f"Visible models: {visible_models}")[0m
[30;1m171 | [0m[35m    return visible_models, models[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    # Sort models and add descriptions[0m
[30;1m166 | [0m[35m    priority = {k: f"___{i:03d}" for i, k in enumerate(model_info)}[0m
[30;1m167 | [0m[35m    models.sort(key=lambda x: priority.get(x, x))[0m
[30;1m168 | [0m[35m    visible_models.sort(key=lambda x: priority.get(x, x))[0m
[30;1m169 | [0m[35m    logger.info(f"All models: {models}")[0m
[30;1m170 | [0m[35m    logger.info(f"Visible models: {visible_models}")[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m    if register_api_endpoint_file:[0m
[30;1m147 | [0m[35m        api_endpoint_info = json.load(open(register_api_endpoint_file))[0m
[30;1m148 | [0m[35m        for mdl, mdl_dict in api_endpoint_info.items():[0m
[30;1m149 | [0m[35m            mdl_multimodal = mdl_dict.get("multimodal", False)[0m
[30;1m150 | [0m[35m            if multimodal and mdl_multimodal:[0m
[30;1m151 | [0m[35m                models += [mdl][0m
[30;1m152 | [0m[35m            elif not multimodal and not mdl_multimodal:[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m            ret = requests.post(controller_url + "/list_multimodal_models")[0m
[30;1m138 | [0m[35m            models = ret.json()["models"][0m
[30;1m139 | [0m[35m        else:[0m
[30;1m140 | [0m[35m            ret = requests.post(controller_url + "/list_language_models")[0m
[30;1m141 | [0m[35m            models = ret.json()["models"][0m
[30;1m142 | [0m[35m    else:[0m
[30;1m143 | [0m[35m        models = [][0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m        assert ret.status_code == 200[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        if multimodal:[0m
[30;1m137 | [0m[35m            ret = requests.post(controller_url + "/list_multimodal_models")[0m
[30;1m138 | [0m[35m            models = ret.json()["models"][0m
[30;1m139 | [0m[35m        else:[0m
[30;1m140 | [0m[35m            ret = requests.post(controller_url + "/list_language_models")[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    # Add models from the controller[0m
[30;1m132 | [0m[35m    if controller_url:[0m
[30;1m133 | [0m[35m        ret = requests.post(controller_url + "/refresh_all_workers")[0m
[30;1m134 | [0m[35m        assert ret.status_code == 200[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        if multimodal:[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m855 | [0m[35m    parser.add_argument([0m
[30;1m856 | [0m[35m        "--gradio-root-path",[0m
[30;1m857 | [0m[35m        type=str,[0m
[30;1m858 | [0m[35m        help="Sets the gradio root path, eg /abc/def. Useful when running behind a reverse-proxy or [0m
[30;1m859 | [0m[35m    )[0m
[30;1m860 | [0m[35m    args = parser.parse_args()[0m
[30;1m861 | [0m[35m    logger.info(f"args: {args}")[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m664 | [0m[35m            )[0m
[30;1m665 | [0m[35m        with gr.Row():[0m
[30;1m666 | [0m[35m            with gr.Accordion([0m
[30;1m667 | [0m[35m                f"üîç Expand to see the descriptions of {len(models)} models",[0m
[30;1m668 | [0m[35m                open=False,[0m
[30;1m669 | [0m[35m            ):[0m
[30;1m670 | [0m[35m                model_description_md = get_model_description_md(models)[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m612 | [0m[35m[Ion Stoica](http://people.eecs.berkeley.edu/~istoica/), [Joseph E. Gonzalez](https://people.eecs.be[0m
[30;1m613 | [0m[35m[0m
[30;1m614 | [0m[35m## Contact Us[0m
[30;1m615 | [0m[35m- Follow our [Twitter](https://twitter.com/lmsysorg), [Discord](https://discord.gg/HSWAKCrnFx) or em[0m
[30;1m616 | [0m[35m- File issues on [GitHub](https://github.com/lm-sys/FastChat)[0m
[30;1m617 | [0m[35m- Download our datasets and models on [HuggingFace](https://huggingface.co/lmsys)[0m
[30;1m618 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mbers from [LMSYS](https://lmsys.org/about/) and UC Berkeley [SkyLab](https://sky.cs.berkeley.edu/). [0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m## Read More[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m664 | [0m[35m            )[0m
[30;1m665 | [0m[35m        with gr.Row():[0m
[30;1m666 | [0m[35m            with gr.Accordion([0m
[30;1m667 | [0m[35m                f"üîç Expand to see the descriptions of {len(models)} models",[0m
[30;1m668 | [0m[35m                open=False,[0m
[30;1m669 | [0m[35m            ):[0m
[30;1m670 | [0m[35m                model_description_md = get_model_description_md(models)[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m496 | [0m[35m    finish_tstamp = time.time()[0m
[30;1m497 | [0m[35m    logger.info(f"{output}")[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m    # We load the image because gradio accepts base64 but that increases file size by ~1.33x[0m
[30;1m500 | [0m[35m    loaded_images = [load_image(image) for image in images][0m
[30;1m501 | [0m[35m    images_hash = [hashlib.md5(image.tobytes()).hexdigest() for image in loaded_images][0m
[30;1m502 | [0m[35m    for image, hash_str in zip(loaded_images, images_hash):[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m362 | [0m[35m    request: gr.Request,[0m
[30;1m363 | [0m[35m    apply_rate_limit=True,[0m
[30;1m364 | [0m[35m):[0m
[30;1m365 | [0m[35m    ip = get_ip(request)[0m
[30;1m366 | [0m[35m    logger.info(f"bot_response. ip: {ip}")[0m
[30;1m367 | [0m[35m    start_tstamp = time.time()[0m
[30;1m368 | [0m[35m    temperature = float(temperature)[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35mdef add_text(state, model_selector, text, image, request: gr.Request):[0m
[30;1m271 | [0m[35m    ip = get_ip(request)[0m
[30;1m272 | [0m[35m    logger.info(f"add_text. ip: {ip}. len: {len(text)}")[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    if state is None:[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m        ip = request.headers["cf-connecting-ip"][0m
[30;1m250 | [0m[35m    else:[0m
[30;1m251 | [0m[35m        ip = request.client.host[0m
[30;1m252 | [0m[35m    return ip[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35mdef _prepare_text_with_image(state, text, image):[0m
[30;1m256 | [0m[35m    if image is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m248 | [0m[35m    if "cf-connecting-ip" in request.headers:[0m
[30;1m249 | [0m[35m        ip = request.headers["cf-connecting-ip"][0m
[30;1m250 | [0m[35m    else:[0m
[30;1m251 | [0m[35m        ip = request.client.host[0m
[30;1m252 | [0m[35m    return ip[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35mdef get_ip(request: gr.Request):[0m
[30;1m248 | [0m[35m    if "cf-connecting-ip" in request.headers:[0m
[30;1m249 | [0m[35m        ip = request.headers["cf-connecting-ip"][0m
[30;1m250 | [0m[35m    else:[0m
[30;1m251 | [0m[35m        ip = request.client.host[0m
[30;1m252 | [0m[35m    return ip[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35mdef clear_history(request: gr.Request):[0m
[30;1m241 | [0m[35m    ip = get_ip(request)[0m
[30;1m242 | [0m[35m    logger.info(f"clear_history. ip: {ip}")[0m
[30;1m243 | [0m[35m    state = None[0m
[30;1m244 | [0m[35m    return (state, [], "", None) + (disable_btn,) * 5[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35mdef regenerate(state, request: gr.Request):[0m
[30;1m234 | [0m[35m    ip = get_ip(request)[0m
[30;1m235 | [0m[35m    logger.info(f"regenerate. ip: {ip}")[0m
[30;1m236 | [0m[35m    state.conv.update_last_message(None)[0m
[30;1m237 | [0m[35m    return (state, state.to_gradio_chatbot(), "", None) + (disable_btn,) * 5[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35mdef flag_last_response(state, model_selector, request: gr.Request):[0m
[30;1m227 | [0m[35m    ip = get_ip(request)[0m
[30;1m228 | [0m[35m    logger.info(f"flag. ip: {ip}")[0m
[30;1m229 | [0m[35m    vote_last_response(state, "flag", model_selector, request)[0m
[30;1m230 | [0m[35m    return ("",) + (disable_btn,) * 3[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35mdef downvote_last_response(state, model_selector, request: gr.Request):[0m
[30;1m220 | [0m[35m    ip = get_ip(request)[0m
[30;1m221 | [0m[35m    logger.info(f"downvote. ip: {ip}")[0m
[30;1m222 | [0m[35m    vote_last_response(state, "downvote", model_selector, request)[0m
[30;1m223 | [0m[35m    return ("",) + (disable_btn,) * 3[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35mdef upvote_last_response(state, model_selector, request: gr.Request):[0m
[30;1m213 | [0m[35m    ip = get_ip(request)[0m
[30;1m214 | [0m[35m    logger.info(f"upvote. ip: {ip}")[0m
[30;1m215 | [0m[35m    vote_last_response(state, "upvote", model_selector, request)[0m
[30;1m216 | [0m[35m    return ("",) + (disable_btn,) * 3[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35mdef load_demo(url_params, request: gr.Request):[0m
[30;1m187 | [0m[35m    global models[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    ip = get_ip(request)[0m
[30;1m190 | [0m[35m    logger.info(f"load_demo. ip: {ip}. params: {url_params}")[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    if args.model_list_mode == "reload":[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m        if mdl_dict["anony_only"]:[0m
[30;1m163 | [0m[35m            visible_models.remove(mdl)[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    # Sort models and add descriptions[0m
[30;1m166 | [0m[35m    priority = {k: f"___{i:03d}" for i, k in enumerate(model_info)}[0m
[30;1m167 | [0m[35m    models.sort(key=lambda x: priority.get(x, x))[0m
[30;1m168 | [0m[35m    visible_models.sort(key=lambda x: priority.get(x, x))[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mThe service is a research preview. It only provides limited safety measures and may generate offensi[0m
[30;1m63 | [0m[35mIt must not be used for any illegal, harmful, violent, racist, or sexual purposes.[0m
[30;1m64 | [0m[35mThe service collects user dialogue data and reserves the right to distribute it under a Creative Com[0m
[30;1m65 | [0m[35mAdditionally, Bard is offered on LMSys for research purposes only. To access the Bard product, pleas[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m### Acknowledgment[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35mUsers are required to agree to the following terms before using the service:[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mThe service is a research preview. It only provides limited safety measures and may generate offensi[0m
[30;1m63 | [0m[35mIt must not be used for any illegal, harmful, violent, racist, or sexual purposes.[0m
[30;1m64 | [0m[35mThe service collects user dialogue data and reserves the right to distribute it under a Creative Com[0m
[30;1m65 | [0m[35mAdditionally, Bard is offered on LMSys for research purposes only. To access the Bard product, pleas[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35menable_moderation = False[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35macknowledgment_md = """[0m
[30;1m58 | [0m[35m### Terms of Service[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35mUsers are required to agree to the following terms before using the service:[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mThe service is a research preview. It only provides limited safety measures and may generate offensi[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mimport json[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport random[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mimport uuid[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mimport gradio as gr[0m
[30;1m16 | [0m[35mimport requests[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m            "queue_length": sum([w.get_queue_length() for w in workers]),[0m
[30;1m280 | [0m[35m        },[0m
[30;1m281 | [0m[35m    }[0m
[30;1m282 | [0m[35m    r = requests.post(url, json=data)[0m
[30;1m283 | [0m[35m    assert r.status_code == 200[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m    return args, workers[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m    return worker.get_conv_template()[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m@app.post("/model_details")[0m
[30;1m151 | [0m[35masync def api_model_details(request: Request):[0m
[30;1m152 | [0m[35m    params = await request.json()[0m
[30;1m153 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m    return worker.count_token(params)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m@app.post("/worker_get_conv_template")[0m
[30;1m144 | [0m[35masync def api_get_conv(request: Request):[0m
[30;1m145 | [0m[35m    params = await request.json()[0m
[30;1m146 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m    }[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m@app.post("/count_token")[0m
[30;1m137 | [0m[35masync def api_count_token(request: Request):[0m
[30;1m138 | [0m[35m    params = await request.json()[0m
[30;1m139 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m    return JSONResponse(content=embedding, background=background_tasks)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m@app.post("/worker_get_status")[0m
[30;1m128 | [0m[35masync def api_get_status(request: Request):[0m
[30;1m129 | [0m[35m    return {[0m
[30;1m130 | [0m[35m        "model_names": [m for w in workers for m in w.model_names],[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m    return JSONResponse(output)[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m@app.post("/worker_get_embeddings")[0m
[30;1m118 | [0m[35masync def api_get_embeddings(request: Request):[0m
[30;1m119 | [0m[35m    params = await request.json()[0m
[30;1m120 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m    return StreamingResponse(generator, background=background_tasks)[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m@app.post("/worker_generate")[0m
[30;1m108 | [0m[35masync def api_generate(request: Request):[0m
[30;1m109 | [0m[35m    params = await request.json()[0m
[30;1m110 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m# underlying sub-worker to call.[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m@app.post("/worker_generate_stream")[0m
[30;1m98 | [0m[35masync def api_generate_stream(request: Request):[0m
[30;1m99 | [0m[35m    params = await request.json()[0m
[30;1m100 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/multi_model_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mimport logging[0m
[30;1m18 | [0m[35mimport json[0m
[30;1m19 | [0m[35mimport os[0m
[30;1m20 | [0m[35mimport time[0m
[30;1m21 | [0m[35mfrom typing import List, Union[0m
[30;1m22 | [0m[35mimport threading[0m
[30;1m23 | [0m[35mimport uuid[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/llama_flash_attn_monkey_patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m    cuda_major, cuda_minor = torch.cuda.get_device_capability()[0m
[30;1m99 | [0m[35m    if cuda_major < 8:[0m
[30;1m100 | [0m[35m        warnings.warn([0m
[30;1m101 | [0m[35m            "Flash attention is only supported on A100 or H100 GPU during training due to head dim >[0m
[30;1m102 | [0m[35m            "ref: https://github.com/HazyResearch/flash-attention/issues/190#issuecomment-1523359593[0m
[30;1m103 | [0m[35m        )[0m
[30;1m104 | [0m[35m    transformers.models.llama.modeling_llama.LlamaModel._prepare_decoder_attention_mask = ([0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m    return worker.get_conv_template()[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m@app.post("/model_details")[0m
[30;1m256 | [0m[35masync def api_model_details(request: Request):[0m
[30;1m257 | [0m[35m    return {"context_length": worker.context_len}[0m
[30;1m258 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m    return worker.count_token(params)[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m@app.post("/worker_get_conv_template")[0m
[30;1m251 | [0m[35masync def api_get_conv(request: Request):[0m
[30;1m252 | [0m[35m    return worker.get_conv_template()[0m
[30;1m253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m    return worker.get_status()[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m@app.post("/count_token")[0m
[30;1m245 | [0m[35masync def api_count_token(request: Request):[0m
[30;1m246 | [0m[35m    params = await request.json()[0m
[30;1m247 | [0m[35m    return worker.count_token(params)[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m    return JSONResponse(output)[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m@app.post("/worker_get_status")[0m
[30;1m240 | [0m[35masync def api_get_status(request: Request):[0m
[30;1m241 | [0m[35m    return worker.get_status()[0m
[30;1m242 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m    return StreamingResponse(generator, background=background_tasks)[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m@app.post("/worker_generate")[0m
[30;1m227 | [0m[35masync def api_generate(request: Request):[0m
[30;1m228 | [0m[35m    params = await request.json()[0m
[30;1m229 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m    return background_tasks[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m@app.post("/worker_generate_stream")[0m
[30;1m215 | [0m[35masync def api_generate_stream(request: Request):[0m
[30;1m216 | [0m[35m    params = await request.json()[0m
[30;1m217 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m                await httpserver_manager.abort(request_id)[0m
[30;1m157 | [0m[35m                finish_reason = "abort"[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m            logprob = metadata.get("logprob", None)[0m
[30;1m160 | [0m[35m            if logprob is not None:[0m
[30;1m161 | [0m[35m                cumulative_logprob += logprob[0m
[30;1m162 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m93 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m        request = params.get("request", None)[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # Handle stop_str[0m
[30;1m98 | [0m[35m        stop = set()[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m89 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m90 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m91 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m92 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m93 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m88 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m89 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m90 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m91 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m92 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m93 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m88 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m89 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m90 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m91 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m92 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m88 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m89 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m90 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m91 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m88 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m89 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m90 | [0m[35m        stop_str = params.get("stop", None)[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m88 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m89 | [0m[35m        echo = params.get("echo", True)[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m88 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m82 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        prompt = params.pop("prompt")[0m
[30;1m81 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m82 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        prompt = params.pop("prompt")[0m
[30;1m81 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m82 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m426 | [0m[35m        default=None,[0m
[30;1m427 | [0m[35m        help="""use to select the handle way when input token len > max_req_input_len.[0m
[30;1m428 | [0m[35m                        None : raise Exception[0m
[30;1m429 | [0m[35m                        head : remove some head tokens to make input token len <= max_req_input_len[0m
[30;1m430 | [0m[35m                        center : remove some tokens in center loc to make input token len <= max_req[0m
[30;1m431 | [0m[35m    )[0m
[30;1m432 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m426 | [0m[35m        default=None,[0m
[30;1m427 | [0m[35m        help="""use to select the handle way when input token len > max_req_input_len.[0m
[30;1m428 | [0m[35m                        None : raise Exception[0m
[30;1m429 | [0m[35m                        head : remove some head tokens to make input token len <= max_req_input_len[0m
[30;1m430 | [0m[35m                        center : remove some tokens in center loc to make input token len <= max_req[0m
[30;1m431 | [0m[35m    )[0m
[30;1m432 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m        "--batch_max_tokens",[0m
[30;1m309 | [0m[35m        type=int,[0m
[30;1m310 | [0m[35m        default=None,[0m
[30;1m311 | [0m[35m        help="max tokens num for new cat batch, it control prefill batch size to Preventing OOM",[0m
[30;1m312 | [0m[35m    )[0m
[30;1m313 | [0m[35m    parser.add_argument("--eos_id", type=int, default=2, help="eos stop token id")[0m
[30;1m314 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m369 | [0m[35m        "--router_token_ratio",[0m
[30;1m370 | [0m[35m        type=float,[0m
[30;1m371 | [0m[35m        default=0.0,[0m
[30;1m372 | [0m[35m        help="token ratio to control router dispatch",[0m
[30;1m373 | [0m[35m    )[0m
[30;1m374 | [0m[35m    parser.add_argument([0m
[30;1m375 | [0m[35m        "--router_max_new_token_len",[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m308 | [0m[35m        "--batch_max_tokens",[0m
[30;1m309 | [0m[35m        type=int,[0m
[30;1m310 | [0m[35m        default=None,[0m
[30;1m311 | [0m[35m        help="max tokens num for new cat batch, it control prefill batch size to Preventing OOM",[0m
[30;1m312 | [0m[35m    )[0m
[30;1m313 | [0m[35m    parser.add_argument("--eos_id", type=int, default=2, help="eos stop token id")[0m
[30;1m314 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/lightllm_worker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mA model worker that executes the model based on LightLLM.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mSee documentations at docs/lightllm_integration.md[0m
[30;1m5 | [0m[35m"""[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport argparse[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_anony.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m431 | [0m[35mdef get_sample_weight(model):[0m
[30;1m432 | [0m[35m    if model in OUTAGE_MODELS:[0m
[30;1m433 | [0m[35m        return 0[0m
[30;1m434 | [0m[35m    weight = SAMPLING_WEIGHTS.get(model, 1.0)[0m
[30;1m435 | [0m[35m    if model in SAMPLING_BOOST_MODELS:[0m
[30;1m436 | [0m[35m        weight *= 5[0m
[30;1m437 | [0m[35m    return weight[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_anony.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m639 | [0m[35m[0m
[30;1m640 | [0m[35m    with gr.Group(elem_id="share-region-anony"):[0m
[30;1m641 | [0m[35m        with gr.Accordion([0m
[30;1m642 | [0m[35m            f"üîç Expand to see the descriptions of {len(models)} models", open=False[0m
[30;1m643 | [0m[35m        ):[0m
[30;1m644 | [0m[35m            model_description_md = get_model_description_md(models)[0m
[30;1m645 | [0m[35m            gr.Markdown(model_description_md, elem_id="model_description_markdown")[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_anony.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m625 | [0m[35m- Vote won't be counted if model identity is revealed during conversation.[0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m## üèÜ Arena Elo&nbsp;[Leaderboard](https://huggingface.co/spaces/lmsys/chatbot-arena-leaderboard)[0m
[30;1m628 | [0m[35mWe collect **200K+** human votes to compute an Elo-based LLM leaderboard.[0m
[30;1m629 | [0m[35mFind out who is the ü•áLLM Champion![0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m## üëá Chat now![0m
[30;1m632 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_anony.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m483 | [0m[35mdef add_text([0m
[30;1m484 | [0m[35m    state0, state1, model_selector0, model_selector1, text, request: gr.Request[0m
[30;1m485 | [0m[35m):[0m
[30;1m486 | [0m[35m    ip = get_ip(request)[0m
[30;1m487 | [0m[35m    logger.info(f"add_text (anony). ip: {ip}. len: {len(text)}")[0m
[30;1m488 | [0m[35m    states = [state0, state1][0m
[30;1m489 | [0m[35m    model_selectors = [model_selector0, model_selector1][0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_anony.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport json[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport gradio as gr[0m
[30;1m10 | [0m[35mimport numpy as np[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_anony.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m639 | [0m[35m[0m
[30;1m640 | [0m[35m    with gr.Group(elem_id="share-region-anony"):[0m
[30;1m641 | [0m[35m        with gr.Accordion([0m
[30;1m642 | [0m[35m            f"üîç Expand to see the descriptions of {len(models)} models", open=False[0m
[30;1m643 | [0m[35m        ):[0m
[30;1m644 | [0m[35m            model_description_md = get_model_description_md(models)[0m
[30;1m645 | [0m[35m            gr.Markdown(model_description_md, elem_id="model_description_markdown")[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/inspect_conv.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mfrom pytz import timezone[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport pandas as pd[0m
[30;1m10 | [0m[35mfrom tqdm import tqdm[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/dataset_release_scripts/lmsys_chat_1m/merge_oai_tag.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom tqdm import tqdm[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m527 | [0m[35m    else:[0m
[30;1m528 | [0m[35m        new_gamekey = (qid, model_2, model_1)[0m
[30;1m529 | [0m[35m        new_result = {[0m
[30;1m530 | [0m[35m            "winners": tuple(reverse_model_map.get(x, x) for x in result["winners"]),[0m
[30;1m531 | [0m[35m            "g1_judgment": result["g2_judgment"],[0m
[30;1m532 | [0m[35m            "g2_judgment": result["g1_judgment"],[0m
[30;1m533 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m        g1_map = {"A": "model_1", "B": "model_2"}[0m
[30;1m334 | [0m[35m        g2_map = {"A": "model_2", "B": "model_1"}[0m
[30;1m335 | [0m[35m        g1_winner = g1_map.get(g1_winner, g1_winner)[0m
[30;1m336 | [0m[35m        g2_winner = g2_map.get(g2_winner, g2_winner)[0m
[30;1m337 | [0m[35m        question_id = question["question_id"][0m
[30;1m338 | [0m[35m        turn = 1 if not multi_turn else 2[0m
[30;1m339 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m        g1_map = {"A": "model_1", "B": "model_2"}[0m
[30;1m334 | [0m[35m        g2_map = {"A": "model_2", "B": "model_1"}[0m
[30;1m335 | [0m[35m        g1_winner = g1_map.get(g1_winner, g1_winner)[0m
[30;1m336 | [0m[35m        g2_winner = g2_map.get(g2_winner, g2_winner)[0m
[30;1m337 | [0m[35m        question_id = question["question_id"][0m
[30;1m338 | [0m[35m        turn = 1 if not multi_turn else 2[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport os[0m
[30;1m10 | [0m[35mimport re[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mfrom typing import Optional[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport openai[0m
[30;1m15 | [0m[35mimport anthropic[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/clean_chat_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m            continue[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m        ip = row["ip"][0m
[30;1m110 | [0m[35m        if ip not in all_ips:[0m
[30;1m111 | [0m[35m            all_ips[ip] = len(all_ips)[0m
[30;1m112 | [0m[35m        user_id = all_ips[ip][0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/clean_chat_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m            ct_network_error += 1[0m
[30;1m107 | [0m[35m            continue[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m        ip = row["ip"][0m
[30;1m110 | [0m[35m        if ip not in all_ips:[0m
[30;1m111 | [0m[35m            all_ips[ip] = len(all_ips)[0m
[30;1m112 | [0m[35m        user_id = all_ips[ip][0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/clean_chat_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mimport json[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mfrom pytz import timezone[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom tqdm import tqdm[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom fastchat.serve.monitor.basic_stats import NUM_SERVERS[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        "stop_token_ids": conv.stop_token_ids,[0m
[30;1m46 | [0m[35m        "echo": False,[0m
[30;1m47 | [0m[35m    }[0m
[30;1m48 | [0m[35m    response = requests.post([0m
[30;1m49 | [0m[35m        worker_addr + "/worker_generate_stream",[0m
[30;1m50 | [0m[35m        headers=headers,[0m
[30;1m51 | [0m[35m        json=gen_params,[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        models.sort()[0m
[30;1m21 | [0m[35m        print(f"Models: {models}")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m        ret = requests.post([0m
[30;1m24 | [0m[35m            controller_addr + "/get_worker_address", json={"model": model_name}[0m
[30;1m25 | [0m[35m        )[0m
[30;1m26 | [0m[35m        worker_addr = ret.json()["address"][0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m    else:[0m
[30;1m16 | [0m[35m        controller_addr = args.controller_address[0m
[30;1m17 | [0m[35m        ret = requests.post(controller_addr + "/refresh_all_workers")[0m
[30;1m18 | [0m[35m        ret = requests.post(controller_addr + "/list_models")[0m
[30;1m19 | [0m[35m        models = ret.json()["models"][0m
[30;1m20 | [0m[35m        models.sort()[0m
[30;1m21 | [0m[35m        print(f"Models: {models}")[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_message.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m        worker_addr = args.worker_address[0m
[30;1m15 | [0m[35m    else:[0m
[30;1m16 | [0m[35m        controller_addr = args.controller_address[0m
[30;1m17 | [0m[35m        ret = requests.post(controller_addr + "/refresh_all_workers")[0m
[30;1m18 | [0m[35m        ret = requests.post(controller_addr + "/list_models")[0m
[30;1m19 | [0m[35m        models = ret.json()["models"][0m
[30;1m20 | [0m[35m        models.sort()[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/compression.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m        use_safetensors = True[0m
[30;1m176 | [0m[35m    if len(files) == 0:[0m
[30;1m177 | [0m[35m        raise ValueError([0m
[30;1m178 | [0m[35m            f"Cannot find any model weight files. "[0m
[30;1m179 | [0m[35m            f"Please check your (cached) weight path: {model_path}"[0m
[30;1m180 | [0m[35m        )[0m
[30;1m181 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/data/split_long_conversation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    assert (end_idx - start_idx) % 2 == 0[0m
[30;1m20 | [0m[35m    return {[0m
[30;1m21 | [0m[35m        "id": sample["id"] + "_" + str(start_idx),[0m
[30;1m22 | [0m[35m        "model": sample.get("model", ""),[0m
[30;1m23 | [0m[35m        "conversations": sample["conversations"][start_idx:end_idx],[0m
[30;1m24 | [0m[35m    }[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_vision_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m            if content is None:[0m
[30;1m116 | [0m[35m                content = ""[0m
[30;1m117 | [0m[35m        except Exception as e:[0m
[30;1m118 | [0m[35m            content = chunk.choices[0].delta.get("content", "")[0m
[30;1m119 | [0m[35m        print(content, end="", flush=True)[0m
[30;1m120 | [0m[35m    print()[0m
[30;1m121 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_vision_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    from PIL import Image[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    if image.startswith("http://") or image.startswith("https://"):[0m
[30;1m24 | [0m[35m        response = requests.get(image)[0m
[30;1m25 | [0m[35m        image = Image.open(BytesIO(response.content)).convert("RGB")[0m
[30;1m26 | [0m[35m    else:[0m
[30;1m27 | [0m[35m        image = Image.open(image).convert("RGB")[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_vision_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m    print(completion.choices[0].message.content)[0m
[30;1m77 | [0m[35m    print("=" * 25)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    # Image using base64 image url[0m
[30;1m80 | [0m[35m    completion = openai.chat.completions.create([0m
[30;1m81 | [0m[35m        model=model,[0m
[30;1m82 | [0m[35m        messages=[[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_vision_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mdef encode_image(image):[0m
[30;1m17 | [0m[35m    import base64[0m
[30;1m18 | [0m[35m    from io import BytesIO[0m
[30;1m19 | [0m[35m    import requests[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    from PIL import Image[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m    return worker.get_conv_template()[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m@app.post("/model_details")[0m
[30;1m240 | [0m[35masync def api_model_details(request: Request):[0m
[30;1m241 | [0m[35m    return {"context_length": worker.context_len}[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m    return worker.count_token(params)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m@app.post("/worker_get_conv_template")[0m
[30;1m235 | [0m[35masync def api_get_conv(request: Request):[0m
[30;1m236 | [0m[35m    return worker.get_conv_template()[0m
[30;1m237 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m    return worker.get_status()[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m@app.post("/count_token")[0m
[30;1m229 | [0m[35masync def api_count_token(request: Request):[0m
[30;1m230 | [0m[35m    params = await request.json()[0m
[30;1m231 | [0m[35m    return worker.count_token(params)[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m    return JSONResponse(content=embedding)[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m@app.post("/worker_get_status")[0m
[30;1m224 | [0m[35masync def api_get_status(request: Request):[0m
[30;1m225 | [0m[35m    return worker.get_status()[0m
[30;1m226 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m    return JSONResponse(output)[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m@app.post("/worker_get_embeddings")[0m
[30;1m215 | [0m[35masync def api_get_embeddings(request: Request):[0m
[30;1m216 | [0m[35m    params = await request.json()[0m
[30;1m217 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m    return StreamingResponse(generator, background=background_tasks)[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m@app.post("/worker_generate")[0m
[30;1m206 | [0m[35masync def api_generate(request: Request):[0m
[30;1m207 | [0m[35m    params = await request.json()[0m
[30;1m208 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m    return background_tasks[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m@app.post("/worker_generate_stream")[0m
[30;1m197 | [0m[35masync def api_generate_stream(request: Request):[0m
[30;1m198 | [0m[35m    params = await request.json()[0m
[30;1m199 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m        while True:[0m
[30;1m113 | [0m[35m            try:[0m
[30;1m114 | [0m[35m                ret = requests.post([0m
[30;1m115 | [0m[35m                    url,[0m
[30;1m116 | [0m[35m                    json={[0m
[30;1m117 | [0m[35m                        "worker_name": self.worker_addr,[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m            "worker_status": self.get_status(),[0m
[30;1m97 | [0m[35m            "multimodal": self.multimodal,[0m
[30;1m98 | [0m[35m        }[0m
[30;1m99 | [0m[35m        r = requests.post(url, json=data)[0m
[30;1m100 | [0m[35m        assert r.status_code == 200[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    def send_heart_beat(self):[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/base_model_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport threading[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom typing import List[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom fastapi import FastAPI, Request, BackgroundTasks[0m
[30;1m7 | [0m[35mfrom fastapi.responses import StreamingResponse, JSONResponse[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/basic_stats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m                type=row["type"],[0m
[30;1m51 | [0m[35m                tstamp=row["tstamp"],[0m
[30;1m52 | [0m[35m                model=row.get("model", ""),[0m
[30;1m53 | [0m[35m                models=row.get("models", ["", ""]),[0m
[30;1m54 | [0m[35m            )[0m
[30;1m55 | [0m[35m        )[0m
[30;1m56 | [0m[35m    return data[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/basic_stats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m            dict([0m
[30;1m50 | [0m[35m                type=row["type"],[0m
[30;1m51 | [0m[35m                tstamp=row["tstamp"],[0m
[30;1m52 | [0m[35m                model=row.get("model", ""),[0m
[30;1m53 | [0m[35m                models=row.get("models", ["", ""]),[0m
[30;1m54 | [0m[35m            )[0m
[30;1m55 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/basic_stats.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m188 | [0m[35m    last_24_hours_df = pd.DataFrame({"time": times, "value": num_chats_last_24_hours})[0m
[30;1m189 | [0m[35m    last_24_hours_md = last_24_hours_df.to_markdown(index=False, tablefmt="github")[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    # Last update datetime[0m
[30;1m192 | [0m[35m    last_updated_tstamp = now_t[0m
[30;1m193 | [0m[35m    last_updated_datetime = datetime.datetime.fromtimestamp([0m
[30;1m194 | [0m[35m        last_updated_tstamp, tz=timezone("US/Pacific")[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/basic_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m                filepath = f"{log_root}/server{i}/{filename}"[0m
[30;1m26 | [0m[35m                name_tstamp_tuple = (filepath, os.path.getmtime(filepath))[0m
[30;1m27 | [0m[35m                filenames.append(name_tstamp_tuple)[0m
[30;1m28 | [0m[35m    # sort by tstamp[0m
[30;1m29 | [0m[35m    filenames = sorted(filenames, key=lambda x: x[1])[0m
[30;1m30 | [0m[35m    filenames = [x[0] for x in filenames][0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/basic_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mfrom pytz import timezone[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport pandas as pd  # pandas>=2.0.3[0m
[30;1m10 | [0m[35mimport plotly.express as px[0m
[30;1m11 | [0m[35mimport plotly.graph_objects as go[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/clean_battle_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m        else:[0m
[30;1m217 | [0m[35m            user_id = f"{all_ips[ip]['ip']}"[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        if ban_ip_list is not None and ip in ban_ip_list:[0m
[30;1m220 | [0m[35m            ct_banned += 1[0m
[30;1m221 | [0m[35m            continue[0m
[30;1m222 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/clean_battle_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m        )[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        ip = row["ip"][0m
[30;1m211 | [0m[35m        if ip not in all_ips:[0m
[30;1m212 | [0m[35m            all_ips[ip] = {"ip": ip, "count": 0, "sanitized_id": len(all_ips)}[0m
[30;1m213 | [0m[35m        all_ips[ip]["count"] += 1[0m
[30;1m214 | [0m[35m        if sanitize_ip:[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/clean_battle_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m            row["states"][1]["messages"][row["states"][1]["offset"] :][0m
[30;1m208 | [0m[35m        )[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        ip = row["ip"][0m
[30;1m211 | [0m[35m        if ip not in all_ips:[0m
[30;1m212 | [0m[35m            all_ips[ip] = {"ip": ip, "count": 0, "sanitized_id": len(all_ips)}[0m
[30;1m213 | [0m[35m        all_ips[ip]["count"] += 1[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/clean_battle_data.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mimport json[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mfrom pytz import timezone[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom tqdm import tqdm[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom fastchat.serve.monitor.basic_stats import get_log_files, NUM_SERVERS[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/qa_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m            ans["choices"][0]["turns"][i].strip()[0m
[30;1m169 | [0m[35m        )[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    ref = question.get("reference", ["", ""])[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    ref_md = ""[0m
[30;1m174 | [0m[35m    if turn is None:[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/qa_browser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m            ans_b["choices"][0]["turns"][i].strip()[0m
[30;1m140 | [0m[35m        )[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    ref = question.get("reference", ["", ""])[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    ref_md = ""[0m
[30;1m145 | [0m[35m    if turn is None:[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/qa_browser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m368 | [0m[35m        gr.Markdown([0m
[30;1m369 | [0m[35m            """[0m
[30;1m370 | [0m[35m# MT-Bench Browser[0m
[30;1m371 | [0m[35mThe code to generate answers and judgments is at [fastchat.llm_judge](https://github.com/lm-sys/Fast[0m
[30;1m372 | [0m[35m"""[0m
[30;1m373 | [0m[35m        )[0m
[30;1m374 | [0m[35m        with gr.Tab("Single Answer Grading"):[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m304 | [0m[35m        # Load image if it has not been loaded in yet[0m
[30;1m305 | [0m[35m        if type(image) == str:[0m
[30;1m306 | [0m[35m            if image.startswith("http://") or image.startswith("https://"):[0m
[30;1m307 | [0m[35m                response = requests.get(image)[0m
[30;1m308 | [0m[35m                image = Image.open(BytesIO(response.content)).convert("RGB")[0m
[30;1m309 | [0m[35m            elif "base64" in image:[0m
[30;1m310 | [0m[35m                # OpenAI format is: data:image/jpeg;base64,{base64_encoded_image_str}[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m7. Superhero Training Camp: Create a superhero-themed party where the kids can engage in fun trainin[0m
[30;1m448 | [0m[35m8. Outdoor Adventure: Plan an outdoor adventure party at a local park or nature reserve. Arrange act[0m
[30;1m449 | [0m[35mRemember to tailor the activities to the birthday child's interests and preferences. Have a great ce[0m
[30;1m450 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m338 | [0m[35m            if i % 2 == 0:[0m
[30;1m339 | [0m[35m                if type(msg) is tuple:[0m
[30;1m340 | [0m[35m                    msg, image = msg[0m
[30;1m341 | [0m[35m                    img_b64_str = image[0]  # Only one image on gradio at one time[0m
[30;1m342 | [0m[35m                    img_str = f'<img src="data:image/jpeg;base64,{img_b64_str}" alt="user upload ima[0m
[30;1m343 | [0m[35m                    msg = img_str + msg.replace("<image>\n", "").strip()[0m
[30;1m344 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m292 | [0m[35m        """Update the last output.[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        The last message is typically set to be None when constructing the prompt,[0m
[30;1m295 | [0m[35m        so we need to update it in-place after getting the response from a model.[0m
[30;1m296 | [0m[35m        """[0m
[30;1m297 | [0m[35m        self.messages[-1][1] = message[0m
[30;1m298 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m442 | [0m[35mty: Plan a science-themed party where kids can engage in fun and interactive experiments. You can se[0m
[30;1m443 | [0m[35m3. Outdoor Movie Night: Set up a backyard movie night with a projector and a large screen or white s[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m338 | [0m[35m            if i % 2 == 0:[0m
[30;1m339 | [0m[35m                if type(msg) is tuple:[0m
[30;1m340 | [0m[35m                    msg, image = msg[0m
[30;1m341 | [0m[35m                    img_b64_str = image[0]  # Only one image on gradio at one time[0m
[30;1m342 | [0m[35m                    img_str = f'<img src="data:image/jpeg;base64,{img_b64_str}" alt="user upload ima[0m
[30;1m343 | [0m[35m                    msg = img_str + msg.replace("<image>\n", "").strip()[0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m                ret.append([msg, None])[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m297 | [0m[35m        self.messages[-1][1] = message[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m    def convert_image_to_base64(self, image):[0m
[30;1m300 | [0m[35m        """Given an image, return the base64 encoded image string."""[0m
[30;1m301 | [0m[35m        from PIL import Image[0m
[30;1m302 | [0m[35m        import requests[0m
[30;1m303 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mIf you have any changes in mind, please contribute back so the community can benefit collectively an[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport base64[0m
[30;1m9 | [0m[35mimport dataclasses[0m
[30;1m10 | [0m[35mfrom enum import auto, IntEnum[0m
[30;1m11 | [0m[35mfrom io import BytesIO[0m
[30;1m12 | [0m[35mfrom typing import List, Any, Dict, Union, Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/conversation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mConversation prompt templates.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mWe kindly request that you import fastchat instead of copying this file if you wish to use it.[0m
[30;1m5 | [0m[35mIf you have any changes in mind, please contribute back so the community can benefit collectively an[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m#    Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m6 | [0m[35m#    you may not use this file except in compliance with the License.[0m
[30;1m7 | [0m[35m#    You may obtain a copy of the License at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m#        http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m#    Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m    return worker.get_conv_template()[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m@app.post("/model_details")[0m
[30;1m232 | [0m[35masync def api_model_details(request: Request):[0m
[30;1m233 | [0m[35m    return {"context_length": worker.context_len}[0m
[30;1m234 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m    return worker.count_token(params)[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m@app.post("/worker_get_conv_template")[0m
[30;1m227 | [0m[35masync def api_get_conv(request: Request):[0m
[30;1m228 | [0m[35m    return worker.get_conv_template()[0m
[30;1m229 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m    return worker.get_status()[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m@app.post("/count_token")[0m
[30;1m221 | [0m[35masync def api_count_token(request: Request):[0m
[30;1m222 | [0m[35m    params = await request.json()[0m
[30;1m223 | [0m[35m    return worker.count_token(params)[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m    return JSONResponse(output)[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m@app.post("/worker_get_status")[0m
[30;1m216 | [0m[35masync def api_get_status(request: Request):[0m
[30;1m217 | [0m[35m    return worker.get_status()[0m
[30;1m218 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m    return StreamingResponse(generator, background=background_tasks)[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m@app.post("/worker_generate")[0m
[30;1m203 | [0m[35masync def api_generate(request: Request):[0m
[30;1m204 | [0m[35m    params = await request.json()[0m
[30;1m205 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m    return background_tasks[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m@app.post("/worker_generate_stream")[0m
[30;1m192 | [0m[35masync def api_generate_stream(request: Request):[0m
[30;1m193 | [0m[35m    params = await request.json()[0m
[30;1m194 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m92 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m93 | [0m[35m        use_beam_search = params.get("use_beam_search", False)[0m
[30;1m94 | [0m[35m        best_of = params.get("best_of", None)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        # Handle stop_str[0m
[30;1m97 | [0m[35m        stop = set()[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m91 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m92 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m93 | [0m[35m        use_beam_search = params.get("use_beam_search", False)[0m
[30;1m94 | [0m[35m        best_of = params.get("best_of", None)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        # Handle stop_str[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m90 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m91 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m92 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m93 | [0m[35m        use_beam_search = params.get("use_beam_search", False)[0m
[30;1m94 | [0m[35m        best_of = params.get("best_of", None)[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m88 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m89 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m90 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m91 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m92 | [0m[35m        echo = params.get("echo", True)[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m88 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m89 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m90 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m91 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m88 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m89 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m90 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m88 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m89 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m88 | [0m[35m        stop_str = params.get("stop", None)[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m82 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m87 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        context = params.pop("prompt")[0m
[30;1m81 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m82 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m86 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        context = params.pop("prompt")[0m
[30;1m81 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m82 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m83 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m84 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m85 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/mlx_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mCode based on vllm_worker https://github.com/lm-sys/FastChat/blob/main/fastchat/serve/vllm_worker.py[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mYou must install MLX python:[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mpip install mlx-lm[0m
[30;1m13 | [0m[35m"""[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mimport argparse[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m338 | [0m[35mpip3 install -e ".[train]"[0m
[30;1m339 | [0m[35m```[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m- You can use the following command to train Vicuna-7B with 4 x A100 (40GB). Update `--model_name_or[0m
[30;1m342 | [0m[35m```bash[0m
[30;1m343 | [0m[35mtorchrun --nproc_per_node=4 --master_port=20001 fastchat/train/train_mem.py \[0m
[30;1m344 | [0m[35m    --model_name_or_path meta-llama/Llama-2-7b-hf \[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m312 | [0m[35m## Evaluation[0m
[30;1m313 | [0m[35mWe use MT-bench, a set of challenging multi-turn open-ended questions to evaluate models. [0m
[30;1m314 | [0m[35mTo automate the evaluation process, we prompt strong LLMs like GPT-4 to act as judges and assess the[0m
[30;1m315 | [0m[35mSee instructions for running MT-bench at [fastchat/llm_judge](fastchat/llm_judge).[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35mMT-bench is the new recommended way to benchmark your models. If you are still looking for the old 8[0m
[30;1m318 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m282 | [0m[35mIf the models do not show up, try to reboot the gradio web server.[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m#### (Optional): Advanced Features, Scalability, Third Party UI[0m
[30;1m285 | [0m[35m- You can register multiple model workers to a single controller, which can be used for serving a si[0m
[30;1m286 | [0m[35m```[0m
[30;1m287 | [0m[35m# worker 0[0m
[30;1m288 | [0m[35mCUDA_VISIBLE_DEVICES=0 python3 -m fastchat.serve.model_worker --model-path lmsys/vicuna-7b-v1.5 --co[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m## Citation[0m
[30;1m383 | [0m[35mThe code (training, serving, and evaluation) in this repository is mostly developed for or derived f[0m
[30;1m384 | [0m[35mPlease cite it if you find the repository helpful.[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m```[0m
[30;1m387 | [0m[35m@misc{zheng2023judging,[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m376 | [0m[35mstChat-T5) and use LoRA are in [docs/training.md](docs/training.md).[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m### Fine-tuning on Any Cloud with SkyPilot[0m
[30;1m379 | [0m[35m[SkyPilot](https://github.com/skypilot-org/skypilot) is a framework built by UC Berkeley for easily [0m
[30;1m380 | [0m[35mFind SkyPilot documentation [here](https://github.com/skypilot-org/skypilot/tree/master/llm/vicuna) [0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m## Citation[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m## API[0m
[30;1m300 | [0m[35m### OpenAI-Compatible RESTful APIs & SDK[0m
[30;1m301 | [0m[35mFastChat provides OpenAI-compatible APIs for its supported models, so you can use FastChat as a loca[0m
[30;1m302 | [0m[35mThe FastChat server is compatible with both [openai-python](https://github.com/openai/openai-python)[0m
[30;1m303 | [0m[35mThe REST API is capable of being executed from Google Colab free tier, as demonstrated in the [FastC[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m2. Install Package[0m
[30;1m107 | [0m[35m```bash[0m
[30;1m108 | [0m[35mpip3 install --upgrade pip  # enable PEP 660 support[0m
[30;1m109 | [0m[35mpip3 install -e ".[model_worker,webui]"[0m
[30;1m110 | [0m[35m```[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m### Method 2: From source[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m1. Clone this repository and navigate to the FastChat folder[0m
[30;1m96 | [0m[35m```bash[0m
[30;1m97 | [0m[35mgit clone https://github.com/lm-sys/FastChat.git[0m
[30;1m98 | [0m[35mcd FastChat[0m
[30;1m99 | [0m[35m```[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m## Install[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m### Method 1: With pip[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m```bash[0m
[30;1m90 | [0m[35mpip3 install "fschat[model_worker,webui]"[0m
[30;1m91 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m338 | [0m[35mpip3 install -e ".[train]"[0m
[30;1m339 | [0m[35m```[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m- You can use the following command to train Vicuna-7B with 4 x A100 (40GB). Update `--model_name_or[0m
[30;1m342 | [0m[35m```bash[0m
[30;1m343 | [0m[35mtorchrun --nproc_per_node=4 --master_port=20001 fastchat/train/train_mem.py \[0m
[30;1m344 | [0m[35m    --model_name_or_path meta-llama/Llama-2-7b-hf \[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m312 | [0m[35m## Evaluation[0m
[30;1m313 | [0m[35mWe use MT-bench, a set of challenging multi-turn open-ended questions to evaluate models. [0m
[30;1m314 | [0m[35mTo automate the evaluation process, we prompt strong LLMs like GPT-4 to act as judges and assess the[0m
[30;1m315 | [0m[35mSee instructions for running MT-bench at [fastchat/llm_judge](fastchat/llm_judge).[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35mMT-bench is the new recommended way to benchmark your models. If you are still looking for the old 8[0m
[30;1m318 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m282 | [0m[35mIf the models do not show up, try to reboot the gradio web server.[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m#### (Optional): Advanced Features, Scalability, Third Party UI[0m
[30;1m285 | [0m[35m- You can register multiple model workers to a single controller, which can be used for serving a si[0m
[30;1m286 | [0m[35m```[0m
[30;1m287 | [0m[35m# worker 0[0m
[30;1m288 | [0m[35mCUDA_VISIBLE_DEVICES=0 python3 -m fastchat.serve.model_worker --model-path lmsys/vicuna-7b-v1.5 --co[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m## Citation[0m
[30;1m383 | [0m[35mThe code (training, serving, and evaluation) in this repository is mostly developed for or derived f[0m
[30;1m384 | [0m[35mPlease cite it if you find the repository helpful.[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m```[0m
[30;1m387 | [0m[35m@misc{zheng2023judging,[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m376 | [0m[35mstChat-T5) and use LoRA are in [docs/training.md](docs/training.md).[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m### Fine-tuning on Any Cloud with SkyPilot[0m
[30;1m379 | [0m[35m[SkyPilot](https://github.com/skypilot-org/skypilot) is a framework built by UC Berkeley for easily [0m
[30;1m380 | [0m[35mFind SkyPilot documentation [here](https://github.com/skypilot-org/skypilot/tree/master/llm/vicuna) [0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m## Citation[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m## API[0m
[30;1m300 | [0m[35m### OpenAI-Compatible RESTful APIs & SDK[0m
[30;1m301 | [0m[35mFastChat provides OpenAI-compatible APIs for its supported models, so you can use FastChat as a loca[0m
[30;1m302 | [0m[35mThe FastChat server is compatible with both [openai-python](https://github.com/openai/openai-python)[0m
[30;1m303 | [0m[35mThe REST API is capable of being executed from Google Colab free tier, as demonstrated in the [FastC[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m2. Install Package[0m
[30;1m107 | [0m[35m```bash[0m
[30;1m108 | [0m[35mpip3 install --upgrade pip  # enable PEP 660 support[0m
[30;1m109 | [0m[35mpip3 install -e ".[model_worker,webui]"[0m
[30;1m110 | [0m[35m```[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m### Method 2: From source[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m1. Clone this repository and navigate to the FastChat folder[0m
[30;1m96 | [0m[35m```bash[0m
[30;1m97 | [0m[35mgit clone https://github.com/lm-sys/FastChat.git[0m
[30;1m98 | [0m[35mcd FastChat[0m
[30;1m99 | [0m[35m```[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fschat.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m## Install[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m### Method 1: With pip[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m```bash[0m
[30;1m90 | [0m[35mpip3 install "fschat[model_worker,webui]"[0m
[30;1m91 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/data/extract_gpt4_only.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    content = content[args.begin : args.end][0m
[30;1m20 | [0m[35m    new_content = [][0m
[30;1m21 | [0m[35m    for c in content:[0m
[30;1m22 | [0m[35m        model = c.get("model", None)[0m
[30;1m23 | [0m[35m        if model == "gpt4" or model is None:[0m
[30;1m24 | [0m[35m            new_content.append(c)[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_throughput.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        else:[0m
[30;1m56 | [0m[35m            thread_worker_addr = worker_addr[0m
[30;1m57 | [0m[35m        print(f"thread {i} goes to {thread_worker_addr}")[0m
[30;1m58 | [0m[35m        response = requests.post([0m
[30;1m59 | [0m[35m            thread_worker_addr + "/worker_generate_stream",[0m
[30;1m60 | [0m[35m            headers=headers,[0m
[30;1m61 | [0m[35m            json=ploads[i],[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_throughput.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    def send_request(results, i):[0m
[30;1m50 | [0m[35m        if args.test_dispatch:[0m
[30;1m51 | [0m[35m            ret = requests.post([0m
[30;1m52 | [0m[35m                controller_addr + "/get_worker_address", json={"model": args.model_name}[0m
[30;1m53 | [0m[35m            )[0m
[30;1m54 | [0m[35m            thread_worker_addr = ret.json()["address"][0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_throughput.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        models.sort()[0m
[30;1m21 | [0m[35m        print(f"Models: {models}")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m        ret = requests.post([0m
[30;1m24 | [0m[35m            controller_addr + "/get_worker_address", json={"model": args.model_name}[0m
[30;1m25 | [0m[35m        )[0m
[30;1m26 | [0m[35m        worker_addr = ret.json()["address"][0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_throughput.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m    else:[0m
[30;1m16 | [0m[35m        controller_addr = args.controller_address[0m
[30;1m17 | [0m[35m        ret = requests.post(controller_addr + "/refresh_all_workers")[0m
[30;1m18 | [0m[35m        ret = requests.post(controller_addr + "/list_models")[0m
[30;1m19 | [0m[35m        models = ret.json()["models"][0m
[30;1m20 | [0m[35m        models.sort()[0m
[30;1m21 | [0m[35m        print(f"Models: {models}")[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_throughput.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m        worker_addr = args.worker_address[0m
[30;1m15 | [0m[35m    else:[0m
[30;1m16 | [0m[35m        controller_addr = args.controller_address[0m
[30;1m17 | [0m[35m        ret = requests.post(controller_addr + "/refresh_all_workers")[0m
[30;1m18 | [0m[35m        ret = requests.post(controller_addr + "/list_models")[0m
[30;1m19 | [0m[35m        models = ret.json()["models"][0m
[30;1m20 | [0m[35m        models.sort()[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_throughput.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m87 | [0m[35m    # n_words = 0[0m
[30;1m88 | [0m[35m    # for i, response in enumerate(results):[0m
[30;1m89 | [0m[35m    #     # print(prompt[i].replace(conv.sep, "\n"), end="")[0m
[30;1m90 | [0m[35m    #     # make sure the streaming finishes at EOS or stopping criteria[0m
[30;1m91 | [0m[35m    #     k = list(response.iter_lines(chunk_size=8192, decode_unicode=False, delimiter=b"\0"))[0m
[30;1m92 | [0m[35m    #     response_new_words = json.loads(k[-2].decode("utf-8"))["text"][0m
[30;1m93 | [0m[35m    #     # print(response_new_words)[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_throughput.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport requests[0m
[30;1m6 | [0m[35mimport threading[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom fastchat.conversation import get_conv_template[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/test_throughput.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""Benchmarking script to test the throughput of serving workers."""[0m
[30;1m2 | [0m[35mimport argparse[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m437 | [0m[35m    logger = build_logger("monitor", "monitor.log")[0m
[30;1m438 | [0m[35m    logger.info(f"args: {args}")[0m
[30;1m439 | [0m[35m[0m
[30;1m440 | [0m[35m    if args.elo_results_file is None:  # Do live update[0m
[30;1m441 | [0m[35m        update_thread = threading.Thread([0m
[30;1m442 | [0m[35m            target=update_worker,[0m
[30;1m443 | [0m[35m            args=([0m
[30;1m444 | [0m[35m                args.max_num_files,[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35mdef build_leaderboard_tab(elo_results_file, leaderboard_table_file, show_plot=False):[0m
[30;1m269 | [0m[35m    if elo_results_file is None:  # Do live update[0m
[30;1m270 | [0m[35m        default_md = "Loading ..."[0m
[30;1m271 | [0m[35m        p1 = p2 = p3 = p4 = None[0m
[30;1m272 | [0m[35m    else:[0m
[30;1m273 | [0m[35m        with open(elo_results_file, "rb") as fin:[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m89 | [0m[35m    log_files = get_log_files(max_num_files)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    # Leaderboard[0m
[30;1m92 | [0m[35m    if elo_results_file is None:  # Do live update[0m
[30;1m93 | [0m[35m        ban_ip_list = json.load(open(ban_ip_file)) if ban_ip_file else None[0m
[30;1m94 | [0m[35m        battles = clean_battle_data([0m
[30;1m95 | [0m[35m            log_files, exclude_model_names, ban_ip_list=ban_ip_list[0m
[30;1m96 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m53 | [0m[35m    leaderboard_md = f"""[0m
[30;1m54 | [0m[35mTotal #models: **{total_models}**. Total #votes: **{total_votes}**. Last updated: Feb 2, 2024.[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mContribute your vote üó≥Ô∏è at [chat.lmsys.org](https://chat.lmsys.org)! Find more analysis in the [not[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m‚ö†Ô∏è **Some mobile users reported the leaderboard is not displayed normally, please visit [our HF alte[0m
[30;1m59 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m        gr.Markdown([0m
[30;1m353 | [0m[35m            f"""## More Statistics for Chatbot Arena\n[0m
[30;1m354 | [0m[35mBelow are figures for more statistics. The code for generating them is also included in this [notebo[0m
[30;1m355 | [0m[35mYou can find more discussions in this blog [post](https://lmsys.org/blog/2023-12-07-leaderboard/).[0m
[30;1m356 | [0m[35m    """,[0m
[30;1m357 | [0m[35m            elem_id="leaderboard_markdown",[0m
[30;1m358 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35mdef get_arena_table(arena_df, model_table_df):[0m
[30;1m234 | [0m[35m    # sort by rating[0m
[30;1m235 | [0m[35m    arena_df = arena_df.sort_values(by=["rating"], ascending=False)[0m
[30;1m236 | [0m[35m    values = [][0m
[30;1m237 | [0m[35m    for i in range(len(arena_df)):[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m    leaderboard_md = f"""[0m
[30;1m54 | [0m[35mTotal #models: **{total_models}**. Total #votes: **{total_votes}**. Last updated: Feb 2, 2024.[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mContribute your vote üó≥Ô∏è at [chat.lmsys.org](https://chat.lmsys.org)! Find more analysis in the [not[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m‚ö†Ô∏è **Some mobile users reported the leaderboard is not displayed normally, please visit [our HF alte[0m
[30;1m59 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35mimport pickle[0m
[30;1m13 | [0m[35mimport os[0m
[30;1m14 | [0m[35mimport threading[0m
[30;1m15 | [0m[35mimport time[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mimport pandas as pd[0m
[30;1m18 | [0m[35mimport gradio as gr[0m
[30;1m19 | [0m[35mimport numpy as np[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mLive monitor of the website statistics and leaderboard.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mDependency:[0m
[30;1m5 | [0m[35msudo apt install pkg-config libicu-dev[0m
[30;1m6 | [0m[35mpip install pytz gradio gdown plotly polyglot pyicu pycld2 tabulate[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport argparse[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mLive monitor of the website statistics and leaderboard.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mDependency:[0m
[30;1m5 | [0m[35msudo apt install pkg-config libicu-dev[0m
[30;1m6 | [0m[35mpip install pytz gradio gdown plotly polyglot pyicu pycld2 tabulate[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/data/hardcoded_questions.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m46 | [0m[35m        f"You can call me {name}, and I was trained by {org} researchers as a language model.",[0m
[30;1m47 | [0m[35m        f"As a language model, I go by the name {name} and was trained by researchers from {org}.",[0m
[30;1m48 | [0m[35m        f"I'm a language model called {name}, and I was trained by {org} researchers.",[0m
[30;1m49 | [0m[35m        f"You may refer to me as {name}, a language model meticulously developed by the researchers [0m
[30;1m50 | [0m[35m    ][0m
[30;1m51 | [0m[35m    generate_conversations(questions, answers)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_registry.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m    else:[0m
[30;1m25 | [0m[35m        # To fix this, please use `register_model_info` to register your model[0m
[30;1m26 | [0m[35m        return ModelInfo([0m
[30;1m27 | [0m[35m            name, "", "Register the description at fastchat/model/model_registry.py"[0m
[30;1m28 | [0m[35m        )[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_registry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m    ["tenyxchat-7b-v1"],[0m
[30;1m260 | [0m[35m    "TenyxChat-7B",[0m
[30;1m261 | [0m[35m    "https://huggingface.co/tenyx/TenyxChat-7B-v1",[0m
[30;1m262 | [0m[35m    "An open model DPO trained on top of OpenChat-3.5 using Tenyx fine-tuning",[0m
[30;1m263 | [0m[35m)[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35mregister_model_info([0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/apply_lora.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mApply the LoRA weights on top of a base model.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mUsage:[0m
[30;1m5 | [0m[35mpython3 -m fastchat.model.apply_lora --base ~/model_weights/llama-7b --target ~/model_weights/baize-[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m    return worker.get_conv_template()[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m@app.post("/model_details")[0m
[30;1m232 | [0m[35masync def api_model_details(request: Request):[0m
[30;1m233 | [0m[35m    return {"context_length": worker.context_len}[0m
[30;1m234 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m    return worker.count_token(params)[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m@app.post("/worker_get_conv_template")[0m
[30;1m227 | [0m[35masync def api_get_conv(request: Request):[0m
[30;1m228 | [0m[35m    return worker.get_conv_template()[0m
[30;1m229 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m    return worker.get_status()[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m@app.post("/count_token")[0m
[30;1m221 | [0m[35masync def api_count_token(request: Request):[0m
[30;1m222 | [0m[35m    params = await request.json()[0m
[30;1m223 | [0m[35m    return worker.count_token(params)[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m    return JSONResponse(output)[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m@app.post("/worker_get_status")[0m
[30;1m216 | [0m[35masync def api_get_status(request: Request):[0m
[30;1m217 | [0m[35m    return worker.get_status()[0m
[30;1m218 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m    return StreamingResponse(generator)[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m@app.post("/worker_generate")[0m
[30;1m207 | [0m[35masync def api_generate(request: Request):[0m
[30;1m208 | [0m[35m    params = await request.json()[0m
[30;1m209 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m    return background_tasks[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m@app.post("/worker_generate_stream")[0m
[30;1m198 | [0m[35masync def api_generate_stream(request: Request):[0m
[30;1m199 | [0m[35m    params = await request.json()[0m
[30;1m200 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m92 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m93 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m94 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        # Handle stop_str[0m
[30;1m97 | [0m[35m        stop = [][0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m91 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m92 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m93 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m94 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        # Handle stop_str[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m90 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m91 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m92 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m93 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m94 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m89 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m90 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m91 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m92 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m93 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m94 | [0m[35m        echo = params.get("echo", True)[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m88 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m89 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m90 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m91 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m92 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m93 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m87 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m88 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m89 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m90 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m91 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m92 | [0m[35m        stop_str = params.get("stop", None)[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        images = params.get("images", [])[0m
[30;1m86 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m87 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m88 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m89 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m90 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m91 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        prompt = params.pop("prompt")[0m
[30;1m85 | [0m[35m        images = params.get("images", [])[0m
[30;1m86 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m87 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m88 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m89 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m90 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        prompt = params.pop("prompt")[0m
[30;1m85 | [0m[35m        images = params.get("images", [])[0m
[30;1m86 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m87 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m88 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m89 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/sglang_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        self.call_ct += 1[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        prompt = params.pop("prompt")[0m
[30;1m85 | [0m[35m        images = params.get("images", [])[0m
[30;1m86 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m87 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m88 | [0m[35m        top_k = params.get("top_k", -1.0)[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m    if image_file.startswith("http://") or image_file.startswith("https://"):[0m
[30;1m369 | [0m[35m        timeout = int(os.getenv("REQUEST_TIMEOUT", "3"))[0m
[30;1m370 | [0m[35m        response = requests.get(image_file, timeout=timeout)[0m
[30;1m371 | [0m[35m        image = Image.open(BytesIO(response.content))[0m
[30;1m372 | [0m[35m    elif image_file.lower().endswith(("png", "jpg", "jpeg", "webp", "gif")):[0m
[30;1m373 | [0m[35m        image = Image.open(image_file)[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35mdef run_cmd(cmd: str):[0m
[30;1m308 | [0m[35m    """Run a bash command."""[0m
[30;1m309 | [0m[35m    print(cmd)[0m
[30;1m310 | [0m[35m    return os.system(cmd)[0m
[30;1m311 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m366 | [0m[35m    image = None[0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m    if image_file.startswith("http://") or image_file.startswith("https://"):[0m
[30;1m369 | [0m[35m        timeout = int(os.getenv("REQUEST_TIMEOUT", "3"))[0m
[30;1m370 | [0m[35m        response = requests.get(image_file, timeout=timeout)[0m
[30;1m371 | [0m[35m        image = Image.open(BytesIO(response.content))[0m
[30;1m372 | [0m[35m    elif image_file.lower().endswith(("png", "jpg", "jpeg", "webp", "gif")):[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35mdef run_cmd(cmd: str):[0m
[30;1m308 | [0m[35m    """Run a bash command."""[0m
[30;1m309 | [0m[35m    print(cmd)[0m
[30;1m310 | [0m[35m    return os.system(cmd)[0m
[30;1m311 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m    url_params = Object.fromEntries(params);[0m
[30;1m234 | [0m[35m    console.log("url_params", url_params);[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m    msg = "Users of this website are required to agree to the following terms:\\n\\nThe service is a[0m
[30;1m237 | [0m[35m    alert(msg);[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    return url_params;[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m    url_params = Object.fromEntries(params);[0m
[30;1m234 | [0m[35m    console.log("url_params", url_params);[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m    msg = "Users of this website are required to agree to the following terms:\\n\\nThe service is a[0m
[30;1m237 | [0m[35m    alert(msg);[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    return url_params;[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35mfrom asyncio import AbstractEventLoop[0m
[30;1m5 | [0m[35mfrom io import BytesIO[0m
[30;1m6 | [0m[35mimport base64[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35mimport logging[0m
[30;1m9 | [0m[35mimport logging.handlers[0m
[30;1m10 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_yuan2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m#    Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m6 | [0m[35m#    you may not use this file except in compliance with the License.[0m
[30;1m7 | [0m[35m#    You may obtain a copy of the License at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m#        http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m#    Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/api_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m440 | [0m[35m    }[0m
[30;1m441 | [0m[35m    logger.info(f"==== request ====\n{payload}")[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m    response = requests.post([0m
[30;1m444 | [0m[35m        api_base, headers=headers, json=payload, stream=True, timeout=1[0m
[30;1m445 | [0m[35m    )[0m
[30;1m446 | [0m[35m    text = ""[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/api_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m331 | [0m[35m    if temperature == 0.0 and top_p < 1.0:[0m
[30;1m332 | [0m[35m        raise ValueError("top_p must be 1 when temperature is 0.0")[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m    res = requests.post([0m
[30;1m335 | [0m[35m        api_base,[0m
[30;1m336 | [0m[35m        stream=True,[0m
[30;1m337 | [0m[35m        headers={"Authorization": f"Bearer {ai2_key}"},[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/api_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m    api_base=None,[0m
[30;1m314 | [0m[35m):[0m
[30;1m315 | [0m[35m    # get keys and needed values[0m
[30;1m316 | [0m[35m    ai2_key = api_key or os.environ.get("AI2_API_KEY")[0m
[30;1m317 | [0m[35m    api_base = api_base or "https://inferd.allen.ai/api/v1/infer"[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m    # Make requests[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/api_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m    logger.info(f"==== request ====\n{params}")[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m    try:[0m
[30;1m260 | [0m[35m        res = requests.post([0m
[30;1m261 | [0m[35m            f"https://generativelanguage.googleapis.com/v1beta2/models/{model_name}:generateMessage?[0m
[30;1m262 | [0m[35m            json={[0m
[30;1m263 | [0m[35m                "prompt": {[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/api_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35mdef gemini_api_stream_iter([0m
[30;1m181 | [0m[35m    model_name, conv, temperature, top_p, max_new_tokens, api_key=None[0m
[30;1m182 | [0m[35m):[0m
[30;1m183 | [0m[35m    import google.generativeai as genai  # pip install google-generativeai[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    if api_key is None:[0m
[30;1m186 | [0m[35m        api_key = os.environ["GEMINI_API_KEY"][0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/api_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport os[0m
[30;1m5 | [0m[35mimport random[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport requests[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom fastchat.utils import build_logger[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server_multi.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m224 | [0m[35m    parser.add_argument([0m
[30;1m225 | [0m[35m        "--gradio-root-path",[0m
[30;1m226 | [0m[35m        type=str,[0m
[30;1m227 | [0m[35m        help="Sets the gradio root path, eg /abc/def. Useful when running behind a reverse-proxy or [0m
[30;1m228 | [0m[35m    )[0m
[30;1m229 | [0m[35m    parser.add_argument([0m
[30;1m230 | [0m[35m        "--ga-id",[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server_multi.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35mdef load_demo(url_params, request: gr.Request):[0m
[30;1m46 | [0m[35m    global models, all_models, vl_models[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m    ip = get_ip(request)[0m
[30;1m49 | [0m[35m    logger.info(f"load_demo. ip: {ip}. params: {url_params}")[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    selected = 0[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_web_server_multi.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport argparse[0m
[30;1m7 | [0m[35mimport pickle[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport gradio as gr[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom fastchat.serve.gradio_block_arena_anony import ([0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m14 | [0m[35m MODERATION GUIDELINES."[0m
[30;1m15 | [0m[35mCONVERSATION_LIMIT_MSG = "YOU HAVE REACHED THE CONVERSATION LENGTH LIMIT. PLEASE CLEAR HISTORY AND S[0m
[30;1m16 | [0m[35mINACTIVE_MSG = "THIS SESSION HAS BEEN INACTIVE FOR TOO LONG. PLEASE REFRESH THIS PAGE."[0m
[30;1m17 | [0m[35mSLOW_MODEL_MSG = "‚ö†Ô∏è  Both models will show the responses all at once. Please stay patient as it may[0m
[30;1m18 | [0m[35mRATE_LIMIT_MSG = "**RATE LIMIT OF THIS MODEL IS REACHED. PLEASE COME BACK LATER OR TRY OTHER MODELS.[0m
[30;1m19 | [0m[35m# Maximum input length[0m
[30;1m20 | [0m[35mINPUT_CHAR_LEN_LIMIT = int(os.getenv("FASTCHAT_INPUT_CHAR_LEN_LIMIT", 12000))[0m
[30;1m21 | [0m[35m# Maximum conversation turns[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35mCPU_ISA = os.getenv("CPU_ISA")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m##### For the controller and workers (could be overwritten through ENV variables.)[0m
[30;1m32 | [0m[35mCONTROLLER_HEART_BEAT_EXPIRATION = int([0m
[30;1m33 | [0m[35m    os.getenv("FASTCHAT_CONTROLLER_HEART_BEAT_EXPIRATION", 90)[0m
[30;1m34 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mINPUT_CHAR_LEN_LIMIT = int(os.getenv("FASTCHAT_INPUT_CHAR_LEN_LIMIT", 12000))[0m
[30;1m21 | [0m[35m# Maximum conversation turns[0m
[30;1m22 | [0m[35mCONVERSATION_TURN_LIMIT = 50[0m
[30;1m23 | [0m[35m# Session expiration time[0m
[30;1m24 | [0m[35mSESSION_EXPIRATION_TIME = 3600[0m
[30;1m25 | [0m[35m# The output dir of log files[0m
[30;1m26 | [0m[35mLOGDIR = os.getenv("LOGDIR", ".")[0m
[30;1m27 | [0m[35m# CPU Instruction Set Architecture[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_with_template.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m            [self.raw_data[i]["conversations"]],[0m
[30;1m281 | [0m[35m            self.tokenizer,[0m
[30;1m282 | [0m[35m            self.template_id,[0m
[30;1m283 | [0m[35m            systems=[self.raw_data[i].get("system", "")],[0m
[30;1m284 | [0m[35m        )[0m
[30;1m285 | [0m[35m        ret = dict([0m
[30;1m286 | [0m[35m            input_ids=ret["input_ids"][0],[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_with_template.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m        super(SupervisedDataset, self).__init__()[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m        rank0_print("Formatting inputs...")[0m
[30;1m238 | [0m[35m        systems = [example.get("system", "") for example in raw_data][0m
[30;1m239 | [0m[35m        sources = [example["conversations"] for example in raw_data][0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m        data_dict = preprocess(sources, tokenizer, template_id, systems=systems)[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_with_template.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m            ).get()[0m
[30;1m219 | [0m[35m            targets = p.apply_async([0m
[30;1m220 | [0m[35m                mask_targets, (conversations, targets, tokenizer, conv)[0m
[30;1m221 | [0m[35m            ).get()[0m
[30;1m222 | [0m[35m            p.close()[0m
[30;1m223 | [0m[35m            p.join()[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_with_template.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m            ).get()[0m
[30;1m216 | [0m[35m            input_ids, targets = p.apply_async([0m
[30;1m217 | [0m[35m                tokenize_conversations, (conversations, tokenizer)[0m
[30;1m218 | [0m[35m            ).get()[0m
[30;1m219 | [0m[35m            targets = p.apply_async([0m
[30;1m220 | [0m[35m                mask_targets, (conversations, targets, tokenizer, conv)[0m
[30;1m221 | [0m[35m            ).get()[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_with_template.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        with Pool() as p:[0m
[30;1m210 | [0m[35m            conversations, conv = p.apply_async([0m
[30;1m211 | [0m[35m                apply_prompt_template, (sources, template_id, systems)[0m
[30;1m212 | [0m[35m            ).get()[0m
[30;1m213 | [0m[35m            input_ids, targets = p.apply_async([0m
[30;1m214 | [0m[35m                tokenize_conversations, (conversations, tokenizer)[0m
[30;1m215 | [0m[35m            ).get()[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_with_template.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35mdef preprocess([0m
[30;1m199 | [0m[35m    sources, tokenizer: transformers.PreTrainedTokenizer, template_id, **kwargs[0m
[30;1m200 | [0m[35m) -> Dict:[0m
[30;1m201 | [0m[35m    systems = None if not kwargs else kwargs.get("systems", None)[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    # If the data volume is small, process it directly in the main thread[0m
[30;1m204 | [0m[35m    if len(sources) <= 1000:[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_with_template.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m#    Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m6 | [0m[35m#    you may not use this file except in compliance with the License.[0m
[30;1m7 | [0m[35m#    You may obtain a copy of the License at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m#        http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m#    Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/protocol/openai_api_protocol.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom typing import Literal, Optional, List, Dict, Any, Union[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport shortuuid[0m
[30;1m6 | [0m[35mfrom pydantic import BaseModel, Field[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_named.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m307 | [0m[35m                    )[0m
[30;1m308 | [0m[35m        with gr.Row():[0m
[30;1m309 | [0m[35m            with gr.Accordion([0m
[30;1m310 | [0m[35m                f"üîç Expand to see the descriptions of {len(models)} models", open=False[0m
[30;1m311 | [0m[35m            ):[0m
[30;1m312 | [0m[35m                model_description_md = get_model_description_md(models)[0m
[30;1m313 | [0m[35m                gr.Markdown(model_description_md, elem_id="model_description_markdown")[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_named.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m                    )[0m
[30;1m308 | [0m[35m        with gr.Row():[0m
[30;1m309 | [0m[35m            with gr.Accordion([0m
[30;1m310 | [0m[35m                f"üîç Expand to see the descriptions of {len(models)} models", open=False[0m
[30;1m311 | [0m[35m            ):[0m
[30;1m312 | [0m[35m                model_description_md = get_model_description_md(models)[0m
[30;1m313 | [0m[35m                gr.Markdown(model_description_md, elem_id="model_description_markdown")[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_named.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35mdef add_text([0m
[30;1m147 | [0m[35m    state0, state1, model_selector0, model_selector1, text, request: gr.Request[0m
[30;1m148 | [0m[35m):[0m
[30;1m149 | [0m[35m    ip = get_ip(request)[0m
[30;1m150 | [0m[35m    logger.info(f"add_text (named). ip: {ip}. len: {len(text)}")[0m
[30;1m151 | [0m[35m    states = [state0, state1][0m
[30;1m152 | [0m[35m    model_selectors = [model_selector0, model_selector1][0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/gradio_block_arena_named.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport json[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport gradio as gr[0m
[30;1m10 | [0m[35mimport numpy as np[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_flant5.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m                    + sentence["value"][0m
[30;1m205 | [0m[35m                    + END_SIGNAL[0m
[30;1m206 | [0m[35m                    + BEGIN_SIGNAL[0m
[30;1m207 | [0m[35m                    + roles.get(next_sentence["from"].lower(), unknown_role)[0m
[30;1m208 | [0m[35m                    + ": "[0m
[30;1m209 | [0m[35m                )[0m
[30;1m210 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_flant5.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m                next_sentence = source[i + 1][0m
[30;1m200 | [0m[35m                sentence["value"] = ([0m
[30;1m201 | [0m[35m                    BEGIN_SIGNAL[0m
[30;1m202 | [0m[35m                    + roles.get(sentence_from, unknown_role)[0m
[30;1m203 | [0m[35m                    + ": "[0m
[30;1m204 | [0m[35m                    + sentence["value"][0m
[30;1m205 | [0m[35m                    + END_SIGNAL[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_flant5.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m224 | [0m[35m) -> Dict:[0m
[30;1m225 | [0m[35m    """[0m
[30;1m226 | [0m[35m    Given a list of sources, each is a conversation list. This transform:[0m
[30;1m227 | [0m[35m    1. Add signal '### ' at the beginning each sentence, with end signal '\n';[0m
[30;1m228 | [0m[35m    2. Concatenate conversations together;[0m
[30;1m229 | [0m[35m    3. Tokenize the concatenated conversation;[0m
[30;1m230 | [0m[35m    4. Make a deepcopy as the target. Mask human words with IGNORE_INDEX.[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_flant5.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m#    Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m5 | [0m[35m#    you may not use this file except in compliance with the License.[0m
[30;1m6 | [0m[35m#    You may obtain a copy of the License at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m#        http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m#    Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m    world_size = int(os.environ.get("WORLD_SIZE", 1))[0m
[30;1m120 | [0m[35m    ddp = world_size != 1[0m
[30;1m121 | [0m[35m    if lora_args.q_lora:[0m
[30;1m122 | [0m[35m        device_map = {"": int(os.environ.get("LOCAL_RANK") or 0)} if ddp else None[0m
[30;1m123 | [0m[35m        if len(training_args.fsdp) > 0 or deepspeed.is_deepspeed_zero3_enabled():[0m
[30;1m124 | [0m[35m            logging.warning([0m
[30;1m125 | [0m[35m                "FSDP and ZeRO3 are both currently incompatible with QLoRA."[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        replace_llama_attn_with_flash_attn()[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    device_map = None[0m
[30;1m119 | [0m[35m    world_size = int(os.environ.get("WORLD_SIZE", 1))[0m
[30;1m120 | [0m[35m    ddp = world_size != 1[0m
[30;1m121 | [0m[35m    if lora_args.q_lora:[0m
[30;1m122 | [0m[35m        device_map = {"": int(os.environ.get("LOCAL_RANK") or 0)} if ddp else None[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/train/train_lora.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m#    Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m7 | [0m[35m#    you may not use this file except in compliance with the License.[0m
[30;1m8 | [0m[35m#    You may obtain a copy of the License at[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m#        http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m11 | [0m[35m#[0m
[30;1m12 | [0m[35m#    Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_openai_langchain.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m# python3 -m fastchat.serve.model_worker --model-path lmsys/vicuna-7b-v1.5 --model-names gpt-3.5-tur[0m
[30;1m3 | [0m[35m# export OPENAI_API_BASE=http://localhost:8000/v1[0m
[30;1m4 | [0m[35m# export OPENAI_API_KEY=EMPTY[0m
[30;1m5 | [0m[35m# wget https://raw.githubusercontent.com/hwchase17/langchain/v0.0.200/docs/modules/state_of_the_unio[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_chatglm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m78 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m79 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m80 | [0m[35m    echo = params.get("echo", True)[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    model_type = str(type(model)).lower()[0m
[30;1m83 | [0m[35m    if "peft" in model_type:[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_chatglm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m77 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m78 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m79 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m80 | [0m[35m    echo = params.get("echo", True)[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    model_type = str(type(model)).lower()[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_chatglm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m    prompt = params["prompt"][0m
[30;1m76 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m77 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m78 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m79 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m80 | [0m[35m    echo = params.get("echo", True)[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_chatglm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m):[0m
[30;1m75 | [0m[35m    prompt = params["prompt"][0m
[30;1m76 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m77 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m78 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m79 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m80 | [0m[35m    echo = params.get("echo", True)[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_chatglm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    judge_sent_end=False,[0m
[30;1m74 | [0m[35m):[0m
[30;1m75 | [0m[35m    prompt = params["prompt"][0m
[30;1m76 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m77 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m78 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m79 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m    logprobs = params.get("logprobs", None)  # FIXME: Support logprobs>1.[0m
[30;1m83 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m84 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m85 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m86 | [0m[35m    if tokenizer.eos_token_id not in stop_token_ids:[0m
[30;1m87 | [0m[35m        stop_token_ids.append(tokenizer.eos_token_id)[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m82 | [0m[35m    logprobs = params.get("logprobs", None)  # FIXME: Support logprobs>1.[0m
[30;1m83 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m84 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m85 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m86 | [0m[35m    if tokenizer.eos_token_id not in stop_token_ids:[0m
[30;1m87 | [0m[35m        stop_token_ids.append(tokenizer.eos_token_id)[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m    top_k = int(params.get("top_k", -1))  # -1 means disable[0m
[30;1m81 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m82 | [0m[35m    logprobs = params.get("logprobs", None)  # FIXME: Support logprobs>1.[0m
[30;1m83 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m84 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m85 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m86 | [0m[35m    if tokenizer.eos_token_id not in stop_token_ids:[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m80 | [0m[35m    top_k = int(params.get("top_k", -1))  # -1 means disable[0m
[30;1m81 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m82 | [0m[35m    logprobs = params.get("logprobs", None)  # FIXME: Support logprobs>1.[0m
[30;1m83 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m84 | [0m[35m    stop_str = params.get("stop", None)[0m
[30;1m85 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m79 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m80 | [0m[35m    top_k = int(params.get("top_k", -1))  # -1 means disable[0m
[30;1m81 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m82 | [0m[35m    logprobs = params.get("logprobs", None)  # FIXME: Support logprobs>1.[0m
[30;1m83 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m84 | [0m[35m    stop_str = params.get("stop", None)[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m78 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m79 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m80 | [0m[35m    top_k = int(params.get("top_k", -1))  # -1 means disable[0m
[30;1m81 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m82 | [0m[35m    logprobs = params.get("logprobs", None)  # FIXME: Support logprobs>1.[0m
[30;1m83 | [0m[35m    echo = bool(params.get("echo", True))[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m77 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m78 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m79 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m80 | [0m[35m    top_k = int(params.get("top_k", -1))  # -1 means disable[0m
[30;1m81 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m
[30;1m82 | [0m[35m    logprobs = params.get("logprobs", None)  # FIXME: Support logprobs>1.[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m    prompt = params["prompt"][0m
[30;1m76 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m77 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m78 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m79 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m80 | [0m[35m    top_k = int(params.get("top_k", -1))  # -1 means disable[0m
[30;1m81 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 256))[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m    # Read parameters[0m
[30;1m75 | [0m[35m    prompt = params["prompt"][0m
[30;1m76 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m77 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m78 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m79 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m80 | [0m[35m    top_k = int(params.get("top_k", -1))  # -1 means disable[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport math[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport sys[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom typing import Iterable, Optional, Dict[0m
[30;1m10 | [0m[35mimport warnings[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport psutil[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/monitor/dataset_release_scripts/lmsys_chat_1m/filter_bad_conv.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mFilter conversations for release.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mDependency:[0m
[30;1m5 | [0m[35mpip install opencc-python-reimplementedpip install opencc-python-reimplemented[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUsage:[0m
[30;1m8 | [0m[35mpython3 filter_bad_conv_lmsys_chat_1m.py --in clean_battle_conv_20230630_tagged_v1_pii.json[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m    return worker.get_conv_template()[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m@app.post("/model_details")[0m
[30;1m240 | [0m[35masync def api_model_details(request: Request):[0m
[30;1m241 | [0m[35m    return {"context_length": worker.context_len}[0m
[30;1m242 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m    return worker.count_token(params)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m@app.post("/worker_get_conv_template")[0m
[30;1m235 | [0m[35masync def api_get_conv(request: Request):[0m
[30;1m236 | [0m[35m    return worker.get_conv_template()[0m
[30;1m237 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m    return worker.get_status()[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m@app.post("/count_token")[0m
[30;1m229 | [0m[35masync def api_count_token(request: Request):[0m
[30;1m230 | [0m[35m    params = await request.json()[0m
[30;1m231 | [0m[35m    return worker.count_token(params)[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m    return JSONResponse(output)[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m@app.post("/worker_get_status")[0m
[30;1m224 | [0m[35masync def api_get_status(request: Request):[0m
[30;1m225 | [0m[35m    return worker.get_status()[0m
[30;1m226 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m    return StreamingResponse(generator, background=background_tasks)[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m@app.post("/worker_generate")[0m
[30;1m211 | [0m[35masync def api_generate(request: Request):[0m
[30;1m212 | [0m[35m    params = await request.json()[0m
[30;1m213 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m    return background_tasks[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m@app.post("/worker_generate_stream")[0m
[30;1m199 | [0m[35masync def api_generate_stream(request: Request):[0m
[30;1m200 | [0m[35m    params = await request.json()[0m
[30;1m201 | [0m[35m    await acquire_worker_semaphore()[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        use_beam_search = params.get("use_beam_search", False)[0m
[30;1m84 | [0m[35m        best_of = params.get("best_of", None)[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        request = params.get("request", None)[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        # Handle stop_str[0m
[30;1m89 | [0m[35m        stop = set()[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m82 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m83 | [0m[35m        use_beam_search = params.get("use_beam_search", False)[0m
[30;1m84 | [0m[35m        best_of = params.get("best_of", None)[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        request = params.get("request", None)[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m81 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m82 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m83 | [0m[35m        use_beam_search = params.get("use_beam_search", False)[0m
[30;1m84 | [0m[35m        best_of = params.get("best_of", None)[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        request = params.get("request", None)[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m80 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m81 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m82 | [0m[35m        echo = params.get("echo", True)[0m
[30;1m83 | [0m[35m        use_beam_search = params.get("use_beam_search", False)[0m
[30;1m84 | [0m[35m        best_of = params.get("best_of", None)[0m
[30;1m85 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m77 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m78 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m79 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m80 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m81 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m
[30;1m82 | [0m[35m        echo = params.get("echo", True)[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m76 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m77 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m78 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m79 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m80 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m
[30;1m81 | [0m[35m            stop_token_ids.append(self.tokenizer.eos_token_id)[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m75 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m76 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m77 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m78 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m79 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m80 | [0m[35m        if self.tokenizer.eos_token_id is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m74 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m75 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m76 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m77 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m78 | [0m[35m        stop_str = params.get("stop", None)[0m
[30;1m79 | [0m[35m        stop_token_ids = params.get("stop_token_ids", None) or [][0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m73 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m74 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m75 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m76 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m77 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m
[30;1m78 | [0m[35m        stop_str = params.get("stop", None)[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m72 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m73 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m74 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m75 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m76 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m
[30;1m77 | [0m[35m        max_new_tokens = params.get("max_new_tokens", 256)[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m        context = params.pop("prompt")[0m
[30;1m71 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m72 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m73 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m74 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m75 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m
[30;1m76 | [0m[35m        frequency_penalty = float(params.get("frequency_penalty", 0.0))[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        context = params.pop("prompt")[0m
[30;1m71 | [0m[35m        request_id = params.pop("request_id")[0m
[30;1m72 | [0m[35m        temperature = float(params.get("temperature", 1.0))[0m
[30;1m73 | [0m[35m        top_p = float(params.get("top_p", 1.0))[0m
[30;1m74 | [0m[35m        top_k = params.get("top_k", -1.0)[0m
[30;1m75 | [0m[35m        presence_penalty = float(params.get("presence_penalty", 0.0))[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/vllm_worker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mA model worker that executes the model based on vLLM.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mSee documentations at docs/vllm_integration.md[0m
[30;1m5 | [0m[35m"""[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport argparse[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/launch_all_serve.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m191 | [0m[35m    os.environ["CUDA_VISIBLE_DEVICES"] = args.gpus[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m# 0,controller, model_worker, openai_api_server[0m
[30;1m194 | [0m[35m# 1, cmd options[0m
[30;1m195 | [0m[35m# 2,LOGDIR[0m
[30;1m196 | [0m[35m# 3, log file name[0m
[30;1m197 | [0m[35mbase_launch_sh = "nohup python3 -m fastchat.serve.{0} {1} >{2}/{3}.log 2>&1 &"[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/launch_all_serve.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35mThe key mechanism behind this scripts is: [0m
[30;1m7 | [0m[35m    1, execute shell cmd to launch the controller/worker/openai-api-server;[0m
[30;1m8 | [0m[35m    2, check the log of controller/worker/openai-api-server to ensure that the serve is launched pro[0m
[30;1m9 | [0m[35mNote that a few of non-critical `fastchat.serve` cmd options are not supported currently.[0m
[30;1m10 | [0m[35m"""[0m
[30;1m11 | [0m[35mimport sys[0m
[30;1m12 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/launch_all_serve.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35mWorkers are listed in format of `model-path`@`host`@`port` [0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mThe key mechanism behind this scripts is: [0m
[30;1m7 | [0m[35m    1, execute shell cmd to launch the controller/worker/openai-api-server;[0m
[30;1m8 | [0m[35m    2, check the log of controller/worker/openai-api-server to ensure that the serve is launched pro[0m
[30;1m9 | [0m[35mNote that a few of non-critical `fastchat.serve` cmd options are not supported currently.[0m
[30;1m10 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m863 | [0m[35m            ChatCompletionResponseChoice([0m
[30;1m864 | [0m[35m                index=i,[0m
[30;1m865 | [0m[35m                message=ChatMessage(role="assistant", content=content["text"]),[0m
[30;1m866 | [0m[35m                finish_reason=content.get("finish_reason", "stop"),[0m
[30;1m867 | [0m[35m            )[0m
[30;1m868 | [0m[35m        )[0m
[30;1m869 | [0m[35m        task_usage = UsageInfo.parse_obj(content["usage"])[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m799 | [0m[35m    return APITokenCheckResponse(prompts=checkedList)[0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m[0m
[30;1m802 | [0m[35m@app.post("/api/v1/chat/completions")[0m
[30;1m803 | [0m[35masync def create_chat_completion(request: APIChatCompletionRequest):[0m
[30;1m804 | [0m[35m    """Creates a completion for the chat message"""[0m
[30;1m805 | [0m[35m    error_check_ret = await check_model(request)[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m764 | [0m[35m### GENERAL API - NOT OPENAI COMPATIBLE ###[0m
[30;1m765 | [0m[35m[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m@app.post("/api/v1/token_check")[0m
[30;1m768 | [0m[35masync def count_tokens(request: APITokenCheckRequest):[0m
[30;1m769 | [0m[35m    """[0m
[30;1m770 | [0m[35m    Checks the token count for each message in your list[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m[0m
[30;1m707 | [0m[35m@app.post("/v1/embeddings", dependencies=[Depends(check_api_key)])[0m
[30;1m708 | [0m[35m@app.post("/v1/engines/{model_name}/embeddings", dependencies=[Depends(check_api_key)])[0m
[30;1m709 | [0m[35masync def create_embeddings(request: EmbeddingsRequest, model_name: str = None):[0m
[30;1m710 | [0m[35m    """Creates embeddings for the text"""[0m
[30;1m711 | [0m[35m    if request.model is None:[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m704 | [0m[35m    return await fetch_remote(worker_addr + "/worker_generate", payload, "")[0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m[0m
[30;1m707 | [0m[35m@app.post("/v1/embeddings", dependencies=[Depends(check_api_key)])[0m
[30;1m708 | [0m[35m@app.post("/v1/engines/{model_name}/embeddings", dependencies=[Depends(check_api_key)])[0m
[30;1m709 | [0m[35masync def create_embeddings(request: EmbeddingsRequest, model_name: str = None):[0m
[30;1m710 | [0m[35m    """Creates embeddings for the text"""[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m668 | [0m[35m                    model=model_name,[0m
[30;1m669 | [0m[35m                )[0m
[30;1m670 | [0m[35m                if len(delta_text) == 0:[0m
[30;1m671 | [0m[35m                    if content.get("finish_reason", None) is not None:[0m
[30;1m672 | [0m[35m                        finish_stream_events.append(chunk)[0m
[30;1m673 | [0m[35m                    continue[0m
[30;1m674 | [0m[35m                yield f"data: {chunk.json(exclude_unset=True, ensure_ascii=False)}\n\n"[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m659 | [0m[35m                    index=i,[0m
[30;1m660 | [0m[35m                    text=delta_text,[0m
[30;1m661 | [0m[35m                    logprobs=create_openai_logprobs(content.get("logprobs", None)),[0m
[30;1m662 | [0m[35m                    finish_reason=content.get("finish_reason", None),[0m
[30;1m663 | [0m[35m                )[0m
[30;1m664 | [0m[35m                chunk = CompletionStreamResponse([0m
[30;1m665 | [0m[35m                    id=id,[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m658 | [0m[35m                choice_data = CompletionResponseStreamChoice([0m
[30;1m659 | [0m[35m                    index=i,[0m
[30;1m660 | [0m[35m                    text=delta_text,[0m
[30;1m661 | [0m[35m                    logprobs=create_openai_logprobs(content.get("logprobs", None)),[0m
[30;1m662 | [0m[35m                    finish_reason=content.get("finish_reason", None),[0m
[30;1m663 | [0m[35m                )[0m
[30;1m664 | [0m[35m                chunk = CompletionStreamResponse([0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m607 | [0m[35m                    index=i,[0m
[30;1m608 | [0m[35m                    text=content["text"],[0m
[30;1m609 | [0m[35m                    logprobs=create_openai_logprobs(content.get("logprobs", None)),[0m
[30;1m610 | [0m[35m                    finish_reason=content.get("finish_reason", "stop"),[0m
[30;1m611 | [0m[35m                )[0m
[30;1m612 | [0m[35m            )[0m
[30;1m613 | [0m[35m            task_usage = UsageInfo.parse_obj(content["usage"])[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m606 | [0m[35m                CompletionResponseChoice([0m
[30;1m607 | [0m[35m                    index=i,[0m
[30;1m608 | [0m[35m                    text=content["text"],[0m
[30;1m609 | [0m[35m                    logprobs=create_openai_logprobs(content.get("logprobs", None)),[0m
[30;1m610 | [0m[35m                    finish_reason=content.get("finish_reason", "stop"),[0m
[30;1m611 | [0m[35m                )[0m
[30;1m612 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m540 | [0m[35m    yield "data: [DONE]\n\n"[0m
[30;1m541 | [0m[35m[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m@app.post("/v1/completions", dependencies=[Depends(check_api_key)])[0m
[30;1m544 | [0m[35masync def create_completion(request: CompletionRequest):[0m
[30;1m545 | [0m[35m    error_check_ret = await check_model(request)[0m
[30;1m546 | [0m[35m    if error_check_ret is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m530 | [0m[35m                id=id, choices=[choice_data], model=model_name[0m
[30;1m531 | [0m[35m            )[0m
[30;1m532 | [0m[35m            if delta_text is None:[0m
[30;1m533 | [0m[35m                if content.get("finish_reason", None) is not None:[0m
[30;1m534 | [0m[35m                    finish_stream_events.append(chunk)[0m
[30;1m535 | [0m[35m                continue[0m
[30;1m536 | [0m[35m            yield f"data: {chunk.json(exclude_unset=True, ensure_ascii=False)}\n\n"[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m524 | [0m[35m            choice_data = ChatCompletionResponseStreamChoice([0m
[30;1m525 | [0m[35m                index=i,[0m
[30;1m526 | [0m[35m                delta=DeltaMessage(content=delta_text),[0m
[30;1m527 | [0m[35m                finish_reason=content.get("finish_reason", None),[0m
[30;1m528 | [0m[35m            )[0m
[30;1m529 | [0m[35m            chunk = ChatCompletionStreamResponse([0m
[30;1m530 | [0m[35m                id=id, choices=[choice_data], model=model_name[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m            ChatCompletionResponseChoice([0m
[30;1m474 | [0m[35m                index=i,[0m
[30;1m475 | [0m[35m                message=ChatMessage(role="assistant", content=content["text"]),[0m
[30;1m476 | [0m[35m                finish_reason=content.get("finish_reason", "stop"),[0m
[30;1m477 | [0m[35m            )[0m
[30;1m478 | [0m[35m        )[0m
[30;1m479 | [0m[35m        if "usage" in content:[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m409 | [0m[35m    return ModelList(data=model_cards)[0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35m[0m
[30;1m412 | [0m[35m@app.post("/v1/chat/completions", dependencies=[Depends(check_api_key)])[0m
[30;1m413 | [0m[35masync def create_chat_completion(request: ChatCompletionRequest):[0m
[30;1m414 | [0m[35m    """Creates a completion for the chat message"""[0m
[30;1m415 | [0m[35m    error_check_ret = await check_model(request)[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m395 | [0m[35m    return conv_template[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m[0m
[30;1m398 | [0m[35m@app.get("/v1/models", dependencies=[Depends(check_api_key)])[0m
[30;1m399 | [0m[35masync def show_available_models():[0m
[30;1m400 | [0m[35m    controller_address = app_settings.controller_address[0m
[30;1m401 | [0m[35m    ret = await fetch_remote(controller_address + "/refresh_all_workers")[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m[0m
[30;1m388 | [0m[35masync def get_conv(model_name: str, worker_addr: str):[0m
[30;1m389 | [0m[35m    conv_template = conv_template_map.get((worker_addr, model_name))[0m
[30;1m390 | [0m[35m    if conv_template is None:[0m
[30;1m391 | [0m[35m        conv_template = await fetch_remote([0m
[30;1m392 | [0m[35m            worker_addr + "/worker_get_conv_template", {"model": model_name}, "conv"[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/openai_api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35masync def fetch_remote(url, pload=None, name=None):[0m
[30;1m77 | [0m[35m    async with aiohttp.ClientSession(timeout=fetch_timeout) as session:[0m
[30;1m78 | [0m[35m        async with session.post(url, json=pload) as response:[0m
[30;1m79 | [0m[35m            chunks = [][0m
[30;1m80 | [0m[35m            if response.status != 200:[0m
[30;1m81 | [0m[35m                ret = {[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_codet5p.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 1024))[0m
[30;1m29 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m30 | [0m[35m    stop_token_ids.append(tokenizer.eos_token_id)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    decode_config = dict(skip_special_tokens=True, clean_up_tokenization_spaces=True)[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_codet5p.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 1024))[0m
[30;1m29 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m30 | [0m[35m    stop_token_ids.append(tokenizer.eos_token_id)[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_codet5p.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 1024))[0m
[30;1m29 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m30 | [0m[35m    stop_token_ids.append(tokenizer.eos_token_id)[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_codet5p.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m    prompt = params["prompt"][0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 1024))[0m
[30;1m29 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_codet5p.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m):[0m
[30;1m23 | [0m[35m    prompt = params["prompt"][0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 1024))[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_codet5p.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    judge_sent_end=False,[0m
[30;1m22 | [0m[35m):[0m
[30;1m23 | [0m[35m    prompt = params["prompt"][0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1.0))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 1.0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 50))  # -1 means disable[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_codet5p.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m52 | [0m[35m            self, input_ids: torch.LongTensor, scores: torch.FloatTensor, **kwargs[0m
[30;1m53 | [0m[35m        ) -> bool:[0m
[30;1m54 | [0m[35m            # Code-completion is open-end generation.[0m
[30;1m55 | [0m[35m            # We check \n\n to stop at end of a code block.[0m
[30;1m56 | [0m[35m            if list(input_ids[0][-2:]) == [628, 198]:[0m
[30;1m57 | [0m[35m                return True[0m
[30;1m58 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m    }[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m@app.get("/get_model_call_stats")[0m
[30;1m214 | [0m[35masync def get_model_call_stats([0m
[30;1m215 | [0m[35m    model: str = None, most_recent_min: int = 60, top_k: int = None[0m
[30;1m216 | [0m[35m):[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m    return {"num_users": len(monitor.user_call_stats_day)}[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m@app.get("/get_user_call_stats")[0m
[30;1m205 | [0m[35masync def get_user_call_stats([0m
[30;1m206 | [0m[35m    model: str = None, most_recent_min: int = 60, top_k: int = None[0m
[30;1m207 | [0m[35m):[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m    return {"num_users": len(monitor.user_call_stats_hour)}[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m@app.get("/get_num_users_day")[0m
[30;1m200 | [0m[35masync def get_num_users_day():[0m
[30;1m201 | [0m[35m    return {"num_users": len(monitor.user_call_stats_day)}[0m
[30;1m202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m    return {"is_limit_reached": False}[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m@app.get("/get_num_users_hr")[0m
[30;1m195 | [0m[35masync def get_num_users():[0m
[30;1m196 | [0m[35m    return {"num_users": len(monitor.user_call_stats_hour)}[0m
[30;1m197 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m    return {"success": True}[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m@app.get("/is_limit_reached")[0m
[30;1m180 | [0m[35masync def is_limit_reached(model: str, user_id: str):[0m
[30;1m181 | [0m[35m    if monitor.is_model_limit_reached(model):[0m
[30;1m182 | [0m[35m        return {[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m    return {"model_call_limit": {model: monitor.get_model_call_limit(model)}}[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m@app.get("/update_model_call_limit/{model}/{limit}")[0m
[30;1m173 | [0m[35masync def update_model_call_limit(model: str, limit: int):[0m
[30;1m174 | [0m[35m    if not monitor.update_model_call_limit(model, limit):[0m
[30;1m175 | [0m[35m        return {"success": False}[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m    asyncio.create_task(monitor.update_stats(2))[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m@app.get("/get_model_call_limit/{model}")[0m
[30;1m168 | [0m[35masync def get_model_call_limit(model: str):[0m
[30;1m169 | [0m[35m    return {"model_call_limit": {model: monitor.get_model_call_limit(model)}}[0m
[30;1m170 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    async def update_stats(self, num_file=1) -> None:[0m
[30;1m29 | [0m[35m        while True:[0m
[30;1m30 | [0m[35m            # find the latest num_file log under log_dir[0m
[30;1m31 | [0m[35m            json_files = glob.glob(os.path.join(self.log_dir, "*.json"))[0m
[30;1m32 | [0m[35m            json_files.sort(key=os.path.getctime, reverse=True)[0m
[30;1m33 | [0m[35m            json_files = json_files[:num_file][0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/call_monitor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport glob[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom fastapi import FastAPI[0m
[30;1m7 | [0m[35mimport hashlib[0m
[30;1m8 | [0m[35mimport asyncio[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_yuan2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 512))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", "<eod>")[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m31 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m32 | [0m[35m    stop_token_ids.append(tokenizer("<eod>")["input_ids"][0])[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    inputs = tokenizer(prompt, return_tensors="pt").to(model.device)[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_yuan2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 1))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 512))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", "<eod>")[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m31 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m32 | [0m[35m    stop_token_ids.append(tokenizer("<eod>")["input_ids"][0])[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_yuan2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 1))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 512))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", "<eod>")[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m31 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m
[30;1m32 | [0m[35m    stop_token_ids.append(tokenizer("<eod>")["input_ids"][0])[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_yuan2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 1))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 512))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", "<eod>")[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m
[30;1m31 | [0m[35m    stop_token_ids = params.get("stop_token_ids", None) or [][0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_yuan2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 1))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 512))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", "<eod>")[0m
[30;1m30 | [0m[35m    echo = bool(params.get("echo", True))[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_yuan2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 1))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 512))[0m
[30;1m29 | [0m[35m    stop_str = params.get("stop", "<eod>")[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_yuan2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    prompt = params["prompt"][0m
[30;1m23 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 1))  # -1 means disable[0m
[30;1m28 | [0m[35m    max_new_tokens = int(params.get("max_new_tokens", 512))[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/model_yuan2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m):[0m
[30;1m22 | [0m[35m    prompt = params["prompt"][0m
[30;1m23 | [0m[35m    len_prompt = len(prompt)[0m
[30;1m24 | [0m[35m    temperature = float(params.get("temperature", 1))[0m
[30;1m25 | [0m[35m    repetition_penalty = float(params.get("repetition_penalty", 1.0))[0m
[30;1m26 | [0m[35m    top_p = float(params.get("top_p", 0))[0m
[30;1m27 | [0m[35m    top_k = int(params.get("top_k", 1))  # -1 means disable[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/register_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        "worker_status": None,[0m
[30;1m25 | [0m[35m        "multimodal": args.multimodal,[0m
[30;1m26 | [0m[35m    }[0m
[30;1m27 | [0m[35m    r = requests.post(url, json=data)[0m
[30;1m28 | [0m[35m    assert r.status_code == 200[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m140 | [0m[35m                    else:[0m
[30;1m141 | [0m[35m                        lines.append("  \n")[0m
[30;1m142 | [0m[35m                markdown = Markdown("".join(lines))[0m
[30;1m143 | [0m[35m                # Update the Live console output[0m
[30;1m144 | [0m[35m                live.update(markdown)[0m
[30;1m145 | [0m[35m        self._console.print()[0m
[30;1m146 | [0m[35m        return text[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m                #  better compatibility with real-world text. However, rendering[0m
[30;1m126 | [0m[35m                #  in markdown would break the format. It is because standard markdown[0m
[30;1m127 | [0m[35m                #  treat a single "\n" in normal text as a space.[0m
[30;1m128 | [0m[35m                #  Our workaround is adding two spaces at the end of each line.[0m
[30;1m129 | [0m[35m                #  This is not a perfect solution, as it would[0m
[30;1m130 | [0m[35m                #  introduce trailing spaces (only) in code block, but it works well[0m
[30;1m131 | [0m[35m                #  especially for console output, because in general the console does not[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m    def stream_output(self, output_stream):[0m
[30;1m111 | [0m[35m        """Stream output from a role."""[0m
[30;1m112 | [0m[35m        # TODO(suquark): the console flickers when there is a code block[0m
[30;1m113 | [0m[35m        #  above it. We need to cut off "live" when a code block is done.[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        # Create a Live context for updating the console output[0m
[30;1m116 | [0m[35m        with Live(console=self._console, refresh_per_second=4) as live:[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/model/apply_delta.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mApply the delta weights on top of a base model.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mUsage:[0m
[30;1m5 | [0m[35mpython3 -m fastchat.model.apply_delta --base ~/model_weights/llama-7b --target ~/model_weights/vicun[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/protocol/api_protocol.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom typing import Literal, Optional, List, Dict, Any, Union[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport shortuuid[0m
[30;1m6 | [0m[35mfrom pydantic import BaseModel, Field[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/data/clean_sharegpt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m        elif cid in visited:[0m
[30;1m170 | [0m[35m            print(f"id {cid} is an id duplication of {visited[cid]}")[0m
[30;1m171 | [0m[35m            cnt_id_duplication += 1[0m
[30;1m172 | [0m[35m        elif sample.get("plugins", None) is not None:[0m
[30;1m173 | [0m[35m            print(f"id {cid} contains plugin")[0m
[30;1m174 | [0m[35m            cnt_plugin += 1[0m
[30;1m175 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/data/clean_sharegpt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m48 | [0m[35m    # Reformat code[0m
[30;1m49 | [0m[35m    val = reformat_code(val)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # Remove noisy "[number] / [number]" at the beginning[0m
[30;1m52 | [0m[35m    noise = re.search(regenerate_pattern, val)[0m
[30;1m53 | [0m[35m    if noise and noise.start() == 0:[0m
[30;1m54 | [0m[35m        val = val[noise.end() :][0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/llm_judge/gen_api_answer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport argparse[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mimport concurrent.futures[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport openai[0m
[30;1m13 | [0m[35mimport shortuuid[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m            "queue_length": sum([w.get_queue_length() for w in workers]),[0m
[30;1m395 | [0m[35m        },[0m
[30;1m396 | [0m[35m    }[0m
[30;1m397 | [0m[35m    r = requests.post(url, json=data)[0m
[30;1m398 | [0m[35m    assert r.status_code == 200[0m
[30;1m399 | [0m[35m[0m
[30;1m400 | [0m[35m    return args, workers[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m337 | [0m[35m        model_names = model_info[m].get("model_names", [m.split("/")[-1]])[0m
[30;1m338 | [0m[35m        if isinstance(model_names, str):[0m
[30;1m339 | [0m[35m            model_names = [model_names][0m
[30;1m340 | [0m[35m        conv_template = model_info[m].get("conv_template", None)[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        context_length_list.append(context_length)[0m
[30;1m343 | [0m[35m        model_names_list.append(model_names)[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m        token_list.append(model_info[m]["token"])[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m        context_length = model_info[m]["context_length"][0m
[30;1m337 | [0m[35m        model_names = model_info[m].get("model_names", [m.split("/")[-1]])[0m
[30;1m338 | [0m[35m        if isinstance(model_names, str):[0m
[30;1m339 | [0m[35m            model_names = [model_names][0m
[30;1m340 | [0m[35m        conv_template = model_info[m].get("conv_template", None)[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m    return worker.get_conv_template()[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m@app.post("/model_details")[0m
[30;1m275 | [0m[35masync def api_model_details(request: Request):[0m
[30;1m276 | [0m[35m    params = await request.json()[0m
[30;1m277 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m    return worker.count_token(params)[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m@app.post("/worker_get_conv_template")[0m
[30;1m268 | [0m[35masync def api_get_conv(request: Request):[0m
[30;1m269 | [0m[35m    params = await request.json()[0m
[30;1m270 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m    }[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m@app.post("/count_token")[0m
[30;1m261 | [0m[35masync def api_count_token(request: Request):[0m
[30;1m262 | [0m[35m    params = await request.json()[0m
[30;1m263 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m    return JSONResponse(content=embedding)[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m@app.post("/worker_get_status")[0m
[30;1m252 | [0m[35masync def api_get_status(request: Request):[0m
[30;1m253 | [0m[35m    return {[0m
[30;1m254 | [0m[35m        "model_names": [m for w in workers for m in w.model_names],[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m    return JSONResponse(output)[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m@app.post("/worker_get_embeddings")[0m
[30;1m242 | [0m[35masync def api_get_embeddings(request: Request):[0m
[30;1m243 | [0m[35m    params = await request.json()[0m
[30;1m244 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m    return StreamingResponse(generator, background=background_tasks)[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m@app.post("/worker_generate")[0m
[30;1m232 | [0m[35masync def api_generate(request: Request):[0m
[30;1m233 | [0m[35m    params = await request.json()[0m
[30;1m234 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m    return background_tasks[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m@app.post("/worker_generate_stream")[0m
[30;1m222 | [0m[35masync def api_generate_stream(request: Request):[0m
[30;1m223 | [0m[35m    params = await request.json()[0m
[30;1m224 | [0m[35m    worker = worker_map[params["model"]][0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        "temperature": float(params.get("temperature", 1.0)),[0m
[30;1m68 | [0m[35m        "stop_sequences": stop_sequences,[0m
[30;1m69 | [0m[35m        "repetition_penalty": float(params.get("repetition_penalty", 1.0)),[0m
[30;1m70 | [0m[35m        "top_k": params.get("top_k", None),[0m
[30;1m71 | [0m[35m        "seed": seed,[0m
[30;1m72 | [0m[35m    }[0m
[30;1m73 | [0m[35m    if gen_kwargs["top_p"] == 1:[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        "top_p": float(params.get("top_p", 1.0)),[0m
[30;1m67 | [0m[35m        "temperature": float(params.get("temperature", 1.0)),[0m
[30;1m68 | [0m[35m        "stop_sequences": stop_sequences,[0m
[30;1m69 | [0m[35m        "repetition_penalty": float(params.get("repetition_penalty", 1.0)),[0m
[30;1m70 | [0m[35m        "top_k": params.get("top_k", None),[0m
[30;1m71 | [0m[35m        "seed": seed,[0m
[30;1m72 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        "return_full_text": bool(params.get("echo", False)),[0m
[30;1m65 | [0m[35m        "max_new_tokens": int(params.get("max_new_tokens", 256)),[0m
[30;1m66 | [0m[35m        "top_p": float(params.get("top_p", 1.0)),[0m
[30;1m67 | [0m[35m        "temperature": float(params.get("temperature", 1.0)),[0m
[30;1m68 | [0m[35m        "stop_sequences": stop_sequences,[0m
[30;1m69 | [0m[35m        "repetition_penalty": float(params.get("repetition_penalty", 1.0)),[0m
[30;1m70 | [0m[35m        "top_k": params.get("top_k", None),[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        "do_sample": True,[0m
[30;1m64 | [0m[35m        "return_full_text": bool(params.get("echo", False)),[0m
[30;1m65 | [0m[35m        "max_new_tokens": int(params.get("max_new_tokens", 256)),[0m
[30;1m66 | [0m[35m        "top_p": float(params.get("top_p", 1.0)),[0m
[30;1m67 | [0m[35m        "temperature": float(params.get("temperature", 1.0)),[0m
[30;1m68 | [0m[35m        "stop_sequences": stop_sequences,[0m
[30;1m69 | [0m[35m        "repetition_penalty": float(params.get("repetition_penalty", 1.0)),[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m    gen_kwargs = {[0m
[30;1m63 | [0m[35m        "do_sample": True,[0m
[30;1m64 | [0m[35m        "return_full_text": bool(params.get("echo", False)),[0m
[30;1m65 | [0m[35m        "max_new_tokens": int(params.get("max_new_tokens", 256)),[0m
[30;1m66 | [0m[35m        "top_p": float(params.get("top_p", 1.0)),[0m
[30;1m67 | [0m[35m        "temperature": float(params.get("temperature", 1.0)),[0m
[30;1m68 | [0m[35m        "stop_sequences": stop_sequences,[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        stop_sequences = [][0m
[30;1m62 | [0m[35m    gen_kwargs = {[0m
[30;1m63 | [0m[35m        "do_sample": True,[0m
[30;1m64 | [0m[35m        "return_full_text": bool(params.get("echo", False)),[0m
[30;1m65 | [0m[35m        "max_new_tokens": int(params.get("max_new_tokens", 256)),[0m
[30;1m66 | [0m[35m        "top_p": float(params.get("top_p", 1.0)),[0m
[30;1m67 | [0m[35m        "temperature": float(params.get("temperature", 1.0)),[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/fastchat/serve/huggingface_api_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m    params,[0m
[30;1m53 | [0m[35m    seed: Optional[int] = None,[0m
[30;1m54 | [0m[35m):[0m
[30;1m55 | [0m[35m    stop = params.get("stop", None)[0m
[30;1m56 | [0m[35m    if isinstance(stop, list):[0m
[30;1m57 | [0m[35m        stop_sequences = stop[0m
[30;1m58 | [0m[35m    elif isinstance(stop, str):[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m    ][0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    for model_path in models:[0m
[30;1m77 | [0m[35m        cmd = f"python3 -m fastchat.serve.huggingface_api --model-path {model_path}"[0m
[30;1m78 | [0m[35m        ret = run_cmd(cmd)[0m
[30;1m79 | [0m[35m        if ret != 0:[0m
[30;1m80 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m    ][0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    for model_path in models:[0m
[30;1m60 | [0m[35m        cmd = ([0m
[30;1m61 | [0m[35m            f"python3 -m fastchat.serve.cli --model-path {model_path} "[0m
[30;1m62 | [0m[35m            f"--style programmatic --load-8bit < test_cli_inputs.txt"[0m
[30;1m63 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m    ][0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    for model_path in models:[0m
[30;1m44 | [0m[35m        cmd = ([0m
[30;1m45 | [0m[35m            f"python3 -m fastchat.serve.cli --model-path {model_path} "[0m
[30;1m46 | [0m[35m            f"--style programmatic --num-gpus 2 --max-gpu-memory 14Gib < test_cli_inputs.txt"[0m
[30;1m47 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m501[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/fschat-0.2.36/tests/test_cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m            os.path.expanduser(model_path)[0m
[30;1m25 | [0m[35m        ):[0m
[30;1m26 | [0m[35m            continue[0m
[30;1m27 | [0m[35m        cmd = ([0m
[30;1m28 | [0m[35m            f"python3 -m fastchat.serve.cli --model-path {model_path} "[0m
[30;1m29 | [0m[35m            f"--style programmatic < test_cli_inputs.txt"[0m
[30;1m30 | [0m[35m        )[0m

501 matches found.
