Run started:2025-04-13 08:49:30.440432

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	# Server to use for anisette generation
20	ANISETTE = "https://sign.rheaa.xyz/"
21	#ANISETTE = 'http://45.132.246.138:6969/'
22	#ANISETTE = 'https://sideloadly.io/anisette/irGb3Quww8zrhgqnzmrx'
23	#ANISETTE = "http://jkcoxson.com:2052/"
24	
25	# Configure SRP library for compatibility with Apple's implementation
26	srp.rfc5054_enable()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	def generate_anisette() -> dict:
36	    r = requests.get(ANISETTE, verify=False if DEBUG else True, timeout=5)
37	    r = json.loads(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	        """Fetches anisette data that we cannot calculate from a remote server"""
45	        r = requests.get(url, verify=False if DEBUG else True, timeout=5)
46	        r = json.loads(r.text)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
119	
120	        return b64encode(self._user_id.encode()).decode()
121	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:120
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
119	
120	        return b64encode(self._user_id.encode()).decode()
121	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
232	
233	    resp = requests.post(
234	        "https://gsa.apple.com/grandslam/GsService2",
235	        headers=headers,
236	        data=plist.dumps(body),
237	        verify=False,  # TODO: Verify Apple's self-signed cert
238	        timeout=5,
239	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	    resp = requests.post(
234	        "https://gsa.apple.com/grandslam/GsService2",
235	        headers=headers,
236	        data=plist.dumps(body),
237	        verify=False,  # TODO: Verify Apple's self-signed cert
238	        timeout=5,
239	    )
240	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
284	def trusted_second_factor(dsid, idms_token, anisette: Anisette):
285	    identity_token = b64encode((dsid + ":" + idms_token).encode()).decode()
286	    

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:285
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
284	def trusted_second_factor(dsid, idms_token, anisette: Anisette):
285	    identity_token = b64encode((dsid + ":" + idms_token).encode()).decode()
286	    

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
299	    # Easier to just use a text prompt
300	    requests.get(
301	        "https://gsa.apple.com/auth/verify/trusteddevice",
302	        headers=headers,
303	        verify=False,
304	        timeout=10,
305	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
300	    requests.get(
301	        "https://gsa.apple.com/auth/verify/trusteddevice",
302	        headers=headers,
303	        verify=False,
304	        timeout=10,
305	    )
306	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
312	    # Send the 2FA code to Apple
313	    resp = requests.get(
314	        "https://gsa.apple.com/grandslam/GsService2/validate",
315	        headers=headers,
316	        verify=False,
317	        timeout=10,
318	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
313	    resp = requests.get(
314	        "https://gsa.apple.com/grandslam/GsService2/validate",
315	        headers=headers,
316	        verify=False,
317	        timeout=10,
318	    )
319	    r = plist.loads(resp.content)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
325	def sms_second_factor(dsid, idms_token, anisette: Anisette):
326	    identity_token = b64encode((dsid + ":" + idms_token).encode()).decode()
327	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:326
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
325	def sms_second_factor(dsid, idms_token, anisette: Anisette):
326	    identity_token = b64encode((dsid + ":" + idms_token).encode()).decode()
327	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
347	    # Easier to just use a text prompt
348	    requests.post(
349	        "https://gsa.apple.com/auth/verify/phone/put?mode=sms",
350	        data=plist.dumps(body),
351	        headers=headers,
352	        verify=False,
353	        timeout=5,
354	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	    requests.post(
349	        "https://gsa.apple.com/auth/verify/phone/put?mode=sms",
350	        data=plist.dumps(body),
351	        headers=headers,
352	        verify=False,
353	        timeout=5,
354	    )
355	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
368	    # Send the 2FA code to Apple
369	    resp = requests.post(
370	        "https://gsa.apple.com/auth/verify/phone/securitycode?referrer=/auth/verify/phone/put",
371	        headers=headers,
372	        data=plist.dumps(body),
373	        verify=False,
374	        timeout=5,
375	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
369	    resp = requests.post(
370	        "https://gsa.apple.com/auth/verify/phone/securitycode?referrer=/auth/verify/phone/put",
371	        headers=headers,
372	        data=plist.dumps(body),
373	        verify=False,
374	        timeout=5,
375	    )
376	    print(resp.content.decode())

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
389	
390	    r = authenticated_request(
391	        {
392	            "A2k": A,
393	            "ps": ["s2k", "s2k_fo"],
394	            "u": username,
395	            "o": "init",
396	        },
397	        anisette,
398	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/grandslam-0.1.0/grandslam-0.1.0/src/grandslam/gsa.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
417	
418	    r = authenticated_request(
419	        {
420	            "c": r["c"],
421	            "M1": M,
422	            "u": username,
423	            "o": "complete",
424	        },
425	        anisette,
426	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 324
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 3.0
Files skipped (0):
