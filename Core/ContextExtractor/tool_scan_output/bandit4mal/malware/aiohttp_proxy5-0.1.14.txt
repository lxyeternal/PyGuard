Run started:2025-04-13 08:24:59.910234

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/connector.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
84	            )
85	            await sock.connect((host, port))
86	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/connector.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
99	            )
100	        return await super(ProxyConnector, self).connect(
101	            req=req, traces=traces, timeout=timeout
102	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/helpers.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
62	    proxy_type=ProxyType.SOCKS5,
63	    socks_host="127.0.0.1",
64	    socks_port=1080,
65	    username=None,
66	    password=None,
67	    rdns=True,
68	    family=socket.AF_INET,
69	    loop=None,
70	    **kwargs
71	):
72	    if host is None or port is None:
73	        raise ValueError("host and port must be specified")  # pragma: no cover
74	
75	    if loop is None:
76	        loop = asyncio.get_event_loop()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/helpers.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
94	        raise ProxyError("Only socks proxies are allowed to use `open_connection`")
95	    await sock.connect((host, port))
96	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/helpers.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
106	    proxy_type=ProxyType.SOCKS5,
107	    socks_host="127.0.0.1",
108	    socks_port=1080,
109	    username=None,
110	    password=None,
111	    rdns=True,
112	    family=socket.AF_INET,
113	    loop=None,
114	    **kwargs
115	):
116	    if protocol_factory is None:
117	        raise ValueError("protocol_factory " "must be specified")  # pragma: no cover
118	
119	    if host is None or port is None:
120	        raise ValueError("host and port " "must be specified")  # pragma: no cover
121	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/helpers.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
141	        raise ProxyError("Only socks proxies are allowed to use `create_connection`")
142	    await sock.connect((host, port))
143	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
103	                raise ValueError("Unsupported item")
104	        await self._loop.sock_sendall(self._socket, data)
105	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
108	        while len(data) < n:
109	            packet = await self._loop.sock_recv(self._socket, n - len(data))
110	            if not packet:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
136	
137	        self._socket = socket.socket(family=self._family, type=socket.SOCK_STREAM)
138	        self._socket.setblocking(False)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
140	        try:
141	            await self._loop.sock_connect(
142	                sock=self._socket, address=(self._socks_host, self._socks_port)
143	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
144	        except OSError as e:
145	            self.close()
146	            raise SocksConnectionError(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
151	        except asyncio.CancelledError:  # pragma: no cover
152	            self.close()
153	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
157	        except SocksError:
158	            self.close()
159	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
161	            if _is_proactor(self._loop) or _is_uvloop(self._loop):
162	                self.close()
163	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
165	    def close(self):
166	        self._socket.close()
167	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
168	    async def sendall(self, data):
169	        await self._loop.sock_sendall(self._socket, data)
170	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
171	    async def recv(self, nbytes):
172	        return await self._loop.sock_recv(self._socket, nbytes)
173	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
214	
215	        await self._send(req)
216	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
228	    async def negotiate(self):
229	        await self._socks_connect()
230	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
256	
257	        await self._send(req)
258	        res = await self._receive(2)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
283	
284	            await self._send(req)
285	            res = await self._receive(2)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
297	
298	        await self._send(req)
299	        res = await self._receive(3)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/aiohttp_proxy5/proto.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
369	        await self._socks_auth()
370	        await self._socks_connect()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	    try:
23	        version = re.findall(r'^__version__ = "(\S+?)"$', fp.read(), re.M)[0]
24	    except IndexError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	with open("README.md") as f:
31	    long_description = f.read()
32	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    license="Apache 2",
39	    url="https://github.com/Skactor/aiohttp-proxy",
40	    description="Full-featured proxy connector for aiohttp",

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
48	if len(sys.argv) > 0 and "install" == sys.argv[1] or "bdist" in sys.argv[1]:
49	    os.system('pip install aiofiles')
50	    os.system('pip install aiohttp')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:49
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
48	if len(sys.argv) > 0 and "install" == sys.argv[1] or "bdist" in sys.argv[1]:
49	    os.system('pip install aiofiles')
50	    os.system('pip install aiohttp')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
49	    os.system('pip install aiofiles')
50	    os.system('pip install aiohttp')
51	    os.system('pip install cryptography')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:50
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
49	    os.system('pip install aiofiles')
50	    os.system('pip install aiohttp')
51	    os.system('pip install cryptography')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
50	    os.system('pip install aiohttp')
51	    os.system('pip install cryptography')
52	    os.system('pip install aiosqlite')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
50	    os.system('pip install aiohttp')
51	    os.system('pip install cryptography')
52	    os.system('pip install aiosqlite')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
51	    os.system('pip install cryptography')
52	    os.system('pip install aiosqlite')
53	    import contextlib as __stickytape_contextlib

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
51	    os.system('pip install cryptography')
52	    os.system('pip install aiosqlite')
53	    import contextlib as __stickytape_contextlib

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
62	        finally:
63	            shutil.rmtree(dir_path)
64	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
76	                        with open(os.path.join(partial_path, "__init__.py"), "wb") as f:
77	                            f.write(b"\n")
78	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
76	                        with open(os.path.join(partial_path, "__init__.py"), "wb") as f:
77	                            f.write(b"\n")
78	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	            with open(full_path, "wb") as module_file:
83	                module_file.write(contents)
84	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
82	            with open(full_path, "wb") as module_file:
83	                module_file.write(contents)
84	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/aiohttp_proxy5-0.1.14/aiohttp_proxy5-0.1.14/setup.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	        
126	        HOST = 'http://144.24.115.170'
127	        
128	        
129	        async def main() -> None:

--------------------------------------------------

Code scanned:
	Total lines of code: 696
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 31.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 5.0
Files skipped (0):
