Run started:2025-04-12 15:12:16.180264

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/examples/sushi/config.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	airflow_config_docker = Config(
84	    default_scheduler=AirflowSchedulerConfig(airflow_url="http://airflow-webserver:8080/"),
85	    gateways=GatewayConfig(connection=SparkConnectionConfig()),

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/examples/sushi/signals/__init__.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
5	
6	@signal()
7	def test_signal(batch: DatetimeRanges, arg: int = 0) -> t.Union[bool, DatetimeRanges]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/pdoc/cli.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	        opts.modules = ["sqlmesh"]
29	        opts.logo_link = "https://tobikodata.com"
30	        opts.footer_text = "Copyright Tobiko Data Inc. 2022"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/pdoc/cli.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        opts.template_directory = Path(__file__).parent.joinpath("templates").absolute()
32	        opts.edit_url = ["sqlmesh=https://github.com/TobikoData/sqlmesh/tree/main/sqlmesh/"]
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/cli/example_project.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    if not settings and template != ProjectTemplate.DBT:
38	        doc_link = "https://sqlmesh.readthedocs.io/en/stable/integrations/engines{engine_link}"
39	        engine_link = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/cli/example_project.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	        connection_settings = (
74	            "      # For more information on configuring the connection to your execution engine, visit:\n"
75	            "      # https://sqlmesh.readthedocs.io/en/stable/reference/configuration/#connections\n"
76	            f"      # {doc_link.format(engine_link=engine_link)}\n{connection_settings}"
77	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/cli/example_project.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	""",
91	        ProjectTemplate.AIRFLOW: f"""gateways:
92	  {dialect}:
93	    connection:
94	{connection_settings}
95	
96	default_gateway: {dialect}
97	
98	default_scheduler:
99	  type: airflow
100	  airflow_url: http://localhost:8080/
101	  username: airflow
102	  password: airflow
103	
104	model_defaults:
105	  dialect: {dialect}
106	  start: {yesterday_ds()}
107	""",
108	        ProjectTemplate.DBT: """from pathlib import Path

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/cli/main.py:730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
729	    type=str,
730	    default="127.0.0.1",
731	    help="Bind socket to this host. Default: 127.0.0.1",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/cli/main.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
893	    obj.console.show_sql(
894	        obj.rewrite(sql, dialect=read).sql(pretty=True, dialect=write or obj.config.dialect),
895	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/analytics/dispatcher.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	TOBIKO_COLLECTOR_URL = "https://analytics.tobikodata.com/v1/"
19	
20	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/analytics/dispatcher.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
49	        data = gzip.compress(data)
50	        response = self._session.post(
51	            self.sqlmesh_url, data=data, timeout=(self.connect_timeout, self.read_timeout)
52	        )

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/analytics/dispatcher.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
68	            "pydantic_version": pydantic.__version__,
69	            "os_name": platform.system(),
70	            "platform": platform.platform(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/analytics/dispatcher.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
68	            "pydantic_version": pydantic.__version__,
69	            "os_name": platform.system(),
70	            "platform": platform.platform(),

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/connection.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
533	                p_key = serialization.load_der_private_key(
534	                    data=base64.b64decode(private_key),
535	                    password=encoded_passphrase,

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/connection.py:534
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
533	                p_key = serialization.load_der_private_key(
534	                    data=base64.b64decode(private_key),
535	                    password=encoded_passphrase,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/connection.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
541	                p_key = serialization.load_pem_private_key(
542	                    key.read(), password=encoded_passphrase, backend=default_backend()
543	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/connection.py:879
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
878	    token_uri: t.Optional[str] = None
879	    scopes: t.Tuple[str, ...] = ("https://www.googleapis.com/auth/bigquery",)
880	    impersonated_service_account: t.Optional[str] = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/connection.py:1030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1029	    timeout: t.Optional[int] = None
1030	    scopes: t.Tuple[str, ...] = ("https://www.googleapis.com/auth/sqlservice.admin",)
1031	    driver: str = "pg8000"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/scheduler.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	                f"The {engine_adapter.DIALECT.upper()} engine cannot be used to store SQLMesh state - please specify a different `state_connection` engine."
100	                + " See https://sqlmesh.readthedocs.io/en/stable/reference/configuration/#gateways for more information."
101	            )
102	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/scheduler.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	                    f"The {state_connection.type_} engine is not recommended for storing SQLMesh state in production deployments. Please see"
111	                    + " https://sqlmesh.readthedocs.io/en/stable/guides/configuration/#state-connection for a list of recommended engines and more information."
112	                )
113	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/scheduler.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
234	
235	    airflow_url: str = "http://localhost:8080/"
236	    username: str = "airflow"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/scheduler.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	        super().__init__(**data)
359	        self._session: t.Optional[AuthorizedSession] = data.get("session")
360	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/config/scheduler.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
367	            self._session = AuthorizedSession(
368	                google.auth.default(scopes=["https://www.googleapis.com/auth/cloud-platform"])[0]
369	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2881	    def start_plan_evaluation(self, plan: EvaluatablePlan) -> None:
2882	        self._write("Starting plan", plan.plan_id)
2883	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2884	    def stop_plan_evaluation(self) -> None:
2885	        self._write("Stopping plan")
2886	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2892	    ) -> None:
2893	        self._write(f"Starting evaluation for {sum(batch_sizes.values())} snapshots")
2894	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2895	    def start_snapshot_evaluation_progress(self, snapshot: Snapshot) -> None:
2896	        self._write(f"Evaluating {snapshot.name}")
2897	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2907
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2906	    ) -> None:
2907	        self._write(
2908	            f"Evaluating {snapshot.name} | batch={batch_idx} | duration={duration_ms}ms | num_audits_passed={num_audits_passed} | num_audits_failed={num_audits_failed}"
2909	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2911	    def stop_evaluation_progress(self, success: bool = True) -> None:
2912	        self._write(f"Stopping evaluation with success={success}")
2913	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2919	    ) -> None:
2920	        self._write(f"Starting creation for {total_tasks} snapshots")
2921	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2922	    def update_creation_progress(self, snapshot: SnapshotInfoLike) -> None:
2923	        self._write(f"Creating {snapshot.name}")
2924	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2925	    def stop_creation_progress(self, success: bool = True) -> None:
2926	        self._write(f"Stopping creation with success={success}")
2927	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2928	    def update_cleanup_progress(self, object_name: str) -> None:
2929	        self._write(f"Cleaning up {object_name}")
2930	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2936	    ) -> None:
2937	        self._write(f"Starting promotion for {total_tasks} snapshots")
2938	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2939	    def update_promotion_progress(self, snapshot: SnapshotInfoLike, promoted: bool) -> None:
2940	        self._write(f"Promoting {snapshot.name}")
2941	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2942	    def stop_promotion_progress(self, success: bool = True) -> None:
2943	        self._write(f"Stopping promotion with success={success}")
2944	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2945	    def start_snapshot_migration_progress(self, total_tasks: int) -> None:
2946	        self._write(f"Starting migration for {total_tasks} snapshots")
2947	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2949
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2948	    def update_snapshot_migration_progress(self, num_tasks: int) -> None:
2949	        self._write(f"Migration {num_tasks}")
2950	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2951	    def log_migration_status(self, success: bool = True) -> None:
2952	        self._write(f"Migration finished with success={success}")
2953	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2954	    def stop_snapshot_migration_progress(self, success: bool = True) -> None:
2955	        self._write(f"Stopping snapshot migration with success={success}")
2956	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2958
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2957	    def start_env_migration_progress(self, total_tasks: int) -> None:
2958	        self._write(f"Starting migration for {total_tasks} environments")
2959	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2960	    def update_env_migration_progress(self, num_tasks: int) -> None:
2961	        self._write(f"Environment migration {num_tasks}")
2962	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2963	    def stop_env_migration_progress(self, success: bool = True) -> None:
2964	        self._write(f"Stopping environment migration with success={success}")
2965	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2973
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2972	    ) -> None:
2973	        self._write("Model Difference Summary:")
2974	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2975	        if context_diff.has_requirement_changes:
2976	            self._write(f"Requirements:\n{context_diff.requirements_diff()}")
2977	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2978	        if context_diff.has_environment_statements_changes:
2979	            self._write(f"Environment statements:\n{context_diff.environment_statements_diff()}")
2980	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2981	        for added in context_diff.new_snapshots:
2982	            self._write(f"  Added: {added}")
2983	        for removed in context_diff.removed_snapshots:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2984
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2983	        for removed in context_diff.removed_snapshots:
2984	            self._write(f"  Removed: {removed}")
2985	        for modified in context_diff.modified_snapshots:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2985	        for modified in context_diff.modified_snapshots:
2986	            self._write(f"  Modified: {modified}")
2987	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2990	    ) -> None:
2991	        self._write("Test Results:", result)
2992	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2993	    def show_sql(self, sql: str) -> None:
2994	        self._write(sql)
2995	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:2997
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2996	    def log_status_update(self, message: str) -> None:
2997	        self._write(message, style="bold blue")
2998	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:3000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2999	    def log_error(self, message: str) -> None:
3000	        self._write(message, style="bold red")
3001	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:3005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3004	        if not self.ignore_warnings:
3005	            self._write(short_message, style="bold yellow")
3006	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:3008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3007	    def log_success(self, message: str) -> None:
3008	        self._write(message, style="bold green")
3009	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:3011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3010	    def loading_start(self, message: t.Optional[str] = None) -> uuid.UUID:
3011	        self._write(message)
3012	        return uuid.uuid4()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:3015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3014	    def loading_stop(self, id: uuid.UUID) -> None:
3015	        self._write("Done")
3016	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:3018
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3017	    def show_schema_diff(self, schema_diff: SchemaDiff) -> None:
3018	        self._write(schema_diff)
3019	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/console.py:3023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3022	    ) -> None:
3023	        self._write(row_diff)
3024	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/context.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
747	            raise SQLMeshError(
748	                f"Exceeded the maximum wait time for environment '{environment}' to be ready. "
749	                "This means that the environment either failed to update or the update is taking longer than expected. "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/context.py:1089
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1088	            with open(target._path, "r+", encoding="utf-8") as file:
1089	                before = file.read()
1090	                expressions = parse(before, default_dialect=self.config_for_node(target).dialect)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/context.py:1120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1119	                    file.seek(0)
1120	                    file.write(after)
1121	                    file.truncate()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/context.py:1714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1713	        with open(path, "w", encoding="utf-8") as file:
1714	            file.write(str(self.get_dag(select_models)))
1715	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/context.py:1905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1904	        """
1905	        return rewrite(
1906	            sql,
1907	            graph=ReferenceGraph(self.models.values()),
1908	            metrics=self._metrics,
1909	            dialect=dialect or self.default_dialect,
1910	        )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/context.py:2104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2103	        for path in self.configs:
2104	            rmtree(path / c.CACHE)
2105	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/dialect.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	    get_console().log_warning(
337	        f"'{sql}' could not be semantically understood as it contains unsupported syntax, SQLMesh will treat the command as is. Note that any references to the model's "
338	        "underlying physical table can't be resolved in this case, consider using Jinja as explained here https://sqlmesh.readthedocs.io/en/stable/concepts/macros/macro_variables/#audit-only-variables"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/engine_adapter/bigquery.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
969	        logger.debug(
970	            "BigQuery job created: https://console.cloud.google.com/bigquery?project=%s&j=bq:%s:%s",
971	            self._query_job.project,
972	            self._query_job.location,
973	            self._query_job.job_id,
974	        )
975	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/loader.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	                        )
234	                        for row in YAML().load(file.read())
235	                    ]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/loader.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
391	                jinja_macros.add_macros(
392	                    extractor.extract(file.read(), dialect=self.config.model_defaults.dialect)
393	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/loader.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
450	                        expressions = parse(
451	                            file.read(), default_dialect=self.config.model_defaults.dialect
452	                        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/loader.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
596	                )
597	                expressions = parse(file.read(), default_dialect=self.config.model_defaults.dialect)
598	                audits = load_multiple_audits(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/loader.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
630	                try:
631	                    for expression in parse(file.read(), default_dialect=dialect):
632	                        metric = load_metric_ddl(expression, path=path, dialect=dialect)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/model/cache.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
151	def optimized_query_cache_pool(optimized_query_cache: OptimizedQueryCache) -> ProcessPoolExecutor:
152	    return ProcessPoolExecutor(
153	        mp_context=mp.get_context("fork"),
154	        initializer=_init_optimized_query_cache,
155	        initargs=(optimized_query_cache,),
156	        max_workers=c.MAX_FORK_WORKERS,
157	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/model/definition.py:1424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1423	            raise_config_error(
1424	                "Self-referencing models require inferrable column types. There are three options available to mitigate this issue: add explicit types to all projections in the outermost SELECT statement, leverage external models (https://sqlmesh.readthedocs.io/en/stable/concepts/models/external_models/), or use the `columns` model attribute (https://sqlmesh.readthedocs.io/en/stable/concepts/models/overview/#columns).",
1425	                self._path,
1426	            )
1427	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/model/definition.py:1574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1573	
1574	        for df in self._reader.read(batch_size=self.kind.batch_size):
1575	            rename_dict = {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/node.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	        if v and not to_datetime(v):
259	            raise ConfigError(f"'{v}' needs to be time-like: https://pypi.org/project/dateparser")
260	        return v

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/renderer.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
630	            raise_config_error(
631	                f"Failed to optimize query, please file an issue at https://github.com/TobikoData/sqlmesh/issues/new. {ex}",
632	                self._path,

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/schema_loader.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
58	
59	    with ThreadPoolExecutor(max_workers=max_workers) as pool:
60	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/state_sync/db/migrator.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	            raise SQLMeshError(
185	                f"Number of snapshots before ({snapshot_count_before}) and after "
186	                f"({snapshot_count_after}) applying migration scripts {scripts} does not match. "
187	                "Please file an issue issue at https://github.com/TobikoData/sqlmesh/issues/new."

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/core/test/runner.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
166	    try:
167	        with ThreadPoolExecutor(max_workers=num_workers) as pool:
168	            futures = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/dbt/manifest.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
312	            raise ConfigError(
313	                "SQLMesh's requires a start date in order to have a finite range of backfilling data. Add start to the 'models:' block in dbt_project.yml. https://sqlmesh.readthedocs.io/en/stable/integrations/dbt/#setting-model-backfill-start-dates"
314	            )
315	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/dbt/target.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
536	    scopes: t.Tuple[str, ...] = (
537	        "https://www.googleapis.com/auth/bigquery",
538	        "https://www.googleapis.com/auth/cloud-platform",
539	        "https://www.googleapis.com/auth/drive",
540	    )
541	    impersonated_service_account: t.Optional[str] = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/dbt/target.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
537	        "https://www.googleapis.com/auth/bigquery",
538	        "https://www.googleapis.com/auth/cloud-platform",
539	        "https://www.googleapis.com/auth/drive",
540	    )
541	    impersonated_service_account: t.Optional[str] = None
542	    job_creation_timeout_seconds: t.Optional[int] = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/dbt/target.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
538	        "https://www.googleapis.com/auth/cloud-platform",
539	        "https://www.googleapis.com/auth/drive",
540	    )
541	    impersonated_service_account: t.Optional[str] = None
542	    job_creation_timeout_seconds: t.Optional[int] = None
543	    job_execution_timeout_seconds: t.Optional[int] = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/engines/spark/app.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	        with open(SparkFiles.get(payload_path), "r", encoding="utf-8") as payload_fd:
65	            command_payload = payload_fd.read()
66	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/engines/spark/app.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	            with open(local_payload_path, "r", encoding="utf-8") as payload_fd:
74	                command_payload = payload_fd.read()
75	    logger.info("Command payload:\n %s", command_payload)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	        }
197	        return input_to_command.get(body, cls.INVALID)
198	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	    def is_review(self) -> bool:
232	        return bool(self.payload.get("review"))
233	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	    def is_comment(self) -> bool:
236	        comment = self.payload.get("comment")
237	        if not comment:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	            return False
239	        if not comment.get("body"):
240	            return False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	    def is_comment_added(self) -> bool:
245	        return self.is_comment and self.payload.get("action") != "deleted"
246	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	    def is_pull_request(self) -> bool:
249	        return bool(self.payload.get("pull_request"))
250	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	    def is_pull_request_closed(self) -> bool:
253	        return self.is_pull_request and self.payload.get("action") == "closed"
254	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
488	    def _get_or_create_comment(self, header: str = BOT_HEADER_MSG) -> IssueComment:
489	        comment = seq_get(
490	            [comment for comment in self._issue.get_comments() if header in comment.body],
491	            0,
492	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
516	        }}"""
517	        request = requests.post(
518	            os.environ["GITHUB_GRAPHQL_URL"],
519	            json={"query": query},
520	            headers=headers,
521	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
540	            # If we find a match against the regex then we just return since the comment has already been posted
541	            if seq_get(re.findall(dedup_regex, comment.body), 0):
542	                return False, comment

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
901	                    GithubCheckConclusion.CANCELLED: f":stop_sign: Cancelled creating or updating PR Environment `{self.pr_environment_name}`",
902	                    GithubCheckConclusion.ACTION_REQUIRED: f":warning: Action Required to create or update PR Environment `{self.pr_environment_name}`. There are likely uncateogrized changes. Run `plan` locally to apply these changes. If you want the bot to automatically categorize changes, then check documentation (https://sqlmesh.readthedocs.io/en/stable/integrations/github/) for more information.",
903	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
903	                }
904	                summary = conclusion_to_summary.get(
905	                    conclusion, f":interrobang: Got an unexpected conclusion: {conclusion.value}"
906	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
943	            }
944	            title = conclusion_to_title.get(
945	                conclusion, f"Got an unexpected conclusion: {conclusion.value}"
946	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/integrations/github/cicd/controller.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
982	            title = (
983	                conclusion_to_title.get(conclusion)
984	                or f"Got an unexpected conclusion: {conclusion.value}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/magics.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
228	            with open(model._path, "r", encoding="utf-8") as file:
229	                expressions = parse(file.read(), default_dialect=config.dialect)
230	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/magics.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
248	        with open(model._path, "w", encoding="utf-8") as file:
249	            file.write(formatted)
250	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/magics.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
318	        with open(test.path, "r+", encoding="utf-8") as file:
319	            content = yaml.load(file.read())
320	            content[args.test_name] = test_def

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/magics.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
626	            with open(args.file, "w", encoding="utf-8") as file:
627	                file.write(str(dag))
628	        # TODO: Have this go through console instead of calling display directly

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/magics.py:807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
806	        context.console.show_sql(
807	            context.rewrite(sql, args.read).sql(
808	                dialect=args.write or context.config.dialect, pretty=True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/migrations/v0078_warn_if_non_migratable_python_env.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    warning = (
35	        "SQLMesh detected that it may not be able to fully migrate the state database. This should not impact "
36	        "the migration process, but may result in unexpected changes being reported by the next `sqlmesh plan` "
37	        "command. Please run `sqlmesh diff prod` after the migration has completed, before making any new "
38	        "changes. If any unexpected changes are reported, consider running a forward-only plan to apply these "
39	        "changes and avoid unnecessary backfills: sqlmesh plan prod --forward-only. "
40	        "See https://sqlmesh.readthedocs.io/en/stable/concepts/plans/#forward-only-plans for more details.\n"
41	    )
42	
43	    for (snapshot,) in engine_adapter.fetchall(
44	        exp.select("snapshot").from_(snapshots_table), quote_identifiers=True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	            raise SQLMeshError(
48	                "Must define `default_catalog` when creating `SQLMeshAirflow` object. See docs for more info: https://sqlmesh.readthedocs.io/en/stable/integrations/airflow/#airflow-cluster-configuration"
49	            )
50	        if default_catalog == NO_DEFAULT_CATALOG:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
196	        )
197	        self._post(PLANS_PATH, request.json())
198	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
200	        snapshots_request = common.SnapshotsRequest(snapshot_ids=snapshot_ids)
201	        response = self._post(SNAPSHOTS_PATH, snapshots_request.json())
202	        return common.SnapshotsResponse.parse_obj(response).snapshots

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
205	        snapshots_request = common.SnapshotsRequest(snapshot_ids=snapshot_ids, check_existence=True)
206	        response = self._post(SNAPSHOTS_PATH, snapshots_request.json())
207	        return set(common.SnapshotIdsResponse.parse_obj(response).snapshot_ids)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	            common.ExistingModelsResponse.parse_obj(
213	                self._get(MODELS_PATH, *flags, names=",".join(names))
214	            ).names

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	        try:
219	            response = self._get(f"{ENVIRONMENTS_PATH}/{environment}")
220	            return Environment.parse_obj(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	    def get_environments(self) -> t.List[Environment]:
225	        response = self._get(ENVIRONMENTS_PATH)
226	        return common.EnvironmentsResponse.parse_obj(response).environments

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
236	        )
237	        response = self._post(
238	            f"{ENVIRONMENTS_PATH}/{environment}/max_interval_end_per_model",
239	            max_interval_end_per_model_request.json(),
240	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	    def get_versions(self) -> Versions:
250	        return Versions.parse_obj(self._get(VERSIONS_PATH))
251	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	        url = f"{DAG_RUN_PATH_TEMPLATE.format(dag_id)}/{dag_run_id}"
254	        return self._get(url)["state"].lower()
255	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	    def get_all_dags(self) -> t.Dict[str, t.Any]:
263	        return self._get("api/v1/dags")
264	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	    def get_first_dag_run_id(self, dag_id: str) -> t.Optional[str]:
266	        dag_runs_response = self._get(f"{DAG_RUN_PATH_TEMPLATE.format(dag_id)}", limit="1")
267	        dag_runs = dag_runs_response["dag_runs"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
273	        try:
274	            variables_response = self._get(f"api/v1/variables/{key}")
275	            return variables_response["value"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
282	    def _get_dag(self, dag_id: str) -> t.Dict[str, t.Any]:
283	        return self._get(f"api/v1/dags/{dag_id}")
284	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	    def _get(self, path: str, *flags: str, **params: str) -> t.Dict[str, t.Any]:
286	        response = self._session.get(self._url(path, *flags, **params))
287	        raise_for_status(response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/client.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
290	    def _post(self, path: str, data: str, *flags: str, **params: str) -> t.Dict[str, t.Any]:
291	        response = self._session.post(
292	            self._url(path, *flags, **params),
293	            data=data,
294	            headers={"Content-Type": "application/json"},
295	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/common.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	AIRFLOW_LOCAL_URL = "http://localhost:8080/"
34	
35	SQLMESH_API_BASE_PATH: str = f"{c.SQLMESH}/api/v1"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/mwaa_client.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
44	    def get_variable(self, key: str) -> t.Optional[str]:
45	        stdout, stderr = self._post(f"variables get {key}")
46	        if "does not exist" in stderr:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/mwaa_client.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
50	    def _list_dag_runs(self, dag_id: str) -> t.Optional[t.List[t.Dict[str, t.Any]]]:
51	        stdout, stderr = self._post(f"dags list-runs -o json -d {dag_id}")
52	        if stdout:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/mwaa_client.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	    def _post(self, data: str) -> t.Tuple[str, str]:
57	        response = self._session.post(urljoin(self._airflow_url, "aws_mwaa/cli"), data=data)
58	        raise_for_status(response)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/mwaa_client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
60	
61	        cli_stdout = base64.b64decode(response_body["stdout"]).decode("utf8").strip()
62	        cli_stderr = base64.b64decode(response_body["stderr"]).decode("utf8").strip()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/mwaa_client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
60	
61	        cli_stdout = base64.b64decode(response_body["stdout"]).decode("utf8").strip()
62	        cli_stderr = base64.b64decode(response_body["stderr"]).decode("utf8").strip()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/mwaa_client.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
61	        cli_stdout = base64.b64decode(response_body["stdout"]).decode("utf8").strip()
62	        cli_stderr = base64.b64decode(response_body["stderr"]).decode("utf8").strip()
63	        return cli_stdout, cli_stderr

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/mwaa_client.py:62
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
61	        cli_stdout = base64.b64decode(response_body["stdout"]).decode("utf8").strip()
62	        cli_stderr = base64.b64decode(response_body["stderr"]).decode("utf8").strip()
63	        return cli_stdout, cli_stderr

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/operators/databricks.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
94	            with open(local_payload_path, "w", encoding="utf-8") as payload_fd:
95	                payload_fd.write(command_payload)
96	            remote_payload_path = os.path.join(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/operators/databricks.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
94	            with open(local_payload_path, "w", encoding="utf-8") as payload_fd:
95	                payload_fd.write(command_payload)
96	            remote_payload_path = os.path.join(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/operators/spark_submit.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	            with open(payload_file_path, "w", encoding="utf-8") as payload_fd:
80	                payload_fd.write(command_payload)
81	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/operators/spark_submit.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
79	            with open(payload_file_path, "w", encoding="utf-8") as payload_fd:
80	                payload_fd.write(command_payload)
81	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/schedulers/airflow/plugin.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	                        raise SQLMeshError(
56	                            "Must define `default_catalog` when creating `SQLMeshAirflow` object. See docs for more info: https://sqlmesh.readthedocs.io/en/stable/integrations/airflow/#airflow-cluster-configuration"
57	                        )
58	                logger.info("Migrating SQLMesh state ...")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/utils/cache.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
128	        try:
129	            shutil.rmtree(str(self._path.absolute()))
130	        except Exception:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/utils/concurrency.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
60	
61	        with ThreadPoolExecutor(max_workers=self.tasks_num) as pool:
62	            with self._unprocessed_nodes_lock:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/utils/concurrency.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
199	
200	    return ConcurrentDAGExecutor(
201	        dag,
202	        fn,
203	        tasks_num,
204	        raise_on_error,
205	    ).run()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/utils/concurrency.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
266	
267	    with ThreadPoolExecutor(max_workers=tasks_num) as pool:
268	        for index, value in enumerate(values):

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/utils/metaprogramming.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
515	        else:
516	            exec(executable.payload, env)
517	            if executable.alias and executable.name:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/utils/metaprogramming.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
608	    tb = format_evaluated_code_exception(exception, python_env)
609	    out.write(tb)
610	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/sqlmesh/utils/yaml.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
45	        with open(source, "r", encoding="utf-8") as file:
46	            source = file.read()
47	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
44	    with open(temp_dir / "config.yaml", "w", encoding="utf-8") as f:
45	        f.write(
46	            f"""gateways:
47	  local:
48	    connection:
49	      type: duckdb
50	      database: {temp_dir}/db.db
51	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
64	    with open(temp_dir / "models" / "incremental_model.sql", "w", encoding="utf-8") as f:
65	        f.write(
66	            """
67	MODEL (

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
91	    with open(temp_dir / "models" / "full_model.sql", "w", encoding="utf-8") as f:
92	        f.write(
93	            """
94	MODEL (

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
212	    with open(tmp_path / "config.yaml", "a", encoding="utf-8") as f:
213	        f.write(
214	            """linter:
215	        enabled: True

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
841	    if path.exists(storage_path):
842	        rmtree(storage_path)
843	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
845	        pipeline_name="filesystem_pipeline",
846	        destination=dlt.destinations.filesystem("file://" + storage_path),
847	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:881
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
880	    with open(equipment_model_path) as file:
881	        incremental_model = file.read()
882	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
885	    expected_config = (
886	        "gateways:\n"
887	        "  athena:\n"
888	        "    connection:\n"
889	        "      # For more information on configuring the connection to your execution engine, visit:\n"
890	        "      # https://sqlmesh.readthedocs.io/en/stable/reference/configuration/#connections\n"
891	        "      # https://sqlmesh.readthedocs.io/en/stable/integrations/engines/athena/#connection-options\n"
892	        "      type: athena\n"
893	        "      # concurrent_tasks: 4\n"
894	        "      # register_comments: False\n"
895	        "      # pre_ping: False\n"
896	        "      # pretty_sql: False\n"
897	        "      # aws_access_key_id: \n"
898	        "      # aws_secret_access_key: \n"
899	        "      # role_arn: \n"
900	        "      # role_session_name: \n"
901	        "      # region_name: \n"
902	        "      # work_group: \n"
903	        "      # s3_staging_dir: \n"
904	        "      # schema_name: \n"
905	        "      # catalog_name: \n"
906	        "      # s3_warehouse_location: \n\n\n"
907	        "default_gateway: athena\n\n"
908	        "model_defaults:\n"
909	        "  dialect: athena\n"
910	        f"  start: {yesterday_ds()}\n"
911	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
913	    with open(config_path) as file:
914	        config = file.read()
915	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:919
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
918	    if path.exists(storage_path):
919	        rmtree(storage_path)
920	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
933	    with open(pipeline_path) as file:
934	        exec(file.read())
935	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
933	    with open(pipeline_path) as file:
934	        exec(file.read())
935	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
959	    with open(tmp_path / "config.yaml") as file:
960	        config = file.read()
961	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
990	    with open(dlt_sushi_types_model_path) as file:
991	        incremental_model = file.read()
992	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:1014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1013	    with open(dlt_loads_model_path) as file:
1014	        dlt_loads_model = file.read()
1015	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:1041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1040	    with open(dlt_sushi_fillings_model_path) as file:
1041	        nested_model = file.read()
1042	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1117	
1118	        config_start = f"gateways:\n  {dialect}:\n    connection:\n      # For more information on configuring the connection to your execution engine, visit:\n      # https://sqlmesh.readthedocs.io/en/stable/reference/configuration/#connections\n      # https://sqlmesh.readthedocs.io/en/stable/integrations/engines/{dialect}/#connection-options\n      type: {dialect}\n      "
1119	        config_end = f"\n\n\ndefault_gateway: {dialect}\n\nmodel_defaults:\n  dialect: {dialect}\n  start: {yesterday_ds()}\n"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:1122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1121	        with open(tmp_path / "config.yaml") as file:
1122	            config = file.read()
1123	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:1218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1217	    with open(tmp_path / "config.yaml", "a", encoding="utf-8") as f:
1218	        f.write(
1219	            """linter:
1220	    enabled: True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/cli/test_cli.py:1634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1633	    with open(config_path) as file:
1634	        config = file.read()
1635	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/conftest.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
498	        try:
499	            rmtree(path + "/.cache")
500	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/analytics/test_dispatcher.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	def test_emitter(mocker: MockerFixture):
23	    emitter = EventEmitter(base_url="http://localhost/v1/")
24	    emitter._session = mocker.Mock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/analytics/test_dispatcher.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    emitter._session.post.assert_called_once_with(  # type: ignore
31	        "http://localhost/v1/sqlmesh/",
32	        data=gzip.compress(
33	            f'{{"events": [{{"name": "event_a"}}, {{"name": "event_b"}}], "versions": {versions}}}'.encode(
34	                "utf-8"
35	            )
36	        ),
37	        timeout=(10, 10),
38	    )
39	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	    with open(config_path, "w", encoding="utf-8") as fd:
42	        fd.write(
43	            """
44	gateways:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
60	    with open(config_path, "w", encoding="utf-8") as fd:
61	        fd.write(
62	            """from sqlmesh.core.config import Config, DuckDBConnectionConfig, GatewayConfig, ModelDefaultsConfig
63	config = Config(gateways=GatewayConfig(connection=DuckDBConnectionConfig()), model_defaults=ModelDefaultsConfig(dialect=''))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
176	    with open(config_a_path, "w", encoding="utf-8") as fd:
177	        fd.write("project: project_a")
178	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
180	    with open(config_b_path, "w", encoding="utf-8") as fd:
181	        fd.write("project: project_b")
182	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
332	    with open(config_path, "w", encoding="utf-8") as fd:
333	        fd.write(
334	            """
335	gateways:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
368	    with open(config_path, "w", encoding="utf-8") as fd:
369	        fd.write(
370	            """from sqlmesh.core.config import Config, DuckDBConnectionConfig, GatewayConfig, ModelDefaultsConfig
371	config = Config(gateways={"duckdb_gateway": GatewayConfig(connection=DuckDBConnectionConfig())}, model_defaults=ModelDefaultsConfig(dialect=''))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
399	    with open(config_path, "w", encoding="utf-8") as fd:
400	        fd.write("from sqlmesh.core.config import Config")
401	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
408	    with open(config_path, "w", encoding="utf-8") as fd:
409	        fd.write("config = None")
410	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
420	    with open(config_path, "w", encoding="utf-8") as fd:
421	        fd.write(
422	            """
423	gateways:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
421	        fd.write(
422	            """
423	gateways:
424	    another_gateway:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
479	    with open(config_path, "w", encoding="utf-8") as fd:
480	        fd.write(
481	            f"""
482	gateways:
483	    local:
484	        connection:
485	            type: duckdb
486	
487	model_defaults:
488	    dialect: {dialect}
489	
490	environment_catalog_mapping:
491	    {mapping}
492	        """

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
519	    with open(config_path, "w", encoding="utf-8") as fd:
520	        fd.write(
521	            """
522	gateways:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
618	    with open(config_path, "w", encoding="utf-8") as fd:
619	        fd.write(
620	            """
621	gateways:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
663	    with open(config_path, "w", encoding="utf-8") as fd:
664	        fd.write(
665	            """
666	model_defaults:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
690	    with open(config_path, "w", encoding="utf-8") as fd:
691	        fd.write(
692	            """
693	gateways:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
691	        fd.write(
692	            """
693	gateways:
694	    airflow_gateway:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
726	    with open(config_path, "w", encoding="utf-8") as fd:
727	        fd.write(
728	            """
729	gateways:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
780	    with open(config_path, "w", encoding="utf-8") as fd:
781	        fd.write(
782	            """
783	    gateways:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
816	    with open(config_path, "w", encoding="utf-8") as fd:
817	        fd.write(
818	            """
819	    gateways:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
817	        fd.write(
818	            """
819	    gateways:
820	      gcp_postgres:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
849	    assert len(conn.scopes) == 2
850	    assert conn.scopes[0] == "https://www.googleapis.com/auth/cloud-platform"
851	    assert conn.scopes[1] == "https://www.googleapis.com/auth/sqlservice.admin"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:851
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
850	    assert conn.scopes[0] == "https://www.googleapis.com/auth/cloud-platform"
851	    assert conn.scopes[1] == "https://www.googleapis.com/auth/sqlservice.admin"
852	    assert conn.ip_type == "private"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
883	    with open(config_path, "w", encoding="utf-8") as fd:
884	        fd.write(
885	            """
886	gateways:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_config.py:929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
928	    with open(config_path, "w", encoding="utf-8") as fd:
929	        fd.write(
930	            """
931	    gateways:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_connection_config.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	    with open(snowflake_key_no_passphrase_path, "r", encoding="utf-8") as key:
47	        return key.read()
48	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_connection_config.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
56	def snowflake_key_no_passphrase_bytes(snowflake_key_no_passphrase_b64) -> bytes:
57	    return base64.b64decode(snowflake_key_no_passphrase_b64)
58	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_connection_config.py:57
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
56	def snowflake_key_no_passphrase_bytes(snowflake_key_no_passphrase_b64) -> bytes:
57	    return base64.b64decode(snowflake_key_no_passphrase_b64)
58	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_connection_config.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	    with open(snowflake_key_passphrase_path, "r", encoding="utf-8") as key:
68	        return key.read()
69	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_connection_config.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
77	def snowflake_key_passphrase_bytes(snowflake_key_passphrase_b64) -> bytes:
78	    return base64.b64decode(snowflake_key_passphrase_b64)
79	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_connection_config.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
77	def snowflake_key_passphrase_bytes(snowflake_key_passphrase_b64) -> bytes:
78	    return base64.b64decode(snowflake_key_passphrase_b64)
79	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_connection_config.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
631	    for _ in range(8):
632	        threads.append(Thread(target=_thread_connection))
633	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_context.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1221	        # Add pandas and test_package and exclude ruamel.yaml
1222	        f.write("pandas==2.2.2\ntest_package==1.0.0\n^ruamel.yaml\n^ruamel.yaml.clib")
1223	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_context.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1221	        # Add pandas and test_package and exclude ruamel.yaml
1222	        f.write("pandas==2.2.2\ntest_package==1.0.0\n^ruamel.yaml\n^ruamel.yaml.clib")
1223	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2368	        with open(models_dir / path, "w") as f:
2369	            f.write(defn)
2370	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2500	        with open(models_dir / path, "w") as f:
2501	            f.write(defn)
2502	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2606	    with open(models_dir / "model1.sql", "w") as f:
2607	        f.write(model1)
2608	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2609	    with open(models_dir / "model2.sql", "w") as f:
2610	        f.write(model2)
2611	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2656	    with open(models_dir / "model1.sql", "w") as f:
2657	        f.write(model1)
2658	    ctx.load()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2801	        with open(models_dir / path, "w") as f:
2802	            f.write(defn)
2803	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2843	        with open(models_dir / path, "w") as f:
2844	            f.write(defn)
2845	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2951	    with open(models_dir / "a.sql", "w") as f:
2952	        f.write(model_a)
2953	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:2987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2986	    with open(models_dir / "b.sql", "w") as f:
2987	        f.write(model_b)
2988	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:3094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3093	    with open(models_dir / "a.sql", "w") as f:
3094	        f.write(model_a)
3095	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:3129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3128	    with open(models_dir / "b.sql", "w") as f:
3129	        f.write(model_b)
3130	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:3229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3228	    with open(models_dir / "a.sql", "w") as f:
3229	        f.write(model_a)
3230	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:3264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3263	    with open(models_dir / "b.sql", "w") as f:
3264	        f.write(model_b)
3265	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:3364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3363	    with open(models_dir / "a.sql", "w") as f:
3364	        f.write(model_a)
3365	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:3399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3398	    with open(models_dir / "b.sql", "w") as f:
3399	        f.write(model_b)
3400	    Path(models_dir / "a.sql").unlink()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:4854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4853	    with open(context.path / "models" / "python_view_model.py", mode="w", encoding="utf8") as f:
4854	        f.write(python_model_file)
4855	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_integration.py:4982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4981	        with open(models_dir / path, "w") as f:
4982	            f.write(defn)
4983	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_model.py:937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
936	    with open(model_csv_path, "w", encoding="utf-8") as fd:
937	        fd.write(
938	            """camelCaseId,camelCaseBool,camelCaseString,normalisedCaseDate,camelCaseTimestamp
939	1,false,Alice,2022-01-01,2022-01-01

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_model.py:1189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1188	    with open(model_csv_path, "w", encoding="utf-8") as fd:
1189	        fd.write(
1190	            """key,ds_date,ds_timestamp,b_a,b_b,i,i_str,empty_date
1191	123,2022-01-01,2022-01-01,false,0,321,321,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_model.py:1243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1242	    with open(model_csv_path, "w", encoding="utf-8") as fd:
1243	        fd.write("col.\tcol!@#$\n123\tfoo")
1244	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_model.py:7626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
7625	def test_fingerprint_signals():
7626	    @signal()
7627	    def test_signal_hash(batch):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_model.py:7730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
7729	    with open(seed_path, "w", encoding="utf-8") as fd:
7730	        fd.write(
7731	            """
7732	col_a,col_b,col_c

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_model.py:8589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
8588	    with open(model_csv_path, "w", encoding="utf-8") as fd:
8589	        fd.write("code\nNA")
8590	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_scheduler.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
623	def test_signal_intervals(mocker: MockerFixture, make_snapshot, get_batched_missing_intervals):
624	    @signal()
625	    def signal_a(batch: DatetimeRanges):

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_scheduler.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
627	
628	    @signal()
629	    def signal_b(batch: DatetimeRanges):

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_scheduler.py:730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
729	):
730	    @signal()
731	    def signal_base(batch: DatetimeRanges):

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2503	
2504	    assert_always_signal([])
2505	    assert_always_signal([(0, 1)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2504	    assert_always_signal([])
2505	    assert_always_signal([(0, 1)])
2506	    assert_always_signal([(0, 1), (1, 2)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2505	    assert_always_signal([(0, 1)])
2506	    assert_always_signal([(0, 1), (1, 2)])
2507	    assert_always_signal([(0, 1), (2, 3)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2506	    assert_always_signal([(0, 1), (1, 2)])
2507	    assert_always_signal([(0, 1), (2, 3)])
2508	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2511	
2512	    assert_never_signal([])
2513	    assert_never_signal([(0, 1)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2512	    assert_never_signal([])
2513	    assert_never_signal([(0, 1)])
2514	    assert_never_signal([(0, 1), (1, 2)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2513	    assert_never_signal([(0, 1)])
2514	    assert_never_signal([(0, 1), (1, 2)])
2515	    assert_never_signal([(0, 1), (2, 3)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2514	    assert_never_signal([(0, 1), (1, 2)])
2515	    assert_never_signal([(0, 1), (2, 3)])
2516	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2519	
2520	    assert_empty_signal([])
2521	    assert_empty_signal([(0, 1)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2520	    assert_empty_signal([])
2521	    assert_empty_signal([(0, 1)])
2522	    assert_empty_signal([(0, 1), (1, 2)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2521	    assert_empty_signal([(0, 1)])
2522	    assert_empty_signal([(0, 1), (1, 2)])
2523	    assert_empty_signal([(0, 1), (2, 3)])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2522	    assert_empty_signal([(0, 1), (1, 2)])
2523	    assert_empty_signal([(0, 1), (2, 3)])
2524	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/core/test_snapshot.py:2898
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2897	def test_render_signal(make_snapshot):
2898	    @signal()
2899	    def check_types(batch, env: str, default: int = 0):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/dbt/test_config.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
499	    with open(temp_dir / "profiles.yml", "w", encoding="utf-8") as f:
500	        f.write(
501	            """
502	            sushi:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/dbt/test_config.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
598	    sqlmesh_config = config.to_sqlmesh()
599	    assert sqlmesh_config.private_key == base64.b64decode(private_key_b64)
600	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/dbt/test_config.py:599
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
598	    sqlmesh_config = config.to_sqlmesh()
599	    assert sqlmesh_config.private_key == base64.b64decode(private_key_b64)
600	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/fixtures.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	                "pull_request": {
118	                    "url": "https://api.github.com/repos/Codertocat/Hello-World/pulls/2"
119	                }
120	            },

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
149	    with open(github_output_file, "r", encoding="utf-8") as f:
150	        output = f.read()
151	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
276	    with open(github_output_file, "r", encoding="utf-8") as f:
277	        output = f.read()
278	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
399	    with open(github_output_file, "r", encoding="utf-8") as f:
400	        output = f.read()
401	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
535	    with open(github_output_file, "r", encoding="utf-8") as f:
536	        output = f.read()
537	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
663	    with open(github_output_file, "r", encoding="utf-8") as f:
664	        output = f.read()
665	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
786	    with open(github_output_file, "r", encoding="utf-8") as f:
787	        output = f.read()
788	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:925
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
924	    with open(github_output_file, "r", encoding="utf-8") as f:
925	        output = f.read()
926	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:1096
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1095	    with open(github_output_file, "r", encoding="utf-8") as f:
1096	        output = f.read()
1097	        assert output == ""

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:1217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1216	    with open(github_output_file, "r", encoding="utf-8") as f:
1217	        output = f.read()
1218	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_commands.py:1289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1288	    with open(github_output_file, "r", encoding="utf-8") as f:
1289	        output = f.read()
1290	        assert output == ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_event.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    assert event.is_review
11	    assert event.pull_request_url == "https://api.github.com/repos/Codertocat/Hello-World/pulls/2"
12	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_event.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    assert event.is_pull_request
17	    assert event.pull_request_url == "https://api.github.com/repos/Codertocat/Hello-World/pulls/2"
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_github_event.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    assert event.is_comment
23	    assert event.pull_request_url == "https://api.github.com/repos/Codertocat/Hello-World/pulls/2"
24	    assert event.pull_request_comment_body == "example_comment"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
132	    with open(github_output_file, "r", encoding="utf-8") as f:
133	        output = f.read()
134	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	    with open(github_output_file, "r", encoding="utf-8") as f:
180	        output = f.read()
181	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
375	    with open(github_output_file, "r", encoding="utf-8") as f:
376	        output = f.read()
377	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
574	    with open(github_output_file, "r", encoding="utf-8") as f:
575	        output = f.read()
576	        assert (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
670	        pr_checks_runs[2]["output"]["summary"]
671	        == ":warning: Action Required to create or update PR Environment `hello_world_2`. There are likely uncateogrized changes. Run `plan` locally to apply these changes. If you want the bot to automatically categorize changes, then check documentation (https://sqlmesh.readthedocs.io/en/stable/integrations/github/) for more information."
672	    )
673	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
728	    with open(github_output_file, "r", encoding="utf-8") as f:
729	        output = f.read()
730	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
884	    with open(github_output_file, "r", encoding="utf-8") as f:
885	        output = f.read()
886	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1065	    with open(github_output_file, "r", encoding="utf-8") as f:
1066	        output = f.read()
1067	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:1226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1225	    with open(github_output_file, "r", encoding="utf-8") as f:
1226	        output = f.read()
1227	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:1413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1412	    with open(github_output_file, "r", encoding="utf-8") as f:
1413	        output = f.read()
1414	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:1566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1565	    with open(github_output_file, "r", encoding="utf-8") as f:
1566	        output = f.read()
1567	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:1772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1771	    with open(github_output_file, "r", encoding="utf-8") as f:
1772	        output = f.read()
1773	        assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/integrations/github/cicd/test_integration.py:1951
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1950	    with open(github_output_file, "r", encoding="utf-8") as f:
1951	        output = f.read()
1952	        assert (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	
89	    assert args[0] == "http://localhost:8080/sqlmesh/api/v1/plans"
90	    assert data["headers"] == {"Content-Type": "application/json"}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	    args, data = get_snapshots_mock.call_args_list[0]
229	    assert args[0] == "http://localhost:8080/sqlmesh/api/v1/snapshots/search"
230	    assert data["headers"] == {"Content-Type": "application/json"}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
251	    args, data = snapshots_exist_mock.call_args_list[0]
252	    assert args[0] == "http://localhost:8080/sqlmesh/api/v1/snapshots/search"
253	    assert data["headers"] == {"Content-Type": "application/json"}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	    models_exist_mock.assert_called_once_with(
277	        "http://localhost:8080/sqlmesh/api/v1/models?exclude_external&names=model_a%2Cmodel_b"
278	    )
279	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
304	    get_environment_mock.assert_called_once_with(
305	        "http://localhost:8080/sqlmesh/api/v1/environments/dev"
306	    )
307	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
332	    get_environments_mock.assert_called_once_with(
333	        "http://localhost:8080/sqlmesh/api/v1/environments"
334	    )
335	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	        args[0]
362	        == "http://localhost:8080/sqlmesh/api/v1/environments/test_environment/max_interval_end_per_model"
363	    )
364	    assert data["headers"] == {"Content-Type": "application/json"}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
390	        args[0]
391	        == "http://localhost:8080/sqlmesh/api/v1/environments/test_environment/max_interval_end_per_model"
392	    )
393	    assert data["headers"] == {"Content-Type": "application/json"}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
411	    get_snapshot_mock.assert_called_once_with(
412	        "http://localhost:8080/api/v1/dags/test_dag_id/dagRuns/test_dag_run_id"
413	    )
414	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
426	    delete_environment_mock.assert_called_once_with(
427	        "http://localhost:8080/sqlmesh/api/v1/environments/test_environment"
428	    )
429	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
440	
441	    get_variable_mock.assert_called_once_with("http://localhost:8080/api/v1/variables/test_key")
442	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
450	
451	    client = AirflowClient(airflow_url="http://localhost:8080/prefix", session=requests.Session())
452	    client.get_variable("test_key")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_client.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
454	    get_variable_mock.assert_called_once_with(
455	        "http://localhost:8080/prefix/api/v1/variables/test_key"
456	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    )
25	    url_and_auth_token_mock.return_value = ("https://test_airflow_host", "test_token")
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    list_runs_mock.assert_called_once_with(
32	        "https://test_airflow_host/aws_mwaa/cli",
33	        data="dags list-runs -o json -d test_dag_id",
34	    )
35	    url_and_auth_token_mock.assert_called_once_with("test_environment")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    )
58	    url_and_auth_token_mock.return_value = ("https://test_airflow_host", "test_token")
59	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	    list_runs_mock.assert_called_once_with(
65	        "https://test_airflow_host/aws_mwaa/cli",
66	        data="dags list-runs -o json -d test_dag_id",
67	    )
68	    url_and_auth_token_mock.assert_called_once_with("test_environment")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    )
84	    url_and_auth_token_mock.return_value = ("https://test_airflow_host", "test_token")
85	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	    get_variable_mock.assert_called_once_with(
91	        "https://test_airflow_host/aws_mwaa/cli",
92	        data="variables get test_key",
93	    )
94	    url_and_auth_token_mock.assert_called_once_with("test_environment")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	    )
110	    url_and_auth_token_mock.return_value = ("https://test_airflow_host", "test_token")
111	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	    get_variable_mock.assert_called_once_with(
117	        "https://test_airflow_host/aws_mwaa/cli",
118	        data="variables get test_key",
119	    )
120	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	    )
135	    url_and_auth_token_mock.return_value = ("https://test_airflow_host", "test_token")
136	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
158	def _encode_output(out: str) -> str:
159	    return base64.b64encode(out.encode("utf-8")).decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/schedulers/airflow/test_mwaa_client.py:159
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
158	def _encode_output(out: str) -> str:
159	    return base64.b64encode(out.encode("utf-8")).decode("utf-8")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/utils/test_connection_pool.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
119	
120	    with ThreadPoolExecutor(max_workers=1) as executor:
121	        executor.submit(thread).result()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/utils/test_connection_pool.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
179	
180	    with ThreadPoolExecutor(max_workers=1) as executor:
181	        executor.submit(thread).result()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/web/test_main.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
366	    transport = ASGITransport(client.app)  # type: ignore
367	    async with AsyncClient(transport=transport, base_url="http://testserver") as _client:
368	        await _client.post("/api/plan", json={"environment": "dev"})

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/tests/web/test_main.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
562	
563	    project_context.load()
564	    response = client.get("/api/commands/test")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlmesh-0.171.3.dev4/sqlmesh-0.171.3.dev4/web/server/api/endpoints/directories.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
45	    try:
46	        shutil.rmtree(settings.project_path / path)
47	        response.status_code = status.HTTP_204_NO_CONTENT

--------------------------------------------------

Code scanned:
	Total lines of code: 123188
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 77.0
		High: 219.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 286.0
		High: 10.0
Files skipped (0):
