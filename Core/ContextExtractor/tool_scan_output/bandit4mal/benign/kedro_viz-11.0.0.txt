Run started:2025-04-12 14:16:09.629741

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/apps.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	    # Serve the favicon.ico file from the "html" directory
77	    @app.get("/favicon.ico", include_in_schema=False)
78	    async def favicon():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/apps.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	
81	    @app.get("/")
82	    async def index():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/apps.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	
108	    @app.get("/api/reload")
109	    async def reload(request: Request):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/apps.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	
129	    @app.get("/")
130	    async def index():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/apps.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	
134	    @app.get("/api/main", response_class=JSONResponse)
135	    async def main():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/apps.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
137	
138	    @app.get("/api/nodes/{node_id}", response_class=JSONResponse)
139	    async def get_node_metadata(node_id):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/apps.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	
144	    @app.get("/api/pipelines/{pipeline_id}", response_class=JSONResponse)
145	    async def get_registered_pipeline(pipeline_id):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/apps.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	
150	    @app.get("/api/deploy-viz-metadata", response_class=JSONResponse)
151	    async def get_deployed_viz_metadata():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/rest/router.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	
35	@router.get("/main", response_model=GraphAPIResponse)
36	async def main():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/rest/router.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	
40	@router.get(
41	    "/nodes/{node_id}",
42	    response_model=NodeMetadataAPIResponse,
43	    response_model_exclude_none=True,
44	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/rest/router.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	
49	@router.get(
50	    "/pipelines/{registered_pipeline_id}",
51	    response_model=GraphAPIResponse,
52	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/rest/router.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	
57	@router.get(
58	    "/version",
59	    response_model=VersionAPIResponse,
60	)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/rest/router.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
64	
65	@router.post("/deploy")
66	async def deploy_kedro_viz(input_values: DeployerConfiguration):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/api/rest/router.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	
104	@router.get(
105	    "/metadata",
106	    response_model=MetadataAPIResponse,
107	)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/constants.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
9	
10	DEFAULT_HOST = "127.0.0.1"
11	DEFAULT_PORT = 4141

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/integrations/deployment/base_deployer.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
69	            with open(temp_file_path, "w", encoding="utf-8") as temp_index_file:
70	                temp_index_file.write(html_content)
71	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/integrations/deployment/base_deployer.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
97	            with self._fs.open(f"{self._path}/{_METADATA_PATH}", "w") as metadata_file:
98	                metadata_file.write(json.dumps(metadata))
99	        except Exception as exc:  # pragma: no cover

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/integrations/notebook/visualizer.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	DEFAULT_JS_URL = (
39	    "https://cdn.jsdelivr.net/gh/kedro-org/kedro-viz@main/esm/kedro-viz.production.mjs"
40	)
41	
42	
43	class NotebookVisualizer:
44	    """Represent a Kedro-Viz visualization instance in a notebook"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/integrations/pypi/__init__.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	# PyPI endpoint to query latest Kedro-Viz version available
13	_PYPI_ENDPOINT = "https://pypi.python.org/pypi/kedro-viz/json"
14	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/integrations/pypi/__init__.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	    try:
21	        pypi_response = requests.get(_PYPI_ENDPOINT, timeout=30).json()
22	    except requests.exceptions.RequestException:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/cli/deploy.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    required=True,
22	    help="Static Website hosted endpoint."
23	    "(eg., For AWS - http://<bucket_name>.s3-website.<region_name>.amazonaws.com/)",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/cli/run.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        display_cli_message(
146	            "WARNING: You are using an old version of Kedro Viz. "
147	            f"You are using version {installed_version}; "
148	            f"however, version {latest_version} is now available.\n"
149	            "You should consider upgrading via the `pip install -U kedro-viz` command.\n"
150	            "You can view the complete changelog at "
151	            "https://github.com/kedro-org/kedro-viz/releases.",
152	            "yellow",

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/cli/run.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
195	            }
196	            viz_process = process_context.Process(
197	                target=run_process,
198	                daemon=False,
199	                args=run_process_args,
200	                kwargs={**run_process_kwargs},
201	            )

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/cli/run.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
202	        else:
203	            viz_process = process_context.Process(
204	                target=run_server, daemon=False, kwargs={**run_server_kwargs}
205	            )

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/cli/utils.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
27	
28	        viz_deploy_process = multiprocessing.Process(
29	            target=_load_and_deploy_viz,
30	            args=(
31	                platform,
32	                is_all_previews_enabled,
33	                endpoint,
34	                bucket_name,
35	                include_hooks,
36	                PACKAGE_NAME,
37	                process_completed,
38	                exception_queue,
39	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/cli/utils.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	            display_cli_message(
82	                "PERMISSION ERROR: Deploying and hosting Kedro-Viz requires "
83	                f"{platform.upper()} access keys, a valid {platform.upper()} "
84	                "endpoint and bucket name.\n"
85	                f"Please supply your {platform.upper()} access keys as environment variables "
86	                f"and make sure the {platform.upper()} endpoint and bucket name are valid.\n"
87	                "More information can be found at : "
88	                "https://docs.kedro.org/en/stable/visualisation/share_kedro_viz.html",
89	                "red",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/jupyter.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
21	_VIZ_PROCESSES: Dict[str, int] = {}
22	_DATABRICKS_HOST = "0.0.0.0"
23	
24	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/jupyter.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
134	        }
135	        viz_process = process_context.Process(
136	            target=run_process,
137	            daemon=False,
138	            args=run_process_args,
139	            kwargs={**run_process_kwargs},
140	        )

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/jupyter.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
141	    else:
142	        viz_process = process_context.Process(
143	            target=run_server, daemon=True, kwargs={**run_server_kwargs}
144	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/utils.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	    try:
78	        response = requests.get(url, timeout=10)
79	    except requests.ConnectionError:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/utils.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
85	def _is_port_in_use(host: str, port: int):
86	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
87	        return s.connect_ex((host, port)) == 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/utils.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
121	    """Check whether a host is a localhost"""
122	    return host in ("127.0.0.1", "localhost", "0.0.0.0")
123	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/launchers/utils.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
121	    """Check whether a host is a localhost"""
122	    return host in ("127.0.0.1", "localhost", "0.0.0.0")
123	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kedro_viz-11.0.0/kedro_viz-11.0.0/kedro_viz/server.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
170	
171	    viz_process = process_context.Process(
172	        target=run_process,
173	        daemon=False,
174	        args=run_process_args,
175	        kwargs={**run_process_kwargs},
176	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 4780
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 1.0
Files skipped (0):
