Run started:2025-04-12 16:53:58.865140

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/auth_policy_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	            return AsyncBearerTokenCredentialPolicy(
44	                credential, "https://communication.azure.com//.default"  # type: ignore
45	            )
46	        return BearerTokenCredentialPolicy(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/auth_policy_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        return BearerTokenCredentialPolicy(
47	            credential, "https://communication.azure.com//.default"  # type: ignore
48	        )
49	    if isinstance(credential, (AzureKeyCredential, str)):

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/policy.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
48	        if isinstance(self._access_key, AzureKeyCredential):
49	            decoded_secret = base64.b64decode(self._access_key.key)
50	        else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/policy.py:49
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
48	        if isinstance(self._access_key, AzureKeyCredential):
49	            decoded_secret = base64.b64decode(self._access_key.key)
50	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/policy.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
50	        else:
51	            decoded_secret = base64.b64decode(self._access_key)
52	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/policy.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
50	        else:
51	            decoded_secret = base64.b64decode(self._access_key)
52	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/policy.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
56	
57	        return base64.b64encode(digest).decode("utf-8")
58	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/policy.py:57
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
56	
57	        return base64.b64encode(digest).decode("utf-8")
58	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/policy.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
106	        ).digest()
107	        content_hash = base64.b64encode(content_digest).decode("utf-8")
108	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/policy.py:107
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
106	        ).digest()
107	        content_hash = base64.b64encode(content_digest).decode("utf-8")
108	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        raise ValueError(
42	            "Invalid connection string. You can get the connection string from your resource page in the Azure Portal. "
43	            "The format should be as follows: endpoint=https://<ResourceUrl>/;accesskey=<KeyValue>"
44	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/utils.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
85	    try:
86	        padded_base64_payload = base64.b64decode(parts[1] + "==").decode("ascii")
87	        payload = json.loads(padded_base64_payload)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/azure/communication/sms/_shared/utils.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
85	    try:
86	        padded_base64_payload = base64.b64decode(parts[1] + "==").decode("ascii")
87	        payload = json.loads(padded_base64_payload)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	    version = re.search(r'^VERSION\s*=\s*[\'"]([^\'"]*)[\'"]',
24	                        fd.read(), re.MULTILINE).group(1)
25	if not version:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	with open('README.md', encoding='utf-8') as f:
29	    long_description = f.read()
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/setup.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    long_description_content_type='text/markdown',
39	    url='https://github.com/Azure/azure-sdk-for-python',
40	    keywords="azure, azure sdk",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/_shared/communication_service_preparer.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    "communication",
12	    communication_livetest_dynamic_connection_string="endpoint=https://sanitized.communication.azure.com/;accesskey=fake===",
13	)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/_shared/helper.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
15	    expiry_json = f'{{"exp": {str(expires_on_epoch)} }}'
16	    base64expiry = base64.b64encode(expiry_json.encode("utf-8")).decode("utf-8").rstrip("=")
17	    token_template = f"""eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/_shared/helper.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
15	    expiry_json = f'{{"exp": {str(expires_on_epoch)} }}'
16	    base64expiry = base64.b64encode(expiry_json.encode("utf-8")).decode("utf-8").rstrip("=")
17	    token_template = f"""eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/_shared/utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	        raise ValueError(
70	            "Invalid connection string. You can get the connection string from your resource page in the Azure Portal. "
71	            "The format should be as follows: endpoint=https://<ResourceUrl>/;accesskey=<KeyValue>"
72	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/acs_sms_test_case.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        if self.is_playback():
24	            return "endpoint=https://sanitized.communication.azure.com/;accesskey=fake==="
25	        return os.getenv('COMMUNICATION_LIVETEST_STATIC_CONNECTION_STRING')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/test_sms_client.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	
53	        sms_client = SmsClient("https://endpoint", FakeTokenCredential(), transport=Mock(send=mock_send))
54	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/test_sms_client.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	
83	        sms_client = SmsClient("https://endpoint", FakeTokenCredential())
84	        sms_client.send(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/test_sms_client_async.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	
53	        sms_client = SmsClient("https://endpoint", FakeTokenCredential(), transport=Mock(send=mock_send))
54	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_communication_sms-1.1.0/azure_communication_sms-1.1.0/tests/test_sms_client_async.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	
83	        sms_client = SmsClient("https://endpoint", FakeTokenCredential())
84	        await sms_client.send(

--------------------------------------------------

Code scanned:
	Total lines of code: 2694
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 6.0
Files skipped (0):
