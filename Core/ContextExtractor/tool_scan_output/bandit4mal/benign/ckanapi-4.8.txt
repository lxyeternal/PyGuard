Run started:2025-04-12 12:55:43.094100

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/action.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	    if arguments['--input-json']:
25	        action_args = json.loads(stdin.read().decode('utf-8'))
26	    elif arguments['--input']:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/action.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	            action_args = json.loads(
30	                in_f.read().decode('utf-8') if sys.version_info.major == 2 else in_f.read())
31	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/action.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	            action_args = json.loads(
30	                in_f.read().decode('utf-8') if sys.version_info.major == 2 else in_f.read())
31	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/dump.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
90	            if not arguments['--quiet']:
91	                stderr.write('{0} {1} {2} {3} {4}\n'.format(
92	                    finished,
93	                    job_ids,
94	                    next(stats),
95	                    error,
96	                    record.get('name', '') if record else '',
97	                    ).encode('utf-8'))
98	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/dump.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	            if log:
100	                log.write(compact_json([
101	                    timestamp,
102	                    finished,
103	                    error,
104	                    record.get('name', '') if record else None,
105	                    ]) + b'\n')
106	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/dump.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	                    # sort keys so we can diff output
117	                    jsonl_output.write(compact_json(record,
118	                        sort_keys=True) + b'\n')
119	                expecting_number += 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/dump.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	        """
161	        stdout.write(compact_json([
162	            datetime.now().isoformat(),
163	            error,
164	            record]) + b'\n')
165	        stdout.flush()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	                # use either id or name to locate existing records
181	                name = obj.get('id')
182	                if name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
195	                        continue
196	                name = obj.get('name')
197	                if not existing and name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	            if not existing and arguments['--update-only']:
213	                reply('show', 'NotFound', [obj.get('id'), obj.get('name')])
214	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	            if not existing and arguments['--update-only']:
213	                reply('show', 'NotFound', [obj.get('id'), obj.get('name')])
214	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	            else:
242	                reply(act, None, r.get('name',r.get('id')))
243	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	            else:
242	                reply(act, None, r.get('name',r.get('id')))
243	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	    for resource in resources:
292	        if resource.get('url_type') != 'upload':
293	            continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	
295	        f = requests.get(resource['url'],stream=True)
296	        name = resource['url'].rsplit('/',1)[-1]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/load.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
311	    else:
312	        f = requests.get(obj['image_display_url'],stream=True)
313	        name,ext = obj['image_url'].rsplit('.',1)  #reformulate image_url for new site

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/main.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	                version=__version__,
132	                url='https://github.com/open-data/ckanapi'),
133	            get_only=arguments['--get-request'],

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/main.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	            for r in action(ckan, arguments):
165	                stdout.write(r)
166	            return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/main.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	        except CLIError as e:
168	            sys.stderr.write(e.args[0] + '\n')
169	            return 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/main.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
174	            ) and arguments['--processes'] != '1' and os.name == 'nt':
175	        sys.stderr.write(
176	            "multiple worker processes are not supported on windows\n")
177	        arguments['--processes'] = '1'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/search.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	    if arguments['--input-json']:
33	        action_args = json.loads(stdin.read().decode('utf-8'))
34	    elif arguments['--input']:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/search.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	            action_args = json.loads(
38	                in_f.read().decode('utf-8') if sys.version_info.major == 2 else in_f.read())
39	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/search.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	            action_args = json.loads(
38	                in_f.read().decode('utf-8') if sys.version_info.major == 2 else in_f.read())
39	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/cli/search.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
76	        for r in rows:
77	            jsonl_output.write(compact_json(r, sort_keys=True) + b'\n')
78	        if not rows or 'rows' in action_args:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	    try:
28	        r = requests.get(resource['url'], headers=headers, stream=True)
29	        with open(os.path.join(datapackage_dir, path), 'wb') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
31	                if chunk: # filter out keep-alive new chunks
32	                    f.write(chunk)
33	        return dict(resource, path=path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
34	    except requests.ConnectionError:
35	        stderr.write('URL {url} refused connection. The resource will not be downloaded\n'.format(url=resource['url']))
36	    except requests.exceptions.RequestException as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	    except requests.exceptions.RequestException as e:
37	        stderr.write(str(e.args[0]) if len(e.args) > 0 else '')
38	        stderr.write('\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37	        stderr.write(str(e.args[0]) if len(e.args) > 0 else '')
38	        stderr.write('\n')
39	    except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
39	    except Exception as e:
40	        stderr.write(str(e.args[0]) if len(e.args) > 0 else '')
41	    return resource

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    resource_formats_to_ignore = ['API', 'api']
50	    dataset_name = record.get('name', '')
51	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	    ckan_resources = []
57	    for resource in record.get('resources', []):
58	        if resource['format'] in resource_formats_to_ignore:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	
66	    for cres, dres in zip(ckan_resources, datapackage.get('resources', [])):
67	        filename = resource_filename(dres)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	    with open(json_path, 'wb') as out:
78	        out.write(pretty_json(datapackage))
79	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	            df = {'name': f['id']}
110	            dtyp = DATAPACKAGE_TYPES.get(f['type'])
111	            if dtyp:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	                df['type'] = dtyp
113	            dtit = f.get('info', {}).get('label', '')
114	            if dtit:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	                df['type'] = dtyp
113	            dtit = f.get('info', {}).get('label', '')
114	            if dtit:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	                df['title'] = dtit
116	            ddesc = f.get('info', {}).get('notes', '')
117	            if ddesc:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	                df['title'] = dtit
116	            ddesc = f.get('info', {}).get('notes', '')
117	            if ddesc:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	    """
128	    if not res.get('datastore_active', False):
129	        return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	
153	    if resource_dict.get('url'):
154	        resource['path'] = resource_dict['url']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	
157	    if resource_dict.get('description'):
158	        resource['description'] = resource_dict['description']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	
160	    if resource_dict.get('format'):
161	        resource['format'] = resource_dict['format']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	
163	    if resource_dict.get('hash'):
164	        resource['hash'] = resource_dict['hash']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	
166	    if resource_dict.get('name'):
167	        resource['name'] = slugify.slugify(resource_dict['name']).lower()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	
172	    schema = resource_dict.get('schema')
173	    if isinstance(schema, six.string_types):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	
210	    resources = dataset_dict.get('resources')
211	    if resources:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	    names = {}
217	    for resource in dp.get('resources', []):
218	        if resource['name'] in names.keys():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	
232	        if the_dict.get(original_key):
233	            result[destination_key] = the_dict[original_key]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	
242	    if dataset_dict.get('ckan_url'):
243	        result['homepage'] = dataset_dict['ckan_url']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	
251	    if dataset_dict.get('notes'):
252	        result['description'] = dataset_dict['notes']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	
261	    if dataset_dict.get('license_id'):
262	        license['type'] = dataset_dict['license_id']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	        license['type'] = dataset_dict['license_id']
263	    if dataset_dict.get('license_title'):
264	        license['title'] = dataset_dict['license_title']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
264	        license['title'] = dataset_dict['license_title']
265	    if dataset_dict.get('license_url'):
266	        license['url'] = dataset_dict['license_url']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	
278	    if dataset_dict.get('author'):
279	        source['name'] = dataset_dict['author']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
279	        source['name'] = dataset_dict['author']
280	    if dataset_dict.get('author_email'):
281	        source['email'] = dataset_dict['author_email']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
281	        source['email'] = dataset_dict['author_email']
282	    if dataset_dict.get('url'):
283	        source['web'] = dataset_dict['url']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	
295	    if dataset_dict.get('maintainer'):
296	        author['name'] = dataset_dict['maintainer']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	        author['name'] = dataset_dict['maintainer']
297	    if dataset_dict.get('maintainer_email'):
298	        author['email'] = dataset_dict['maintainer_email']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
308	
309	    keywords = [tag['name'] for tag in dataset_dict.get('tags', [])]
310	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/datapackage.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	    extras = [[extra['key'], extra['value']] for extra
321	              in dataset_dict.get('extras', [])]
322	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/localckan.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
90	            break
91	        out.write(chunk)
92	    return out

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/remoteckan.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
14	# add your sites to remove parallel limits on ckanapi cli
15	MY_SITES = ['localhost', '127.0.0.1', '[::1]']
16	CKANAPI_MY_SITES = os.getenv('CKANAPI_MY_SITES')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/remoteckan.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	                version=__version__,
50	                url='https://github.com/ckan/ckanapi')
51	        self.user_agent = user_agent

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/remoteckan.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	        if self.get_only:
94	            status, response = self._request_fn_get(url, data_dict, headers, requests_kwargs)
95	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/remoteckan.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
99	    def _request_fn(self, url, data, headers, files, requests_kwargs):
100	        r = self.session.post(url, data=data, headers=headers, files=files,
101	            allow_redirects=False, **requests_kwargs)
102	        # allow_redirects=False because: if a post is redirected (e.g. 301 due

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/remoteckan.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	    def _request_fn_get(self, url, data_dict, headers, requests_kwargs):
110	        r = self.session.get(url, params=data_dict, headers=headers,
111	            **requests_kwargs)
112	        return r.status_code, r.text

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/testappckan.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	                    filename = fieldname
51	                upload_files.append( (fieldname, filename, file_.read()) )
52	            kwargs['upload_files'] = upload_files

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_dump.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	                             'datastore_active': True,
39	                             'url': 'https://google.com'}]}},
40	                'group_show': {
41	                    'ab': {'title': "ABBA"}},
42	                'organization_show': {
43	                    'cd': {'title': "Super Trouper"}},
44	                'datastore_search': {

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_dump.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
306	        finally:
307	            shutil.rmtree(target)
308	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_dump.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
346	                    'id': 'd902fafc-5717-4dd0-87f2-7a6fc96989b7',
347	                    'url': 'https://google.com',
348	                    'datastore_active': True,
349	                    'resource_views': [{
350	                        'description': 'Test view',
351	                        'filterable': True,
352	                        'id': 'd902fafc-5717-4dd0-87f2-7a6fc96989d9',
353	                        'package_id': 'dp',
354	                        'resource_id': 'd902fafc-5717-4dd0-87f2-7a6fc96989b7',
355	                        'responsive': True,
356	                        'show_fields': ['_id']
357	                    }]
358	                }]
359	            })
360	        finally:
361	            shutil.rmtree(target)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_dump.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
360	        finally:
361	            shutil.rmtree(target)
362	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
21	    def stdout_write(self, data):
22	        self.stdout_inside.write(data)
23	        self.stdout_inside.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37	            # need to respond or pool will block test
38	            child.stdout_write(b'AA\n')
39	            children.append(child)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	        self.assertEqual(c.stdin_readline(), b'job2\n')
52	        c.stdout_write(b'BB\n')
53	        self.assertEqual(next(pool), ([None], 1, b'BB\n'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	            if not children:
63	                child.stdout_write(b'AA\n')
64	            children.append(child)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	        self.assertEqual(c0.stdin_readline(), b'job3\n')
78	        c1.stdout_write(b'BB\n')
79	        self.assertEqual(next(pool), ([2, 3], 1, b'BB\n'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	        self.assertEqual(c1.stdin_readline(), b'job4\n')
81	        c0.stdout_write(b'CC\n')
82	        self.assertEqual(next(pool), ([None, 3], 2, b'CC\n'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	        self.assertEqual(next(pool), ([None, 3], 2, b'CC\n'))
83	        c1.stdout_write(b'DD\n')
84	        self.assertEqual(next(pool), ([None, None], 3, b'DD\n'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	            if children:
94	                child.stdout_write(b'AA\n')
95	            children.append(child)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
108	        self.assertEqual(c1.stdin_readline(), b'job3\n')
109	        c1.stdout_write(b'BB\n')
110	        self.assertEqual(next(pool), ([0, 3], 2, b'BB\n'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	        self.assertEqual(c1.stdin_readline(), b'job4\n')
112	        c1.stdout_write(b'CC\n')
113	        self.assertEqual(next(pool), ([0, None], 3, b'CC\n'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	        self.assertEqual(next(pool), ([0, None], 3, b'CC\n'))
114	        c0.stdout_write(b'DD\n')
115	        self.assertEqual(next(pool), ([None, None], 0, b'DD\n'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
123	            if not children:
124	                child.stdout_write(b'AA\n')
125	            children.append(child)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
144	            if not children:
145	                child.stdout_write(b'AA\n')
146	            children.append(child)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_cli_workers.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	        # need to write in advance to avoid blocking test
161	        c0.stdout_write(b'BB\n')
162	        response = pool.send(enumerate((b"job2\n", b"job3\n"), 1))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	                u'name': u'Image 1',
23	                u'url': u'http://example.com/image.png',
24	                }],
25	            u'tags': [{
26	                u'display_name': u'science',
27	                u'id': u'59f9359c-002b-4166-a519-755f89a631da',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	                            u'name': u'image-1',
44	                            u'path': u'http://example.com/image.png',
45	                            u'title': u'Image 1'}],
46	            u'title': u'Test Dataset'}
47	
48	    def test_full_dataset(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	                u'id': u'aa878f8c-1f6e-4e87-b08e-67272d9c3d16',
80	                u'image_url': u'http://placekitten.com/g/200/100',
81	                u'is_organization': True,
82	                u'name': u'test_org_00',
83	                u'revision_id': u'bb31cfee-aee9-4031-9333-ed922bf3f049',
84	                u'state': u'active',
85	                u'title': u'Test Organization',
86	                u'type': u'organization'},
87	            u'owner_org': u'aa878f8c-1f6e-4e87-b08e-67272d9c3d16',
88	            u'private': False,
89	            u'relationships_as_object': [],
90	            u'relationships_as_subject': [],
91	            u'resources': [{
92	                u'cache_last_updated': None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	                u'state': u'active',
109	                u'url': u'http://example.com/image.png',
110	                u'url_type': None}],
111	            u'revision_id': u'990df889-690c-412e-a7ad-f848c9927218',
112	            u'state': u'active',
113	            u'tags': [{
114	                u'display_name': u'science',
115	                u'id': u'59f9359c-002b-4166-a519-755f89a631da',
116	                u'name': u'science',
117	                u'state': u'active',
118	                u'vocabulary_id': None}],
119	            u'title': u'Test Dataset',
120	            u'type': u'dataset',
121	            u'url': None,
122	            u'version': None
123	        }
124	
125	        datapackage = dataset_to_datapackage(dataset_dict)
126	
127	        assert datapackage == {
128	            u'description': u'Just another test dataset.',
129	            u'extras': {u'subject': u'science'},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	                            u'name': u'image-1',
134	                            u'path': u'http://example.com/image.png',
135	                            u'title': u'Image 1'}],
136	            u'title': u'Test Dataset'}
137	
138	    def test_resource_names_are_unique(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
146	                    u'name': u'Image',
147	                    u'url': u'http://example.com/imageA.png',
148	                },
149	                {
150	                    u'format': u'PNG',
151	                    u'name': u'Image',
152	                    u'url': u'http://example.com/imageB.png',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	                    u'name': u'Image',
152	                    u'url': u'http://example.com/imageB.png',
153	                },
154	                {
155	                    u'format': u'PNG',
156	                    u'name': u'Image',
157	                    u'url': u'http://example.com/imageC.png',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
156	                    u'name': u'Image',
157	                    u'url': u'http://example.com/imageC.png',
158	                },
159	                ],
160	            u'tags': [{
161	                u'display_name': u'science',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	            u'name': u'Image',
183	            u'url': u'http://example.com/image.png',
184	        }
185	        filename = 'image_saved.png'
186	        os.makedirs('/test/data')
187	        stderr = BytesIO()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
195	        stderr.seek(0)
196	        assert not stderr.read()
197	        assert returned_resource == {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	        assert returned_resource == {
198	            u'url': u'http://example.com/image.png',
199	            u'name': u'Image',
200	            u'format': u'PNG',
201	            u'path': u'data/image_saved.png',
202	        }
203	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
216	                u'name': u'Image 1',
217	                u'url': u'http://example.com/image.png',
218	                }],
219	            u'tags': [{
220	                u'display_name': u'science',
221	                u'id': u'59f9359c-002b-4166-a519-755f89a631da',

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
235	        stderr.seek(0)
236	        assert not stderr.read()
237	        assert datapackage_dir == u'/test/test_dataset_00'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_datapackage.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	            u'name': u'Buildings 1',
271	            u'url': u'http://example.com/buildings.csv',
272	            # example datastore fields from:
273	            # curl 'https://data.boston.gov/api/3/action/datastore_search?resource_id=28ca9f8d-f6ad-4855-bf14-90d2d0bc85ca&limit=0' |jq '.result.fields'
274	            u'datastore_fields': [
275	                {
276	                    u'id': u'country',
277	                    u'type': u'int',
278	                    u'info': {
279	                        u'label': u'The country',
280	                        u'notes': u'iso code',
281	                    }
282	                },
283	                {
284	                    u'id': u'NUM_FLOORS',
285	                    u'type': u'text',
286	                    u'info': {
287	                        u'type_override': {}
288	                    },
289	                }
290	            ]
291	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_remote.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	
26	TEST_CKAN = 'http://localhost:8901'
27	
28	NUMBER_THING_CSV = """

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_remote.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
48	            try:
49	                r = urlopen(TEST_CKAN + '/api/action/site_read')
50	                if r.getcode() == 200:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_remote.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
60	            ['aa', 'bb', 'cc'])
61	        ckan.close()
62	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_remote.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    def test_custom_ua(self):
82	        ua = 'testckanapibot/1.0 (+https://github.com/ckan/ckanapi)'
83	        with RemoteCKAN(TEST_CKAN, user_agent=ua) as ckan:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_remote.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	                files={'upload': StringIO(NUMBER_THING_CSV)})
96	        self.assertEqual(res.get('last_row'), ['5', 'sasquach'])
97	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_remote.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	                files={'upload': StringIO(NUMBER_THING_CSV)})
103	        self.assertEqual(res.get('option'), "42")
104	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/ckanapi/tests/test_remote.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	                files={'upload': StringIO(NUMBER_THING_CSV)})
111	        self.assertEqual(res.get('option'), uname)
112	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ckanapi-4.8/ckanapi-4.8/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	    author_email='ian@excess.org',
30	    url='https://github.com/ckan/ckanapi',
31	    packages=[

--------------------------------------------------

Code scanned:
	Total lines of code: 3668
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 88.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 108.0
		High: 0.0
Files skipped (0):
