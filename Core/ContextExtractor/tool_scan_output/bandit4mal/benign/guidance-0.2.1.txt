Run started:2025-04-12 11:19:56.324239

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/_parser.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
47	        )
48	        self._threadpool = ThreadPoolExecutor(max_workers=1)
49	        self._generator = self._parse(prompt, ensure_bos_token)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
22	    if isinstance(src, str) and re.match(r"[^:/]+://", src):
23	        with urllib.request.urlopen(src) as response:
24	            response = cast(http.client.HTTPResponse, response)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_audio.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
12	    bytes_data = bytes_from(src, allow_local=allow_local)
13	    base64_string = base64.b64encode(bytes_data).decode('utf-8')
14	    lm += AudioBlob(data=base64_string)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_audio.py:13
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
12	    bytes_data = bytes_from(src, allow_local=allow_local)
13	    base64_string = base64.b64encode(bytes_data).decode('utf-8')
14	    lm += AudioBlob(data=base64_string)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_image.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
18	        bytes_data = bytes_from(src, allow_local=allow_local)
19	        base64_string = base64.b64encode(bytes_data).decode('utf-8')
20	        lm += ImageBlob(data=base64_string)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_image.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
18	        bytes_data = bytes_from(src, allow_local=allow_local)
19	        base64_string = base64.b64encode(bytes_data).decode('utf-8')
20	        lm += ImageBlob(data=base64_string)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_image.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
30	        bytes_data = f.read()
31	        base64_string = base64.b64encode(bytes_data).decode('utf-8')
32	        lm += ImageOutput(value=base64_string, is_input=False)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_image.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
30	        bytes_data = f.read()
31	        base64_string = base64.b64encode(bytes_data).decode('utf-8')
32	        lm += ImageOutput(value=base64_string, is_input=False)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_video.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
15	    bytes_data = bytes_from(src, allow_local=allow_local)
16	    base64_string = base64.b64encode(bytes_data).decode('utf-8')
17	    lm += VideoOutput(value=base64_string, is_input=True)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_video.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
15	    bytes_data = bytes_from(src, allow_local=allow_local)
16	    base64_string = base64.b64encode(bytes_data).decode('utf-8')
17	    lm += VideoOutput(value=base64_string, is_input=True)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_video.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
28	        bytes_data = f.read()
29	        base64_string = base64.b64encode(bytes_data).decode('utf-8')
30	        lm += VideoOutput(value=base64_string, is_input=False)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/library/_video.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
28	        bytes_data = f.read()
29	        base64_string = base64.b64encode(bytes_data).decode('utf-8')
30	        lm += VideoOutput(value=base64_string, is_input=False)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/metrics/_metrics.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
186	
187	    p = psutil.Process()
188	    try:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/metrics/_metrics.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
249	    def start(self):
250	        self.process = Process(
251	            target=_monitor_fn, args=(self.stop_flag, self.metrics_dict, self.max_size)
252	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_base/_client.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
62	        image_bytes = bytes_from(node.url, allow_local=False)
63	        base64_string = base64.b64encode(image_bytes).decode("utf-8")
64	        return self.image_blob(state, ImageBlob(data=base64_string), **kwargs)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_base/_client.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
62	        image_bytes = bytes_from(node.url, allow_local=False)
63	        base64_string = base64.b64encode(image_bytes).decode("utf-8")
64	        return self.image_blob(state, ImageBlob(data=base64_string), **kwargs)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_base/_model.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
357	        # Start the thread
358	        thread = threading.Thread(target=target, args=(copy_context(),))
359	        thread.start()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_engine/_client.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
107	
108	        image_bytes = b64decode(node.data)
109	        pil_image = PIL.Image.open(BytesIO(image_bytes))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_engine/_client.py:108
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
107	
108	        image_bytes = b64decode(node.data)
109	        pil_image = PIL.Image.open(BytesIO(image_bytes))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_engine/_client.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
124	
125	        image_bytes = b64decode(node.data)
126	        pil_image = PIL.Image.open(BytesIO(image_bytes))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_engine/_client.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
124	
125	        image_bytes = b64decode(node.data)
126	        pil_image = PIL.Image.open(BytesIO(image_bytes))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_grammarless.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
248	        self._num_calls_made += 1
249	        self._model_interaction_thread = threading.Thread(
250	            target=self._start_generator_stream, args=(generator,)
251	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_llama_cpp.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	                    with open(os.path.expanduser("~/.llama_cpp_model"), "r") as file:
158	                        model = file.read().replace("\n", "")
159	                except:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_llama_cpp.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	                logger.warn(
176	                    "Cannot use verbose=True in this context (probably CoLab). See https://github.com/abetlen/llama-cpp-python/issues/729"
177	                )
178	                kwargs["verbose"] = True  # llama-cpp-python can't hide output in this case

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_openai.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
332	                wav_file.setframerate(22050)  # A guess
333	                wav_file.writeframes(base64.b64decode(audio.data))
334	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_openai.py:333
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
332	                wav_file.setframerate(22050)  # A guess
333	                wav_file.writeframes(base64.b64decode(audio.data))
334	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_openai.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
336	            wav_bytes = wav_buffer.getvalue()
337	            yield AudioOutput(value=base64.b64encode(wav_bytes).decode(), is_input=False)
338	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_openai.py:337
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
336	            wav_bytes = wav_buffer.getvalue()
337	            yield AudioOutput(value=base64.b64encode(wav_bytes).decode(), is_input=False)
338	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_openai.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
348	
349	        image_bytes = base64.b64decode(node.data)
350	        with PIL.Image.open(BytesIO(image_bytes)) as pil_image:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_openai.py:349
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
348	
349	        image_bytes = base64.b64decode(node.data)
350	        with PIL.Image.open(BytesIO(image_bytes)) as pil_image:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_openai.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
365	        image_bytes = bytes_from(node.url, allow_local=False)
366	        base64_string = base64.b64encode(image_bytes).decode("utf-8")
367	        yield ImageOutput(value=base64_string, input=True)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_openai.py:366
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
365	        image_bytes = bytes_from(node.url, allow_local=False)
366	        base64_string = base64.b64encode(image_bytes).decode("utf-8")
367	        yield ImageOutput(value=base64_string, input=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/models/_transformers.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
404	                with open(os.path.expanduser("~/.transformers_model"), "r") as file:
405	                    model = file.read().replace("\n", "")
406	            except:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/visual/_trace.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
157	        elif isinstance(node.output, ImageOutput):
158	            encoded = base64.b64encode(node.output.value).decode()
159	            buffer.append(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/guidance/visual/_trace.py:158
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
157	        elif isinstance(node.output, ImageOutput):
158	            encoded = base64.b64encode(node.output.value).decode()
159	            buffer.append(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/setup.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
100	    with codecs.open(os.path.join(here, *parts), "r") as fp:
101	        return fp.read()
102	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/setup.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
104	def find_version(*file_paths):
105	    version_file = read(*file_paths)
106	    version_match = re.search(r"^__version__ = ['\"]([^'\"]*)['\"]", version_file, re.M)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/guidance-0.2.1/guidance-0.2.1/setup.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	    version=find_version("guidance", "__init__.py"),
115	    url="https://github.com/guidance-ai/guidance",
116	    author="Guidance Maintainers",

--------------------------------------------------

Code scanned:
	Total lines of code: 7358
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 13.0
Files skipped (0):
