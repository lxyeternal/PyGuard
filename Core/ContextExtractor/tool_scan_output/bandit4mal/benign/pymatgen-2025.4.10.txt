Run started:2025-04-12 15:08:20.467546

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/alchemy/materials.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
371	                    "name": snl_metadata.pop("name", "pymatgen"),
372	                    "url": snl_metadata.pop("url", "http://pypi.python.org/pypi/pymatgen"),
373	                    "description": hist,

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/alchemy/transmuters.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
122	        if self.ncores and transformation.use_multiprocessing:
123	            with Pool(self.ncores) as pool:
124	                # need to condense arguments into single tuple to use map

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/alchemy/transmuters.py:123
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
122	        if self.ncores and transformation.use_multiprocessing:
123	            with Pool(self.ncores) as pool:
124	                # need to condense arguments into single tuple to use map

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/alchemy/transmuters.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
276	            with open(filename, encoding="utf-8") as file:
277	                cif_files.append(file.read())
278	        return cls(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/alchemy/transmuters.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
315	            with open(filename, encoding="utf-8") as file:
316	                trafo_structs.append(TransformedStructure.from_poscar_str(file.read(), []))
317	        return StandardTransmuter(trafo_structs, transformations, extend_collection=extend_collection)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/analysis/local_env.py:1429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1428	        openbabel,
1429	        "BabelMolAdaptor requires openbabel to be installed with "
1430	        "Python bindings. Please get it at https://openbabel.org "
1431	        "(version >=3.0.0).",
1432	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/analysis/molecule_matcher.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
568	        openbabel,
569	        "BabelMolAdaptor requires openbabel to be installed with Python "
570	        "bindings. Please get it at https://openbabel.org (version >=3.0.0).",
571	    )
572	    def __init__(self, tolerance: float = 0.01, mapper=None) -> None:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/analysis/pourbaix_diagram.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
651	            func = partial(self.process_multientry, prod_comp=tot_comp)
652	            with Pool(nproc) as proc_pool:
653	                multi_entries = list(proc_pool.imap(func, all_combos))

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/analysis/pourbaix_diagram.py:652
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
651	            func = partial(self.process_multientry, prod_comp=tot_comp)
652	            with Pool(nproc) as proc_pool:
653	                multi_entries = list(proc_pool.imap(func, all_combos))

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/analysis/pourbaix_diagram.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
700	            func = partial(self.process_multientry, prod_comp=total_comp)
701	            with Pool(nproc) as proc_pool:
702	                processed_entries = list(proc_pool.imap(func, entry_combos))

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/analysis/pourbaix_diagram.py:701
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
700	            func = partial(self.process_multientry, prod_comp=total_comp)
701	            with Pool(nproc) as proc_pool:
702	                processed_entries = list(proc_pool.imap(func, entry_combos))

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/apps/borg/queen.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
71	        logger.info(f"{len(valid_paths)} valid paths found.")
72	        with Pool(self._num_drones) as pool:
73	            pool.map(

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/apps/borg/queen.py:72
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
71	        logger.info(f"{len(valid_paths)} valid paths found.")
72	        with Pool(self._num_drones) as pool:
73	            pool.map(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/cli/pmg_config.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
49	            try:
50	                chunks = chunk(file.read())
51	            except IndexError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/cli/pmg_config.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
72	            try:
73	                chunks = chunk(file.read())
74	            except IndexError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/cli/pmg_config.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	    try:
181	        subprocess.call(["git", "clone", "--recursive", "https://github.com/msg-byu/enumlib"])
182	        os.chdir(f"{cwd}/enumlib/symlib/src")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/cli/pmg_config.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
194	        os.chdir(cwd)
195	        shutil.rmtree("enumlib")
196	    return state

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/cli/pmg_config.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
204	    """
205	    bader_url = "https://theory.cm.utexas.edu/henkelman/code/bader/download/bader.tar.gz"
206	    cwd = os.getcwd()

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/cli/pmg_config.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
208	    try:
209	        urlretrieve(bader_url, "bader.tar.gz")  # noqa: S310
210	        subprocess.call(["/usr/bin/tar", "-zxf", "bader.tar.gz"])

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/cli/pmg_config.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
215	        os.chdir("..")
216	        shutil.rmtree("bader")
217	        os.remove("bader.tar.gz")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/bader_caller.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	            raise RuntimeError(
121	                "Requires bader or bader.exe to be in the PATH or the absolute path to "
122	                f"the binary to be specified via {bader_path=}.\n"
123	                "Download from https://theory.cm.utexas.edu/henkelman/code/bader."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/chargemol_caller.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	            raise OSError(
104	                "ChargemolAnalysis requires the Chargemol executable to be in PATH."
105	                " Please download the library at https://sourceforge.net/projects/ddec/files"
106	                "and follow the instructions."

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/chargemol_caller.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
393	        # This is to fix a Chargemol filepath nuance
394	        if platform.system() == "Windows":
395	            if atomic_densities_path[-1] != "\\":

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/chargemol_caller.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
393	        # This is to fix a Chargemol filepath nuance
394	        if platform.system() == "Windows":
395	            if atomic_densities_path[-1] != "\\":

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/chargemol_caller.py:394
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
393	        # This is to fix a Chargemol filepath nuance
394	        if platform.system() == "Windows":
395	            if atomic_densities_path[-1] != "\\":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/chargemol_caller.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
412	        with open("job_control.txt", mode="w", encoding="utf-8") as file:
413	            file.write(lines)
414	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/chargemol_caller.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
412	        with open("job_control.txt", mode="w", encoding="utf-8") as file:
413	            file.write(lines)
414	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/critic2_caller.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	        with open("input_script.cri", mode="w", encoding="utf-8") as file:
99	            file.write(input_script)
100	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/critic2_caller.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
98	        with open("input_script.cri", mode="w", encoding="utf-8") as file:
99	            file.write(input_script)
100	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/critic2_caller.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        which("critic2"),
85	        "Critic2Caller requires the executable critic to be in the path. "
86	        "Please follow the instructions at https://github.com/aoterodelaroza/critic2.",
87	    )
88	    def __init__(self, input_script: str):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/enumlib_caller.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
284	        with open("struct_enum.in", mode="w", encoding="utf-8") as file:
285	            file.write("\n".join(output))
286	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/enumlib_caller.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
284	        with open("struct_enum.in", mode="w", encoding="utf-8") as file:
285	            file.write("\n".join(output))
286	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/enumlib_caller.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
369	            with open(file, encoding="utf-8") as _file:
370	                data = _file.read()
371	                data = re.sub(r"scale factor", "1", data)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/enumlib_caller.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    ENUM_CMD and MAKESTR_CMD,
60	    "EnumlibAdaptor requires the executables 'enum.x' or 'multienum.x' "
61	    "and 'makestr.x' or 'makeStr.py' to be in the path. Please download the "
62	    "library at https://github.com/msg-byu/enumlib and follow the instructions "
63	    "in the README to compile these two executables accordingly.",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/gulp_caller.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
514	                    return
515	        raise GulpError("Executable not found, please download from https://gulp.curtin.edu.au/index.html.")
516	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/mcsqs_caller.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	        with open("sqscell.out", mode="w", encoding="utf-8") as file:
98	            file.write("1\n1 0 0\n0 1 0\n0 0 1\n")
99	        structure *= scaling

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/mcsqs_caller.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
97	        with open("sqscell.out", mode="w", encoding="utf-8") as file:
98	            file.write("1\n1 0 0\n0 1 0\n0 0 1\n")
99	        structure *= scaling

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/mcsqs_caller.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    which("mcsqs") and which("str2cif"),
35	    "run_mcsqs requires first installing AT-AT, see https://www.brown.edu/Departments/Engineering/Labs/avdw/atat/",
36	)
37	def run_mcsqs(
38	    structure: Structure,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/command_line/vampire_caller.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        VAMP_EXE,
57	        "VampireCaller requires vampire-serial to be in the path."
58	        "Please follow the instructions at https://vampire.york.ac.uk/download/.",
59	    )
60	    def __init__(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
932	                traj_file = opt_kwargs["trajectory"]
933	                traj_observer = read(traj_file, index=":")
934	            return system, traj_observer  # type: ignore[reportPossiblyUnboundVariable]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:2964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2963	                with zopen(filename, mode="wt", encoding="utf-8") as file:
2964	                    file.write(json_str)
2965	            return json_str

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:2973
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2972	                with zopen(filename, mode="wt", encoding="utf-8") as file:
2973	                    file.write(res_str)
2974	            return res_str

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:2987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2986	                with zopen(filename, mode="wt", encoding="ascii") as file:
2987	                    file.write(res_str)
2988	            return res_str

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:3002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3001	                with zopen(filename, mode="wt", encoding="utf-8") as file:
3002	                    file.write(yaml_str)
3003	            return yaml_str

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:3011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3010	                with zopen(filename, mode="wt", encoding="utf-8") as file:
3011	                    file.write(geom_in.get_header(filename))
3012	                    file.write(geom_in.content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:3012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3011	                    file.write(geom_in.get_header(filename))
3012	                    file.write(geom_in.content)
3013	                    file.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:3013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3012	                    file.write(geom_in.content)
3013	                    file.write("\n")
3014	            return geom_in.content

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:3028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3027	                with zopen(filename, mode="wt", encoding="utf-8") as file:
3028	                    file.write(res_str)
3029	            return res_str

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:3193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3192	        with zopen(filename, mode="rt", errors="replace", encoding="utf-8") as file:
3193	            contents = file.read()
3194	        if fnmatch(fname.lower(), "*.cif*") or fnmatch(fname.lower(), "*.mcif*"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:4016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4015	                with zopen(filename, mode="wt", encoding="utf-8") as file:
4016	                    file.write(json_str)
4017	            return json_str

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:4025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4024	                with zopen(filename, mode="wt", encoding="utf-8") as file:
4025	                    file.write(yaml_str)
4026	            return yaml_str

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/structure.py:4107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4106	        with zopen(filename, mode="rt", encoding="utf-8") as file:
4107	            contents = file.read()
4108	        fname = filename.lower()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/surface.py:1993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1992	        spg_analyzer = SpacegroupAnalyzer(structure)
1993	        system = spg_analyzer.get_crystal_system()
1994	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/surface.py:2056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2055	    spg_analyzer = SpacegroupAnalyzer(structure)
2056	    if spg_analyzer.get_crystal_system() == "trigonal":
2057	        transf = spg_analyzer.get_conventional_to_primitive_transformation_matrix()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/surface.py:2073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2072	        if not _is_in_miller_family(miller, unique_millers, symm_ops):
2073	            if spg_analyzer.get_crystal_system() == "trigonal":
2074	                # Now we find the distinct primitive hkls using

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/surface.py:2085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2084	
2085	    if return_hkil and spg_analyzer.get_crystal_system() in {"trigonal", "hexagonal"}:
2086	        return [(hkl[0], hkl[1], -1 * hkl[0] - hkl[1], hkl[2]) for hkl in unique_millers_conv]

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/tensors.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
424	        conv_latt = Lattice(np.transpose(np.dot(np.transpose(structure.lattice.matrix), np.linalg.inv(trans_mat))))
425	        xtal_sys = sga.get_crystal_system()
426	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/trajectory.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
477	        with zopen(filename, mode="wt", encoding="utf-8") as file:
478	            file.write(xdatcar_str)
479	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/trajectory.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
477	        with zopen(filename, mode="wt", encoding="utf-8") as file:
478	            file.write(xdatcar_str)
479	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/trajectory.py:873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
872	            with AseTrajectory(ase_traj_file, "a" if idx > 0 else "w", atoms=atoms) as _traj_file:
873	                _traj_file.write()
874	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/core/trajectory.py:873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
872	            with AseTrajectory(ase_traj_file, "a" if idx > 0 else "w", atoms=atoms) as _traj_file:
873	                _traj_file.write()
874	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        which("x_trans"),
68	        "BoltztrapRunner requires the executables 'x_trans' to be in PATH. Please download "
69	        "BoltzTraP at https://www.tuwien.at/en/tch/tc/theoretical-materials-chemistry/boltztrap "
70	        "and follow the instructions in the README to compile BoltzTraP accordingly. "
71	        "Then add x_trans to your path",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
260	        with open(output_file, mode="w", encoding="utf-8") as file:
261	            file.write("test\n")
262	            file.write(f"{len(self._bs.kpoints)}\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
260	        with open(output_file, mode="w", encoding="utf-8") as file:
261	            file.write("test\n")
262	            file.write(f"{len(self._bs.kpoints)}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
261	            file.write("test\n")
262	            file.write(f"{len(self._bs.kpoints)}\n")
263	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
261	            file.write("test\n")
262	            file.write(f"{len(self._bs.kpoints)}\n")
263	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
274	                    a, b, c = kpt.frac_coords
275	                    file.write(f"{a:12.8f} {b:12.8f} {c:12.8f}{len(eigs)}\n")
276	                    for e in eigs:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
274	                    a, b, c = kpt.frac_coords
275	                    file.write(f"{a:12.8f} {b:12.8f} {c:12.8f}{len(eigs)}\n")
276	                    for e in eigs:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
276	                    for e in eigs:
277	                        file.write(f"{sign * float(e):18.8f}\n")
278	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
276	                    for e in eigs:
277	                        file.write(f"{sign * float(e):18.8f}\n")
278	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
301	                    a, b, c = kpt.frac_coords
302	                    file.write(f"{a:12.8f} {b:12.8f} {c:12.8f} {len(eigs)}\n")
303	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
301	                    a, b, c = kpt.frac_coords
302	                    file.write(f"{a:12.8f} {b:12.8f} {c:12.8f} {len(eigs)}\n")
303	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
304	                    for e in eigs:
305	                        file.write(f"{float(e):18.8f}\n")
306	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
304	                    for e in eigs:
305	                        file.write(f"{float(e):18.8f}\n")
306	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
317	            if self._symprec is not None:
318	                file.write(f"{self._bs.structure.formula} {sym.get_space_group_symbol()}\n")  # type: ignore[reportPossiblyUnboundVariable]
319	            else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
317	            if self._symprec is not None:
318	                file.write(f"{self._bs.structure.formula} {sym.get_space_group_symbol()}\n")  # type: ignore[reportPossiblyUnboundVariable]
319	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
319	            else:
320	                file.write(f"{self._bs.structure.formula} symmetries disabled\n")
321	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
319	            else:
320	                file.write(f"{self._bs.structure.formula} symmetries disabled\n")
321	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
321	
322	            file.write(
323	                "\n".join(
324	                    " ".join(f"{Length(i, 'ang').to('bohr'):.5f}" for i in row)
325	                    for row in self._bs.structure.lattice.matrix
326	                )
327	                + "\n"
328	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
321	
322	            file.write(
323	                "\n".join(
324	                    " ".join(f"{Length(i, 'ang').to('bohr'):.5f}" for i in row)
325	                    for row in self._bs.structure.lattice.matrix
326	                )
327	                + "\n"
328	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
331	
332	            file.write(f"{len(ops)}\n")
333	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
331	
332	            file.write(f"{len(ops)}\n")
333	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
335	                for row in op:
336	                    file.write(f"{' '.join(map(str, row))}\n")
337	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
335	                for row in op:
336	                    file.write(f"{' '.join(map(str, row))}\n")
337	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
349	                so = "so"
350	            file.write(
351	                "5, 'boltztrap.intrans',      'old',    'formatted',0\n"
352	                "6,'boltztrap.outputtrans',      'unknown',    "
353	                "'formatted',0\n"
354	                "20,'boltztrap.struct',         'old',    'formatted',0\n"
355	                f"10,'boltztrap.energy{so}',         'old',    "
356	                "'formatted',0\n48,'boltztrap.engre',         'unknown',    "

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
349	                so = "so"
350	            file.write(
351	                "5, 'boltztrap.intrans',      'old',    'formatted',0\n"
352	                "6,'boltztrap.outputtrans',      'unknown',    "
353	                "'formatted',0\n"
354	                "20,'boltztrap.struct',         'old',    'formatted',0\n"
355	                f"10,'boltztrap.energy{so}',         'old',    "
356	                "'formatted',0\n48,'boltztrap.engre',         'unknown',    "

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
379	                    with open(f"{output_file_proj}_{site_nb}_{orb}", mode="w", encoding="utf-8") as file:
380	                        file.write(f"{self._bs.structure.formula}\n")
381	                        file.write(f"{len(self._bs.kpoints)}\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
379	                    with open(f"{output_file_proj}_{site_nb}_{orb}", mode="w", encoding="utf-8") as file:
380	                        file.write(f"{self._bs.structure.formula}\n")
381	                        file.write(f"{len(self._bs.kpoints)}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
380	                        file.write(f"{self._bs.structure.formula}\n")
381	                        file.write(f"{len(self._bs.kpoints)}\n")
382	                        for kpt_idx, kpt in enumerate(self._bs.kpoints):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
380	                        file.write(f"{self._bs.structure.formula}\n")
381	                        file.write(f"{len(self._bs.kpoints)}\n")
382	                        for kpt_idx, kpt in enumerate(self._bs.kpoints):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
393	                            a, b, c = kpt.frac_coords
394	                            file.write(f"{a:12.8f} {b:12.8f} {c:12.8f} {len(tmp_proj)}\n")
395	                            for t in tmp_proj:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
393	                            a, b, c = kpt.frac_coords
394	                            file.write(f"{a:12.8f} {b:12.8f} {c:12.8f} {len(tmp_proj)}\n")
395	                            for t in tmp_proj:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
395	                            for t in tmp_proj:
396	                                file.write(f"{float(t):18.8f}\n")
397	        with open(output_file_def, mode="w", encoding="utf-8") as file:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
395	                            for t in tmp_proj:
396	                                file.write(f"{float(t):18.8f}\n")
397	        with open(output_file_def, mode="w", encoding="utf-8") as file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
400	                so = "so"
401	            file.write(
402	                "5, 'boltztrap.intrans',      'old',    'formatted',0\n"
403	                "6,'boltztrap.outputtrans',      'unknown',    "
404	                "'formatted',0\n"
405	                "20,'boltztrap.struct',         'old',    'formatted',0\n"
406	                f"10,'boltztrap.energy{so}',         'old',    "
407	                "'formatted',0\n48,'boltztrap.engre',         'unknown',    "

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
400	                so = "so"
401	            file.write(
402	                "5, 'boltztrap.intrans',      'old',    'formatted',0\n"
403	                "6,'boltztrap.outputtrans',      'unknown',    "
404	                "'formatted',0\n"
405	                "20,'boltztrap.struct',         'old',    'formatted',0\n"
406	                f"10,'boltztrap.energy{so}',         'old',    "
407	                "'formatted',0\n48,'boltztrap.engre',         'unknown',    "

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
420	                    if orb_idx < len(self._bs.projections[Spin.up][0][0]):
421	                        file.write(f"{kpt_idx},'boltztrap.proj_{site_nb}_{orb.name}old', 'formatted',0\n")
422	                        kpt_idx += 1

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
420	                    if orb_idx < len(self._bs.projections[Spin.up][0][0]):
421	                        file.write(f"{kpt_idx},'boltztrap.proj_{site_nb}_{orb.name}old', 'formatted',0\n")
422	                        kpt_idx += 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
433	            with open(output_file, mode="w", encoding="utf-8") as fout:
434	                fout.write("GENE          # use generic interface\n")
435	                fout.write(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
433	            with open(output_file, mode="w", encoding="utf-8") as fout:
434	                fout.write("GENE          # use generic interface\n")
435	                fout.write(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
434	                fout.write("GENE          # use generic interface\n")
435	                fout.write(
436	                    f"1 0 {set_gap} {Energy(self.scissor, 'eV').to('Ry')}         "
437	                    "# iskip (not presently used) idebug setgap shiftgap \n"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
434	                fout.write("GENE          # use generic interface\n")
435	                fout.write(
436	                    f"1 0 {set_gap} {Energy(self.scissor, 'eV').to('Ry')}         "
437	                    "# iskip (not presently used) idebug setgap shiftgap \n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
438	                )
439	                fout.write(
440	                    f"0.0 {Energy(self.energy_grid, 'eV').to('Ry')} "
441	                    f"{Energy(self.energy_span_around_fermi, 'eV').to('Ry')} {self._nelec}.1f     "
442	                    f"# Fermilevel (Ry),energygrid,energy span around Fermilevel, number of electrons\n"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
438	                )
439	                fout.write(
440	                    f"0.0 {Energy(self.energy_grid, 'eV').to('Ry')} "
441	                    f"{Energy(self.energy_span_around_fermi, 'eV').to('Ry')} {self._nelec}.1f     "
442	                    f"# Fermilevel (Ry),energygrid,energy span around Fermilevel, number of electrons\n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
443	                )
444	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
445	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
443	                )
444	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
445	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
444	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
445	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
446	                fout.write(f"{self.run_type}                     # run mode (only BOLTZ is supported)\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
444	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
445	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
446	                fout.write(f"{self.run_type}                     # run mode (only BOLTZ is supported)\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
445	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
446	                fout.write(f"{self.run_type}                     # run mode (only BOLTZ is supported)\n")
447	                fout.write(".15                       # (efcut) energy range of chemical potential\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
445	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
446	                fout.write(f"{self.run_type}                     # run mode (only BOLTZ is supported)\n")
447	                fout.write(".15                       # (efcut) energy range of chemical potential\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
446	                fout.write(f"{self.run_type}                     # run mode (only BOLTZ is supported)\n")
447	                fout.write(".15                       # (efcut) energy range of chemical potential\n")
448	                fout.write(f"{self.tmax} {self.tgrid}                  # Tmax, temperature grid\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
446	                fout.write(f"{self.run_type}                     # run mode (only BOLTZ is supported)\n")
447	                fout.write(".15                       # (efcut) energy range of chemical potential\n")
448	                fout.write(f"{self.tmax} {self.tgrid}                  # Tmax, temperature grid\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
447	                fout.write(".15                       # (efcut) energy range of chemical potential\n")
448	                fout.write(f"{self.tmax} {self.tgrid}                  # Tmax, temperature grid\n")
449	                fout.write("-1.  # energyrange of bands given DOS output sig_xxx and dos_xxx (xxx is band number)\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
447	                fout.write(".15                       # (efcut) energy range of chemical potential\n")
448	                fout.write(f"{self.tmax} {self.tgrid}                  # Tmax, temperature grid\n")
449	                fout.write("-1.  # energyrange of bands given DOS output sig_xxx and dos_xxx (xxx is band number)\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
448	                fout.write(f"{self.tmax} {self.tgrid}                  # Tmax, temperature grid\n")
449	                fout.write("-1.  # energyrange of bands given DOS output sig_xxx and dos_xxx (xxx is band number)\n")
450	                fout.write(self.dos_type + "\n")  # e.g. HISTO or TETRA

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
448	                fout.write(f"{self.tmax} {self.tgrid}                  # Tmax, temperature grid\n")
449	                fout.write("-1.  # energyrange of bands given DOS output sig_xxx and dos_xxx (xxx is band number)\n")
450	                fout.write(self.dos_type + "\n")  # e.g. HISTO or TETRA

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
449	                fout.write("-1.  # energyrange of bands given DOS output sig_xxx and dos_xxx (xxx is band number)\n")
450	                fout.write(self.dos_type + "\n")  # e.g. HISTO or TETRA
451	                fout.write(f"{self.tauref} {self.tauexp} {self.tauen} 0 0 0\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
449	                fout.write("-1.  # energyrange of bands given DOS output sig_xxx and dos_xxx (xxx is band number)\n")
450	                fout.write(self.dos_type + "\n")  # e.g. HISTO or TETRA
451	                fout.write(f"{self.tauref} {self.tauexp} {self.tauen} 0 0 0\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
450	                fout.write(self.dos_type + "\n")  # e.g. HISTO or TETRA
451	                fout.write(f"{self.tauref} {self.tauexp} {self.tauen} 0 0 0\n")
452	                fout.write(f"{2 * len(self.doping)}\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
450	                fout.write(self.dos_type + "\n")  # e.g. HISTO or TETRA
451	                fout.write(f"{self.tauref} {self.tauexp} {self.tauen} 0 0 0\n")
452	                fout.write(f"{2 * len(self.doping)}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
451	                fout.write(f"{self.tauref} {self.tauexp} {self.tauen} 0 0 0\n")
452	                fout.write(f"{2 * len(self.doping)}\n")
453	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
451	                fout.write(f"{self.tauref} {self.tauexp} {self.tauen} 0 0 0\n")
452	                fout.write(f"{2 * len(self.doping)}\n")
453	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
454	                for d in self.doping:
455	                    fout.write(str(d) + "\n")
456	                for d in self.doping:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
454	                for d in self.doping:
455	                    fout.write(str(d) + "\n")
456	                for d in self.doping:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
456	                for d in self.doping:
457	                    fout.write(str(-d) + "\n")
458	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
456	                for d in self.doping:
457	                    fout.write(str(-d) + "\n")
458	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
460	            with open(output_file, mode="w", encoding="utf-8") as fout:
461	                fout.write("GENE          # use generic interface\n")
462	                fout.write("1 0 0 0.0         # iskip (not presently used) idebug setgap shiftgap \n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
460	            with open(output_file, mode="w", encoding="utf-8") as fout:
461	                fout.write("GENE          # use generic interface\n")
462	                fout.write("1 0 0 0.0         # iskip (not presently used) idebug setgap shiftgap \n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
461	                fout.write("GENE          # use generic interface\n")
462	                fout.write("1 0 0 0.0         # iskip (not presently used) idebug setgap shiftgap \n")
463	                fout.write(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
461	                fout.write("GENE          # use generic interface\n")
462	                fout.write("1 0 0 0.0         # iskip (not presently used) idebug setgap shiftgap \n")
463	                fout.write(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
462	                fout.write("1 0 0 0.0         # iskip (not presently used) idebug setgap shiftgap \n")
463	                fout.write(
464	                    f"0.0 {Energy(self.energy_grid, 'eV').to('Ry')} 0.1 {self._nelec:6.1f}     # Fermilevel "
465	                    "(Ry),energygrid,energy span around Fermilevel, number of electrons\n"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
462	                fout.write("1 0 0 0.0         # iskip (not presently used) idebug setgap shiftgap \n")
463	                fout.write(
464	                    f"0.0 {Energy(self.energy_grid, 'eV').to('Ry')} 0.1 {self._nelec:6.1f}     # Fermilevel "
465	                    "(Ry),energygrid,energy span around Fermilevel, number of electrons\n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
466	                )
467	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
468	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
466	                )
467	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
468	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
467	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
468	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
469	                fout.write("FERMI                     # run mode (only BOLTZ is supported)\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
467	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
468	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
469	                fout.write("FERMI                     # run mode (only BOLTZ is supported)\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
468	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
469	                fout.write("FERMI                     # run mode (only BOLTZ is supported)\n")
470	                fout.write(f"1                        # actual band selected: {self.band_nb + 1} spin: {self.spin}")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
468	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
469	                fout.write("FERMI                     # run mode (only BOLTZ is supported)\n")
470	                fout.write(f"1                        # actual band selected: {self.band_nb + 1} spin: {self.spin}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
469	                fout.write("FERMI                     # run mode (only BOLTZ is supported)\n")
470	                fout.write(f"1                        # actual band selected: {self.band_nb + 1} spin: {self.spin}")
471	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
469	                fout.write("FERMI                     # run mode (only BOLTZ is supported)\n")
470	                fout.write(f"1                        # actual band selected: {self.band_nb + 1} spin: {self.spin}")
471	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
482	            with open(output_file, mode="w", encoding="utf-8") as fout:
483	                fout.write("GENE          # use generic interface\n")
484	                fout.write(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
482	            with open(output_file, mode="w", encoding="utf-8") as fout:
483	                fout.write("GENE          # use generic interface\n")
484	                fout.write(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
483	                fout.write("GENE          # use generic interface\n")
484	                fout.write(
485	                    f"1 0 {set_gap} {Energy(self.scissor, 'eV').to('Ry')}         # iskip (not presently used) "
486	                    "idebug setgap shiftgap \n"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
483	                fout.write("GENE          # use generic interface\n")
484	                fout.write(
485	                    f"1 0 {set_gap} {Energy(self.scissor, 'eV').to('Ry')}         # iskip (not presently used) "
486	                    "idebug setgap shiftgap \n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
487	                )
488	                fout.write(
489	                    f"0.0 {Energy(self.energy_grid, 'eV').to('Ry')} "
490	                    f"{Energy(self.energy_span_around_fermi, 'eV').to('Ry')} {self._nelec:.1f}     "
491	                    f"# Fermilevel (Ry),energygrid,energy span around Fermilevel, number of electrons\n"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
487	                )
488	                fout.write(
489	                    f"0.0 {Energy(self.energy_grid, 'eV').to('Ry')} "
490	                    f"{Energy(self.energy_span_around_fermi, 'eV').to('Ry')} {self._nelec:.1f}     "
491	                    f"# Fermilevel (Ry),energygrid,energy span around Fermilevel, number of electrons\n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
492	                )
493	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
494	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
492	                )
493	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
494	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
493	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
494	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
495	                fout.write("BANDS                     # run mode (only BOLTZ is supported)\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
493	                fout.write("CALC                    # CALC (calculate expansion coeff), NOCALC read from file\n")
494	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
495	                fout.write("BANDS                     # run mode (only BOLTZ is supported)\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
494	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
495	                fout.write("BANDS                     # run mode (only BOLTZ is supported)\n")
496	                fout.write(f"P {len(self.kpt_line)}\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
494	                fout.write(f"{self.lpfac}                        # lpfac, number of latt-points per k-point\n")
495	                fout.write("BANDS                     # run mode (only BOLTZ is supported)\n")
496	                fout.write(f"P {len(self.kpt_line)}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
495	                fout.write("BANDS                     # run mode (only BOLTZ is supported)\n")
496	                fout.write(f"P {len(self.kpt_line)}\n")
497	                for kp in self.kpt_line:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
495	                fout.write("BANDS                     # run mode (only BOLTZ is supported)\n")
496	                fout.write(f"P {len(self.kpt_line)}\n")
497	                for kp in self.kpt_line:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
498	                    fout.writelines([f"{k} " for k in kp])
499	                    fout.write("\n")
500	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/electronic_structure/boltztrap.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
498	                    fout.writelines([f"{k} " for k in kp])
499	                    fout.write("\n")
500	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/entries/entry_tools.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
135	        groups = manager.list()
136	        with mp.Pool(ncpus) as pool:
137	            # Parallel processing only supports Python primitives and not objects.

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/entries/entry_tools.py:136
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
135	        groups = manager.list()
136	        with mp.Pool(ncpus) as pool:
137	            # Parallel processing only supports Python primitives and not objects.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/cod.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	        self.timeout = timeout
56	        self.url = "https://www.crystallography.net"
57	        self.api_url = f"{self.url}/cod/result"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/cod.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	
71	        response = requests.get(self.api_url, params=params, timeout=self.timeout)
72	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/cod.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	
96	        response = requests.get(f"{self.url}/cod/{cod_id}.cif", timeout=timeout)
97	        return Structure.from_str(response.text, fmt="cif", **kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/cod.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	
119	        response = requests.get(self.api_url, params=params, timeout=self.timeout)
120	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/cod.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	            cod_id = entry["file"]
127	            sg = entry.get("sg")
128	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	        else:
80	            self.api_key = SETTINGS.get("PMG_MAPI_KEY", "")
81	        self.preamble = SETTINGS.get("PMG_MAPI_ENDPOINT", "https://api.materialsproject.org/")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	            self.api_key = SETTINGS.get("PMG_MAPI_KEY", "")
81	        self.preamble = SETTINGS.get("PMG_MAPI_ENDPOINT", "https://api.materialsproject.org/")
82	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	            self.api_key = SETTINGS.get("PMG_MAPI_KEY", "")
81	        self.preamble = SETTINGS.get("PMG_MAPI_ENDPOINT", "https://api.materialsproject.org/")
82	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
87	            python_info = f"Python/{sys.version.split()[0]}"
88	            platform_info = f"{platform.system()}/{platform.release()}"
89	            self.session.headers["user-agent"] = f"{pymatgen_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
87	            python_info = f"Python/{sys.version.split()[0]}"
88	            platform_info = f"{platform.system()}/{platform.release()}"
89	            self.session.headers["user-agent"] = f"{pymatgen_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:88
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
87	            python_info = f"Python/{sys.version.split()[0]}"
88	            platform_info = f"{platform.system()}/{platform.release()}"
89	            self.session.headers["user-agent"] = f"{pymatgen_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
127	                if method == "POST":
128	                    response = self.session.post(actual_url, data=payload, verify=True)
129	                else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	                else:
130	                    response = self.session.get(actual_url, params=payload, verify=True)
131	                if response.status_code in [200, 400]:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
171	        logger.info(f"query={get}")
172	        return self.request(f"materials/summary/?{get}", payload=criteria)
173	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
184	        get = "_all_fields=True" if fields is None else "_fields=" + ",".join(fields)
185	        return self.request(f"materials/summary/?{get}", payload=criteria)
186	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
197	        get = "_all_fields=True" if fields is None else "_fields=" + ",".join(fields)
198	        return self.request(f"materials/summary/?{get}", payload={"material_ids": material_id})[0]
199	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
229	        prop = "structure" if final else "initial_structure"
230	        response = self.request(f"materials/summary/?{query}&_all_fields=false&_fields={prop}")
231	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
246	        prop = "structure"
247	        response = self.request(f"materials/summary?material_ids={material_id}&_fields={prop}")
248	        structure = response[0][prop]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
267	        prop = "initial_structures"
268	        response = self.request(f"materials/summary/{material_id}/?_fields={prop}")
269	        structures = response[0][prop]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
317	        entries = []
318	        response = self.request(f"materials/thermo/?_fields=entries&{query}")
319	        for dct in response:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
378	        prop = "ph_bs"
379	        response = self.request(f"materials/phonon/?material_ids={material_id}&_fields={prop}")
380	        return response[0][prop]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
391	        prop = "ph_dos"
392	        response = self.request(f"materials/phonon/?material_ids={material_id}&_fields={prop}")
393	        return response[0][prop]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
424	        if api_key is None:
425	            api_key = kwargs.get("api_key", SETTINGS.get("PMG_MAPI_KEY"))
426	            kwargs["api_key"] = api_key

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
424	        if api_key is None:
425	            api_key = kwargs.get("api_key", SETTINGS.get("PMG_MAPI_KEY"))
426	            kwargs["api_key"] = api_key

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
428	        if not api_key:
429	            raise ValueError("Please supply an API key. See https://materialsproject.org/api for details.")
430	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	        warnings.warn(
169	            "You are using the legacy MPRester. This version of the MPRester will no longer be updated. "
170	            "To access the latest data with the new MPRester, obtain a new API key from "
171	            "https://materialsproject.org/api and consult the docs at https://docs.materialsproject.org/ "
172	            "for more information.",
173	            FutureWarning,
174	            stacklevel=2,
175	        )
176	        if api_key is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	        else:
179	            self.api_key = SETTINGS.get("PMG_MAPI_KEY", "")
180	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
183	        else:
184	            self.preamble = SETTINGS.get("PMG_MAPI_ENDPOINT", "https://legacy.materialsproject.org/rest/v2")
185	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	        else:
184	            self.preamble = SETTINGS.get("PMG_MAPI_ENDPOINT", "https://legacy.materialsproject.org/rest/v2")
185	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	
186	        if self.preamble != "https://legacy.materialsproject.org/rest/v2":
187	            warnings.warn(f"Non-default endpoint used: {self.preamble}", stacklevel=2)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
193	            python_info = f"Python/{sys.version.split()[0]}"
194	            platform_info = f"{platform.system()}/{platform.release()}"
195	            self.session.headers["user-agent"] = f"{pymatgen_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
193	            python_info = f"Python/{sys.version.split()[0]}"
194	            platform_info = f"{platform.system()}/{platform.release()}"
195	            self.session.headers["user-agent"] = f"{pymatgen_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:194
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
193	            python_info = f"Python/{sys.version.split()[0]}"
194	            platform_info = f"{platform.system()}/{platform.release()}"
195	            self.session.headers["user-agent"] = f"{pymatgen_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
262	            if method == "POST":
263	                response = self.session.post(url, data=payload, verify=True)
264	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
264	            else:
265	                response = self.session.get(url, params=payload, verify=True)
266	            if response.status_code in [200, 400]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	                if data["valid_response"]:
269	                    if data.get("warning"):
270	                        warnings.warn(data["warning"], stacklevel=2)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
293	        """
294	        dct = self._make_request("/api_check")
295	        return dct["version"]["db"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
306	        """
307	        return self._make_request(f"/materials/mid_from_tid/{task_id}")
308	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
317	        """
318	        return self._make_request(f"/materials/{material_id}/refs")
319	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
344	            sub_url += "/" + prop
345	        return self._make_request(sub_url)
346	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
356	        """
357	        return self._make_request(f"/materials/{chemsys_formula}/mids", mp_decode=False)
358	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
373	        """
374	        return self._make_request(f"/materials/{materials_id}/doc", mp_decode=False)
375	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
393	            )
394	        data = self._make_request(
395	            f"/materials/{material_id}/xas/{absorbing_element}",
396	            mp_decode=False,
397	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
420	            sub_url += "/" + prop
421	        return self._make_request(sub_url)
422	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
458	        payload = {"structure": json.dumps(struct.as_dict(), cls=MontyEncoder)}
459	        response = self.session.post(f"{self.preamble}/find_structure", data=payload)
460	        if response.status_code in [200, 400]:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
620	        url = "/pourbaix_diagram/reference_data/" + "-".join(chemsys)
621	        ion_data = self._make_request(url)
622	        ion_ref_comps = [Composition(d["Reference Solid"]) for d in ion_data]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
803	        """
804	        return self._make_request(f"/materials/{material_id}/phonondos")
805	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
814	        """
815	        return self._make_request(f"/materials/{material_id}/phononbs")
816	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
825	        """
826	        return self._make_request(f"/materials/{material_id}/abinit_ddb")
827	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:995
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
994	        if chunk_size == 0:
995	            return self._make_request("/query", payload=payload, method="POST", mp_decode=mp_decode)
996	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
998	        count_payload["options"] = json.dumps({"count_only": True})
999	        num_results = self._make_request("/query", payload=count_payload, method="POST")
1000	        if num_results <= chunk_size:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1000	        if num_results <= chunk_size:
1001	            return self._make_request("/query", payload=payload, method="POST", mp_decode=mp_decode)
1002	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1108	        payload = {"snl": json.dumps(json_data, cls=MontyEncoder)}
1109	        response = self.session.post(f"{self.preamble}/snl/submit", data=payload)
1110	        if response.status_code in [200, 400]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1112	            if response["valid_response"]:
1113	                if response.get("warning"):
1114	                    warnings.warn(response["warning"], stacklevel=2)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1133	        payload = {"ids": json.dumps(snl_ids)}
1134	        response = self.session.post(f"{self.preamble}/snl/delete", data=payload)
1135	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1138	            if response["valid_response"]:
1139	                if response.get("warning"):
1140	                    warnings.warn(response["warning"], stacklevel=2)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1162	        payload = {"criteria": json.dumps(criteria)}
1163	        response = self.session.post(f"{self.preamble}/snl/query", data=payload)
1164	        if response.status_code in [200, 400]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1166	            if response["valid_response"]:
1167	                if response.get("warning"):
1168	                    warnings.warn(response["warning"], stacklevel=2)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1257	        payload = {"entries": json.dumps(entries, cls=MontyEncoder)}
1258	        response = self.session.post(
1259	            f"{self.preamble}/phase_diagram/calculate_stability",
1260	            data=payload,
1261	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1264	            if response["valid_response"]:
1265	                if response.get("warning"):
1266	                    warnings.warn(response["warning"], stacklevel=2)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1288	        for el in comp_dict:
1289	            ent = self._make_request(f"/element/{el}/tasks/isolated_atom", mp_decode=False)[0]
1290	            isolated_atom_e_sum += ent["output"]["final_energy_per_atom"] * comp_dict[el]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1304	        """
1305	        return self._make_request(
1306	            "/reaction",
1307	            payload={"reactants[]": reactants, "products[]": products},
1308	            mp_decode=False,
1309	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1328	            req += f"&orient={' '.join(map(str, orient))}"
1329	        return self._make_request(req)
1330	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1337	        """
1338	        return self._make_request("/materials/all_substrate_ids")
1339	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1369	        if miller_index:
1370	            surf_data_dict = self._make_request(req)
1371	            surf_list = surf_data_dict["surfaces"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1377	            raise ValueError("Bad miller index.")
1378	        return self._make_request(req)
1379	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1448	        if include_work_of_separation and material_id:
1449	            list_of_gbs = self._make_request("/grain_boundaries", payload=payload)
1450	            for gb_dict in list_of_gbs:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1459	
1460	        return self._make_request("/grain_boundaries", payload=payload)
1461	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1499	        }
1500	        return self._make_request("/interface_reactions", payload=payload, method="POST")
1501	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1524	                mp_id = doc["task_id"]
1525	                if meta.get(mp_id) is None:
1526	                    meta[mp_id] = [{"task_id": task_id, "task_type": task_type}]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1536	        # check if these task ids exist on NOMAD
1537	        prefix = "https://nomad-lab.eu/prod/rae/api/repo/?"
1538	        if file_patterns is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1548	        # generate download links for those that exist
1549	        prefix = "https://nomad-lab.eu/prod/rae/api/raw/query?"
1550	        if file_patterns is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/matproj_legacy.py:1579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1578	    def _check_nomad_exist(url) -> bool:
1579	        response = requests.get(url=url, timeout=60)
1580	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	    aliases: ClassVar[dict[str, str]] = {
62	        "aflow": "https://aflow.org/API/optimade/",
63	        "alexandria": "https://alexandria.icams.rub.de/pbe",
64	        "alexandria.pbe": "https://alexandria.icams.rub.de/pbe",
65	        "alexandria.pbesol": "https://alexandria.icams.rub.de/pbesol",
66	        "cod": "https://www.crystallography.net/cod/optimade",
67	        "cmr": "https://cmr-optimade.fysik.dtu.dk",
68	        "mcloud.mc3d": "https://aiida.materialscloud.org/mc3d/optimade",
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        "aflow": "https://aflow.org/API/optimade/",
63	        "alexandria": "https://alexandria.icams.rub.de/pbe",
64	        "alexandria.pbe": "https://alexandria.icams.rub.de/pbe",
65	        "alexandria.pbesol": "https://alexandria.icams.rub.de/pbesol",
66	        "cod": "https://www.crystallography.net/cod/optimade",
67	        "cmr": "https://cmr-optimade.fysik.dtu.dk",
68	        "mcloud.mc3d": "https://aiida.materialscloud.org/mc3d/optimade",
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        "alexandria": "https://alexandria.icams.rub.de/pbe",
64	        "alexandria.pbe": "https://alexandria.icams.rub.de/pbe",
65	        "alexandria.pbesol": "https://alexandria.icams.rub.de/pbesol",
66	        "cod": "https://www.crystallography.net/cod/optimade",
67	        "cmr": "https://cmr-optimade.fysik.dtu.dk",
68	        "mcloud.mc3d": "https://aiida.materialscloud.org/mc3d/optimade",
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        "alexandria.pbe": "https://alexandria.icams.rub.de/pbe",
65	        "alexandria.pbesol": "https://alexandria.icams.rub.de/pbesol",
66	        "cod": "https://www.crystallography.net/cod/optimade",
67	        "cmr": "https://cmr-optimade.fysik.dtu.dk",
68	        "mcloud.mc3d": "https://aiida.materialscloud.org/mc3d/optimade",
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        "alexandria.pbesol": "https://alexandria.icams.rub.de/pbesol",
66	        "cod": "https://www.crystallography.net/cod/optimade",
67	        "cmr": "https://cmr-optimade.fysik.dtu.dk",
68	        "mcloud.mc3d": "https://aiida.materialscloud.org/mc3d/optimade",
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	        "cod": "https://www.crystallography.net/cod/optimade",
67	        "cmr": "https://cmr-optimade.fysik.dtu.dk",
68	        "mcloud.mc3d": "https://aiida.materialscloud.org/mc3d/optimade",
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        "cmr": "https://cmr-optimade.fysik.dtu.dk",
68	        "mcloud.mc3d": "https://aiida.materialscloud.org/mc3d/optimade",
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	        "mcloud.mc3d": "https://aiida.materialscloud.org/mc3d/optimade",
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	        "mcloud.mc2d": "https://aiida.materialscloud.org/mc2d/optimade",
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        "mcloud.2dtopo": "https://aiida.materialscloud.org/2dtopo/optimade",
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	        "mcloud.tc-applicability": "https://aiida.materialscloud.org/tc-applicability/optimade",
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        "mcloud.pyrene-mofs": "https://aiida.materialscloud.org/pyrene-mofs/optimade",
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	        "mcloud.curated-cofs": "https://aiida.materialscloud.org/curated-cofs/optimade",
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        "mcloud.stoceriaitf": "https://aiida.materialscloud.org/stoceriaitf/optimade",
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	        "mcloud.scdm": "https://aiida.materialscloud.org/autowannier/optimade",
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        "mcloud.tin-antimony-sulfoiodide": "https://aiida.materialscloud.org/tin-antimony-sulfoiodide/optimade",
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	        "mcloud.optimade-sample": "https://aiida.materialscloud.org/optimade-sample/optimade",
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        "mp": "https://optimade.materialsproject.org",
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        "mpdd": "http://mpddoptimade.phaseslab.org",
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	        "mpds": "https://api.mpds.io",
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	        "nmd": "https://nomad-lab.eu/prod/rae/optimade/",
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended
111	        as a way to quickly search an endpoint in a way familiar to users of pymatgen without

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	        "odbx": "https://optimade.odbx.science",
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended
111	        as a way to quickly search an endpoint in a way familiar to users of pymatgen without
112	        needing to know the full OPTIMADE specification.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	        "odbx.odbx_misc": "https://optimade-misc.odbx.science",
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended
111	        as a way to quickly search an endpoint in a way familiar to users of pymatgen without
112	        needing to know the full OPTIMADE specification.
113	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        "odbx.gnome": "https://optimade-gnome.odbx.science",
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended
111	        as a way to quickly search an endpoint in a way familiar to users of pymatgen without
112	        needing to know the full OPTIMADE specification.
113	
114	        For advanced usage, please see the OPTIMADE documentation at optimade.org and

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	        "omdb.omdb_production": "https://optimade.openmaterialsdb.se",
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended
111	        as a way to quickly search an endpoint in a way familiar to users of pymatgen without
112	        needing to know the full OPTIMADE specification.
113	
114	        For advanced usage, please see the OPTIMADE documentation at optimade.org and
115	        consider calling the APIs directly.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	        "oqmd": "https://oqmd.org/optimade/",
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended
111	        as a way to quickly search an endpoint in a way familiar to users of pymatgen without
112	        needing to know the full OPTIMADE specification.
113	
114	        For advanced usage, please see the OPTIMADE documentation at optimade.org and
115	        consider calling the APIs directly.
116	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	        "jarvis": "https://jarvis.nist.gov/optimade/jarvisdft",
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended
111	        as a way to quickly search an endpoint in a way familiar to users of pymatgen without
112	        needing to know the full OPTIMADE specification.
113	
114	        For advanced usage, please see the OPTIMADE documentation at optimade.org and
115	        consider calling the APIs directly.
116	
117	        For convenience, known OPTIMADE endpoints have been given aliases in pymatgen to save

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        "tcod": "https://www.crystallography.net/tcod/optimade",
89	        "twodmatpedia": "http://optimade.2dmatpedia.org",
90	    }
91	
92	    # The set of OPTIMADE fields that are required to define a `pymatgen.core.Structure`
93	    mandatory_response_fields = (
94	        "lattice_vectors",
95	        "cartesian_site_positions",
96	        "species",
97	        "species_at_sites",
98	    )
99	
100	    def __init__(
101	        self,
102	        aliases_or_resource_urls: str | list[str] | None = None,
103	        refresh_aliases: bool = False,
104	        timeout: int = 5,
105	    ):
106	        """OPTIMADE is an effort to provide a standardized interface to retrieve information
107	        from many different materials science databases.
108	
109	        This is a client to retrieve structures from OPTIMADE v1 compliant endpoints. It
110	        does not yet support all features of the OPTIMADE v1 specification but is intended
111	        as a way to quickly search an endpoint in a way familiar to users of pymatgen without
112	        needing to know the full OPTIMADE specification.
113	
114	        For advanced usage, please see the OPTIMADE documentation at optimade.org and
115	        consider calling the APIs directly.
116	
117	        For convenience, known OPTIMADE endpoints have been given aliases in pymatgen to save
118	        typing the full URL.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	        if refresh_aliases:
142	            _logger.warning("Refreshing OPTIMADE provider aliases from https://providers.optimade.org")
143	            self.refresh_aliases()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	        """Retrieve and returns JSON resource from given url."""
192	        return self.session.get(url, timeout=self._timeout).json()
193	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	                pbar = tqdm(
354	                    total=json["meta"].get("data_returned", 0),
355	                    desc=identifier,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
359	                # TODO: check spec for `more_data_available` boolean, may simplify this conditional
360	                while next_link := json.get("links", {}).get("next"):
361	                    if isinstance(next_link, dict) and "href" in next_link:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
359	                # TODO: check spec for `more_data_available` boolean, may simplify this conditional
360	                while next_link := json.get("links", {}).get("next"):
361	                    if isinstance(next_link, dict) and "href" in next_link:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
515	            return Provider(
516	                name=provider_info_json["meta"].get("provider", {}).get("name", "Unknown"),
517	                base_url=provider_url,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
515	            return Provider(
516	                name=provider_info_json["meta"].get("provider", {}).get("name", "Unknown"),
517	                base_url=provider_url,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
517	                base_url=provider_url,
518	                description=provider_info_json["meta"].get("provider", {}).get("description", "Unknown"),
519	                homepage=provider_info_json["meta"].get("provider", {}).get("homepage"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
517	                base_url=provider_url,
518	                description=provider_info_json["meta"].get("provider", {}).get("description", "Unknown"),
519	                homepage=provider_info_json["meta"].get("provider", {}).get("homepage"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
518	                description=provider_info_json["meta"].get("provider", {}).get("description", "Unknown"),
519	                homepage=provider_info_json["meta"].get("provider", {}).get("homepage"),
520	                prefix=provider_info_json["meta"].get("provider", {}).get("prefix", "Unknown"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
518	                description=provider_info_json["meta"].get("provider", {}).get("description", "Unknown"),
519	                homepage=provider_info_json["meta"].get("provider", {}).get("homepage"),
520	                prefix=provider_info_json["meta"].get("provider", {}).get("prefix", "Unknown"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	                homepage=provider_info_json["meta"].get("provider", {}).get("homepage"),
520	                prefix=provider_info_json["meta"].get("provider", {}).get("prefix", "Unknown"),
521	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	                homepage=provider_info_json["meta"].get("provider", {}).get("homepage"),
520	                prefix=provider_info_json["meta"].get("provider", {}).get("prefix", "Unknown"),
521	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
567	                            description=link["attributes"]["description"],
568	                            homepage=link["attributes"].get("homepage"),
569	                            prefix=link["attributes"].get("prefix"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
568	                            homepage=link["attributes"].get("homepage"),
569	                            prefix=link["attributes"].get("prefix"),
570	                        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/ext/optimade.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
593	
594	    def refresh_aliases(self, providers_url="https://providers.optimade.org/providers.json"):
595	        """Update available OPTIMADE structure resources based on the current list of OPTIMADE

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/abinit/abitimer.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
124	            try:
125	                self._read(file, filename)
126	                read_ok.append(filename)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/abinit/abitimer.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
704	        for idx, section in enumerate(self.sections):
705	            fileobj.write(section.to_csvline(with_header=(idx == 0)))
706	        fileobj.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/abinit/inputs.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
620	        with open(filepath, mode="w", encoding="utf-8") as file:
621	            file.write(str(self))
622	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/abinit/inputs.py:1302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1301	            p = f"{root}DS{i}" + ext
1302	            inp.write(filepath=p)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/abinit/pseudos.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
225	        with open(self.path, encoding="utf-8") as file:
226	            text = file.read()
227	            # usedforsecurity=False needed in FIPS mode (Federal Information Processing Standards)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/adf.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
554	            for block in mol_blocks:
555	                file.write(str(block) + "\n")
556	            file.write(str(self.task) + "\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/adf.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
555	                file.write(str(block) + "\n")
556	            file.write(str(self.task) + "\n")
557	            file.write("END INPUT")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/adf.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
556	            file.write(str(self.task) + "\n")
557	            file.write("END INPUT")
558	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	        with zopen(filepath, mode="rt", encoding="utf-8") as in_file:
138	            content = in_file.read()
139	        return cls.from_str(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
223	        with open(f"{directory}/geometry.in", mode="w", encoding="utf-8") as file:
224	            file.write(self.get_header(file_name.as_posix()))
225	            file.write(self.content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
224	            file.write(self.get_header(file_name.as_posix()))
225	            file.write(self.content)
226	            file.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
225	            file.write(self.content)
226	            file.write("\n")
227	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
680	        with open(f"{directory}/control.in", mode="w", encoding="utf-8") as file:
681	            file.write(f"#{'=' * 72}\n")
682	            file.write(f"# FHI-aims geometry file: {directory}/geometry.in\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
681	            file.write(f"#{'=' * 72}\n")
682	            file.write(f"# FHI-aims geometry file: {directory}/geometry.in\n")
683	            file.write("# File generated from pymatgen\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
682	            file.write(f"# FHI-aims geometry file: {directory}/geometry.in\n")
683	            file.write("# File generated from pymatgen\n")
684	            file.write(f"# {time.asctime()}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
683	            file.write("# File generated from pymatgen\n")
684	            file.write(f"# {time.asctime()}\n")
685	            file.write(f"#{'=' * 72}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
684	            file.write(f"# {time.asctime()}\n")
685	            file.write(f"#{'=' * 72}\n")
686	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
686	
687	            file.write(content)
688	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/aims/inputs.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
767	        with zopen(filename, mode="rt", encoding="utf-8") as file:
768	            return cls(data=file.read(), label=label)
769	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/babel.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    openbabel,
38	    "BabelMolAdaptor requires openbabel to be installed with Python bindings. "
39	    "Please get it at https://openbabel.org (version >=3.0.0).",
40	)
41	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cif.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
302	        with zopen(filename, mode="rt", errors="replace", encoding="utf-8") as file:
303	            return cls.from_str(file.read())
304	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cif.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
383	        elif isinstance(filename, StringIO):
384	            self._cif = CifFile.from_str(filename.read())
385	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cif.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1296	            warnings.warn(
1297	                "The default value of primitive was changed from True to False in "
1298	                "https://github.com/materialsproject/pymatgen/pull/3419. CifParser now returns the cell "
1299	                "in the CIF file as is. If you want the primitive cell, please set primitive=True explicitly.",
1300	                stacklevel=2,
1301	            )
1302	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cif.py:1708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1707	            warnings.warn(
1708	                "Site labels are not unique, which is not compliant with the CIF spec "
1709	                "(https://www.iucr.org/__data/iucr/cifdic_html/1/cif_core.dic/Iatom_site_label.html):"
1710	                f"`{atom_site_label}`.",
1711	                stacklevel=2,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cif.py:1768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1767	        with zopen(filename, mode=mode, encoding="utf-8") as file:
1768	            file.write(str(self))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/common.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
357	        with zopen(filename, mode="wt", encoding="utf-8") as file:
358	            file.write(f"# Cube file for {self.structure.formula} generated by Pymatgen\n")
359	            file.write(f"# {comment}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/common.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
358	            file.write(f"# Cube file for {self.structure.formula} generated by Pymatgen\n")
359	            file.write(f"# {comment}\n")
360	            file.write(f"\t {len(self.structure)} 0.000000 0.000000 0.000000\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/common.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
359	            file.write(f"# {comment}\n")
360	            file.write(f"\t {len(self.structure)} 0.000000 0.000000 0.000000\n")
361	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/common.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
363	                lattice_matrix = self.structure.lattice.matrix[idx] / self.dim[idx] * ang_to_bohr
364	                file.write(
365	                    f"\t {self.dim[idx]} {lattice_matrix[0]:.6f} {lattice_matrix[1]:.6f} {lattice_matrix[2]:.6f}\n"
366	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/common.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
368	            for site in self.structure:
369	                file.write(
370	                    f"\t {Element(site.species_string).Z} 0.000000 "
371	                    f"{ang_to_bohr * site.coords[0]} "
372	                    f"{ang_to_bohr * site.coords[1]} "
373	                    f"{ang_to_bohr * site.coords[2]} \n"
374	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/common.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
376	            for idx, dat in enumerate(self.data["total"].flatten(), start=1):
377	                file.write(f"{' ' if dat > 0 else ''}{dat:.6e} ")
378	                if idx % 6 == 0:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/common.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
378	                if idx % 6 == 0:
379	                    file.write("\n")
380	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/common.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
529	        with zopen(fpath, mode="rt", encoding="utf-8") as f:
530	            return f.read()
531	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/core.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	        with zopen(Path(filename), mode="wt", encoding="utf-8") as file:
78	            file.write(self.get_str())
79	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/core.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
105	        with zopen(Path(path), mode="rt", encoding="utf-8") as file:
106	            return cls.from_str(file.read())  # from_str not implemented
107	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/core.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
221	                with zopen(file_path, mode="wt", encoding="utf-8") as file:
222	                    file.write(str(contents))
223	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/core.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
229	                    try:
230	                        zip_file.write(file_path)
231	                        os.remove(file_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/inputs.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
695	        with zopen(filename, mode="rt", encoding="utf-8") as file:
696	            txt = preprocessor(file.read(), os.path.dirname(file.name))
697	            return cls.from_str(txt)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/inputs.py:779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
778	        with open(filepath, mode="w", encoding="utf-8") as file:
779	            file.write(self.get_str())
780	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/inputs.py:2758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2757	        with open(filename, encoding="utf-8") as file:
2758	            data = cls.from_str(file.read())  # type: ignore[call-arg]
2759	            for obj in data.objects:  # type: ignore[attr-defined]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/inputs.py:2772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2771	        with open(filename, mode="w", encoding="utf-8") as file:
2772	            file.write(self.get_str())
2773	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/outputs.py:1279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1278	        with open(bandstructure_filename, encoding="utf-8") as file:
1279	            lines = file.read().split("\n")
1280	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/outputs.py:1359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1358	        with zopen(hyperfine_filename, mode="rt", encoding="utf-8") as file:
1359	            lines = [line for line in file.read().split("\n") if line]
1360	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/outputs.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1379	        with zopen(gtensor_filename, mode="rt", encoding="utf-8") as file:
1380	            lines = [line for line in file.read().split("\n") if line]
1381	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/outputs.py:1417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1416	        with zopen(chi_filename, mode="rt", encoding="utf-8") as file:
1417	            lines = [line for line in file.read().split("\n") if line]
1418	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/outputs.py:1579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1578	            else:
1579	                text = file.read()
1580	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/cp2k/utils.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	        with zopen(os.path.join(dir, inc), mode="rt", encoding="utf-8") as file:
84	            data = re.sub(rf"{incl}", file.read(), data)
85	    variable_sets = re.findall(r"(@SET.+)", data, re.IGNORECASE)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/exciting/inputs.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
217	        root.set(
218	            "{http://www.w3.org/2001/XMLSchema-instance}noNamespaceSchemaLocation",
219	            "http://xml.exciting-code.org/excitinginput.xsd",
220	        )
221	        title = ET.SubElement(root, "title")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/exciting/inputs.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	            "{http://www.w3.org/2001/XMLSchema-instance}noNamespaceSchemaLocation",
219	            "http://xml.exciting-code.org/excitinginput.xsd",
220	        )
221	        title = ET.SubElement(root, "title")
222	        title.text = self.title

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/feff/sets.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
107	            with open(os.path.join(output_dir, k), mode="w", encoding="utf-8") as file:
108	                file.write(str(v))
109	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/feff/sets.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
110	        with open(f"{output_dir}/feff.inp", mode="w", encoding="utf-8") as file:
111	            file.write(feff_input)
112	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/fiesta.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
217	        with zopen(filename, mode="rt", encoding="utf-8") as file:
218	            basis_set = file.read()
219	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/fiesta.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
536	        with zopen(filename, mode="wt", encoding="utf-8") as file:
537	            file.write(str(self))
538	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/fiesta.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
715	        with zopen(filename, mode="rt", encoding="utf-8") as file:
716	            return cls.from_str(file.read())
717	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/fiesta.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
733	        with zopen(filename, mode="rt", encoding="utf-8") as file:
734	            data = file.read()
735	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/fiesta.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
824	        with zopen(filename, mode="rt", encoding="utf-8") as file:
825	            log_bse = file.read()
826	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/gaussian.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
371	        with zopen(filename, mode="rt", encoding="utf-8") as file:
372	            return cls.from_str(file.read())
373	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/gaussian.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
452	        with zopen(filename, mode="wt", encoding="utf-8") as file:
453	            file.write(self.to_str(cart_coords))
454	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/icet.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
280	        for proc_idx in range(self.instances):
281	            process = multiproc.Process(
282	                target=self._get_best_sqs_from_list,
283	                args=(chunks[proc_idx], working_list),
284	            )

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/icet.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
326	        """Run `self.instances` Monte Carlo SQS search with Icet."""
327	        with multiproc.Pool(self.instances) as pool:
328	            return pool.starmap(self._single_monte_carlo_sqs_run, [() for _ in range(self.instances)])

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/icet.py:327
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
326	        """Run `self.instances` Monte Carlo SQS search with Icet."""
327	        with multiproc.Pool(self.instances) as pool:
328	            return pool.starmap(self._single_monte_carlo_sqs_run, [() for _ in range(self.instances)])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/generators.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
70	        with zopen(self.template, mode="rt", encoding="utf-8") as file:
71	            template_str = file.read()
72	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/inputs.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
556	        with zopen(filename, mode="wt", encoding="utf-8") as file:
557	            file.write(self.get_str(ignore_comments=ignore_comments, keep_stages=keep_stages))
558	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/inputs.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
656	        with zopen(filename, mode="rt", encoding="utf-8") as file:
657	            return cls.from_str(file.read(), ignore_comments=ignore_comments, keep_stages=keep_stages)
658	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/inputs.py:956
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
955	        with open(template_path, encoding="utf-8") as file:
956	            script_template = file.read()
957	        settings = other_settings.copy() if other_settings else {}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/inputs.py:1103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1102	    with open(os.path.join(output_dir, script_filename), mode="w", encoding="utf-8") as file:
1103	        file.write(input_script)
1104	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	            raise RuntimeError(
220	                "PackmolRunner requires the executable 'packmol' to be in "
221	                "the path. Please download packmol from "
222	                "https://github.com/leandromartinez98/packmol "

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
268	            for key, val in self.control_params.items():
269	                inp.write(f"{key} {self._format_param_val(val)}\n")
270	            # write the structures of the constituent molecules to file and set

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
268	            for key, val in self.control_params.items():
269	                inp.write(f"{key} {self._format_param_val(val)}\n")
270	            # write the structures of the constituent molecules to file and set

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
281	                    pm = pybel.Molecule(a.openbabel_mol)
282	                    pm.write(
283	                        self.control_params["filetype"],
284	                        filename=filename,
285	                        overwrite=True,
286	                    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
281	                    pm = pybel.Molecule(a.openbabel_mol)
282	                    pm.write(
283	                        self.control_params["filetype"],
284	                        filename=filename,
285	                        overwrite=True,
286	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
287	
288	                inp.write("\n")
289	                inp.write(f"structure {os.path.join(input_dir, str(idx))}.{self.control_params['filetype']}\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
287	
288	                inp.write("\n")
289	                inp.write(f"structure {os.path.join(input_dir, str(idx))}.{self.control_params['filetype']}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
288	                inp.write("\n")
289	                inp.write(f"structure {os.path.join(input_dir, str(idx))}.{self.control_params['filetype']}\n")
290	                for key, val in self.param_list[idx].items():

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
288	                inp.write("\n")
289	                inp.write(f"structure {os.path.join(input_dir, str(idx))}.{self.control_params['filetype']}\n")
290	                for key, val in self.param_list[idx].items():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
290	                for key, val in self.param_list[idx].items():
291	                    inp.write(f"  {key} {self._format_param_val(val)}\n")
292	                inp.write("end structure\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
290	                for key, val in self.param_list[idx].items():
291	                    inp.write(f"  {key} {self._format_param_val(val)}\n")
292	                inp.write("end structure\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
291	                    inp.write(f"  {key} {self._format_param_val(val)}\n")
292	                inp.write("end structure\n")
293	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
291	                    inp.write(f"  {key} {self._format_param_val(val)}\n")
292	                inp.write("end structure\n")
293	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
339	
340	        pbm.write(format="pdb", filename=filename, overwrite=True)
341	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
339	
340	        pbm.write(format="pdb", filename=filename, overwrite=True)
341	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lammps/utils.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
450	            raise RuntimeError(
451	                f"LammpsRunner requires the executable {self.lammps_bin[-1]} to be in the path. "
452	                "Please download and install LAMMPS from "

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/inputs.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
266	                if key in type(self).FLOAT_KEYWORDS or key in type(self).STRING_KEYWORDS:
267	                    file.write(f"{type(self).AVAILABLE_KEYWORDS[key]} {self.get(key)}\n")
268	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/inputs.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
269	                elif key in type(self).BOOLEAN_KEYWORDS:
270	                    file.write(f"{type(self).BOOLEAN_KEYWORDS[key]}\n")
271	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/inputs.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
273	                    for value in self.get(key):  # type: ignore[union-attr]
274	                        file.write(f"{type(self).LIST_KEYWORDS[key]} {value}\n")
275	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/inputs.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
591	        with zopen(lobsterin, mode="rt", encoding="utf-8") as file:
592	            lines = file.read().split("\n")
593	        if not lines:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/inputs.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
648	        with zopen(POTCAR_input, mode="rt", encoding="utf-8") as file:
649	            data = file.read()
650	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
123	        with zopen(self._filename, mode="rt", encoding="utf-8") as file:
124	            lines = file.read().split("\n")
125	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
407	            with zopen(self._filename, mode="rt", encoding="utf-8") as file:
408	                all_lines = file.read().split("\n")
409	                lines = all_lines[1:-1] if "spin" not in all_lines[1] else all_lines[2:-1]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
624	        with zopen(filename, mode="rt", encoding="utf-8") as file:
625	            lines = file.read().split("\n")[1:-1]
626	        if len(lines) == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:916
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
915	            with zopen(filename, mode="rt", encoding="utf-8") as file:
916	                lines = file.read().split("\n")[3:-3]
917	            if len(lines) == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:1050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1049	            with zopen(filename, mode="rt", encoding="utf-8") as file:
1050	                lines = file.read().split("\n")
1051	            if len(lines) == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:1448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1447	            with zopen(fname, mode="rt", encoding="utf-8") as file:
1448	                lines = file.read().split("\n")
1449	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:1482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1481	            with zopen(filename, mode="rt", encoding="utf-8") as file:
1482	                lines = file.read().split("\n")
1483	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:1630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1629	            with zopen(filename, mode="rt", encoding="utf-8") as file:
1630	                lines = file.read().split("\n")
1631	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:1635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1634	            self._filename = filename
1635	            self._read(lines, spin_numbers)
1636	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:1770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1769	            with zopen(filename, mode="rt", encoding="utf-8") as file:
1770	                lines = file.read().split("\n")
1771	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:1900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1899	        with zopen(filename, mode="rt", encoding="utf-8") as file:
1900	            lines = file.read().split("\n")
1901	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:2070
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2069	            with zopen(filename, mode="rt", encoding="utf-8") as file:
2070	                lines = file.read().split("\n")[5]
2071	            if len(lines) == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:2141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2140	            with zopen(filename, mode="rt", encoding="utf-8") as file:
2141	                lines = file.read().split("\n")
2142	            if len(lines) == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:2438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2437	            with zopen(filename, mode="rt", encoding="utf-8") as file:
2438	                lines = file.read().split("\n")
2439	            if len(lines) == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/lobster/outputs.py:2482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2481	            with zopen(filename, mode="rt", encoding="utf-8") as file:
2482	                lines = file.read().split("\n")
2483	            if len(lines) == 0:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/nwchem.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
397	        with zopen(filename, mode="wt", encoding="utf-8") as file:
398	            file.write(str(self))
399	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/nwchem.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
537	        with zopen(filename, mode="rt", encoding="utf-8") as file:
538	            return cls.from_str(file.read())
539	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/nwchem.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
560	        with zopen(filename, mode="rt", encoding="utf-8") as file:
561	            data = file.read()
562	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/packmol.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	            raise RuntimeError(
55	                "Running a PackmolSet requires the executable 'packmol' to be in the path. Please "
56	                "download packmol from https://github.com/leandromartinez98/packmol and follow the "
57	                "instructions in the README to compile. Don't forget to add the packmol binary to your path"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/packmol.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	                with open(self.stdoutfile, mode="w", encoding="utf-8") as out:
85	                    out.write(proc.stdout.decode())
86	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/qchem/outputs.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	        with zopen(filename, mode="rt", encoding="ISO-8859-1") as file:
63	            self.text = file.read()
64	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/qchem/outputs.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
665	        with zopen(filename, mode="rt", encoding="utf-8") as file:
666	            text = re.split(r"\s*(?:Running\s+)*Job\s+\d+\s+of\s+\d+\s+", file.read())
667	        if text[0] == "":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/qchem/outputs.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
670	            with open(f"{filename}.{i}", mode="w", encoding="utf-8") as temp:
671	                temp.write(sub_text)
672	            tempOutput = QCOutput(f"{filename}.{i}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/qchem/outputs.py:2981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2980	    with zopen(filename, mode="rb") as file:
2981	        binary = file.read()
2982	    tmp_grad_data.extend(struct.unpack("d", binary[ii * 8 : (ii + 1) * 8])[0] for ii in range(len(binary) // 8))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/qchem/outputs.py:3007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3006	    with zopen(filename, mode="rb") as file:
3007	        binary = file.read()
3008	    hessian.extend(struct.unpack("d", binary[ii * 8 : (ii + 1) * 8])[0] for ii in range(len(binary) // 8))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/qchem/outputs.py:3026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3025	    with zopen(filename, mode="rb") as file:
3026	        binary = file.read()
3027	    orbital_coeffs.extend(struct.unpack("d", binary[ii * 8 : (ii + 1) * 8])[0] for ii in range(len(binary) // 8))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/qchem/sets.py:647
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
646	            with zopen(os.path.join(os.path.dirname(input_file), "solvent_data"), mode="wt", encoding="utf-8") as file:
647	                file.write(self.custom_smd)
648	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/shengbte.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	        f90nml,
134	        "ShengBTE Control object requires f90nml to be installed. Please get it at https://pypi.org/project/f90nml.",
135	    )
136	    def from_file(cls, filepath: str) -> Self:
137	        """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/shengbte.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	        f90nml,
173	        "ShengBTE Control object requires f90nml to be installed. Please get it at https://pypi.org/project/f90nml.",
174	    )
175	    def to_file(self, filename: str = "CONTROL") -> None:
176	        """Write ShengBTE CONTROL file from 'Control' object.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/help.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        """Init for VaspDoc."""
23	        self.url_template = "https://www.vasp.at/wiki/index.php/%s"
24	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/help.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	        tag = tag.upper()
57	        response = requests.get(
58	            f"https://www.vasp.at/wiki/index.php/{tag}",
59	            timeout=60,
60	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/help.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	        response = requests.get(
58	            f"https://www.vasp.at/wiki/index.php/{tag}",
59	            timeout=60,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/help.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        url = (
75	            "https://www.vasp.at/wiki/api.php?"
76	            "action=query&list=categorymembers"
77	            "&cmtitle=Category:INCAR_tag"
78	            "&cmlimit=500&format=json"
79	        )
80	        response = requests.get(url, timeout=60)
81	        response_dict = json.loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/help.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	        )
80	        response = requests.get(url, timeout=60)
81	        response_dict = json.loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/help.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	        while "continue" in response_dict:
96	            response = requests.get(url + f"&cmcontinue={response_dict['continue']['cmcontinue']}", timeout=60)
97	            response_dict = json.loads(response.text)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	        with zopen(filename, mode="rt", encoding="utf-8") as file:
288	            return cls.from_str(file.read(), names, read_velocities=read_velocities)
289	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
684	        with zopen(filename, mode="wt", encoding="utf-8") as file:
685	            file.write(self.get_str(**kwargs))
686	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
919	        with zopen(filename, mode="wt", encoding="utf-8") as file:
920	            file.write(str(self))
921	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
932	        with zopen(filename, mode="rt", encoding="utf-8") as file:
933	            return cls.from_str(file.read())
934	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:1119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1118	        with open(os.path.join(MODULE_DIR, "incar_parameters.json"), encoding="utf-8") as json_file:
1119	            incar_params = json.loads(json_file.read())
1120	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:1673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1672	        with zopen(filename, mode="rt", encoding="utf-8") as file:
1673	            return cls.from_str(file.read())
1674	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:1814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1813	        with zopen(filename, mode="wt", encoding="utf-8") as file:
1814	            file.write(str(self))
1815	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:2478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2477	        with zopen(filename, mode="wt", encoding="utf-8") as file:
2478	            file.write(str(self))
2479	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:2503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2502	            with zopen(filename, mode="rt", encoding="utf-8") as file:
2503	                return cls(file.read(), symbol=symbol or None)
2504	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:2512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2511	            with codecs.open(str(filename), "r", encoding="utf-8", errors="ignore") as file:
2512	                return cls(file.read(), symbol=symbol or None)
2513	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:2990
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2989	        with zopen(filename, mode="rt", encoding="utf-8") as file:
2990	            fdata = file.read()
2991	        return cls.from_str(fdata)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:3000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2999	        with zopen(filename, mode="wt", encoding="utf-8") as file:
3000	            file.write(str(self))
3001	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:3172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3171	                with zopen(os.path.join(output_dir, key), mode="wt", encoding="utf-8") as file:
3172	                    file.write(str(value))
3173	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/inputs.py:3182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3181	                    try:
3182	                        zip_file.write(os.path.join(output_dir, file), arcname=file)
3183	                    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
333	                # Remove parts of the xml file and parse the string
334	                content: str = file.read()
335	                steps: list[str] = content.split("<calculation>")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:2515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2514	        with zopen(self.filename, mode="rt", encoding="utf-8") as file:
2515	            text = file.read()
2516	        table_pattern_text = header_pattern + r"\s*^(?P<table_body>(?:\s+" + row_pattern + r")+)\s+" + footer_pattern

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:2727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2726	        with zopen(self.filename, mode="rt", encoding="utf-8") as file:
2727	            text = file.read()
2728	        unsym_table_pattern_text = header_pattern + first_part_pattern + r"(?P<table_body>.+)" + unsym_footer_pattern

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:3834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3833	            count = 0
3834	            file.write(f"   {dim[0]}   {dim[1]}   {dim[2]}\n")
3835	            for k, j, i in itertools.product(list(range(dim[2])), list(range(dim[1])), list(range(dim[0]))):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:3839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3838	                if count % 5 == 0:
3839	                    file.write(" " + "".join(lines) + "\n")
3840	                    lines = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:3844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3843	            if count % 5 != 0:
3844	                file.write(" " + "".join(lines) + " \n")
3845	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:3848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3847	            if isinstance(data, Iterable):
3848	                file.write("".join(data))
3849	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:3868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3867	            lines += " \n"
3868	            file.write(lines)
3869	            dim = self.dim

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:4053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4052	        self.orbitals = None  # used to check for consistency in files later
4053	        self.read(filenames)
4054	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:4075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4074	                xyz_data,
4075	            ) = self._read(filename, parsed_kpoints=parsed_kpoints)
4076	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:4828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4827	        with zopen(filename, mode="wt", encoding="utf-8") as file:
4828	            file.write(self.get_str(**kwargs))
4829	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:5735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5734	                prefix = np.fromfile(file, dtype=np.int32, count=1)[0]
5735	                data += file.read(abs(prefix))
5736	                suffix = np.fromfile(file, dtype=np.int32, count=1)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:6466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6465	            with open(filename, "rb") as f:
6466	                byte_data = f.read()
6467	            with zopen(filename, "wb") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/outputs.py:6468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
6467	            with zopen(filename, "wb") as f:
6468	                f.write(byte_data)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/sets.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
433	                warnings.warn(
434	                    "The structure contains Ytterbium (Yb) and this InputSet uses the Yb_2 PSP.\n"
435	                    "Yb_2 is known to often give bad results since Yb has oxidation state 3+ in most compounds.\n"
436	                    "See https://github.com/materialsproject/pymatgen/issues/2968 for details.",
437	                    BadInputSetWarning,
438	                    stacklevel=2,
439	                )
440	            if self.standardize and self.sym_prec:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/vasp/sets.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
770	            warnings.warn(
771	                f"{msg} See VASP recommendations on ISMEAR for metals (https://www.vasp.at/wiki/index.php/ISMEAR).",
772	                BadInputSetWarning,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/xtb/inputs.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	            with open(".constrains", mode="w", encoding="utf-8") as file:
60	                file.write(constrains_string)
61	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/xtb/outputs.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	            xtb_out_file.seek(-2, 2)
90	            while xtb_out_file.read(1) != b"\n":
91	                xtb_out_file.seek(-2, 1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/xtb/outputs.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91	                xtb_out_file.seek(-2, 1)
92	            end_bstring = xtb_out_file.read()
93	            if b"CREST terminated normally." in end_bstring:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/zeopp.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
159	        with zopen(filename, mode="rt", encoding="utf-8") as file:
160	            return cls.from_str(file.read())
161	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/zeopp.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
213	        with zopen(filename, mode="rt", encoding="utf-8") as file:
214	            return cls.from_str(file.read())
215	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/zeopp.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
264	                for el in rad_dict:
265	                    file.write(f"{el} {rad_dict[el].real}\n")
266	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/zeopp.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
264	                for el in rad_dict:
265	                    file.write(f"{el} {rad_dict[el].real}\n")
266	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/zeopp.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
413	                for el in rad_dict:
414	                    file.write(f"{el} {rad_dict[el].real}\n")
415	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/io/zeopp.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
413	                for el in rad_dict:
414	                    file.write(f"{el} {rad_dict[el].real}\n")
415	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
223	        with open(filename, mode="a", encoding="utf-8") as file:
224	            file.write("loop_ \n")
225	            file.write("_atom_site_aniso_label\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
224	            file.write("loop_ \n")
225	            file.write("_atom_site_aniso_label\n")
226	            file.write("_atom_site_aniso_U_11\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
225	            file.write("_atom_site_aniso_label\n")
226	            file.write("_atom_site_aniso_U_11\n")
227	            file.write("_atom_site_aniso_U_22\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
226	            file.write("_atom_site_aniso_U_11\n")
227	            file.write("_atom_site_aniso_U_22\n")
228	            file.write("_atom_site_aniso_U_33\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
227	            file.write("_atom_site_aniso_U_22\n")
228	            file.write("_atom_site_aniso_U_33\n")
229	            file.write("_atom_site_aniso_U_23\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228	            file.write("_atom_site_aniso_U_33\n")
229	            file.write("_atom_site_aniso_U_23\n")
230	            file.write("_atom_site_aniso_U_13\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
229	            file.write("_atom_site_aniso_U_23\n")
230	            file.write("_atom_site_aniso_U_13\n")
231	            file.write("_atom_site_aniso_U_12\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
230	            file.write("_atom_site_aniso_U_13\n")
231	            file.write("_atom_site_aniso_U_12\n")
232	            file.write(f"# Additional Data for U_Aniso: {self.temperature}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
231	            file.write("_atom_site_aniso_U_12\n")
232	            file.write(f"# Additional Data for U_Aniso: {self.temperature}\n")
233	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
234	            for idx, (site, matrix) in enumerate(zip(self.structure, self.Ucif, strict=True)):
235	                file.write(
236	                    f"{site.specie.symbol}{idx} {matrix[0][0]} {matrix[1][1]} {matrix[2][2]}"
237	                    f" {matrix[1][2]} {matrix[0][2]} {matrix[0][1]}\n"
238	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
341	        with open(filename, mode="w", encoding="utf-8") as file:
342	            file.write("#VESTA_FORMAT_VERSION 3.5.4\n \n \n")
343	            file.write("CRYSTAL\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
342	            file.write("#VESTA_FORMAT_VERSION 3.5.4\n \n \n")
343	            file.write("CRYSTAL\n\n")
344	            file.write("TITLE\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
343	            file.write("CRYSTAL\n\n")
344	            file.write("TITLE\n")
345	            file.write("Directionality Criterion\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
344	            file.write("TITLE\n")
345	            file.write("Directionality Criterion\n\n")
346	            file.write("GROUP\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
345	            file.write("Directionality Criterion\n\n")
346	            file.write("GROUP\n")
347	            file.write("1 1 P 1\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
346	            file.write("GROUP\n")
347	            file.write("1 1 P 1\n\n")
348	            file.write("CELLP\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
347	            file.write("1 1 P 1\n\n")
348	            file.write("CELLP\n")
349	            file.write(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
348	            file.write("CELLP\n")
349	            file.write(
350	                f"{structure.lattice.a} {structure.lattice.b} {structure.lattice.c} "
351	                f"{structure.lattice.alpha} {structure.lattice.beta} {structure.lattice.gamma}\n"
352	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
352	            )
353	            file.write("  0.000000   0.000000   0.000000   0.000000   0.000000   0.000000\n")  # error on parameters
354	            file.write("STRUC\n")  # codespell:ignore struc

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
353	            file.write("  0.000000   0.000000   0.000000   0.000000   0.000000   0.000000\n")  # error on parameters
354	            file.write("STRUC\n")  # codespell:ignore struc
355	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
356	            for site_idx, site in enumerate(structure, start=1):
357	                file.write(
358	                    f"{site_idx} {site.species_string} {site.species_string}{site_idx} 1.0000 {site.frac_coords[0]} "
359	                    f"{site.frac_coords[1]} {site.frac_coords[2]} 1a 1\n"
360	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
360	                )
361	                file.write(" 0.000000 0.000000 0.000000 0.00\n")  # error on positions - zero here
362	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
363	            # now we iterate over the whole structure and write down the fractional coordinates (with errors)
364	            file.write("  0 0 0 0 0 0 0\n")
365	            file.write("THERT 0\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
364	            file.write("  0 0 0 0 0 0 0\n")
365	            file.write("THERT 0\n")
366	            file.write("THERM\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
365	            file.write("THERT 0\n")
366	            file.write("THERM\n")
367	            # print all U11s (make sure they are in the correct order)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
370	            for atom_therm, site in zip(matrix_cif, structure, strict=True):
371	                file.write(
372	                    f"{counter} {site.species_string}{counter} {atom_therm[0]} "
373	                    f"{atom_therm[1]} {atom_therm[2]} {atom_therm[5]} {atom_therm[4]} {atom_therm[3]}\n"
374	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
375	                counter += 1
376	            file.write("  0 0 0 0 0 0 0 0\n")
377	            file.write("VECTR\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
376	            file.write("  0 0 0 0 0 0 0 0\n")
377	            file.write("VECTR\n")
378	            vector_count = site_count = 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
386	
387	                file.write(f"    {vector_count} {vector0_x} {vector0_y} {vector0_z} 0\n")
388	                file.write(f"    {site_count} 0 0 0 0\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
387	                file.write(f"    {vector_count} {vector0_x} {vector0_y} {vector0_z} 0\n")
388	                file.write(f"    {site_count} 0 0 0 0\n")
389	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
389	
390	                file.write(" 0 0 0 0 0\n")
391	                vector_count += 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
391	                vector_count += 1
392	                file.write(f"    {vector_count} {vector1_x} {vector1_y} {vector1_z} 0\n")
393	                file.write(f"    {site_count} 0 0 0 0\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
392	                file.write(f"    {vector_count} {vector1_x} {vector1_y} {vector1_z} 0\n")
393	                file.write(f"    {site_count} 0 0 0 0\n")
394	                vector_count += 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
395	                site_count += 1
396	                file.write(" 0 0 0 0 0\n")
397	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
397	
398	            file.write(" 0 0 0 0 0\n")
399	            file.write("VECTT\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
398	            file.write(" 0 0 0 0 0\n")
399	            file.write("VECTT\n")
400	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
403	            for _ in range(len(result)):
404	                file.write(f"{counter} 0.2 255 0 0 1\n")
405	                counter += 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
405	                counter += 1
406	                file.write(f"{counter} 0.2 0 0 255 1\n")
407	                counter += 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/phonon/thermal_displacements.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
408	
409	            file.write(" 0 0 0 0 0\n")
410	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/symmetry/analyzer.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
243	        spg_num = self._space_group_data.number
244	        system = self.get_crystal_system()
245	        if spg_num in {146, 148, 155, 160, 161, 166, 167}:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/symmetry/analyzer.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
254	        """
255	        cry_sys = self.get_crystal_system()
256	        spg_sym = self.get_space_group_symbol()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/symmetry/analyzer.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
539	        if "C" in self.get_space_group_symbol() or "A" in self.get_space_group_symbol():
540	            if self.get_crystal_system() == "monoclinic":
541	                return np.array([[1, 1, 0], [-1, 1, 0], [0, 0, 2]], dtype=np.float64) / 2

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/symmetry/maggroups.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
554	    out = (
555	        "Data parsed from raw data from:\n"
556	        "ISO-MAG, ISOTROPY Software Suite, iso.byu.edu\n"
557	        "http://stokes.byu.edu/iso/magnetic_data.txt\n"
558	        "Used with kind permission from Professor Branton Campbell, BYU\n\n"
559	    )
560	    all_msgs = list(map(MagneticSpaceGroup, range(1, 1652)))
561	    for msg in all_msgs:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/src/pymatgen/symmetry/maggroups.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
563	    with open(filename, mode="w", encoding="utf-8") as file:
564	        file.write(out)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymatgen-2025.4.10/pymatgen-2025.4.10/tests/test_pkg.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
18	    with open(SRC_TXT_PATH, encoding="utf-8") as file:
19	        sources = file.read()
20	

--------------------------------------------------

Code scanned:
	Total lines of code: 157839
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 76.0
		High: 405.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 472.0
		High: 9.0
Files skipped (0):
