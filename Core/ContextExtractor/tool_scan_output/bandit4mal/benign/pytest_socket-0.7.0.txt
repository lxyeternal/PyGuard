Run started:2025-04-12 15:54:44.077608

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/pytest_socket.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
249	        ):
250	            return _true_connect(inst, *args)
251	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_async.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    testdir.makepyfile(
37	        """
38	        import pytest
39	        import httpx

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_combinations.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    testdir.makepyfile(
15	        f"""
16	        import pytest
17	        import requests
18	
19	
20	        @pytest.mark.parametrize(
21	            "url",
22	            [
23	                "https://google.com",
24	                "https://amazon.com",
25	                "https://microsoft.com",
26	            ],
27	        )
28	        def test_domain(url, socket_enabled):
29	            requests.get(url)
30	
31	        def test_localhost_works():
32	            requests.get("{httpbin.url}/")
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_combinations.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    testdir.makepyfile(
15	        f"""
16	        import pytest
17	        import requests
18	
19	
20	        @pytest.mark.parametrize(
21	            "url",
22	            [
23	                "https://google.com",
24	                "https://amazon.com",
25	                "https://microsoft.com",
26	            ],
27	        )
28	        def test_domain(url, socket_enabled):
29	            requests.get(url)
30	
31	        def test_localhost_works():
32	            requests.get("{httpbin.url}/")
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_precedence.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	    testdir.makepyfile(
151	        f"""
152	        from urllib.request import urlopen
153	
154	        def test_urlopen():
155	            assert urlopen("{httpbin.url}/")
156	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
4	
5	localhost = "127.0.0.1"
6	
7	connect_code_template = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	
25	urlopen_code_template = """
26	    import pytest
27	    from urllib.request import urlopen
28	
29	    {3}
30	    def {2}():
31	        assert urlopen('http://{0}:{1}/').getcode() == 200
32	"""
33	
34	urlopen_hostname_code_template = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	
34	urlopen_hostname_code_template = """
35	    import pytest
36	    from urllib.request import urlopen
37	
38	    {3}
39	    def {2}():
40	        # Skip {{1}} as we expect {{0}} to be the full hostname with or without port
41	        assert urlopen('http://{0}').getcode() == 200
42	"""
43	
44	
45	def assert_host_blocked(result, host):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
137	        cli_arg="localhost",
138	        host="1.2.3.4",
139	        code_template=urlopen_hostname_code_template,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
167	def test_multiple_mark_arg_list_connect_enabled(assert_connect):
168	    assert_connect(True, mark_arg=[localhost, "1.2.3.4"])
169	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
171	def test_mark_cli_conflict_mark_wins_connect_enabled(assert_connect):
172	    assert_connect(True, mark_arg=[localhost], cli_arg="1.2.3.4")
173	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
176	    assert_connect(
177	        False, cli_arg="1.2.3.4", code_template=connect_unicode_code_template
178	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
185	def test_single_mark_arg_connect_disabled(assert_connect):
186	    assert_connect(False, mark_arg="1.2.3.4")
187	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
193	def test_multiple_mark_arg_list_connect_disabled(assert_connect):
194	    assert_connect(False, mark_arg=["5.6.7.8", "1.2.3.4"])
195	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
193	def test_multiple_mark_arg_list_connect_disabled(assert_connect):
194	    assert_connect(False, mark_arg=["5.6.7.8", "1.2.3.4"])
195	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
197	def test_mark_cli_conflict_mark_wins_connect_disabled(assert_connect):
198	    assert_connect(False, mark_arg=["1.2.3.4"], cli_arg=localhost)
199	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
212	    assert_connect(
213	        True, mark_arg=[localhost, "1.2.3.4"], code_template=urlopen_code_template
214	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
233	    result.assert_outcomes(0, 0, 1)
234	    assert_host_blocked(result, "127.0.0.1")
235	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_restrict_hosts.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
298	    result.assert_outcomes(1, 0, 2)
299	    assert_host_blocked(result, "2.2.2.2")
300	    assert_host_blocked(result, httpbin.host)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_socket.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	    testdir.makepyfile(
145	        """
146	        try:
147	            from urllib.request import urlopen

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_socket.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	    testdir.makepyfile(
163	        """
164	        import pytest
165	        import pytest_socket

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pytest_socket-0.7.0/pytest_socket-0.7.0/tests/test_socket.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	    testdir.makepyfile(
184	        """
185	        import pytest
186	        try:

--------------------------------------------------

Code scanned:
	Total lines of code: 923
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 1.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 0.0
Files skipped (0):
