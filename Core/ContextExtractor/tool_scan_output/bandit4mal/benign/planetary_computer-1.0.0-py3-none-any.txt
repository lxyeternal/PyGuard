Run started:2025-04-12 10:28:05.346021

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
281	        if storage_options is None:
282	            storage_options = extra_d.get("xarray:open_kwargs", {}).get(
283	                "storage_options", None
284	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
281	        if storage_options is None:
282	            storage_options = extra_d.get("xarray:open_kwargs", {}).get(
283	                "storage_options", None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	            storage_options = (
288	                extra_d.get("xarray:open_kwargs", {})
289	                .get("backend_kwargs", {})
290	                .get("storage_options", None)
291	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	            storage_options = (
288	                extra_d.get("xarray:open_kwargs", {})
289	                .get("backend_kwargs", {})
290	                .get("storage_options", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	            storage_options = (
288	                extra_d.get("xarray:open_kwargs", {})
289	                .get("backend_kwargs", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	            return
295	        account = storage_options.get("account_name")
296	        container = parse_adlfs_url(href)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
404	
405	    elif mapping.get("type") == "FeatureCollection" and mapping.get("features"):
406	        for feature in mapping["features"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
404	
405	    elif mapping.get("type") == "FeatureCollection" and mapping.get("features"):
406	        for feature in mapping["features"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
406	        for feature in mapping["features"]:
407	            for k, v in feature.get("assets", {}).items():
408	                v["href"] = sign_url(v["href"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	    """
446	    settings = Settings.get()
447	    token_request_url = f"{settings.sas_url}/{account_name}/{container_name}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	    token_request_url = f"{settings.sas_url}/{account_name}/{container_name}"
448	    token = TOKEN_CACHE.get(token_request_url)
449	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/sas.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
461	        session.mount("https://", adapter)
462	        response = session.get(
463	            token_request_url,
464	            headers=(
465	                {"Ocp-Apim-Subscription-Key": settings.subscription_key}
466	                if settings.subscription_key
467	                else None
468	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/settings.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	
11	DEFAULT_SAS_TOKEN_ENDPOINT = "https://planetarycomputer.microsoft.com/api/sas/v1/token"
12	
13	
14	def set_subscription_key(key: str) -> None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/planetary_computer-1.0.0-py3-none-any/planetary_computer/utils.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	asset_xpr = re.compile(
95	    r"https://(?P<account>[A-z0-9]+?)"
96	    r"\.blob\.core\.windows\.net/"
97	    r"(?P<container>.+?)"

--------------------------------------------------

Code scanned:
	Total lines of code: 589
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 0.0
Files skipped (0):
