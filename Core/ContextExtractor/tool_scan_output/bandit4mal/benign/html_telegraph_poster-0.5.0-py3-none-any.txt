Run started:2025-04-12 12:12:40.727003

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/converter.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    # convert telegram embed posts before cleaner
44	    html_string = re.sub(telegram_embed_script_re, r'<iframe src="https://t.me/\1"></iframe>', html_string)
45	    # remove <head> if present (can't do this with Cleaner)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/converter.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	                    yt_id = urlparse(iframe_src).path.replace('/embed/', '')
184	                    element.set('src', '/embed/youtube?url=' + quote_plus('https://www.youtube.com/watch?v=' + yt_id))
185	                elif vimeo:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/converter.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	                elif vimeo:
186	                    element.set('src', '/embed/vimeo?url=' + quote_plus('https://vimeo.com/' + vimeo.group(2)))
187	                elif telegram:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/converter.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
367	
368	def convert_json_to_html(elements, base_url='http://telegra.ph'):
369	    content = html.fragment_fromstring('<div></div>')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/create_account.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
10	    with open('.env', 'a',) as f:
11	        f.write('\n\nTELEGRAPH_ACCESS_TOKEN=%s' % t.access_token)
12	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	base_url = 'http://telegra.ph'
10	save_url = 'https://edit.telegra.ph/save'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	base_url = 'http://telegra.ph'
10	save_url = 'https://edit.telegra.ph/save'
11	api_url = 'https://api.telegra.ph'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	save_url = 'https://edit.telegra.ph/save'
11	api_url = 'https://api.telegra.ph'
12	default_user_agent = 'Python_telegraph_poster/0.1'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
46	
47	        response = r.post(save_url, timeout=4, headers=headers, cookies=cookies, data=m.to_string())
48	        result = json.loads(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	        if 'path' in result:
50	            result['tph_uuid'] = response.cookies.get('tph_uuid') or tph_uuid
51	            result['url'] = telegraph_base_url + '/' + result['path']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
93	
94	    resp = requests.post(telegraph_api_url + method, data=_prepare_page_upload_params(params), headers=request_headers).json()
95	    if resp['ok'] is True:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	    if resp['ok'] is True:
96	        return resp.get('result')
97	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	
111	    resp = requests.get(api_url+'/createAccount', params, headers={'User-Agent': user_agent})
112	    json_data = resp.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	            params['access_token'] = self.access_token
146	        resp = requests.get(self.telegraph_api_url + '/' + method, params, headers={'User-Agent': self.user_agent})
147	        return resp.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	
193	        return self._api_request('getAccountInfo', {
194	            'fields': json.dumps(fields) if fields else ''
195	        }).get('result')
196	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
192	
193	        return self._api_request('getAccountInfo', {
194	            'fields': json.dumps(fields) if fields else ''
195	        }).get('result')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	            params['author_url'] = author_url
217	        return self._api_request('editAccountInfo', params).get('result')
218	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
216	            params['author_url'] = author_url
217	        return self._api_request('editAccountInfo', params).get('result')
218	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
226	        """
227	        json_response = self._api_request('getPage', {
228	            'path': path,
229	            'return_content': return_content
230	        })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	            json_response['result']['html'] = convert_json_to_html(json_response['result']['content'], self.telegraph_base_url)
233	        return json_response.get('result')
234	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
241	        """
242	        json_response = self._api_request('getPageList', {
243	            'offset': offset,
244	            'limit': limit
245	        })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	        })
246	        return json_response.get('result')
247	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	        """
262	        return self._api_request('getViews', {
263	            'path': path,
264	            'year': year,
265	            'month': month,
266	            'day': day,
267	            'hour': hour
268	        }).get('result')
269	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
261	        """
262	        return self._api_request('getViews', {
263	            'path': path,
264	            'year': year,
265	            'month': month,
266	            'day': day,
267	            'hour': hour
268	        }).get('result')

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
296	
297	        json_response = self._api_request('revokeAccessToken')
298	        if json_response['ok'] is True:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/html_to_telegraph.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
306	        """
307	        return self.post(*args, **kwargs)
308	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/upload_images.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	from io import BytesIO
6	base_url = 'http://telegra.ph'
7	save_url = 'https://edit.telegra.ph/save'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/upload_images.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	base_url = 'http://telegra.ph'
7	save_url = 'https://edit.telegra.ph/save'
8	upload_file_url = 'https://telegra.ph/upload'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/upload_images.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	save_url = 'https://edit.telegra.ph/save'
8	upload_file_url = 'https://telegra.ph/upload'
9	
10	
11	class Error(Exception):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/upload_images.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	        if ext:
36	            return mimetypes.types_map.get(ext, mimetypes.common_types.get(ext, ''))
37	    return ''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/upload_images.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	        if ext:
36	            return mimetypes.types_map.get(ext, mimetypes.common_types.get(ext, ''))
37	    return ''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/upload_images.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	        try:
53	            img = requests.get(file_name_or_url, headers={'User-Agent': user_agent}, timeout=get_timeout)
54	        except:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/upload_images.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
81	    try:
82	        json_response = requests.post(upload_file_url, timeout=upload_timeout, files=files, headers=headers)
83	    except requests.exceptions.ReadTimeout:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/upload_images.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	        elif type(json_response) is dict:
93	            if json_response.get('error') == 'File type invalid':
94	                raise FileTypeNotSupported('This file is unsupported')

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/html_telegraph_poster-0.5.0-py3-none-any/html_telegraph_poster/utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
40	
41	        with concurrent.futures.ThreadPoolExecutor(max_workers=max_workers) as executor:
42	            for image in images:

--------------------------------------------------

Code scanned:
	Total lines of code: 764
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 0.0
Files skipped (0):
