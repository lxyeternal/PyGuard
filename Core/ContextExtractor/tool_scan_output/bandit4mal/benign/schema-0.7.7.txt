Run started:2025-04-12 13:00:02.056151

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/schema.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
819	                        "$id": schema_id,
820	                        "$schema": "http://json-schema.org/draft-07/schema#",
821	                    }
822	                )
823	                if self._name:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    keywords="schema json validation",
24	    url="https://github.com/keleshev/schema",
25	    py_modules=["schema"],

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
100	def test_validate_file():
101	    assert Schema(Use(open)).validate("LICENSE-MIT").read().startswith("Copyright")
102	    with SE:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
460	    assert len(data["<file>"]) == 1
461	    assert data["<file>"][0].read().startswith("Copyright")
462	    assert data["<path>"] == "./"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
884	    assert s.json_schema("my-id") == {
885	        "$schema": "http://json-schema.org/draft-07/schema#",
886	        "$id": "my-id",
887	        "properties": {"test": {"type": "string"}},
888	        "required": ["test"],
889	        "additionalProperties": False,
890	        "type": "object",
891	    }
892	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
896	    assert s.json_schema("my-id") == {
897	        "$schema": "http://json-schema.org/draft-07/schema#",
898	        "$id": "my-id",
899	        "title": "Testing a schema",
900	        "properties": {"test": {"type": "string"}},
901	        "required": ["test"],
902	        "additionalProperties": False,
903	        "type": "object",
904	    }
905	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
916	    assert s.json_schema("my-id") == {
917	        "$schema": "http://json-schema.org/draft-07/schema#",
918	        "$id": "my-id",
919	        "properties": {
920	            "test_str": {"type": "string"},
921	            "test_int": {"type": "integer"},
922	            "test_float": {"type": "number"},
923	            "test_bool": {"type": "boolean"},
924	        },
925	        "required": [],
926	        "additionalProperties": False,
927	        "type": "object",
928	    }
929	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
934	    assert s.json_schema("my-id") == {
935	        "$schema": "http://json-schema.org/draft-07/schema#",
936	        "$id": "my-id",
937	        "properties": {"test_other": {"type": "string"}},
938	        "required": [],
939	        "additionalProperties": False,
940	        "type": "object",
941	    }
942	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
946	    assert s.json_schema("my-id") == {
947	        "$schema": "http://json-schema.org/draft-07/schema#",
948	        "$id": "my-id",
949	        "properties": {
950	            "test": {
951	                "type": "object",
952	                "properties": {"other": {"type": "string"}},
953	                "additionalProperties": True,
954	                "required": ["other"],
955	            }
956	        },
957	        "required": ["test"],
958	        "additionalProperties": True,
959	        "type": "object",
960	    }
961	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
965	    assert s.json_schema("my-id") == {
966	        "$schema": "http://json-schema.org/draft-07/schema#",
967	        "$id": "my-id",
968	        "properties": {
969	            "test": {
970	                "type": "object",
971	                "properties": {"other": {"type": "string"}},
972	                "additionalProperties": True,
973	                "required": ["other"],
974	            }
975	        },
976	        "required": ["test"],
977	        "additionalProperties": False,
978	        "type": "object",
979	    }
980	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
984	    assert s.json_schema("my-id") == {
985	        "$schema": "http://json-schema.org/draft-07/schema#",
986	        "$id": "my-id",
987	        "properties": {"test": {"type": "string"}},
988	        "required": [],
989	        "additionalProperties": False,
990	        "type": "object",
991	    }
992	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:997
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
996	    assert s.json_schema("my-id") == {
997	        "$schema": "http://json-schema.org/draft-07/schema#",
998	        "$id": "my-id",
999	        "properties": {
1000	            "test": {
1001	                "type": "object",
1002	                "properties": {"other": {"type": "string"}},
1003	                "additionalProperties": False,
1004	                "required": [],
1005	            }
1006	        },
1007	        "required": ["test"],
1008	        "additionalProperties": False,
1009	        "type": "object",
1010	    }
1011	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1015	    assert s.json_schema("my-id") == {
1016	        "$schema": "http://json-schema.org/draft-07/schema#",
1017	        "$id": "my-id",
1018	        "properties": {"test1": {"type": "string"}, "test2": {"type": "string"}},
1019	        "required": [],
1020	        "additionalProperties": False,
1021	        "type": "object",
1022	    }
1023	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1027	    assert s.json_schema("my-id") == {
1028	        "$schema": "http://json-schema.org/draft-07/schema#",
1029	        "$id": "my-id",
1030	        "properties": {"param": {"enum": ["test1", "test2"]}},
1031	        "required": ["param"],
1032	        "additionalProperties": False,
1033	        "type": "object",
1034	    }
1035	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1039	    assert s.json_schema("my-id") == {
1040	        "$schema": "http://json-schema.org/draft-07/schema#",
1041	        "$id": "my-id",
1042	        "properties": {
1043	            "param": {
1044	                "anyOf": [
1045	                    {"type": "array", "items": {"type": "string"}},
1046	                    {"type": "array", "items": {"type": "array"}},
1047	                ]
1048	            }
1049	        },
1050	        "required": ["param"],
1051	        "additionalProperties": False,
1052	        "type": "object",
1053	    }
1054	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1058	    assert s.json_schema("my-id") == {
1059	        "$schema": "http://json-schema.org/draft-07/schema#",
1060	        "$id": "my-id",
1061	        "properties": {"whatever": {"enum": ["test1", "test2"]}},
1062	        "required": [],
1063	        "additionalProperties": False,
1064	        "type": "object",
1065	    }
1066	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1070	    assert s.json_schema("my-id") == {
1071	        "$schema": "http://json-schema.org/draft-07/schema#",
1072	        "$id": "my-id",
1073	        "properties": {
1074	            "username": {"type": "string", "pattern": "[a-zA-Z][a-zA-Z0-9]{3,}"}
1075	        },
1076	        "required": [],
1077	        "additionalProperties": False,
1078	        "type": "object",
1079	    }
1080	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1084	    assert s.json_schema("my-id") == {
1085	        "$schema": "http://json-schema.org/draft-07/schema#",
1086	        "$id": "my-id",
1087	        "properties": {"test": {"anyOf": [{"type": "string"}, {"type": "integer"}]}},
1088	        "required": ["test"],
1089	        "additionalProperties": False,
1090	        "type": "object",
1091	    }
1092	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1097
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1096	    assert s.json_schema("my-id") == {
1097	        "$schema": "http://json-schema.org/draft-07/schema#",
1098	        "$id": "my-id",
1099	        "properties": {"test": {"type": "string"}},
1100	        "required": ["test"],
1101	        "additionalProperties": False,
1102	        "type": "object",
1103	    }
1104	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1109	    assert s.json_schema("my-id") == {
1110	        "$schema": "http://json-schema.org/draft-07/schema#",
1111	        "$id": "my-id",
1112	        "properties": {"test": {"type": "string"}},
1113	        "required": ["test"],
1114	        "additionalProperties": False,
1115	        "type": "object",
1116	    }
1117	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1121	    assert s.json_schema("my-id") == {
1122	        "$schema": "http://json-schema.org/draft-07/schema#",
1123	        "$id": "my-id",
1124	        "properties": {"test": {"const": True}},
1125	        "required": ["test"],
1126	        "additionalProperties": False,
1127	        "type": "object",
1128	    }
1129	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1133	    assert s.json_schema("my-id") == {
1134	        "$schema": "http://json-schema.org/draft-07/schema#",
1135	        "$id": "my-id",
1136	        "properties": {"test": {"const": None}},
1137	        "required": ["test"],
1138	        "additionalProperties": False,
1139	        "type": "object",
1140	    }
1141	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1148	    assert s.json_schema("my-id") == {
1149	        "$schema": "http://json-schema.org/draft-07/schema#",
1150	        "$id": "my-id",
1151	        "properties": {"test": {}},
1152	        "required": ["test"],
1153	        "additionalProperties": False,
1154	        "type": "object",
1155	    }
1156	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1164	    assert s.json_schema("my-id") == {
1165	        "$schema": "http://json-schema.org/draft-07/schema#",
1166	        "$id": "my-id",
1167	        "properties": {"test": {"const": "Hello!"}},
1168	        "required": ["test"],
1169	        "additionalProperties": False,
1170	        "type": "object",
1171	    }
1172	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1180	    assert s.json_schema("my-id") == {
1181	        "$schema": "http://json-schema.org/draft-07/schema#",
1182	        "$id": "my-id",
1183	        "properties": {"test": {"default": "Hello!", "type": "string"}},
1184	        "required": [],
1185	        "additionalProperties": False,
1186	        "type": "object",
1187	    }
1188	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1195	    assert s.json_schema("my-id") == {
1196	        "$schema": "http://json-schema.org/draft-07/schema#",
1197	        "$id": "my-id",
1198	        "properties": {"test": {"default": "Hello!", "type": "string"}},
1199	        "required": [],
1200	        "additionalProperties": False,
1201	        "type": "object",
1202	    }
1203	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1210	    assert s.json_schema("my-id", name="World!") == {
1211	        "$schema": "http://json-schema.org/draft-07/schema#",
1212	        "$id": "my-id",
1213	        "properties": {"test": {"default": "Hello, World!", "type": "string"}},
1214	        "required": [],
1215	        "additionalProperties": False,
1216	        "type": "object",
1217	    }
1218	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1224	    assert s.json_schema("my-id") == {
1225	        "$schema": "http://json-schema.org/draft-07/schema#",
1226	        "$id": "my-id",
1227	        "properties": {
1228	            "test": {
1229	                "anyOf": [
1230	                    {
1231	                        "additionalProperties": False,
1232	                        "properties": {
1233	                            "param1": {"const": "test1"},
1234	                            "param2": {"const": "test2"},
1235	                        },
1236	                        "required": ["param1"],
1237	                        "type": "object",
1238	                    },
1239	                    {
1240	                        "type": "array",
1241	                        "items": {
1242	                            "additionalProperties": False,
1243	                            "properties": {
1244	                                "param1": {"const": "test1"},
1245	                                "param2": {"const": "test2"},
1246	                            },
1247	                            "required": ["param1"],
1248	                            "type": "object",
1249	                        },
1250	                    },
1251	                ]
1252	            }
1253	        },
1254	        "required": ["test"],
1255	        "additionalProperties": False,
1256	        "type": "object",
1257	    }
1258	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1262	    assert s.json_schema("my-id") == {
1263	        "$schema": "http://json-schema.org/draft-07/schema#",
1264	        "$id": "my-id",
1265	        "properties": {"test1": {"allOf": [{"type": "string"}, {"const": "test2"}]}},
1266	        "required": ["test1"],
1267	        "additionalProperties": False,
1268	        "type": "object",
1269	    }
1270	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1274	    assert s.json_schema("my-id") == {
1275	        "$schema": "http://json-schema.org/draft-07/schema#",
1276	        "$id": "my-id",
1277	        "properties": {
1278	            "param1": {
1279	                "allOf": [
1280	                    {"type": "array", "items": {"enum": ["choice1", "choice2"]}},
1281	                    {"type": "array"},
1282	                ]
1283	            }
1284	        },
1285	        "required": ["param1"],
1286	        "additionalProperties": False,
1287	        "type": "object",
1288	    }
1289	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1293	    assert s.json_schema("my-id") == {
1294	        "$schema": "http://json-schema.org/draft-07/schema#",
1295	        "$id": "my-id",
1296	        "properties": {"test": {"type": "string"}},
1297	        "required": ["test"],
1298	        "additionalProperties": False,
1299	        "type": "object",
1300	    }
1301	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1317	    assert s.json_schema("my-id") == {
1318	        "$schema": "http://json-schema.org/draft-07/schema#",
1319	        "$id": "my-id",
1320	        "required": [],
1321	        "properties": {},
1322	        "additionalProperties": additional_properties,
1323	        "type": "object",
1324	    }
1325	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1329	    assert s.json_schema("my-id") == {
1330	        "$schema": "http://json-schema.org/draft-07/schema#",
1331	        "$id": "my-id",
1332	        "required": ["named_property"],
1333	        "properties": {"named_property": {"type": "boolean"}},
1334	        "additionalProperties": True,
1335	        "type": "object",
1336	    }
1337	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1359	        "$id": "my-id",
1360	        "$schema": "http://json-schema.org/draft-07/schema#",
1361	    }
1362	
1363	
1364	@mark.parametrize(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1374	        "$id": "my-id",
1375	        "$schema": "http://json-schema.org/draft-07/schema#",
1376	    }
1377	
1378	
1379	def test_json_schema_regex_root():
1380	    json_schema = Schema(Regex("^v\\d+")).json_schema("my-id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1385	        "$id": "my-id",
1386	        "$schema": "http://json-schema.org/draft-07/schema#",
1387	    }
1388	
1389	
1390	def test_json_schema_dict_type():
1391	    json_schema = Schema({Optional("test1", default={}): dict}).json_schema("my-id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1398	        "$id": "my-id",
1399	        "$schema": "http://json-schema.org/draft-07/schema#",
1400	    }
1401	
1402	
1403	def test_json_schema_title_and_description():
1404	    s = Schema(
1405	        {Literal("productId", description="The unique identifier for a product"): int},
1406	        name="Product",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1409	    assert s.json_schema("my-id") == {
1410	        "$schema": "http://json-schema.org/draft-07/schema#",
1411	        "$id": "my-id",
1412	        "title": "Product",
1413	        "description": "A product in the catalog",
1414	        "properties": {
1415	            "productId": {
1416	                "description": "The unique identifier for a product",
1417	                "type": "integer",
1418	            }
1419	        },
1420	        "required": ["productId"],
1421	        "additionalProperties": False,
1422	        "type": "object",
1423	    }
1424	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1434	    assert s.json_schema("my-id") == {
1435	        "$schema": "http://json-schema.org/draft-07/schema#",
1436	        "$id": "my-id",
1437	        "properties": {
1438	            "test1": {
1439	                "default": {},
1440	                "description": "A description here",
1441	                "anyOf": [
1442	                    {"items": {"type": "string"}, "type": "array"},
1443	                    {"items": {"type": "array"}, "type": "array"},
1444	                ],
1445	            }
1446	        },
1447	        "required": [],
1448	        "additionalProperties": False,
1449	        "type": "object",
1450	    }
1451	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1484	        "$id": "my-id",
1485	        "$schema": "http://json-schema.org/draft-07/schema#",
1486	    }
1487	
1488	
1489	def test_json_schema_literal_with_enum():
1490	    s = Schema(
1491	        {
1492	            Literal("test", description="A test"): Or(
1493	                Literal("literal1", description="A literal with description"),
1494	                Literal("literal2", description="Another literal with description"),
1495	            )
1496	        }
1497	    )
1498	    assert s.json_schema("my-id") == {
1499	        "type": "object",
1500	        "properties": {
1501	            "test": {"description": "A test", "enum": ["literal1", "literal2"]}
1502	        },
1503	        "required": ["test"],
1504	        "additionalProperties": False,
1505	        "$id": "my-id",
1506	        "$schema": "http://json-schema.org/draft-07/schema#",
1507	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1505	        "$id": "my-id",
1506	        "$schema": "http://json-schema.org/draft-07/schema#",
1507	    }
1508	
1509	
1510	def test_json_schema_description_and_nested():
1511	    s = Schema(
1512	        {
1513	            Optional(
1514	                Or(
1515	                    Literal("test1", description="A description here"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1541	        "$id": "my-id",
1542	        "$schema": "http://json-schema.org/draft-07/schema#",
1543	    }
1544	
1545	
1546	def test_description():
1547	    s = Schema(
1548	        {Optional(Literal("test1", description="A description here"), default={}): dict}
1549	    )
1550	    assert s.validate({"test1": {}})
1551	
1552	
1553	def test_description_with_default():
1554	    s = Schema(
1555	        {Optional(Literal("test1", description="A description here"), default={}): dict}
1556	    )
1557	    assert s.validate({}) == {"test1": {}}
1558	
1559	
1560	def test_json_schema_ref_in_list():
1561	    s = Schema(
1562	        Or(
1563	            Schema([str], name="Inner test", as_reference=True),
1564	            Schema([str], name="Inner test2", as_reference=True),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1578	        "$id": "my-id",
1579	        "$schema": "http://json-schema.org/draft-07/schema#",
1580	    }
1581	
1582	
1583	def test_json_schema_refs():
1584	    s = Schema({"test1": str, "test2": str, "test3": str})
1585	    hashed = "#" + str(hash(repr(sorted({"type": "string"}.items()))))
1586	    generated_json_schema = s.json_schema("my-id", use_refs=True)
1587	
1588	    # The order can change, so let's check indirectly
1589	    assert generated_json_schema["type"] == "object"
1590	    assert sorted(generated_json_schema["required"]) == ["test1", "test2", "test3"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1592	    assert generated_json_schema["$id"] == "my-id"
1593	    assert generated_json_schema["$schema"] == "http://json-schema.org/draft-07/schema#"
1594	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1753	        "$id": "my-id",
1754	        "$schema": "http://json-schema.org/draft-07/schema#",
1755	        "definitions": {
1756	            "sub_schema": {
1757	                "type": "object",
1758	                "properties": {"sub_key1": {"type": "integer"}},
1759	                "required": ["sub_key1"],
1760	                "additionalProperties": False,
1761	            }
1762	        },
1763	    }
1764	
1765	
1766	def test_json_schema_definitions_and_literals():
1767	    sub_schema = Schema(
1768	        {Literal("sub_key1", description="Sub key 1"): int},
1769	        name="sub_schema",
1770	        as_reference=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1797	        "$id": "my-id",
1798	        "$schema": "http://json-schema.org/draft-07/schema#",
1799	        "definitions": {
1800	            "sub_schema": {
1801	                "description": "Sub Schema",
1802	                "type": "object",
1803	                "properties": {
1804	                    "sub_key1": {"description": "Sub key 1", "type": "integer"}
1805	                },
1806	                "required": ["sub_key1"],
1807	                "additionalProperties": False,
1808	            }
1809	        },
1810	    }
1811	
1812	
1813	def test_json_schema_definitions_nested():
1814	    sub_sub_schema = Schema(
1815	        {"sub_sub_key1": int}, name="sub_sub_schema", as_reference=True
1816	    )
1817	    sub_schema = Schema(
1818	        {"sub_key1": int, "sub_key2": sub_sub_schema},
1819	        name="sub_schema",
1820	        as_reference=True,
1821	    )
1822	    main_schema = Schema({"main_key1": str, "main_key2": sub_schema})
1823	
1824	    json_schema = main_schema.json_schema("my-id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1833	        "$id": "my-id",
1834	        "$schema": "http://json-schema.org/draft-07/schema#",
1835	        "definitions": {
1836	            "sub_schema": {
1837	                "type": "object",
1838	                "properties": {
1839	                    "sub_key1": {"type": "integer"},
1840	                    "sub_key2": {"$ref": "#/definitions/sub_sub_schema"},
1841	                },
1842	                "required": ["sub_key1", "sub_key2"],
1843	                "additionalProperties": False,
1844	            },
1845	            "sub_sub_schema": {
1846	                "type": "object",
1847	                "properties": {"sub_sub_key1": {"type": "integer"}},
1848	                "required": ["sub_sub_key1"],
1849	                "additionalProperties": False,
1850	            },
1851	        },
1852	    }
1853	
1854	
1855	def test_json_schema_definitions_recursive():
1856	    """Create a JSON schema with an object that refers to itself
1857	
1858	    This is the example from here: https://json-schema.org/understanding-json-schema/structuring.html#recursion
1859	    """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1871	        "$id": "my-id",
1872	        "$schema": "http://json-schema.org/draft-07/schema#",
1873	        "title": "person",
1874	        "definitions": {
1875	            "person": {
1876	                "type": "object",
1877	                "properties": {
1878	                    "name": {"type": "string"},
1879	                    "children": {
1880	                        "type": "array",
1881	                        "items": {"$ref": "#/definitions/person"},
1882	                    },
1883	                },
1884	                "required": [],
1885	                "additionalProperties": False,
1886	            }
1887	        },
1888	    }
1889	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1903	        "$id": "my-id",
1904	        "$schema": "http://json-schema.org/draft-07/schema#",
1905	    }
1906	
1907	
1908	def test_json_schema_default_value_with_literal():
1909	    s = Schema({Optional(Literal("test1"), default=False): bool})
1910	    assert s.json_schema("my-id") == {
1911	        "type": "object",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1916
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1915	        "$id": "my-id",
1916	        "$schema": "http://json-schema.org/draft-07/schema#",
1917	    }
1918	
1919	
1920	def test_json_schema_default_is_none():
1921	    s = Schema({Optional("test1", default=None): str})
1922	    assert s.json_schema("my-id") == {
1923	        "type": "object",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1927	        "$id": "my-id",
1928	        "$schema": "http://json-schema.org/draft-07/schema#",
1929	    }
1930	
1931	
1932	def test_json_schema_default_is_tuple():
1933	    s = Schema({Optional("test1", default=(1, 2)): list})
1934	    assert s.json_schema("my-id") == {
1935	        "type": "object",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1939	        "$id": "my-id",
1940	        "$schema": "http://json-schema.org/draft-07/schema#",
1941	    }
1942	
1943	
1944	def test_json_schema_default_is_literal():
1945	    s = Schema({Optional("test1", default=Literal("Hello!")): str})
1946	    assert s.json_schema("my-id") == {
1947	        "type": "object",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/schema-0.7.7/schema-0.7.7/test_schema.py:1952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1951	        "$id": "my-id",
1952	        "$schema": "http://json-schema.org/draft-07/schema#",
1953	    }
1954	
1955	
1956	def test_prepend_schema_name():
1957	    try:
1958	        Schema({"key1": int}).validate({"key1": "a"})
1959	    except SchemaError as e:

--------------------------------------------------

Code scanned:
	Total lines of code: 2465
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 51.0
		High: 2.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 53.0
		High: 0.0
Files skipped (0):
