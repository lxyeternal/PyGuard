Run started:2025-04-12 17:21:38.909964

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/_grib_idx.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
144	    except UnicodeDecodeError:
145	        enocded_val = (b"base64:" + base64.b64encode(data_bytes)).decode("ascii")
146	    zstore[f"{key}/{vkey}"] = enocded_val

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/_grib_idx.py:145
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
144	    except UnicodeDecodeError:
145	        enocded_val = (b"base64:" + base64.b64encode(data_bytes)).decode("ascii")
146	    zstore[f"{key}/{vkey}"] = enocded_val

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/_grib_idx.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
435	    with fsspec.open(fpath, "wb") as f:
436	        f.write(compressed)
437	    logger.info("Wrote %d bytes to %s", len(compressed), fpath)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/_grib_idx.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
448	    with fsspec.open(fpath, "rb") as f:
449	        compressed = f.read()
450	    logger.info("Read %d bytes from %s", len(compressed), fpath)

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/codecs.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
328	        if out:
329	            out[:] = zlib.decompress(data)
330	            return out

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/codecs.py:329
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
328	        if out:
329	            out[:] = zlib.decompress(data)
330	            return out

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/codecs.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
330	            return out
331	        return zlib.decompress(data)
332	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/codecs.py:331
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
330	            return out
331	        return zlib.decompress(data)
332	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/df.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
29	    if r.startswith(b"base64:"):
30	        return base64.b64decode(r[7:])
31	    return r

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/df.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
29	    if r.startswith(b"base64:"):
30	        return base64.b64decode(r[7:])
31	    return r

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/grib2.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        raise ImportError(
41	            "cfgrib is needed to kerchunk GRIB2 files. Please install it with "
42	            "`conda install -c conda-forge cfgrib`. See https://github.com/ecmwf/cfgrib "
43	            "for more details."

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/grib2.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
105	        except UnicodeDecodeError:
106	            b = b"base64:" + base64.b64encode(data)
107	        store[f"{var}/0"] = b.decode("ascii")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/grib2.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
105	        except UnicodeDecodeError:
106	            b = b"base64:" + base64.b64encode(data)
107	        store[f"{var}/0"] = b.decode("ascii")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/grib2.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
603	    except UnicodeDecodeError:
604	        enocded_val = (b"base64:" + base64.b64encode(step_bytes)).decode("ascii")
605	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/grib2.py:604
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
603	    except UnicodeDecodeError:
604	        enocded_val = (b"base64:" + base64.b64encode(step_bytes)).decode("ascii")
605	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/hdf.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    raise ImportError(
25	        "h5py is required for kerchunking HDF5/NetCDF4 files. Please install with "
26	        "`pip/conda install h5py`. See https://docs.h5py.org/en/latest/build.html "
27	        "for more details."

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/hdf.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
532	                            except UnicodeDecodeError:
533	                                data = b"base64:" + base64.b64encode(data)
534	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/hdf.py:533
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
532	                            except UnicodeDecodeError:
533	                                data = b"base64:" + base64.b64encode(data)
534	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/mzML.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
10	    def decode(self, buf, out=None):
11	        buf2 = base64.b64decode(buf)
12	        if out:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/mzML.py:11
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
10	    def decode(self, buf, out=None):
11	        buf2 = base64.b64decode(buf)
12	        if out:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/mzML.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
17	    def encode(self, buf):
18	        return base64.b64encode(buf)
19	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/mzML.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
17	    def encode(self, buf):
18	        return base64.b64encode(buf)
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/netCDF3.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    raise ImportError(
20	        "Scipy is required for kerchunking NetCDF3 files. Please install with "
21	        "`pip/conda install scipy`. See https://scipy.org/install/ for more details."
22	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
122	            except UnicodeDecodeError:
123	                out[k] = (b"base64:" + base64.b64encode(v)).decode()
124	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:123
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
122	            except UnicodeDecodeError:
123	                out[k] = (b"base64:" + base64.b64encode(v)).decode()
124	        else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
205	            except UnicodeDecodeError:
206	                store[k] = "base64:" + base64.b64encode(v).decode()
207	    return store

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:206
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
205	            except UnicodeDecodeError:
206	                store[k] = "base64:" + base64.b64encode(v).decode()
207	    return store

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
217	        v = compressor.encode(v)
218	        v = str(base64.standard_b64encode(v), "ascii")
219	        return v

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
240	    elif dtype.kind in "SV":
241	        v = str(base64.standard_b64encode(v), "ascii")
242	        return v

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
284	        except UnicodeDecodeError:
285	            v = b"base64:" + base64.b64encode(v)
286	        out[k] = v

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:285
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
284	        except UnicodeDecodeError:
285	            v = b"base64:" + base64.b64encode(v)
286	        out[k] = v

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/utils.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
456	    for target, tar_or_zip in target_files:
457	        with fsspec.open(target, **(remote_options or {})) as tf:
458	            if tar_or_zip == "tar":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kerchunk-0.2.8/kerchunk-0.2.8/kerchunk/xarray_backend.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    description = "Open Kerchunk References with Xarray"
34	    url = "https://fsspec.github.io/kerchunk/"
35	

--------------------------------------------------

Code scanned:
	Total lines of code: 4744
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 12.0
Files skipped (0):
