Run started:2025-04-12 14:42:34.988329

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/__main__.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
14	    config = uvicorn.Config(app    = "cbr_website_beta.fast_api_main:app",
15	                            host   = "0.0.0.0"                           ,
16	                            port   = port                                ,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/_testing/website/CBR__Login.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        super().setUp()
12	        self.cognito_host  = 'https://the-cbr-beta.auth.eu-west-2.amazoncognito.com'
13	        self.cbr_pages     = CBR__Pages    ()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/chat/chat_routes.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    url_for_screenshot = f'{current_server()}web/chat/view/{path}'                 # todo: add path validation
52	    screenshot_data_url = f'https://serverless-flows.dev.aws.cyber-boardroom.com/browser/url-screenshot?url={url_for_screenshot}'
53	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/chat/chat_routes.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	    target_server = current_server()
73	    if target_server == "http://localhost:5001/":
74	        target_server = "https://dev.cyber-boardroom.com/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/chat/chat_routes.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	    if target_server == "http://localhost:5001/":
74	        target_server = "https://dev.cyber-boardroom.com/"
75	    url_for_screenshot = f'{target_server}web/chat/view/{path}'                 # todo: add path validation

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/chat/chat_routes.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    url_for_screenshot = f'{target_server}web/chat/view/{path}'                 # todo: add path validation
76	    pdf_data_url = f'https://serverless-flows.dev.aws.cyber-boardroom.com/browser/url-pdf?url={url_for_screenshot}'
77	    pdf_data     = GET_json(pdf_data_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/config.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    #ASSETS_ROOT               = os.getenv('ASSETS_ROOT', server_config__cbr_website.assets_root())
9	    STATIC_SERVER             = os.getenv('STATIC_SERVER'            , 'https://static.dev.aws.cyber-boardroom.com/'                         )
10	    CBR__SITE__WEB_COMPONENTS = os.getenv('CBR__SITE__WEB_COMPONENTS', 'https://static.dev.aws.cyber-boardroom.com/cbr-web-components/latest')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/config.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    STATIC_SERVER             = os.getenv('STATIC_SERVER'            , 'https://static.dev.aws.cyber-boardroom.com/'                         )
10	    CBR__SITE__WEB_COMPONENTS = os.getenv('CBR__SITE__WEB_COMPONENTS', 'https://static.dev.aws.cyber-boardroom.com/cbr-web-components/latest')
11	    ASSETS_ROOT               = os.getenv('CBR__SITE__STATIC'        , 'https://static.dev.aws.cyber-boardroom.com/cbr-static/latest/assets' )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/config.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    CBR__SITE__WEB_COMPONENTS = os.getenv('CBR__SITE__WEB_COMPONENTS', 'https://static.dev.aws.cyber-boardroom.com/cbr-web-components/latest')
11	    ASSETS_ROOT               = os.getenv('CBR__SITE__STATIC'        , 'https://static.dev.aws.cyber-boardroom.com/cbr-static/latest/assets' )
12	    GTA_ENABLED               = server_config__cbr_website.gta_enabled()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/dev/view_data.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	
8	useful_links = [{'label': 'Athena - Fast API (PROD )'  , 'url': 'https://athena.thecyberboardroom.com'  , 'target': '_blank'},
9	                {'label': 'Athena - Fast API (DEV  )'  , 'url': 'https://athena-dev.cyber-boardroom.com', 'target': '_blank'},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/dev/view_data.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	useful_links = [{'label': 'Athena - Fast API (PROD )'  , 'url': 'https://athena.thecyberboardroom.com'  , 'target': '_blank'},
9	                {'label': 'Athena - Fast API (DEV  )'  , 'url': 'https://athena-dev.cyber-boardroom.com', 'target': '_blank'},
10	                {'label': 'Athena - Fast API (LOCAL)'  , 'url': 'http://localhost:5111'                 , 'target': '_blank'},]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/dev/view_data.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	                {'label': 'Athena - Fast API (DEV  )'  , 'url': 'https://athena-dev.cyber-boardroom.com', 'target': '_blank'},
10	                {'label': 'Athena - Fast API (LOCAL)'  , 'url': 'http://localhost:5111'                 , 'target': '_blank'},]
11	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/dev/view_data.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	                 {'label': 'Current Sessions'     , 'url': '/dev/current-sessions', 'target': ''      },
14	                 {'label': 'Athena Prompts'       , 'url': 'https://github.com/the-cyber-boardroom/cbr-hf-gradio/tree/main/docs/prompts', 'target': '_blank'      },
15	                 {'label': 'Security content'     , 'url': 'https://github.com/the-cyber-boardroom/cbr-athena/tree/main/docs'          , 'target': '_blank'}]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/dev/view_data.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	                 {'label': 'Athena Prompts'       , 'url': 'https://github.com/the-cyber-boardroom/cbr-hf-gradio/tree/main/docs/prompts', 'target': '_blank'      },
15	                 {'label': 'Security content'     , 'url': 'https://github.com/the-cyber-boardroom/cbr-athena/tree/main/docs'          , 'target': '_blank'}]
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/home/home_routes.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	
7	COGNITO_SIGN_IN       = 'https://the-cbr-beta.auth.eu-west-2.amazoncognito.com/login?client_id=5ij6l5kdho4umoks5rjfh9cbid&response_type=code&scope=email+openid+phone&redirect_uri={cbr_domain}/web/sign-in'
8	COGNITO_SIGN_OUT      = 'https://the-cbr-beta.auth.eu-west-2.amazoncognito.com/logout?client_id=5ij6l5kdho4umoks5rjfh9cbid&response_type=code&scope=email+openid+phone&logout_uri={cbr_domain}/web/sign-out'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/home/home_routes.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	COGNITO_SIGN_IN       = 'https://the-cbr-beta.auth.eu-west-2.amazoncognito.com/login?client_id=5ij6l5kdho4umoks5rjfh9cbid&response_type=code&scope=email+openid+phone&redirect_uri={cbr_domain}/web/sign-in'
8	COGNITO_SIGN_OUT      = 'https://the-cbr-beta.auth.eu-west-2.amazoncognito.com/logout?client_id=5ij6l5kdho4umoks5rjfh9cbid&response_type=code&scope=email+openid+phone&logout_uri={cbr_domain}/web/sign-out'
9	CBR_DOMAIN            = 'https://www.thecyberboardroom.com'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/home/home_routes.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	COGNITO_SIGN_OUT      = 'https://the-cbr-beta.auth.eu-west-2.amazoncognito.com/logout?client_id=5ij6l5kdho4umoks5rjfh9cbid&response_type=code&scope=email+openid+phone&logout_uri={cbr_domain}/web/sign-out'
9	CBR_DOMAIN            = 'https://www.thecyberboardroom.com'
10	#DEV_DOMAIN            = 'http://localhost:5000'
11	EXPECTED_ROUTES__HOME = [ '/<path:path>' , '/terms_and_conditions', '/service-worker.js']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/home/home_routes.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	    if ':5001' in target_server:
86	        target_server   = "https://dev.cyber-boardroom.com/"
87	    url_for_screenshot  = f'{target_server}{path}'                                                                                  # todo: add path validation

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/home/home_routes.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	    url_for_screenshot  = f'{target_server}{path}'                                                                                  # todo: add path validation
88	    screenshot_data_url = f'https://serverless-flows.dev.aws.cyber-boardroom.com/browser/url-screenshot?url={url_for_screenshot}'   # todo: refactor to separate class for serverless-flows
89	    screenshot_data     = GET_json(screenshot_data_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/apps/user/user_routes.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	
5	LOCAL_DEV_SERVER     = 'http://localhost:5000/'
6	COGNITO_PROJECT      = 'the-cbr-beta'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/apigateway/web_sockets/server/TestCase__WS_Server.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	        cls.port          = cls.find_free_port()
29	        cls.server_thread = threading.Thread(target=cls.socketio.run, args=(cls.app,), kwargs={'port': cls.port})
30	        cls.server_thread.daemon = True  # This allows the thread to be killed when the main thread exits

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/apigateway/web_sockets/server/TestCase__WS_Server.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
31	        cls.server_thread.start()
32	        wait_for_port('127.0.0.1',cls.port)
33	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/apigateway/web_sockets/server/TestCase__WS_Server.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
41	    def find_free_port():
42	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
43	            s.bind(('', 0))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/apigateway/web_sockets/server/TestCase__WS_Server.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	        url = urljoin(self.url(), path)
48	        return requests.get(url).text
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/apigateway/web_sockets/server/TestCase__WS_Server.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    def url(self):
51	        return f'http://localhost:{self.port}'

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/apigateway/web_sockets/server/WS__Flask_Server.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
76	            print('Received message:', message)
77	            send(f'Response back to the message: {message}')
78	            #self.sent_manually('manual message')

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/apigateway/web_sockets/server/WS__Flask_Server.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
98	            print('Received json:', json)
99	            send(reply, json=True)
100	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/apigateway/web_sockets/server/WS__Flask_Server.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
127	        socketio = flask.current_app.extensions['socketio']
128	        response = socketio.send(message, json=json, namespace=namespace, to=to,
129	                             include_self=include_self, skip_sid=skip_sid,
130	                             callback=callback, ignore_queue=ignore_queue)
131	        print(response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
24	        }
25	        response = requests.post(token_url, data=payload, headers=headers)
26	        return response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	            cognito_tokens = self.convert_auth_code_to_auth_data(sign_in_code, redirect_uri)
37	            access_token   = cognito_tokens.get('access_token')
38	            user_info      = self.parse_jwt_token(access_token)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	        db_users  = cbr_shared_objects.db_users()
55	        user_name = user_info.get('username')
56	        user_id   = user_info.get('sub')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	        user_name = user_info.get('username')
56	        user_id   = user_info.get('sub')
57	        db_user   =  db_users.db_user(user_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        db_sessions = cbr_shared_objects.db_sessions()
71	        user_name   = user_info.get('username')
72	        user_jti    = user_info.get('jti')              # Cognito's JWT Token Identifier (changes on every login)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        user_name   = user_info.get('username')
72	        user_jti    = user_info.get('jti')              # Cognito's JWT Token Identifier (changes on every login)
73	        user_id     = user_info.get('sub')              # Cognito's User Identifier      (never changes)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	        user_jti    = user_info.get('jti')              # Cognito's JWT Token Identifier (changes on every login)
73	        user_id     = user_info.get('sub')              # Cognito's User Identifier      (never changes)
74	        session_id  = user_jti                          # we can use the jti as the session_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	
83	        user_name       = user_info.get('username')
84	        session_id      = user_info.get('jti')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	        user_name       = user_info.get('username')
84	        session_id      = user_info.get('jti')
85	        source          = 'CognitoAuth'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/cognito/Cognito_Auth_Flow.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	        if 'session_id' in response:
94	            session_id           = response.get('session_id')
95	            return session_id

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/aws/s3/docs/CBR_Documentation_In_S3.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	#URL_CBR_STATIC_FILES               = 'https://static.thecyberboardroom.com'                   # this one has some caching issues (due to cloudfront)
20	URL_CBR_STATIC_FILES                = "https://470426667096-cbr.s3.eu-west-2.amazonaws.com/"
21	URL_FILE__DOCUMENTATION_IMAGES      = f'{URL_CBR_STATIC_FILES}/{S3_PATH__DOCUMENTATION_IMAGES}/{S3_FILE_NAME__DOCUMENTATION_IMAGES}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        port                    = server_config__cbr_website.cbr_host__port()
24	        url_from_config         = f'http://localhost:{port}{athena_path_from_config}'    # todo: need a better solution to handle these calls to athena
25	        return url_from_config

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	        url = self.athena_url() + path
29	        response = requests.get(url)
30	        if response.headers.get('Content-Type') == 'application/json':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	        response = requests.get(url)
30	        if response.headers.get('Content-Type') == 'application/json':
31	            return response.json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
35	        url = self.athena_url() + path
36	        response = requests.post(url, json=data)
37	        if response.headers.get('Content-Type') == 'application/json':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	        response = requests.post(url, json=data)
37	        if response.headers.get('Content-Type') == 'application/json':
38	            return response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    #def git_repo_status (self): return self.requests_get('/git_repo_status' )
44	    def open_api        (self): return self.requests_get('/openapi.json'    )
45	    #def ping            (self): return self.requests_get('/ping'            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	    #def ping            (self): return self.requests_get('/ping'            )
46	    def root            (self): return self.requests_get('/'                )
47	    def version         (self): return self.requests_get('/config/version'  )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	    def root            (self): return self.requests_get('/'                )
47	    def version         (self): return self.requests_get('/config/version'  )
48	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
52	    def open_ai__prompt_with_stream(self, data ):
53	        return self.requests_post(PATH__OPENAI__PROMPT_WITH_STREAM, data)
54	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	        json_data = log_entry.dict()
57	        return self.requests_post(PATH__LOGGING__ADD_LOG_ENTRY, json_data)
58	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Athena_Rest_API.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
60	        json_data = create_user_session.dict()
61	        return self.requests_post(PATH__USER__CREATE_USER_SESSION, json_data)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Minerva_Rest_API.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    def __init__(self):
9	        self.url = "https://minerva-dev.cyber-boardroom.com/"
10	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Minerva_Rest_API.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
13	        url = urljoin(self.url, path)
14	        return requests.get(url).json()
15	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Minerva_Rest_API.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
16	    def version(self):
17	        return self.requests_get('/version')
18	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Minerva_Rest_API.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	    def root(self):
21	        return self.requests_get('/')
22	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/bots/Minerva_Rest_API.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	    def aws_cost_explorer(self, days=7):
24	        return self.requests_get(f'/aws_cost_explorer?days={days}')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__fastapi/CBR__Fast_API.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	
201	        @app.get("/")                                # todo: move this to a separate method
202	        def read_root():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__fastapi/CBR__Fast_API.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	
207	        @app.get('/favicon.ico')                    # todo: convert the png below to .ico file (also see what are the side effects of returning a png instead of an ico)
208	        def favicon_ico():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__fastapi/CBR__Fast_API.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	
216	        @app.get('/docs', include_in_schema=False)
217	        async def custom_swagger_ui_html(request: Request):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__fastapi/routes/CBR__WebC__Routes.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	URL__CDN_SERVER    ="https://static.dev.aws.cyber-boardroom.com/cbr-web-components"
10	PAGE__MAIN_PAGE      = 'pages/page-cbr.html'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__flask/register_logging.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	        # capture the fastapi request object
57	        g.request_id = request.headers.get('Fast-Api-Request-Id')
58	        g.request_data = global_vars.fast_api_http_events.requests_data.get(g.request_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__flask/register_logging.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	        g.request_id = request.headers.get('Fast-Api-Request-Id')
58	        g.request_data = global_vars.fast_api_http_events.requests_data.get(g.request_id)
59	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__flask/register_logging.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
81	        try:
82	            cbr_request = create_logging__cbr_request()
83	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__flask/register_logging.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	            document    = dydb_cbr_requests.add_document(document)
86	            document_id = document.get('document').get('id')
87	            print(f'>>>> added request as {document_id} to {dydb_cbr_requests.table_name}')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__flask/register_logging.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	            document    = dydb_cbr_requests.add_document(document)
86	            document_id = document.get('document').get('id')
87	            print(f'>>>> added request as {document_id} to {dydb_cbr_requests.table_name}')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__flask/register_logging.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	        headers = {key: value for key, value in request.headers.items()}
157	        country = headers.get('Cloudfront-Viewer-Country-Name')  # todo refactor to a country and city method
158	        if not country:  # if 'Cloudfront-Viewer-Country-Name' did not had a value

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__flask/register_logging.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158	        if not country:  # if 'Cloudfront-Viewer-Country-Name' did not had a value
159	            country = headers.get('Cloudfront-Viewer-Country', 'NA')  # try Cloudfront-Viewer-Country
160	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/cbr__flask/register_logging.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	        cbr_request.environ = env_vars_to_log()
172	        cbr_request.city = headers.get('Cloudfront-Viewer-City', 'NA')
173	        cbr_request.country = country

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/config/CBR__Site_Info.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	        if port:
128	            return f'http://localhost:{port}{athena_path}'
129	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/utils/IP_Data.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	ENV_VAR__IP_DATA__API_KEY = 'IP_DATA__API_KEY'
9	SERVER__IP_DATA_API       = 'https://api.ipdata.co/'
10	
11	# todo: add support for caching (in dynamodb) the data received from the ipdata.co API since it shouldn't change that often
12	class IP_Data:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/utils/health_checks/Health_Checks__CBR__Internal_Data.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	                      'iat'           : 1707694293                                                   ,
30	                      'iss'           : 'https://cognito-idp.eu-west-2.amazonaws.com/eu-west-2_BBBBB',
31	                      'jti'           : '2fca243c-cccc-bbbb-aaaa-996f35942d59'                       ,
32	                      'origin_jti'    : '7fe352e1-aaaa-bbbb-cccc-2718eae9ebc5'                       ,
33	                      'scope'         : 'phone openid email'                                         ,
34	                      'sub'           : '48fe1709-aaaa-aaaa-aaaa-6526f1537537'                       ,
35	                      'token_use'     : 'access'                                                     ,
36	                      'username'      : 'an_temp_user_xyz'                                           ,
37	                      'version'       : 2                                                            }
38	        metadata  = {'source': 'pytest'}
39	        db_session = cognito_auth_flow.create_session(user_info, metadata)
40	        assert db_session.exists() is True
41	        assert db_session.delete() is True
42	        return RESULT_OK__cbr_check_session_creation

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/utils/health_checks/Health_Checks__Http__External_Sites.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	    def head__google():
8	        url = 'https://www.google.com'
9	        response = requests.head(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/utils/remote_shell/CBR__Remote_Shell.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	
6	CBR__LAMBDA_SHELL__DEFAULT_SERVER = 'https://dev.cyber-boardroom.com'
7	CBR__LAMBDA_SHELL__PATH           = '{server}/web/dev/lambda-shell'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/utils/remote_shell/CBR__Remote_Shell.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
19	                                     'auth_key'     : auth_key       }}
20	        response = requests.post(url, json=payload)
21	        if response.headers.get('Content-Type') == 'application/json':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cbr_website_beta-0.221.1/cbr_website_beta-0.221.1/cbr_website_beta/utils/remote_shell/CBR__Remote_Shell.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	        response = requests.post(url, json=payload)
21	        if response.headers.get('Content-Type') == 'application/json':
22	            return response.json()

--------------------------------------------------

Code scanned:
	Total lines of code: 4930
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 32.0
		High: 42.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 73.0
		High: 1.0
Files skipped (0):
