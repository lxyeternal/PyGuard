Run started:2025-04-12 13:41:41.165104

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    version='1.31.0',
13	    description='Python library and command-line utility for Shodan (https://developer.shodan.io)',
14	    long_description=README,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    author_email='jmath@shodan.io',
18	    url='https://github.com/achillean/shodan-python',
19	    packages=['shodan', 'shodan.cli', 'shodan.cli.converter'],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	    # Check that the converter allows a custom list of fields
107	    converter_class = CONVERTERS.get(format)
108	    if fields:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
126	    finished_event = threading.Event()
127	    progress_bar_thread = threading.Thread(target=async_spinner, args=(finished_event,))
128	    progress_bar_thread.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
233	    with open(keyfile, 'w') as fout:
234	        fout.write(key.strip())
235	        click.echo(click.style('Successfully initialized', fg='green'))

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
236	
237	    os.chmod(keyfile, 0o600)
238	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:237
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
236	
237	    os.chmod(keyfile, 0o600)
238	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
440	                if color:
441	                    tmp = click.style(tmp, fg=COLORIZE_FIELDS.get(field, 'white'))
442	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
460	    if ipv6:
461	        api.base_url = 'https://apiv6.shodan.io'
462	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
528	                if color:
529	                    tmp = click.style(tmp, fg=COLORIZE_FIELDS.get(field, 'white'))
530	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
724	    def _create_stream(name, args, timeout):
725	        return {
726	            'all': api.stream.banners(timeout=timeout),
727	            'alert': api.stream.alert(args, timeout=timeout),
728	            'asn': api.stream.asn(args, timeout=timeout),
729	            'countries': api.stream.countries(args, timeout=timeout),
730	            'custom_filters': api.stream.custom(args, timeout=timeout),
731	            'ports': api.stream.ports(args, timeout=timeout),
732	            'tags': api.stream.tags(args, timeout=timeout),
733	            'vulns': api.stream.vulns(args, timeout=timeout),
734	        }.get(name, 'all')
735	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
786	                            if color:
787	                                tmp = click.style(tmp, fg=COLORIZE_FIELDS.get(field, 'white'))
788	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
630	@main.command()
631	@click.option('--streamer', help='Specify a custom Shodan stream server to use for grabbing data.', default='https://stream.shodan.io', type=str)
632	@click.option('--fields', help='List of properties to output.', default='ip_str,port,hostnames,data')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
848	    result_facets = []
849	    if results.get("facets"):
850	        result_facets = list(results["facets"].keys())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/__main__.py:869
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
868	                line = json.dumps(match) + '\n'
869	                fout.write(line.encode('utf-8'))
870	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/converter/images.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	                fout = open(filename, 'wb')
50	                fout.write(decode(screenshot['data'].encode(), 'base64'))
51	                fout.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/converter/kml.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    def header(self):
9	        self.fout.write("""<?xml version="1.0" encoding="UTF-8"?>
10	<kml xmlns="http://www.opengis.net/kml/2.2">

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/converter/kml.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	            if 'hostnames' in host and host['hostnames']:
46	                placemark += '<div><a style="color: #999;margin-top:-10px;padding-top:0;" href="http://{0}" target="_blank">{0}</a></div>'.format(host['hostnames'][0])
47	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/converter/kml.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	
73	            placemark += """
74	                <div style="text-align:center"><a href="https://www.shodan.io/host/{0}" style="display: inline-block;

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/data.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	            # Show the SHA1 checksum if available
32	            if file.get('sha1'):
33	                click.echo(click.style('{:42s}'.format(file['sha1']), fg='green'), nl=False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/data.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	    # Start downloading the file
71	    response = requests.get(file['url'], stream=True)
72	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/data.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	    # Figure out the size of the file based on the headers
74	    filesize = response.headers.get('content-length', None)
75	    if not filesize:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/helpers.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
31	    if not oct(os.stat(keyfile).st_mode).endswith("600"):
32	        os.chmod(keyfile, 0o600)
33	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/helpers.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
31	    if not oct(os.stat(keyfile).st_mode).endswith("600"):
32	        os.chmod(keyfile, 0o600)
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/helpers.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	    with open(keyfile, 'r') as fin:
35	        return fin.read().strip()
36	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/cli/helpers.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	    while not finished.is_set():
116	        sys.stdout.write('\b{}'.format(next(spinner)))
117	        sys.stdout.flush()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
59	            """
60	            return self.parent._request('/shodan/data', {})
61	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
66	            """
67	            return self.parent._request('/shodan/data/{}'.format(dataset), {})
68	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
83	                args['type'] = type
84	            return self.parent._request('/dns/domain/{}'.format(domain), args)
85	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
106	
107	            return self.parent._request('/notifier', args, method='post')
108	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
117	            """
118	            return self.parent._request('/notifier/{}'.format(nid), args, method='put')
119	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
126	            """
127	            return self.parent._request('/notifier/{}'.format(nid), {})
128	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
133	            """
134	            return self.parent._request('/notifier', {})
135	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
140	            """
141	            return self.parent._request('/notifier/provider', {})
142	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
149	            """
150	            return self.parent._request('/notifier/{}'.format(nid), {}, method='delete')
151	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
161	            """
162	            return self.parent._request('/tools/myip', {})
163	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
187	
188	            return self.parent._request('/api/search', query_args, service='exploits')
189	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
206	
207	            return self.parent._request('/api/count', query_args, service='exploits')
208	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
221	            """
222	            return self.parent._request('/labs/honeyscore/{}'.format(ip), {})
223	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
238	            """
239	            return self.parent._request('/org/member/{}'.format(user), {
240	                'notify': notify,
241	            }, method='PUT')['success']
242	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
245	            """
246	            return self.parent._request('/org', {})
247	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
255	            """
256	            return self.parent._request('/org/member/{}'.format(user), {}, method='DELETE')['success']
257	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
277	
278	            return self.parent._request('/api/v1/search', args, service='trends')
279	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
284	            """
285	            return self.parent._request('/api/v1/search/facets', {}, service='trends')
286	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
291	            """
292	            return self.parent._request('/api/v1/search/filters', {}, service='trends')
293	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	        self.api_key = key
303	        self.base_url = 'https://api.shodan.io'
304	        self.base_exploits_url = 'https://exploits.shodan.io'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
303	        self.base_url = 'https://api.shodan.io'
304	        self.base_exploits_url = 'https://exploits.shodan.io'
305	        self.base_trends_url = 'https://trends.shodan.io'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
304	        self.base_exploits_url = 'https://exploits.shodan.io'
305	        self.base_trends_url = 'https://trends.shodan.io'
306	        self.data = self.Data(self)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	        
323	        if os.environ.get('SHODAN_API_URL'):
324	            self.base_url = os.environ.get('SHODAN_API_URL')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
323	        if os.environ.get('SHODAN_API_URL'):
324	            self.base_url = os.environ.get('SHODAN_API_URL')
325	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	        # Determine the base_url based on which service we're interacting with
341	        base_url = {
342	            'shodan': self.base_url,
343	            'exploits': self.base_exploits_url,
344	            'trends': self.base_trends_url,
345	        }.get(service, 'shodan')
346	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
356	                if json_data:
357	                    data = self._session.post(base_url + function, params=params,
358	                                            data=json.dumps(json_data),
359	                                            headers={'content-type': 'application/json'},
360	                        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
361	                else:
362	                    data = self._session.post(base_url + function, params)
363	            elif method == 'put':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
367	            else:
368	                data = self._session.get(base_url + function, params=params)
369	            self._api_query_time = time.time()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
420	            query_args['facets'] = create_facet_string(facets)
421	        return self._request('/shodan/host/count', query_args)
422	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
440	            params['minify'] = minify
441	        return self._request('/shodan/host/{}'.format(','.join(ips)), params)
442	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
446	        """
447	        return self._request('/api-info', {})
448	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
453	        """
454	        return self._request('/shodan/ports', {})
455	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
460	        """
461	        return self._request('/shodan/protocols', {})
462	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
494	
495	        return self._request('/shodan/scan', params, method='post')
496	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
502	        """
503	        return self._request('/shodan/scans', {
504	            'page': page,
505	        })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
521	
522	        return self._request('/shodan/scan/internet', params, method='post')
523	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
531	        """
532	        return self._request('/shodan/scan/{}'.format(scan_id), {})
533	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
570	
571	        return self._request('/shodan/host/search', args)
572	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
629	        """
630	        return self._request('/shodan/host/search/facets', {})
631	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
636	        """
637	        return self._request('/shodan/host/search/filters', {})
638	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
649	        }
650	        return self._request('/shodan/host/search/tokens', query_args)
651	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
656	        """
657	        return self._request('/shodan/services', {})
658	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
675	        }
676	        return self._request('/shodan/query', args)
677	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
691	        }
692	        return self._request('/shodan/query/search', args)
693	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
704	        }
705	        return self._request('/shodan/query/tags', args)
706	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
724	
725	        response = self._request('/shodan/alert', params={}, json_data=data, method='post')
726	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
744	
745	        response = self._request('/shodan/alert/{}'.format(aid), params={}, json_data=data, method='post')
746	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
755	
756	        response = self._request(func, params={
757	            'include_expired': include_expired,
758	        })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
765	
766	        response = self._request(func, params={}, method='delete')
767	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
774	        """
775	        return self._request('/shodan/alert/triggers', {})
776	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
778	        """Enable the given trigger on the alert."""
779	        return self._request('/shodan/alert/{}/trigger/{}'.format(aid, trigger), {}, method='put')
780	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
782	        """Disable the given trigger on the alert."""
783	        return self._request('/shodan/alert/{}/trigger/{}'.format(aid, trigger), {}, method='delete')
784	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
790	        if trigger in ('vulnerable', 'vulnerable_unverified') and vulns and isinstance(vulns, list):
791	            return self._request('/shodan/alert/{}/trigger/{}/ignore/{}:{}/{}'.format(aid, trigger, ip, port, ','.join(vulns)), {}, method='put')
792	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
792	
793	        return self._request('/shodan/alert/{}/trigger/{}/ignore/{}:{}'.format(aid, trigger, ip, port), {}, method='put')
794	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
796	        """Re-enable trigger notifications for the provided IP and port"""
797	        return self._request('/shodan/alert/{}/trigger/{}/ignore/{}:{}'.format(aid, trigger, ip, port), {}, method='delete')
798	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
800	        """Enable the given notifier for an alert that has triggers enabled."""
801	        return self._request('/shodan/alert/{}/notifier/{}'.format(aid, nid), {}, method='put')
802	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/client.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
804	        """Remove the given notifier for an alert that has triggers enabled."""
805	        return self._request('/shodan/alert/{}/notifier/{}'.format(aid, nid), {}, method='delete')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/helpers.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	
27	def api_request(key, function, params=None, data=None, base_url='https://api.shodan.io',
28	                method='get', retries=1, proxies=None):
29	    """General-purpose function to create web requests to SHODAN.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/helpers.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
48	            if method.lower() == 'post':
49	                data = requests.post(base_url + function, json.dumps(data), params=params,
50	                                     headers={'content-type': 'application/json'},
51	                                     proxies=proxies)
52	            elif method.lower() == 'delete':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/helpers.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	            else:
57	                data = requests.get(base_url + function, params=params, proxies=proxies)
58	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/helpers.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	    # Raise an exception if an error occurred
83	    if type(data) == dict and data.get('error', None):
84	        raise APIError(data['error'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/stream.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	    base_url = 'https://stream.shodan.io'
11	
12	    def __init__(self, api_key, proxies=None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/stream.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	            while True:
38	                req = requests.get(stream_url, params=params, stream=True, timeout=timeout,
39	                                   proxies=self.proxies)
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/threatnet.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	        base_url = 'https://stream.shodan.io'
18	
19	        def __init__(self, parent, proxies=None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/threatnet.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	            try:
25	                req = requests.get(self.base_url + name, params={'key': self.parent.api_key},
26	                                   stream=True, proxies=self.proxies)
27	            except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/shodan/threatnet.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        self.api_key = key
66	        self.base_url = 'https://api.shodan.io'
67	        self.stream = self.Stream(self)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/tests/test_shodan.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
76	    def test_host_details(self):
77	        host = self.api.host('147.228.101.7')
78	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shodan-1.31.0/shodan-1.31.0/tests/test_shodan.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
78	
79	        self.assertEqual('147.228.101.7', host['ip_str'])
80	        self.assertFalse(isinstance(host['ip'], basestring))

--------------------------------------------------

Code scanned:
	Total lines of code: 3250
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 76.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 92.0
		High: 2.0
Files skipped (0):
