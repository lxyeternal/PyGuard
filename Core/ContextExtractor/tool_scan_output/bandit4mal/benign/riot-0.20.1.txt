Run started:2025-04-12 11:38:19.916281

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
197	            logger.info("Deleting virtualenv '%s'", venv_path)
198	            shutil.rmtree(venv_path)
199	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
325	            # TODO: Cache the file content to avoid re-reading it
326	            ns_out.write(
327	                ns_in.read().replace(
328	                    "sys._getframe(1).f_locals['sitedir']",
329	                    f"'{src_sitepkgs}'",
330	                )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
325	            # TODO: Cache the file content to avoid re-reading it
326	            ns_out.write(
327	                ns_in.read().replace(
328	                    "sys._getframe(1).f_locals['sitedir']",
329	                    f"'{src_sitepkgs}'",
330	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
326	            ns_out.write(
327	                ns_in.read().replace(
328	                    "sys._getframe(1).f_locals['sitedir']",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
499	        with open(in_path, "w+b") as f:
500	            f.write(pkgs.encode("utf-8"))
501	            f.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
499	        with open(in_path, "w+b") as f:
500	            f.write(pkgs.encode("utf-8"))
501	            f.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1008	        with tempfile.NamedTemporaryFile() as rcfile:
1009	            rcfile.write()
1010	            rcfile.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1008	        with tempfile.NamedTemporaryFile() as rcfile:
1009	            rcfile.write()
1010	            rcfile.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1060	                with tempfile.NamedTemporaryFile() as rcfile:
1061	                    rcfile.write(
1062	                        SHELL_RCFILE.format(
1063	                            venv_path=venv_path, name=inst.name
1064	                        ).encode()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riot/riot.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1060	                with tempfile.NamedTemporaryFile() as rcfile:
1061	                    rcfile.write(
1062	                        SHELL_RCFILE.format(
1063	                            venv_path=venv_path, name=inst.name
1064	                        ).encode()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/riotfile.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	            name="codecov",
61	            command="bash <(curl -s https://codecov.io/bash)",
62	            pkgs={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/setup.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    description="A simple Python test runner runner.",
10	    url="https://github.com/DataDog/riot",
11	    author="Datadog, Inc.",

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
27	) -> typing.Generator[None, None, None]:
28	    with cli.isolated_filesystem() as fs_dir:
29	        shutil.copy(

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
38	) -> typing.Generator[None, None, None]:
39	    with cli.isolated_filesystem():
40	        yield

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
341	    """Running command with optional infix cmdargs."""
342	    with cli.isolated_filesystem():
343	        with open("riotfile.py", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
343	        with open("riotfile.py", "w") as f:
344	            f.write(
345	                """
346	from riot import Venv

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
384	def test_nested_venv(cli: click.testing.CliRunner) -> None:
385	    with cli.isolated_filesystem():
386	        with open("riotfile.py", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
386	        with open("riotfile.py", "w") as f:
387	            f.write(
388	                """
389	from riot import Venv

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
410	        with open("test_success.py", "w") as f:
411	            f.write(
412	                """
413	def test_success():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
418	        with open("test_failure.py", "w") as f:
419	            f.write(
420	                """
421	def test_failure():

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
441	def test_types(cli: click.testing.CliRunner) -> None:
442	    with cli.isolated_filesystem():
443	        with open("riotfile.py", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
443	        with open("riotfile.py", "w") as f:
444	            f.write(
445	                """
446	from riot import Venv

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
478	def test_env(cli: click.testing.CliRunner) -> None:
479	    with cli.isolated_filesystem():
480	        with open("riotfile.py", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
480	        with open("riotfile.py", "w") as f:
481	            f.write(
482	                """
483	from riot import Venv, latest

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
501	        with open("test_success.py", "w") as f:
502	            f.write(
503	                """
504	import os

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
518	def test_default_env(cli: click.testing.CliRunner) -> None:
519	    with cli.isolated_filesystem():
520	        with open("riotfile.py", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
520	        with open("riotfile.py", "w") as f:
521	            f.write(
522	                """
523	from riot import Venv, latest

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
541	        with open("test_success.py", "w") as f:
542	            f.write(
543	                """
544	import os

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
566	) -> None:
567	    with cli.isolated_filesystem():
568	        with open("riotfile.py", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
568	        with open("riotfile.py", "w") as f:
569	            f.write(
570	                """
571	from riot import Venv

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
588	        with open("test_success.py", "w") as f:
589	            f.write(
590	                """
591	import os

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
606	def test_bad_riotfile_name(cli: click.testing.CliRunner) -> None:
607	    with cli.isolated_filesystem():
608	        with open("riotfile", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
608	        with open("riotfile", "w") as f:
609	            f.write(
610	                """
611	from riot import Venv

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
635	def test_riotfile_execute_error(cli: click.testing.CliRunner) -> None:
636	    with cli.isolated_filesystem():
637	        with open("riotfile.py", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
637	        with open("riotfile.py", "w") as f:
638	            f.write(
639	                """
640	this is invalid syntax

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
652	) -> None:
653	    with cli.isolated_filesystem():
654	        with open("riotfile.py", "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:655
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
654	        with open("riotfile.py", "w") as f:
655	            f.write(
656	                """
657	from riot import Venv

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
679	        with open("test_no_env.py", "w") as f:
680	            f.write(
681	                """
682	import os

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_cli.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
690	        with open("test_env.py", "w") as f:
691	            f.write(
692	                """
693	import os

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_integration.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
849	    setup_path.write_text(
850	        """
851	from setuptools import setup, find_packages
852	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_unit.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
49	    finally:
50	        shutil.rmtree(RIOT_TESTS_PATH, ignore_errors=True)
51	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/riot-0.20.1/riot-0.20.1/tests/test_unit.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
61	    finally:
62	        shutil.rmtree(RIOT_TESTS_PATH, ignore_errors=True)
63	

--------------------------------------------------

Code scanned:
	Total lines of code: 3182
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 39.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 42.0
		High: 0.0
Files skipped (0):
