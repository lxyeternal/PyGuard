Run started:2025-04-12 17:17:07.411519

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/base.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	        if self.reload_config_interval and self.reload_config_action != ReloadConfigAction.DO_NOTHING:
149	            Thread(target=config_refresher, name="ConfigReloader", daemon=True).start()
150	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/base.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
309	            self.logger.info("Starting heartbeat loop")
310	            Thread(target=heartbeat_loop, name="HeartbeatLoop", daemon=True).start()
311	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/configtools/elements.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	    audience: str | None = None
79	    authority: str = "https://login.microsoftonline.com/"
80	    min_ttl: float = 30  # minimum time to live: refresh token ahead of expiration

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/configtools/elements.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
295	    external_id_prefix: str = ""
296	    host: str = "https://api.cognitedata.com"
297	
298	    def get_cognite_client(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/configtools/elements.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
516	    port: int = 9000
517	    host: str = "0.0.0.0"
518	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/configtools/loaders.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
362	        with open(self.config_path) as stream:
363	            self._config_text = stream.read()
364	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/metrics.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	        """
162	        thread = threading.Thread(target=self._proc_collect, name="ProcessMetricsCollector", daemon=True)
163	        thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/metrics.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
213	        """
214	        self.thread = threading.Thread(target=self._run, daemon=True, name=self.thread_name)
215	        self.thread.start()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/threading.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
95	            logger.info("Waiting for threads to complete. Send another interrupt to force quit.")
96	            signal.signal(signal.SIGINT, signal.default_int_handler)
97	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/threading.py:96
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
95	            logger.info("Waiting for threads to complete. Send another interrupt to force quit.")
96	            signal.signal(signal.SIGINT, signal.default_int_handler)
97	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/threading.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
98	        try:
99	            signal.signal(signal.SIGINT, sigint_handler)
100	        except ValueError as e:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/threading.py:99
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
98	        try:
99	            signal.signal(signal.SIGINT, sigint_handler)
100	        except ValueError as e:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/unstable/core/base.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
333	        if startup:
334	            with ThreadPoolExecutor() as pool:
335	                for task in startup:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/unstable/core/runtime.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
114	        self._message_queue = Queue()
115	        process = Process(
116	            target=self._inner_run,
117	            args=(self._message_queue, config),
118	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/unstable/core/runtime.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
160	                if errors:
161	                    client.post(
162	                        f"/api/v1/projects/{client.config.project}/odin/checkin",
163	                        json={
164	                            "externalId": connection_config.integration,
165	                            "errors": [e.model_dump() for e in errors],
166	                        },
167	                        headers={"cdf-version": "alpha"},
168	                    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/unstable/core/runtime.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
176	        try:
177	            client.post(
178	                f"/api/v1/projects/{client.config.project}/odin/checkin",
179	                json={
180	                    "externalId": connection_config.integration,
181	                },
182	                headers={"cdf-version": "alpha"},
183	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
143	            self._pos += size
144	            return self._inner.read(size)
145	        return b""

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173	            raise StreamConsumed()
174	        chunk = self._stream.read(self.CHUNK_SIZE)
175	        while chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
176	            yield chunk
177	            chunk = self._stream.read(self.CHUNK_SIZE)
178	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
247	
248	        self._update_queue_thread = threading.Thread(target=self._remove_done_from_queue, daemon=True)
249	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
259	        with _QUEUES_LOCK:
260	            self._pool = ThreadPoolExecutor(
261	                max_workers=self.parallelism,
262	                thread_name_prefix=f"FileUploadQueue-{_QUEUES}",
263	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
337	        file_meta, url = self._upload_only_metadata(file_meta)
338	        resp = self._httpx_client.send(self._get_file_upload_request(url, file, size, file_meta.mime_type))
339	        resp.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
337	        file_meta, url = self._upload_only_metadata(file_meta)
338	        resp = self._httpx_client.send(self._get_file_upload_request(url, file, size, file_meta.mime_type))
339	        resp.raise_for_status()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
381	        upload_id = returned_file_metadata["uploadId"]
382	        file_meta = FileMetadata.load(returned_file_metadata)
383	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
385	            chunks.next_chunk()
386	            resp = self._httpx_client.send(self._get_file_upload_request(url, chunks, len(chunks), file_meta.mime_type))
387	            resp.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
385	            chunks.next_chunk()
386	            resp = self._httpx_client.send(self._get_file_upload_request(url, chunks, len(chunks), file_meta.mime_type))
387	            resp.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
392	
393	        res = self.cdf_client.files._post(
394	            url_path="/files/completemultipartupload",
395	            json={"id": file_meta.id, "uploadId": upload_id},
396	            headers=completed_headers,
397	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
402	            node_id = self._apply_cognite_file(file_meta)
403	            identifiers = IdentifierSequence.load(instance_ids=node_id).as_singleton()
404	            res = self.cdf_client.files._post(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
403	            identifiers = IdentifierSequence.load(instance_ids=node_id).as_singleton()
404	            res = self.cdf_client.files._post(
405	                url_path="/files/multiuploadlink",
406	                json={"items": identifiers.as_dicts()},
407	                params={"parts": chunks.chunk_count},
408	                headers=_CDF_ALPHA_VERSION_HEADER,
409	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
412	        else:
413	            res = self.cdf_client.files._post(
414	                url_path="/files/initmultipartupload",
415	                json=file_meta.dump(camel_case=True),
416	                params={
417	                    "overwrite": self.overwrite_existing,
418	                    "parts": chunks.chunk_count,
419	                },

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
558	    def _create_cdm(self, instance_id: NodeId) -> tuple[FileMetadata, str]:
559	        identifiers = IdentifierSequence.load(instance_ids=instance_id).as_singleton()
560	        res = self.cdf_client.files._post(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
559	        identifiers = IdentifierSequence.load(instance_ids=instance_id).as_singleton()
560	        res = self.cdf_client.files._post(
561	            url_path="/files/uploadlink",
562	            json={"items": identifiers.as_dicts()},
563	            headers=_CDF_ALPHA_VERSION_HEADER,
564	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cognite_extractor_utils-7.5.13/cognite_extractor_utils-7.5.13/cognite/extractorutils/uploader/files.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
566	        resp_json = res.json()["items"][0]
567	        return FileMetadata.load(resp_json), resp_json["uploadUrl"]
568	

--------------------------------------------------

Code scanned:
	Total lines of code: 6384
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 2.0
Files skipped (0):
