Run started:2025-04-12 20:53:33.516354

Test results:
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
214	        if self.protocol and self.protocol.transport:
215	            self.protocol.transport.close()
216	            self.protocol = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
216	            self.protocol = None
217	        btmgmt_socket.close(self.sock)
218	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
235	        except asyncio.TimeoutError:
236	            btmgmt_socket.close(self.sock)
237	            raise

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
274	
275	        idxdata = await self.protocol.send("ReadControllerIndexList", None)
276	        if idxdata.event_frame.status.value != 0x00:  # 0x00 - Success

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
287	        for idx in hci_idx_list:
288	            hci_info = await self.protocol.send("ReadControllerInformation", idx)
289	            _LOGGER.debug("controller idx %s: %s", idx, hci_info)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
317	        if self.idx is not None:
318	            response = await self.protocol.send("ReadControllerInformation", self.idx)
319	            return response.cmd_response_frame.current_settings.get(

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
326	        assert self.protocol is not None  # nosec
327	        response = await self.protocol.send(
328	            "SetPowered", self.idx, int(new_state is True)
329	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
558	            try:
559	                await adapter.close()
560	            except Exception as ex:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:815
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
814	    """Create a bluetooth socket for a specific adapter."""
815	    sock = socket.socket(AF_BLUETOOTH, socket.SOCK_RAW, BTPROTO_HCI)
816	    sock.bind((adapter_idx,))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bluetooth_auto_recovery-1.4.5/bluetooth_auto_recovery-1.4.5/src/bluetooth_auto_recovery/recover.py:823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
822	    fd = bt_socket.detach()
823	    socket.close(fd)

--------------------------------------------------

Code scanned:
	Total lines of code: 729
	Total lines skipped (#nosec): 7

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 1.0
Files skipped (0):
