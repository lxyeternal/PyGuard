Run started:2025-04-12 14:18:09.631241

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
25	        self.services = services if isinstance(services, list) else [services]
26	        self.threadpool = ThreadPoolExecutor(max_workers=4)
27	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/device_server/device_server.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
248	        self.connector.register(MessageEndpoints.stop_all_devices(), cb=self.on_stop_all_devices)
249	        self.executor = ThreadPoolExecutor(max_workers=4)
250	        self._start_device_manager()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/device_server/tests/utils.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
142	    def read_configuration(self):
143	        return self.read()
144	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/device_server/tests/utils.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
246	        for name in self._read_attrs:
247	            ret.update(getattr(self, name).read())
248	        return ret

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/device_server/tests/utils.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
252	        for name in self._read_config_attrs:
253	            ret.update(getattr(self, name).read())
254	        return ret

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/file_writer/file_writer.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
295	        try:
296	            HDF5StorageWriter.write(writer_storage, file_handle)
297	        finally:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
58	        self.current_queue = None
59	        self.executor = ThreadPoolExecutor(max_workers=4)
60	        self.executor_tasks = collections.deque(maxlen=100)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/scan_server/procedures/manager.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
45	        self.active_workers: dict[str, ProcedureWorkerEntry] = {}
46	        self.executor = ThreadPoolExecutor(
47	            max_workers=MAX_WORKERS, thread_name_prefix="user_procedure_"
48	        )

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/scan_server/scans.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
271	            func_name = self._get_func_name_from_macro(macro)
272	            exec(macro)
273	            eval(func_name)(self.device_manager.devices, self)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/scihub/scilog/scilog.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
36	        """get a new scilog token"""
37	        response = requests.post(
38	            f"{self.host}/users/login",
39	            json={"principal": self.user, "password": self.user_secret},
40	            timeout=5,
41	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/scihub/scilog/scilog.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	    def _load_environment(self):
69	        env_base = self.scihub.config.service_config.get("scilog", {}).get("env_file")
70	        if not env_base:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/bec_server/scihub/scilog/scilog.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	    def _load_environment(self):
69	        env_base = self.scihub.config.service_config.get("scilog", {}).get("env_file")
70	        if not env_base:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_file_writer/test_file_writer.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
74	    ):
75	        file_writer.write("./test.h5", scan_storage_mock, configuration_data={})
76	    with h5py.File("./test.h5", "r") as test_file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_file_writer/test_file_writer.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
172	
173	    file_writer.write("./test.h5", storage, configuration_data={})
174	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_file_writer/test_file_writer.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
195	        mock_get_file_writer_plugins.return_value = {"cSAXS": cSAXSFormat}
196	        file_writer.write(
197	            f"{tmp_path}/test.h5", ScanStorage(2, "scan_id-string"), configuration_data={}
198	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_file_writer/test_file_writer.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
210	        mock_get_file_writer_plugins.return_value = {"cSAXS": cSAXSFormat}
211	        file_writer.write(f"{tmp_path}/test.h5", scan_storage_mock, configuration_data={})
212	    with h5py.File(f"{tmp_path}/test.h5", "r") as test_file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_file_writer/test_file_writer_manager.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
174	    storage.append(1, {"data": "data"})
175	    assert storage.ready_to_write() is True
176	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_file_writer/test_file_writer_manager.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
206	    file_manager.scan_storage["scan_id"].scan_segments = {"0": {"data": np.zeros((10, 10))}}
207	    assert file_manager.scan_storage["scan_id"].ready_to_write() is True
208	    file_manager.scan_storage["scan_id1"] = scan_storage_mock

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_file_writer/test_file_writer_manager.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
211	    file_manager.scan_storage["scan_id1"].scan_segments = {"0": {"data": np.zeros((10, 10))}}
212	    assert file_manager.scan_storage["scan_id1"].ready_to_write() is False
213	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_file_writer/test_file_writer_manager.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
219	    file_manager.scan_storage["scan_id"].forced_finish = True
220	    assert file_manager.scan_storage["scan_id"].ready_to_write() is True
221	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_scan_server/test_scan_worker.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
92	    with mock.patch.object(worker.device_manager, "connector") as connector_mock:
93	        worker.publish_data_as_read(instr)
94	        msg = messages.DeviceMessage(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_scan_server/test_scan_worker.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
97	        connector_mock.set_and_publish.assert_called_once_with(
98	            MessageEndpoints.device_read("samx"), msg
99	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_scan_server/test_scan_worker.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117	    with mock.patch.object(worker.device_manager, "connector") as connector_mock:
118	        worker.publish_data_as_read(instr)
119	        mock_calls = []

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_scan_server/test_scan_worker.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	            msg = messages.DeviceMessage(signals=dev_data, metadata=instr.metadata)
122	            mock_calls.append(mock.call(MessageEndpoints.device_read(device), msg))
123	        assert connector_mock.set_and_publish.mock_calls == mock_calls

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_scihub/test_scilog_connector.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	        mock_dotenv_values.return_value = {
16	            "SCILOG_DEFAULT_HOST": "https://dummy_host",
17	            "SCILOG_USER": "dummy_user",
18	            "SCILOG_USER_SECRET": "dummy_user_secret",
19	        }
20	        SciHubMock.config.service_config = {"scilog": {"env_file": "dummy_env_file"}}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_scihub/test_scilog_connector.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            scilog = SciLogConnector(SciHubMock, mock.MagicMock())
25	            assert scilog.host == "https://dummy_host"
26	            assert scilog.user == "dummy_user"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bec_server-3.28.1/bec_server-3.28.1/tests/tests_scihub/test_scilog_connector.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	                    credentials={
32	                        "url": "https://dummy_host",
33	                        "token": "Bearer dummy_token",
34	                        "user": "dummy_user",
35	                    }
36	                ),

--------------------------------------------------

Code scanned:
	Total lines of code: 20101
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 1.0
Files skipped (0):
