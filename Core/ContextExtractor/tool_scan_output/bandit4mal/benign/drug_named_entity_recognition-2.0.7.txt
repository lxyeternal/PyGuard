Run started:2025-04-12 13:54:58.536473

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/01_drugbank_download_vocabulary.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	
37	response = requests.get("https://go.drugbank.com/releases/latest#open-data")
38	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/01_drugbank_download_vocabulary.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	
37	response = requests.get("https://go.drugbank.com/releases/latest#open-data")
38	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/01_drugbank_download_vocabulary.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	
39	re_url = re.compile(r'\bhttps://go.drugbank.com/releases/[a-z0-9-/]+all-drugbank-vocabulary\b')
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/02_mesh_download_mesh_dump_and_extract_drug_names_and_synonyms.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	mesh_xml_file_name = f"desc{datetime.datetime.now().year}.xml"
41	url = f"https://nlmpubs.nlm.nih.gov/projects/mesh/MESH_FILES/xmlmesh/{mesh_xml_file_name}"
42	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/02_mesh_download_mesh_dump_and_extract_drug_names_and_synonyms.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	print(
48	    f"Downloading MeSH XML dump from {url}. If this URL doesn't work, please navigate to https://www.nlm.nih.gov/ and search the site for a MeSH data dump in XML format.")
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/03_nhs_get_drug_data_from_api.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	# You can get API sandbox credentials from: https://onboarding.prod.api.platform.nhs.uk/MyApplications/ApplicationDetails/EditAPIKeys?appId=27d2bbf8-76a3-4788-8302-bc8740da9491
10	endpoint_url = 'https://int.api.service.nhs.uk/nhs-website-content/medicines'
11	headers = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/03_nhs_get_drug_data_from_api.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	
27	    response = requests.get(endpoint_url, headers=headers, params=params)
28	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/03_nhs_get_drug_data_from_api.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	with open("all_nhs_drugs.json", "w", encoding="utf-8") as f:
52	    f.write(json.dumps(all_nhs_drugs, indent=4))

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/04_wikipedia_extract_drug_names_and_synonyms_from_wikipedia_dump.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
69	    if bytes_read % 100000000 < 2000:
70	        os.system('cls||clear')
71	        print ("num gigabytes seen", bytes_read / 1000000000)

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/04_wikipedia_extract_drug_names_and_synonyms_from_wikipedia_dump.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
69	    if bytes_read % 100000000 < 2000:
70	        os.system('cls||clear')
71	        print ("num gigabytes seen", bytes_read / 1000000000)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/04_wikipedia_extract_drug_names_and_synonyms_from_wikipedia_dump.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        
89	        link = 'https://en.wikipedia.org/wiki/' + urllib.parse.quote(title.encode('utf8'))
90	        

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/05_combine_data_sources.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	
134	    nhs_website_url = re.sub(".+nhs.uk/nhs-website-content", "https://nhs.uk", nhs_drug["url"])
135	    data = {"nhs_api_url": nhs_drug["url"], "nhs_url": nhs_website_url}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/06_optional_check_words_with_ai.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	with open("words_to_check_with_ai.txt", "r", encoding="utf-8") as f:
43	    words_to_check_with_ai = f.read().split("\n")
44	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/06_optional_check_words_with_ai.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
67	        try:
68	            response = requests.post('https://api.openai.com/v1/chat/completions', headers=headers, json=json_data)
69	            r = response.json()["choices"][0]["message"]["content"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/06_optional_check_words_with_ai.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        try:
68	            response = requests.post('https://api.openai.com/v1/chat/completions', headers=headers, json=json_data)
69	            r = response.json()["choices"][0]["message"]["content"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/06_optional_check_words_with_ai.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	        for j in range(idx):
79	            f.write(words_to_check_with_ai[j] + "\t" + bot_responses[j] + "\n")
80	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/harvesting_data_from_source/07_optional_augment_inclusions_list.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	TEMPLATE = """'''
25	MIT License
26	
27	Copyright (c) 2023 Fast Data Science Ltd (https://fastdatascience.com)
28	
29	Maintainer: Thomas Wood
30	
31	Tutorial at https://fastdatascience.com/drug-named-entity-recognition-python-library/
32	
33	Permission is hereby granted, free of charge, to any person obtaining a copy
34	of this software and associated documentation files (the "Software"), to deal
35	in the Software without restriction, including without limitation the rights
36	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
37	copies of the Software, and to permit persons to whom the Software is
38	furnished to do so, subject to the following conditions:
39	
40	The above copyright notice and this permission notice shall be included in all
41	copies or substantial portions of the Software.
42	
43	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
44	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
45	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
46	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
47	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
48	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
49	SOFTWARE.
50	
51	'''
52	
53	common_english_words_to_include_in_drugs_dictionary = """
54	
55	serialised = json.dumps(all_inclusion_words, indent=4)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/setup.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    long_description_content_type="text/markdown",
43	    url="https://fastdatascience.com/drug-named-entity-recognition-python-library",
44	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/setup.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    project_urls={
45	        "Documentation": "https://fastdatascience.com/drug-named-entity-recognition-python-library",
46	        "Bug Reports": "https://github.com/fastdatascience/drug_named_entity_recognition/issues",
47	        "Source Code": "https://github.com/fastdatascience/drug_named_entity_recognition",
48	        # 'Funding': '',
49	        # 'Say Thanks!': '',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        "Documentation": "https://fastdatascience.com/drug-named-entity-recognition-python-library",
46	        "Bug Reports": "https://github.com/fastdatascience/drug_named_entity_recognition/issues",
47	        "Source Code": "https://github.com/fastdatascience/drug_named_entity_recognition",
48	        # 'Funding': '',
49	        # 'Say Thanks!': '',
50	    },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/setup.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        "Bug Reports": "https://github.com/fastdatascience/drug_named_entity_recognition/issues",
47	        "Source Code": "https://github.com/fastdatascience/drug_named_entity_recognition",
48	        # 'Funding': '',
49	        # 'Say Thanks!': '',
50	    },
51	    package_dir={"": "src"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/omop_api.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    try:
41	        url = f"https://rxnav.nlm.nih.gov/REST/rxcui.json?name={drug_name}"
42	        response = requests.get(url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/omop_api.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
41	        url = f"https://rxnav.nlm.nih.gov/REST/rxcui.json?name={drug_name}"
42	        response = requests.get(url)
43	        rxnorm_ids = response.json().get("idGroup", {}).get("rxnormId")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/omop_api.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	        response = requests.get(url)
43	        rxnorm_ids = response.json().get("idGroup", {}).get("rxnormId")
44	        omop_id = rxnorm_ids[0] if rxnorm_ids else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/omop_api.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	        response = requests.get(url)
43	        rxnorm_ids = response.json().get("idGroup", {}).get("rxnormId")
44	        omop_id = rxnorm_ids[0] if rxnorm_ids else None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/structure_file_downloader.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	def download_structures(this_path):
41	    temp_mirror_url = 'https://fastdatascience.z33.web.core.windows.net/drugbank_all_open_structures.sdf.zip'
42	
43	    if not temp_mirror_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/structure_file_downloader.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    if not temp_mirror_url:
44	        response = requests.get("https://go.drugbank.com/releases/latest#open-data")
45	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/structure_file_downloader.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    if not temp_mirror_url:
44	        response = requests.get("https://go.drugbank.com/releases/latest#open-data")
45	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/structure_file_downloader.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	
46	        re_url = re.compile(r'\bhttps://go.drugbank.com/releases/[a-z0-9-/]+all-open-structures\b')
47	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/drug_named_entity_recognition-2.0.7/drug_named_entity_recognition-2.0.7/src/drug_named_entity_recognition/structure_file_downloader.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    # To avoid too much traffic to Drugbank, we download molecule structure data from the mirror at Fast Data Science
55	    url = 'https://fastdatascience.z33.web.core.windows.net/drugbank_all_open_structures.sdf.zip'
56	
57	    print(f"Downloading from Fast Data Science mirror {url}...")

--------------------------------------------------

Code scanned:
	Total lines of code: 2871
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 1.0
Files skipped (0):
