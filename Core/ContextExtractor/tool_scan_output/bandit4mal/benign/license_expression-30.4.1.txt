Run started:2025-04-12 11:02:20.745373

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/docs/source/conf.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	intersphinx_mapping = {
56	    "aboutcode": ("https://aboutcode.readthedocs.io/en/latest/", None),
57	    "scancode-workbench": (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/docs/source/conf.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    "scancode-workbench": (
58	        "https://scancode-workbench.readthedocs.io/en/develop/",
59	        None,
60	    ),
61	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/docs/source/conf.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	intersphinx_mapping = {
68	    "python": ("https://docs.python.org/3", None),
69	    "boolean.py": ("https://booleanpy.readthedocs.io/en/latest/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/docs/source/conf.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	    "python": ("https://docs.python.org/3", None),
69	    "boolean.py": ("https://booleanpy.readthedocs.io/en/latest/", None),
70	}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/gen_pypi_simple.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
163	        with open(archive_file, "rb") as f:
164	            checksum = hashlib.sha256(f.read()).hexdigest()
165	        return cls(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/gen_pypi_simple.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
178	
179	def build_pypi_index(directory, base_url="https://thirdparty.aboutcode.org/pypi"):
180	    """

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/gen_pypi_simple.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
193	    if index_dir.exists():
194	        shutil.rmtree(str(index_dir), ignore_errors=True)
195	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_dejacode.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	
24	DEJACODE_API_KEY = os.environ.get("DEJACODE_API_KEY", "")
25	DEJACODE_API_URL = os.environ.get("DEJACODE_API_URL", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_dejacode.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	DEJACODE_API_KEY = os.environ.get("DEJACODE_API_KEY", "")
25	DEJACODE_API_URL = os.environ.get("DEJACODE_API_URL", "")
26	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_dejacode.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	
51	    response = requests.get(
52	        DEJACODE_API_URL_PACKAGES,
53	        params=params,
54	        headers=DEJACODE_API_HEADERS,
55	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_dejacode.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	        about_url = f"{package_api_url}about"
99	        response = requests.get(about_url, headers=DEJACODE_API_HEADERS)
100	        # note that this is YAML-formatted

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_dejacode.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	        about_url = f"{package_api_url}about_files"
119	        response = requests.get(about_url, headers=DEJACODE_API_HEADERS)
120	        about_zip = response.content

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_dejacode.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
203	
204	    response = requests.post(
205	        DEJACODE_API_URL_PACKAGES,
206	        data=new_package_payload,
207	        headers=DEJACODE_API_HEADERS,
208	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_requirements.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	    with open(requirements_file) as reqs:
29	        req_lines = reqs.read().splitlines(False)
30	    return get_required_name_versions(req_lines, with_unpinned=with_unpinned)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_requirements.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	    with open(requirements_file, "w") as fo:
84	        fo.write(get_installed_reqs(site_packages_dir=site_packages_dir))
85	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_requirements.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
107	    with open(dev_requirements_file, "w") as fo:
108	        fo.write(new_reqs)
109	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	
190	ABOUT_BASE_URL = "https://thirdparty.aboutcode.org/pypi"
191	ABOUT_PYPI_SIMPLE_URL = f"{ABOUT_BASE_URL}/simple"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	ABOUT_LINKS_URL = f"{ABOUT_PYPI_SIMPLE_URL}/links.html"
193	PYPI_SIMPLE_URL = "https://pypi.org/simple"
194	PYPI_INDEX_URLS = (PYPI_SIMPLE_URL, ABOUT_PYPI_SIMPLE_URL)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	
212	LICENSEDB_API_URL = "https://scancode-licensedb.aboutcode.org"
213	
214	LICENSING = license_expression.Licensing()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
683	                with open(location) as fi:
684	                    existing_content = fi.read()
685	                if existing_content == content:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
690	            with open(location, "w") as fo:
691	                fo.write(content)
692	            return True

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
690	            with open(location, "w") as fo:
691	                fo.write(content)
692	            return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
722	                with open(about_path) as fi:
723	                    about_data = saneyaml.load(fi.read())
724	                    if not about_data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
749	                with open(notice_loc) as fi:
750	                    about_data["notice_text"] = fi.read()
751	        return self.update(about_data, keep_extra=True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
758	        try:
759	            about_text = CACHE.get(
760	                path_or_url=self.about_download_url,
761	                as_text=True,
762	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
772	            try:
773	                notice_text = CACHE.get(
774	                    path_or_url=self.notice_download_url,
775	                    as_text=True,
776	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:809
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
808	            csv = getattr(self, csk)
809	            rcv = real_checksums.get(csk)
810	            if csv and rcv and csv != rcv:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
832	        errors = []
833	        extra_lic_names = [l.get("file")
834	                           for l in self.extra_data.get("licenses", {})]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
833	        extra_lic_names = [l.get("file")
834	                           for l in self.extra_data.get("licenses", {})]
835	        extra_lic_names += [self.extra_data.get("license_file")]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
834	                           for l in self.extra_data.get("licenses", {})]
835	        extra_lic_names += [self.extra_data.get("license_file")]
836	        extra_lic_names = [ln for ln in extra_lic_names if ln]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
903	                    with open(pi) as fi:
904	                        return fi.read()
905	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:963
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
962	        """
963	        package_url = data.get("package_url")
964	        if package_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1701	        else:
1702	            return self._get_package_versions_map(name).get(version)
1703	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1709	        package_url = f"{self.index_url}/{normalized_name}"
1710	        text = CACHE.get(
1711	            path_or_url=package_url,
1712	            as_text=True,
1713	            force=not self.use_cached_index,
1714	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1776	
1777	        text = CACHE.get(
1778	            path_or_url=links_url,
1779	            as_text=True,
1780	            force=not self.use_cached_index,
1781	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1869
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1868	            with open(cached, wmode) as fo:
1869	                fo.write(content)
1870	            return content

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1869
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1868	            with open(cached, wmode) as fo:
1869	                fo.write(content)
1870	            return content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1910	    with open(path, mode) as fo:
1911	        return fo.read()
1912	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1939	    print(f"    DOWNLOADING: {url}")
1940	    with requests.get(url, allow_redirects=True, stream=True, headers=headers) as response:
1941	        status = response.status_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1975	    """
1976	    content = CACHE.get(
1977	        path_or_url=path_or_url,
1978	        as_text=as_text,
1979	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1982	    with open(output, wmode) as fo:
1983	        fo.write(content)
1984	    return content

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_thirdparty.py:1983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1982	    with open(output, wmode) as fo:
1983	        fo.write(content)
1984	    return content

--------------------------------------------------

Code scanned:
	Total lines of code: 7487
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 34.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 42.0
		High: 0.0
Files skipped (0):
