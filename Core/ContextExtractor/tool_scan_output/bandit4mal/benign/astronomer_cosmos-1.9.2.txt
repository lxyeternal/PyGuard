Run started:2025-04-12 10:16:04.454846

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/cache.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
244	                packed = msgpack.packb(data)
245	                f.write(packed)
246	    return should_patch_partial_parse_content

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/cache.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
244	                packed = msgpack.packb(data)
245	                f.write(packed)
246	    return should_patch_partial_parse_content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/cache.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
292	            with open(str(filepath), "rb") as fp:
293	                buf = fp.read()
294	                hasher.update(buf)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/cache.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
530	    with open(yaml_file) as file:
531	        yaml_content = file.read()
532	    data = yaml.safe_load(yaml_content)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/constants.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	DEFAULT_OPENLINEAGE_NAMESPACE = "cosmos"
28	OPENLINEAGE_PRODUCER = "https://github.com/astronomer/astronomer-cosmos/"
29	
30	# Cosmos will not emit datasets for the following Airflow versions, due to a breaking change that's fixed in later Airflow 2.x versions
31	# https://github.com/apache/airflow/issues/39486
32	PARTIALLY_SUPPORTED_AIRFLOW_VERSIONS = [Version("2.9.0"), Version("2.9.1")]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/constants.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	
167	TELEMETRY_URL = "https://astronomer.gateway.scarf.sh/astronomer-cosmos/{telemetry_version}/{cosmos_version}/{airflow_version}/{python_version}/{platform_system}/{platform_machine}/{event_type}/{status}/{dag_hash}/{task_count}/{cosmos_task_count}"
168	TELEMETRY_VERSION = "v1"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/dbt/graph.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
449	        compressed_data = zlib.compress(dbt_ls_output.encode("utf-8"))
450	        encoded_data = base64.b64encode(compressed_data)
451	        dbt_ls_compressed = encoded_data.decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/dbt/graph.py:450
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
449	        compressed_data = zlib.compress(dbt_ls_output.encode("utf-8"))
450	        encoded_data = base64.b64encode(compressed_data)
451	        dbt_ls_compressed = encoded_data.decode("utf-8")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/dbt/graph.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
500	            if dbt_ls_compressed:
501	                encoded_data = base64.b64decode(dbt_ls_compressed.encode())
502	                cache_dict["dbt_ls"] = zlib.decompress(encoded_data).decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/dbt/graph.py:501
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
500	            if dbt_ls_compressed:
501	                encoded_data = base64.b64decode(dbt_ls_compressed.encode())
502	                cache_dict["dbt_ls"] = zlib.decompress(encoded_data).decode()

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/dbt/graph.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
501	                encoded_data = base64.b64decode(dbt_ls_compressed.encode())
502	                cache_dict["dbt_ls"] = zlib.decompress(encoded_data).decode()
503	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/dbt/graph.py:502
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
501	                encoded_data = base64.b64decode(dbt_ls_compressed.encode())
502	                cache_dict["dbt_ls"] = zlib.decompress(encoded_data).decode()
503	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/dbt/graph.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
732	        with open(self.render_config.dbt_ls_path) as fp:  # type: ignore[arg-type]
733	            dbt_ls_output = fp.read()
734	            nodes = parse_dbt_ls_output(project_path=project_path, ls_stdout=dbt_ls_output)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/hooks/subprocess.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
65	                    if hasattr(signal, sig):
66	                        signal.signal(getattr(signal, sig), signal.SIG_DFL)
67	                os.setsid()

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/hooks/subprocess.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
65	                    if hasattr(signal, sig):
66	                        signal.signal(getattr(signal, sig), signal.SIG_DFL)
67	                os.setsid()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/operators/_asynchronous/bigquery.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
138	        with object_storage_path.open() as fp:  # type: ignore
139	            sql = fp.read()
140	            elapsed_time = time.time() - start_time

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/operators/local.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
411	        with run_sql_path.open("r") as sql_file:
412	            sql_content: str = sql_file.read()
413	        return sql_content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/operators/local.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
618	            raise AirflowCompatibilityError(
619	                """
620	                Apache Airflow 2.9.0 & 2.9.1 introduced a breaking change in Dataset URIs, to be fixed in newer versions:
621	                https://github.com/apache/airflow/issues/39486

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/operators/virtualenv.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
130	            self.log.info(f"Deleting the Python virtualenv {self.virtualenv_dir}")
131	            shutil.rmtree(str(self.virtualenv_dir), ignore_errors=True)
132	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/operators/virtualenv.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
167	            with open(self._lock_file) as lf:
168	                pid = int(lf.read())
169	                self.log.info(f"Checking for running process with PID {pid}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/operators/virtualenv.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	            logger.info(f"Acquiring lock at {self._lock_file} with pid {str(self._pid)}")
187	            lf.write(str(self._pid))
188	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/operators/virtualenv.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
186	            logger.info(f"Acquiring lock at {self._lock_file} with pid {str(self._pid)}")
187	            lf.write(str(self._pid))
188	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/operators/virtualenv.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
195	        with open(self._lock_file) as lf:
196	            lock_file_pid = int(lf.read())
197	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/plugin/__init__.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	        with open(path) as f:
119	            content = f.read()
120	        return content  # type: ignore[no-any-return]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/plugin/__init__.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
269	        "view": dbt_docs_view,
270	        "href": conf.get("webserver", "base_url") + "/cosmos/dbt_docs",
271	    }

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/telemetry.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
31	        "python_version": platform.python_version(),
32	        "platform_system": platform.system(),
33	        "platform_machine": platform.machine(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/telemetry.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
31	        "python_version": platform.python_version(),
32	        "platform_system": platform.system(),
33	        "platform_machine": platform.machine(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_cosmos-1.9.2/astronomer_cosmos-1.9.2/cosmos/telemetry.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
31	        "python_version": platform.python_version(),
32	        "platform_system": platform.system(),
33	        "platform_machine": platform.machine(),

--------------------------------------------------

Code scanned:
	Total lines of code: 9236
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 5.0
Files skipped (0):
