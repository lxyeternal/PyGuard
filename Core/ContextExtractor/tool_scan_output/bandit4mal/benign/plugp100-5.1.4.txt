Run started:2025-04-12 13:27:09.097118

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
52	    async def execute_raw_request(self, request: "TapoRequest") -> Try[Json]:
53	        return (await self._protocol.send_request(request)).map(lambda x: x.result)
54	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
52	    async def execute_raw_request(self, request: "TapoRequest") -> Try[Json]:
53	        return (await self._protocol.send_request(request)).map(lambda x: x.result)
54	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
55	    async def get_component_negotiation(self) -> Try[Components]:
56	        return (await self.execute_raw_request(TapoRequest.component_negotiation())).map(
57	            Components.try_from_json

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
55	    async def get_component_negotiation(self) -> Try[Components]:
56	        return (await self.execute_raw_request(TapoRequest.component_negotiation())).map(
57	            Components.try_from_json

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
66	        get_info_request = TapoRequest.get_device_info()
67	        return await self.execute_raw_request(get_info_request)
68	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
66	        get_info_request = TapoRequest.get_device_info()
67	        return await self.execute_raw_request(get_info_request)
68	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
75	        get_energy_request = TapoRequest.get_energy_usage()
76	        response = await self.execute_raw_request(get_energy_request)
77	        return response.map(EnergyInfo)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
75	        get_energy_request = TapoRequest.get_energy_usage()
76	        response = await self.execute_raw_request(get_energy_request)
77	        return response.map(EnergyInfo)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
85	        get_current_power = TapoRequest.get_current_power()
86	        response = await self.execute_raw_request(get_current_power)
87	        return response.map(PowerInfo)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
85	        get_current_power = TapoRequest.get_current_power()
86	        response = await self.execute_raw_request(get_current_power)
87	        return response.map(PowerInfo)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
108	        """
109	        response = await self.execute_raw_request(
110	            TapoRequest.set_lighting_effect(light_effect)
111	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
108	        """
109	        response = await self.execute_raw_request(
110	            TapoRequest.set_lighting_effect(light_effect)
111	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
120	        request = TapoRequest.get_child_device_list(0)
121	        response = (await self.execute_raw_request(request)).map(
122	            lambda x: ChildDeviceList.try_from_json(**x)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
120	        request = TapoRequest.get_child_device_list(0)
121	        response = (await self.execute_raw_request(request)).map(
122	            lambda x: ChildDeviceList.try_from_json(**x)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	        if all_pages and response.is_success():
126	            return await self._get_all_pagination(response.get())
127	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	        while current_head.map(lambda x: x.has_next()).get_or_else(False):
133	            previous_head = current_head.get()
134	            request = TapoRequest.get_child_device_list(previous_head.get_next_index())

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
135	            current_head = (
136	                (await self.execute_raw_request(request))
137	                .map(lambda x: ChildDeviceList.try_from_json(**x))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
135	            current_head = (
136	                (await self.execute_raw_request(request))
137	                .map(lambda x: ChildDeviceList.try_from_json(**x))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
148	        request = TapoRequest.get_child_device_component_list()
149	        return (await self.execute_raw_request(request)).map(lambda x: x)
150	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
148	        request = TapoRequest.get_child_device_component_list()
149	        return (await self.execute_raw_request(request)).map(lambda x: x)
150	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
162	        """
163	        multiple_request = TapoRequest.multiple_request(
164	            MultipleRequestParams([request])
165	        ).with_request_time_millis(round(time() * 1000))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
162	        """
163	        multiple_request = TapoRequest.multiple_request(
164	            MultipleRequestParams([request])
165	        ).with_request_time_millis(round(time() * 1000))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
166	        request = TapoRequest.control_child(child_id, multiple_request)
167	        response = await self._protocol.send_request(request)
168	        if response.is_success():

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
166	        request = TapoRequest.control_child(child_id, multiple_request)
167	        response = await self._protocol.send_request(request)
168	        if response.is_success():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	            try:
170	                responses = response.get().result["responseData"]["result"]["responses"]
171	                if len(responses) > 0:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
183	    async def _set_device_info(self, device_info: Json) -> Try[bool]:
184	        response = await self.execute_raw_request(
185	            TapoRequest.set_device_info(device_info)
186	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/api/tapo_client.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
183	    async def _set_device_info(self, device_info: Json) -> Try[bool]:
184	        response = await self.execute_raw_request(
185	            TapoRequest.set_device_info(device_info)
186	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/discovery/cloud_client.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	
11	_TAPO_CLOUD_URL = "https://wap.tplinkcloud.com"
12	
13	
14	class CloudClient:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/discovery/tapo_discovery.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
35	        )
36	        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)  # UDP
37	        sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/discovery/tapo_discovery.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
55	                    if encrypt_info:
56	                        encrypted_session_key_bytes = base64.b64decode(
57	                            encrypt_info["key"]
58	                        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/discovery/tapo_discovery.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
55	                    if encrypt_info:
56	                        encrypted_session_key_bytes = base64.b64decode(
57	                            encrypt_info["key"]
58	                        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/discovery/tapo_discovery.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
71	            now = time.time()
72	        sock.close()
73	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/discovery/tapo_discovery.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
76	        timeout: Optional[int] = 5,
77	        broadcast: Optional[str] = "255.255.255.255",
78	        port: int = 20002,
79	    ) -> list[DiscoveredDevice]:
80	        loop = asyncio.get_event_loop()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/helpers.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
9	def base64encode(to_encode: str) -> Base64str:
10	    return base64.b64encode(to_encode.encode("UTF-8")).decode("UTF-8")
11	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/helpers.py:10
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
9	def base64encode(to_encode: str) -> Base64str:
10	    return base64.b64encode(to_encode.encode("UTF-8")).decode("UTF-8")
11	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/key_pair.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
24	        return KeyPair(
25	            private_key=base64.b64encode(private_key_bytes).decode("UTF-8"),
26	            public_key=base64.b64encode(public_key_bytes).decode("UTF-8"),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/key_pair.py:25
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
24	        return KeyPair(
25	            private_key=base64.b64encode(private_key_bytes).decode("UTF-8"),
26	            public_key=base64.b64encode(public_key_bytes).decode("UTF-8"),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/key_pair.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
25	            private_key=base64.b64encode(private_key_bytes).decode("UTF-8"),
26	            public_key=base64.b64encode(public_key_bytes).decode("UTF-8"),
27	        )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/key_pair.py:26
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
25	            private_key=base64.b64encode(private_key_bytes).decode("UTF-8"),
26	            public_key=base64.b64encode(public_key_bytes).decode("UTF-8"),
27	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/tp_link_cipher.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
21	    def create_from_keypair(handshake_key: str, keypair: KeyPair) -> "TpLinkCipher":
22	        handshake_key: bytes = base64.b64decode(handshake_key.encode("UTF-8"))
23	        private_key_data = base64.b64decode(keypair.get_private_key().encode("UTF-8"))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/tp_link_cipher.py:22
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
21	    def create_from_keypair(handshake_key: str, keypair: KeyPair) -> "TpLinkCipher":
22	        handshake_key: bytes = base64.b64decode(handshake_key.encode("UTF-8"))
23	        private_key_data = base64.b64decode(keypair.get_private_key().encode("UTF-8"))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/tp_link_cipher.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
22	        handshake_key: bytes = base64.b64decode(handshake_key.encode("UTF-8"))
23	        private_key_data = base64.b64decode(keypair.get_private_key().encode("UTF-8"))
24	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/tp_link_cipher.py:23
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
22	        handshake_key: bytes = base64.b64decode(handshake_key.encode("UTF-8"))
23	        private_key_data = base64.b64decode(keypair.get_private_key().encode("UTF-8"))
24	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/tp_link_cipher.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	        encrypted = encryptor.update(padded_data) + encryptor.finalize()
41	        return base64.b64encode(encrypted).decode("UTF-8")
42	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/tp_link_cipher.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
40	        encrypted = encryptor.update(padded_data) + encryptor.finalize()
41	        return base64.b64encode(encrypted).decode("UTF-8")
42	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/tp_link_cipher.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
46	        decrypted = (
47	            decryptor.update(base64.b64decode(data.encode("UTF-8")))
48	            + decryptor.finalize()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/encryption/tp_link_cipher.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
46	        decrypted = (
47	            decryptor.update(base64.b64decode(data.encode("UTF-8")))
48	            + decryptor.finalize()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/child/tapohubchildren.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
137	    async def set_target_temp(self, kwargs: Any) -> Try[bool]:
138	        return await self._send_trv_control_request(
139	            TRVDeviceInfoParams(target_temp=kwargs["temperature"])
140	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/child/tapohubchildren.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
142	    async def set_temp_offset(self, value: int) -> Try[bool]:
143	        return await self._send_trv_control_request(
144	            TRVDeviceInfoParams(temp_offset=value)
145	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/child/tapohubchildren.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
147	    async def set_frost_protection_on(self) -> Try[bool]:
148	        return await self._send_trv_control_request(
149	            TRVDeviceInfoParams(frost_protection_on=True)
150	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/child/tapohubchildren.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
152	    async def set_frost_protection_off(self) -> Try[bool]:
153	        return await self._send_trv_control_request(
154	            TRVDeviceInfoParams(frost_protection_on=False)
155	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/child/tapohubchildren.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
157	    async def set_child_protection_on(self) -> Try[bool]:
158	        return await self._send_trv_control_request(
159	            TRVDeviceInfoParams(child_protection=True)
160	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/child/tapohubchildren.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
162	    async def set_child_protection_off(self) -> Try[bool]:
163	        return await self._send_trv_control_request(
164	            TRVDeviceInfoParams(child_protection=False)
165	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/alarm_component.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	    async def update(self, current_state: dict[str, Any] | None = None):
22	        self._alarm_on = current_state.get("in_alarm", False)
23	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/alarm_component.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
28	        )
29	        return (await self._client.execute_raw_request(request)).map(lambda _: True)
30	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/alarm_component.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
32	        return (
33	            await self._client.execute_raw_request(
34	                TapoRequest(method="stop_alarm", params=None)
35	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/alarm_component.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
39	        return (
40	            await self._client.execute_raw_request(
41	                TapoRequest(method="get_support_alarm_type_list", params=None)
42	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/countdown.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
19	        self._rules = (
20	            (await self._client.execute_raw_request(request))
21	            .map(lambda x: TapoRuleList.from_json(x, RuleTimer))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/countdown.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
44	        )
45	        return (await self._client.execute_raw_request(request)).map(lambda _: True)
46	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/countdown.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	        return TapoRuleList(
60	            enable=data.get("enable", False),
61	            countdown_rule_max_count=data.get("countdown_rule_max_count", 1),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/countdown.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	            enable=data.get("enable", False),
61	            countdown_rule_max_count=data.get("countdown_rule_max_count", 1),
62	            rule_list=list(map(lambda x: constructor(**x), data.get("rule_list", []))),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/countdown.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	            countdown_rule_max_count=data.get("countdown_rule_max_count", 1),
62	            rule_list=list(map(lambda x: constructor(**x), data.get("rule_list", []))),
63	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/hub_children_component.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	                    _LOGGER.warning(
46	                        "Please request support by opening an issue to https://github.com/petretiandrea/plugp100/issues/new"
47	                    )
48	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/components/on_off_component.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	    async def update(self, current_state: dict[str, Any] | None = None):
37	        self._device_on = current_state.get("device_on", False)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/device_factory.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
47	        device_info = DeviceInfo(
48	            **(await protocol.send_request(request=TapoRequest.get_device_info()))
49	            .get_or_raise()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/device_factory.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
47	        device_info = DeviceInfo(
48	            **(await protocol.send_request(request=TapoRequest.get_device_info()))
49	            .get_or_raise()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/device_factory.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
93	    for i, protocol in enumerate(protocols):
94	        info = await protocol.send_request(device_info_request)
95	        if info.is_success():

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/device_factory.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
93	    for i, protocol in enumerate(protocols):
94	        info = await protocol.send_request(device_info_request)
95	        if info.is_success():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/tapodevice.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	    def get_component(self, component_type: Type[C]) -> Optional[C]:
98	        return self._active_components.get(component_type, None)
99	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/tapodevice.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
156	        else:
157	            response = await self.client.execute_raw_request(request)
158	        return response.map(lambda x: LatestFirmware.from_json(x))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/tapodevice.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
164	        else:
165	            response = await self.client.execute_raw_request(request)
166	        return response.map(lambda x: FirmwareDownloadProgress.from_json(x))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/new/tapodevice.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
172	        else:
173	            response = await self.client.execute_raw_request(request)
174	        return response.map(lambda _: True).get_or_else(False)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
70	            async with self._request_lock:
71	                if response := await self._send_request(request, retry):
72	                    return TapoResponse.try_from_json(response)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
70	            async with self._request_lock:
71	                if response := await self._send_request(request, retry):
72	                    return TapoResponse.try_from_json(response)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
74	            if retry > 0:
75	                return await self.send_request(request, retry - 1)
76	            return Failure(e)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
74	            if retry > 0:
75	                return await self.send_request(request, retry - 1)
76	            return Failure(e)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
93	        )
94	        response, response_data = await self.session_post(
95	            url,
96	            params={"seq": seq},
97	            data=payload,
98	            cookies=cookies,
99	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
123	            local_seed, remote_seed, auth_hash = seeds
124	            session_cookie = self._get_cookies_last_request(
125	                self._last_request_url, KlapProtocol.TP_SESSION_COOKIE_NAME
126	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
123	            local_seed, remote_seed, auth_hash = seeds
124	            session_cookie = self._get_cookies_last_request(
125	                self._last_request_url, KlapProtocol.TP_SESSION_COOKIE_NAME
126	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
127	            timeout = int(
128	                self._get_cookies_last_request(
129	                    self._last_request_url, KlapProtocol.TP_TIMEOUT_COOKIE_NAME
130	                )
131	                or 86400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
127	            timeout = int(
128	                self._get_cookies_last_request(
129	                    self._last_request_url, KlapProtocol.TP_TIMEOUT_COOKIE_NAME
130	                )
131	                or 86400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
147	        url = f"{self._base_url}/handshake1"
148	        response, response_data = await self.session_post(url, data=local_seed)
149	        if response.status != 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
226	        )
227	        response, response_data = await self.session_post(
228	            url, data=payload, cookies=cookies
229	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
240	    def _get_cookies_last_request(self, url: str, cookie_name: str) -> Optional[str]:
241	        if cookie := self._http_session.cookie_jar.filter_cookies(URL(url)).get(
242	            cookie_name
243	        ):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/klap/klap_protocol.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
252	        self._http_session.cookie_jar.clear()
253	        resp = await self._http_session.post(
254	            url, params=params, data=data, cookies=cookies
255	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
44	    ) -> Try[TapoResponse[dict[str, Any]]]:
45	        response = await self._send_request(request)
46	        if retry > 0 and isinstance(response.error(), TapoException):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
44	    ) -> Try[TapoResponse[dict[str, Any]]]:
45	        response = await self._send_request(request)
46	        if retry > 0 and isinstance(response.error(), TapoException):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
51	                )
52	                return await self.send_request(request, retry - 1)
53	            elif response.error().error_code == TapoError.ERR_DEVICE.value:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
51	                )
52	                return await self.send_request(request, retry - 1)
53	            elif response.error().error_code == TapoError.ERR_DEVICE.value:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
57	                )
58	                return await self.send_request(request, retry - 1)
59	        return response

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
57	                )
58	                return await self.send_request(request, retry - 1)
59	        return response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	        if login_session.is_success():
70	            self._session = login_session.get()
71	            request.with_terminal_uuid(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	        else:
88	            session = session_or_error.get()
89	            if not session.is_handshake_session_expired():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/passthrough_protocol.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	                if token_or_error.is_success():
95	                    session.token = token_or_error.get()
96	                    return Try.of(session)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/securepassthrough_transport.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
69	
70	        response = await self._http.async_make_post(url, json=request_body)
71	        resp_dict = await response.json(content_type=None)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/securepassthrough_transport.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
92	
93	            terminal_uuid = base64.b64encode(md5(uuid.uuid4().bytes).digest()).decode(
94	                "UTF-8"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/protocol/securepassthrough_transport.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
92	
93	            terminal_uuid = base64.b64encode(md5(uuid.uuid4().bytes).digest()).decode(
94	                "UTF-8"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/responses/child_device_list.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
86	            device_on=kwargs.get("device_on", False),
87	            nickname=base64.b64decode(kwargs["nickname"]).decode("UTF-8"),
88	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/responses/child_device_list.py:87
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
86	            device_on=kwargs.get("device_on", False),
87	            nickname=base64.b64decode(kwargs["nickname"]).decode("UTF-8"),
88	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/responses/device_state.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
134	        self.mac = kwargs["mac"]
135	        self.nickname = base64.b64decode(kwargs["nickname"]).decode("UTF-8")
136	        self.model = kwargs["model"]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/responses/device_state.py:135
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
134	        self.mac = kwargs["mac"]
135	        self.nickname = base64.b64decode(kwargs["nickname"]).decode("UTF-8")
136	        self.model = kwargs["model"]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/responses/device_state.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
140	        self.ssid = (
141	            base64.b64decode(kwargs["ssid"]).decode() if "ssid" in kwargs else None
142	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/responses/device_state.py:141
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
140	        self.ssid = (
141	            base64.b64decode(kwargs["ssid"]).decode() if "ssid" in kwargs else None
142	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/responses/hub_childs/hub_child_base_info.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
39	        self.at_low_battery = kwargs.get("at_low_battery", False)
40	        self.nickname = base64.b64decode(kwargs["nickname"]).decode("UTF-8")
41	        self.last_onboarding_timestamp = kwargs.get("lastOnboardingTimestamp", 0)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/plugp100/responses/hub_childs/hub_child_base_info.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
39	        self.at_low_battery = kwargs.get("at_low_battery", False)
40	        self.nickname = base64.b64decode(kwargs["nickname"]).decode("UTF-8")
41	        self.last_onboarding_timestamp = kwargs.get("lastOnboardingTimestamp", 0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with open("README.md") as readme_file:
8	    README = readme_file.read()
9	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
10	with open("requirements.txt") as requirements_file:
11	    REQUIREMENTS = requirements_file.read().split("\n")
12	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
18	    with codecs.open(os.path.join(here, rel_path), "r") as fp:
19	        return fp.read()
20	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/setup.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	def get_version(rel_path):
23	    for line in read(rel_path).splitlines():
24	        if line.startswith("__version__"):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/setup.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    keywords=["Tapo", "P100"],
66	    url="https://github.com/petretiandrea/plugp100",
67	    download_url="https://github.com/petretiandrea/plugp100",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    url="https://github.com/petretiandrea/plugp100",
67	    download_url="https://github.com/petretiandrea/plugp100",
68	    classifiers=[

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/integration/test_tapo_discovery.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
36	    def _emulated_tapo_device(self):
37	        with socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP) as sock:
38	            sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/integration/test_tapo_discovery.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
40	            sock.setblocking(True)
41	            sock.settimeout(5)
42	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/integration/test_tapo_discovery.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
43	            # we bind to loopback here since we dont want other devices on the LAN to interfere with the unit tests
44	            sock.bind(("127.0.0.1", 20002))
45	            handshake_packet, addr = sock.recvfrom(2048)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/integration/test_tapo_discovery.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
55	                "device_model": "P105(IT)",
56	                "ip": "192.168.1.3",
57	                "mac": "9C-53-22-A7-C8-35",
58	                "is_support_iot_cloud": True,
59	                "obd_src": "tplink",
60	                "factory_default": False,
61	                "mgt_encrypt_schm": {
62	                    "is_support_https": False,
63	                    "encrypt_type": "KLAP",
64	                    "http_port": 80,
65	                    "lv": 2,
66	                },
67	            }
68	            response = _prepare_fake_handshake_response(key, iv, rsa_key, result)
69	            pkt_id = handshake_packet[8:12]
70	            to_send = _build_packet_for_payload_json(
71	                response, PKT_ONBOARD_RESPONSE, pkt_id

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/integration/test_tapo_discovery.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
77	        t.start()
78	        devices = list(TapoDiscovery.scan(broadcast="127.0.0.1", timeout=2))
79	        t.join(timeout=3)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/integration/test_tapo_discovery.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
88	                    device_model="P105(IT)",
89	                    ip="192.168.1.3",
90	                    mac="9C-53-22-A7-C8-35",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/unit/test_discovery.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
28	    assert device.protocol_version == "Klap V2"
29	    assert device.host == "1.2.3.4"
30	    assert isinstance(device, TapoBulb)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/unit/test_klap_protocol.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	        protocol = KlapProtocol(
31	            client_credentials, "http://localhost", klap_strategy=klap_revision
32	        )
33	        mocked_behaviour = _mock_klap_server(client_credentials, klap_revision, protocol)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/unit/test_klap_protocol.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        client = TapoClient(
37	            auth_credential=client_credentials, url="http://localhost", protocol=protocol
38	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/unit/test_klap_protocol.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
41	        for _ in range(10):
42	            resp = await client.execute_raw_request(
43	                TapoRequest(method="none", params="{}")
44	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/unit/test_klap_protocol.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
41	        for _ in range(10):
42	            resp = await client.execute_raw_request(
43	                TapoRequest(method="none", params="{}")
44	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plugp100-5.1.4/plugp100-5.1.4/tests/unit/test_klap_protocol.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        elif "/request" in url:
71	            current_sequence = params.get("seq")
72	            chiper = KlapChiper(

--------------------------------------------------

Code scanned:
	Total lines of code: 5651
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 96.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 108.0
		High: 15.0
Files skipped (0):
