Run started:2025-04-12 10:49:51.732801

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/dbtmetabase/__main__.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	        type=click.STRING,
96	        help="Metabase URL, e.g. 'https://metabase.example.com'.",
97	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/dbtmetabase/metabase.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
76	
77	        response = self.session.request(
78	            method=method,
79	            url=f"{self.url}{path}",
80	            params=params,
81	            timeout=self.http_timeout,
82	            **kwargs,
83	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/dbtmetabase/metabase.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	        if exclude_personal:
142	            results = list(filter(lambda x: not x.get("personal_owner_id"), results))
143	        return results

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	
22	@target(
23	    description="initial setup",
24	    depends=["dbt_run", "metabase_setup"],
25	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	
30	@target(description="run dbt project")
31	def dbt_run():

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
37	def metabase_setup():
38	    setup_resp = requests.post(
39	        url=f"{MB_API_URL}/setup",
40	        json={
41	            "token": MB_SETUP_TOKEN,
42	            "user": {
43	                "site_name": MB_NAME,
44	                "first_name": MB_NAME,
45	                "last_name": None,
46	                "email": MB_USER,
47	                "password_confirm": MB_PASSWORD,
48	                "password": MB_PASSWORD,
49	            },
50	            "prefs": {
51	                "site_name": MB_NAME,
52	                "site_locale": "en",
53	                "allow_tracking": "false",
54	            },
55	        },
56	        timeout=10,
57	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
64	
65	    session_id = requests.post(
66	        url=f"{MB_API_URL}/session",
67	        json={"username": MB_USER, "password": MB_PASSWORD},
68	        timeout=10,
69	    ).json()["id"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	    sample_database_id = ""
75	    databases = requests.get(
76	        url=f"{MB_API_URL}/database",
77	        headers=headers,
78	        timeout=10,
79	    ).json()["data"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	
94	    collections = requests.get(
95	        url=f"{MB_API_URL}/collection",
96	        headers=headers,
97	        timeout=10,
98	    ).json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	    for collection in collections:
100	        if collection.get("is_sample") and not collection.get("archived"):
101	            logging.info("Deleting Metabase sample collection %s", collection["id"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	    for collection in collections:
100	        if collection.get("is_sample") and not collection.get("archived"):
101	            logging.info("Deleting Metabase sample collection %s", collection["id"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
132	        logging.info("Creating Metabase database")
133	        database_id = requests.post(
134	            url=f"{MB_API_URL}/database",
135	            headers=headers,
136	            json=database_body,
137	            timeout=10,
138	        ).json()["id"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
148	    logging.info("Triggering Metabase database sync")
149	    requests.post(
150	        url=f"{MB_API_URL}/database/{database_id}/sync_schema",
151	        headers=headers,
152	        json={},
153	        timeout=10,
154	    ).raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/sandbox/entrypoint.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	
36	@target(description="set up Metabase user and database")
37	def metabase_setup():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/tests/_mocks.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	        manifest_path: Path = FIXTURES_PATH / "manifest-v12.json",
110	        metabase_url: str = f"http://localhost:{SANDBOX_ENV['MB_PORT']}",
111	    ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_metabase-1.5.1/dbt_metabase-1.5.1/tests/conftest.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	def fixture_metabase() -> MockMetabase:
16	    return MockMetabase(url="http://localhost")
17	

--------------------------------------------------

Code scanned:
	Total lines of code: 2866
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 0.0
Files skipped (0):
