Run started:2025-04-12 16:43:11.074319

Test results:
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/client.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
132	
133	        send_request('POST', self.token_endpoint, headers, self, body=urlencode(body), session=self)
134	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/client.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
156	
157	        send_request('POST', self.token_endpoint, headers, self, body=urlencode(body), session=self)
158	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/client.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
180	
181	        send_request('POST', self.revoke_endpoint, headers, self, body=json.dumps(body), session=self)
182	        return True

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/client.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
200	
201	        return send_request('GET', self.user_info_url, headers, self, session=self)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/config.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	MIGRATION_URL = {
21	    'sandbox': 'https://developer-sandbox.api.intuit.com/v2/oauth2/tokens/migrate',
22	    'production': 'https://developer.api.intuit.com/v2/oauth2/tokens/migrate',
23	}
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/config.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    'sandbox': 'https://developer-sandbox.api.intuit.com/v2/oauth2/tokens/migrate',
22	    'production': 'https://developer.api.intuit.com/v2/oauth2/tokens/migrate',
23	}
24	
25	DISCOVERY_URL = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/config.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	DISCOVERY_URL = {
26	    'sandbox': 'https://developer.intuit.com/.well-known/openid_sandbox_configuration/',
27	    'production': 'https://developer.intuit.com/.well-known/openid_configuration/',
28	}
29	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/config.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    'sandbox': 'https://developer.intuit.com/.well-known/openid_sandbox_configuration/',
27	    'production': 'https://developer.intuit.com/.well-known/openid_configuration/',
28	}
29	
30	# info for user-agent

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/exceptions.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	        self.headers = response.headers
32	        self.intuit_tid = response.headers.get('intuit_tid', None) 
33	        self.timestamp = response.headers.get('Date', None) 

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/exceptions.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	        self.intuit_tid = response.headers.get('intuit_tid', None) 
33	        self.timestamp = response.headers.get('Date', None) 
34	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/migration.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
57	    
58	    send_request('POST', migration_url, headers, auth_client, body=json.dumps(body), oauth1_header=auth_header)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	    if session is not None and isinstance(session, Session):
48	        response = session.get(url=discovery_url)
49	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    else:
50	        response = requests.get(url=discovery_url)
51	    if response.status_code != 200:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
89	    if session is not None and isinstance(session, Session):
90	        response = session.request(method, url, headers=header, data=body, auth=oauth1_header)
91	    else:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
91	    else:
92	        response = requests.request(method, url, headers=header, data=body, auth=oauth1_header) 
93	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
112	        auth_header = auth_header.encode('utf-8')
113	    return ' '.join(['Basic', b64encode(auth_header).decode('utf-8')])
114	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:113
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
112	        auth_header = auth_header.encode('utf-8')
113	    return ' '.join(['Basic', b64encode(auth_header).decode('utf-8')])
114	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
152	
153	    id_token_header = json.loads(b64decode(_correct_padding(id_token_parts[0])).decode('ascii'))
154	    id_token_payload = json.loads(b64decode(_correct_padding(id_token_parts[1])).decode('ascii'))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:153
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
152	
153	    id_token_header = json.loads(b64decode(_correct_padding(id_token_parts[0])).decode('ascii'))
154	    id_token_payload = json.loads(b64decode(_correct_padding(id_token_parts[1])).decode('ascii'))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
153	    id_token_header = json.loads(b64decode(_correct_padding(id_token_parts[0])).decode('ascii'))
154	    id_token_payload = json.loads(b64decode(_correct_padding(id_token_parts[1])).decode('ascii'))
155	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:154
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
153	    id_token_header = json.loads(b64decode(_correct_padding(id_token_parts[0])).decode('ascii'))
154	    id_token_payload = json.loads(b64decode(_correct_padding(id_token_parts[1])).decode('ascii'))
155	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/intuitlib/utils.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	
182	    response = requests.get(jwk_uri)
183	    if response.status_code != 200:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
19	with open("./intuitlib/version.py") as fp:
20	    exec(fp.read(), version)
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    author_email='IDGSDK@intuit.com',
29	    url='https://github.com/intuit/oauth-pythonclient',
30	    packages=find_packages(exclude=('tests*',)),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_client.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    
34	    auth_client = AuthClient('clientId','secret','https://www.mydemoapp.com/oauth-redirect','sandbox')
35	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_client.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	            'scope': 'com.intuit.quickbooks.accounting',
70	            'redirect_uri': 'https://www.mydemoapp.com/oauth-redirect',
71	            'state': self.auth_client.state_token
72	        }
73	        assert auth_params == param_values_to_string
74	
75	    @mock.patch('intuitlib.utils.requests.Session')
76	    def test_exceptions_all_bad_request(self, mock_post):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_migration.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    
36	    auth_client = AuthClient('clientId','secret','https://www.mydemoapp.com/oauth-redirect','sandbox')
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        
46	        assert discovery_doc['issuer'] == 'https://oauth.platform.intuit.com/op/v1'
47	        assert discovery_doc['userinfo_endpoint'] == 'https://sandbox-accounts.platform.intuit.com/v1/openid_connect/userinfo'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        assert discovery_doc['issuer'] == 'https://oauth.platform.intuit.com/op/v1'
47	        assert discovery_doc['userinfo_endpoint'] == 'https://sandbox-accounts.platform.intuit.com/v1/openid_connect/userinfo'
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	        
52	        assert discovery_doc['issuer'] == 'https://oauth.platform.intuit.com/op/v1'
53	        assert discovery_doc['userinfo_endpoint'] == 'https://accounts.platform.intuit.com/v1/openid_connect/userinfo'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        assert discovery_doc['issuer'] == 'https://oauth.platform.intuit.com/op/v1'
53	        assert discovery_doc['userinfo_endpoint'] == 'https://accounts.platform.intuit.com/v1/openid_connect/userinfo'
54	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    def test_get_discovery_doc_custom_url_input(self):
56	        discovery_doc = get_discovery_doc('https://developer.intuit.com/.well-known/openid_sandbox_configuration/')
57	        

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	        
58	        assert discovery_doc['issuer'] =='https://oauth.platform.intuit.com/op/v1'
59	        assert discovery_doc['userinfo_endpoint'] == 'https://sandbox-accounts.platform.intuit.com/v1/openid_connect/userinfo'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	        assert discovery_doc['issuer'] =='https://oauth.platform.intuit.com/op/v1'
59	        assert discovery_doc['userinfo_endpoint'] == 'https://sandbox-accounts.platform.intuit.com/v1/openid_connect/userinfo'
60	    

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
62	    def test_get_discovery_doc_bad_response(self, mock_get):
63	        mock_resp = self.mock_request(status=400)
64	        mock_get.return_value = mock_resp

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
96	    def test_send_request_bad_request(self, mock_post):
97	        mock_resp = self.mock_request(status=400)
98	        mock_post.return_value = mock_resp

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
100	        with pytest.raises(AuthClientError):
101	            send_request('POST', 'url', {}, '', body={})
102	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
104	    def test_send_request_ok(self, mock_post):
105	        mock_resp = self.mock_request(status=200, content={'access_token': 'testaccess'})
106	        mock_post.return_value = mock_resp

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
107	
108	        send_request('POST', 'url', {}, self.auth_client, body={})
109	        assert self.auth_client.access_token == 'testaccess'

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
112	    def test_send_request_session_ok(self, mock_post):
113	        mock_resp = self.mock_request(status=200, content={'access_token': 'testaccess'})
114	        mock_post.return_value = mock_resp

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
116	
117	        send_request('POST', 'url', {}, self.auth_client, body={}, session=session)
118	        assert self.auth_client.access_token == 'testaccess'

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
121	    def test_send_request_session_bad(self, mock_post):
122	        mock_resp = self.mock_request(status=400, content={'access_token': 'testaccess'})
123	        mock_post.return_value = mock_resp

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
126	        with pytest.raises(AuthClientError):
127	            send_request('POST', 'url', {}, self.auth_client, body={}, session=session)
128	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/intuit_oauth-1.2.6/intuit_oauth-1.2.6/tests/test_utils.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
135	    def test_get_jwk_bad_request(self, mock_get):
136	        mock_resp = self.mock_request(status=400)
137	        mock_get.return_value = mock_resp

--------------------------------------------------

Code scanned:
	Total lines of code: 643
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 4.0
Files skipped (0):
