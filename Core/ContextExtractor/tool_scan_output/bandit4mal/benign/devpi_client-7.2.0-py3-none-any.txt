Run started:2025-04-12 10:54:12.827798

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	main_description = """
34	The devpi commands (installed via devpi-client) wrap common Python
35	packaging, uploading, installation and testing activities, using a remote
36	devpi-server managed index.  For more information see http://doc.devpi.net
37	"""
38	
39	hookimpl = HookimplMarker("devpiclient")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
161	                cert = self.current.get_client_cert(url=url)
162	            r = self.http.request(method, url, data=data, headers=headers,
163	                                  auth=basic_auth, cert=cert, verify=verify)
164	        except self.http.SSLError as e:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
230	        def remove_readonly(func, path, excinfo):
231	            os.chmod(path, stat.S_IWRITE)
232	            count = 3

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:231
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
230	        def remove_readonly(func, path, excinfo):
231	            os.chmod(path, stat.S_IWRITE)
232	            count = 3

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
250	        finally:
251	            rmtree(workdir, onerror=remove_readonly)
252	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
383	    def venvwrapper_home(self):
384	        path = os.environ.get("WORKON_HOME", None)
385	        if path is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
390	        """current activated virtualenv"""
391	        path = os.environ.get("VIRTUAL_ENV", None)
392	        if path is None:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
407	        if report:
408	            self.report_popen(args, cwd)
409	        encoding = locale.getpreferredencoding()

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
422	            cwd = self.cwd
423	        self.report_popen(args, cwd)
424	        if dryrun is None:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
449	        args = [str(x) for x in args]
450	        self.report_popen(args, extraenv=extraenv)
451	        env = os.environ.copy()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
453	            env.update({k: str(v) for k, v in extraenv.items()})
454	        assert kwargs.get('stderr') != subprocess.PIPE
455	        assert kwargs.get('stdout') != subprocess.PIPE

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
454	        assert kwargs.get('stderr') != subprocess.PIPE
455	        assert kwargs.get('stdout') != subprocess.PIPE
456	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
568	    def get_error_message(self, debug):
569	        message = self.json_get("message", None)
570	        if message is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
586	    def is_json(self):
587	        return self.headers.get("content-type") == "application/json"
588	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
598	    def type(self):
599	        return self._json.get("type")
600	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
602	    def result(self):
603	        return self._json.get("result")
604	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
626	        auth = "%s:%s" % auth
627	        auth = b64encode(auth.encode("ascii")).decode("ascii")
628	        headers["X-Devpi-Auth"] = auth

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:627
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
626	        auth = "%s:%s" % auth
627	        auth = b64encode(auth.encode("ascii")).decode("ascii")
628	        headers["X-Devpi-Auth"] = auth

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
639	def try_argcomplete(parser):
640	    if os.environ.get('_ARGCOMPLETE'):
641	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
667	        try:
668	            r = HTTPReply(hub.http.get(
669	                url, headers=dict(accept='application/json')))
670	        except hub.http.Errors:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
672	        else:
673	            status = r.json_get('result')
674	            if r.status_code == 200 and status is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	                    "current devpi server: %s" % hub.current.root_url)
677	                versioninfo = status.get('versioninfo', {})
678	                for name, version in sorted(versioninfo.items()):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
767	        clientdir_default = os.path.expanduser(
768	            os.environ.get("DEVPI_CLIENTDIR", "~/.devpi/client"))
769	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
837	        "url", nargs="?",
838	        help="set current API endpoints to the ones obtained from the "
839	             "given url.  If already connected to a server, you can "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
920	    parser.add_argument("spec_or_url",
921	        help="""\
922	        describes project/version/release file(s) to release from the current index.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:927
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
926	    parser.description = textwrap.dedent(remove.__doc__)
927	    parser.epilog = textwrap.dedent("""\
928	        examples:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/main.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1235	    acceptable_api_version = ("2",)
1236	    version = reply.headers.get("X-DEVPI-API-VERSION", None)
1237	    if version is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/push.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	        if posturl is None:
59	            posturl = "https://upload.pypi.org/legacy/"
60	            hub.info("using default pypi url %s" % posturl)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/upload.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	                        for aname in archive.namelist():
138	                            z.writestr(aname, archive.read(aname))
139	                self.hub.info(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/upload.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
424	        if self.target_distdir.exists():
425	            shutil.rmtree(self.target_distdir)
426	        self.target_distdir.mkdir()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/upload.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
518	            if self.rootpath != self.origrepo and distdir.exists():
519	                shutil.rmtree(distdir)
520	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/upload.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
540	        if build.exists():
541	            shutil.rmtree(build)
542	        for guess in ("doc", "docs", "source"):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_client-7.2.0-py3-none-any/devpi/use.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
270	                    and url.scheme == 'http'
271	                    and url.hostname not in ('localhost', '127.0.0.0')):
272	                hub.line("Warning: insecure http host, trusted-host will be set for pip")

--------------------------------------------------

Code scanned:
	Total lines of code: 3381
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 2.0
Files skipped (0):
