Run started:2025-04-12 18:29:57.594454

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	IANA_DOWNLOAD_URL = (
22	    "https://www.iana.org/assignments"
23	    "/service-names-port-numbers/service-names-port-numbers.xml"
24	)
25	IANA_NS = "http://www.iana.org/assignments"
26	WIKIPEDIA_PAGE = "http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	)
25	IANA_NS = "http://www.iana.org/assignments"
26	WIKIPEDIA_PAGE = "http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	IANA_NS = "http://www.iana.org/assignments"
26	WIKIPEDIA_PAGE = "http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers"
27	
28	
29	def _write_unassigned_ranges(out_filename: str) -> None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
34	    with open(out_filename, "wt") as f:
35	        f.write(
36	            "# auto-generated by port_for._download_ranges (%s)\n"
37	            % datetime.date.today()
38	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	        )
39	        f.write("UNASSIGNED_RANGES = [\n")
40	        for range in to_ranges(sorted(list(_unassigned_ports()))):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	        for range in to_ranges(sorted(list(_unassigned_ports()))):
41	            f.write("    (%d, %d),\n" % range)
42	        f.write("]\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	            f.write("    (%d, %d),\n" % range)
42	        f.write("]\n")
43	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	    req = Request(WIKIPEDIA_PAGE, headers={"User-Agent": "Magic Browser"})
58	    page = urlopen(req).read().decode("utf8")
59	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
57	    req = Request(WIKIPEDIA_PAGE, headers={"User-Agent": "Magic Browser"})
58	    page = urlopen(req).read().decode("utf8")
59	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	    """
69	    page = urlopen(IANA_DOWNLOAD_URL).read()
70	    xml = ElementTree.fromstring(page)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/_download_ranges.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
68	    """
69	    page = urlopen(IANA_DOWNLOAD_URL).read()
70	    xml = ElementTree.fromstring(page)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/api.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
103	
104	def port_is_used(port: int, host: str = "127.0.0.1") -> bool:
105	    """Return if port is used.

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/api.py:115
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
114	def _can_bind(port: int, host: str) -> bool:
115	    sock = socket.socket()
116	    with contextlib.closing(sock):

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/api.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
124	def _refuses_connection(port: int, host: str) -> bool:
125	    sock = socket.socket()
126	    with contextlib.closing(sock):

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/api.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
126	    with contextlib.closing(sock):
127	        sock.settimeout(1)
128	        err = sock.connect_ex((host, port))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/store.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
87	        parser = ConfigParser()
88	        parser.read(self._config)
89	        return parser

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/port_for/store.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	        with open(self._config, "wt") as f:
93	            parser.write(f)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/tests/test_cases.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
50	    """Test ports that are not used."""
51	    s = socket.socket()
52	    s.bind(("", 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/port_for-0.7.4/port_for-0.7.4/tests/test_cases.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
54	    assert port_for.port_is_used(port)
55	    s.close()
56	    assert not port_for.port_is_used(port)

--------------------------------------------------

Code scanned:
	Total lines of code: 1694
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 3.0
Files skipped (0):
