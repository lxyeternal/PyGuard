Run started:2025-04-12 13:23:39.165769

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/feature_engineering/__init__.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	            print(
24	                "An error can occur when importing from both databricks-feature-store "
25	                "and databricks-feature-engineering. Run '%pip uninstall databricks-feature-store' to uninstall databricks-feature-store, then "
26	                "run 'dbutils.library.restartPython()' to restart the Python interpreter, and try again. If you would like to use the specific databricks-feature-store version, "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_compute_client/_compute_client.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
829	            raise ValueError(
830	                f"Delta table '{name}' is not a feature table. Use spark API to drop the delta table. "
831	                f"For more information on Spark API, "

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_databricks_client/_databricks_client.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
27	        """
28	        response = http_request(
29	            self._get_host_creds(),
30	            "/api/2.0/workspace/take-notebook-snapshot",  # Inlined because this is not a public API
31	            method="POST",
32	            json={"hidden": True, "path": notebook_path},
33	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_databricks_client/_databricks_client.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
45	        url = f"/api/2.0/unity-catalog/functions/{full_function_name}"
46	        response = http_request(
47	            self._get_host_creds(),
48	            url,
49	            method="DELETE",
50	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_databricks_client/_databricks_client.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
57	        url = f"/api/2.0/unity-catalog/functions/{full_feature_spec_name}"
58	        response = http_request(
59	            self._get_host_creds(),
60	            url,
61	            method="GET",
62	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_databricks_client/_databricks_client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
71	        url = f"/api/2.1/unity-catalog/tables/{quote(table_name)}"
72	        response = http_request(
73	            self._get_host_creds(),
74	            url,
75	            method="GET",
76	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_databricks_client/_databricks_client.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
85	        url = f"/api/2.0/unity-catalog/securable-tags/TABLE/{quote(table_name)}"
86	        response = http_request(
87	            self._get_host_creds(),
88	            url,
89	            method="GET",
90	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_databricks_client/_databricks_client.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
105	        url = f"/api/2.0/unity-catalog/functions/{function_name}"
106	        response = http_request(
107	            self._get_host_creds(),
108	            url,
109	            method="GET",
110	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_feature_serving_endpoint_client/_feature_serving_endpoint_client.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
160	        if method in ["GET", "DELETE"]:
161	            response = http_request(
162	                host_creds=host_creds,
163	                endpoint=api,
164	                method=method,
165	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_feature_serving_endpoint_client/_feature_serving_endpoint_client.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
166	        else:
167	            response = http_request(
168	                host_creds=host_creds,
169	                endpoint=api,
170	                method=method,
171	                json=json_body,
172	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_online_store_publish_client/_online_store_publish_client.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	        elif mode == OVERWRITE:
114	            self._publish_overwrite(df, primary_keys, timestamp_keys, lookback_window)
115	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_spark_client/_spark_client.py:929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
928	        _logger.warning(
929	            f"Feature table {feature_table_name} has its own partition strategy that may yield suboptimal point in time join performance. Consider exploring liquid clustering on this table for better performance. See https://docs.databricks.com/en/delta/clustering.html"
930	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/_training_scoring_client/_training_scoring_client.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
647	                _logger.warning(
648	                    "Model could not be logged with a signature because the training set uses feature tables in "
649	                    "Hive Metastore. Migrate the feature tables to Unity Catalog for model to be logged "
650	                    "with a signature. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/publish_engine/publish_cosmosdb_engine.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
306	            _logger.info(
307	                f"You have specified a target throughput control. "
308	                f"A container called {THROUGHPUT_CONTROL_CONTAINER_NAME} is created under database {self.database_name} to record the metrics, which is required by CosmosDB. "
309	                f"Please refer to the CosmosDB Spark Connector Document https://learn.microsoft.com/en-us/azure/cosmos-db/nosql/throughput-control-spark, and the Databricks Feature Store Client SDK Manual https://api-docs.databricks.com/python/feature-engineering/latest/feature_engineering.client.html for more details. "

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/cosmosdb_type_utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
66	    def to_cosmosdb(value: bytearray) -> str:
67	        return str(base64.b64encode(value), "utf-8")
68	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/cosmosdb_type_utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
66	    def to_cosmosdb(value: bytearray) -> str:
67	        return str(base64.b64encode(value), "utf-8")
68	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/e2e_test_utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	def df_to_dict(the_df, primary_key="id"):
40	    return {r.get(primary_key): r for r in [r.asDict() for r in the_df.collect()]}
41	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/e2e_test_utils.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
248	    with open(conda_env_yaml_path, "r") as target_artifact_fd:
249	        conda_yml_content = yaml.safe_load(target_artifact_fd.read())
250	        error_msg = "No matching pip dependencies found"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/e2e_test_utils.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
315	                    found_pip_dep_prefix = True
316	                    target_file.write(pip_dep_replacement_str)
317	                else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/e2e_test_utils.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
315	                    found_pip_dep_prefix = True
316	                    target_file.write(pip_dep_replacement_str)
317	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/e2e_test_utils.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
317	                else:
318	                    target_file.write(line)
319	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/e2e_test_utils.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
317	                else:
318	                    target_file.write(line)
319	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/rest_utils.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
60	        )
61	        auth_str = "Basic " + base64.standard_b64encode(basic_auth_str).decode("utf-8")
62	    elif host_creds.token:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/rest_utils.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
96	    def request_with_ratelimit_retries(max_rate_limit_interval, **kwargs):
97	        response = requests.request(**kwargs)
98	        time_left = max_rate_limit_interval

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/rest_utils.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	                "Will continue to retry 429s for up to %d seconds.",
105	                kwargs.get("url", endpoint),
106	                sleep,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/rest_utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
110	            time_left -= sleep
111	            response = requests.request(**kwargs)
112	            sleep = min(time_left, sleep * 2)  # sleep for 1, 2, 4, ... seconds;

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/rest_utils.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
262	        params = lowercase_bools_for_get_request_params(json_body)
263	        response = http_request(
264	            host_creds=host_creds,
265	            endpoint=endpoint,
266	            method=method,
267	            params=params,
268	            extra_headers=req_context.get_headers(),
269	            timeout=timeout,
270	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/rest_utils.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
271	    else:
272	        response = http_request(
273	            host_creds=host_creds,
274	            endpoint=endpoint,
275	            method=method,
276	            json=json_body,
277	            extra_headers=req_context.get_headers(),
278	            timeout=timeout,
279	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features/utils/spark_listener.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	        _logger.warning(
153	            "Exception while attempting to initialize JVM-side state for logging "
154	            "Spark datasource. Either use a cluster with ML Runtime or install "
155	            "the mlflow-spark JAR in your cluster as described in "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_feature_engineering-0.9.1a1-py3-none-any/databricks/ml_features_common/entities/feature_tables_for_serving.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	        with open(os.path.join(path, cls.DATA_FILE), "rb") as f:
48	            proto.ParseFromString(f.read())
49	        return cls.from_proto(proto)

--------------------------------------------------

Code scanned:
	Total lines of code: 18851
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 1.0
Files skipped (0):
