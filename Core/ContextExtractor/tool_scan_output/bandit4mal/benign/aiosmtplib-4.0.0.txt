Run started:2025-04-12 13:46:40.115331

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/docs/conf.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	
175	intersphinx_mapping = {"python": ("https://docs.python.org/3.10", None)}
176	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
31	    password_bytes = _ensure_bytes(password)
32	    decoded_challenge = base64.b64decode(challenge)
33	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
31	    password_bytes = _ensure_bytes(password)
32	    decoded_challenge = base64.b64decode(challenge)
33	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
35	    verification = username_bytes + b" " + md5_digest.hexdigest().encode("ascii")
36	    encoded_verification = base64.b64encode(verification)
37	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
35	    verification = username_bytes + b" " + md5_digest.hexdigest().encode("ascii")
36	    encoded_verification = base64.b64encode(verification)
37	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
52	    username_and_password = b"\0" + username_bytes + b"\0" + password_bytes
53	    encoded = base64.b64encode(username_and_password)
54	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:53
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
52	    username_and_password = b"\0" + username_bytes + b"\0" + password_bytes
53	    encoded = base64.b64encode(username_and_password)
54	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
69	
70	    encoded_username = base64.b64encode(username_bytes)
71	    encoded_password = base64.b64encode(password_bytes)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
69	
70	    encoded_username = base64.b64encode(username_bytes)
71	    encoded_password = base64.b64encode(password_bytes)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
70	    encoded_username = base64.b64encode(username_bytes)
71	    encoded_password = base64.b64encode(password_bytes)
72	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/auth.py:71
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
70	    encoded_username = base64.b64encode(username_bytes)
71	    encoded_password = base64.b64encode(password_bytes)
72	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
176	        if not self.is_connected:
177	            await self.connect()
178	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
184	        if isinstance(exc, (ConnectionError, TimeoutError)):
185	            self.close()
186	            return

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
335	    async def _get_default_local_hostname(self) -> str:
336	        return await asyncio.to_thread(socket.getfqdn)
337	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
444	            )
445	            await self._maybe_start_tls_on_connect()
446	            await self._maybe_login_on_connect()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
445	            await self._maybe_start_tls_on_connect()
446	            await self._maybe_login_on_connect()
447	        except Exception as exc:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
447	        except Exception as exc:
448	            self.close()  # Reset our state to disconnected
449	            raise exc

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
571	        except SMTPServerDisconnected:
572	            self.close()
573	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
576	        if response.code == SMTPStatus.domain_unavailable:
577	            self.close()
578	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
608	        if self.transport is not None and not self.transport.is_closing():
609	            self.transport.close()
610	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
815	
816	        self.close()
817	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
914	        except SMTPServerDisconnected:
915	            self.close()
916	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/src/aiosmtplib/smtp.py:1046
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1045	        except SMTPServerDisconnected:
1046	            self.close()
1047	            raise

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/conftest.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	    def data_received(self, data: bytes) -> None:
60	        self.transport.write(data)  # type: ignore
61	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/conftest.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
73	        action="store",
74	        default="127.0.0.1",
75	        help="address to bind on for network tests",

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/conftest.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
459	
460	    server.close()
461	    try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/conftest.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
477	
478	    server.close()
479	    try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/conftest.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
507	
508	    server.close()
509	    try:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/pyright_usage.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
11	async def send_str():
12	    await aiosmtplib.send("test")
13	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/pyright_usage.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
11	async def send_str():
12	    await aiosmtplib.send("test")
13	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/pyright_usage.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
16	    message = email.message.EmailMessage()
17	    await aiosmtplib.send(message)
18	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/pyright_usage.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
16	    message = email.message.EmailMessage()
17	    await aiosmtplib.send(message)
18	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/pyright_usage.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
20	async def send_all_options():
21	    await aiosmtplib.send(
22	        "test",
23	        sender="test@example.com",
24	        recipients=["user1@example.com"],
25	        mail_options=["FOO"],
26	        rcpt_options=["BAR"],
27	        hostname="smtp.example.com",
28	        port=1234,
29	        username="root@example.com",
30	        password="changeme",
31	        local_hostname="test",
32	        source_address=("foo", 123),
33	        timeout=124.34,
34	        use_tls=True,
35	        start_tls=False,
36	        validate_certs=False,
37	        client_cert="test",
38	        client_key="test",
39	        tls_context=ssl.create_default_context(),
40	        cert_bundle="test",
41	        socket_path=pathlib.PurePath("/tmp/foo"),
42	        sock=socket.socket(),
43	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/pyright_usage.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
20	async def send_all_options():
21	    await aiosmtplib.send(
22	        "test",
23	        sender="test@example.com",
24	        recipients=["user1@example.com"],
25	        mail_options=["FOO"],
26	        rcpt_options=["BAR"],
27	        hostname="smtp.example.com",
28	        port=1234,
29	        username="root@example.com",
30	        password="changeme",
31	        local_hostname="test",
32	        source_address=("foo", 123),
33	        timeout=124.34,
34	        use_tls=True,
35	        start_tls=False,
36	        validate_certs=False,
37	        client_cert="test",
38	        client_key="test",
39	        tls_context=ssl.create_default_context(),
40	        cert_bundle="test",
41	        socket_path=pathlib.PurePath("/tmp/foo"),
42	        sock=socket.socket(),
43	    )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/pyright_usage.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
41	        socket_path=pathlib.PurePath("/tmp/foo"),
42	        sock=socket.socket(),
43	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/smtpd.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
140	async def mock_response_bad_data(smtpd: SMTPD, *args: Any, **kwargs: Any) -> None:
141	    smtpd._writer.write(b"250 \xff\xff\xff\xff\r\n")
142	    await smtpd._writer.drain()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/smtpd.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
145	async def mock_response_gibberish(smtpd: SMTPD, *args: Any, **kwargs: Any) -> None:
146	    smtpd._writer.write("wefpPSwrsfa2sdfsdf")
147	    await smtpd._writer.drain()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
24	) -> None:
25	    errors, response = await send(
26	        message,
27	        hostname=hostname,
28	        port=smtpd_server_port,
29	        tls_context=client_tls_context,
30	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
24	) -> None:
25	    errors, response = await send(
26	        message,
27	        hostname=hostname,
28	        port=smtpd_server_port,
29	        tls_context=client_tls_context,
30	    )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
43	) -> None:
44	    errors, response = await send(
45	        message_str,
46	        hostname=hostname,
47	        port=smtpd_server_port,
48	        sender=sender_str,
49	        recipients=[recipient_str],
50	        start_tls=False,
51	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
43	) -> None:
44	    errors, response = await send(
45	        message_str,
46	        hostname=hostname,
47	        port=smtpd_server_port,
48	        sender=sender_str,
49	        recipients=[recipient_str],
50	        start_tls=False,
51	    )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
64	) -> None:
65	    errors, response = await send(
66	        bytes(message_str, "ascii"),
67	        hostname=hostname,
68	        port=smtpd_server_port,
69	        sender=sender_str,
70	        recipients=[recipient_str],
71	        start_tls=False,
72	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
64	) -> None:
65	    errors, response = await send(
66	        bytes(message_str, "ascii"),
67	        hostname=hostname,
68	        port=smtpd_server_port,
69	        sender=sender_str,
70	        recipients=[recipient_str],
71	        start_tls=False,
72	    )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
85	    with pytest.raises(ValueError):
86	        errors, response = await send(
87	            message_str,
88	            hostname=hostname,
89	            port=smtpd_server_port,
90	            sender=None,
91	            recipients=[recipient_str],
92	            start_tls=False,
93	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
85	    with pytest.raises(ValueError):
86	        errors, response = await send(
87	            message_str,
88	            hostname=hostname,
89	            port=smtpd_server_port,
90	            sender=None,
91	            recipients=[recipient_str],
92	            start_tls=False,
93	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
103	    with pytest.raises(ValueError):
104	        errors, response = await send(
105	            message_str,
106	            hostname=hostname,
107	            port=smtpd_server_port,
108	            sender=sender_str,
109	            recipients=[],
110	            start_tls=False,
111	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
103	    with pytest.raises(ValueError):
104	        errors, response = await send(
105	            message_str,
106	            hostname=hostname,
107	            port=smtpd_server_port,
108	            sender=sender_str,
109	            recipients=[],
110	            start_tls=False,
111	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
121	) -> None:
122	    errors, response = await send(
123	        message,
124	        hostname=hostname,
125	        port=smtpd_server_port,
126	        start_tls=True,
127	        tls_context=client_tls_context,
128	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
121	) -> None:
122	    errors, response = await send(
123	        message,
124	        hostname=hostname,
125	        port=smtpd_server_port,
126	        start_tls=True,
127	        tls_context=client_tls_context,
128	    )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
144	) -> None:
145	    errors, response = await send(
146	        message,
147	        hostname=hostname,
148	        port=smtpd_server_port,
149	        start_tls=True,
150	        tls_context=client_tls_context,
151	        username=auth_username,
152	        password=auth_password,
153	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
144	) -> None:
145	    errors, response = await send(
146	        message,
147	        hostname=hostname,
148	        port=smtpd_server_port,
149	        start_tls=True,
150	        tls_context=client_tls_context,
151	        username=auth_username,
152	        password=auth_password,
153	    )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:166
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
165	) -> None:
166	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
167	        sock.connect((hostname, smtpd_server_port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
166	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
167	        sock.connect((hostname, smtpd_server_port))
168	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
168	
169	        errors, _ = await send(
170	            mime_message,
171	            hostname=None,
172	            port=None,
173	            sock=sock,
174	            start_tls=False,
175	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
168	
169	        errors, _ = await send(
170	            mime_message,
171	            hostname=None,
172	            port=None,
173	            sock=sock,
174	            start_tls=False,
175	        )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:189
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
188	) -> None:
189	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
190	        sock.connect((hostname, smtpd_server_port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
189	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
190	        sock.connect((hostname, smtpd_server_port))
191	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
191	
192	        errors, _ = await send(
193	            mime_message,
194	            hostname=hostname,
195	            port=None,
196	            sock=sock,
197	            tls_context=client_tls_context,
198	            use_tls=True,
199	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
191	
192	        errors, _ = await send(
193	            mime_message,
194	            hostname=hostname,
195	            port=None,
196	            sock=sock,
197	            tls_context=client_tls_context,
198	            use_tls=True,
199	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
210	) -> None:
211	    errors, _ = await send(
212	        mime_message,
213	        hostname=None,
214	        port=None,
215	        socket_path=socket_path,
216	        start_tls=False,
217	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
210	) -> None:
211	    errors, _ = await send(
212	        mime_message,
213	        hostname=None,
214	        port=None,
215	        socket_path=socket_path,
216	        start_tls=False,
217	    )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
231	) -> None:
232	    errors, _ = await send(
233	        mime_message,
234	        hostname=hostname,
235	        port=None,
236	        socket_path=socket_path,
237	        use_tls=True,
238	        tls_context=client_tls_context,
239	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
231	) -> None:
232	    errors, _ = await send(
233	        mime_message,
234	        hostname=hostname,
235	        port=None,
236	        socket_path=socket_path,
237	        use_tls=True,
238	        tls_context=client_tls_context,
239	    )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
252	) -> None:
253	    errors, _ = await send(
254	        message_str,
255	        hostname=hostname,
256	        port=smtpd_server_port,
257	        sender=sender_str,
258	        recipients=[recipient_str],
259	        mail_options=["BODY=8BITMIME"],
260	        start_tls=False,
261	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
252	) -> None:
253	    errors, _ = await send(
254	        message_str,
255	        hostname=hostname,
256	        port=smtpd_server_port,
257	        sender=sender_str,
258	        recipients=[recipient_str],
259	        mail_options=["BODY=8BITMIME"],
260	        start_tls=False,
261	    )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
274	) -> None:
275	    errors, _ = await send(
276	        message_str,
277	        hostname=hostname,
278	        port=smtpd_server_port,
279	        sender=sender_str,
280	        recipients=[recipient_str],
281	        # RCPT params are not supported by the server; just check that the kwarg works
282	        rcpt_options=[],
283	        start_tls=False,
284	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_api.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
274	) -> None:
275	    errors, _ = await send(
276	        message_str,
277	        hostname=hostname,
278	        port=smtpd_server_port,
279	        sender=sender_str,
280	        recipients=[recipient_str],
281	        # RCPT params are not supported by the server; just check that the kwarg works
282	        rcpt_options=[],
283	        start_tls=False,
284	    )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_asyncio.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
77	    tasks = [
78	        connect_and_send(sender_str, [recipient], message_str)
79	        for recipient in RECIPIENTS

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_asyncio.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
107	    tasks = [
108	        connect_and_send(sender_str, [recipient], message_str)
109	        for recipient in RECIPIENTS

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_asyncio.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
199	    tasks = [
200	        asyncio.wait_for(connect_and_send(sender_str, [recipient], message_str), 2.0)
201	        for recipient in RECIPIENTS

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_methods.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
166	        SMTPStatus.auth_continue,
167	        base64.b64encode(b"secretteststring").decode("utf-8"),
168	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_methods.py:167
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
166	        SMTPStatus.auth_continue,
167	        base64.b64encode(b"secretteststring").decode("utf-8"),
168	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_methods.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
185	        SMTPStatus.auth_continue,
186	        base64.b64encode(b"secretteststring").decode("utf-8"),
187	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_methods.py:186
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
185	        SMTPStatus.auth_continue,
186	        base64.b64encode(b"secretteststring").decode("utf-8"),
187	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
19	) -> None:
20	    encoded_challenge = base64.b64encode(challenge)
21	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
19	) -> None:
20	    encoded_challenge = base64.b64encode(challenge)
21	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
24	    verification = username + b" " + md5_digest.hexdigest().encode("ascii")
25	    encoded_verification = base64.b64encode(verification)
26	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
24	    verification = username + b" " + md5_digest.hexdigest().encode("ascii")
25	    encoded_verification = base64.b64encode(verification)
26	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	    challenge_bytes = challenge.encode("utf-8")
41	    encoded_challenge = base64.b64encode(challenge_bytes)
42	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
40	    challenge_bytes = challenge.encode("utf-8")
41	    encoded_challenge = base64.b64encode(challenge_bytes)
42	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
45	    verification = username_bytes + b" " + md5_digest.hexdigest().encode("ascii")
46	    encoded_verification = base64.b64encode(verification)
47	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
45	    verification = username_bytes + b" " + md5_digest.hexdigest().encode("ascii")
46	    encoded_verification = base64.b64encode(verification)
47	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
57	) -> None:
58	    assert auth_plain_encode(username, password) == base64.b64encode(
59	        b"\0" + username + b"\0" + password
60	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
57	) -> None:
58	    assert auth_plain_encode(username, password) == base64.b64encode(
59	        b"\0" + username + b"\0" + password
60	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
70	
71	    assert auth_plain_encode(username, password) == base64.b64encode(
72	        b"\0" + username_bytes + b"\0" + password_bytes
73	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:71
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
70	
71	    assert auth_plain_encode(username, password) == base64.b64encode(
72	        b"\0" + username_bytes + b"\0" + password_bytes
73	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
81	    assert auth_login_encode(username, password) == (
82	        base64.b64encode(username),
83	        base64.b64encode(password),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:82
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
81	    assert auth_login_encode(username, password) == (
82	        base64.b64encode(username),
83	        base64.b64encode(password),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
82	        base64.b64encode(username),
83	        base64.b64encode(password),
84	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:83
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
82	        base64.b64encode(username),
83	        base64.b64encode(password),
84	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
95	    assert auth_login_encode(username, password) == (
96	        base64.b64encode(username_bytes),
97	        base64.b64encode(password_bytes),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:96
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
95	    assert auth_login_encode(username, password) == (
96	        base64.b64encode(username_bytes),
97	        base64.b64encode(password_bytes),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
96	        base64.b64encode(username_bytes),
97	        base64.b64encode(password_bytes),
98	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_auth_utils.py:97
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
96	        base64.b64encode(username_bytes),
97	        base64.b64encode(password_bytes),
98	    )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
24	    with pytest.raises(ValueError):
25	        await client.connect(client_cert="foo.crt")
26	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
46	    with pytest.raises(ValueError):
47	        await client.connect(start_tls=True)
48	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
51	    with pytest.raises(ValueError):
52	        SMTP(port=1, sock=socket.socket(socket.AF_INET))
53	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
87	    source_address = (bind_address, unused_tcp_port)
88	    await client.connect(
89	        hostname=hostname,
90	        port=smtpd_server_port,
91	        use_tls=False,
92	        start_tls=False,
93	        local_hostname=local_hostname,
94	        source_address=source_address,
95	    )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
121	    try:
122	        await client.connect(
123	            hostname=bind_address, use_tls=use_tls, start_tls=start_tls, timeout=0.001
124	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
129	
130	    client.close()
131	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
136	    client = SMTP(hostname="example.com", port=smtpd_server_port, start_tls=False)
137	    await client.connect(hostname=hostname)
138	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
147	    client = SMTP(hostname=hostname, port=17, start_tls=False)
148	    await client.connect(port=smtpd_server_port)
149	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
160	    )
161	    await client.connect(timeout=0.99)
162	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
179	    )
180	    await client.connect(source_address=(bind_address, unused_tcp_port))
181	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
196	    )
197	    await client.connect(local_hostname="example.com")
198	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
215	
216	    await client.connect(use_tls=False)
217	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
234	
235	    await client.connect(validate_certs=True)
236	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
253	
254	    await client.connect(client_cert=None, client_key=None, cert_bundle=None)
255	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
272	
273	    await client.connect(tls_context=client_tls_context)
274	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_config.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
296	
297	    await client.connect(
298	        validate_certs=False,
299	        client_cert="test2",
300	        client_key="test2",
301	        cert_bundle="test2",
302	    )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
35	    await smtpd._reader.readline()
36	    smtpd.transport.close()
37	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
44	    """
45	    await smtp_client.connect()
46	    assert smtp_client.is_connected

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
62	
63	        await smtp_client.connect()
64	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
72	    with pytest.raises(SMTPConnectError):
73	        await smtp_client.connect()
74	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
81	    with pytest.raises(SMTPConnectError):
82	        await smtp_client.connect()
83	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
90	    with pytest.raises(SMTPConnectError):
91	        await smtp_client.connect()
92	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
97	async def test_421_closes_connection(smtp_client: SMTP) -> None:
98	    await smtp_client.connect()
99	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
113	        # processing time.
114	        await client.connect()
115	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
118	async def test_disconnected_server_raises_on_client_read(smtp_client: SMTP) -> None:
119	    await smtp_client.connect()
120	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
128	async def test_disconnected_server_raises_on_client_write(smtp_client: SMTP) -> None:
129	    await smtp_client.connect()
130	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
138	async def test_disconnected_server_raises_on_data_read(smtp_client: SMTP) -> None:
139	    await smtp_client.connect()
140	    await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
157	
158	    await smtp_client.connect()
159	    await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
169	async def test_disconnected_server_raises_on_starttls(smtp_client: SMTP) -> None:
170	    await smtp_client.connect()
171	    await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
239	) -> None:
240	    await smtp_client.connect()
241	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
273	    with pytest.raises(SMTPConnectError):
274	        await client.connect()
275	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
276	    with pytest.raises(SMTPConnectError):
277	        await client.connect()
278	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
283	) -> None:
284	    await smtp_client.connect()
285	    await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
292	
293	    await asyncio.wait_for(smtp_client.connect(), 1.0)
294	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
301	) -> None:
302	    await smtp_client.connect()
303	    await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
310	
311	    await asyncio.wait_for(smtp_client.connect(), 1.0)
312	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
319	) -> None:
320	    await smtp_client.connect()
321	    await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
330	
331	    await asyncio.wait_for(smtp_client.connect(), 1.0)
332	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
343	    # STARTTLS is required for login
344	    await smtp_client.connect(
345	        start_tls=True,
346	        username=auth_username,
347	        password=auth_password,
348	    )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
356	async def test_connect_with_no_starttls_support(smtp_client: SMTP) -> None:
357	    await smtp_client.connect()
358	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:368
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
367	) -> None:
368	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
369	        sock.connect((hostname, smtpd_server_port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
368	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
369	        sock.connect((hostname, smtpd_server_port))
370	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
370	
371	        await smtp_client.connect(hostname=None, port=None, sock=sock)
372	        response = await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
381	) -> None:
382	    await smtp_client.connect(hostname=None, port=None, socket_path=socket_path)
383	    response = await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
389	async def test_disconnected_server_get_transport_info(smtp_client: SMTP) -> None:
390	    await smtp_client.connect()
391	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_connect.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
400	async def test_disconnected_server_data(smtp_client: SMTP) -> None:
401	    await smtp_client.connect()
402	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
28	
29	    transport.close()
30	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
41	    ) -> None:
42	        await reader.read(1000)
43	        long_response = (

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
41	    ) -> None:
42	        await reader.read(1000)
43	        long_response = (

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	        )
48	        writer.write(long_response)
49	        await writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
68	
69	    server.close()
70	    await cleanup_server(server)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	    with pytest.raises(RuntimeError, match="does not support writing"):
93	        protocol.write(b"TEST\n")
94	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
94	
95	    transport.close()
96	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
137	
138	    transport.close()
139	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
161	
162	    transport.close()
163	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
173	    ) -> None:
174	        writer.write(partial_response)
175	        writer.write_eof()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
191	
192	    server.close()
193	    await cleanup_server(server)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
204	    ) -> None:
205	        writer.write(response)
206	        writer.write_eof()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
224	
225	    server.close()
226	    await cleanup_server(server)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
238	    ) -> None:
239	        await reader.read(1000)
240	        writer.write(b"220 Hi\r\n")

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
238	    ) -> None:
239	        await reader.read(1000)
240	        writer.write(b"220 Hi\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
239	        await reader.read(1000)
240	        writer.write(b"220 Hi\r\n")
241	        await writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
258	
259	    server.close()
260	    await cleanup_server(server)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
271	    ) -> None:
272	        await reader.read(1000)
273	        writer.write(b"220 Hi\r\n")

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
271	    ) -> None:
272	        await reader.read(1000)
273	        writer.write(b"220 Hi\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
272	        await reader.read(1000)
273	        writer.write(b"220 Hi\r\n")
274	        await writer.drain()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
275	        await asyncio.sleep(0)
276	        writer.write(b"221 Hi again!\r\n")
277	        await writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
294	
295	    server.close()
296	    await cleanup_server(server)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
316	
317	    server.close()
318	    await cleanup_server(server)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
329	    ) -> None:
330	        await reader.read(1000)
331	        writer.write(b"220 Hi\r\n")

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
329	    ) -> None:
330	        await reader.read(1000)
331	        writer.write(b"220 Hi\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
330	        await reader.read(1000)
331	        writer.write(b"220 Hi\r\n")
332	        await writer.drain()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
333	
334	        await reader.read(1000)
335	        writer.write(b"221 Bye\r\n")

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
333	
334	        await reader.read(1000)
335	        writer.write(b"221 Bye\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
334	        await reader.read(1000)
335	        writer.write(b"221 Bye\r\n")
336	        await writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
337	
338	        writer.transport.close()
339	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_protocol.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
356	
357	    server.close()
358	    await cleanup_server(server)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
24	async def test_command_timeout_error(smtp_client: SMTP) -> None:
25	    await smtp_client.connect()
26	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
32	async def test_data_timeout_error(smtp_client: SMTP) -> None:
33	    await smtp_client.connect()
34	    await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
43	    with pytest.raises(SMTPTimeoutError):
44	        await smtp_client.connect(timeout=0.0)
45	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
53	        # We need to use a timeout > 0 here to avoid timing out on connect
54	        await smtp_client.connect(timeout=0.01)
55	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
58	async def test_timeout_on_starttls(smtp_client: SMTP) -> None:
59	    await smtp_client.connect()
60	    await smtp_client.ehlo()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
81	
82	    transport.close()
83	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
90	    with pytest.raises(SMTPConnectTimeoutError) as exc:
91	        await client.connect()
92	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
106	    with pytest.raises(SMTPConnectTimeoutError):
107	        await client.connect(timeout=0.0)
108	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
139	
140	    server.close()
141	    await cleanup_server(server)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_timeouts.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
164	
165	    transport.close()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtplib-4.0.0/aiosmtplib-4.0.0/tests/test_tls.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
325	        peername = smtp_client.get_transport_info("peername")
326	        assert peername[0] in ("127.0.0.1", "::1")  # IP v4 and 6
327	        assert peername[1] == smtpd_server_port

--------------------------------------------------

Code scanned:
	Total lines of code: 6172
	Total lines skipped (#nosec): 10

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 157.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 160.0
		High: 22.0
Files skipped (0):
