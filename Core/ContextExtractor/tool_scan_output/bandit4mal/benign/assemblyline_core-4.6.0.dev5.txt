Run started:2025-04-12 11:01:49.025332

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py:926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
925	                    if service.uses_temp_submission_data:
926	                        temp_data = task.temporary_data[sha256].read()
927	                        if service.monitored_keys:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/expiry/run_expiry.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
64	
65	        with ThreadPoolExecutor(8) as pool:
66	            for filename in file_batch:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/expiry/run_expiry.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
100	        self.counter = MetricsFactory('expiry', Metrics)
101	        self.file_delete_worker = ProcessPoolExecutor(self.config.core.expiry.delete_workers)
102	        if self.config.filestore.archive:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/expiry/run_expiry.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
337	    def try_run(self):
338	        pool = ThreadPoolExecutor(self.config.core.expiry.workers)
339	        main_threads = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/expiry/run_expiry.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
400	                self.log.error("File delete worker pool crashed.")
401	                self.file_delete_worker = ProcessPoolExecutor(self.config.core.expiry.delete_workers)
402	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
526	                ca_certs = ca_certs_file.name
527	                ca_certs_file.write(self.config.core.metrics.elasticsearch.host_certificates.encode())
528	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
526	                ca_certs = ca_certs_file.name
527	                ca_certs_file.write(self.config.core.metrics.elasticsearch.host_certificates.encode())
528	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	
29	METRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca.crt')
30	METRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	METRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca.crt')
30	METRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"
31	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	                ca_certs = ca_certs_file.name
156	                ca_certs_file.write(self.config.core.metrics.elasticsearch.host_certificates.encode())
157	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
155	                ca_certs = ca_certs_file.name
156	                ca_certs_file.write(self.config.core.metrics.elasticsearch.host_certificates.encode())
157	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	                    name = key.rstrip('.t')
224	                    output_metrics[name] = counts[key] / counts.get(name + ".c", 1)
225	                    output_metrics[name + "_count"] = counts.get(name + ".c", 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	                    output_metrics[name] = counts[key] / counts.get(name + ".c", 1)
225	                    output_metrics[name + "_count"] = counts.get(name + ".c", 0)
226	                # Plain old metric, no modifications needed

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
285	
286	        threading.Thread(target=self._call_interval, args=('es_shards', self._fetch_shards), daemon=True).start()
287	        if self.config.retrohunt.enabled:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	        if self.config.retrohunt.enabled:
288	            threading.Thread(target=self._call_interval, args=('retrohunt', self._fetch_retrohunt), daemon=True).start()
289	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	                    sizes.setdefault(index, 0)
354	                    sizes[index] = max(sizes[index], int(shard.get('store') or 0))
355	                    nodes.add(node)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
383	            }
384	            instances = len(status.get('storage', {}))
385	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
398	            for k in list(self.window_ttl.keys()):
399	                if self.window_ttl.get(k, c_time) < c_time:
400	                    c_name, c_type, c_host = k

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
463	                            name = key.rstrip('.t')
464	                            metrics_data[name] = value / max(counter.get(name + ".c", 1), 1)
465	                            metrics_data[name + "_count"] = counter.get(name + ".c", 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
464	                            metrics_data[name] = value / max(counter.get(name + ".c", 1), 1)
465	                            metrics_data[name + "_count"] = counter.get(name + ".c", 0)
466	                        # Plain old metric, no modifications needed

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/replay.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	                self.replay_config = ReplayConfig(recursive_update(ReplayConfig().as_primitives(),
25	                                                                   yaml.safe_load(env_substitute(yml_fh.read()))))
26	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/replay.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	                    self.log.info(f'Starting thread: {name}')
66	                    threads[name] = thread = threading.Thread(target=function, name=name)
67	                    thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	        # Start a background thread to keep the service server connected
84	        threading.Thread(target=self._refresh_service_networks, daemon=True).start()
85	        self._flush_containers()  # Clear out any containers that are left over from a previous run

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
204	    else:
205	        server_name = 'https://index.docker.io/v1/'
206	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
208	    bin_u_pass = f"{username}:{password}".encode()
209	    auth_string = base64.b64encode(bin_u_pass).decode()
210	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:209
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
208	    bin_u_pass = f"{username}:{password}".encode()
209	    auth_string = base64.b64encode(bin_u_pass).decode()
210	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
317	        self._quota_mem_used: Optional[float] = None
318	        quota_background = threading.Thread(target=self._loop_forever(self._monitor_quotas), daemon=True)
319	        quota_background.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
323	        self._node_pool_max_cpu: float = 0
324	        node_background = threading.Thread(target=self._loop_forever(self._monitor_node_pool), daemon=True)
325	        node_background.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
330	        self._pod_used_namespace_cpu: dict[str, float] = defaultdict(float)
331	        pod_background = threading.Thread(target=self._loop_forever(self._monitor_pods), daemon=True)
332	        pod_background.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
335	        self._deployment_unavailable: dict[str, int] = {}
336	        deployment_background = threading.Thread(target=self._loop_forever(self._monitor_deployments), daemon=True)
337	        deployment_background.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:1054
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1053	                with open(AL_ROOT_CA, 'rb') as root_ca:
1054	                    rootca_cert = x509.load_pem_x509_certificate(root_ca.read())
1055	                with open(AL_ROOT_CA_PK, 'rb') as root_ca_pk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:1056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1055	                with open(AL_ROOT_CA_PK, 'rb') as root_ca_pk:
1056	                    rootca_pk = serialization.load_pem_private_key(root_ca_pk.read(), None)
1057	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1071	                                data={
1072	                                    'tls.crt': b64encode(cert.public_bytes(serialization.Encoding.PEM)).decode(),
1073	                                    'tls.key': b64encode(cert_key.private_bytes(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1071	                                data={
1072	                                    'tls.crt': b64encode(cert.public_bytes(serialization.Encoding.PEM)).decode(),
1073	                                    'tls.key': b64encode(cert_key.private_bytes(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1072	                                    'tls.crt': b64encode(cert.public_bytes(serialization.Encoding.PEM)).decode(),
1073	                                    'tls.key': b64encode(cert_key.private_bytes(
1074	                                        encoding=serialization.Encoding.PEM,
1075	                                        format=serialization.PrivateFormat.PKCS8,
1076	                                        encryption_algorithm=serialization.NoEncryption())).decode()})
1077	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1072	                                    'tls.crt': b64encode(cert.public_bytes(serialization.Encoding.PEM)).decode(),
1073	                                    'tls.key': b64encode(cert_key.private_bytes(
1074	                                        encoding=serialization.Encoding.PEM,
1075	                                        format=serialization.PrivateFormat.PKCS8,
1076	                                        encryption_algorithm=serialization.NoEncryption())).decode()})
1077	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
98	    def __init__(self, size: int = 10):
99	        self.pool = concurrent.futures.ThreadPoolExecutor(size)
100	        self.futures: list[concurrent.futures.Future[Any]] = []

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
276	        with open('/etc/assemblyline/config.yml') as fh:
277	            flattened_config: Dict[str, Any] = flatten(yaml.safe_load(fh.read()))
278	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
904	                        # Pull out statistics from the metrics regularization
905	                        update = self.state.read(profile_name)
906	                        if update:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
933	    def process_timeouts(self):
934	        with concurrent.futures.ThreadPoolExecutor(10) as pool:
935	            futures = []

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
121	        self.log.info("Started")
122	        self._old_sigint = signal.signal(signal.SIGINT, self.interrupt_handler)
123	        self._old_sigterm = signal.signal(signal.SIGTERM, self.interrupt_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py:122
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
121	        self.log.info("Started")
122	        self._old_sigint = signal.signal(signal.SIGINT, self.interrupt_handler)
123	        self._old_sigterm = signal.signal(signal.SIGTERM, self.interrupt_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
122	        self._old_sigint = signal.signal(signal.SIGINT, self.interrupt_handler)
123	        self._old_sigterm = signal.signal(signal.SIGTERM, self.interrupt_handler)
124	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py:123
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
122	        self._old_sigint = signal.signal(signal.SIGINT, self.interrupt_handler)
123	        self._old_sigterm = signal.signal(signal.SIGTERM, self.interrupt_handler)
124	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	        # If it doesn't stop within a few seconds, this other thread should kill the entire process
135	        stop_thread = threading.Thread(target=self.__stop)
136	        stop_thread.daemon = True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
295	                    self.log.info(f'Starting thread: {name}')
296	                    threads[name] = thread = threading.Thread(target=function, name=name)
297	                    thread.start()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	        try:
33	            resp = requests.get(url, headers=headers, verify=verify, proxies=proxies)
34	        except requests.exceptions.SSLError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	                url = url.replace('https://','http://')
38	                resp = requests.get(url, headers=headers, verify=verify, proxies=proxies)
39	        return resp

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
56	            token_url = f"https://{token_server}/token?scope=repository:{image_name}:pull"
57	            resp = self._perform_request(token_url, headers, verify, proxies)
58	            if resp and resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	                # Request to obtain token was successful, set Authorization header for registry API
60	                token = resp.json().get('token')
61	                headers["Authorization"] = f"Bearer {token}"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
62	
63	        resp = self._perform_request(url, headers, verify, proxies)
64	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
82	        # Attempt request with provided credentials alone
83	        resp = self._perform_request(url, headers, verify, proxies)
84	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
89	            token_url = f"https://{server}/oauth2/token?scope=repository:{image_name}:metadata_read,pull&service={server}"
90	            resp = self._perform_request(token_url, headers, verify, proxies)
91	            if resp and resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	                # Request to obtain token was successful, set Authorization header for registry API
93	                token = resp.json().get('access_token')
94	                headers["Authorization"] = f"Bearer {token}"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
95	
96	                resp = self._perform_request(url, headers, verify, proxies)
97	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
121	            token_url = f"https://{server}/service/token?scope=repository:{image_name}:pull"
122	            resp = self._perform_request(token_url, headers, verify, proxies)
123	            if resp and resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	                # Request to obtain token was successful, set Authorization header for registry API
125	                token = resp.json().get('token')
126	                headers["Authorization"] = f"Bearer {token}"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
127	
128	        resp = self._perform_request(url, headers, verify, proxies)
129	        if resp and resp.ok:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
228	        upass = f"{auth_config['username']}:{auth_config['password']}"
229	        auth = f"Basic {b64encode(upass.encode()).decode()}"
230	    elif auth_config['password']:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:229
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
228	        upass = f"{auth_config['username']}:{auth_config['password']}"
229	        auth = f"Basic {b64encode(upass.encode()).decode()}"
230	    elif auth_config['password']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	    if server.endswith(".azurecr.io"):
235	        if auth_config.get('use_fic', False):
236	            # If the use of federated identity token is set, exchange said token to an ACR token

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	                credentials = DefaultAzureCredential()
239	                aad_token = credentials.get_token('https://management.core.windows.net/.default').token
240	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
240	
241	                refresh_token = requests.post(
242	                    f"https://{server}/oauth2/exchange",
243	                    headers={"Content-Type": "application/x-www-form-urlencoded"},
244	                    data=f"grant_type=access_token&service={server}&access_token={aad_token}",
245	                    proxies=proxies).json()["refresh_token"]
246	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
246	
247	                token = requests.post(
248	                    f"https://{server}/oauth2/token",
249	                    headers={"Content-Type": "application/x-www-form-urlencoded"},
250	                    data=f"grant_type=refresh_token&service={server}&refresh_token={refresh_token}"
251	                        f"&scope=repository:{image_name}:metadata_read",
252	                    proxies=proxies).json()["access_token"]
253	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
321	        try:
322	            response = requests.get(url, proxies=proxies)
323	            response.raise_for_status()  # Raises an HTTPError for bad responses

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
327	                for tag_info in response_data['results']:
328	                    tag_name = tag_info.get('name')
329	                    if tag_name and tag_name == f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{update_channel}":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
338	                # The tags are coming from another repository, so we're don't know the ordering of tags
339	                tags.extend(tag_info.get('name') for tag_info in response_data['results'] if tag_info.get('name'))
340	            url = response_data.get('next')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
338	                # The tags are coming from another repository, so we're don't know the ordering of tags
339	                tags.extend(tag_info.get('name') for tag_info in response_data['results'] if tag_info.get('name'))
340	            url = response_data.get('next')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	                tags.extend(tag_info.get('name') for tag_info in response_data['results'] if tag_info.get('name'))
340	            url = response_data.get('next')
341	            if not url:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	    secret.strip("${}")
43	    for secret in re.findall(r'\${\w+}', open('/etc/assemblyline/config.yml', 'r').read())]
44	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
567	            install_threads = []
568	            with ThreadPoolExecutor() as service_installs_exec:
569	                for service_name, install_data in self.container_install.items().items():

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py:667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
666	            update_threads = []
667	            with ThreadPoolExecutor() as service_updates_exec:
668	                for service_name, update_data in self.container_update.items().items():

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/crawler.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
50	    config = get_config()
51	    signal.signal(signal.SIGTERM, sigterm_handler)
52	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/crawler.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
50	    config = get_config()
51	    signal.signal(signal.SIGTERM, sigterm_handler)
52	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/crawler.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
94	        futures: list[concurrent.futures.Future] = []
95	        with concurrent.futures.ThreadPoolExecutor(20) as pool:
96	            for data_directory in vacuum_config.data_directories:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/department_map.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	                if self.url:
55	                    res = requests.get(self.url, verify=False)
56	                    res.raise_for_status()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/department_map.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
85	    departments = DepartmentMap('', None)
86	    print(departments['48.49.39.100'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	                            zone_id=stream['ZONE'],
58	                            classification=f"{stream.get('LEVEL', 'PB')}//{stream.get('CAVEAT', 'CND')}"
59	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	                            zone_id=stream['ZONE'],
58	                            classification=f"{stream.get('LEVEL', 'PB')}//{stream.get('CAVEAT', 'CND')}"
59	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	                if self.url:
67	                    res = requests.get(self.url, verify=False)
68	                    res.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	                            zone_id=stream['ZONE'],
76	                            classification=f"{stream.get('LEVEL', 'PB')}//{stream.get('CAVEAT', 'CND')}"
77	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	                            zone_id=stream['ZONE'],
76	                            classification=f"{stream.get('LEVEL', 'PB')}//{stream.get('CAVEAT', 'CND')}"
77	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	            self._load_stream_map()
95	            return self.table.get(stream_id)
96	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
595	                        fh.seek(0)
596	                        sample = str(fh.read(2000))
597	                        raise NotJSONException(f"File '{meta_path}' is not a JSON Metadata "

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
685	def main():
686	    signal.signal(signal.SIGTERM, sigterm_handler)
687	    run()

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py:686
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
685	def main():
686	    signal.signal(signal.SIGTERM, sigterm_handler)
687	    run()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
10	    with open(package_version_path) as package_version_file:
11	        package_version = package_version_file.read().strip()
12	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
15	with open(os.path.join(this_directory, 'README.md'), encoding='utf-8') as f:
16	    long_description = f.read()
17	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    long_description_content_type='text/markdown',
24	    url="https://github.com/CybercentreCanada/assemblyline-core/",
25	    author="CCCS Assemblyline development team",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_badlist_client.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
130	    tag_type = 'network.static.ip'
131	    tag_value = '127.0.0.1'
132	    hashed_value = f"{tag_type}: {tag_value}".encode('utf8')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_badlist_client.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
299	    tag_type = 'network.static.uri'
300	    tag_value = 'https://BaD.com/About'
301	
302	    normalized_value = 'https://bad.com/About'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_badlist_client.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
301	
302	    normalized_value = 'https://bad.com/About'
303	    hashed_value = f"{tag_type}: {normalized_value}".encode('utf8')

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_expiry.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
62	    expiry.counter = FakeCounter()
63	    with concurrent.futures.ThreadPoolExecutor(5) as pool:
64	        for collection in expiry.expirable_collections:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_plumber.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    datastore.ds.ca_certs = None
26	    datastore.ds.get_hosts.return_value = ["http://localhost:9200"]
27	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_plumber.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    datastore.ds.ca_certs = None
56	    datastore.ds.get_hosts.return_value = ["http://localhost:9200"]
57	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
129	    tag_type = 'network.static.ip'
130	    tag_value = '127.0.0.1'
131	    hashed_value = f"{tag_type}: {tag_value}".encode('utf8')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	    tag_type = 'network.static.uri'
337	    tag_value = 'https://gOOd.com/About'
338	
339	    normalized_value = 'https://good.com/About'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
338	
339	    normalized_value = 'https://good.com/About'
340	    hashed_value = f"{tag_type}: {normalized_value}".encode('utf8')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_simulation.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
340	    with NamedTemporaryFile() as file:
341	        file.write(out)
342	        file.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_vacuum.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	            # Kick off a crawler thread
35	            threading.Thread(target=crawler.run, args=[config, redis_connection], daemon=True).start()
36	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_vacuum.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	            with open(first_file, 'w') as temp:
85	                temp.write(json.dumps({
86	                    'sha256': '0'*64,
87	                    'metadata': {'stream': '100'}
88	                }))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_vacuum.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
84	            with open(first_file, 'w') as temp:
85	                temp.write(json.dumps({
86	                    'sha256': '0'*64,
87	                    'metadata': {'stream': '100'}
88	                }))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_vacuum.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
95	            with open(os.path.join(name, sha256), 'bw') as temp:
96	                temp.write(test_file)
97	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_vacuum.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
95	            with open(os.path.join(name, sha256), 'bw') as temp:
96	                temp.write(test_file)
97	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_vacuum.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	            with open(second_file, 'w') as temp:
100	                temp.write(json.dumps({
101	                    'sha256': sha256,
102	                    'metadata': {'stream': '99'}
103	                }))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_vacuum.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
99	            with open(second_file, 'w') as temp:
100	                temp.write(json.dumps({
101	                    'sha256': sha256,
102	                    'metadata': {'stream': '99'}
103	                }))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_core-4.6.0.dev5/assemblyline_core-4.6.0.dev5/test/test_vacuum.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
105	            # Start the worker
106	            threading.Thread(target=worker.run, args=[config, redis_connection, redis_connection], daemon=True).start()
107	

--------------------------------------------------

Code scanned:
	Total lines of code: 14391
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 87.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 99.0
		High: 8.0
Files skipped (0):
