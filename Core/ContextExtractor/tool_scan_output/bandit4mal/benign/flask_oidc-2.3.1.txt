Run started:2025-04-12 17:13:16.782500

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/docs/conf.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
326	
327	github_url = "https://github.com/fedora-infra/flask-oidc"
328	
329	
330	def changelog_github_links(app, docname, source):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/flask_oidc/__init__.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	                    "client_secret": "testing-client-secret",
193	                    "issuer": "https://oidc.example.com",
194	                }
195	            }
196	        if isinstance(content_or_filepath, dict):
197	            return content_or_filepath

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    'description': 'OpenID Connect extension for Flask',
20	    'long_description': 'flask-oidc\n==========\n\n`OpenID Connect <https://openid.net/connect/>`_ support for `Flask <http://flask.pocoo.org/>`_.\n\n.. image:: https://img.shields.io/pypi/v/flask-oidc.svg?style=flat\n   :target: https://pypi.python.org/pypi/flask-oidc\n   :alt: PyPI version\n\n.. image:: https://img.shields.io/pypi/dm/flask-oidc.svg?style=flat\n   :target: https://pypi.python.org/pypi/flask-oidc\n   :alt: Downloads per month\n\n.. image:: https://readthedocs.org/projects/flask-oidc/badge/?version=latest\n   :target: http://flask-oidc.readthedocs.io/en/latest/?badge=latest\n   :alt: Documentation Status\n\n.. image:: https://github.com/fedora-infra/flask-oidc/actions/workflows/main.yml/badge.svg?branch=develop\n   :target: https://github.com/fedora-infra/flask-oidc/actions/workflows/main.yml?query=branch%3Adevelop\n   :alt: Tests Status\n\n\nThis library should work with any standards compliant OpenID Connect provider.\n\nThe full documentation is at https://flask-oidc.readthedocs.io/\n\nIt has been tested with:\n\n* `Ipsilon <https://ipsilon-project.org/>`_\n\n\nProject status\n==============\n\nThis project is in active development (again).\n\nTest coverage is 100%.\n',
21	    'author': 'Erica Ehrhardt',
22	    'author_email': 'None',
23	    'maintainer': 'None',
24	    'maintainer_email': 'None',
25	    'url': 'https://github.com/fedora-infra/flask-oidc',
26	    'packages': packages,
27	    'package_data': package_data,
28	    'install_requires': install_requires,
29	    'python_requires': '>=3.8,<4.0',
30	}
31	
32	
33	setup(**setup_kwargs)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    'maintainer_email': 'None',
25	    'url': 'https://github.com/fedora-infra/flask-oidc',
26	    'packages': packages,
27	    'package_data': package_data,
28	    'install_requires': install_requires,
29	    'python_requires': '>=3.8,<4.0',
30	}
31	
32	
33	setup(**setup_kwargs)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    """Happy path authentication test."""
40	    mocked_responses.post("https://test/openidc/Token", json=dummy_token)
41	    mocked_responses.get("https://test/openidc/UserInfo", json={"nickname": "dummy"})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    mocked_responses.post("https://test/openidc/Token", json=dummy_token)
41	    mocked_responses.get("https://test/openidc/UserInfo", json={"nickname": "dummy"})
42	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	        "grant_type": ["authorization_code"],
69	        "redirect_uri": ["http://localhost/authorize"],
70	        "code": ["mock_auth_code"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	        mocked_responses.post(
102	            "https://test/openidc/Token", json={"error": "dummy"}, status=401
103	        )
104	        dummy_token["expires_at"] = int(time.time())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	        resp = client.get("/logout?reason=expired")
108	        assert resp.location == "http://localhost/subpath/"
109	        assert "oidc_auth_token" not in flask.session

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	    new_token["access_token"] = "this-is-new"
115	    refresh_call = mocked_responses.post("https://test/openidc/Token", json=new_token)
116	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	    refresh_call = mocked_responses.post(
142	        "https://test/openidc/Token", json={"error": "dummy"}, status=401
143	    )
144	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	    assert resp.status_code == 302
155	    assert resp.location == "http://localhost/"
156	    assert "oidc_auth_token" not in flask.session

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	    assert resp.status_code == 302
170	    assert resp.location == "http://localhost/"
171	    assert "oidc_auth_token" not in flask.session

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	    mocked_responses.get(
210	        "https://test/openidc/UserInfo",
211	        json={"nickname": "dummy"},
212	        match=[
213	            responses.matchers.header_matcher(
214	                {"Authorization": "Bearer other-access-token"}
215	            )
216	        ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
287	    mocked_responses.post(
288	        "https://test/openidc/TokenInfo",
289	        json={
290	            "active": True,
291	            "scope": "openid",
292	        },
293	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
309	    mocked_responses.post(
310	        "https://test/openidc/TokenInfo",
311	        json={
312	            "active": False,
313	            "scope": "openid",
314	        },
315	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
328	    mocked_responses.post(
329	        "https://test/openidc/TokenInfo",
330	        json={
331	            "active": True,
332	            "scope": "openid profile",
333	        },
334	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
341	    mocked_responses.post(
342	        "https://test/openidc/TokenInfo",
343	        json={
344	            "active": True,
345	            "scope": "openid",
346	        },
347	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
362	        responses.GET,
363	        "https://test/openidc/.well-known/openid-configuration",
364	        json=metadata_without_introspection,
365	    )
366	    with pytest.raises(RuntimeError):
367	        client.get("/need-token", headers={"Authorization": "Bearer dummy-token"})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
394	    with pytest.warns():
395	        app = make_test_app({"OVERWRITE_REDIRECT_URI": "http://localhost/dummy_cb"})
396	    assert app.config.get("OIDC_OVERWRITE_REDIRECT_URI", "http://localhost/dummy_cb")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
395	        app = make_test_app({"OVERWRITE_REDIRECT_URI": "http://localhost/dummy_cb"})
396	    assert app.config.get("OIDC_OVERWRITE_REDIRECT_URI", "http://localhost/dummy_cb")
397	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
399	def test_oidc_overwrite_redirect_uri(make_test_app):
400	    app = make_test_app({"OIDC_OVERWRITE_REDIRECT_URI": "http://localhost/dummy_cb"})
401	    client = app.test_client()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
421	    metadata_call = mocked_responses.get(
422	        "https://test/openidc/.well-known/openid-configuration"
423	    )
424	    tokeninfo_call = mocked_responses.post("https://test/openidc/TokenInfo", json={})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
423	    )
424	    tokeninfo_call = mocked_responses.post("https://test/openidc/TokenInfo", json={})
425	    resp_profile = client.get("/get-profile")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_flask_oidc.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
452	        test_app.config["OIDC_SERVER_METADATA_URL"]
453	        == "https://oidc.example.com/.well-known/openid-configuration"
454	    )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
38	    with (
39	        record_signal(before_authorize),
40	        record_signal(after_authorize),

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
39	        record_signal(before_authorize),
40	        record_signal(after_authorize),
41	        record_signal(before_logout),

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
40	        record_signal(after_authorize),
41	        record_signal(before_logout),
42	        record_signal(after_logout),

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
41	        record_signal(before_logout),
42	        record_signal(after_logout),
43	    ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	    resp = client.get(
49	        "http://localhost/authorize?error=dummy_error&error_description=Dummy+Error"
50	    )
51	    assert resp.status_code == 401

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	def test_authorize_no_return_url(client, mocked_responses, dummy_token, sent_signals):
62	    mocked_responses.post("https://test/openidc/Token", json=dummy_token)
63	    mocked_responses.get("https://test/openidc/UserInfo", json={"nickname": "dummy"})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	    mocked_responses.post("https://test/openidc/Token", json=dummy_token)
63	    mocked_responses.get("https://test/openidc/UserInfo", json={"nickname": "dummy"})
64	    with client.session_transaction() as session:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	    assert resp.status_code == 302
68	    assert resp.location == "http://localhost/"
69	    # Signals

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    test_app.config["OIDC_USER_INFO_ENABLED"] = False
80	    mocked_responses.post("https://test/openidc/Token", json=dummy_token)
81	    with client.session_transaction() as session:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	    assert resp.status_code == 302
100	    assert resp.location == "http://localhost/"
101	    assert "oidc_auth_token" not in flask.session

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_oidc-2.3.1/flask_oidc-2.3.1/tests/test_views.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	    # This should not redirect forever to the logout page
120	    assert response.location == "http://localhost/"
121	    flashes = flask.get_flashed_messages()

--------------------------------------------------

Code scanned:
	Total lines of code: 1246
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 32.0
		High: 4.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 0.0
Files skipped (0):
