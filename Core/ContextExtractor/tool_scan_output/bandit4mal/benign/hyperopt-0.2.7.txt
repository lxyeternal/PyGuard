Run started:2025-04-12 10:57:39.418510

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/atpe.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37	            file_name = f.name
38	            f.write(contents)
39	        yield file_name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/atpe.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
37	            file_name = f.name
38	            f.write(contents)
39	        yield file_name

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	def read_pw():
184	    return open(os.path.join(os.getenv("HOME"), ".hyperopt")).read()[:-1]
185	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
229	        if (tmp.username is not None) and pwfile:
230	            password = open(pwfile).read()[:-1]
231	        else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
263	        ssh_tunnel = subprocess.Popen(
264	            ["ssh", "-NTf", "-L", "%i:%s:%i" % (local_port, "127.0.0.1", port), host]
265	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
268	        connection = pymongo.MongoClient(
269	            "127.0.0.1", local_port, document_class=SON, w=1, j=True
270	        )
271	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
644	            raise OperationFailure("multiple name matches", (name, file_ids))
645	        return self.gfs.get(file_ids[0]).read()
646	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
786	                    )
787	                    _file.close()
788	                    raise

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
979	                try:
980	                    rval = gfs.get_version(filename=name, **query).read()
981	                    return rval

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1031
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
1030	        if host_id == None:
1031	            host_id = ("%s:%i" % (socket.gethostname(), os.getpid()),)
1032	        job = None

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1031
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
1030	        if host_id == None:
1031	            host_id = ("%s:%i" % (socket.gethostname(), os.getpid()),)
1032	        job = None

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
1183	    worker_fn = None
1184	    exec(f"import {cmd_module}; worker_fn = {cmd}")
1185	    return worker_fn

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1216	    if not is_windows:
1217	        signal.signal(signal.SIGHUP, sighandler_shutdown)
1218	        signal.signal(signal.SIGUSR1, sighandler_wait_quit)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1217
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1216	    if not is_windows:
1217	        signal.signal(signal.SIGHUP, sighandler_shutdown)
1218	        signal.signal(signal.SIGUSR1, sighandler_wait_quit)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1217	        signal.signal(signal.SIGHUP, sighandler_shutdown)
1218	        signal.signal(signal.SIGUSR1, sighandler_wait_quit)
1219	    signal.signal(signal.SIGINT, sighandler_shutdown)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1218
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1217	        signal.signal(signal.SIGHUP, sighandler_shutdown)
1218	        signal.signal(signal.SIGUSR1, sighandler_wait_quit)
1219	    signal.signal(signal.SIGINT, sighandler_shutdown)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1218	        signal.signal(signal.SIGUSR1, sighandler_wait_quit)
1219	    signal.signal(signal.SIGINT, sighandler_shutdown)
1220	    signal.signal(signal.SIGTERM, sighandler_shutdown)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1219
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1218	        signal.signal(signal.SIGUSR1, sighandler_wait_quit)
1219	    signal.signal(signal.SIGINT, sighandler_shutdown)
1220	    signal.signal(signal.SIGTERM, sighandler_shutdown)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1219	    signal.signal(signal.SIGINT, sighandler_shutdown)
1220	    signal.signal(signal.SIGTERM, sighandler_shutdown)
1221	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/mongoexp.py:1220
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1219	    signal.signal(signal.SIGINT, sighandler_shutdown)
1220	    signal.signal(signal.SIGTERM, sighandler_shutdown)
1221	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/spark.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	
407	        self._dispatcher_thread = threading.Thread(target=run_dispatcher)
408	        self._dispatcher_thread.setDaemon(True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/spark.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
531	
532	        task_thread = threading.Thread(target=run_task_thread)
533	        task_thread.setDaemon(True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_mongoexp.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
121	    expected = [
122	        ("mongo", "hyperopt", "foobar", "127.0.0.1", 27017, "hyperoptdb", "jobs", None),
123	        (

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_mongoexp.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
126	            "foobar",
127	            "127.0.0.1",
128	            27017,
129	            "hyperoptdb",
130	            "jobs",
131	            "db1",
132	        ),
133	    ]
134	
135	    for i, uri in enumerate(uris):
136	        assert parse_url(uri) == expected[i]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_mongoexp.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
199	    def newth(ii):
200	        return threading.Thread(
201	            target=_worker_thread_fn, args=(("hostname", ii), n_jobs, timeout, dbname)
202	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_mongoexp.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
335	        worker_threads = [
336	            threading.Thread(
337	                target=TestExperimentWithThreads.worker_thread_fn,
338	                args=(("hostname", ii), jobs_per_thread, 30.0),
339	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_mongoexp.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
350	            fmin_threads = [
351	                threading.Thread(
352	                    target=TestExperimentWithThreads.fmin_thread_fn,
353	                    args=(domain.expr, trials, max_evals, seed),
354	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_mongoexp.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
426	        max_evals = 3
427	        fmin_thread = threading.Thread(
428	            target=fmin_thread_fn, args=(space, trials, max_evals)
429	        )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_spark.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
44	    def remove_tempdir(cls):
45	        shutil.rmtree(cls.tempdir)
46	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_spark.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
74	        cls._sc = None
75	        shutil.rmtree(cls.checkpointDir)
76	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_spark.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
570	            with open(os.path.join(output_dir, str(timeit.default_timer())), "w") as f:
571	                f.write("1")
572	            raise Exception("Failed!")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/integration/test_spark.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
570	            with open(os.path.join(output_dir, str(timeit.default_timer())), "w") as f:
571	                f.write("1")
572	            raise Exception("Failed!")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/tests/unit/test_utils.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
143	        if isdir(basedir):
144	            shutil.rmtree(basedir)
145	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/utils.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
55	            logger.info("importing %s" % modname)
56	            exec(f"import {modname}")
57	            exec(f"rval = {modname}")

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/utils.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
56	            exec(f"import {modname}")
57	            exec(f"rval = {modname}")
58	        except ImportError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	    if argfile is not None:
111	        argstr = open(argfile).read()
112	    if argstr is not None:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/hyperopt/utils.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
261	        # erase all files in workdir
262	        shutil.rmtree(dir)
263	        if with_sentinel:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/hyperopt-0.2.7/hyperopt-0.2.7/setup.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    entry_points={"console_scripts": ["hyperopt-mongo-worker=hyperopt.mongoexp:main"]},
17	    url="https://hyperopt.github.io/hyperopt",
18	    author="James Bergstra",

--------------------------------------------------

Code scanned:
	Total lines of code: 11915
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 8.0
Files skipped (0):
