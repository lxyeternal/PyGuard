Run started:2025-04-12 11:21:13.957346

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools/api.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	        """Build the API url based on the given url and port. Defaults to `https://api.domaintools.com`"""
97	        rest_api_url = "https://api.domaintools.com"
98	        if api_url:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools/base_results.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
120	        if self.api.rate_limit and (wait_for is None or self.product == "account-information"):
121	            data = self._make_request()
122	            if data.status_code == 503:  # pragma: no cover

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools/base_results.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
130	                self._wait_time()
131	                data = self._make_request()
132	            return data

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools/base_results.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
136	            time.sleep(wait_for)
137	        return self._make_request()
138	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools/cli/api.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
237	                    # if it's a file then write
238	                    out_file.write(output if output.endswith("\n") else output + "\n")
239	                time.sleep(0.25)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools/cli/utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	def _phisheye_helptext():
33	    return """
34	        Returns domain results for the specified term for today or the specified number of days_back. Terms must be setup for monitoring via the web interface: https://research.domaintools.com/phisheye. \n

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools/cli/utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	def _phisheye_termlist():
43	    return """
44	        Provides a list of terms that are set up for this account. This call is not charged against your API usage limit.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools_async/__init__.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
76	                    try:
77	                        await self._make_async_request(session)
78	                    except ServiceUnavailableException:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools_async/__init__.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
80	                        self._wait_time()
81	                        await self._make_async_request(session)
82	                else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/domaintools_async/__init__.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
83	                    await asyncio.sleep(wait_time)
84	                    await self._make_async_request(session)
85	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
111	def test_ip_monitor():
112	    api_call = api.ip_monitor("65.55.53.233")
113	    with api_call as results:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_api.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
113	    with api_call as results:
114	        assert results["ip_address"] == "65.55.53.233"
115	        assert "alerts" in results

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_api.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
220	def test_host_domains():
221	    with api.host_domains(ip="199.30.228.112") as results:
222	        assert "ip_addresses" in results

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_api.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
245	
246	    with api.reverse_ip_whois(ip="65.55.53.233") as result:
247	        assert "ip_to_alloc" in result

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_api.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
258	    with pytest.raises(ValueError):
259	        api.reverse_ip_whois(ip="8.8.8.8", query="Google")
260	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_api.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
527	    with pytest.raises(exceptions.ServiceException):
528	        response = api.iris_investigate(ip="8.8.8.8")
529	        response.response()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
104	    assert ips == {
105	        "142.250.115.26",
106	        "142.250.141.27",
107	        "198.51.44.4",
108	        "198.51.44.68",
109	        "198.51.45.4",
110	        "198.51.45.68",
111	        "199.30.228.112",
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
105	        "142.250.115.26",
106	        "142.250.141.27",
107	        "198.51.44.4",
108	        "198.51.44.68",
109	        "198.51.45.4",
110	        "198.51.45.68",
111	        "199.30.228.112",
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	
116	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
106	        "142.250.141.27",
107	        "198.51.44.4",
108	        "198.51.44.68",
109	        "198.51.45.4",
110	        "198.51.45.68",
111	        "199.30.228.112",
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	
116	
117	def test_get_pivots():

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
107	        "198.51.44.4",
108	        "198.51.44.68",
109	        "198.51.45.4",
110	        "198.51.45.68",
111	        "199.30.228.112",
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	
116	
117	def test_get_pivots():
118	    pivots = utils.get_pivots(iris_investigate_data.domaintools().get("results"), "")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
108	        "198.51.44.68",
109	        "198.51.45.4",
110	        "198.51.45.68",
111	        "199.30.228.112",
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	
116	
117	def test_get_pivots():
118	    pivots = utils.get_pivots(iris_investigate_data.domaintools().get("results"), "")
119	    assert pivots == [["IP ADDRESS", ("199.30.228.112", 4)], ["IP ASN", (17318, 111)], ["IP ISP", ("DomainTools LLC", 222)]]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
109	        "198.51.45.4",
110	        "198.51.45.68",
111	        "199.30.228.112",
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	
116	
117	def test_get_pivots():
118	    pivots = utils.get_pivots(iris_investigate_data.domaintools().get("results"), "")
119	    assert pivots == [["IP ADDRESS", ("199.30.228.112", 4)], ["IP ASN", (17318, 111)], ["IP ISP", ("DomainTools LLC", 222)]]
120	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
110	        "198.51.45.68",
111	        "199.30.228.112",
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	
116	
117	def test_get_pivots():
118	    pivots = utils.get_pivots(iris_investigate_data.domaintools().get("results"), "")
119	    assert pivots == [["IP ADDRESS", ("199.30.228.112", 4)], ["IP ASN", (17318, 111)], ["IP ISP", ("DomainTools LLC", 222)]]
120	
121	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
111	        "199.30.228.112",
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	
116	
117	def test_get_pivots():
118	    pivots = utils.get_pivots(iris_investigate_data.domaintools().get("results"), "")
119	    assert pivots == [["IP ADDRESS", ("199.30.228.112", 4)], ["IP ASN", (17318, 111)], ["IP ISP", ("DomainTools LLC", 222)]]
120	
121	
122	def test_validate_feeds_parameters_update_header_auth_to_False(test_feeds_params):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
112	        "64.233.171.26",
113	        "74.125.142.26",
114	    }
115	
116	
117	def test_get_pivots():
118	    pivots = utils.get_pivots(iris_investigate_data.domaintools().get("results"), "")
119	    assert pivots == [["IP ADDRESS", ("199.30.228.112", 4)], ["IP ASN", (17318, 111)], ["IP ISP", ("DomainTools LLC", 222)]]
120	
121	
122	def test_validate_feeds_parameters_update_header_auth_to_False(test_feeds_params):
123	    test_feeds_params["output_format"] = "jsonl"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/domaintools_api-2.3.0/domaintools_api-2.3.0/tests/test_utils.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
118	    pivots = utils.get_pivots(iris_investigate_data.domaintools().get("results"), "")
119	    assert pivots == [["IP ADDRESS", ("199.30.228.112", 4)], ["IP ASN", (17318, 111)], ["IP ISP", ("DomainTools LLC", 222)]]
120	

--------------------------------------------------

Code scanned:
	Total lines of code: 4926
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 0.0
Files skipped (0):
