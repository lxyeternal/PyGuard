Run started:2025-04-12 13:46:57.602721

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/__init__.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	        iframe = IFrame(
31	            f'https://ai.finlab.tw/api_token/?version={__version__}', width=620, height=300)
32	        display(iframe)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/__init__.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	        try:
35	            token = getpass('請從 https://ai.finlab.tw/api_token 複製驗證碼: \n')
36	        except:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/__init__.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        except:
37	            print('請從 https://ai.finlab.tw/api_token 複製驗證碼: \n')
38	            token = input('驗證碼：')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/__init__.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    def display_text_input(self):
43	        print('請從 https://ai.finlab.tw/api_token 複製驗證碼，貼於此處:\n')
44	        token = input('驗證碼：')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/backtest.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	
52	        res = requests.get('https://asia-east2-fdata-299302.cloudfunctions.net/auth_backtest',
53	                           {'api_token': finlab.get_token(), 'time': str(datetime.datetime.now())})
54	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/backtest.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	
52	        res = requests.get('https://asia-east2-fdata-299302.cloudfunctions.net/auth_backtest',
53	                           {'api_token': finlab.get_token(), 'time': str(datetime.datetime.now())})
54	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/backtest.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
215	    }
216	    r = requests.post("https://notify-api.line.me/api/notify",
217	                      headers=headers, params={'message': message})
218	    if test:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/backtest.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
215	    }
216	    r = requests.post("https://notify-api.line.me/api/notify",
217	                      headers=headers, params={'message': message})
218	    if test:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/backtest.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
417	        print('           If the complete backtest result is required, please implement Market Class with get_price function.')
418	        print('           Market details: https://doc.finlab.tw/reference/market_info/')
419	        print('           And use backtest.sim(..., market=Market) during backtest, so that the correct information is accessable from backtest.sim().')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/broker.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	    config = ConfigParser()
10	    config.read(config_file)
11	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/broker.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
15	    with open(file_path, 'rb') as file:
16	        file_content = file.read()
17	    return file_content.decode('latin1')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/broker.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
21	    with open(output_path, 'wb') as file:
22	        file.write(decoded_content)
23	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/broker.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
122	        config = ConfigParser()
123	        config.read(os.environ['FUGLE_CONFIG_PATH'])
124	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/broker.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
198	        with open(os.path.join(account_path, 'config.ini'), 'w') as f:
199	            config.write(f)
200	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/data_encryptor.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
29	        )
30	        key = urlsafe_b64encode(kdf.derive(password.encode()))
31	        return key

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/data_encryptor.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	        # Combine the salt and the encrypted data for storage/transmission
41	        combined = urlsafe_b64encode(salt + encrypted_data).decode()
42	        return combined

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/data_encryptor.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
46	        password = password or cls.__get_machine_password_static()
47	        combined = urlsafe_b64decode(encrypted_data.encode())
48	        salt = combined[:16]

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/data_encryptor.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
63	        )
64	        key = urlsafe_b64encode(kdf.derive(password.encode()))
65	        return key

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/data_encryptor.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	        with open(path, 'w') as file:
83	            file.write(encrypted_data)
84	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/data_encryptor.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	            with open(path, 'r') as file:
90	                encrypted_data = file.read()
91	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/login.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	            scopes=[
57	                'https://www.googleapis.com/auth/userinfo.profile',
58	                'openid',
59	                'https://www.googleapis.com/auth/userinfo.email',
60	            ],
61	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/login.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	                'openid',
59	                'https://www.googleapis.com/auth/userinfo.email',
60	            ],
61	        )
62	        creds = flow.run_local_server()
63	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/login.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	    global google_token
73	    html_content = """
74	<!DOCTYPE html>
75	<html>
76	<head>
77	    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
78	    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
79	    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
80	    <script>
81	        // Firebase configuration
82	        const firebaseConfig = {{ firebase_config | safe }};
83	        const googleToken = "{{ google_token }}";
84	
85	        // Initialize Firebase
86	        firebase.initializeApp(firebaseConfig);
87	
88	        async function googleSignIn() {
89	            try {
90	                const credential = firebase.auth.GoogleAuthProvider.credential(googleToken);
91	                const result = await firebase.auth().signInWithCredential(credential);
92	
93	                const user = result.user;
94	                const token = await user.getIdToken();
95	                
96	                // get user custom claims
97	                const idToken = await user.getIdTokenResult();
98	                // alert('customClaims:', idToken.claims['role']);
99	
100	                const response = await fetch('/fetch-data', {
101	                    method: 'POST',
102	                    headers: {
103	                        'Content-Type': 'application/json'
104	                    },
105	                    body: JSON.stringify({ token, claims: idToken.claims })
106	                });
107	
108	                if (response.ok) {
109	                    console.log("Data fetched successfully");
110	                } else {
111	                    console.error("Error fetching data");
112	                }
113	            } catch (error) {
114	                // alert("Error during sign-in: " + error.message);
115	                console.error("Error during sign-in:", error);
116	            }
117	        }
118	
119	        window.onload = googleSignIn;
120	    </script>
121	</head>
122	<body>
123	    <h1>Firestore Data Fetch</h1>
124	</body>
125	</html>
126	"""
127	    return render_template_string(html_content, firebase_config=json.dumps(firebase_config), google_token=google_token)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/login.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	
147	    firebase_token = request.json.get('token')
148	    claims = request.json.get('claims')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/login.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	    firebase_token = request.json.get('token')
148	    claims = request.json.get('claims')
149	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/login.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
178	
179	    server = Thread(target=app.run, kwargs={'port': 5000, 'debug': False}, daemon=True)
180	    server.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/login.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	
185	    _webview_process = subprocess.Popen([python_executable, "-c", """
186	import webview

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	
31	    doc_ref = f"https://firestore.googleapis.com/v1/projects/{firebase_config['projectId']}/databases/(default)/documents/users/{user_id}"
32	    response = requests.get(doc_ref, headers=headers)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	    doc_ref = f"https://firestore.googleapis.com/v1/projects/{firebase_config['projectId']}/databases/(default)/documents/users/{user_id}"
32	    response = requests.get(doc_ref, headers=headers)
33	    data = response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	
83	    doc_ref = f"https://firestore.googleapis.com/v1/projects/{firebase_config['projectId']}/databases/(default)/documents/users/{user_id}"
84	    response = requests.get(doc_ref, headers=headers)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	    doc_ref = f"https://firestore.googleapis.com/v1/projects/{firebase_config['projectId']}/databases/(default)/documents/users/{user_id}"
84	    response = requests.get(doc_ref, headers=headers)
85	    data = response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	
96	    doc_ref = f"https://firestore.googleapis.com/v1/projects/{firebase_config['projectId']}/databases/(default)/documents/users/{user_id}/strategies/{strategy_name}/codes/code"
97	    response = requests.get(doc_ref, headers=headers)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	    doc_ref = f"https://firestore.googleapis.com/v1/projects/{firebase_config['projectId']}/databases/(default)/documents/users/{user_id}/strategies/{strategy_name}/codes/code"
97	    response = requests.get(doc_ref, headers=headers)
98	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
159	    file_path = os.path.join(path, f"{output_file_name}.ipynb")
160	    nbformat.write(nb, file_path)
161	    return {

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	    nb.cells = [nbf.new_code_cell(f"%env FINLAB_STRATEGY_NAME={strategy_name}")]
171	    nbformat.write(nb, path)
172	    return {"success": True, "file_path": path}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
178	
179	    nb = nbformat.read(os.path.join(path, f"{strategy_name}.ipynb"), as_version=4)
180	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	
198	    doc_ref = f"https://firestore.googleapis.com/v1/projects/{firebase_config['projectId']}/databases/(default)/documents/users/{user_id}/strategies/{strategy_name}/codes/code"
199	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
213	
214	    doc_ref = f"https://firestore.googleapis.com/v1/projects/{firebase_config['projectId']}/databases/(default)/documents/users/{user_id}"
215	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
293	        if output:
294	            url_match = re.search(r"http://localhost:\d+/\?token=[\w:]+", output)
295	            if url_match:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
303	    with open(f"{WORKSPACE_PATH}/finlab.jupyterlab-workspace", "w") as f:
304	        f.write(setting_file)
305	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
317	        + WORKSPACE_PATH
318	        + """\" --no-browser  --LabApp.tornado_settings=\"{'headers': {'Content-Security-Policy': \\"frame-ancestors 'self' http://localhost:5173 http://127.0.0.1:8888\\"}}" &"""
319	    )
320	    print(command)
321	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/notebook.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
339	        file_name = quote(file_name)
340	        openning_url = f"http://localhost:{port}/lab/workspaces/finlab/tree/{file_name}?token={token}?reset"
341	        print(openning_url)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/workspace.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	        with open(install_script, 'w') as f:
42	            f.write(read_resource_file('finlab.cli', 'install_jupyter.bat'))
43	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/workspace.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	        with open(install_script, 'w') as f:
51	            f.write(read_resource_file('finlab.cli', 'install_jupyter.sh'))
52	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/cli/workspace.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	        with click.open_file(env_config_path, 'w') as f:
99	            f.write(env_txt)
100	        

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/data.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	        if self._expiry:
156	            res = finlab.utils.requests.get('https://asia-east1-fdata-299302.cloudfunctions.net/data_reset_time', timeout=300)
157	            reset_data_time = datetime.datetime.fromtimestamp(float(res.text), tz=datetime.timezone.utc)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/data.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
261	                elif os.path.isdir(file_path):
262	                    shutil.rmtree(file_path)
263	            except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/data.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
618	    def get_location():
619	        response = finlab.utils.requests.get('http://ipinfo.io', timeout=300)
620	        if response.status_code == 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/data.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
680	
681	    url = 'https://asia-east2-fdata-299302.cloudfunctions.net/auth_generate_data_url'
682	    params = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/data.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
714	        if ret['error'] == 'Usage exceed 5000 MB/day. Please consider upgrade to VIP program.':
715	            raise Exception(f"**Error: Usage exceed 5000 MB/day. Please consider reaching out to us at https://discord.gg/tAr4ysPqvR to reset your usage.")
716	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/data.py:1243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1242	
1243	    url = 'https://asia-east2-fdata-299302.cloudfunctions.net/auth_get_strategies'
1244	    response = finlab.utils.requests.get(url, request_args, timeout=300)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/data.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1290	    if not hasattr(search, 'db_info'):
1291	        res = finlab.utils.requests.get('https://asia-east2-fdata-299302.cloudfunctions.net/get_data_info', timeout=300)
1292	        search.db_info = json.loads(res.text)['data']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/ffn_core.py:924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
923	            with open(path, "w") as fl:
924	                fl.write(res)
925	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/ffn_core.py:1269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1268	            with open(path, "w") as fl:
1269	                fl.write(res)
1270	        else:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/ml/feature.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
314	            import multiprocessing
315	            with multiprocessing.Pool(processes=cpu) as pool:
316	

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/ml/feature.py:315
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
314	            import multiprocessing
315	            with multiprocessing.Pool(processes=cpu) as pool:
316	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/ml/qlib.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
261	        with tqdm(total=len(self.csv_files)) as p_bar:
262	            with ProcessPoolExecutor(max_workers=self.works) as executor:
263	                for file_path, ((_begin_time, _end_time), _set_calendars) in zip(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/ml/qlib.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
292	        with tqdm(total=len(self.csv_files)) as p_bar:
293	            with ProcessPoolExecutor(max_workers=self.works) as executor:
294	                for _ in executor.map(_dump_func, self.csv_files):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
27	        self.events = []
28	        self.thread_sched = threading.Thread(target=self.running_sched)
29	        self.thread_sched.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	
31	        self.thread_update_price = threading.Thread(target=self.update_price)
32	        if self.paper_trade:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    def fetch_portfolio(self):
53	        url = 'https://asia-east2-fdata-299302.cloudfunctions.net/dashboard_get_portfolio'
54	        return requests.post(url, json={'api_token': finlab.get_token()}).json()['msg']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
53	        url = 'https://asia-east2-fdata-299302.cloudfunctions.net/dashboard_get_portfolio'
54	        return requests.post(url, json={'api_token': finlab.get_token()}).json()['msg']
55	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    def set_portfolio(self, allocs):
57	        url = 'https://asia-east2-fdata-299302.cloudfunctions.net/dashboard_set_portfolio'
58	        # url = 'http://127.0.0.1:8080'
59	        return requests.post(url, json={

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
58	        # url = 'http://127.0.0.1:8080'
59	        return requests.post(url, json={
60	            'api_token': finlab.get_token(),
61	            'allocs': allocs,
62	            }).json()['msg']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	
127	            url = 'https://asia-east2-fdata-299302.cloudfunctions.net/dashboard_set_qty'
128	            res = requests.post(url, json={

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
127	            url = 'https://asia-east2-fdata-299302.cloudfunctions.net/dashboard_set_qty'
128	            res = requests.post(url, json={
129	                                'target_qty': target_qty, 'present_qty': present_qty,
130	                                'api_token': finlab.get_token(), 'pt': self.paper_trade})
131	        

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	            # upload present and target qty
150	            url = 'https://asia-east2-fdata-299302.cloudfunctions.net/dashboard_set_qty'
151	            requests.post(url, json={

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
150	            url = 'https://asia-east2-fdata-299302.cloudfunctions.net/dashboard_set_qty'
151	            requests.post(url, json={
152	                'target_qty': [], 'present_qty': present_qty,
153	                'api_token': finlab.get_token(), 'pt': True})
154	 

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	
211	            url = "https://asia-east2-fdata-299302.cloudfunctions.net/dashboard_add_txn"
212	
213	            json = {

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/dashboard.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
225	            }
226	            requests.post(url, json=json)
227	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	        config = ConfigParser()
51	        config.read(config_path)
52	        # 將設定檔內容寫至 SDK 中，並確認是否已設定密碼

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
88	        if self.user_account not in threads:
89	            self.thread = Thread(target=lambda: self.sdk.connect_websocket())
90	            self.thread.daemon = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	
162	        if order_id not in trades[self.user_account] or trades[self.user_account][order_id].org_order.get('kind', '') == 'ACK':
163	            self.get_orders()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
202	        global trades
203	        if not order_id in trades[self.user_account] or trades[self.user_account][order_id].org_order.get('kind', '') == 'ACK':
204	            trades[self.user_account] = self.get_orders()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	            try:
250	                res = requests.get(
251	                    f'https://api.fugle.tw/marketdata/v1.0/stock/intraday/quote/{s}',headers={'X-API-KEY': self.market_api_key})
252	                json_response = res.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
250	                res = requests.get(
251	                    f'https://api.fugle.tw/marketdata/v1.0/stock/intraday/quote/{s}',headers={'X-API-KEY': self.market_api_key})
252	                json_response = res.json()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
349	                func(o)
350	        self.threading = Thread(target=lambda: self.sdk.connect_websocket())
351	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
355	    def get_price_info(self):
356	        ref = data.get('reference_price')
357	        return ref.set_index('stock_id').to_dict(orient='index')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	        status = OrderStatus.FILLED
378	    elif order['mat_qty'] == 0 and order['cel_qty'] == 0 and order.get('celable', '1') == '1':
379	        status = OrderStatus.NEW

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
379	        status = OrderStatus.NEW
380	    elif order['org_qty'] > order['mat_qty'] + order['cel_qty'] and order.get('celable', '1') == '1' and order['mat_qty'] > 0:
381	        status = OrderStatus.PARTIALLY_FILLED

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/fugle_account.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	        'action': Action.BUY if order['buy_sell'] == 'B' else Action.SELL,
408	        'price': order.get('od_price', 0),
409	        'quantity': order['org_qty'] - order['cel_qty'],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	        if price is None:
182	            price = data.get('reference_price').set_index('stock_id')['收盤價'].to_dict()
183	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
420	            if s['order_condition'] == oc:
421	                q = qty.get(s['stock_id'], 0)
422	                qty[s['stock_id']] = q + s.get(attr, 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
421	                q = qty.get(s['stock_id'], 0)
422	                qty[s['stock_id']] = q + s.get(attr, 0)
423	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	                for p in new_pos:
456	                    p['weight'] = ws.get(p['stock_id'], 0)
457	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
470	        for key in keys:
471	            value1 = position1.get(key, 0)
472	            value2 = position2.get(key, 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	            value1 = position1.get(key, 0)
472	            value2 = position2.get(key, 0)
473	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
546	
547	        res = requests.get('https://www.sinotrade.com.tw/Stock/Stock_3_8_3')
548	        dfs = pd.read_html(res.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
546	
547	        res = requests.get('https://www.sinotrade.com.tw/Stock/Stock_3_8_3')
548	        dfs = pd.read_html(res.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
550	
551	        res = requests.get('https://www.sinotrade.com.tw/Stock/Stock_3_8_1')
552	        dfs = pd.read_html(res.text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
550	
551	        res = requests.get('https://www.sinotrade.com.tw/Stock/Stock_3_8_1')
552	        dfs = pd.read_html(res.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/online/order_executor.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
557	        if credit_sids.any():
558	            close = data.get('price:收盤價').ffill().iloc[-1]
559	            for sid in list(credit_sids.values):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/cloud_report.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        logger.info(
39	            "OnlineReport is in beta version, please report any issue to FinLab Team at https://discord.gg/tAr4ysPqvR")
40	
41	        required_sdata_structure = {

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/cloud_report.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
146	        # Decode base64 string to gzip bytes
147	        gzip_bytes = base64.b64decode(gzip_b64_str)
148	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/cloud_report.py:147
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
146	        # Decode base64 string to gzip bytes
147	        gzip_bytes = base64.b64decode(gzip_b64_str)
148	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/cloud_report.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	
163	        url = 'https://asia-east2-fdata-299302.cloudfunctions.net/auth_get_strategy'
164	
165	        params = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/cloud_report.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
173	
174	        res = requests.get(url, params)
175	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	                   pdata['positionConfig']['entryTradePrice'], market, 
90	                   pdata['positionConfig'].get('sl', 1), 
91	                   pdata['positionConfig'].get('tp', np.inf), 

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
90	                   pdata['positionConfig'].get('sl', 1), 
91	                   pdata['positionConfig'].get('tp', np.inf), 
92	                   pdata['positionConfig'].get('ts', np.inf),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	                   pdata['positionConfig'].get('tp', np.inf), 
92	                   pdata['positionConfig'].get('ts', np.inf),
93	                   total_weight)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	
112	        url = 'https://asia-east2-fdata-299302.cloudfunctions.net/auth_get_strategy'
113	
114	        res = requests.get(url, {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	
114	        res = requests.get(url, {
115	            'api_token': finlab.get_token(),
116	            'sid': strategy_id,
117	        })

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	        logger.info(
207	            "Portfolio is in beta version, please report any issue to FinLab Team at https://discord.gg/tAr4ysPqvR")
208	        
209	        if isinstance(reports, Report):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	def position_type_check(position_name, data):
26	    if not isinstance(data.get('timestamp'), str):
27	        logger.warning(f"{position_name}: timestamp must be a string, got {type(data.get('timestamp'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	    if not isinstance(data.get('timestamp'), str):
27	        logger.warning(f"{position_name}: timestamp must be a string, got {type(data.get('timestamp'))} instead")
28	    if not isinstance(data.get('next_trading_time'), str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	        logger.warning(f"{position_name}: timestamp must be a string, got {type(data.get('timestamp'))} instead")
28	    if not isinstance(data.get('next_trading_time'), str):
29	        logger.warning(f"{position_name}: next_trading_time must be a string")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	        logger.warning(f"{position_name}: next_trading_time must be a string")
30	    if not isinstance(data.get('position'), list):
31	        logger.warning(f"{position_name}: position must be a float or int, got {type(data.get('position'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	    if not isinstance(data.get('position'), list):
31	        logger.warning(f"{position_name}: position must be a float or int, got {type(data.get('position'))} instead")
32	    if not isinstance(data.get('allocation'), (float, int)):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	        logger.warning(f"{position_name}: position must be a float or int, got {type(data.get('position'))} instead")
32	    if not isinstance(data.get('allocation'), (float, int)):
33	        logger.warning(f"{position_name}: allocation must be a float or int, got {type(data.get('allocation'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	    if not isinstance(data.get('allocation'), (float, int)):
33	        logger.warning(f"{position_name}: allocation must be a float or int, got {type(data.get('allocation'))} instead")
34	    if not isinstance(data.get('weight'), (float, int)):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	        logger.warning(f"{position_name}: allocation must be a float or int, got {type(data.get('allocation'))} instead")
34	    if not isinstance(data.get('weight'), (float, int)):
35	        logger.warning(f"{position_name}: weight must be a float or int, got {type(data.get('weight'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	    if not isinstance(data.get('weight'), (float, int)):
35	        logger.warning(f"{position_name}: weight must be a float or int, got {type(data.get('weight'))} instead")
36	    if not isinstance(data.get('entry_at'), str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	        logger.warning(f"{position_name}: weight must be a float or int, got {type(data.get('weight'))} instead")
36	    if not isinstance(data.get('entry_at'), str):
37	        logger.warning(f"{position_name}: entry_at must be a string, got {type(data.get('entry_at'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	    if not isinstance(data.get('entry_at'), str):
37	        logger.warning(f"{position_name}: entry_at must be a string, got {type(data.get('entry_at'))} instead")
38	    if not isinstance(data.get('exit_at'), str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	        logger.warning(f"{position_name}: entry_at must be a string, got {type(data.get('entry_at'))} instead")
38	    if not isinstance(data.get('exit_at'), str):
39	        logger.warning(f"{position_name}: exit_at must be a string, got {type(data.get('exit_at'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	    if not isinstance(data.get('exit_at'), str):
39	        logger.warning(f"{position_name}: exit_at must be a string, got {type(data.get('exit_at'))} instead")
40	    if not isinstance(data.get('market'), str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        logger.warning(f"{position_name}: exit_at must be a string, got {type(data.get('exit_at'))} instead")
40	    if not isinstance(data.get('market'), str):
41	        if data.get('market', None) is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	    if not isinstance(data.get('market'), str):
41	        if data.get('market', None) is None:
42	            data['market'] = 'tw_stock'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	            data['market'] = 'tw_stock'
43	    if not isinstance(data.get('stop'), list):
44	        logger.warning(f"{position_name}: stop must be a list, got {type(data.get('stop'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    if not isinstance(data.get('stop'), list):
44	        logger.warning(f"{position_name}: stop must be a list, got {type(data.get('stop'))} instead")
45	    if data.get('stop_loss') is not None and not isinstance(data.get('stop_loss'), (float, int)):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	        logger.warning(f"{position_name}: stop must be a list, got {type(data.get('stop'))} instead")
45	    if data.get('stop_loss') is not None and not isinstance(data.get('stop_loss'), (float, int)):
46	        logger.warning(f"{position_name}: stop_loss must be a float or int, got {type(data.get('stop_loss'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	        logger.warning(f"{position_name}: stop must be a list, got {type(data.get('stop'))} instead")
45	    if data.get('stop_loss') is not None and not isinstance(data.get('stop_loss'), (float, int)):
46	        logger.warning(f"{position_name}: stop_loss must be a float or int, got {type(data.get('stop_loss'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	    if data.get('stop_loss') is not None and not isinstance(data.get('stop_loss'), (float, int)):
46	        logger.warning(f"{position_name}: stop_loss must be a float or int, got {type(data.get('stop_loss'))} instead")
47	    if data.get('take_profit') is not None and not isinstance(data.get('take_profit'), (float, int)):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	        logger.warning(f"{position_name}: stop_loss must be a float or int, got {type(data.get('stop_loss'))} instead")
47	    if data.get('take_profit') is not None and not isinstance(data.get('take_profit'), (float, int)):
48	        logger.warning(f"{position_name}: take_profit must be a float or int, got {type(data.get('take_profit'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	        logger.warning(f"{position_name}: stop_loss must be a float or int, got {type(data.get('stop_loss'))} instead")
47	    if data.get('take_profit') is not None and not isinstance(data.get('take_profit'), (float, int)):
48	        logger.warning(f"{position_name}: take_profit must be a float or int, got {type(data.get('take_profit'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	    if data.get('take_profit') is not None and not isinstance(data.get('take_profit'), (float, int)):
48	        logger.warning(f"{position_name}: take_profit must be a float or int, got {type(data.get('take_profit'))} instead")
49	    if data.get('trail_stop') is not None and not isinstance(data.get('trail_stop'), (float, int)):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	        logger.warning(f"{position_name}: take_profit must be a float or int, got {type(data.get('take_profit'))} instead")
49	    if data.get('trail_stop') is not None and not isinstance(data.get('trail_stop'), (float, int)):
50	        logger.warning(f"{position_name}: trail_stop must be a float or int, got {type(data.get('trail_stop'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	        logger.warning(f"{position_name}: take_profit must be a float or int, got {type(data.get('take_profit'))} instead")
49	    if data.get('trail_stop') is not None and not isinstance(data.get('trail_stop'), (float, int)):
50	        logger.warning(f"{position_name}: trail_stop must be a float or int, got {type(data.get('trail_stop'))} instead")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    if data.get('trail_stop') is not None and not isinstance(data.get('trail_stop'), (float, int)):
50	        logger.warning(f"{position_name}: trail_stop must be a float or int, got {type(data.get('trail_stop'))} instead")
51	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	    LOCAL_DIR = os.path.join(get_tmp_dir(), 'workspace')
105	    CLOUD_URL = 'https://asia-east2-fdata-299302.cloudfunctions.net/auth_portfolio'
106	
107	    def __init__(self, data:Optional[Dict]=None, start_with_empty=False):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	        """
158	        url = 'https://asia-east2-fdata-299302.cloudfunctions.net/auth_portfolio'
159	        res = requests.post(cls.CLOUD_URL, params={

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
158	        url = 'https://asia-east2-fdata-299302.cloudfunctions.net/auth_portfolio'
159	        res = requests.post(cls.CLOUD_URL, params={
160	            'pid': name,
161	            'api_token': finlab.get_token(),
162	            'action': 'get'
163	            }, timeout=30)
164	        

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
209	        """
210	        res = requests.post(self.CLOUD_URL, params={
211	            'pid': name,
212	            'api_token': finlab.get_token(),
213	            'action': 'set'
214	        }, json=replace_inf_nan(self.data), timeout=30)
215	        return res

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
524	            if sid in position:
525	                history[sid] = history.get(sid, [])
526	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
571	                            position[sid]['stop'][-1]['timestamp'] = now.isoformat()
572	                            position[sid]['stop'][-1]['reason'] = allocation.actions.to_dict().get(s, None)
573	                            p['quantity'] = 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
583	                            position[sid]['stop'][-1]['timestamp'] = now.isoformat()
584	                            position[sid]['stop'][-1]['reason'] = allocation.actions.to_dict().get(s, None)
585	                            p['quantity'] = 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
588	    def get_last_market_timestamp(self):
589	        timestamps = [sdata.get('last_market_timestamp') for sid, sdata in self.data['position'].items() if 'last_market_timestamp' in sdata]
590	        if len(timestamps) == 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
605	
606	        strategy_position = self.data['position'].get(strategy_name, {})
607	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
611	        # for now, we just assume the exit_at is the same as entry_at
612	        assert strategy_position.get('entry_at', 'close') == strategy_position.get('exit_at', 'close'), \
613	            'entry_at and exit_at difference is not supported'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
611	        # for now, we just assume the exit_at is the same as entry_at
612	        assert strategy_position.get('entry_at', 'close') == strategy_position.get('exit_at', 'close'), \
613	            'entry_at and exit_at difference is not supported'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
616	
617	        has_market_timestamp = strategy_position.get('last_market_timestamp', None) is not None
618	        is_trade_at_open = strategy_position['entry_at'] == 'open'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
618	        is_trade_at_open = strategy_position['entry_at'] == 'open'
619	        last_market_timestamp_is_the_same = strategy_position.get('last_market_timestamp', None)\
620	            == market.market_close_at_timestamp(market.get_price('close').index[-1]).isoformat()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
642	                (at == 'prev_close')
643	                and (latest_market_timestamp == strategy_position.get('last_market_timestamp', None))
644	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
651	        # since at the time of the next trading date, the position is not updated
652	        strategy_history = self.data['history'].get(strategy_name, [])
653	        if len(strategy_history) == 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
655	
656	        if strategy_history[-1].get('last_market_timestamp', None) == strategy_position.get('last_market_timestamp', None):
657	            if len(strategy_history) >= 2:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
655	
656	        if strategy_history[-1].get('last_market_timestamp', None) == strategy_position.get('last_market_timestamp', None):
657	            if len(strategy_history) >= 2:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
801	            df = pd.DataFrame(p.position)\
802	                .pipe(lambda df: df.assign(strategy=df.apply(lambda r: has_strategy.get((r.stock_id, r.order_condition), ''), axis=1)))\
803	                .pipe(lambda df: df.assign(type=df.order_condition.map(lambda v: OrderCondition(v).name)))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
804	
805	            df = df.pipe(lambda df: df.assign(price=df.stock_id.map(lambda i: ref_price.get(i, 0))))\
806	                .pipe(lambda df: df.assign(weight=df.stock_id.map(lambda i: close_price.get(i, 0))*df.quantity / total_allocation * 1000))\

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
805	            df = df.pipe(lambda df: df.assign(price=df.stock_id.map(lambda i: ref_price.get(i, 0))))\
806	                .pipe(lambda df: df.assign(weight=df.stock_id.map(lambda i: close_price.get(i, 0))*df.quantity / total_allocation * 1000))\
807	                .pipe(lambda df: df.assign(close_price=df.stock_id.map(lambda i: close_price.get(i, 0))))\

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
806	                .pipe(lambda df: df.assign(weight=df.stock_id.map(lambda i: close_price.get(i, 0))*df.quantity / total_allocation * 1000))\
807	                .pipe(lambda df: df.assign(close_price=df.stock_id.map(lambda i: close_price.get(i, 0))))\
808	                .pipe(lambda df: df.assign(volume=df.stock_id.map(lambda i: volume.get(i, 0) / 1000)))[["stock_id", "quantity", "price", "weight", "close_price", "volume", "strategy", "type"]]\

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/portfolio/portfolio_sync_manager.py:808
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
807	                .pipe(lambda df: df.assign(close_price=df.stock_id.map(lambda i: close_price.get(i, 0))))\
808	                .pipe(lambda df: df.assign(volume=df.stock_id.map(lambda i: volume.get(i, 0) / 1000)))[["stock_id", "quantity", "price", "weight", "close_price", "volume", "strategy", "type"]]\
809	                .sort_values('stock_id').set_index('stock_id')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/utils.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	        with open(resource_path, encoding='utf-8') as file:
22	            return file.read()
23	    except ImportError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/utils.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	                with open(resource_path, encoding='utf-8') as file:
29	                    return file.read()
30	        except ImportError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/utils.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	            with open(resource_path, encoding='utf-8') as file:
35	                return file.read()
36	    raise ImportError("No compatible importlib.resources implementation found.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/utils.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	    # If running in a cloud function environment
66	    elif os.environ.get('FUNCTION_TARGET', None):
67	        # Set tmp directory to be /tmp for cloud functions

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/utils.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	def get_latest_version(package_name):
86	    url = f"https://pypi.org/pypi/{package_name}/json"
87	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/finlab-1.2.23-cp39-cp39-win_amd64/finlab/utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	    try:
88	        response = requests.get(url)
89	        data = response.json()

--------------------------------------------------

Code scanned:
	Total lines of code: 13844
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 42.0
		High: 115.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 155.0
		High: 2.0
Files skipped (0):
