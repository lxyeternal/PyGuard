Run started:2025-04-12 17:25:54.242954

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/__main__.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
74	                except CypherError as error:
75	                    stderr.write("%s: %s\r\n" % (error.code, error.message))
76	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/__main__.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	                        if args.keys:
79	                            stdout.write("%s\r\n" % "\t".join(metadata.get("fields", ())))
80	                        for i, record in enumerate(records):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/__main__.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	                        for i, record in enumerate(records):
81	                            stdout.write("%s\r\n" % "\t".join(map(repr, record)))
82	                        if args.summary:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/__main__.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	                            for key, value in sorted(metadata):
84	                                stdout.write("{}: {}\r\n".format(key, value))
85	                            stdout.write("\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/__main__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	                                stdout.write("{}: {}\r\n".format(key, value))
85	                            stdout.write("\r\n")
86	    finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
253	        try:
254	            self.close()
255	        except:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
261	    def __exit__(self, exc_type, exc_value, traceback):
262	        self.close()
263	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
387	        try:
388	            self._send()
389	        except self.error_handler.known_errors as error:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
387	        try:
388	            self._send()
389	        except self.error_handler.known_errors as error:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
407	        try:
408	            self.socket.sendall(data)
409	        except SocketError as error:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
477	            self._defunct = True
478	            self.close()
479	            if self.pool:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
521	        """
522	        self.send()
523	        detail_count = summary_count = 0

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
521	        """
522	        self.send()
523	        detail_count = summary_count = 0

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
539	                try:
540	                    self.send()
541	                except ServiceUnavailable:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
539	                try:
540	                    self.send()
541	                except ServiceUnavailable:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
544	            try:
545	                self.socket.close()
546	            except IOError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
576	    def __exit__(self, exc_type, exc_value, traceback):
577	        self.close()
578	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
667	                    try:
668	                        conn.close()
669	                    except IOError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
680	                try:
681	                    connection.close()
682	                except IOError:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:823
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
822	        if len(resolved_address) == 2:
823	            s = socket(AF_INET)
824	        elif len(resolved_address) == 4:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:825
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
824	        elif len(resolved_address) == 4:
825	            s = socket(AF_INET6)
826	        else:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
828	        t = s.gettimeout()
829	        s.settimeout(config.get("connection_timeout", DEFAULT_CONNECTION_TIMEOUT))
830	        log_debug("[#0000]  C: <OPEN> %s", resolved_address)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
830	        log_debug("[#0000]  C: <OPEN> %s", resolved_address)
831	        s.connect(resolved_address)
832	        s.settimeout(t)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
831	        s.connect(resolved_address)
832	        s.settimeout(t)
833	        s.setsockopt(SOL_SOCKET, SO_KEEPALIVE, 1 if config.get("keep_alive", DEFAULT_KEEP_ALIVE) else 0)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
836	        log_debug("[#0000]  C: <CLOSE> %s", resolved_address)
837	        s.close()
838	        raise ServiceUnavailable("Timed out trying to establish connection to {!r}".format(resolved_address))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
841	        log_debug("[#0000]  C: <CLOSE> %s", resolved_address)
842	        s.close()
843	        raise ServiceUnavailable("Failed to establish connection to {!r} (reason {})".format(resolved_address, error))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
855	        except SSLError as cause:
856	            s.close()
857	            error = SecurityError("Failed to establish secure connection to {!r}".format(cause.args[1]))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
863	            if der_encoded_server_certificate is None:
864	                s.close()
865	                raise ProtocolError("When using a secure socket, the server should always "

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
870	                if not store.match_or_trust(host, der_encoded_server_certificate):
871	                    s.close()
872	                    raise ProtocolError("Server certificate does not match known certificate "

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
892	    data = b"".join(struct_pack(">I", num) for num in handshake)
893	    s.sendall(data)
894	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
899	    try:
900	        data = s.recv(4)
901	    except (IOError, OSError):  # TODO 2.0: remove IOError alias

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
907	        log_debug("[#%04X]  S: <CLOSE>", local_port)
908	        s.close()
909	        raise ServiceUnavailable("Connection to %r closed without handshake response" % (resolved_address,))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
912	        log_debug("[#%04X]  S: @*#!", local_port)
913	        s.close()
914	        raise ProtocolError("Expected four byte Bolt handshake response from %r, received %r instead; "

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
920	        s.shutdown(SHUT_RDWR)
921	        s.close()
922	    elif agreed_version in (1, 2):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:936
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
935	        log_debug("[#%04X]  S: <CLOSE>", local_port)
936	        s.close()
937	        raise ServiceUnavailable("Cannot to connect to Bolt service on {!r} "

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:941
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
940	        log_debug("[#%04X]  S: <CLOSE>", local_port)
941	        s.close()
942	        raise ProtocolError("Unknown Bolt protocol version: {}".format(agreed_version))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/direct.py:962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
961	            host = address[0]
962	            s = _connect(resolved_address, **config)
963	            s, der_encoded_server_certificate = _secure(s, host, security_plan.ssl_context, **config)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/security.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
136	    def match_or_trust(self, host, der_encoded_certificate):
137	        base64_encoded_certificate = b64encode(der_encoded_certificate)
138	        if isfile(self.path):

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/security.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
136	    def match_or_trust(self, host, der_encoded_certificate):
137	        base64_encoded_certificate = b64encode(der_encoded_certificate)
138	        if isfile(self.path):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/security.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
151	        if isinstance(host, bytes):
152	            os_write(f_out, host)
153	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/security.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	        else:
154	            os_write(f_out, host.encode("utf-8"))
155	        os_write(f_out, b":")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/security.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
154	            os_write(f_out, host.encode("utf-8"))
155	        os_write(f_out, b":")
156	        os_write(f_out, base64_encoded_certificate)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/security.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	        os_write(f_out, b":")
156	        os_write(f_out, base64_encoded_certificate)
157	        os_write(f_out, b"\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/neobolt/security.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	        os_write(f_out, base64_encoded_certificate)
157	        os_write(f_out, b"\n")
158	        os_close(f_out)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/setup.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	    "license": "Apache License, Version 2.0",
74	    "long_description": open(path_join(dirname(__file__), "README.rst")).read(),
75	    "author": "Neo4j Sweden AB",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/neobolt-1.7.17/neobolt-1.7.17/setup.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	    "keywords": "neo4j graph database",
78	    "url": "https://github.com/neo4j-drivers/neobolt",
79	    "install_requires": install_requires,
80	    "classifiers": classifiers,
81	    "packages": packages,
82	    "ext_modules": ext_modules,
83	}
84	
85	try:
86	    setup(**setup_args)
87	except SystemExit:
88	    print("Compilation failed, falling back to pure Python.")
89	    del setup_args["ext_modules"]
90	    setup(**setup_args)

--------------------------------------------------

Code scanned:
	Total lines of code: 2501
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 42.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 3.0
Files skipped (0):
