Run started:2025-04-12 13:48:57.495675

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/changeset/databases/sqlite.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    def _not_supported(self, op):
27	        raise exceptions.NotSupportedError("SQLite does not support "
28	            "%s; see http://www.sqlite.org/lang_altertable.html" % op)
29	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/fixture/pathed.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
70	            if os.path.isdir(path):
71	                shutil.rmtree(path)
72	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	        # test deprecated upgrade/downgrade with no arguments
62	        contents = open(script_path, 'r').read()
63	        f = open(script_path, 'w')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	        f = open(script_path, 'w')
64	        f.write(contents.replace("upgrade(migrate_engine)", "upgrade()"))
65	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	        f = open(path,'w')
90	        f.write("def fail")
91	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	        f = open(path, 'w')
102	        f.write("def zergling():\n\tprint('rush')")
103	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
128	        '''
129	        f.write(content)
130	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228	        f = open(path, 'w')
229	        f.write(contents)
230	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
240	        f = open(src, 'w')
241	        f.write("""foobar""")
242	        f.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
255	        # populate python script
256	        contents = open(script_path, 'r').read()
257	        contents = contents.replace("pass", "tmp_sql_table.create(migrate_engine)")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
259	        f = open(script_path, 'w')
260	        f.write(contents)
261	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
266	        f = open(src, 'w')
267	        f.write(pyscript.preview_sql(self.url, 1))
268	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_script.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
301	            with open(src, 'wt') as f:
302	                f.write(script)
303	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	        filename = '%s/versions/001_Desc.py' % self.path_repos
180	        source = open(filename).read()
181	        self.assertTrue(source.find('def upgrade') >= 0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
195	        fd = open(filename)
196	        result = fd.read()
197	        self.assertTrue(result.strip() == source.strip())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
336	
337	        open('%s/versions/001_postgres_upgrade.sql' % repos_path, 'a').write(upgrade_script)
338	        open('%s/versions/001_postgres_downgrade.sql' % repos_path, 'a').write(downgrade_script)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
336	
337	        open('%s/versions/001_postgres_upgrade.sql' % repos_path, 'a').write(upgrade_script)
338	        open('%s/versions/001_postgres_downgrade.sql' % repos_path, 'a').write(downgrade_script)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
337	        open('%s/versions/001_postgres_upgrade.sql' % repos_path, 'a').write(upgrade_script)
338	        open('%s/versions/001_postgres_downgrade.sql' % repos_path, 'a').write(downgrade_script)
339	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
337	        open('%s/versions/001_postgres_upgrade.sql' % repos_path, 'a').write(upgrade_script)
338	        open('%s/versions/001_postgres_downgrade.sql' % repos_path, 'a').write(downgrade_script)
339	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
413	        file = open(script_path, 'w')
414	        file.write(script_text)
415	        file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
413	        file = open(script_path, 'w')
414	        file.write(script_text)
415	        file.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
445	        file = open(script_path, 'w')
446	        file.write(script_text)
447	        file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_shell.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
445	        file = open(script_path, 'w')
446	        file.write(script_text)
447	        file.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	        # edit templates
50	        f = open(manage_tmpl_file, 'w').write(MANAGE_CONTENTS)
51	        f = open(repository_tmpl_file, 'w').write(README_CONTENTS)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	        f = open(manage_tmpl_file, 'w').write(MANAGE_CONTENTS)
51	        f = open(repository_tmpl_file, 'w').write(README_CONTENTS)
52	        f = open(script_tmpl_file, 'w').write(SCRIPT_FILE_CONTENTS)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	        f = open(repository_tmpl_file, 'w').write(README_CONTENTS)
52	        f = open(script_tmpl_file, 'w').write(SCRIPT_FILE_CONTENTS)
53	        f = open(sql_script_tmpl_file, 'w').write(SCRIPT_FILE_CONTENTS)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	        f = open(script_tmpl_file, 'w').write(SCRIPT_FILE_CONTENTS)
53	        f = open(sql_script_tmpl_file, 'w').write(SCRIPT_FILE_CONTENTS)
54	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	        # assert changes
65	        self.assertEqual(open(new_manage_dest).read(), MANAGE_CONTENTS)
66	        self.assertEqual(open(os.path.join(new_repo_dest, 'manage.py')).read(), MANAGE_CONTENTS)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	        self.assertEqual(open(new_manage_dest).read(), MANAGE_CONTENTS)
66	        self.assertEqual(open(os.path.join(new_repo_dest, 'manage.py')).read(), MANAGE_CONTENTS)
67	        self.assertEqual(open(os.path.join(new_repo_dest, 'README')).read(), README_CONTENTS)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	        self.assertEqual(open(os.path.join(new_repo_dest, 'manage.py')).read(), MANAGE_CONTENTS)
67	        self.assertEqual(open(os.path.join(new_repo_dest, 'README')).read(), README_CONTENTS)
68	        self.assertEqual(open(os.path.join(new_repo_dest, 'versions/001_test.py')).read(), SCRIPT_FILE_CONTENTS)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	        self.assertEqual(open(os.path.join(new_repo_dest, 'README')).read(), README_CONTENTS)
68	        self.assertEqual(open(os.path.join(new_repo_dest, 'versions/001_test.py')).read(), SCRIPT_FILE_CONTENTS)
69	        self.assertEqual(open(os.path.join(new_repo_dest, 'versions/002_foo_postgres_downgrade.sql')).read(), SCRIPT_FILE_CONTENTS)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	        self.assertEqual(open(os.path.join(new_repo_dest, 'versions/001_test.py')).read(), SCRIPT_FILE_CONTENTS)
69	        self.assertEqual(open(os.path.join(new_repo_dest, 'versions/002_foo_postgres_downgrade.sql')).read(), SCRIPT_FILE_CONTENTS)
70	        self.assertEqual(open(os.path.join(new_repo_dest, 'versions/002_foo_postgres_upgrade.sql')).read(), SCRIPT_FILE_CONTENTS)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_template.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
69	        self.assertEqual(open(os.path.join(new_repo_dest, 'versions/002_foo_postgres_downgrade.sql')).read(), SCRIPT_FILE_CONTENTS)
70	        self.assertEqual(open(os.path.join(new_repo_dest, 'versions/002_foo_postgres_upgrade.sql')).read(), SCRIPT_FILE_CONTENTS)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/tests/versioning/test_util.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	        f = open(model_path, 'w')
99	        f.write("class FakeFloat(int): pass")
100	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/versioning/api.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	        dest = open(dest, 'w')
165	        dest.write(ret)
166	        dest.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/versioning/migrate_repository.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
63	            origfile = '%s/__init__.py' % origdir
64	            if os.path.exists(origfile) and len(open(origfile).read()) == 0:
65	                delete_file(origfile)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/versioning/repository.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
119	
120	        tmpl = open(os.path.join(tmpl_dir, cls._config)).read()
121	        ret = TempitaTemplate(tmpl).substitute(options)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/versioning/repository.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	        fd = open(os.path.join(path, cls._config), 'w')
142	        fd.write(config_text)
143	        fd.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/versioning/repository.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
238	
239	        tmpl = open(mng_file).read()
240	        fd = open(file_, 'w')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/versioning/repository.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
240	        fd = open(file_, 'w')
241	        fd.write(TempitaTemplate(tmpl).substitute(opts))
242	        fd.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/versioning/script/py.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        f = open(src)
75	        contents = f.read()
76	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sqlalchemy_migrate-0.13.0-py2.py3-none-any/migrate/versioning/script/py.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	        args['engine_arg_strategy'] = 'mock'
112	        args['engine_arg_executor'] = lambda s, p = '': buf.write(str(s) + p)
113	

--------------------------------------------------

Code scanned:
	Total lines of code: 6866
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 41.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 42.0
		High: 0.0
Files skipped (0):
