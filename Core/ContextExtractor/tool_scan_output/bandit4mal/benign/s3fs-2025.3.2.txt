Run started:2025-04-12 17:55:51.551906

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
350	                raise RuntimeError("please await ``.set_session`` before anything else")
351	            self.connect()
352	        return self._s3

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
601	            # close the actual socket
602	            s3._client._endpoint.http_session._connector._close()
603	        except AttributeError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1155	            try:
1156	                return await resp["Body"].read()
1157	            finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1157	            finally:
1158	                resp["Body"].close()
1159	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1264	            if size < min(5 * 2**30, 2 * chunksize):
1265	                chunk = f0.read()
1266	                await self._call_s3(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1333	            for i in range(max_concurrency):
1334	                chunk = f0.read(chunksize)
1335	                if chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1378	                    try:
1379	                        chunk = await body.read(2**16)
1380	                    except S3_RETRYABLE_ERRORS:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1386	                        try:
1387	                            body.close()
1388	                        except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1404	                    bytes_read += len(chunk)
1405	                    segment_len = f0.write(chunk)
1406	                    callback.relative_update(segment_len)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1408	            try:
1409	                body.close()
1410	            except Exception:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:1764
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1763	            await asyncio.gather(
1764	                *[self._chmod(p, acl, recursive=False) for p in allfiles]
1765	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:2299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2298	                # existing file too small for multi-upload: download
2299	                self.write(self.fs.cat(self.path))
2300	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:2445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2444	                while n_bytes_left() >= min_chunk:
2445	                    upload_part(self.buffer.read(self.blocksize))
2446	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:2448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2447	                while n_bytes_left() >= min_chunk:
2448	                    upload_part(self.buffer.read(self.part_max))
2449	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:2456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2455	            # create new smaller buffer, seek to file end
2456	            self.buffer = io.BytesIO(self.buffer.read())
2457	            self.buffer.seek(0, 2)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:2472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2471	                self.buffer.seek(0)
2472	                data = self.buffer.read()
2473	                kw = dict(Key=self.key, Bucket=self.bucket, Body=data, **self.kwargs)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:2534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2533	            self.r = r["Body"]
2534	        out = await self.r.read(length)
2535	        self.loc += len(out)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:2566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2565	        try:
2566	            return await resp["Body"].read()
2567	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/core.py:2568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2567	        finally:
2568	            resp["Body"].close()
2569	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/derived/s3fs_fixtures.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	port = 5556
15	endpoint_uri = "http://127.0.0.1:%s/" % port
16	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/derived/s3fs_fixtures.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
80	
81	        server = ThreadedMotoServer(ip_address="127.0.0.1", port=port)
82	        server.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	port = 5555
68	endpoint_uri = "http://127.0.0.1:%s/" % port
69	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
75	    # This fixture is module-scoped, meaning that we can re-use the MotoServer across all tests
76	    server = ThreadedMotoServer(ip_address="127.0.0.1", port=port)
77	    server.start()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
94	    try:
95	        requests.post(f"{endpoint_uri}/moto-api/reset")
96	    except:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	    with s3.open(a, "wb") as f:
165	        f.write(data)
166	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
167	    with s3.open(a, "rb") as f:
168	        out = f.read(len(data))
169	        assert len(data) == len(out)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
176	    with s3.open(a, "wb") as f:
177	        f.write(data)
178	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
180	        assert f.size == 100
181	        out = f.read()
182	        assert len(out) == 100

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
194	    with s3.open(a, "wb") as f:
195	        f.write(data)
196	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
198	        assert isinstance(f.cache, fsspec.core.caches[default_cache_type])
199	        out = f.read(len(data))
200	        assert len(data) == len(out)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	def test_client_kwargs():
210	    s3 = S3FileSystem(client_kwargs={"endpoint_url": "http://foo"})
211	    assert s3.s3.meta.endpoint_url.startswith("http://foo")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	    s3 = S3FileSystem(client_kwargs={"endpoint_url": "http://foo"})
211	    assert s3.s3.meta.endpoint_url.startswith("http://foo")
212	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
397	    ) as f:
398	        f.write(b"0" * (5 * 2**20 + 1))  # starts multipart and puts first part
399	        f.write(b"data")  # any extra data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
398	        f.write(b"0" * (5 * 2**20 + 1))  # starts multipart and puts first part
399	        f.write(b"data")  # any extra data
400	    assert s3.cat(path) == b"0" * (5 * 2**20 + 1) + b"data"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
420	        "Grantee": {
421	            "URI": "http://acs.amazonaws.com/groups/global/AllUsers",
422	            "Type": "Group",
423	        },
424	    }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:764
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
763	    destination = test_bucket_name + "/test.json"
764	    open(test_file, "w").write("text")
765	    s3.put(test_file, destination)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
771	    destination = os.path.join(test_bucket_name, "test.json")
772	    open(test_file, "w").write("text")
773	    s3.put(test_file, destination, ContentType="text/css")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
892	    with s3.open(a, "wb") as f:
893	        f.write(b"123")
894	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
895	    with s3.open(a) as f:
896	        assert f.read() == b"123"
897	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:907
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
906	        f.seek(0)
907	        assert f.read(1) == b"1"
908	        f.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
908	        f.seek(0)
909	        assert f.read(1) == b"1"
910	        f.seek(3)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
910	        f.seek(3)
911	        assert f.read(1) == b""
912	        f.seek(-1, 2)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
912	        f.seek(-1, 2)
913	        assert f.read(1) == b"3"
914	        f.seek(-1, 1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:916
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
915	        f.seek(-1, 1)
916	        assert f.read(1) == b"2"
917	        for i in range(4):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:936
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
935	    with s3.open(fn, "wb") as f:
936	        f.write(data)
937	    sync(s3.loop, s3._copy_managed, fn, fn + "2", size=len(data), block=5 * 2**20)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
956	
957	    s3.get(test_bucket_name + "/test/accounts.1.json", test_file)
958	    data = files["test/accounts.1.json"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
958	    data = files["test/accounts.1.json"]
959	    assert open(test_file, "rb").read() == data
960	    s3.put(test_file, test_bucket_name + "/temp")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
969	    data = b"1234567890A" * 2**20
970	    open(test_file, "wb").write(data)
971	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
973	    test_file = str(tmpdir.join("test2"))
974	    s3.get(test_bucket_name + "/bigfile", test_file)
975	    assert open(test_file, "rb").read() == data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
974	    s3.get(test_bucket_name + "/bigfile", test_file)
975	    assert open(test_file, "rb").read() == data
976	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
985	    cb = BranchingCallback()
986	    s3.get(test_bucket_name + "/test/accounts.1.json", test_file, callback=cb)
987	    assert cb.size == 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1018
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1017	    with open(test_file, "wb") as f:
1018	        f.write(b"1234567890A" * size)
1019	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1036
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1035	    with open(test_file, "wb") as f:
1036	        f.write(block * factor)
1037	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1074
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1073	        with s3.open(test_bucket_name + "/temp", "wb") as f:
1074	            f.read()
1075	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1078	        f.close()
1079	        f.read()
1080	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1115	        while True:
1116	            data = f.read(3)
1117	            if data == b"":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1144	    with s3.open("new/temp", "wb") as f:
1145	        f.write(b"hello")
1146	    with pytest.raises(OSError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1184	    with s3.open(test_bucket_name + "/test", "wb") as f:
1185	        f.write(b"hello")
1186	    assert s3.cat(test_bucket_name + "/test") == b"hello"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1197	        "Grantee": {
1198	            "URI": "http://acs.amazonaws.com/groups/global/AllUsers",
1199	            "Type": "Group",
1200	        },
1201	    }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1203	    with s3.open(filename, "wb", acl="public-read") as f:
1204	        f.write(body)
1205	    assert s3.cat(filename) == body

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1219	    with s3.open(test_bucket_name + "/test", "wb") as fd:
1220	        fd.write(payload)
1221	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1233	    with s3.open(test_bucket_name + "/test", "wb", blocksize=block_size) as fd:
1234	        fd.write(payload)
1235	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1247	    with s3.open("mybucket/test", "wb") as f:
1248	        f.write(b"hello")
1249	    assert s3.cat("mybucket/test") == b"hello"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1261	    with s3.open("mybucket/myfile", "wb") as f:
1262	        f.write(b"hello hello" * 10**6)
1263	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1269	        s3.touch(test_bucket_name + "/temp")
1270	        s3.open(test_bucket_name + "/temp", "rb").write(b"hello")
1271	    with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1275	    with pytest.raises(ValueError):
1276	        f.write(b"hello")
1277	    with pytest.raises(FileNotFoundError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1282	    with s3.open(test_bucket_name + "/temp", "wb", block_size=5 * 2**20) as f:
1283	        f.write(b"a" * 2 * 2**20)
1284	        assert f.buffer.tell() == 2 * 2**20

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1288	        assert not (f.parts)
1289	        f.write(b"a" * 2 * 2**20)
1290	        f.write(b"a" * 2 * 2**20)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1289	        f.write(b"a" * 2 * 2**20)
1290	        f.write(b"a" * 2 * 2**20)
1291	        assert f.mpu

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1294	    with s3.open(test_bucket_name + "/temp2", "wb", block_size=10 * 2**20) as f:
1295	        f.write(b"a" * 15 * 2**20)
1296	        assert f.buffer.tell() == 0

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1313	    with s3.open(a, "wb") as f:
1314	        f.write(data)
1315	    with s3.open(a, "rb") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1322	    with s3.open(a, "wb") as f:
1323	        f.write(data)
1324	    with s3.open(a, "rb") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1347	    with s3.open(a, "wb") as f:
1348	        f.write(data)
1349	    with s3.open(a) as f, io.BytesIO(data) as g:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1391	    with s3.open(a, "wb") as f:
1392	        f.write(b"a" * 10 * 2**20)
1393	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1394	    with s3.open(b, "wb") as f:
1395	        f.write(b"a" * 10 * 2**20)
1396	    s3.merge(test_bucket_name + "/joined", [a, b])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1405	    with s3.open(test_bucket_name + "/nested/file1", "ab") as f:
1406	        f.write(b"extra")  # append, write, small file
1407	    assert s3.cat(test_bucket_name + "/nested/file1") == data + b"extra"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1409	    with s3.open(a, "wb") as f:
1410	        f.write(b"a" * 10 * 2**20)
1411	    with s3.open(a, "ab") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1420	        assert f.tell() == 10 * 2**20
1421	        f.write(b"extra")  # append, small write, big file
1422	    data = s3.cat(a)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1427	        assert f.tell() == 10 * 2**20 + 5
1428	        f.write(b"b" * 10 * 2**20)  # append, big write, big file
1429	        assert f.tell() == 20 * 2**20 + 5

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1445	        StorageClass="REDUCED_REDUNDANCY",
1446	        WebsiteRedirectLocation="https://www.example.com/",
1447	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1448	    with s3.open(a, "wb", **head) as f:
1449	        f.write(b"data")
1450	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1451	    with s3.open(a, "ab") as f:
1452	        f.write(b"other")
1453	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1468	        while True:
1469	            data = f.read(20)
1470	            out.append(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1488	    with s3.open(a, "wb") as f:
1489	        f.write(data)
1490	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1491	    with s3.open(a, "rb") as f:
1492	        out = f.read()
1493	        assert out == b"A" * 1000

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1516	    ctx = mp.get_context(method)
1517	    executor = ProcessPoolExecutor(mp_context=ctx)
1518	    conn_id = executor.submit(_get_s3_id, s3).result()

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1537	
1538	    s3.chmod(test_bucket_name, acl="public-read")
1539	    s3.chmod(other_bucket_name, acl="private")

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1538	    s3.chmod(test_bucket_name, acl="public-read")
1539	    s3.chmod(other_bucket_name, acl="private")
1540	    with pytest.raises(PermissionError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1545	    with s3.open(other_bucket_name + "/see_me", "wb", acl="public-read") as f:
1546	        f.write(b"hello")
1547	    assert s.cat(other_bucket_name + "/see_me") == b"hello"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1553	    with s3.open(path, "wb") as f:
1554	        f.write(b"a" * (10 * 2**20))
1555	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1556	    with s3.open(path, "ab") as f:
1557	        f.write(b"b" * (10 * 2**20))
1558	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1566	        data = b"b" * blocksize
1567	        s3f.write(data)
1568	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1611	    with s3.open(versioned_file, "wb") as fo:
1612	        fo.write(b"1")
1613	    first_version = fo.version_id

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1615	    with s3.open(versioned_file, "wb") as fo:
1616	        fo.write(b"2")
1617	    second_version = fo.version_id

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1628	        assert fo.version_id == second_version
1629	        assert fo.read() == b"2"
1630	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1632	        assert fo.version_id == first_version
1633	        assert fo.read() == b"1"
1634	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1655	        with s3.open(versioned_file, "wb") as fo:
1656	            fo.write(b"1")
1657	    versions = s3.object_version_info(versioned_file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1670	        with s3.open(versioned_file, "wb") as fo:
1671	            fo.write(contents)
1672	        version_lookup[fo.version_id] = contents

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1683	        with fs.open(path, "rb") as fo:
1684	            contents = fo.read()
1685	            assert contents == version_lookup[fo.version_id]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1693	    with s3.open(versioned_file, "wb") as fo:
1694	        fo.write(b"1")
1695	    # moto doesn't correctly return a versionId for a multipart upload. So we resort to this.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1701	    with s3.open(versioned_file, "wb") as fo:
1702	        fo.write(b"2")
1703	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1707	        assert fo.version_id == version_id
1708	        assert fo.read() == b"1"
1709	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1722	    with s3.open(versioned_file, "wb") as fo:
1723	        fo.write(b"1")
1724	    with s3.open(versioned_file, "wb") as fo:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1724	    with s3.open(versioned_file, "wb") as fo:
1725	        fo.write(b"2")
1726	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1728	        assert fo.version_id is None
1729	        assert fo.read() == b"2"
1730	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1732	        with s3.open(versioned_file, version_id="0"):
1733	            fo.read()
1734	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1741	    with s3.open(versioned_file, "wb") as fo:
1742	        fo.write(b"1")
1743	    first_version = fo.version_id

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1744	    with s3.open(versioned_file, "wb") as fo:
1745	        fo.write(b"2")
1746	    second_version = fo.version_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1749	
1750	    assert cached.get("VersionId") == second_version
1751	    assert s3.info(versioned_file) == cached

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1753	    assert (
1754	        s3.info(versioned_file, version_id=first_version).get("VersionId")
1755	        == first_version

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1757	    assert (
1758	        s3.info(versioned_file, version_id=second_version).get("VersionId")
1759	        == second_version

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1767	    with s3.open("bucket/file.txt", "wb") as fd:
1768	        fd.write("\u00af\\_(\u30c4)_/\u00af".encode("utf-16-le"))
1769	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1779	    with s3.open("bucket/file.txt", "w", encoding="utf-8") as fd:
1780	        fd.write("\u00af\\_(\u30c4)_/\u00af")
1781	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1782	    with s3.open("bucket/file.txt", "r", encoding="utf-8") as fd:
1783	        assert fd.read() == "\u00af\\_(\u30c4)_/\u00af"
1784	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1790	    with s3.open("bucket/file.txt", "w", encoding="ibm500") as fd:
1791	        fd.write("Hello, World!")
1792	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1793	    with s3.open("bucket/file.txt", "r", encoding="ibm500") as fd:
1794	        assert fd.read() == "Hello, World!"
1795	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1800	    with s3.open("bucket/file.txt", "wb") as fd:
1801	        fd.write(b"Hello, World!")
1802	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1863
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1862	        with s3.open(path, "wb", autocommit=autocommit) as fo:
1863	            fo.write(b"1")
1864	        return fo

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1889	    with s3.open(path, "wb", autocommit=False) as fo:
1890	        fo.write(b"1")
1891	    assert fo.mpu is not None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1904	    with s3.open(fn, "wb") as f:
1905	        f.write(b"data")
1906	    assert s3.size(fn) == 4

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1911	    with s3.open(fn, "wb") as f:
1912	        f.write(b"data")
1913	    assert s3.size(fn) == 4

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1925	    with s3.open(versioned_file, "wb") as fo:
1926	        fo.write(b"1")
1927	    first_version = fo.version_id

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1928	    with s3.open(versioned_file, "wb") as fo:
1929	        fo.write(b"")
1930	    second_version = fo.version_id

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1941	        assert fo.version_id == second_version
1942	        assert fo.read() == b""
1943	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1945	        assert fo.version_id == first_version
1946	        assert fo.read() == b"1"
1947	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1969	    # Target directory with trailing slash
1970	    s3.get(test_bucket_name + "/dir/", d, recursive=True)
1971	    assert {"dirkey", "dir"} == set(os.listdir(d))

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1974	
1975	    local_fs = fsspec.filesystem("file")
1976	    local_fs.rm(os.path.join(d, "dir"), recursive=True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1979	    # Target directory without trailing slash
1980	    s3.get(test_bucket_name + "/dir", d, recursive=True)
1981	    assert ["dir"] == os.listdir(d)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1988	    with s3.open(fn, "wb") as f:
1989	        f.write(b"a" * 175627146)
1990	    with s3.open(fn, "rb", blocksize=100) as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1991	        f.seek(175561610)
1992	        d1 = f.read(65536)
1993	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:1996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1995	        size = 17562198
1996	        d2 = f.read(size)
1997	        assert len(d2) == size

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2000	        size = 17562187
2001	        d3 = f.read(size)
2002	        assert len(d3) == size

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
2011	
2012	    pool = ThreadPool(processes=20)
2013	    out = pool.map(task, range(40))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2168	    ) as f:
2169	        f.write(b"hello")
2170	    with fsspec.open(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2172	    ) as f:
2173	        assert f.read() == b"hello"
2174	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2264	    os.mkdir(fn)
2265	    open(os.path.join(fn, "abc"), "w").write("text")
2266	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2337	            with gzip.GzipFile(fileobj=f) as zfp:
2338	                zfp.read()
2339	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2401	    with s3.open(test_file, "rb") as f:
2402	        content = f.read()
2403	        assert content == content1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2407	        with expect_errno(errno.EBUSY):
2408	            f.read()
2409	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2420	        for _ in range(5):
2421	            stream.write(b"b" * (stream.blocksize + random.randrange(200)))
2422	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2534	
2535	    assert s3.info(file["name"]).get("ETag", None) is None
2536	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2582	    for f in files:
2583	        open(f, "w").write("hello")
2584	    s3.put(folders[0], "newbucket", recursive=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2603	    f = s3.open(path, "wb")
2604	    f.write(b"0" * 6 * 2**20)
2605	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2672	    target = os.path.join(tmpdir, "target")
2673	    target_fs = fsspec.filesystem("file")
2674	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2677	    for loop in range(2):
2678	        s3.get(src, target, recursive=True)
2679	        assert target_fs.isdir(target)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2693	    for loop in range(2):
2694	        s3.get(src + "/", target, recursive=True)
2695	        assert target_fs.isdir(target)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2701	    src_file = os.path.join(src, "file")
2702	    source_fs = fsspec.filesystem("file")
2703	    source_fs.mkdir(src)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2764
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2763	        while True:
2764	            got = await f.read(1000)
2765	            assert f.size == len(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2838	    with s3_fixed_upload_size.open(a, "wb", block_size=6_000_000) as f:
2839	        f.write(b" " * 6_001_000)
2840	        assert len(f.buffer.getbuffer()) == 1000

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2845	        assert f.offset == 6_000_000
2846	        f.write(b" " * 6_001_000)
2847	        assert len(f.buffer.getbuffer()) == 2000

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2851	    with s3_fixed_upload_size.open(a, "r") as f:
2852	        assert len(f.read()) == 6_001_000 * 2
2853	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2858	    with s3_fixed_upload_size.open(a, "wb", block_size=block) as f:
2859	        f.write(b" " * (block + pad1))
2860	        assert len(f.buffer.getbuffer()) == pad1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2863	        assert f.offset == block
2864	        f.write(b" " * (block + pad2))
2865	        assert len(f.buffer.getbuffer()) == pad1 + pad2

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2869	    with s3_fixed_upload_size.open(a, "r") as f:
2870	        assert len(f.read()) == 2 * block + pad1 + pad2
2871	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/s3fs/tests/test_s3fs.py:2908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2907	    with open(fn, "wb") as f:
2908	        f.write(fn)
2909	    s3.put(fn, f"{test_bucket_name}/afile", data, mode="overwrite", chunksize=chunksize)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	    description="Convenient Filesystem interface over S3",
30	    url="http://github.com/fsspec/s3fs/",
31	    maintainer="Martin Durant",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
518	    "git"
519	] = r'''
520	# This file helps to compute a version number in source trees obtained from
521	# git-archive tarball (such as those provided by githubs download-from-tag
522	# feature). Distribution tarballs (built by setup.py sdist) and build
523	# directories (produced by setup.py build) will contain a much shorter file
524	# that just contains the computed version number.
525	
526	# This file is released into the public domain.
527	# Generated by versioneer-0.29
528	# https://github.com/python-versioneer/python-versioneer
529	
530	"""Git implementation of _version.py."""
531	
532	import errno
533	import os
534	import re
535	import subprocess
536	import sys
537	from typing import Any, Callable, Dict, List, Optional, Tuple
538	import functools
539	
540	
541	def get_keywords() -> Dict[str, str]:
542	    """Get the keywords needed to look up the version information."""
543	    # these strings will be replaced by git during git-archive.
544	    # setup.py/versioneer.py will grep for the variable names, so they must
545	    # each be defined on a line of their own. _version.py will just call
546	    # get_keywords().
547	    git_refnames = "%(DOLLAR)sFormat:%%d%(DOLLAR)s"
548	    git_full = "%(DOLLAR)sFormat:%%H%(DOLLAR)s"
549	    git_date = "%(DOLLAR)sFormat:%%ci%(DOLLAR)s"
550	    keywords = {"refnames": git_refnames, "full": git_full, "date": git_date}
551	    return keywords
552	
553	
554	class VersioneerConfig:
555	    """Container for Versioneer configuration parameters."""
556	
557	    VCS: str
558	    style: str
559	    tag_prefix: str
560	    parentdir_prefix: str
561	    versionfile_source: str
562	    verbose: bool
563	
564	
565	def get_config() -> VersioneerConfig:
566	    """Create, populate and return the VersioneerConfig() object."""
567	    # these strings are filled in when 'setup.py versioneer' creates
568	    # _version.py
569	    cfg = VersioneerConfig()
570	    cfg.VCS = "git"
571	    cfg.style = "%(STYLE)s"
572	    cfg.tag_prefix = "%(TAG_PREFIX)s"
573	    cfg.parentdir_prefix = "%(PARENTDIR_PREFIX)s"
574	    cfg.versionfile_source = "%(VERSIONFILE_SOURCE)s"
575	    cfg.verbose = False
576	    return cfg
577	
578	
579	class NotThisMethod(Exception):
580	    """Exception raised if a method is not valid for the current scenario."""
581	
582	
583	LONG_VERSION_PY: Dict[str, str] = {}
584	HANDLERS: Dict[str, Dict[str, Callable]] = {}
585	
586	
587	def register_vcs_handler(vcs: str, method: str) -> Callable:  # decorator
588	    """Create decorator to mark a method as the handler of a VCS."""
589	    def decorate(f: Callable) -> Callable:
590	        """Store f in HANDLERS[vcs][method]."""
591	        if vcs not in HANDLERS:
592	            HANDLERS[vcs] = {}
593	        HANDLERS[vcs][method] = f
594	        return f
595	    return decorate
596	
597	
598	def run_command(
599	    commands: List[str],
600	    args: List[str],
601	    cwd: Optional[str] = None,
602	    verbose: bool = False,
603	    hide_stderr: bool = False,
604	    env: Optional[Dict[str, str]] = None,
605	) -> Tuple[Optional[str], Optional[int]]:
606	    """Call the given command(s)."""
607	    assert isinstance(commands, list)
608	    process = None
609	
610	    popen_kwargs: Dict[str, Any] = {}
611	    if sys.platform == "win32":
612	        # This hides the console window if pythonw.exe is used
613	        startupinfo = subprocess.STARTUPINFO()
614	        startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW
615	        popen_kwargs["startupinfo"] = startupinfo
616	
617	    for command in commands:
618	        try:
619	            dispcmd = str([command] + args)
620	            # remember shell=False, so use git.cmd on windows, not just git
621	            process = subprocess.Popen([command] + args, cwd=cwd, env=env,
622	                                       stdout=subprocess.PIPE,
623	                                       stderr=(subprocess.PIPE if hide_stderr
624	                                               else None), **popen_kwargs)
625	            break
626	        except OSError as e:
627	            if e.errno == errno.ENOENT:
628	                continue
629	            if verbose:
630	                print("unable to run %%s" %% dispcmd)
631	                print(e)
632	            return None, None
633	    else:
634	        if verbose:
635	            print("unable to find command, tried %%s" %% (commands,))
636	        return None, None
637	    stdout = process.communicate()[0].strip().decode()
638	    if process.returncode != 0:
639	        if verbose:
640	            print("unable to run %%s (error)" %% dispcmd)
641	            print("stdout was %%s" %% stdout)
642	        return None, process.returncode
643	    return stdout, process.returncode
644	
645	
646	def versions_from_parentdir(
647	    parentdir_prefix: str,
648	    root: str,
649	    verbose: bool,
650	) -> Dict[str, Any]:
651	    """Try to determine the version from the parent directory name.
652	
653	    Source tarballs conventionally unpack into a directory that includes both
654	    the project name and a version string. We will also support searching up
655	    two directory levels for an appropriately named parent directory
656	    """
657	    rootdirs = []
658	
659	    for _ in range(3):
660	        dirname = os.path.basename(root)
661	        if dirname.startswith(parentdir_prefix):
662	            return {"version": dirname[len(parentdir_prefix):],
663	                    "full-revisionid": None,
664	                    "dirty": False, "error": None, "date": None}
665	        rootdirs.append(root)
666	        root = os.path.dirname(root)  # up a level
667	
668	    if verbose:
669	        print("Tried directories %%s but none started with prefix %%s" %%
670	              (str(rootdirs), parentdir_prefix))
671	    raise NotThisMethod("rootdir doesn't start with parentdir_prefix")
672	
673	
674	@register_vcs_handler("git", "get_keywords")
675	def git_get_keywords(versionfile_abs: str) -> Dict[str, str]:
676	    """Extract version information from the given file."""
677	    # the code embedded in _version.py can just fetch the value of these
678	    # keywords. When used from setup.py, we don't want to import _version.py,
679	    # so we do it with a regexp instead. This function is not used from
680	    # _version.py.
681	    keywords: Dict[str, str] = {}
682	    try:
683	        with open(versionfile_abs, "r") as fobj:
684	            for line in fobj:
685	                if line.strip().startswith("git_refnames ="):
686	                    mo = re.search(r'=\s*"(.*)"', line)
687	                    if mo:
688	                        keywords["refnames"] = mo.group(1)
689	                if line.strip().startswith("git_full ="):
690	                    mo = re.search(r'=\s*"(.*)"', line)
691	                    if mo:
692	                        keywords["full"] = mo.group(1)
693	                if line.strip().startswith("git_date ="):
694	                    mo = re.search(r'=\s*"(.*)"', line)
695	                    if mo:
696	                        keywords["date"] = mo.group(1)
697	    except OSError:
698	        pass
699	    return keywords
700	
701	
702	@register_vcs_handler("git", "keywords")
703	def git_versions_from_keywords(
704	    keywords: Dict[str, str],
705	    tag_prefix: str,
706	    verbose: bool,
707	) -> Dict[str, Any]:
708	    """Get version information from git keywords."""
709	    if "refnames" not in keywords:
710	        raise NotThisMethod("Short version file found")
711	    date = keywords.get("date")
712	    if date is not None:
713	        # Use only the last line.  Previous lines may contain GPG signature
714	        # information.
715	        date = date.splitlines()[-1]
716	
717	        # git-2.2.0 added "%%cI", which expands to an ISO-8601 -compliant
718	        # datestamp. However we prefer "%%ci" (which expands to an "ISO-8601
719	        # -like" string, which we must then edit to make compliant), because
720	        # it's been around since git-1.5.3, and it's too difficult to
721	        # discover which version we're using, or to work around using an
722	        # older one.
723	        date = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
724	    refnames = keywords["refnames"].strip()
725	    if refnames.startswith("$Format"):
726	        if verbose:
727	            print("keywords are unexpanded, not using")
728	        raise NotThisMethod("unexpanded keywords, not a git-archive tarball")
729	    refs = {r.strip() for r in refnames.strip("()").split(",")}
730	    # starting in git-1.8.3, tags are listed as "tag: foo-1.0" instead of
731	    # just "foo-1.0". If we see a "tag: " prefix, prefer those.
732	    TAG = "tag: "
733	    tags = {r[len(TAG):] for r in refs if r.startswith(TAG)}
734	    if not tags:
735	        # Either we're using git < 1.8.3, or there really are no tags. We use
736	        # a heuristic: assume all version tags have a digit. The old git %%d
737	        # expansion behaves like git log --decorate=short and strips out the
738	        # refs/heads/ and refs/tags/ prefixes that would let us distinguish
739	        # between branches and tags. By ignoring refnames without digits, we
740	        # filter out many common branch names like "release" and
741	        # "stabilization", as well as "HEAD" and "master".
742	        tags = {r for r in refs if re.search(r'\d', r)}
743	        if verbose:
744	            print("discarding '%%s', no digits" %% ",".join(refs - tags))
745	    if verbose:
746	        print("likely tags: %%s" %% ",".join(sorted(tags)))
747	    for ref in sorted(tags):
748	        # sorting will prefer e.g. "2.0" over "2.0rc1"
749	        if ref.startswith(tag_prefix):
750	            r = ref[len(tag_prefix):]
751	            # Filter out refs that exactly match prefix or that don't start
752	            # with a number once the prefix is stripped (mostly a concern
753	            # when prefix is '')
754	            if not re.match(r'\d', r):
755	                continue
756	            if verbose:
757	                print("picking %%s" %% r)
758	            return {"version": r,
759	                    "full-revisionid": keywords["full"].strip(),
760	                    "dirty": False, "error": None,
761	                    "date": date}
762	    # no suitable tags, so version is "0+unknown", but full hex is still there
763	    if verbose:
764	        print("no suitable tags, using unknown + full revision id")
765	    return {"version": "0+unknown",
766	            "full-revisionid": keywords["full"].strip(),
767	            "dirty": False, "error": "no suitable tags", "date": None}
768	
769	
770	@register_vcs_handler("git", "pieces_from_vcs")
771	def git_pieces_from_vcs(
772	    tag_prefix: str,
773	    root: str,
774	    verbose: bool,
775	    runner: Callable = run_command
776	) -> Dict[str, Any]:
777	    """Get version from 'git describe' in the root of the source tree.
778	
779	    This only gets called if the git-archive 'subst' keywords were *not*
780	    expanded, and _version.py hasn't already been rewritten with a short
781	    version string, meaning we're inside a checked out source tree.
782	    """
783	    GITS = ["git"]
784	    if sys.platform == "win32":
785	        GITS = ["git.cmd", "git.exe"]
786	
787	    # GIT_DIR can interfere with correct operation of Versioneer.
788	    # It may be intended to be passed to the Versioneer-versioned project,
789	    # but that should not change where we get our version from.
790	    env = os.environ.copy()
791	    env.pop("GIT_DIR", None)
792	    runner = functools.partial(runner, env=env)
793	
794	    _, rc = runner(GITS, ["rev-parse", "--git-dir"], cwd=root,
795	                   hide_stderr=not verbose)
796	    if rc != 0:
797	        if verbose:
798	            print("Directory %%s not under git control" %% root)
799	        raise NotThisMethod("'git rev-parse --git-dir' returned error")
800	
801	    # if there is a tag matching tag_prefix, this yields TAG-NUM-gHEX[-dirty]
802	    # if there isn't one, this yields HEX[-dirty] (no NUM)
803	    describe_out, rc = runner(GITS, [
804	        "describe", "--tags", "--dirty", "--always", "--long",
805	        "--match", f"{tag_prefix}[[:digit:]]*"
806	    ], cwd=root)
807	    # --long was added in git-1.5.5
808	    if describe_out is None:
809	        raise NotThisMethod("'git describe' failed")
810	    describe_out = describe_out.strip()
811	    full_out, rc = runner(GITS, ["rev-parse", "HEAD"], cwd=root)
812	    if full_out is None:
813	        raise NotThisMethod("'git rev-parse' failed")
814	    full_out = full_out.strip()
815	
816	    pieces: Dict[str, Any] = {}
817	    pieces["long"] = full_out
818	    pieces["short"] = full_out[:7]  # maybe improved later
819	    pieces["error"] = None
820	
821	    branch_name, rc = runner(GITS, ["rev-parse", "--abbrev-ref", "HEAD"],
822	                             cwd=root)
823	    # --abbrev-ref was added in git-1.6.3
824	    if rc != 0 or branch_name is None:
825	        raise NotThisMethod("'git rev-parse --abbrev-ref' returned error")
826	    branch_name = branch_name.strip()
827	
828	    if branch_name == "HEAD":
829	        # If we aren't exactly on a branch, pick a branch which represents
830	        # the current commit. If all else fails, we are on a branchless
831	        # commit.
832	        branches, rc = runner(GITS, ["branch", "--contains"], cwd=root)
833	        # --contains was added in git-1.5.4
834	        if rc != 0 or branches is None:
835	            raise NotThisMethod("'git branch --contains' returned error")
836	        branches = branches.split("\n")
837	
838	        # Remove the first line if we're running detached
839	        if "(" in branches[0]:
840	            branches.pop(0)
841	
842	        # Strip off the leading "* " from the list of branches.
843	        branches = [branch[2:] for branch in branches]
844	        if "master" in branches:
845	            branch_name = "master"
846	        elif not branches:
847	            branch_name = None
848	        else:
849	            # Pick the first branch that is returned. Good or bad.
850	            branch_name = branches[0]
851	
852	    pieces["branch"] = branch_name
853	
854	    # parse describe_out. It will be like TAG-NUM-gHEX[-dirty] or HEX[-dirty]
855	    # TAG might have hyphens.
856	    git_describe = describe_out
857	
858	    # look for -dirty suffix
859	    dirty = git_describe.endswith("-dirty")
860	    pieces["dirty"] = dirty
861	    if dirty:
862	        git_describe = git_describe[:git_describe.rindex("-dirty")]
863	
864	    # now we have TAG-NUM-gHEX or HEX
865	
866	    if "-" in git_describe:
867	        # TAG-NUM-gHEX
868	        mo = re.search(r'^(.+)-(\d+)-g([0-9a-f]+)$', git_describe)
869	        if not mo:
870	            # unparsable. Maybe git-describe is misbehaving?
871	            pieces["error"] = ("unable to parse git-describe output: '%%s'"
872	                               %% describe_out)
873	            return pieces
874	
875	        # tag
876	        full_tag = mo.group(1)
877	        if not full_tag.startswith(tag_prefix):
878	            if verbose:
879	                fmt = "tag '%%s' doesn't start with prefix '%%s'"
880	                print(fmt %% (full_tag, tag_prefix))
881	            pieces["error"] = ("tag '%%s' doesn't start with prefix '%%s'"
882	                               %% (full_tag, tag_prefix))
883	            return pieces
884	        pieces["closest-tag"] = full_tag[len(tag_prefix):]
885	
886	        # distance: number of commits since tag
887	        pieces["distance"] = int(mo.group(2))
888	
889	        # commit: short hex revision ID
890	        pieces["short"] = mo.group(3)
891	
892	    else:
893	        # HEX: no tags
894	        pieces["closest-tag"] = None
895	        out, rc = runner(GITS, ["rev-list", "HEAD", "--left-right"], cwd=root)
896	        pieces["distance"] = len(out.split())  # total number of commits
897	
898	    # commit date: see ISO-8601 comment in git_versions_from_keywords()
899	    date = runner(GITS, ["show", "-s", "--format=%%ci", "HEAD"], cwd=root)[0].strip()
900	    # Use only the last line.  Previous lines may contain GPG signature
901	    # information.
902	    date = date.splitlines()[-1]
903	    pieces["date"] = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
904	
905	    return pieces
906	
907	
908	def plus_or_dot(pieces: Dict[str, Any]) -> str:
909	    """Return a + if we don't already have one, else return a ."""
910	    if "+" in pieces.get("closest-tag", ""):
911	        return "."
912	    return "+"
913	
914	
915	def render_pep440(pieces: Dict[str, Any]) -> str:
916	    """Build up version string, with post-release "local version identifier".
917	
918	    Our goal: TAG[+DISTANCE.gHEX[.dirty]] . Note that if you
919	    get a tagged build and then dirty it, you'll get TAG+0.gHEX.dirty
920	
921	    Exceptions:
922	    1: no tags. git_describe was just HEX. 0+untagged.DISTANCE.gHEX[.dirty]
923	    """
924	    if pieces["closest-tag"]:
925	        rendered = pieces["closest-tag"]
926	        if pieces["distance"] or pieces["dirty"]:
927	            rendered += plus_or_dot(pieces)
928	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
929	            if pieces["dirty"]:
930	                rendered += ".dirty"
931	    else:
932	        # exception #1
933	        rendered = "0+untagged.%%d.g%%s" %% (pieces["distance"],
934	                                          pieces["short"])
935	        if pieces["dirty"]:
936	            rendered += ".dirty"
937	    return rendered
938	
939	
940	def render_pep440_branch(pieces: Dict[str, Any]) -> str:
941	    """TAG[[.dev0]+DISTANCE.gHEX[.dirty]] .
942	
943	    The ".dev0" means not master branch. Note that .dev0 sorts backwards
944	    (a feature branch will appear "older" than the master branch).
945	
946	    Exceptions:
947	    1: no tags. 0[.dev0]+untagged.DISTANCE.gHEX[.dirty]
948	    """
949	    if pieces["closest-tag"]:
950	        rendered = pieces["closest-tag"]
951	        if pieces["distance"] or pieces["dirty"]:
952	            if pieces["branch"] != "master":
953	                rendered += ".dev0"
954	            rendered += plus_or_dot(pieces)
955	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
956	            if pieces["dirty"]:
957	                rendered += ".dirty"
958	    else:
959	        # exception #1
960	        rendered = "0"
961	        if pieces["branch"] != "master":
962	            rendered += ".dev0"
963	        rendered += "+untagged.%%d.g%%s" %% (pieces["distance"],
964	                                          pieces["short"])
965	        if pieces["dirty"]:
966	            rendered += ".dirty"
967	    return rendered
968	
969	
970	def pep440_split_post(ver: str) -> Tuple[str, Optional[int]]:
971	    """Split pep440 version string at the post-release segment.
972	
973	    Returns the release segments before the post-release and the
974	    post-release version number (or -1 if no post-release segment is present).
975	    """
976	    vc = str.split(ver, ".post")
977	    return vc[0], int(vc[1] or 0) if len(vc) == 2 else None
978	
979	
980	def render_pep440_pre(pieces: Dict[str, Any]) -> str:
981	    """TAG[.postN.devDISTANCE] -- No -dirty.
982	
983	    Exceptions:
984	    1: no tags. 0.post0.devDISTANCE
985	    """
986	    if pieces["closest-tag"]:
987	        if pieces["distance"]:
988	            # update the post release segment
989	            tag_version, post_version = pep440_split_post(pieces["closest-tag"])
990	            rendered = tag_version
991	            if post_version is not None:
992	                rendered += ".post%%d.dev%%d" %% (post_version + 1, pieces["distance"])
993	            else:
994	                rendered += ".post0.dev%%d" %% (pieces["distance"])
995	        else:
996	            # no commits, use the tag as the version
997	            rendered = pieces["closest-tag"]
998	    else:
999	        # exception #1
1000	        rendered = "0.post0.dev%%d" %% pieces["distance"]
1001	    return rendered
1002	
1003	
1004	def render_pep440_post(pieces: Dict[str, Any]) -> str:
1005	    """TAG[.postDISTANCE[.dev0]+gHEX] .
1006	
1007	    The ".dev0" means dirty. Note that .dev0 sorts backwards
1008	    (a dirty tree will appear "older" than the corresponding clean one),
1009	    but you shouldn't be releasing software with -dirty anyways.
1010	
1011	    Exceptions:
1012	    1: no tags. 0.postDISTANCE[.dev0]
1013	    """
1014	    if pieces["closest-tag"]:
1015	        rendered = pieces["closest-tag"]
1016	        if pieces["distance"] or pieces["dirty"]:
1017	            rendered += ".post%%d" %% pieces["distance"]
1018	            if pieces["dirty"]:
1019	                rendered += ".dev0"
1020	            rendered += plus_or_dot(pieces)
1021	            rendered += "g%%s" %% pieces["short"]
1022	    else:
1023	        # exception #1
1024	        rendered = "0.post%%d" %% pieces["distance"]
1025	        if pieces["dirty"]:
1026	            rendered += ".dev0"
1027	        rendered += "+g%%s" %% pieces["short"]
1028	    return rendered
1029	
1030	
1031	def render_pep440_post_branch(pieces: Dict[str, Any]) -> str:
1032	    """TAG[.postDISTANCE[.dev0]+gHEX[.dirty]] .
1033	
1034	    The ".dev0" means not master branch.
1035	
1036	    Exceptions:
1037	    1: no tags. 0.postDISTANCE[.dev0]+gHEX[.dirty]
1038	    """
1039	    if pieces["closest-tag"]:
1040	        rendered = pieces["closest-tag"]
1041	        if pieces["distance"] or pieces["dirty"]:
1042	            rendered += ".post%%d" %% pieces["distance"]
1043	            if pieces["branch"] != "master":
1044	                rendered += ".dev0"
1045	            rendered += plus_or_dot(pieces)
1046	            rendered += "g%%s" %% pieces["short"]
1047	            if pieces["dirty"]:
1048	                rendered += ".dirty"
1049	    else:
1050	        # exception #1
1051	        rendered = "0.post%%d" %% pieces["distance"]
1052	        if pieces["branch"] != "master":
1053	            rendered += ".dev0"
1054	        rendered += "+g%%s" %% pieces["short"]
1055	        if pieces["dirty"]:
1056	            rendered += ".dirty"
1057	    return rendered
1058	
1059	
1060	def render_pep440_old(pieces: Dict[str, Any]) -> str:
1061	    """TAG[.postDISTANCE[.dev0]] .
1062	
1063	    The ".dev0" means dirty.
1064	
1065	    Exceptions:
1066	    1: no tags. 0.postDISTANCE[.dev0]
1067	    """
1068	    if pieces["closest-tag"]:
1069	        rendered = pieces["closest-tag"]
1070	        if pieces["distance"] or pieces["dirty"]:
1071	            rendered += ".post%%d" %% pieces["distance"]
1072	            if pieces["dirty"]:
1073	                rendered += ".dev0"
1074	    else:
1075	        # exception #1
1076	        rendered = "0.post%%d" %% pieces["distance"]
1077	        if pieces["dirty"]:
1078	            rendered += ".dev0"
1079	    return rendered
1080	
1081	
1082	def render_git_describe(pieces: Dict[str, Any]) -> str:
1083	    """TAG[-DISTANCE-gHEX][-dirty].
1084	
1085	    Like 'git describe --tags --dirty --always'.
1086	
1087	    Exceptions:
1088	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
1089	    """
1090	    if pieces["closest-tag"]:
1091	        rendered = pieces["closest-tag"]
1092	        if pieces["distance"]:
1093	            rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
1094	    else:
1095	        # exception #1
1096	        rendered = pieces["short"]
1097	    if pieces["dirty"]:
1098	        rendered += "-dirty"
1099	    return rendered
1100	
1101	
1102	def render_git_describe_long(pieces: Dict[str, Any]) -> str:
1103	    """TAG-DISTANCE-gHEX[-dirty].
1104	
1105	    Like 'git describe --tags --dirty --always -long'.
1106	    The distance/hash is unconditional.
1107	
1108	    Exceptions:
1109	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
1110	    """
1111	    if pieces["closest-tag"]:
1112	        rendered = pieces["closest-tag"]
1113	        rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
1114	    else:
1115	        # exception #1
1116	        rendered = pieces["short"]
1117	    if pieces["dirty"]:
1118	        rendered += "-dirty"
1119	    return rendered
1120	
1121	
1122	def render(pieces: Dict[str, Any], style: str) -> Dict[str, Any]:
1123	    """Render the given version pieces into the requested style."""
1124	    if pieces["error"]:
1125	        return {"version": "unknown",
1126	                "full-revisionid": pieces.get("long"),
1127	                "dirty": None,
1128	                "error": pieces["error"],
1129	                "date": None}
1130	
1131	    if not style or style == "default":
1132	        style = "pep440"  # the default
1133	
1134	    if style == "pep440":
1135	        rendered = render_pep440(pieces)
1136	    elif style == "pep440-branch":
1137	        rendered = render_pep440_branch(pieces)
1138	    elif style == "pep440-pre":
1139	        rendered = render_pep440_pre(pieces)
1140	    elif style == "pep440-post":
1141	        rendered = render_pep440_post(pieces)
1142	    elif style == "pep440-post-branch":
1143	        rendered = render_pep440_post_branch(pieces)
1144	    elif style == "pep440-old":
1145	        rendered = render_pep440_old(pieces)
1146	    elif style == "git-describe":
1147	        rendered = render_git_describe(pieces)
1148	    elif style == "git-describe-long":
1149	        rendered = render_git_describe_long(pieces)
1150	    else:
1151	        raise ValueError("unknown style '%%s'" %% style)
1152	
1153	    return {"version": rendered, "full-revisionid": pieces["long"],
1154	            "dirty": pieces["dirty"], "error": None,
1155	            "date": pieces.get("date")}
1156	
1157	
1158	def get_versions() -> Dict[str, Any]:
1159	    """Get version information or return default if unable to do so."""
1160	    # I am in _version.py, which lives at ROOT/VERSIONFILE_SOURCE. If we have
1161	    # __file__, we can work backwards from there to the root. Some
1162	    # py2exe/bbfreeze/non-CPython implementations don't do __file__, in which
1163	    # case we can only use expanded keywords.
1164	
1165	    cfg = get_config()
1166	    verbose = cfg.verbose
1167	
1168	    try:
1169	        return git_versions_from_keywords(get_keywords(), cfg.tag_prefix,
1170	                                          verbose)
1171	    except NotThisMethod:
1172	        pass
1173	
1174	    try:
1175	        root = os.path.realpath(__file__)
1176	        # versionfile_source is the relative path from the top of the source
1177	        # tree (where the .git directory might live) to this file. Invert
1178	        # this to find the root from __file__.
1179	        for _ in cfg.versionfile_source.split('/'):
1180	            root = os.path.dirname(root)
1181	    except NameError:
1182	        return {"version": "0+unknown", "full-revisionid": None,
1183	                "dirty": None,
1184	                "error": "unable to find root of source tree",
1185	                "date": None}
1186	
1187	    try:
1188	        pieces = git_pieces_from_vcs(cfg.tag_prefix, root, verbose)
1189	        return render(pieces, cfg.style)
1190	    except NotThisMethod:
1191	        pass
1192	
1193	    try:
1194	        if cfg.parentdir_prefix:
1195	            return versions_from_parentdir(cfg.parentdir_prefix, root, verbose)
1196	    except NotThisMethod:
1197	        pass
1198	
1199	    return {"version": "0+unknown", "full-revisionid": None,
1200	            "dirty": None,
1201	            "error": "unable to compute version", "date": None}
1202	'''
1203	
1204	
1205	@register_vcs_handler("git", "get_keywords")
1206	def git_get_keywords(versionfile_abs: str) -> Dict[str, str]:
1207	    """Extract version information from the given file."""
1208	    # the code embedded in _version.py can just fetch the value of these

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:1484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1483	        with open(".gitattributes", "a+") as fobj:
1484	            fobj.write(f"{versionfile_source} export-subst\n")
1485	        files.append(".gitattributes")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:1545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1544	        with open(filename) as f:
1545	            contents = f.read()
1546	    except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:1564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1563	    with open(filename, "w") as f:
1564	        f.write(SHORT_VERSION_PY % contents)
1565	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:2061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2060	                    LONG = LONG_VERSION_PY[cfg.VCS]
2061	                    f.write(
2062	                        LONG
2063	                        % {
2064	                            "DOLLAR": "$",
2065	                            "STYLE": cfg.style,
2066	                            "TAG_PREFIX": cfg.tag_prefix,
2067	                            "PARENTDIR_PREFIX": cfg.parentdir_prefix,
2068	                            "VERSIONFILE_SOURCE": cfg.versionfile_source,
2069	                        }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:2094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2093	                    LONG = LONG_VERSION_PY[cfg.VCS]
2094	                    f.write(
2095	                        LONG
2096	                        % {
2097	                            "DOLLAR": "$",
2098	                            "STYLE": cfg.style,
2099	                            "TAG_PREFIX": cfg.tag_prefix,
2100	                            "PARENTDIR_PREFIX": cfg.parentdir_prefix,
2101	                            "VERSIONFILE_SOURCE": cfg.versionfile_source,
2102	                        }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:2143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2142	            with open(manifest_filename, "w") as fobj:
2143	                fobj.write("\n".join(normalized))
2144	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:2238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2237	            with open(os.path.join(root, "setup.cfg"), "a") as f:
2238	                f.write(SAMPLE_CONFIG)
2239	        print(CONFIG_ERROR, file=sys.stderr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:2245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2244	        LONG = LONG_VERSION_PY[cfg.VCS]
2245	        f.write(
2246	            LONG
2247	            % {
2248	                "DOLLAR": "$",
2249	                "STYLE": cfg.style,
2250	                "TAG_PREFIX": cfg.tag_prefix,
2251	                "PARENTDIR_PREFIX": cfg.parentdir_prefix,
2252	                "VERSIONFILE_SOURCE": cfg.versionfile_source,
2253	            }

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:2261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2260	            with open(ipy, "r") as f:
2261	                old = f.read()
2262	        except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:2269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2268	            with open(ipy, "w") as f:
2269	                f.write(old.replace(OLD_SNIPPET, snippet))
2270	        elif snippet not in old:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/s3fs-2025.3.2/s3fs-2025.3.2/versioneer.py:2273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2272	            with open(ipy, "a") as f:
2273	                f.write(snippet)
2274	        else:

--------------------------------------------------

Code scanned:
	Total lines of code: 6650
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 157.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 168.0
		High: 0.0
Files skipped (0):
