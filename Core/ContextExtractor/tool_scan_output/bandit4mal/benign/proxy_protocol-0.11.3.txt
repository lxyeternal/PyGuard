Run started:2025-04-12 09:45:11.812747

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/proxyprotocol/dnsbl.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	
133	    _mapping = [(IPv4Network('127.0.0.2/32'), 'https://www.spamhaus.org/sbl/'),
134	                (IPv4Network('127.0.0.3/32'), 'https://www.spamhaus.org/css/'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/proxyprotocol/dnsbl.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	    _mapping = [(IPv4Network('127.0.0.2/32'), 'https://www.spamhaus.org/sbl/'),
134	                (IPv4Network('127.0.0.3/32'), 'https://www.spamhaus.org/css/'),
135	                (IPv4Network('127.0.0.4/30'), 'https://www.spamhaus.org/xbl/'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/proxyprotocol/dnsbl.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	                (IPv4Network('127.0.0.3/32'), 'https://www.spamhaus.org/css/'),
135	                (IPv4Network('127.0.0.4/30'), 'https://www.spamhaus.org/xbl/'),
136	                (IPv4Network('127.0.0.10/31'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/proxyprotocol/dnsbl.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	                (IPv4Network('127.0.0.10/31'),
137	                 'https://www.spamhaus.org/pbl/')]
138	
139	    def map_results(self, addresses: Sequence[IPv4Address]) -> Optional[str]:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/proxyprotocol/server/echo.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	                    break
70	                writer.write(line)
71	                await writer.drain()

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/proxyprotocol/tlv.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
552	        if val is not None:
553	            decompressed = zlib.decompress(val)
554	            ret: PeerCert = json.loads(decompressed)

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/proxyprotocol/tlv.py:553
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
552	        if val is not None:
553	            decompressed = zlib.decompress(val)
554	            ret: PeerCert = json.loads(decompressed)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_build.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
28	        sock.type = socket.SOCK_STREAM
29	        sock.getpeername.return_value = ('127.0.0.1', 10)
30	        sock.getsockname.return_value = ('1.2.3.4', 20)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_build.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
29	        sock.getpeername.return_value = ('127.0.0.1', 10)
30	        sock.getsockname.return_value = ('1.2.3.4', 20)
31	        res = build_socket_result(sock, unique_id=b'uid', dnsbl='host')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_build.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
31	        res = build_socket_result(sock, unique_id=b'uid', dnsbl='host')
32	        self.assertEqual((IPv4Address('127.0.0.1'), 10), res.source)
33	        self.assertEqual((IPv4Address('1.2.3.4'), 20), res.dest)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_build.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
32	        self.assertEqual((IPv4Address('127.0.0.1'), 10), res.source)
33	        self.assertEqual((IPv4Address('1.2.3.4'), 20), res.dest)
34	        self.assertEqual(socket.AF_INET, res.family)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_build.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
95	        sock.type = socket.SOCK_STREAM
96	        self.extra['peername'] = ('127.0.0.1', 10)
97	        self.extra['sockname'] = ('1.2.3.4', 20)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_build.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
96	        self.extra['peername'] = ('127.0.0.1', 10)
97	        self.extra['sockname'] = ('1.2.3.4', 20)
98	        self.extra['ssl_object'] = None

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_build.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
99	        res = build_transport_result(self.transport)
100	        self.assertEqual((IPv4Address('127.0.0.1'), 10), res.source)
101	        self.assertEqual((IPv4Address('1.2.3.4'), 20), res.dest)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_build.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
100	        self.assertEqual((IPv4Address('127.0.0.1'), 10), res.source)
101	        self.assertEqual((IPv4Address('1.2.3.4'), 20), res.dest)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
36	        sock_info = MagicMock(SocketInfo)
37	        sock_info.peername_ip = IPv4Address('1.2.3.4')
38	        loop = MagicMock(AbstractEventLoop)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
45	        sock_info = MagicMock(SocketInfo)
46	        sock_info.peername_ip = IPv4Address('1.2.3.4')
47	        loop = MagicMock(AbstractEventLoop)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
54	        sock_info = MagicMock(SocketInfo)
55	        sock_info.peername_ip = IPv4Address('1.2.3.4')
56	        loop = MagicMock(AbstractEventLoop)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
57	        loop.getaddrinfo = AsyncMock(return_value=[
58	            (None, None, None, None, ('0.0.0.0', 0))])
59	        result = await dnsbl.lookup(sock_info, loop=loop)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	        sock_info = MagicMock(SocketInfo)
65	        sock_info.peername_ip = IPv4Address('1.2.3.4')
66	        loop = MagicMock(AbstractEventLoop)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
73	        sock_info = MagicMock(SocketInfo)
74	        sock_info.peername_ip = IPv4Address('1.2.3.4')
75	        loop = MagicMock(AbstractEventLoop)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
76	        loop.getaddrinfo = AsyncMock(return_value=[
77	            (None, None, None, None, ('127.0.0.4', 0))])
78	        result = await dnsbl.lookup(sock_info, loop=loop)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        result = await dnsbl.lookup(sock_info, loop=loop)
79	        self.assertEqual('https://www.spamhaus.org/xbl/', result)
80	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
83	        sock_info = MagicMock(SocketInfo)
84	        sock_info.peername_ip = IPv4Address('1.2.3.4')
85	        loop = MagicMock(AbstractEventLoop)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_dnsbl.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
86	        loop.getaddrinfo = AsyncMock(return_value=[
87	            (None, None, None, None, ('127.0.0.100', 0))])
88	        result = await dnsbl.lookup(sock_info, loop=loop)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_result.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
44	    def test_result_ipv4(self) -> None:
45	        res = ProxyResultIPv4((IPv4Address('1.2.3.4'), 10),
46	                              (IPv4Address('5.6.7.8'), 20))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_result.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
45	        res = ProxyResultIPv4((IPv4Address('1.2.3.4'), 10),
46	                              (IPv4Address('5.6.7.8'), 20))
47	        self.assertTrue(is_ipv4(res))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_result.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
48	        self.assertEqual(ProxyResultType.IPv4, res.type)
49	        self.assertEqual((IPv4Address('1.2.3.4'), 10), res.source)
50	        self.assertEqual((IPv4Address('5.6.7.8'), 20), res.dest)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_result.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
49	        self.assertEqual((IPv4Address('1.2.3.4'), 10), res.source)
50	        self.assertEqual((IPv4Address('5.6.7.8'), 20), res.dest)
51	        self.assertEqual(socket.AF_INET, res.family)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_result.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
53	        self.assertTrue(res.proxied)
54	        self.assertEqual(('1.2.3.4', 10), res.peername)
55	        self.assertEqual(('5.6.7.8', 20), res.sockname)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_result.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
54	        self.assertEqual(('1.2.3.4', 10), res.peername)
55	        self.assertEqual(('5.6.7.8', 20), res.sockname)
56	        self.assertEqual(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_result.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
61	    def test_result_ipv4_protocol(self) -> None:
62	        res = ProxyResultIPv4((IPv4Address('1.2.3.4'), 10),
63	                              (IPv4Address('5.6.7.8'), 20),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_result.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
62	        res = ProxyResultIPv4((IPv4Address('1.2.3.4'), 10),
63	                              (IPv4Address('5.6.7.8'), 20),
64	                              protocol=socket.SOCK_STREAM)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_sock.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
82	        info = SocketInfo.get(self.transport, result)
83	        self.assertEqual(IPv4Address('1.2.3.4'), info.sockname_ip)
84	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_v1.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
50	        self.assertIsInstance(res.dest[0], IPv4Address)
51	        self.assertEqual('1.2.3.4', str(res.source[0]))
52	        self.assertEqual(10, res.source[1])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_v1.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
52	        self.assertEqual(10, res.source[1])
53	        self.assertEqual('5.6.7.8', str(res.dest[0]))
54	        self.assertEqual(20, res.dest[1])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_v1.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
88	        result = ProxyResultIPv4(
89	            (IPv4Address('1.2.3.4'), 10),
90	            (IPv4Address('5.6.7.8'), 20))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_v1.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
89	            (IPv4Address('1.2.3.4'), 10),
90	            (IPv4Address('5.6.7.8'), 20))
91	        header = pp.pack(result)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_v2.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
116	        self.assertIsInstance(res.dest[0], IPv4Address)
117	        self.assertEqual('0.0.0.0', str(res.source[0]))
118	        self.assertEqual(0, res.source[1])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_v2.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
118	        self.assertEqual(0, res.source[1])
119	        self.assertEqual('127.0.0.1', str(res.dest[0]))
120	        self.assertEqual(25, res.dest[1])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_v2.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
171	        result = ProxyResultIPv4(
172	            (IPv4Address('0.0.0.0'), 0),
173	            (IPv4Address('127.0.0.1'), 25),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/proxy_protocol-0.11.3/proxy_protocol-0.11.3/test/test_v2.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
172	            (IPv4Address('0.0.0.0'), 0),
173	            (IPv4Address('127.0.0.1'), 25),
174	            protocol=socket.SOCK_STREAM)

--------------------------------------------------

Code scanned:
	Total lines of code: 3361
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 2.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 1.0
Files skipped (0):
