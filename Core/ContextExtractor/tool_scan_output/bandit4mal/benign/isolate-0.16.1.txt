Run started:2025-04-12 14:07:00.304196

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/backends/common.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	
49	    thread = threading.Thread(target=_keep_alive)
50	    try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/backends/common.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	            # TODO: we probably should pass the real line endings
115	            raw_data = stream.read()
116	            if not raw_data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/backends/common.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
154	
155	    observer_thread = threading.Thread(target=_reader)
156	    observer_thread.start()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/backends/settings.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
104	                # directory (we can't leave it as a corrupted build).
105	                shutil.rmtree(path, ignore_errors=True)
106	                raise

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/backends/virtualenv.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
56	            with open(self.constraints_file) as stream:
57	                constraints = stream.read().splitlines()
58	        else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/backends/virtualenv.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
195	
196	            shutil.rmtree(connection_key)
197	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/connections/grpc/_base.py:120
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
119	            """Find a free port in the system."""
120	            with socket.socket() as _temp_socket:
121	                _temp_socket.bind(("", 0))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/connections/grpc/agent.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
192	    def log(self, message: str) -> None:
193	        self._log.write(message + "\n")
194	        self._log.flush()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/connections/grpc/agent.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
211	    server = grpc.server(
212	        futures.ThreadPoolExecutor(max_workers=1),
213	        maximum_concurrent_rpcs=1,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/connections/ipc/_base.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
72	    host, port = address
73	    return base64.b64encode(f"{host}:{port}".encode()).decode("utf-8")
74	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/connections/ipc/_base.py:73
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
72	    host, port = address
73	    return base64.b64encode(f"{host}:{port}".encode()).decode("utf-8")
74	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/connections/ipc/agent.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
52	def decode_service_address(address: str) -> tuple[str, int]:
53	    host, port = base64.b64decode(address).decode("utf-8").rsplit(":", 1)
54	    return host, int(port)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/connections/ipc/agent.py:53
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
52	def decode_service_address(address: str) -> tuple[str, int]:
53	    host, port = base64.b64decode(address).decode("utf-8").rsplit(":", 1)
54	    return host, int(port)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/connections/ipc/agent.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
110	    def log(_msg):
111	        _log.write(_msg)
112	        _log.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/server/server.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	    with open(_AGENT_REQUIREMENTS_TXT) as stream:
51	        AGENT_REQUIREMENTS = stream.read().splitlines()
52	else:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/server/server.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
58	_Q_WAIT_DELAY = 0.1
59	RUNNER_THREAD_POOL = futures.ThreadPoolExecutor(max_workers=MAX_THREADS)
60	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/server/server.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
247	
248	        with ThreadPoolExecutor(max_workers=1) as local_pool:
249	            environment_paths = []

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/server/server.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
630	    parser = ArgumentParser()
631	    parser.add_argument("--host", default="0.0.0.0")
632	    parser.add_argument("--port", type=int, default=50001)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/src/isolate/server/server.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
653	    server = grpc.server(
654	        futures.ThreadPoolExecutor(max_workers=options.num_workers),
655	        options=get_default_options(),

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/tests/conftest.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
12	    monkeypatch.setattr("isolate.server.server.INHERIT_FROM_LOCAL", True)
13	    server = grpc.server(futures.ThreadPoolExecutor(max_workers=1))
14	    test_settings = IsolateSettings(cache_dir=tmp_path / "cache")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/tests/test_backends.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
308	                "requirements": [f"black=={alpha_version}"],
309	                "extra_index_urls": ["https://test.pypi.org/simple/"],
310	            },

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/tests/test_concurrency.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
24	
25	    with futures.ProcessPoolExecutor(os.cpu_count() or 8) as executor:
26	        # Do some create and destroy operations in parallel and ensure

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/tests/test_concurrency.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
46	    key = environment.create()
47	    with futures.ProcessPoolExecutor(max_workers=os.cpu_count() or 8) as executor:
48	        # Do some create and destroy operations in parallel and ensure

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/tests/test_server.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
52	    server = grpc.server(
53	        futures.ThreadPoolExecutor(max_workers=1),
54	        options=get_default_options(),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/tests/test_server.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
739	            time.sleep(0.1)
740	            fobj.write("still alive")
741	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/isolate-0.16.1/isolate-0.16.1/tests/test_server.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
741	
742	        fobj.write("completed")
743	

--------------------------------------------------

Code scanned:
	Total lines of code: 4918
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 3.0
Files skipped (0):
