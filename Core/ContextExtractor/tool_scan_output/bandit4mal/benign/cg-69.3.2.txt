Run started:2025-04-12 11:53:41.038172

Test results:
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/coverage/api.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
75	        with tempfile.NamedTemporaryFile(mode="w+t") as tmp_gene_file:
76	            tmp_gene_file.write("\n".join([str(gene) for gene in panel_genes]))
77	            tmp_gene_file.flush()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/demultiplex/demultiplex_api.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
273	        ):
274	            shutil.rmtree(
275	                self.demultiplexed_run_dir_path(sequencing_run=sequencing_run), ignore_errors=False
276	            )

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/environ.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
10	    if not username:
11	        username = getpass.getuser()
12	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/environ.py:11
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
10	    if not username:
11	        username = getpass.getuser()
12	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	        lims_sample: dict[str, Any] = self.sample(lims_id=lims_id)
78	        return lims_sample.get("source")
79	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	            "project": self._export_project(lims_sample.project),
96	            "family": udfs.get("familyID"),
97	            "customer": udfs.get("customer"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	            "family": udfs.get("familyID"),
97	            "customer": udfs.get("customer"),
98	            "sex": SEX_MAP.get(udfs.get("Gender"), None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	            "customer": udfs.get("customer"),
98	            "sex": SEX_MAP.get(udfs.get("Gender"), None),
99	            "father": udfs.get("fatherID"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	            "customer": udfs.get("customer"),
98	            "sex": SEX_MAP.get(udfs.get("Gender"), None),
99	            "father": udfs.get("fatherID"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            "sex": SEX_MAP.get(udfs.get("Gender"), None),
99	            "father": udfs.get("fatherID"),
100	            "mother": udfs.get("motherID"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	            "father": udfs.get("fatherID"),
100	            "mother": udfs.get("motherID"),
101	            "source": udfs.get("Source"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	            "mother": udfs.get("motherID"),
101	            "source": udfs.get("Source"),
102	            "status": udfs.get("Status"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	            "source": udfs.get("Source"),
102	            "status": udfs.get("Status"),
103	            "panels": udfs.get("Gene List").split(";") if udfs.get("Gene List") else None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	            "status": udfs.get("Status"),
103	            "panels": udfs.get("Gene List").split(";") if udfs.get("Gene List") else None,
104	            "priority": udfs.get("priority"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	            "status": udfs.get("Status"),
103	            "panels": udfs.get("Gene List").split(";") if udfs.get("Gene List") else None,
104	            "priority": udfs.get("priority"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	            "panels": udfs.get("Gene List").split(";") if udfs.get("Gene List") else None,
104	            "priority": udfs.get("priority"),
105	            "received": self.get_received_date(lims_sample.id),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	            "received": self.get_received_date(lims_sample.id),
106	            "application": udfs.get("Sequencing Analysis"),
107	            "application_version": (
108	                int(udfs["Application Tag Version"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	                int(udfs["Application Tag Version"])
109	                if udfs.get("Application Tag Version")
110	                else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	            ),
112	            "comment": udfs.get("comment"),
113	            "concentration_ng_ul": udfs.get("Concentration (ng/ul)"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	            "comment": udfs.get("comment"),
113	            "concentration_ng_ul": udfs.get("Concentration (ng/ul)"),
114	            "passed_initial_qc": udfs.get("Passed Initial QC"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	            "concentration_ng_ul": udfs.get("Concentration (ng/ul)"),
114	            "passed_initial_qc": udfs.get("Passed Initial QC"),
115	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	        try:
122	            date = sample.udf.get("Received at")
123	        except HTTPError as error:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	        try:
132	            date = sample.udf.get("Library Prep Finished")
133	        except HTTPError as error:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
140	        try:
141	            date = sample.udf.get("Delivered at")
142	        except HTTPError as error:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	            lims_sample = Sample(self, id=lims_id)
153	            capture_kit: str | None = lims_sample.udf.get("Bait Set")
154	            if capture_kit and capture_kit != "NA":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	        if sex:
226	            lims_gender = REV_SEX_MAP.get(sex)
227	            if lims_gender:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	        for key, value in kwargs.items():
235	            if not PROP2UDF.get(key):
236	                raise LimsDataError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	        sample = Sample(self, id=lims_id)
247	        if not PROP2UDF.get(key):
248	            raise LimsDataError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	                ):
321	                    method_name = AM_METHODS.get(method[METHOD_DOCUMENT_INDEX])
322	                    return (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
351	        """
352	        if "atlas_version" in method_udfs and process.udf.get(method_udfs["atlas_version"]):
353	            return DocumentationMethod.ATLAS

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
373	        """
374	        return process.udf.get(udf_key_method_doc)
375	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
380	        """
381	        return process.udf.get(udf_key_version)
382	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
388	        return {
389	            artifact.parent_process.udf.get(udf_key)
390	            for artifact in artifacts

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
390	            for artifact in artifacts
391	            if artifact.parent_process.udf.get(udf_key) is not None
392	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	        return {
400	            artifact.udf.get(udf_key)
401	            for artifact in artifacts

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
401	            for artifact in artifacts
402	            if artifact.udf.get(udf_key) is not None
403	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
409	        if lims_sample:
410	            comment: str = lims_sample.get("comment")
411	        return comment

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
417	        if lims_sample:
418	            project_id: str = lims_sample.get("project").get("id")
419	        return project_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
417	        if lims_sample:
418	            project_id: str = lims_sample.get("project").get("id")
419	        return project_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
425	            sample_artifact: Artifact = Artifact(self, id=f"{sample_id}PA1")
426	            rin: float = sample_artifact.udf.get(PROP2UDF["rin"])
427	        except HTTPError as error:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
435	            sample_artifact: Artifact = Artifact(self, id=f"{sample_id}PA1")
436	            dv200: float = sample_artifact.udf.get(PROP2UDF["dv200"])
437	        except HTTPError as error:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
443	        lims_sample: dict[str, Any] = self.sample(sample_id)
444	        initial_qc_udf: str | None = lims_sample.get("passed_initial_qc")
445	        initial_qc: bool | None = eval(initial_qc_udf) if initial_qc_udf else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
464	                            artifact.parent_process.date_run,
465	                            artifact.udf.get(udf_key),
466	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
552	            if (
553	                sample.udf.get("Control") == ControlOptions.NEGATIVE
554	                and sample.udf.get("customer") == CustomerId.CG_INTERNAL_CUSTOMER

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/api.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
553	                sample.udf.get("Control") == ControlOptions.NEGATIVE
554	                and sample.udf.get("customer") == CustomerId.CG_INTERNAL_CUSTOMER
555	            ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/batch.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	SMP_MAKER = ElementMaker(
8	    namespace="http://genologics.com/ri/sample",
9	    nsmap={"smp": "http://genologics.com/ri/sample", "udf": "http://genologics.com/ri/userdefined"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/batch.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    namespace="http://genologics.com/ri/sample",
9	    nsmap={"smp": "http://genologics.com/ri/sample", "udf": "http://genologics.com/ri/userdefined"},
10	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/batch.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    namespace="http://genologics.com/ri/sample",
9	    nsmap={"smp": "http://genologics.com/ri/sample", "udf": "http://genologics.com/ri/userdefined"},
10	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/batch.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	CON_MAKER = ElementMaker(
15	    namespace="http://genologics.com/ri/container",
16	    nsmap={"con": "http://genologics.com/ri/container"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/batch.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    namespace="http://genologics.com/ri/container",
16	    nsmap={"con": "http://genologics.com/ri/container"},
17	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/batch.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	UDF_MAKER = ElementMaker(namespace="http://genologics.com/ri/userdefined", annotate=False)
22	UDF_FIELD = partial(UDF_MAKER, "field")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/batch.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	ART_MAKER = ElementMaker(
25	    namespace="http://genologics.com/ri/artifact",
26	    nsmap={"art": "http://genologics.com/ri/artifact"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/lims/batch.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    namespace="http://genologics.com/ri/artifact",
26	    nsmap={"art": "http://genologics.com/ri/artifact"},
27	)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/madeline/api.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
75	            madeline_content = "\n".join(ped_stream)
76	            in_file.write(madeline_content)
77	            in_file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/apps/madeline/api.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
92	        with open(out_path, "w") as out_handle:
93	            out_handle.write(svg_content)
94	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/cli/set/base.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
284	        if obj.comment is None:
285	            obj.comment = f"{timestamp}-{getpass.getuser()}: {comment}"
286	        else:

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/cli/set/base.py:285
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
284	        if obj.comment is None:
285	            obj.comment = f"{timestamp}-{getpass.getuser()}: {comment}"
286	        else:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/cli/set/base.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
286	        else:
287	            obj.comment = f"{timestamp}-{getpass.getuser()}: {comment}" + "\n" + obj.comment
288	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/cli/set/base.py:287
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
286	        else:
287	            obj.comment = f"{timestamp}-{getpass.getuser()}: {comment}" + "\n" + obj.comment
288	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/cli/workflow/commands.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
165	                LOG.info(f"Removing {process.as_posix()}")
166	                shutil.rmtree(process, ignore_errors=True)
167	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/clients/arnold/api.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
21	        post_request_data: CreateCaseRequest = case
22	        response: Response = requests.post(
23	            endpoint, data=post_request_data.model_dump_json(), verify=True
24	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/clients/chanjo2/client.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
26	        post_data: dict = coverage_post_request.model_dump()
27	        response: requests.Response = requests.post(
28	            url=endpoint, headers=self.headers, json=post_data
29	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/clients/freshdesk/freshdesk_client.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
26	
27	        response = self.session.post(
28	            url=f"{self.base_url}{EndPoints.TICKETS}", data=multipart_data, files=files
29	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/clients/freshdesk/freshdesk_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
64	
65	        response = self.session.post(url=url, data=multipart_data, files=files)
66	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/clients/janus/api.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
21	        post_request_data: str = collect_qc_request.model_dump_json()
22	        response = requests.post(endpoint, data=post_request_data, verify=True)
23	        if response.status_code == HTTPStatus.OK:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/io/api.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
13	    """Create POST request."""
14	    return requests.post(url=url, headers=headers, json=json, verify=verify)
15	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/io/api.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	    """Create GET request."""
24	    return requests.get(url=url, headers=headers, json=json, verify=verify)
25	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/io/png.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
13	    with open(file_path, "rb") as png_file:
14	        encoded_string: str = base64.b64encode(png_file.read()).decode("utf-8")
15	    return f"data:image/png;base64,{encoded_string}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/io/png.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
13	    with open(file_path, "rb") as png_file:
14	        encoded_string: str = base64.b64encode(png_file.read()).decode("utf-8")
15	    return f"data:image/png;base64,{encoded_string}"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/archive/ddn/ddn_data_flow_client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
119	        metadata: list[dict] = get_metadata(file_and_sample.sample)
120	        archival_request: TransferPayload = self.create_transfer_request(
121	            miria_file_data=miria_file_data, is_archiving_request=True, metadata=metadata
122	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/archive/ddn/ddn_data_flow_client.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
134	        )
135	        retrieval_request: TransferPayload = self.create_transfer_request(
136	            miria_file_data=miria_file_data, is_archiving_request=False
137	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/archive/ddn/ddn_data_flow_client.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
212	        )
213	        response: Response = self._post_request(
214	            endpoint=DataflowEndpoints.DELETE_FILE,
215	            headers=dict(self.headers, **self.auth_header),
216	            body=delete_file_payload,
217	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/archive/ddn/ddn_data_flow_client.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
225	        """Archives a file via DDN and validates the response."""
226	        response: Response = self._post_request(
227	            body=body, endpoint=DataflowEndpoints.ARCHIVE_FILES, headers=headers
228	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/archive/ddn/ddn_data_flow_client.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
232	        """Retrieves files specified in the body and validates the response."""
233	        response: Response = self._post_request(
234	            body=body, endpoint=DataflowEndpoints.RETRIEVE_FILES, headers=headers
235	        )

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/fohm/fohm.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
156	            return
157	        if getpass.getuser() == self.config.fohm.valid_uploader:
158	            return

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/fohm/fohm.py:157
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
156	            return
157	        if getpass.getuser() == self.config.fohm.valid_uploader:
158	            return

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/fohm/fohm.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
159	        raise CgError(
160	            f"Cannot upload to FOHM as {getpass.getuser()}, please log in as {self.config.fohm.valid_uploader} "
161	        )

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/fohm/fohm.py:160
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
159	        raise CgError(
160	            f"Cannot upload to FOHM as {getpass.getuser()}, please log in as {self.config.fohm.valid_uploader} "
161	        )

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/fohm/fohm.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
240	            )
241	            pangolin_report_file.chmod(0o0777)
242	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/fohm/fohm.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
293	        if os.listdir(self.daily_report_path) == []:
294	            self.daily_report_path.rmdir()
295	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/fohm/fohm.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
296	        if os.listdir(self.daily_bundle_path) == []:
297	            self.daily_bundle_path.rmdir()
298	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/fohm/fohm.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
320	        if os.listdir(self.daily_rawdata_path) == []:
321	            self.daily_rawdata_path.rmdir()
322	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/nipt/nipt.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	        token: str = (
185	            requests.post(
186	                self.statina_auth_url,
187	                data={"username": self.statina_user, "password": self.statina_password},
188	            )
189	            .json()
190	            .get("access_token")
191	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/nipt/nipt.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
184	        token: str = (
185	            requests.post(
186	                self.statina_auth_url,
187	                data={"username": self.statina_user, "password": self.statina_password},
188	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/upload/nipt/nipt.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
192	
193	        response: Response = requests.post(
194	            url=self.statina_upload_url,
195	            headers={"authorization": f"Bearer {token}"},
196	            data=statina_files.json(exclude_none=True),
197	        )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/workflow/analysis.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
601	
602	            shutil.rmtree(case_path, ignore_errors=True)
603	            LOG.info(f"Cleaned {case_path}")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/workflow/fluffy.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
147	            LOG.info("Fastq directory exists, removing and re-linking files!")
148	            shutil.rmtree(workdir_path, ignore_errors=True)
149	        workdir_path.mkdir(parents=True, exist_ok=True)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/workflow/fluffy.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
243	            if not dry_run:
244	                shutil.rmtree(output_path, ignore_errors=True)
245	        if not workflow_config:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/workflow/microsalt/microsalt.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
78	
79	                shutil.rmtree(analysis_path, ignore_errors=True)
80	                LOG.info(f"Cleaned {analysis_path}")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/meta/workflow/mutant/mutant.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
172	            LOG.info("Found old output files, directory will be cleaned!")
173	            shutil.rmtree(self.get_case_output_path(case_id=case_id), ignore_errors=True)
174	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/app.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	    _initialize_logging(app)
68	    certs_resp = requests.get("https://www.googleapis.com/oauth2/v1/certs")
69	    app.config["GOOGLE_OAUTH_CERTS"] = certs_resp.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/app.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	    _initialize_logging(app)
68	    certs_resp = requests.get("https://www.googleapis.com/oauth2/v1/certs")
69	    app.config["GOOGLE_OAUTH_CERTS"] = certs_resp.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/app.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	        client_secret=app_config.google_oauth_client_secret,
88	        scope=["openid", "https://www.googleapis.com/auth/userinfo.email"],
89	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/app.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	        """Called when the user logs in via Google OAuth."""
94	        resp = google.get("/oauth2/v1/userinfo?alt=json")
95	        assert resp.ok, resp.text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/app_config.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    # Freshdesk settings
42	    freshdesk_url: str = "https://company.freshdesk.com"
43	    freshdesk_api_key: str = "freshdesk_api_key"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/applications.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
13	APPLICATIONS_BLUEPRINT = Blueprint("applications", __name__, url_prefix="/api/v1")
14	APPLICATIONS_BLUEPRINT.before_request(before_request)
15	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/cases.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
15	CASES_BLUEPRINT = Blueprint("cases", __name__, url_prefix="/api/v1")
16	CASES_BLUEPRINT.before_request(before_request)
17	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/cases.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
15	CASES_BLUEPRINT = Blueprint("cases", __name__, url_prefix="/api/v1")
16	CASES_BLUEPRINT.before_request(before_request)
17	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/cases.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	
73	    customer_internal_id = request.args.get("customer")
74	    workflow = request.args.get("data_analysis")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/cases.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	    customer_internal_id = request.args.get("customer")
74	    workflow = request.args.get("data_analysis")
75	    case_search_pattern = request.args.get("enquiry")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/cases.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	    workflow = request.args.get("data_analysis")
75	    case_search_pattern = request.args.get("enquiry")
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/cases.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	    customer: Customer = db.get_customer_by_internal_id(
92	        customer_internal_id=request.args.get("customer")
93	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/orders.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
45	ORDERS_BLUEPRINT = Blueprint("orders", __name__, url_prefix="/api/v1")
46	ORDERS_BLUEPRINT.before_request(before_request)
47	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/orders.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
45	ORDERS_BLUEPRINT = Blueprint("orders", __name__, url_prefix="/api/v1")
46	ORDERS_BLUEPRINT.before_request(before_request)
47	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/orders.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	    """Parse an orderform/JSON export."""
108	    input_file = request.files.get("file")
109	    filename = secure_filename(input_file.filename)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/orders.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
119	        else:
120	            json_data = json.load(input_file.stream, strict=False)
121	            order_parser = JsonOrderformParser()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/pools.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
9	POOLS_BLUEPRINT = Blueprint("pools", __name__, url_prefix="/api/v1")
10	POOLS_BLUEPRINT.before_request(before_request)
11	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/samples.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
12	SAMPLES_BLUEPRINT = Blueprint("samples", __name__, url_prefix="/api/v1")
13	SAMPLES_BLUEPRINT.before_request(before_request)
14	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/samples.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
12	SAMPLES_BLUEPRINT = Blueprint("samples", __name__, url_prefix="/api/v1")
13	SAMPLES_BLUEPRINT.before_request(before_request)
14	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/samples.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	    customer: Customer = db.get_customer_by_internal_id(
38	        customer_internal_id=request.args.get("customer")
39	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/users.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
8	USERS_BLUEPRINT = Blueprint("users", __name__, url_prefix="/api/v1")
9	USERS_BLUEPRINT.before_request(before_request)
10	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/endpoints/utils.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	
49	    auth_header = request.headers.get("Authorization")
50	    if not auth_header:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/invoices/views.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
101	    if kth_excel_file:
102	        invoice_obj.excel_kth = kth_excel_file.stream.read()
103	    ki_excel_file = request.files.get("KI_excel")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/invoices/views.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
104	    if ki_excel_file:
105	        invoice_obj.excel_ki = ki_excel_file.stream.read()
106	    db.session.commit()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/invoices/views.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
218	        if cost_center == "KTH":
219	            file_object.write(invoice_obj.excel_kth)
220	        elif cost_center == "KI":

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/invoices/views.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
218	        if cost_center == "KTH":
219	            file_object.write(invoice_obj.excel_kth)
220	        elif cost_center == "KI":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/invoices/views.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
220	        elif cost_center == "KI":
221	            file_object.write(invoice_obj.excel_ki)
222	    return send_from_directory(directory=temp_dir, path=file_name, as_attachment=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/server/invoices/views.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
220	        elif cost_center == "KI":
221	            file_object.write(invoice_obj.excel_ki)
222	    return send_from_directory(directory=temp_dir, path=file_name, as_attachment=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/services/delivery_message/messages/utils.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    case_name: str = case.name
13	    return f"https://scout.scilifelab.se/{customer_id}/{case_name}"
14	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/services/delivery_message/messages/utils.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	def get_statina_link(batch_id: str) -> str:
31	    return f"https://statina.clinicalgenomics.se/batches/{batch_id}"

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/services/orders/submitter/ticket_handler.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
77	        with order_file_path.open("w") as order_file:
78	            order_file.write(order.json())
79	        return order_file_path

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/services/web_services/sample/service.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
66	            samples: list[Sample] = self.store.get_samples_to_sequence()
67	        start, finish = get_start_and_finish_indexes_from_request(request)
68	        parsed_samples: list[dict] = [sample.to_dict() for sample in samples[start:finish]]

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cg-69.3.2/cg-69.3.2/cg/utils/files.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
96	    try:
97	        shutil.rmtree(directory_path)
98	        LOG.info(f"Successfully removed the directory and its contents: {directory_path}")

--------------------------------------------------

Code scanned:
	Total lines of code: 53913
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 104.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 117.0
		High: 6.0
Files skipped (0):
