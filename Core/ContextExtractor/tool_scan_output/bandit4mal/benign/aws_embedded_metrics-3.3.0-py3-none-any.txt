Run started:2025-04-12 17:03:18.355312

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/environment/ec2_environment.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	# https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html
29	TOKEN_ENDPOINT = "http://169.254.169.254/latest/api/token"
30	TOKEN_REQUEST_HEADER_KEY = "X-aws-ec2-metadata-token-ttl-seconds"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/environment/ec2_environment.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	DEFAULT_EC2_METADATA_ENDPOINT = (
33	    "http://169.254.169.254/latest/dynamic/instance-identity/document"
34	)
35	METADATA_REQUEST_HEADER_KEY = "X-aws-ec2-metadata-token"
36	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/environment/ec2_environment.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
40	) -> Dict[str, Any]:
41	    async with session.request(method, url, timeout=2, headers=headers) as response:
42	        # content_type=None prevents validation of the HTTP Content-Type header

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/environment/ec2_environment.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
50	) -> str:
51	    async with session.request(method, url, timeout=2, headers=headers) as response:
52	        return await response.text()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/tcp_client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
36	            try:
37	                self._sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
38	                self._sock.connect((self._endpoint.hostname, self._endpoint.port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/tcp_client.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
37	                self._sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
38	                self._sock.connect((self._endpoint.hostname, self._endpoint.port))
39	                self._should_connect = False

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/tcp_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
66	        if self._sock is None or self._sock._closed or self._should_connect:  # type: ignore
67	            self.connect()
68	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/tcp_client.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
70	            try:
71	                self._sock.sendall(message)
72	                log.info("Submitted metrics to agent over TCP.")

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/tcp_client.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
74	                log.error("Socket timeout durring send %s" % (e,))
75	                self.connect()
76	                self.send_message(message, retry - 1)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/tcp_client.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
78	                log.error("Failed to write metrics to the socket due to socket.error. %s" % (e,))
79	                self.connect()
80	                self.send_message(message, retry - 1)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/tcp_client.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
82	                log.error("Failed to write metrics to the socket due to exception. %s" % (e,))
83	                self.connect()
84	                self.send_message(message, retry - 1)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/udp_client.py:27
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
26	    def send_message(self, message: bytes) -> None:
27	        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
28	        sock.sendto(message, (self.endpoint.hostname, self.endpoint.port))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_embedded_metrics-3.3.0-py3-none-any/aws_embedded_metrics/sinks/udp_client.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
28	        sock.sendto(message, (self.endpoint.hostname, self.endpoint.port))
29	        sock.close()
30	        log.info("Submitted metrics to agent over UDP.")

--------------------------------------------------

Code scanned:
	Total lines of code: 1024
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 2.0
Files skipped (0):
