Run started:2025-04-12 10:16:55.044516

Test results:
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/attach.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
25	def start_attach(init_kwargs_b64: str) -> None:
26	    init_kwargs = json.loads(base64.urlsafe_b64decode(init_kwargs_b64.encode("ascii")).decode("ascii"))
27	    tracer = get_tracer()

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/cellmagic.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
55	            with VizTracer(**tracer_kwargs):
56	                exec(code, local_ns, local_ns)
57	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/cellmagic.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	                import webbrowser
63	                webbrowser.open_new_tab(f'http://127.0.0.1:{server.port}')
64	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
170	            cfg_parser = configparser.ConfigParser()
171	            cfg_parser.read(filename)
172	            if "default" not in cfg_parser:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
362	        if options.patch_only:
363	            exec(code, global_dict)
364	            return True, None

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
372	
373	        signal.signal(signal.SIGTERM, term_handler)
374	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:373
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
372	
373	        signal.signal(signal.SIGTERM, term_handler)
374	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
375	        if options.subprocess_child:
376	            tracer.label_file_to_write()
377	            multiprocessing.util.Finalize(tracer, tracer.exit_routine, exitpriority=-1)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
375	        if options.subprocess_child:
376	            tracer.label_file_to_write()
377	            multiprocessing.util.Finalize(tracer, tracer.exit_routine, exitpriority=-1)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
383	
384	        exec(code, global_dict)
385	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
439	        with io.open_code(file_name) as f:
440	            code_string = f.read()
441	        if options.magic_comment or options.log_var or options.log_number or options.log_attr or \

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
564	        })
565	        b64s = base64.urlsafe_b64encode(json.dumps(self.init_kwargs).encode("ascii")).decode("ascii")
566	        start_code = f"import viztracer.attach; viztracer.attach.start_attach(\\\"{b64s}\\\")"

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/main.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
656	        builder.save(output_file=ofile)
657	        shutil.rmtree(self.multiprocess_output_dir)
658	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/patch.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	            with open(real_path, "rb") as f:
72	                if f.read(2) == b"#!":
73	                    executable = f.readline().decode("utf-8").strip()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/patch.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
232	                self: Process = reduction.pickle.load(from_parent)
233	                sp = SpawnProcess(viztracer_kwargs, self.run, self._target, self._args, self._kwargs, cmdline_args)
234	                self.run = sp.run

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/patch.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
290	                    # new process
291	                    tracer.label_file_to_write()
292	            os.register_at_fork(after_in_child=callback)  # type: ignore

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/report_builder.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	        with open(data, encoding="utf-8") as f:
27	            json_str = f.read()
28	    elif isinstance(data, tuple):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/report_builder.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
31	            with open(path, encoding="utf-8") as f:
32	                json_str = f.read()
33	            ret = json.loads(json_str)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/report_builder.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
199	                                    with open(file_name, "r", encoding="utf-8") as f:
200	                                        content = f.read()
201	                                        file_dict[file_name] = [content, content.count("\n")]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/report_builder.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
214	            with open(os.path.join(os.path.dirname(__file__), "html/trace_viewer_embedder.html"), encoding="utf-8") as f:
215	                tmpl = f.read()
216	            with open(os.path.join(os.path.dirname(__file__), "html/trace_viewer_full.html"), encoding="utf-8") as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/report_builder.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
216	            with open(os.path.join(os.path.dirname(__file__), "html/trace_viewer_full.html"), encoding="utf-8") as f:
217	                sub["trace_viewer_full"] = f.read()
218	            if json.__name__ == "orjson":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/report_builder.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
224	                                       .replace("</script>", "<\\/script>")  # type: ignore
225	            output_file.write(Template(tmpl).substitute(sub))
226	        elif output_format == "json":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/report_builder.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228	            if json.__name__ == "orjson":
229	                output_file.write(json.dumps(self.combined_json).decode("utf-8"))
230	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/report_builder.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
233	                else:
234	                    output_file.write(json.dumps(self.combined_json))  # type: ignore
235	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	            self.end_headers()
83	            self.wfile.write(json.dumps(info).encode("utf-8"))
84	            self.wfile.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	            self.end_headers()
89	            self.wfile.write(json.dumps(self.server_thread.file_info).encode("utf-8"))
90	            self.wfile.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	        title = f'Directory listing for {displaypath}'
180	        r.append('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" '
181	                 '"http://www.w3.org/TR/html4/strict.dtd">')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
214	        f = io.BytesIO()
215	        f.write(encoded)
216	        f.seek(0)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
277	        self.quiet = quiet
278	        self.link = f"http://127.0.0.1:{self.port}"
279	        self.use_external_procesor = use_external_processor

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
312	                    with gzip.open(self.path, "rt", encoding="utf-8", errors="ignore") as f:
313	                        trace_data = json.load(f)
314	                else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
315	                    with open(self.path, encoding="utf-8", errors="ignore") as f:
316	                        trace_data = json.load(f)
317	                self.file_info = trace_data.get("file_info", {})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
329	        socketserver.TCPServer.allow_reuse_address = True
330	        with VizViewerTCPServer(('0.0.0.0', self.port), Handler) as self.httpd:
331	            if not self.once and not self.quiet:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
332	                print("Running vizviewer")
333	                print(f"You can also view your trace on http://localhost:{self.port}")
334	                print("Press Ctrl+C to quit", flush=True)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
338	                while not self.httpd.__dict__.get("trace_served", False):
339	                    self.httpd.handle_request()
340	            else:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:353
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
352	        with contextlib.closing(
353	                socket.socket(socket.AF_INET,
354	                              socket.SOCK_STREAM)) as sock:
355	            return sock.connect_ex(('127.0.0.1', self.port)) == 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
354	                              socket.SOCK_STREAM)) as sock:
355	            return sock.connect_ex(('127.0.0.1', self.port)) == 0
356	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
391	            if port not in ports_used:
392	                t = ServerThread(
393	                    path,
394	                    port=port,
395	                    use_external_processor=self.use_external_processor,
396	                    quiet=True)
397	                t.start()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
425	        socketserver.TCPServer.allow_reuse_address = True
426	        with VizViewerTCPServer(('0.0.0.0', self.port), Handler) as httpd:
427	            print("Running vizviewer")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
427	            print("Running vizviewer")
428	            print(f"You can also view your trace on http://localhost:{self.port}")
429	            print("Press Ctrl+C to quit", flush=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
432	                import webbrowser
433	                webbrowser.open_new_tab(f'http://127.0.0.1:{self.port}')
434	            try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
496	        try:
497	            server = ServerThread(
498	                path,
499	                port=options.port,
500	                once=options.once,
501	                timeout=options.timeout,
502	                use_external_processor=options.use_external_processor,
503	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viewer.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
510	                import webbrowser
511	                webbrowser.open_new_tab(f'http://127.0.0.1:{options.port}')
512	            while server.is_alive():

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
190	
191	        signal.signal(signal.SIGUSR1, signal_start)
192	        signal.signal(signal.SIGUSR2, signal_stop)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:191
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
190	
191	        signal.signal(signal.SIGUSR1, signal_start)
192	        signal.signal(signal.SIGUSR2, signal_stop)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
191	        signal.signal(signal.SIGUSR1, signal_start)
192	        signal.signal(signal.SIGUSR2, signal_stop)
193	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:192
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
191	        signal.signal(signal.SIGUSR1, signal_start)
192	        signal.signal(signal.SIGUSR2, signal_stop)
193	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
276	        self.start()
277	        exec(command)
278	        self.stop()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
338	
339	        p = multiprocessing.Process(target=self.save, daemon=False,
340	                                    kwargs={"output_file": output_file})
341	        p.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
373	
374	        self.label_file_to_write()
375	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
373	
374	        self.label_file_to_write()
375	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
375	
376	        signal.signal(signal.SIGTERM, term_handler)
377	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/src/viztracer/viztracer.py:376
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
375	
376	        signal.signal(signal.SIGTERM, term_handler)
377	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_cmdline.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
614	            with open(filename, "w") as f:
615	                parser.write(f)
616	            try:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_cmdline.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
614	            with open(filename, "w") as f:
615	                parser.write(f)
616	            try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_multiprocess.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	
195	file_pool = """
196	import gc
197	from multiprocessing import Process, Pool
198	import os
199	import time
200	
201	def f(x):
202	    return x*x
203	
204	if __name__ == "__main__":
205	    process_num = 2
206	    # gc seems to cause SegFault with multithreading
207	    # Pool creates a couple of thread and it's failing the test
208	    # https://github.com/python/cpython/issues/101975
209	
210	    gc.disable()
211	    with Pool(processes=process_num) as pool:
212	        print(pool.map(f, range(10)))
213	
214	        for i in pool.imap_unordered(f, range(10)):
215	            print(i)
216	
217	        res = pool.apply_async(f, (20,))      # runs in *only* one process
218	        print(res.get(timeout=1))             # prints "400"
219	
220	        res = pool.apply_async(os.getpid, ()) # runs in *only* one process
221	        print(res.get(timeout=1))             # prints the PID of that process
222	
223	        multiple_results = [pool.apply_async(os.getpid, ()) for i in range(process_num)]
224	        print([res.get(timeout=1) for res in multiple_results])
225	    gc.enable()
226	"""
227	
228	file_pool_with_pickle = """

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_multiprocess.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
261	        with open("child.py", "w") as f:
262	            f.write(file_child)
263	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_multiprocess.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
261	        with open("child.py", "w") as f:
262	            f.write(file_child)
263	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_multiprocess.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
365	        with open("parent.py", "w") as f:
366	            f.write(file_parent)
367	        self.template(["viztracer", "-o", "result.json", "cmdline_test.py"],

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_multiprocess.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
365	        with open("parent.py", "w") as f:
366	            f.write(file_parent)
367	        self.template(["viztracer", "-o", "result.json", "cmdline_test.py"],

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_multiprocess.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
377	        with open("parent.py", "w") as f:
378	            f.write(file_multiprocessing)
379	        self.template(["viztracer", "-o", "result.json", "cmdline_test.py"],

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_multiprocess.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
377	        with open("parent.py", "w") as f:
378	            f.write(file_multiprocessing)
379	        self.template(["viztracer", "-o", "result.json", "cmdline_test.py"],

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_patch.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
114	        self.assertTrue(re.match(r"result_[0-9]*\.json", files[0]))
115	        shutil.rmtree(tmpdir)
116	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_patch.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
127	        self.assertTrue(re.match(r"result_[0-9]*\.json", files[0]))
128	        shutil.rmtree(tmpdir)
129	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	        with open("attached_script.py", "w") as f:
86	            f.write(file_to_attach)
87	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	            p_attach.wait()
103	            out, err = p_attach.stdout.read().decode("utf-8"), p_attach.stderr.read().decode("utf-8")
104	            p_attach.stdout.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	            p_attach.wait()
103	            out, err = p_attach.stdout.read().decode("utf-8"), p_attach.stderr.read().decode("utf-8")
104	            p_attach.stdout.close()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
118	            self.assertIn("success", out.decode("utf-8"))
119	            p_attach.send_signal(signal.SIGINT)
120	            p_attach.wait()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
132	            p_script.wait()
133	            attached_out, attached_err = p_script.stdout.read().decode("utf-8"), p_script.stderr.read().decode("utf-8")
134	            p_script.stdout.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
132	            p_script.wait()
133	            attached_out, attached_err = p_script.stdout.read().decode("utf-8"), p_script.stderr.read().decode("utf-8")
134	            p_script.stdout.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
159	        with open("attached_script.py", "w") as f:
160	            f.write(file_to_attach)
161	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
178	            self.assertIn("success", out.decode("utf-8"))
179	            p_attach.send_signal(signal.SIGINT)
180	            p_attach.wait()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
192	            self.assertIn("success", out.decode("utf-8"))
193	            p_attach.send_signal(signal.SIGINT)
194	            p_attach.wait()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
238	        with open("attached_script.py", "w") as f:
239	            f.write(file_to_attach)
240	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
252	            p_script.wait()
253	            self.assertIn("finish", p_script.stdout.read().decode("utf-8"))
254	            p_script.stdout.close()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
263	        kwargs_non_exist = {"output_file": "non_exist.json"}
264	        kwargs_b64 = base64.urlsafe_b64encode(json.dumps(kwargs).encode("ascii")).decode("ascii")
265	        kwargs_non_exist_b64 = base64.urlsafe_b64encode(json.dumps(kwargs_non_exist).encode("ascii")).decode("ascii")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_remote.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
264	        kwargs_b64 = base64.urlsafe_b64encode(json.dumps(kwargs).encode("ascii")).decode("ascii")
265	        kwargs_non_exist_b64 = base64.urlsafe_b64encode(json.dumps(kwargs_non_exist).encode("ascii")).decode("ascii")
266	        attach_script = textwrap.dedent(f"""

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_report_builder.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	        with open(json_path) as f:
26	            rb = ReportBuilder(json.loads(f.read()), verbose=0)
27	        with io.StringIO() as s:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_report_builder.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	        with open(json_path) as f:
38	            rb = ReportBuilder(json.loads(f.read()), verbose=0, minimize_memory=True)
39	        with io.StringIO() as s:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_report_builder.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	        with open(json_path) as f:
43	            rb = ReportBuilder(json.loads(f.read()), verbose=0, minimize_memory=False)
44	        with io.StringIO() as s:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_report_builder.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	        with open(json_path) as f:
68	            rb = ReportBuilder(json.loads(f.read()), verbose=1)
69	        rb.entry_number_threshold = 20

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_report_builder.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124	            with open(empty_file, "w") as f:
125	                f.write(json.dumps({"traceEvents": []}))
126	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_report_builder.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
124	            with open(empty_file, "w") as f:
125	                f.write(json.dumps({"traceEvents": []}))
126	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_util.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
51	        # test child
52	        p = Process(target=target_child)
53	        p.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_vcompressor.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
224	        with open(uncompressed_file_path, "rb") as original_file:
225	            compressed_data = zlib.compress(original_file.read())
226	        with open(compressed_file_path, "wb") as compressed_file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_vcompressor.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
226	        with open(compressed_file_path, "wb") as compressed_file:
227	            compressed_file.write(compressed_data)
228	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_vcompressor.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
226	        with open(compressed_file_path, "wb") as compressed_file:
227	            compressed_file.write(compressed_data)
228	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_vcompressor.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
250	        with open(tmp_compress_file, "rb") as tmp_file:
251	            compressed_data = zlib.compress(tmp_file.read())
252	        with open(compressed_file_path, "wb") as compressed_file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_vcompressor.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
252	        with open(compressed_file_path, "wb") as compressed_file:
253	            compressed_file.write(compressed_data)
254	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_vcompressor.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
252	        with open(compressed_file_path, "wb") as compressed_file:
253	            compressed_file.write(compressed_data)
254	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
87	                if self.process.poll() is None:
88	                    self.process.send_signal(signal.SIGINT)
89	                    self.process.wait(timeout=20)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
98	            finally:
99	                self.process.stdout.close()
100	                self.process.stderr.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
99	                self.process.stdout.close()
100	                self.process.stderr.close()
101	                self.stopped = True

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:116
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
115	        for _ in range(10):
116	            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
117	            sock.settimeout(5)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
116	            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
117	            sock.settimeout(5)
118	            result = sock.connect_ex(('127.0.0.1', port))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
117	            sock.settimeout(5)
118	            result = sock.connect_ex(('127.0.0.1', port))
119	            sock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
118	            result = sock.connect_ex(('127.0.0.1', port))
119	            sock.close()
120	            if result == 0:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	    def url(self, offset: int = 0) -> str:
126	        return f'http://127.0.0.1:{self.port + offset}'
127	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
139	            try:
140	                resp = urllib.request.urlopen(url, timeout=2)
141	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
142	                continue
143	            self.assertRegex(resp.read().decode("utf-8"), re.compile(expected, re.DOTALL))
144	        if self.int_pid is not None:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
149	        ctx = multiprocessing.get_context("spawn")
150	        self.p = ctx.Process(target=self.get_and_check, args=(url, self.file_content))
151	        self.p.start()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:156
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
155	    def _find_a_free_port(self) -> int:
156	        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
157	        sock.bind(('', 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
158	        port = sock.getsockname()[1]
159	        sock.close()
160	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	            with tempfile.NamedTemporaryFile(mode='w', suffix='.json', delete=False) as f:
168	                f.write(json_script)
169	            with Viewer(f.name, port=self._find_a_free_port()) as v:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
167	            with tempfile.NamedTemporaryFile(mode='w', suffix='.json', delete=False) as f:
168	                f.write(json_script)
169	            with Viewer(f.name, port=self._find_a_free_port()) as v:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
170	                time.sleep(0.5)
171	                resp = urllib.request.urlopen(v.url())
172	                self.assertTrue(resp.code == 200)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
172	                self.assertTrue(resp.code == 200)
173	                resp = urllib.request.urlopen(f"{v.url()}/file_info")
174	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173	                resp = urllib.request.urlopen(f"{v.url()}/file_info")
174	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
175	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
174	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
175	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
176	                self.assertEqual(json.loads(resp.read().decode("utf-8")), json.loads(json_script))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
176	                self.assertEqual(json.loads(resp.read().decode("utf-8")), json.loads(json_script))
177	        finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
184	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
185	                f.write(json_script)
186	            with Viewer(f.name) as v:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
184	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
185	                f.write(json_script)
186	            with Viewer(f.name) as v:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
187	                time.sleep(0.5)
188	                resp = urllib.request.urlopen(v.url())
189	                self.assertTrue(resp.code == 200)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
189	                self.assertTrue(resp.code == 200)
190	                resp = urllib.request.urlopen(f"{v.url()}/file_info")
191	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
190	                resp = urllib.request.urlopen(f"{v.url()}/file_info")
191	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
192	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
191	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
192	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
193	                self.assertEqual(json.loads(resp.read().decode("utf-8")), json.loads(json_script))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
192	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
193	                self.assertEqual(json.loads(resp.read().decode("utf-8")), json.loads(json_script))
194	        finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
202	            with gzip.open(filename, "wt") as f:
203	                f.write(json_script)
204	            with Viewer(filename) as v:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
202	            with gzip.open(filename, "wt") as f:
203	                f.write(json_script)
204	            with Viewer(filename) as v:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
205	                time.sleep(0.5)
206	                resp = urllib.request.urlopen(v.url())
207	                self.assertTrue(resp.code == 200)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
207	                self.assertTrue(resp.code == 200)
208	                resp = urllib.request.urlopen(f"{v.url()}/file_info")
209	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	                resp = urllib.request.urlopen(f"{v.url()}/file_info")
209	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
210	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
209	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
210	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
211	                self.assertEqual(json.loads(gzip.decompress(resp.read()).decode("utf-8")),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
210	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
211	                self.assertEqual(json.loads(gzip.decompress(resp.read()).decode("utf-8")),
212	                                 json.loads(json_script))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
218	            with tempfile.NamedTemporaryFile(mode="w", suffix=".html", delete=False) as f:
219	                f.write(html)
220	            with Viewer(f.name) as v:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
218	            with tempfile.NamedTemporaryFile(mode="w", suffix=".html", delete=False) as f:
219	                f.write(html)
220	            with Viewer(f.name) as v:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
221	                time.sleep(0.5)
222	                resp = urllib.request.urlopen(v.url())
223	                self.assertTrue(resp.code == 200)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
231	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
232	                f.write(json_script)
233	            with Viewer(f.name, use_external_processor=True) as v:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
231	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
232	                f.write(json_script)
233	            with Viewer(f.name, use_external_processor=True) as v:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
234	                time.sleep(0.5)
235	                resp = urllib.request.urlopen(v.url(), timeout=10)
236	                self.assertTrue(resp.code == 200)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
247	                with open(os.path.join(web_dist_path, "trace_processor")) as f:
248	                    match = re.search(r"tools/roll-prebuilts v(\d+\.\d+)", f.read())
249	                if match is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
262	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
263	                f.write(json_script)
264	            with Viewer(f.name) as v:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
262	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
263	                f.write(json_script)
264	            with Viewer(f.name) as v:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
265	                time.sleep(0.5)
266	                resp = urllib.request.urlopen(v.url())
267	                self.assertTrue(resp.code == 200)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
269	                    self.assertNotEqual(v2.process.returncode, 0)
270	                    stdout = v2.process.stdout.read()
271	                    self.assertIn("Error", stdout)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
278	            with tempfile.NamedTemporaryFile(mode="w", suffix=".html", delete=False) as f:
279	                f.write(html)
280	            with Viewer(f.name, once=True) as v:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
278	            with tempfile.NamedTemporaryFile(mode="w", suffix=".html", delete=False) as f:
279	                f.write(html)
280	            with Viewer(f.name, once=True) as v:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
281	                time.sleep(0.5)
282	                resp = urllib.request.urlopen(v.url())
283	                v.wait()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
291	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
292	                f.write(json_script)
293	            with Viewer(f.name, once=True) as v:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
291	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
292	                f.write(json_script)
293	            with Viewer(f.name, once=True) as v:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
294	                time.sleep(0.5)
295	                resp = urllib.request.urlopen(v.url())
296	                self.assertTrue(resp.code == 200)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
296	                self.assertTrue(resp.code == 200)
297	                resp = urllib.request.urlopen(f"{v.url()}/file_info")
298	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
297	                resp = urllib.request.urlopen(f"{v.url()}/file_info")
298	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
299	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
298	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
299	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
300	                self.assertEqual(json.loads(resp.read().decode("utf-8")), json.loads(json_script))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
299	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
300	                self.assertEqual(json.loads(resp.read().decode("utf-8")), json.loads(json_script))
301	                v.wait()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
308	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
309	                f.write(json_script)
310	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
308	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
309	                f.write(json_script)
310	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
327	            with tempfile.NamedTemporaryFile(mode="w", suffix=".html", delete=False) as f:
328	                f.write(html)
329	            with unittest.mock.patch.object(sys, "argv", ["vizviewer", "--once", f.name]):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
327	            with tempfile.NamedTemporaryFile(mode="w", suffix=".html", delete=False) as f:
328	                f.write(html)
329	            with unittest.mock.patch.object(sys, "argv", ["vizviewer", "--once", f.name]):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
340	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
341	                f.write(json_script)
342	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
340	            with tempfile.NamedTemporaryFile(mode="w", suffix=".json", delete=False) as f:
341	                f.write(json_script)
342	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
344	                time.sleep(0.5)
345	                resp = urllib.request.urlopen(f"{v.url()}/vizviewer_info")
346	                self.assertTrue(resp.code == 200)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
346	                self.assertTrue(resp.code == 200)
347	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
348	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
347	                self.assertEqual(json.loads(resp.read().decode("utf-8")), {})
348	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
349	                self.assertEqual(json.loads(resp.read().decode("utf-8")), json.loads(json_script))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
348	                resp = urllib.request.urlopen(f"{v.url()}/localtrace")
349	                self.assertEqual(json.loads(resp.read().decode("utf-8")), json.loads(json_script))
350	                v.wait()

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
361	            time.sleep(0.5)
362	            resp = urllib.request.urlopen(v.url())
363	            self.assertEqual(resp.code, 200)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
363	            self.assertEqual(resp.code, 200)
364	            self.assertIn("fib.json", resp.read().decode("utf-8"))
365	            resp = urllib.request.urlopen(f"{v.url()}/fib.json")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
364	            self.assertIn("fib.json", resp.read().decode("utf-8"))
365	            resp = urllib.request.urlopen(f"{v.url()}/fib.json")
366	            self.assertEqual(resp.url, f"{v.url(1)}/")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
366	            self.assertEqual(resp.url, f"{v.url(1)}/")
367	            resp = urllib.request.urlopen(f"{v.url()}/old.json")
368	            self.assertEqual(resp.url, f"{v.url(2)}/")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
375	            with tempfile.NamedTemporaryFile(mode="w", suffix=".html", delete=False) as f:
376	                f.write(html)
377	            tmp_dir = os.path.dirname(f.name)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
375	            with tempfile.NamedTemporaryFile(mode="w", suffix=".html", delete=False) as f:
376	                f.write(html)
377	            tmp_dir = os.path.dirname(f.name)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
392	            time.sleep(0.5)
393	            resp = urllib.request.urlopen(v.url())
394	            self.assertEqual(resp.code, 200)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
394	            self.assertEqual(resp.code, 200)
395	            self.assertIn("fib.json", resp.read().decode("utf-8"))
396	            resp = urllib.request.urlopen(f"{v.url()}/fib.json")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
395	            self.assertIn("fib.json", resp.read().decode("utf-8"))
396	            resp = urllib.request.urlopen(f"{v.url()}/fib.json")
397	            self.assertEqual(resp.url, f"{v.url(1)}/")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
398	            time.sleep(2.5)
399	            resp = urllib.request.urlopen(f"{v.url()}/old.json")
400	            self.assertEqual(resp.url, f"{v.url(1)}/")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
411	                time.sleep(0.5)
412	                resp = urllib.request.urlopen(v.url())
413	                self.assertEqual(resp.code, 200)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
415	                    time.sleep(0.02)
416	                    resp = urllib.request.urlopen(f"{v.url()}/{i}.json")
417	                    self.assertEqual(resp.code, 200)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
417	                    self.assertEqual(resp.code, 200)
418	                    self.assertRegex(resp.url, "http://127.0.0.1:90[0-1][0-9]/")
419	        finally:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/viztracer-1.0.3/viztracer-1.0.3/tests/test_viewer.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
419	        finally:
420	            shutil.rmtree(tmp_dir)
421	

--------------------------------------------------

Code scanned:
	Total lines of code: 7812
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 143.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 157.0
		High: 11.0
Files skipped (0):
