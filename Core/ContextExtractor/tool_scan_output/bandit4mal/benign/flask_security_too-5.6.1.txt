Run started:2025-04-12 11:28:31.701975

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	intersphinx_mapping = {
122	    "python": ("https://docs.python.org/3/", None),
123	    "werkzeug": ("https://werkzeug.palletsprojects.com/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	    "python": ("https://docs.python.org/3/", None),
123	    "werkzeug": ("https://werkzeug.palletsprojects.com/", None),
124	    "flask": ("https://flask.palletsprojects.com/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	    "werkzeug": ("https://werkzeug.palletsprojects.com/", None),
124	    "flask": ("https://flask.palletsprojects.com/", None),
125	    "itsdangerous": ("https://itsdangerous.palletsprojects.com/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	    "flask": ("https://flask.palletsprojects.com/", None),
125	    "itsdangerous": ("https://itsdangerous.palletsprojects.com/", None),
126	    "sqlalchemy": ("https://docs.sqlalchemy.org/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	    "itsdangerous": ("https://itsdangerous.palletsprojects.com/", None),
126	    "sqlalchemy": ("https://docs.sqlalchemy.org/", None),
127	    "wtforms": ("https://wtforms.readthedocs.io/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	    "sqlalchemy": ("https://docs.sqlalchemy.org/", None),
127	    "wtforms": ("https://wtforms.readthedocs.io/", None),
128	    "flask_wtforms": ("https://flask-wtf.readthedocs.io", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	    "wtforms": ("https://wtforms.readthedocs.io/", None),
128	    "flask_wtforms": ("https://flask-wtf.readthedocs.io", None),
129	    "flask_sqlalchemy": ("https://flask-sqlalchemy.palletsprojects.com/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	    "flask_wtforms": ("https://flask-wtf.readthedocs.io", None),
129	    "flask_sqlalchemy": ("https://flask-sqlalchemy.palletsprojects.com/", None),
130	    "flask_sqlalchemy_lite": (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	    "flask_sqlalchemy_lite": (
131	        "https://flask-sqlalchemy-lite.readthedocs.io/en/latest/",
132	        None,
133	    ),
134	    "flask_login": ("https://flask-login.readthedocs.io/en/latest/", None),
135	    "passlib": ("https://passlib.readthedocs.io/en/stable", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	    ),
134	    "flask_login": ("https://flask-login.readthedocs.io/en/latest/", None),
135	    "passlib": ("https://passlib.readthedocs.io/en/stable", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	    "flask_login": ("https://flask-login.readthedocs.io/en/latest/", None),
135	    "passlib": ("https://passlib.readthedocs.io/en/stable", None),
136	    "authlib": ("https://docs.authlib.org/en/latest/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	    "passlib": ("https://passlib.readthedocs.io/en/stable", None),
136	    "authlib": ("https://docs.authlib.org/en/latest/", None),
137	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	    "project_links": [
151	        ProjectLink("PyPI releases", "https://pypi.org/project/Flask-Security/"),
152	        ProjectLink("Source Code", "https://github.com/pallets-eco/flask-security/"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	        ProjectLink("PyPI releases", "https://pypi.org/project/Flask-Security/"),
152	        ProjectLink("Source Code", "https://github.com/pallets-eco/flask-security/"),
153	        ProjectLink(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	            "Issue Tracker",
155	            "https://github.com/pallets-eco/flask-security/issues/",
156	        ),
157	        ProjectLink(
158	            "Changes",
159	            "https://flask-security.readthedocs.io/en/stable/changelog.html",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/docs/conf.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	            "Changes",
159	            "https://flask-security.readthedocs.io/en/stable/changelog.html",
160	        ),
161	    ]
162	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/oauth/server/app.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	        return {
49	            "api_base_url": "https://graph.microsoft.com/",
50	            "server_metadata_url": "https://login.microsoftonline.com/"
51	            "8ad9bf45-2e93-4043-8f46-a6420c8e9d68/v2.0/"
52	            ".well-known/openid-configuration",
53	            "client_kwargs": {"scope": "openid email profile"},
54	        }
55	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/oauth/server/app.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	            "api_base_url": "https://graph.microsoft.com/",
50	            "server_metadata_url": "https://login.microsoftonline.com/"
51	            "8ad9bf45-2e93-4043-8f46-a6420c8e9d68/v2.0/"
52	            ".well-known/openid-configuration",
53	            "client_kwargs": {"scope": "openid email profile"},
54	        }
55	
56	    def fetch_identity_cb(self, oauth, token):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	    jresp = resp.json()
39	    rdata = jresp.get("response")
40	    if not rdata:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
58	
59	    resp = session.post(
60	        f"{server_url}/register",
61	        json={"email": email, "password": password},
62	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	
65	    resp = session.get(f"{server_url}/api/popmail")
66	    if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	    matcher = re.match(
73	        r".*(http://[^\s*]*).*", jbody["mail"], re.IGNORECASE | re.DOTALL
74	    )
75	    magic_link = matcher.group(1)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	    # this is json.
79	    resp = session.get(magic_link, allow_redirects=False)
80	    assert resp.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	    # reset freshness to show how that would work
88	    resp = session.get(f"{server_url}/api/resetfresh")
89	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
90	    csrf_token = session.cookies["XSRF-TOKEN"]
91	    resp = session.post(
92	        f"{server_url}/us-setup",
93	        json={"chosen_method": "us_phone_number", "phone": phone},
94	        headers={"X-XSRF-Token": csrf_token},
95	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
102	    # re-verify
103	    resp = session.post(
104	        f"{server_url}/us-verify",
105	        json={"passcode": password},
106	        headers={"X-XSRF-Token": csrf_token},
107	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
110	    # try again
111	    resp = session.post(
112	        f"{server_url}/us-setup",
113	        json={"chosen_method": "sms", "phone": phone},
114	        headers={"X-XSRF-Token": csrf_token},
115	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	
120	    resp = session.get(f"{server_url}/api/popsms")
121	    if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
125	    code = jbody["sms"].split()[-1].strip(".")
126	    resp = session.post(
127	        f"{server_url}/us-setup/{state}",
128	        json={"passcode": code},
129	        headers={"X-XSRF-Token": csrf_token},
130	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
135	    # Sign in using SMS code.
136	    session.post(
137	        f"{server_url}/us-signin/send-code",
138	        json={"identity": username, "chosen_method": "sms"},
139	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	    # Fetch code via test API
142	    resp = session.get(f"{server_url}/api/popsms")
143	    if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
147	    code = jbody["sms"].split()[-1].strip(".")
148	    resp = session.post(
149	        f"{server_url}/us-signin",
150	        json={"identity": username, "passcode": code},
151	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	    )
160	    server_url = "http://localhost:5002"
161	
162	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	        # verify confirmed and logged in
175	        resp = session.get(f"{server_url}/api/health")
176	        assert resp.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
183	        # Verify can sign in with SMS
184	        session.post(f"{server_url}/logout")
185	        sms_signin(server_url, session, username, myphone)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/examples/unified_signin/client/client.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	        # verify logged in
188	        resp = session.get(f"{server_url}/api/health")
189	        assert resp.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/oauth_provider.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	        return dict(
102	            access_token_url="https://github.com/login/oauth/access_token",
103	            access_token_params=None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/oauth_provider.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	            access_token_params=None,
104	            authorize_url="https://github.com/login/oauth/authorize",
105	            authorize_params=None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/oauth_provider.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	            authorize_params=None,
106	            api_base_url="https://api.github.com/",
107	            client_kwargs={"scope": "user:email"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/oauth_provider.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	        return dict(
119	            server_metadata_url="https://accounts.google.com/"
120	            ".well-known/openid-configuration",
121	            client_kwargs={"scope": "openid email profile"},

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/totp.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
156	                image.save(virtual_file)
157	                image_as_str = base64.b64encode(virtual_file.getvalue()).decode("ascii")
158	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/totp.py:157
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
156	                image.save(virtual_file)
157	                image_as_str = base64.b64encode(virtual_file.getvalue()).decode("ascii")
158	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/utils.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
345	    h = hmac.new(encode_string(salt), encode_string(password), hashlib.sha512)
346	    return base64.b64encode(h.digest())
347	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/utils.py:346
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
345	    h = hmac.new(encode_string(salt), encode_string(password), hashlib.sha512)
346	    return base64.b64encode(h.digest())
347	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/utils.py:1351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1350	    req = urllib.request.Request(
1351	        url=f"https://api.pwnedpasswords.com/range/{sha1[:5].upper()}",
1352	        headers={"User-Agent": "Flask-Security (Python)"},

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/flask_security/utils.py:1355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1354	    # Might raise HTTPError
1355	    with urllib.request.urlopen(req) as f:
1356	        response = f.read()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_async.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
81	            "Authorization": "Basic %s"
82	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
83	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_async.py:82
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
81	            "Authorization": "Basic %s"
82	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
83	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    data = dict(email="matt@lp.com", password="password")
84	    response = client.post("/login?next=http://google.com", data=data)
85	    assert get_message("INVALID_REDIRECT") in response.data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	    data = dict(email="matt@lp.com", password="password")
91	    response = client.post("/login?next=http://google.com", json=data)
92	    assert response.json["response"]["errors"][0].encode() == get_message(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	    data = dict(email="matt@lp.com", password="password")
99	    response = client.post("/login?next=http:///google.com", data=data)
100	    assert get_message("INVALID_REDIRECT") in response.data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	    data = dict(email="matt@lp.com", password="password")
153	    response = client.post("/login?next=http://sub.lp.com", data=data)
154	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	    assert response.status_code == 302
155	    assert response.location == "http://sub.lp.com"
156	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	    data = dict(email="matt@lp.com", password="password")
165	    response = client.post("http://auth.lp.com/login?next=http://lp.com", data=data)
166	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	    assert response.status_code == 302
167	    assert response.location == "http://lp.com"
168	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	    data = dict(email="matt@lp.com", password="password")
174	    response = client.post("/login?next=http://sub.lp.net", data=data)
175	    assert get_message("INVALID_REDIRECT") in response.data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	    data = dict(email="matt@lp.com", password="password")
181	    response = client.post("/login?next=http://sub.lp.com", data=data)
182	    assert get_message("INVALID_REDIRECT") in response.data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	    # not in subdomain allowed list
192	    response = client.post("/login?next=http://blog2.bigidea.org", data=data)
193	    assert get_message("INVALID_REDIRECT") in response.data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	
195	    response = client.post("/login?next=http://my.photo.bigidea.org/image", data=data)
196	    assert response.location == "http://my.photo.bigidea.org/image"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	    response = client.post("/login?next=http://my.photo.bigidea.org/image", data=data)
196	    assert response.location == "http://my.photo.bigidea.org/image"
197	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
204	    data = dict(email="matt@lp.com", password="password")
205	    response = client.post("/login?next=http://blog2.bigidea.org", data=data)
206	    assert get_message("INVALID_REDIRECT") in response.data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	    assert get_message("INVALID_REDIRECT") in response.data
207	    response = client.post("/login?next=http://bigidea.org/imin", data=data)
208	    assert response.location == "http://bigidea.org/imin"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
207	    response = client.post("/login?next=http://bigidea.org/imin", data=data)
208	    assert response.location == "http://bigidea.org/imin"
209	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	    response = client.post("/login", data=data)
220	    assert response.location == "http://blog.bigidea.org/post_login"
221	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	@pytest.mark.settings(
212	    post_login_view="http://blog.bigidea.org/post_login",
213	    redirect_base_domain="bigidea.org",

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
445	            "Authorization": "Basic %s"
446	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
447	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:446
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
445	            "Authorization": "Basic %s"
446	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
447	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
460	            "Authorization": "Basic %s"
461	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
462	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:461
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
460	            "Authorization": "Basic %s"
461	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
462	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
488	    authenticate(client)
489	    response = client.get("/logout?next=http://google.com")
490	    assert "google.com" not in response.location

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
761	            "Authorization": "Basic %s"
762	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
763	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:762
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
761	            "Authorization": "Basic %s"
762	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
763	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
778	            "Authorization": "Basic %s"
779	            % base64.b64encode(b"jill:password").decode("utf-8")
780	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:779
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
778	            "Authorization": "Basic %s"
779	            % base64.b64encode(b"jill:password").decode("utf-8")
780	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
789	            "Authorization": "Basic %s"
790	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
791	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:790
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
789	            "Authorization": "Basic %s"
790	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
791	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
801	            "Authorization": "Basic %s"
802	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8"),
803	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:802
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
801	            "Authorization": "Basic %s"
802	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8"),
803	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
830	            "Authorization": "Basic %s"
831	            % base64.b64encode(b"bogus:bogus").decode("utf-8")
832	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:831
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
830	            "Authorization": "Basic %s"
831	            % base64.b64encode(b"bogus:bogus").decode("utf-8")
832	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
845	            "Authorization": "Basic %s"
846	            % base64.b64encode(b"bogus:bogus").decode("utf-8"),
847	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:846
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
845	            "Authorization": "Basic %s"
846	            % base64.b64encode(b"bogus:bogus").decode("utf-8"),
847	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
861	            "Authorization": "Basic %s"
862	            % base64.b64encode(b"joe@lp.com:bogus").decode("utf-8")
863	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:862
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
861	            "Authorization": "Basic %s"
862	            % base64.b64encode(b"joe@lp.com:bogus").decode("utf-8")
863	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
874	            "Authorization": "Basic %s"
875	            % base64.b64encode(b"joe@lp.com:bogus").decode("utf-8")
876	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:875
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
874	            "Authorization": "Basic %s"
875	            % base64.b64encode(b"joe@lp.com:bogus").decode("utf-8")
876	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
886	        "Authorization": "Basic %s"
887	        % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
888	    }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:887
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
886	        "Authorization": "Basic %s"
887	        % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
888	    }

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:916
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
915	            "Authorization": "Basic %s"
916	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
917	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:916
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
915	            "Authorization": "Basic %s"
916	            % base64.b64encode(b"joe@lp.com:password").decode("utf-8")
917	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
932	            "Authorization": "Basic %s"
933	            % base64.b64encode(b"bogus:bogus").decode("utf-8")
934	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_basic.py:933
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
932	            "Authorization": "Basic %s"
933	            % base64.b64encode(b"bogus:bogus").decode("utf-8")
934	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_changeable.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
448	            "Authorization": "Basic %s"
449	            % base64.b64encode(b"matt@lp.com:password").decode("utf-8")
450	        },

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_changeable.py:449
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
448	            "Authorization": "Basic %s"
449	            % base64.b64encode(b"matt@lp.com:password").decode("utf-8")
450	        },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_configuration.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
34	        "/http",
35	        headers={"Authorization": "Basic %s" % base64.b64encode(b"joe@lp.com:bogus")},
36	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_configuration.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
34	        "/http",
35	        headers={"Authorization": "Basic %s" % base64.b64encode(b"joe@lp.com:bogus")},
36	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	
43	    response = client.get("/reset")
44	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	
51	    response = client.get("/login")
52	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	    authenticate(client)
60	    response = client.get("/verify")
61	    assert b"CUSTOM VERIFY USER" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	
70	    response = client.get("/register")
71	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
79	    with capture_reset_password_requests() as requests:
80	        response = client.post(
81	            "/reset", data=dict(email="joe@lp.com"), follow_redirects=True
82	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	    token = requests[0]["token"]
84	    response = client.get(f"/reset/{token}")
85	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	    authenticate(client)
93	    response = client.get("/change")
94	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	
101	    response = client.get("/confirm")
102	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	
109	    client.get("/logout")
110	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
110	
111	    client.post("/reset", data=dict(email="matt@lp.com"))
112	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	    authenticate(client)
122	    response = client.get("/change-email")
123	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	
130	    client.get("/logout")
131	    response = client.get("/recover-username")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	    client.get("/logout")
131	    response = client.get("/recover-username")
132	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	    authenticate(client)
140	    response = client.get("/change-username")
141	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
151	
152	    response = client.get("/login")
153	    assert b"bar-send-login" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	    authenticate(client)
175	    response = client.get("/tf-setup")
176	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	    tf_authenticate(app, client, validate=False)
185	    response = client.get("/tf-rescue")
186	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	    # signin template is used in 3 places (TODO test POST us-send-code)
207	    response = client.get("/us-signin")
208	    assert b"CUSTOM UNIFIED SIGN IN" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
211	
212	    response = client.post("/us-signin/send-code")
213	    assert b"CUSTOM UNIFIED SIGN IN" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
221	    us_authenticate(client)
222	    response = client.get("us-setup")
223	    assert b"CUSTOM UNIFIED SIGNIN SETUP" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
226	
227	    response = client.post("us-setup", data=dict(chosen_method="sms", phone="555-1212"))
228	    assert b"CUSTOM UNIFIED SIGNIN SETUP" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	    us_authenticate(client)
237	    response = client.get("us-verify")
238	    assert b"CUSTOM UNIFIED VERIFY" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
241	
242	    response = client.post(
243	        "us-verify", data=dict(chosen_method="sms", phone="555-1212")
244	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	    authenticate(client)
266	    response = client.get("/mf-recovery-codes")
267	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_context_processors.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	    authenticate(client, "gal@lp.com")
276	    response = client.get("/mf-recovery")
277	    assert b"global" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
98	    client = app.test_client()
99	    client.post("/reset", data=dict(email="matt@lp.com"))
100	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	    client = app.test_client()
107	    response = client.get("/login")
108	    assert response.status_code == 404

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	
155	    response = client.get("/login")
156	    assert b"My Login Username Field" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	
158	    response = client.get("/register")
159	    assert b"My Register Email Address Field" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	
161	    response = client.get("/reset")
162	    assert b"My Forgot Email Address Field" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
164	    with capture_reset_password_requests() as requests:
165	        response = client.post("/reset", data=dict(email="matt@lp.com"))
166	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	    token = requests[0]["token"]
168	    response = client.get("/reset/" + token)
169	    assert b"My Reset Password Field" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	
173	    response = client.get("/change")
174	    assert b"My Change Password Field" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	
199	    response = client.get("/register")
200	    assert b"My Register Email Address Field" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	
202	    response = client.get("/confirm")
203	    assert b"My Send Confirmation Email Address Field" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	
220	    response = client.get("/login")
221	    assert b"My Passwordless Email Address Field" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
233	
234	    response = client.get("/logout", follow_redirects=True)
235	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
243	
244	    response = client.post("/logout", follow_redirects=True)
245	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	
262	    response = client.get("/logout", follow_redirects=True)
263	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
265	
266	    response = client.post("/logout", follow_redirects=True)
267	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	    client = app.test_client()
285	    response = client.get("/profile")
286	    assert get_message("LOGIN") not in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
315	
316	    response = client.post(
317	        "/login", data=dict(email="matt@lp.com", password="password")
318	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	
321	    response = client.get("/logout")
322	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
322	
323	    response = client.post(
324	        "/login", data=dict(email="matt@lp.com", password="password")
325	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
378	    client = app.test_client()
379	    response = client.get("/login")
380	    assert b"My Login Email Address Field" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
381	
382	    response = client.get("/register")
383	    assert b"My Register Email Address Field" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
461	    csrf_token = get_csrf_token(client)
462	    response = client.post(
463	        "/login",
464	        data=dict(email="matt@lp.com", password="password", csrf_token=csrf_token),
465	        follow_redirects=True,
466	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
471	    csrf_token = get_csrf_token(client)
472	    response = client.post(
473	        "/login",
474	        data=dict(email="joe@lp.com", password="password", csrf_token=csrf_token),
475	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
501	
502	    response = client.post("/login", content_type="application/json")
503	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
523	
524	    response = client.post("/login", content_type="application/json")
525	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
535	    app.config["BABEL_DEFAULT_LOCALE"] = "fr_FR"
536	    response = client.get("/login")
537	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
614	
615	    response = client.get("/login")
616	    assert b'<label for="password">Mot de passe</label>' in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
642	    client = app.test_client()
643	    response = client.post("/login", data=dict(email="matt@lp.com", password="forgot"))
644	    assert b"Passe - no-worky" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
663	    client = app.test_client()
664	    response = client.post("/login", data=dict(email="matt@lp.com", password="forgot"))
665	    assert b"Passe - no-worky" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
708	    client = app.test_client()
709	    response = client.get("/login")
710	    assert b'<label for="password">Mot de passe</label>' in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
713	    )
714	    response = client.post(
715	        "/login", json=data, headers={"Content-Type": "application/json"}
716	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
736	        if "lang" not in session:
737	            locale = request.args.get("lang", None)
738	            if not locale:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
741	                session["lang"] = locale
742	        return session.get("lang", None).replace("-", "_")
743	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
746	
747	    response = client.get("/login", headers=[("Accept-Language", "fr")])
748	    assert b'<label for="password">Mot de passe</label>' in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
752	    data = dict(email="matt@lp.com", password="", remember="y")
753	    response = client.post("/login", data=data, headers=[("Accept-Language", "fr")])
754	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
760	    data = dict(email="matt@lp.com", password="password", remember="y")
761	    response = client.post(
762	        "/login", data=data, headers=[("Accept-Language", "fr")], follow_redirects=True
763	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
766	    # make sure further requests always get correct xlation w/o sending header
767	    response = client.get("/change", follow_redirects=True)
768	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
772	    # try JSON
773	    response = client.post(
774	        "/change",
775	        json=dict(email="matt@lp.com"),
776	        headers={"Content-Type": "application/json"},
777	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
922	
923	    response = client.get("/myview", follow_redirects=False)
924	    # should require login

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
928	    authenticate(client)
929	    response = client.get("/myview")
930	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
980	    # This should work and not be redirected
981	    response = client.get("/myview", follow_redirects=False)
982	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
986	    with capture_flashes() as flashes:
987	        response = client.get("/myspecialview", follow_redirects=False)
988	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
995	    # Test json error response
996	    response = client.get("/myspecialview", headers={"accept": "application/json"})
997	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1027
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1026	    # This should work and not be redirected
1027	    response = client.get("/myview", follow_redirects=False)
1028	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1032
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1031	    time.sleep(0.1)
1032	    response = client.get("/myspecialview", follow_redirects=False)
1033	    assert response.status_code == 500

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1036
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1035	    # Test json error response
1036	    response = client.get("/myspecialview", headers={"accept": "application/json"})
1037	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1049	    # This should work and not be redirected
1050	    response = client.get("/myview", follow_redirects=False)
1051	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1067
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1066	    reset_fresh(client, within=timedelta(minutes=1))
1067	    response = client.get("/myview", follow_redirects=False)
1068	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1087
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1086	    # This should work and not be redirected
1087	    response = client.get("/myview", follow_redirects=False)
1088	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1092
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1091	    time.sleep(0.1)
1092	    response = client.get("/myspecialview", follow_redirects=False)
1093	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1108	    # This should fail - should be a redirect
1109	    response = client_nc.get("/myview", headers=h, follow_redirects=False)
1110	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1126	    # This should fail - should be a redirect
1127	    response = client_nc.get("/myview", headers=h, follow_redirects=False)
1128	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1140	    # This should work
1141	    response = client_nc.get("/tf-setup", json={}, headers=h)
1142	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1144	
1145	    response = client_nc.get("/mf-recovery-codes", json={}, headers=h)
1146	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1155	    with capture_flashes() as flashes:
1156	        response = client.get("/fresh", follow_redirects=True)
1157	        assert b"Reauthenticate" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1168	    reset_fresh(client, app.config["SECURITY_FRESHNESS"])
1169	    response = client.get(verify_url)
1170	    assert b"Reauthenticate" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1171	
1172	    response = client.post(
1173	        verify_url, data=dict(password="not my password"), follow_redirects=False
1174	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1176	
1177	    response = client.post(
1178	        verify_url, data=dict(password="password"), follow_redirects=False
1179	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1182	    # should be fine now
1183	    response = client.get("/fresh", follow_redirects=True)
1184	    assert b"Fresh Only" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1192	    reset_fresh(client, app.config["SECURITY_FRESHNESS"])
1193	    response = client.get("/fresh", headers=headers)
1194	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1196	
1197	    response = client.get("/verify")
1198	    assert b"Reauthenticate" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1199	
1200	    response = client.post(
1201	        "/verify", json=dict(password="not my password"), headers=headers
1202	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1204	
1205	    response = client.post("/verify", json=dict(password="password"), headers=headers)
1206	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1208	    # should be fine now
1209	    response = client.get("/fresh", headers=headers)
1210	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1223	    )
1224	    response = client.post(
1225	        "/change",
1226	        json=data,
1227	        headers={"Content-Type": "application/json"},
1228	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1230	
1231	    response = client.post(
1232	        "/verify",
1233	        json=dict(password="new strong password\N{ROMAN NUMERAL ONE}"),
1234	        headers=headers,
1235	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1237	
1238	    response = client.post(
1239	        "/verify",
1240	        json=dict(password="new strong password\N{LATIN CAPITAL LETTER I}"),
1241	        headers=headers,
1242	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1248	    authenticate(client)
1249	    response = client.post(
1250	        "/auth/?next=http://localhost/mynext",
1251	        data=dict(password="password"),
1252	        follow_redirects=False,
1253	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1249	    response = client.post(
1250	        "/auth/?next=http://localhost/mynext",
1251	        data=dict(password="password"),
1252	        follow_redirects=False,
1253	    )
1254	    assert response.location == "http://localhost/mynext"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1253	    )
1254	    assert response.location == "http://localhost/mynext"
1255	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1265	    reset_fresh(client, app.config["SECURITY_FRESHNESS"])
1266	    response = client.get("/fresh", headers=headers)
1267	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1271	    # the verify form should have the webauthn verify form attached
1272	    response = client.get("verify")
1273	    assert b'action="/wan-verify"' in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1275	    app.config["SECURITY_WAN_ALLOW_AS_VERIFY"] = None
1276	    response = client.get("/fresh", headers=headers)
1277	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1281	    # the verify form should NOT have the webauthn verify form attached
1282	    response = client.get("verify")
1283	    assert b'action="/wan-verify"' not in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1298	    authenticate(client)
1299	    response = client.get("/myview", headers=headers)
1300	    assert response.status_code == 403

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1304	    authenticate(client, email="jill@lp.com")
1305	    response = client.get("/myview", headers=headers)
1306	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1320	    # This should work and not be redirected
1321	    response = client.get("/myview", follow_redirects=False)
1322	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1328	
1329	    response = client.post(
1330	        "/login", data=dict(email="matt@lp.com", password="password")
1331	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1334	
1335	    response = client.get("/logout")
1336	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1351	
1352	    response = client.post(
1353	        "/login", data=dict(email="matt@lp.com", password="password")
1354	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1357	
1358	    response = client.get("/logout")
1359	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1378	        data = dict(email="matt@lp.com", password="password", next=i)
1379	        response = client.post("/login", data=data, follow_redirects=False)
1380	        if response.status_code == 302:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1435	    init_app_with_options(app, sqlalchemy_datastore)
1436	    with app.test_request_context("http://localhost:5001/login"):
1437	        static_url = url_for_security("static", filename="js/webauthn.js")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1483	    )
1484	    response = client.post("/register", json=data)
1485	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1490	    # login should work since we are just checking for identity
1491	    response = client.post(
1492	        "/login", data=dict(email="matt@lp.com", password="password")
1493	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1508	
1509	    client.post("/login", data=dict(email="matt@lp.com", password="password"))
1510	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1510	
1511	    client.post("/login", json=dict(noemail="matt@lp.com", password="password"))
1512	    time.sleep(5)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1523	
1524	    response = client.get("/loginreq", follow_redirects=False)
1525	    assert response.location == "/login?next=/loginreq"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1526	
1527	    response = client.get("/loginreq", follow_redirects=True)
1528	    assert get_message("UNAUTHENTICATED") in response.data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1533	
1534	    s = simplify_url("https://localhost/profile", "https://localhost/login")
1535	    assert s == "/login"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1533	
1534	    s = simplify_url("https://localhost/profile", "https://localhost/login")
1535	    assert s == "/login"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1535	    assert s == "/login"
1536	    s = simplify_url("https:/myhost/profile", "https://localhost/login")
1537	    assert s == "https://localhost/login"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1536	    s = simplify_url("https:/myhost/profile", "https://localhost/login")
1537	    assert s == "https://localhost/login"
1538	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1585	
1586	    response = client.get("/login", follow_redirects=False)
1587	    assert not get_form_input(response, "email")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1588	
1589	    response = client.post(
1590	        "/login", json=dict(email="jill@lp.com", password="password")
1591	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_misc.py:1598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1597	
1598	    response = client.post("/login", json=dict(username="jill", password="password"))
1599	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
37	    # Test disabled account
38	    response = client.post(
39	        "/login", data=dict(email="tiya@lp.com"), follow_redirects=True
40	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
44	    data = dict(email="matt@lp.com")
45	    response = client.post(
46	        "/login", json=data, headers={"Content-Type": "application/json"}
47	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
53	    data = dict(email="nobody@lp.com")
54	    response = client.post(
55	        "/login", json=data, headers={"Content-Type": "application/json"}
56	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
60	    with capture_passwordless_login_requests() as requests:
61	        response = client.post(
62	            "/login", data=dict(email="matt@lp.com"), follow_redirects=True
63	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	    token = requests[0]["login_token"]
75	    response = client.get("/login/" + token, follow_redirects=True)
76	    assert get_message("PASSWORDLESS_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	    # Test already authenticated
79	    response = client.get("/login/" + token, follow_redirects=True)
80	    assert get_message("PASSWORDLESS_LOGIN_SUCCESSFUL") not in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	    # Test invalid token
85	    response = client.get("/login/bogus", follow_redirects=True)
86	    assert get_message("INVALID_LOGIN_TOKEN") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
88	    # Test login request with invalid email
89	    response = client.post("/login", data=dict(email="bogus@bogus.com"))
90	    assert get_message("USER_DOES_NOT_EXIST") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
97	    with capture_passwordless_login_requests() as requests:
98	        client.post("/login", data=dict(email="joe@lp.com"), follow_redirects=True)
99	        outbox = app.mail.outbox

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	        link = matcher[0].split(":", 1)[1]
109	        response = client.get(link, follow_redirects=True)
110	        assert get_message("PASSWORDLESS_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
118	        with freeze_time(date.today() + timedelta(days=-1)):
119	            client.post("/login", data=dict(email=e), follow_redirects=True)
120	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	
124	    response = client.get("/login/" + token, follow_redirects=True)
125	    assert (

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
142	        with capture_passwordless_login_requests() as requests:
143	            response = client.post(
144	                "/login",
145	                json=dict(email="matt@lp.com"),
146	                headers={"Content-Type": "application/json"},
147	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	
151	        response = client.get("/login/" + token)
152	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
172	            with freeze_time(date.today() + timedelta(days=-1)):
173	                response = client.post(
174	                    "/login",
175	                    json=dict(email="matt@lp.com"),
176	                    headers={"Content-Type": "application/json"},
177	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	
181	        response = client.get("/login/" + token)
182	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_passwordless.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	        )
198	        response = client.get("/login/" + token)
199	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	    # Test the reset view
57	    response = clients.get("/reset")
58	    assert b"<h1>Send password reset instructions</h1>" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
62	    with capture_reset_password_requests() as requests:
63	        response = clients.post(
64	            "/reset", data=dict(email="joe@lp.com"), follow_redirects=True
65	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	    # Test view for reset token
74	    response = clients.get("/reset/" + token)
75	    assert b"<h1>Reset password</h1>" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
77	    # Test submitting a new password but leave out confirm
78	    response = clients.post(
79	        "/reset/" + token, data={"password": "newpassword"}, follow_redirects=True
80	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
84	    # Test submitting a new password
85	    response = clients.post(
86	        "/reset/" + token,
87	        data={"password": "awesome sunset", "password_confirm": "awesome sunset"},
88	        follow_redirects=True,
89	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
104	    # Test invalid email
105	    response = clients.post(
106	        "/reset", data=dict(email="bogus@lp.com"), follow_redirects=True
107	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
112	    # Test invalid token
113	    response = clients.post(
114	        "/reset/bogus",
115	        data={"password": "awesome sunset", "password_confirm": "awesome sunset"},
116	        follow_redirects=True,
117	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
125	    )
126	    response = clients.post(
127	        "/reset/" + token,
128	        data={"password": "newpassword", "password_confirm": "newpassword"},
129	        follow_redirects=True,
130	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
138	    data = dict(email="jyl@lp.com", password="awesome sunset")
139	    clients.post("/register", data=data)
140	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
140	
141	    response = clients.post(
142	        "/reset", data=dict(email="jyl@lp.com"), follow_redirects=True
143	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
163	        with capture_reset_password_requests() as requests:
164	            response = client.post(
165	                "/reset",
166	                json=dict(email="joe@lp.com"),
167	                headers={"Content-Type": "application/json"},
168	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
176	        # Test invalid email
177	        response = client.post(
178	            "/reset",
179	            json=dict(email="whoknows@lp.com"),
180	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
186	        # Test submitting a new password but leave out 'confirm'
187	        response = client.post(
188	            "/reset/" + token,
189	            json=dict(password="newpassword"),
190	            headers={"Content-Type": "application/json"},
191	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
197	        # Test submitting a new password
198	        response = client.post(
199	            "/reset/" + token + "?include_auth_token",
200	            json=dict(password="awesome sunset", password_confirm="awesome sunset"),
201	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
208	        # Test logging in with the new password
209	        response = client.post(
210	            "/login?include_auth_token",
211	            json=dict(email="joe@lp.com", password="awesome sunset"),
212	            headers={"Content-Type": "application/json"},
213	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
221	        # Use token again - should fail since already have set new password.
222	        response = client.post(
223	            "/reset/" + token,
224	            json=dict(password="newpassword", password_confirm="newpassword"),
225	            headers={"Content-Type": "application/json"},
226	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
230	        # Test invalid token
231	        response = client.post(
232	            "/reset/bogus",
233	            json=dict(password="newpassword", password_confirm="newpassword"),
234	            headers={"Content-Type": "application/json"},
235	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
246	    with capture_reset_password_requests() as resets:
247	        response = client.post(
248	            "/reset", data=dict(email="joe@lp.com"), follow_redirects=True
249	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	        link = matcher[0].split(":", 1)[1]
260	        response = client.get(link, follow_redirects=True)
261	        assert b"Reset Password" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	    authenticate(other_client)
269	    response = other_client.get("/profile", follow_redirects=True)
270	    assert b"Profile Page" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
273	    with capture_reset_password_requests() as requests:
274	        response = client.post(
275	            "/reset",
276	            json=dict(email="matt@lp.com"),
277	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
283	    # Test submitting a new password
284	    response = client.post(
285	        "/reset/" + token + "?include_auth_token",
286	        json=dict(password="awesome sunset", password_confirm="awesome sunset"),
287	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
290	    # try to access protected endpoint with old session - shouldn't work
291	    response = other_client.get("/profile")
292	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
308	        with capture_reset_password_requests() as requests:
309	            client.post("/reset", data=dict(email="joe@lp.com"), follow_redirects=True)
310	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
319	        # Test getting reset form with expired token
320	        response = client.get("/reset/" + token, follow_redirects=True)
321	        assert msg in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
323	        # Test trying to reset password with expired token
324	        response = client.post(
325	            "/reset/" + token,
326	            data={"password": "newpassword", "password_confirm": "newpassword"},
327	            follow_redirects=True,
328	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
335	    # Test invalid token - get form
336	    response = client.get("/reset/bogus", follow_redirects=True)
337	    assert get_message("INVALID_RESET_PASSWORD_TOKEN") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
339	    # Test invalid token - reset password
340	    response = client.post(
341	        "/reset/bogus",
342	        data={"password": "newpassword", "password_confirm": "newpassword"},
343	        follow_redirects=True,
344	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
352	    )
353	    response = client.post(
354	        "/reset/" + token,
355	        data={"password": "newpassword", "password_confirm": "newpassword"},
356	        follow_redirects=True,
357	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
362	    with capture_reset_password_requests() as requests:
363	        client.post("/reset", data=dict(email="gene@lp.com"), follow_redirects=True)
364	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
373	
374	    response = client.post(
375	        "/reset/" + token,
376	        data={"password": "newpassword", "password_confirm": "newpassword"},
377	        follow_redirects=True,
378	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
385	    with capture_reset_password_requests() as requests:
386	        client.post("/reset", data=dict(email="joe@lp.com"), follow_redirects=True)
387	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
390	    # use the token
391	    response = client.post(
392	        "/reset/" + token,
393	        data={"password": "awesome sunset", "password_confirm": "awesome sunset"},
394	        follow_redirects=True,
395	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
401	    # attempt to use it a second time
402	    response2 = client.post(
403	        "/reset/" + token,
404	        data={"password": "otherpassword", "password_confirm": "otherpassword"},
405	        follow_redirects=True,
406	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
413	    with capture_reset_password_requests() as requests:
414	        client.post("/reset", data=dict(email="jess@lp.com"), follow_redirects=True)
415	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
418	    # use the token
419	    response = client.post(
420	        "/reset/" + token,
421	        data={"password": "awesome sunset", "password_confirm": "awesome sunset"},
422	        follow_redirects=True,
423	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
429	def test_custom_reset_url(client):
430	    response = client.get("/custom_reset")
431	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
438	def test_custom_reset_templates(client):
439	    response = client.get("/reset")
440	    assert b"CUSTOM FORGOT PASSWORD" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
442	    with capture_reset_password_requests() as requests:
443	        client.post("/reset", data=dict(email="joe@lp.com"), follow_redirects=True)
444	        token = requests[0]["token"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	
446	    response = client.get("/reset/" + token)
447	    assert b"CUSTOM RESET PASSWORD" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
460	    with capture_reset_password_requests() as requests:
461	        response = client.post(
462	            "/reset",
463	            json=dict(email="joe@lp.com"),
464	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
468	
469	    response = client.get("/reset/" + token)
470	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
491	            with capture_reset_password_requests() as requests:
492	                response = client.post(
493	                    "/reset",
494	                    json=dict(email="joe@lp.com"),
495	                    headers={"Content-Type": "application/json"},
496	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	
501	        response = client.get("/reset/" + token)
502	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
522	        )
523	        response = client.get("/reset/" + token)
524	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
539	    with capture_reset_password_requests() as requests:
540	        client.post("/reset", data=dict(email="joe@lp.com"), follow_redirects=True)
541	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
544	    # use the token
545	    response = client.post(
546	        "/reset/" + token,
547	        data={"password": "mypassword", "password_confirm": "mypassword"},
548	        follow_redirects=True,
549	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
554	def test_reset_inactive(client, get_message):
555	    response = client.post(
556	        "/reset", data=dict(email="tiya@lp.com"), follow_redirects=True
557	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
559	
560	    response = client.post(
561	        "/reset",
562	        json=dict(email="tiya@lp.com"),
563	        headers={"Content-Type": "application/json"},
564	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
568	def test_email_normalization(client, get_message):
569	    response = client.post(
570	        "/reset", data=dict(email="joe@LP.COM"), follow_redirects=True
571	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
577	    with capture_reset_password_requests() as requests:
578	        response = client.post(
579	            "/reset",
580	            json=dict(email="matt@lp.com"),
581	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
584	
585	    response = client.post(
586	        "/reset/" + token,
587	        json=dict(password="HheHhe", password_confirm="HheHhe"),
588	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
592	    # make sure can log in with new password both normalized or not
593	    response = client.post(
594	        "/login",
595	        json=dict(email="matt@lp.com", password="HheHhe"),
596	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
598	    # verify actually logged in
599	    response = client.get("/profile", follow_redirects=False)
600	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
602	
603	    response = client.post(
604	        "/login",
605	        json=dict(email="matt@lp.com", password="Ho\u0308heHo\u0308he"),
606	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
608	    # verify actually logged in
609	    response = client.get("/profile", follow_redirects=False)
610	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
615	    # try unknown user
616	    response = client.post("/reset", data=dict(email="whoami@test.com"))
617	    assert (

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
620	
621	    response = client.post("/reset", json=dict(email="whoami@test.com"))
622	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
648	    with capture_flashes() as flashes:
649	        response = client.post("/reset", data=bad_data)
650	        assert b"Field must be at least 5" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
652	    with capture_flashes() as flashes:
653	        response = client.post("/reset", data=good_data)
654	    assert len(flashes) == 1

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
657	    with capture_flashes() as flashes:
658	        response = client.post("/reset", json=bad_data)
659	        assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
665	    with capture_flashes() as flashes:
666	        response = client.post("/reset", json=good_data)
667	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
672	    with capture_flashes() as flashes:
673	        response = client.post("/reset", data=bad_data)
674	        assert b"Field must be at least 5" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
676	    with capture_flashes() as flashes:
677	        response = client.post("/reset", json=bad_data)
678	        assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
691	    with capture_reset_password_requests() as requests:
692	        response = client.post(
693	            "/reset", data=dict(email="joe@lp.com"), follow_redirects=True
694	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
699	    with capture_flashes() as flashes:
700	        response = client.post(
701	            "/reset/" + token,
702	            data=dict(password="awesome sunset", password_confirm="awesome sunset"),
703	            follow_redirects=True,
704	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
709	    # verify actually logged in
710	    response = client.get("/profile", follow_redirects=False)
711	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
718	    with capture_reset_password_requests() as requests:
719	        response = client.post(
720	            "/reset",
721	            json=dict(email="joe@lp.com"),
722	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
728	    # Test submitting a new password
729	    response = client.post(
730	        "/reset/" + token + "?include_auth_token",
731	        json=dict(password="awesome sunset", password_confirm="awesome sunset"),
732	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
737	    # verify actually logged in
738	    response = client.get("/profile", follow_redirects=False)
739	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
757	    with capture_reset_password_requests() as requests:
758	        response = client.post(
759	            "/reset",
760	            json=dict(email="joe@lp.com"),
761	            headers={"Content-Type": "application/json"},
762	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
768	    # Test submitting a new password
769	    response = client.post(
770	        "/reset/" + token + "?include_auth_token",
771	        json=dict(password="awesome sunset", password_confirm="awesome sunset"),
772	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
779	def test_csrf(app, client, get_message):
780	    response = client.get("/reset")
781	    csrf_token = get_form_input_value(response, "csrf_token")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
782	    with capture_reset_password_requests() as requests:
783	        client.post(
784	            "/reset",
785	            data=dict(email="joe@lp.com", csrf_token=csrf_token),
786	            follow_redirects=True,
787	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:792
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
791	    data = {"password": "mypassword", "password_confirm": "mypassword"}
792	    response = client.post(
793	        "/reset/" + token,
794	        data=data,
795	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
798	    data["csrf_token"] = csrf_token
799	    response = client.post(f"/reset/{token}", data=data)
800	    assert check_location(app, response.location, "/post_reset_view")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
813	    # Test the username recovery view
814	    response = clients.get("/recover-username")
815	    assert b"<h1>Username Recovery</h1>" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
816	
817	    response = clients.post(
818	        "/recover-username", data=dict(email="joe@lp.com"), follow_redirects=True
819	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
825	    with capture_flashes() as flashes:
826	        response = clients.post(
827	            "/recover-username",
828	            data=dict(email="joe@lp.com"),
829	            follow_redirects=True,
830	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
840	    # Test JSON responses
841	    response = clients.post(
842	        "/recover-username",
843	        json=dict(email="joe@lp.com"),
844	        headers={"Content-Type": "application/json"},
845	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
851	def test_username_recovery_invalid_email(app, clients):
852	    response = clients.post(
853	        "/recover-username", data=dict(email="bogus@lp.com"), follow_redirects=True
854	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
859	    # Test JSON responses
860	    response = clients.post(
861	        "/recover-username",
862	        json=dict(email="bogus@lp.com"),
863	        headers={"Content-Type": "application/json"},
864	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
884	    with capture_flashes() as flashes:
885	        response = clients.post(
886	            "/recover-username",
887	            data=dict(email="joe@lp.com"),
888	            follow_redirects=True,
889	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
899	    with capture_flashes() as flashes:
900	        response = clients.post(
901	            "/recover-username",
902	            data=dict(email="bogus@lp.com"),
903	            follow_redirects=True,
904	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
914	    # Test JSON responses - valid email
915	    response = clients.post(
916	        "/recover-username",
917	        json=dict(email="joe@lp.com"),
918	        headers={"Content-Type": "application/json"},
919	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_recoverable.py:924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
923	    # Test JSON responses - invalid email
924	    response = clients.post(
925	        "/recover-username",
926	        json=dict(email="bogus@lp.com"),
927	        headers={"Content-Type": "application/json"},
928	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_registerable.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
201	            " address.",
202	            confirmation_link=f"http://localhost/confirm/{confirmation_token[0]}",
203	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	    # returns list of validation errors
43	    t = client.get(name)
44	    if t.status_code != 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
49	def check_template_rdata(name, r, rdata):
50	    vout = r.post("https://validator.w3.org/nu/?out=json", rdata)
51	    if vout.status_code == 429:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	def check_template_rdata(name, r, rdata):
50	    vout = r.post("https://validator.w3.org/nu/?out=json", rdata)
51	    if vout.status_code == 429:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
53	        sleep(2.0)
54	        vout = r.post("https://validator.w3.org/nu/?out=json", rdata)
55	        if vout.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        sleep(2.0)
54	        vout = r.post("https://validator.w3.org/nu/?out=json", rdata)
55	        if vout.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	    # since we get rate limited - use external pytest option to specify
79	    totry = app.config.get("TEMPLATES", "").split(",")
80	    rsession = requests.session()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	    authenticate(client, csrf=True)
108	    response = client.get("/change")
109	    csrf_token = get_form_input_value(response, "csrf_token")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	        if t == "US_SETUP":
121	            response = client.get("/us-setup")
122	            csrf_token = get_form_input_value(response, "csrf_token")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
122	            csrf_token = get_form_input_value(response, "csrf_token")
123	            response = client.post(
124	                "us-setup",
125	                data=dict(chosen_method="authenticator", csrf_token=csrf_token),
126	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	        if t == "TWO_FACTOR_SETUP":
130	            response = client.get("/tf-setup")
131	            csrf_token = get_form_input_value(response, "csrf_token")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
131	            csrf_token = get_form_input_value(response, "csrf_token")
132	            response = client.post(
133	                "tf-setup",
134	                data=dict(setup="authenticator", csrf_token=csrf_token),
135	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
155	    # since we get rate limited - use external pytest option to specify
156	    totry = app.config.get("TEMPLATES", "").split(",")
157	    if "CONFIRM" in totry:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	    # since we get rate limited - use external pytest option to specify
169	    totry = app.config.get("TEMPLATES", "").split(",")
170	    if "RESET" in totry:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	        with capture_reset_password_requests() as resets:
173	            response = client.get("/reset")
174	            csrf_token = get_form_input_value(response, "csrf_token")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
174	            csrf_token = get_form_input_value(response, "csrf_token")
175	            client.post("/reset", data=dict(email="joe@lp.com", csrf_token=csrf_token))
176	        token = resets[0]["token"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
188	    # since we get rate limited - use external pytest option to specify
189	    totry = app.config.get("TEMPLATES", "").split(",")
190	    if "TWO_FACTOR_RESCUE" in totry:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_templates.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	        authenticate(client, csrf=True)
192	        response = client.get("/tf-setup")
193	        csrf_token = get_form_input_value(response, "csrf_token")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_trackable.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
29	    logout(client)
30	    authenticate(client, email=e, headers={"X-Forwarded-For": "127.0.0.1"})
31	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_trackable.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
36	        assert user.last_login_ip == _client_ip(client)
37	        assert user.current_login_ip == "127.0.0.1"
38	        assert user.login_count == 2

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_trackable.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
57	        assert user.last_login_ip == _client_ip(client)
58	        assert user.current_login_ip == "88.88.88.88"
59	        assert user.login_count == 2

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_trackable.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
86	    data = dict(email=e, password="password", remember="y")
87	    client.post("/login_custom", data=data, headers={"X-Forwarded-For": "127.0.0.1"})
88	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_trackable.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
93	        assert user.last_login_ip == _client_ip(client)
94	        assert user.current_login_ip == "127.0.0.1"
95	        assert user.login_count == 2

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	    json_data = dict(email="gal@lp.com", password="password", remember=remember)
57	    response = client.post(
58	        "/login", json=json_data, headers={"Content-Type": "application/json"}
59	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
66	        if json:
67	            response = client.post(
68	                "/tf-validate",
69	                json=dict(code=code),
70	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
72	        else:
73	            response = client.post(
74	                "/tf-validate", data=dict(code=code), follow_redirects=True
75	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
100	    data = dict(email="gal@lp.com", password="password")
101	    response = client.post("/login", data=data, follow_redirects=True)
102	    assert b"Welcome gal@lp.com" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
106	    data = dict(email="gal2@lp.com", password="password")
107	    response = client.post("/login", data=data, follow_redirects=True)
108	    assert b"Please enter your authentication code" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
116	    data = dict(email="gal@lp.com", password="password")
117	    response = client.post(
118	        "/login",
119	        json=data,
120	        follow_redirects=True,
121	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
127	    data["email"] = "gal2@lp.com"
128	    response = client.post(
129	        "/login",
130	        json=data,
131	        follow_redirects=True,
132	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
144	    data = dict(email="gal@lp.com", password="password")
145	    response = client.post("/login", data=data, follow_redirects=True)
146	    assert b"Please enter your authentication code" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
153	    data = dict(email="gal@lp.com", password="password")
154	    response = client.post(
155	        "/login",
156	        json=data,
157	        follow_redirects=True,
158	        headers={"Content-Type": "application/json"},
159	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
174	    data = dict(email="gal@lp.com", password="password")
175	    response = client.post("/login", data=data, follow_redirects=True)
176	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
182	    data = dict(email="gal@lp.com", password="password")
183	    response = client.post(
184	        "/login",
185	        json=data,
186	        follow_redirects=True,
187	        headers={"Content-Type": "application/json"},
188	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
204	    data = dict(email="gal@lp.com", password="password")
205	    response = client.post("/login", data=data, follow_redirects=True)
206	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
217	    data = dict(email="gal@lp.com", password="password")
218	    response = client.post(
219	        "/login",
220	        json=data,
221	        follow_redirects=True,
222	        headers={"Content-Type": "application/json"},
223	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
239	    data = dict(email="gal@lp.com", password="password")
240	    response = client.post("/login", data=data, follow_redirects=True)
241	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
252	    data = dict(email="gal@lp.com", password="password")
253	    response = client.post(
254	        "/login",
255	        json=data,
256	        follow_redirects=True,
257	        headers={"Content-Type": "application/json"},
258	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
269	    with capture_flashes() as flashes:
270	        response = client.post("/tf-setup", data=data)
271	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
283	    with capture_flashes() as flashes:
284	        response = client.post("/api/tf-setup", data=data)
285	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
292	    # try validate code
293	    response = client.post(
294	        "/api/tf-validate", data=dict(code=b"333"), follow_redirects=False
295	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
299	    # try rescue
300	    response = client.post(
301	        "/api/tf-rescue", data=dict(help_setup="lost_device"), follow_redirects=False
302	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
312	    wrong_code = b"000000"
313	    response = client.post(
314	        "/tf-validate", data=dict(code=wrong_code), follow_redirects=True
315	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
321	    data = dict(email="nobody@lp.com", password="password")
322	    response = client.post("/login", data=data, follow_redirects=True)
323	    assert b"Specified user does not exist" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
323	    assert b"Specified user does not exist" in response.data
324	    response = client.post(
325	        "/login",
326	        json=data,
327	        headers={"Content-Type": "application/json"},
328	        follow_redirects=True,
329	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
333	    data = dict(email="gal@lp.com", password="wrong_pass")
334	    response = client.post("/login", data=data, follow_redirects=True)
335	    assert b"Invalid password" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
335	    assert b"Invalid password" in response.data
336	    response = client.post(
337	        "/login",
338	        json=data,
339	        headers={"Content-Type": "application/json"},
340	        follow_redirects=True,
341	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
345	    data = dict(email="matt@lp.com", password="password")
346	    response = client.post("/login", data=data, follow_redirects=True)
347	    message = b"Two-Factor authentication adds an extra layer of security"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
348	    assert message in response.data
349	    response = client.post(
350	        "/tf-setup", data=dict(setup="not_a_method"), follow_redirects=True
351	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
357	    data = dict(setup="not_a_method")
358	    response = client.post(
359	        "/tf-setup",
360	        json=data,
361	        headers={"Content-Type": "application/json"},
362	        follow_redirects=True,
363	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
370	    data = dict(setup="email")
371	    response = client.post(
372	        "/tf-setup",
373	        json=data,
374	        headers={"Content-Type": "application/json"},
375	        follow_redirects=True,
376	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
380	    data = dict(email="gal@lp.com", password="password")
381	    response = client.post(
382	        "/login",
383	        json=data,
384	        headers={"Content-Type": "application/json"},
385	        follow_redirects=True,
386	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
393	    # submit bad token to two_factor_token_validation
394	    response = client.post("/tf-validate", data=dict(code=wrong_code))
395	    assert get_message("TWO_FACTOR_INVALID_TOKEN") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
397	    # submit right token and show appropriate response
398	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
399	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
405	    setup_data = dict(setup="email")
406	    response = client.post("/tf-setup", data=setup_data, follow_redirects=True)
407	    msg = b"Enter code to complete setup"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
410	    # Fetch token validate form
411	    response = client.get("/tf-validate")
412	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
417	    # submit right token and show appropriate response
418	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
419	    assert b"You successfully changed your two-factor method" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
423	    setup_data = dict(setup="authenticator")
424	    response = client.post("/tf-setup", data=setup_data, follow_redirects=True)
425	    assert b"Open an authenticator app on your device" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
436	    code = totp.generate().token
437	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
438	    assert b"You successfully changed your two-factor method" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
444	    data = dict(email="gal@lp.com", password="password", remember=True)
445	    response = client.post(
446	        "/login",
447	        json=data,
448	        headers={"Content-Type": "application/json"},
449	        follow_redirects=True,
450	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
453	    code = totp.generate().token
454	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
455	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
465	    data = dict(email="matt@lp.com", password="password")
466	    response = client.post("/login", data=data, follow_redirects=True)
467	    message = b"Two-Factor authentication adds an extra layer of security"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
474	    setup_data = dict(setup="authenticator")
475	    response = client.post("/tf-setup", data=setup_data, follow_redirects=True)
476	    assert b"Open an authenticator app on your device" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
481	    data = dict(setup="sms", phone="+442083661177")
482	    response = client.post("/tf-setup", data=data, follow_redirects=True)
483	    assert b"Enter code to complete setup" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
486	
487	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
488	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
494	    rescue_data_json = dict(help_setup="lost_device")
495	    response = client.post(
496	        "/tf-rescue",
497	        json=rescue_data_json,
498	        headers={"Content-Type": "application/json"},
499	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
503	    data = dict(email="gal2@lp.com", password="password")
504	    response = client.post("/login", data=data, follow_redirects=True)
505	    assert b"Please enter your authentication code" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
506	    rescue_data = dict(help_setup="email")
507	    response = client.post("/tf-rescue", data=rescue_data, follow_redirects=True)
508	    message = b"The code for authentication was sent to your email address"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
510	    rescue_data = dict(help_setup="help")
511	    response = client.post("/tf-rescue", data=rescue_data, follow_redirects=True)
512	    message = b"An email was sent to us in order to reset your application account"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
519	
520	    response = client.post(
521	        "/login", json=dict(email="gal2@lp.com", password="password")
522	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
524	
525	    response = client.get("/tf-rescue", headers=headers)
526	    options = response.json["response"]["recovery_options"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
530	    # make sure that even if post using email - we get an error
531	    response = client.post("/tf-rescue", json=dict(help_setup="email"))
532	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
541	    data = dict(email="matt@lp.com", password="password")
542	    response = client.post("/login", data=data, follow_redirects=True)
543	    message = b"Two-Factor authentication adds an extra layer of security"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
547	    data = dict(setup="sms", phone="555-1212")
548	    response = client.post("/tf-setup", data=data, follow_redirects=True)
549	    assert b"Phone number not valid" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
553	    data = dict(setup="sms")
554	    response = client.post("/tf-setup", data=data, follow_redirects=True)
555	    assert b"Phone number not valid" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
558	    # Now setup good phone
559	    response = client.post(
560	        "/tf-setup", data=dict(setup="sms", phone="650-555-1212"), follow_redirects=True
561	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
566	
567	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
568	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
571	    headers = {"Accept": "application/json", "Content-Type": "application/json"}
572	    response = client.get("/tf-setup", headers=headers)
573	    # N.B. right now for tfa - we don't canonicalize phone number (since user

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
587	    data = dict(email="gal@lp.com", password="password")
588	    response = client.post("/login", json=data, headers=headers)
589	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
596	    code = sms_sender.messages[0].split()[-1]
597	    response = client.post("/tf-validate", json=dict(code=code))
598	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
599	    # verify logged in
600	    response = client.get("/profile", follow_redirects=False)
601	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
605	    data = dict(email="matt@lp.com", password="password")
606	    response = client.post("/login", json=data)
607	    assert response.json["response"]["tf_required"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
610	    # Start setup process.
611	    response = client.get("/tf-setup", headers=headers)
612	    assert response.json["response"]["tf_required"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
616	    data = dict(setup="sms", phone="+442083661177")
617	    response = client.post("/tf-setup", json=data)
618	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
621	    code = sms_sender.messages[0].split()[-1]
622	    response = client.post("/tf-validate", json=dict(code=code), headers=headers)
623	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
630	    data = dict(email="matt@lp.com", password="password")
631	    response = client.post("/login", json=data)
632	    assert response.json["response"]["tf_required"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
635	    # send bad code
636	    response = client.post("/tf-validate", json=dict(code="whatsup"))
637	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
641	    # Do a GET - should get recovery options
642	    response = client.get("/tf-validate", headers=headers)
643	    options = response.json["response"]["recovery_options"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
648	    code = sms_sender.messages[0].split()[-1]
649	    response = client.post("/tf-validate", json=dict(code=code))
650	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
651	    # verify logged in
652	    response = client.get("/profile", follow_redirects=False)
653	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
655	    # tf-setup should provide existing info
656	    response = client.get("/tf-setup", headers=headers)
657	    assert response.json["response"]["tf_required"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
668	    rescue_data_json = dict(help_setup="help")
669	    response = client.post(
670	        "/tf-rescue",
671	        json=rescue_data_json,
672	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
676	    data = dict(email="gal2@lp.com", password="password")
677	    response = client.post("/login", json=data)
678	    assert response.json["response"]["tf_required"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
680	    rescue_data = dict(help_setup="email")
681	    response = client.post("/tf-rescue", json=rescue_data)
682	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
688	    matcher = re.match(r".*code: ([0-9]+).*", outbox[0].body, re.IGNORECASE | re.DOTALL)
689	    response = client.post("/tf-validate", json=dict(code=matcher.group(1)))
690	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
693	    # Try rescue with no email (should send email to admin)
694	    client.post("/login", json=data)
695	    rescue_data = dict(help_setup="help")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
695	    rescue_data = dict(help_setup="help")
696	    response = client.post("/tf-rescue", json=rescue_data)
697	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
715	    data = dict(email="gal@lp.com", password="password")
716	    response = client.post("/login", json=data, headers=headers)
717	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
722	    code = sms_sender.messages[0].split()[-1]
723	    response = client.post("/tf-validate?include_auth_token", json=dict(code=code))
724	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
727	    # make sure can access restricted page
728	    response = client.get("/token", headers=headers)
729	    assert b"Token Authentication" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
735	    sms_sender = SmsSenderFactory.createSender("test")
736	    response = client.post(
737	        "/login",
738	        data=dict(email="gal@lp.com", password="password"),
739	        follow_redirects=True,
740	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
744	    # submit right token and show appropriate response
745	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
746	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
747	
748	    response = client.get("/tf-setup", follow_redirects=True)
749	    assert b"Disable two factor" not in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
753	    data = dict(setup="disable")
754	    response = client.post("/tf-setup", data=data, follow_redirects=True)
755	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
762	def test_custom_urls(client):
763	    response = client.get("/tf-setup")
764	    assert response.status_code == 404

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
764	    assert response.status_code == 404
765	    response = client.get("/custom-setup")
766	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
766	    assert response.status_code == 302
767	    response = client.get("/custom-rescue")
768	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
789	    # try to validate
790	    response = client.post("/tf-validate", data=dict(code="?"), follow_redirects=True)
791	    # This should log us out since it thinks we are evil

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
819	    data = dict(setup="sms", phone="+442083661177")
820	    response = client.post("/tf-setup", data=data, follow_redirects=True)
821	    assert b"Enter code to complete setup" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
825	    # Validate token - this should complete 2FA setup
826	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
827	    assert b"You successfully changed" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
847	    code = sms_sender.messages[0].split()[-1]
848	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
849	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
857	    data = dict(setup="disable")
858	    response = client.post("/tf-setup", data=data, follow_redirects=True)
859	    assert b"You successfully disabled two-factor authorization." in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
885	    data = dict(setup="sms", phone="+442083661177")
886	    response = client_nc.post("/tf-setup", json=data, headers=headers)
887	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
892	    # send bad token
893	    response = client_nc.post(
894	        "/tf-setup/not-a-token", json=dict(code=code), headers=headers
895	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
901	    # send bad code
902	    response = client_nc.post(
903	        f"/tf-setup/{state_token}", json=dict(code=12345), headers=headers
904	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:916
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
915	
916	    response = client_nc.post(
917	        f"/tf-setup/{state_token}", json=dict(code=code), headers=headers
918	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
920	
921	    response = client_nc.get("/tf-setup", headers=headers)
922	    assert response.json["response"]["tf_method"] == "sms"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
939	        data = dict(setup="sms", phone="+442083661177")
940	        response = client_nc.post("/tf-setup", json=data, headers=headers)
941	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
946	    # Validate token - this should complete 2FA setup
947	    response = client_nc.post(
948	        f"/tf-setup/{state_token}", json=dict(code=code), headers=headers
949	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
966	    data = dict(setup="sms", phone="+442083661177")
967	    response = client.post("/tf-setup", data=data, follow_redirects=True)
968	    assert b"Enter code to complete setup" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
973	    # send in bad token
974	    response = client.post(
975	        "/tf-setup/not-a-token", data=dict(code=code), follow_redirects=True
976	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
980	    # send in bad code
981	    response = client.post(verify_url, data=dict(code=12345), follow_redirects=True)
982	    assert check_location(app, response.history[0].location, "/tf-setup")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
985	    # Validate token - this should complete 2FA setup
986	    response = client.post(verify_url, data=dict(code=code), follow_redirects=True)
987	    assert b"You successfully changed" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
993	
994	    response = client.get("/tf-setup")
995	    assert b"Disable two-factor" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1002	    tf_authenticate(app, client)
1003	    response = client.get("tf-setup", headers=headers)
1004	    assert "disable" in response.json["response"]["tf_available_methods"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1005	
1006	    response = client.post("tf-setup", json=dict(setup="disable"), headers=headers)
1007	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1015	    assert is_authenticated(client, get_message)
1016	    response = client.get("tf-setup", headers=headers)
1017	    assert "disable" not in response.json["response"]["tf_available_methods"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1033	
1034	    client.post("/reset", data=dict(email="gal@lp.com"), follow_redirects=True)
1035	    response = client.post(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1034	    client.post("/reset", data=dict(email="gal@lp.com"), follow_redirects=True)
1035	    response = client.post(
1036	        "/reset/" + rtokens[0],
1037	        data={"password": "awesome sunset", "password_confirm": "awesome sunset"},
1038	        follow_redirects=True,
1039	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1043	    # we shouldn't be logged in
1044	    response = client.get("/profile", follow_redirects=False)
1045	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1049	    code = sms_sender.messages[0].split()[-1]
1050	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1051	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1054
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1053	    # verify we are logged in
1054	    response = client.get("/profile", follow_redirects=False)
1055	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1065
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1064	    data = dict(email="gene@lp.com", password="password")
1065	    response = client.post(
1066	        "/login", json=data, headers={"Content-Type": "application/json"}
1067	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1070	    # we shouldn't be logged in
1071	    response = client.get("/profile", follow_redirects=False)
1072	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1089
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1088	    code = sms_sender.messages[0].split()[-1]
1089	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1090	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1092	    # verify we are logged in
1093	    response = client.get("/profile", follow_redirects=False)
1094	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1105	    data = dict(email="gene@lp.com", password="password")
1106	    response = client.post(
1107	        "/login", json=data, headers={"Content-Type": "application/json"}
1108	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1112	    # we shouldn't be logged in
1113	    response = client.get("/profile", follow_redirects=False)
1114	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1122	    data = dict(email="gene@lp.com", password="password")
1123	    response = client.post(
1124	        "/login", json=data, headers={"Content-Type": "application/json"}
1125	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1131	    data = dict(setup="sms", phone="+442083661177")
1132	    response = client.post(
1133	        "/tf-setup", json=data, headers={"Content-Type": "application/json"}
1134	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1143	    # submit token and show appropriate response
1144	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1145	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1180	    data = dict(setup="sms", phone="+442083661188")
1181	    response = client.post("/tf-setup", data=data, follow_redirects=True)
1182	    assert b"Enter code to complete setup" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1191	    # Validate token - this should complete 2FA setup
1192	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1193	    assert b"You successfully changed" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1201	    data = dict(setup="disable")
1202	    response = client.post("/tf-setup", data=data, follow_redirects=True)
1203	    assert b"You successfully disabled two-factor authorization." in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1217	
1218	    response = client.get("/tf-setup", follow_redirects=True)
1219	    assert b"Set up using SMS" not in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1221	    data = dict(setup="authenticator")
1222	    response = client.post("/tf-setup", data=data, follow_redirects=True)
1223	    assert b"Submit Code" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1225	    # test json
1226	    response = client.post("/tf-setup", json=data)
1227	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1241	    setup_data = dict(setup="authenticator")
1242	    response = client.post("/tf-setup", json=setup_data, headers=headers)
1243	    assert response.json["response"]["tf_authr_issuer"] == "tests"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1261	    setup_data = dict(setup="authenticator")
1262	    response = client.post("/tf-setup", json=setup_data, headers=headers)
1263	    assert response.json["response"]["tf_authr_username"] == "456789"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1274	    authenticate(client, email="jill@lp.com")
1275	    response = client.post("/tf-setup", data=dict(setup="email"), follow_redirects=True)
1276	    msg = b"Enter code to complete setup"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1292	    authenticate(client, email="jill@lp.com")
1293	    response = client.post("/tf-setup", data=dict(setup="email"), follow_redirects=True)
1294	    msg = b"Enter code to complete setup"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1312	        data = {"email": "gal@lp.com", "password": "password"}
1313	        response = client.post("login", data=data, follow_redirects=False)
1314	        assert response.status_code == 302

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1319	    data = dict(email="gal@lp.com", password="password")
1320	    response = client.post("login", json=data, headers=headers)
1321	    assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1328	    data = dict(setup="sms", phone="+442083661188")
1329	    response = client.post("tf-setup", data=data)
1330	    assert get_message("FAILED_TO_SEND_CODE") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1331	
1332	    response = client.post("tf-setup", json=data, headers=headers)
1333	    assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1379	    data = dict(email="trp@lp.com", password="password")
1380	    response = client.post("/login", data=data, follow_redirects=True)
1381	    assert b"Please enter your authentication code" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1382	    rescue_data = dict(help_setup="email")
1383	    response = client.post("/tf-rescue", data=rescue_data, follow_redirects=True)
1384	    assert b"That didnt work out as we planned" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1387	    headers = {"Accept": "application/json", "Content-Type": "application/json"}
1388	    response = client.post("/tf-rescue", json=rescue_data, headers=headers)
1389	    assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1398	        data = dict(email="gal@lp.com", password="password")
1399	        response = client.post("/login?next=/im-in", data=data, follow_redirects=True)
1400	        assert "?next=/im-in" in response.request.url

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1402	        verify_url = get_form_action(response)
1403	        response = client.post(
1404	            verify_url, data=dict(code=codes[0]["login_token"]), follow_redirects=False
1405	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1410	        data = dict(email="gal@lp.com", password="password", next="/im-in")
1411	        response = client.post("/login", data=data, follow_redirects=True)
1412	        assert "?next=/im-in" in response.request.url

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1414	        verify_url = get_form_action(response)
1415	        response = client.post(
1416	            verify_url, data=dict(code=codes[1]["login_token"]), follow_redirects=False
1417	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1424	    authenticate(client)
1425	    response = client.get("tf-setup", follow_redirects=False)
1426	    assert check_location(app, response.location, "/verify?next=/tf-setup")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1431	    authenticate(client)
1432	    response = client.get("tf-setup", follow_redirects=True)
1433	    assert get_message("REAUTHENTICATION_REQUIRED") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1436	    # Send wrong password
1437	    response = client.post(
1438	        verify_password_url,
1439	        data=dict(password="iforgot"),
1440	        follow_redirects=True,
1441	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1446	    with capture_flashes() as flashes:
1447	        response = client.post(
1448	            verify_password_url,
1449	            data=dict(password="password"),
1450	            follow_redirects=False,
1451	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1467	    app.config["SECURITY_FRESHNESS"] = timedelta(minutes=0)
1468	    response = client.get("tf-setup", headers=headers)
1469	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1471	
1472	    response = client.post("verify", json=dict(password="notmine"), headers=headers)
1473	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1477	
1478	    response = client.post("verify", json=dict(password="password"), headers=headers)
1479	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1481	    app.config["SECURITY_FRESHNESS"] = timedelta(minutes=60)
1482	    response = client.get("tf-setup", headers=headers)
1483	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1488	    authenticate(client)
1489	    response = client.get("tf-setup", follow_redirects=False)
1490	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1549	    data = dict(email="trp@lp.com", password="password")
1550	    client.post("/login", data=data, follow_redirects=True)
1551	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1551	
1552	    response = client.post("/tf-setup", data=dict(setup="email"), follow_redirects=True)
1553	    msg = b"Enter code to complete setup"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1557	    # submit right token and show appropriate response
1558	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1559	    assert b"You successfully changed your two-factor method" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1570	    data = dict(setup="sms", phone="+442083661177")
1571	    response = client.post("/tf-setup", data=data, follow_redirects=True)
1572	    assert b"Enter code to complete setup" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1576	    # Validate token - this should complete 2FA setup
1577	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=False)
1578	    assert check_location(app, response.location, "/post_setup_view")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1597	        code = app.security._totp_factory.generate_totp_password(user.tf_totp_secret)
1598	    client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1599	    response = client.get("/tf-setup", follow_redirects=True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1598	    client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1599	    response = client.get("/tf-setup", follow_redirects=True)
1600	    with app.test_request_context():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1609	    tf_authenticate(app, client)
1610	    response = client.get("tf-setup")
1611	    assert b"Disable" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1613	
1614	    response = client.post("tf-setup", data=dict(setup="disable"))
1615	    assert b"The CSRF token is missing" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1616	
1617	    response = client.post(
1618	        "tf-setup", data=dict(setup="disable", csrf_token=csrf_token)
1619	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1626	    tf_authenticate(app, client)
1627	    response = client.get("tf-setup", json=dict())
1628	    csrf_token = response.json["response"]["csrf_token"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1629	
1630	    response = client.post("tf-setup", json=dict(setup="disable"))
1631	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1633	
1634	    response = client.post(
1635	        "tf-setup", json=dict(setup="disable"), headers={"X-CSRF-Token": csrf_token}
1636	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1644	    sms_sender = SmsSenderFactory.createSender("test")
1645	    response = client.get(
1646	        "/login", data={}, headers={"Content-Type": "application/json"}
1647	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1651	
1652	    response = client.post(
1653	        "/login",
1654	        json=dict(email="gal@lp.com", password="password"),
1655	        headers={
1656	            "Content-Type": "application/json",
1657	            "X-CSRF-Token": client.get_cookie("XSRF-Token").value,
1658	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1666	
1667	    response = client.post(
1668	        "/tf-validate",
1669	        json=dict(code=code),
1670	        headers={
1671	            "Content-Type": "application/json",
1672	            "X-CSRF-Token": client.get_cookie("XSRF-Token").value,
1673	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1677	    # verify original session csrf_token still works.
1678	    response = client.post(
1679	        "/json_auth",
1680	        json=dict(label="label"),
1681	        headers={"Content-Type": "application/json", "X-CSRF-Token": csrf_token},
1682	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1685	    # use XSRF_Cookie to send in csrf_token
1686	    response = client.post(
1687	        "/json_auth",
1688	        json=dict(label="label"),
1689	        headers={
1690	            "Content-Type": "application/json",
1691	            "X-CSRF-Token": client.get_cookie("XSRF-Token").value,
1692	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1702	    sms_sender = SmsSenderFactory.createSender("test")
1703	    response = client.post(
1704	        "/login",
1705	        json=dict(email="gal@lp.com", password="password"),
1706	        headers={"Content-Type": "application/json"},
1707	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1709	    code = sms_sender.messages[0].split()[-1]
1710	    response = client.post(
1711	        "/tf-validate",
1712	        json=dict(code=code),
1713	        headers={"Content-Type": "application/json"},
1714	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_two_factor.py:1717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1716	
1717	    response = client.post(
1718	        "/json_auth",
1719	        json=dict(label="label"),
1720	        headers={
1721	            "Content-Type": "application/json",
1722	            "X-CSRF-Token": client.get_cookie("XSRF-Token").value,
1723	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
84	    with capture_send_code_requests() as requests:
85	        response = client.post(
86	            "/us-signin/send-code",
87	            json=dict(identity=identity, chosen_method="email"),
88	            headers={"Content-Type": "application/json"},
89	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
91	
92	    response = client.post(
93	        "/us-signin?include_auth_token",
94	        json=dict(identity=identity, passcode=requests[0]["token"]),
95	        headers={"Content-Type": "application/json"},
96	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
108	    json_data = dict(identity="gal@lp.com", passcode="password", remember=remember)
109	    response = client.post(
110	        "/us-signin", json=json_data, headers={"Content-Type": "application/json"}
111	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
118	        if json:
119	            response = client.post(
120	                "/tf-validate",
121	                json=dict(code=code),
122	                headers={"Content-Type": "application/json"},
123	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
125	        else:
126	            response = client.post(
127	                "/tf-validate", data=dict(code=code), follow_redirects=True
128	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
159	    data = dict(identity="matt@lp.com")
160	    response = clients.post("/us-signin/send-code", data=data, follow_redirects=True)
161	    assert get_message("US_METHOD_NOT_AVAILABLE") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
164	    data = dict(identity="nobody@lp.com", chosen_method="email")
165	    response = clients.post("/us-signin/send-code", data=data, follow_redirects=True)
166	    assert get_message("US_SPECIFY_IDENTITY") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
175	    data = dict(identity="gal3@lp.com", chosen_method="email")
176	    response = clients.post("/us-signin/send-code", data=data, follow_redirects=True)
177	    assert b"Code has been sent" not in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
180	    with capture_send_code_requests() as requests:
181	        response = clients.post(
182	            "/us-signin/send-code",
183	            data=dict(identity="matt@lp.com", chosen_method="email"),
184	            follow_redirects=True,
185	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
191	    # try bad code
192	    response = clients.post(
193	        "/us-signin",
194	        data=dict(identity="matt@lp.com", passcode="blahblah"),
195	        follow_redirects=True,
196	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
201	    assert not clients.get_cookie("session")
202	    response = clients.post(
203	        "/us-signin",
204	        data=dict(identity="matt@lp.com", passcode=requests[0]["token"]),
205	        follow_redirects=False,
206	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
217	    set_phone(app)
218	    response = clients.post(
219	        "/us-signin/send-code",
220	        data=dict(identity="matt@lp.com", chosen_method="sms"),
221	        follow_redirects=True,
222	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
226	    code = sms_sender.messages[0].split()[-1].strip(".")
227	    response = clients.post(
228	        "/us-signin",
229	        data=dict(identity="matt@lp.com", passcode=code, remember=True),
230	        follow_redirects=True,
231	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	    with capture_flashes() as flashes:
253	        response = client_nc.get("/us-signin", headers=headers)
254	        jresponse = response.json["response"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
261	        with capture_send_code_requests() as requests:
262	            response = client_nc.post(
263	                "/us-signin/send-code",
264	                json=dict(identity="matt@lp.com", chosen_method="email"),
265	                headers=headers,
266	                follow_redirects=True,
267	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
274	        # try bad code
275	        response = client_nc.post(
276	            "/us-signin",
277	            json=dict(identity="matt@lp.com", passcode="blahblah"),
278	            headers=headers,
279	            follow_redirects=True,
280	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
286	        # Login successfully with code
287	        response = client_nc.post(
288	            "/us-signin?include_auth_token",
289	            json=dict(identity="matt@lp.com", passcode=requests[0]["token"]),
290	            headers=headers,
291	            follow_redirects=True,
292	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
302	        set_phone(app)
303	        response = client_nc.post(
304	            "/us-signin/send-code",
305	            json=dict(identity="matt@lp.com", chosen_method="sms"),
306	            headers=headers,
307	            follow_redirects=True,
308	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
311	        code = sms_sender.messages[0].split()[-1].strip(".")
312	        response = client_nc.post(
313	            "/us-signin?include_auth_token",
314	            json=dict(identity="matt@lp.com", passcode=code),
315	            headers=headers,
316	            follow_redirects=True,
317	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
332	    )
333	    response = client.post(
334	        "/change",
335	        json=data,
336	        headers={"Content-Type": "application/json"},
337	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
340	
341	    response = client.post(
342	        "/us-signin",
343	        json=dict(
344	            identity="matt@lp.com", passcode="new strong password\N{ROMAN NUMERAL ONE}"
345	        ),
346	        headers=headers,
347	        follow_redirects=False,
348	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
351	
352	    response = client.post(
353	        "/us-signin",
354	        json=dict(
355	            identity="matt@lp.com",
356	            passcode="new strong password\N{LATIN CAPITAL LETTER I}",
357	        ),
358	        headers=headers,
359	        follow_redirects=False,
360	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
370	    # doesn't have all of them.
371	    response = client.post(
372	        "/register", data=dict(email="nopasswd-dude@lp.com"), follow_redirects=True
373	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
375	    with capture_send_code_requests() as requests:
376	        response = client.post(
377	            "/us-signin/send-code",
378	            data=dict(identity="nopasswd-dude@lp.com", chosen_method="email"),
379	            follow_redirects=True,
380	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
394	        link = matcher[0].split(":", 1)[1]
395	        response = client.get(link, follow_redirects=True)
396	        assert get_message("PASSWORDLESS_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
398	    # check us-setup has 'email' but not password
399	    response = client.get("/us-setup", json={})
400	    assert response.json["response"]["active_methods"] == ["email"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
407	    # Check passwordless with confirmation required.
408	    response = client.post(
409	        "/register", data=dict(email="nopasswd-dude@lp.com"), follow_redirects=True
410	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
411	    # Try logging in - should get confirmation required.
412	    response = client.post(
413	        "/us-signin/send-code",
414	        data=dict(identity="nopasswd-dude@lp.com", chosen_method="email"),
415	        follow_redirects=True,
416	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
421	    link = matcher[0].split(":", 1)[1]
422	    response = client.get(link, follow_redirects=True)
423	    assert get_message("EMAIL_CONFIRMED") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
426	    # should be able to authenticate now.
427	    response = client.post(
428	        "/us-signin/send-code",
429	        data=dict(identity="nopasswd-dude@lp.com", chosen_method="email"),
430	        follow_redirects=True,
431	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	    link = matcher[0].split(":", 1)[1]
438	    response = client.get(link, follow_redirects=True)
439	    assert get_message("PASSWORDLESS_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
447	    headers = {"Accept": "application/json", "Content-Type": "application/json"}
448	    response = client.post("/register", json=dict(email="nopasswd-dude@lp.com"))
449	    # Try logging in - should get confirmation required.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
449	    # Try logging in - should get confirmation required.
450	    response = client.post(
451	        "/us-signin/send-code",
452	        json=dict(identity="nopasswd-dude@lp.com", chosen_method="email"),
453	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
461	    link = matcher[0].split(":", 1)[1]
462	    response = client.get(link, headers=headers, follow_redirects=False)
463	    assert check_location(app, response.location, "/login")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
465	    # should be able to authenticate now.
466	    response = client.post(
467	        "/us-signin/send-code",
468	        json=dict(identity="nopasswd-dude@lp.com", chosen_method="email"),
469	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
475	    link = matcher[0].split(":", 1)[1]
476	    response = client.get(link, headers=headers, follow_redirects=True)
477	    assert get_message("PASSWORDLESS_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
486	    set_phone(app)
487	    response = client_nc.post(
488	        "/us-signin/send-code",
489	        json=dict(identity="matt@lp.com", chosen_method="sms"),
490	        headers=headers,
491	        follow_redirects=True,
492	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
496	    code = sms_sender.messages[0].split()[-1].strip(".")
497	    response = client_nc.post(
498	        "/us-signin?include_auth_token",
499	        json=dict(identity="matt@lp.com", passcode=code),
500	        headers=headers,
501	        follow_redirects=True,
502	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
511	
512	    response = client_nc.post(
513	        "/us-signin/send-code",
514	        json=dict(identity="matt@lp.com", chosen_method="sms"),
515	        headers=headers,
516	        follow_redirects=True,
517	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
532	    set_phone(app)
533	    response = client_nc.post(
534	        "/us-signin/send-code",
535	        json=dict(identity="matt@lp.com", chosen_method="sms"),
536	        headers=headers,
537	        follow_redirects=True,
538	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
546	
547	    response = client_nc.post(
548	        "/us-signin/send-code",
549	        json=dict(identity="matt@lp.com", chosen_method="sms"),
550	        headers=headers,
551	        follow_redirects=True,
552	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
565	    # This should ignore next
566	    response = client.get("/us-signin?next=/page1", follow_redirects=True)
567	    assert b"Post Login" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
570	    headers = {"Accept": "application/json", "Content-Type": "application/json"}
571	    response = client.get("/us-signin", headers=headers)
572	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
587	    data = dict(email="matt@lp.com", password="password")
588	    response = client.post("/us-signin", data=data, follow_redirects=True)
589	    assert b"Post Login" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
591	    headers = {"Accept": "application/json", "Content-Type": "application/json"}
592	    response = client.post("/us-signin", json=data, headers=headers)
593	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
608	    with capture_send_code_requests() as requests:
609	        response = client.post(
610	            "/us-signin/send-code",
611	            data=dict(identity="matt@lp.com", chosen_method="email"),
612	            follow_redirects=True,
613	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
621	    matcher = re.match(
622	        r".*(http://[^\s*]*).*", outbox[0].body, re.IGNORECASE | re.DOTALL
623	    )
624	    magic_link = matcher.group(1)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
626	    # Try with missing code
627	    response = client.get("us-verify-link?id=matt@lp.com", follow_redirects=False)
628	    assert "/us-signin" in response.location

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
628	    assert "/us-signin" in response.location
629	    response = client.get("us-verify-link?id=matt@lp.com", follow_redirects=True)
630	    assert get_message("API_ERROR") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
632	    # Try unknown user
633	    response = client.get("us-verify-link?id=123435&code=12345", follow_redirects=True)
634	    assert get_message("USER_DOES_NOT_EXIST") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
636	    # Try bad code
637	    response = client.get(
638	        f"us-verify-link?id={requests[0]['user'].fs_uniquifier}&code=12345",
639	        follow_redirects=True,
640	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	    # Try actual link
644	    response = client.get(magic_link, follow_redirects=True)
645	    assert get_message("PASSWORDLESS_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
664	    with capture_send_code_requests() as requests:
665	        response = client.post(
666	            "/us-signin/send-code",
667	            json=dict(identity="matt@lp.com", chosen_method="email"),
668	            headers=headers,
669	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
673	    matcher = re.match(
674	        r".*(http://[^\s*]*).*", outbox[0].body, re.IGNORECASE | re.DOTALL
675	    )
676	    magic_link = matcher.group(1)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:679
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
678	    # Try with no code
679	    response = client.get("us-verify-link?id=matt@lp.com", follow_redirects=False)
680	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
687	    # Try unknown user
688	    response = client.get("us-verify-link?id=98765&code=12345", follow_redirects=False)
689	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
696	    # Try bad code
697	    response = client.get(
698	        f"us-verify-link?id={requests[0]['user'].fs_uniquifier}&code=12345",
699	        follow_redirects=False,
700	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
708	    # Try actual link
709	    response = client.get(magic_link, follow_redirects=False)
710	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
723	    us_authenticate(tcl)
724	    response = tcl.get("us-setup")
725	    # Email should be in delete options since we just set that up.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
731	    # test not supplying anything to do
732	    response = tcl.post("us-setup", data=dict(phone="6505551212"))
733	    assert get_message("API_ERROR") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
735	    # test missing phone
736	    response = tcl.post("us-setup", data=dict(chosen_method="sms", phone=""))
737	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
740	    # test invalid phone
741	    response = tcl.post(
742	        "us-setup", data=dict(chosen_method="sms", phone="NOT-A-NUMBER")
743	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
748	    sms_sender = SmsSenderFactory.createSender("test")
749	    response = tcl.post(
750	        "us-setup", data=dict(chosen_method="sms", phone="650-555-1212")
751	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
758	    # Try invalid code
759	    response = tcl.post(verify_url, data=dict(passcode=12345), follow_redirects=True)
760	    assert get_message("INVALID_PASSWORD_CODE") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
762	    code = sms_sender.messages[0].split()[-1].strip(".")
763	    response = tcl.post(verify_url, data=dict(passcode=code), follow_redirects=True)
764	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
772	    us_authenticate(client)
773	    response = client.post("us-setup", data=dict(chosen_method="email"))
774	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
786	    code = matcher[2].split(":")[1]
787	    response = client.post(verify_url, data=dict(passcode=code), follow_redirects=True)
788	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
811	    }
812	    response = client_nc.get("/us-setup", headers=headers)
813	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:819
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
818	    sms_sender = SmsSenderFactory.createSender("test")
819	    response = client_nc.post(
820	        "us-setup",
821	        json=dict(chosen_method="sms", phone="650-555-1212"),
822	        headers=headers,
823	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
828	    # send invalid code
829	    response = client_nc.post(
830	        "/us-setup/" + state, json=dict(passcode=12344), headers=headers
831	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
836	    code = sms_sender.messages[0].split()[-1].strip(".")
837	    response = client_nc.post(
838	        "/us-setup/" + state, json=dict(passcode=code), headers=headers
839	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:845
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
844	    # Verify sms in list of 'active' methods
845	    response = client_nc.get("/us-setup", headers=headers)
846	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:857
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
856	    sms_sender = SmsSenderFactory.createSender("test")
857	    response = client_nc.post(
858	        "/us-signin/send-code",
859	        json=dict(identity="6505551212", chosen_method="sms"),
860	        headers=headers,
861	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
863	    code = sms_sender.messages[0].split()[-1].strip(".")
864	    response = client_nc.post(
865	        "/us-signin?include_auth_token",
866	        json=dict(identity="matt@lp.com", passcode=code),
867	        headers=headers,
868	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
887	    }
888	    response = client_nc.get("/us-setup", headers=headers)
889	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
893	    # re-verify
894	    client_nc.post(
895	        "/us-verify/send-code",
896	        json=dict(identity="matt@lp.com", chosen_method="email"),
897	        headers=headers,
898	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
901	    code = matcher.group(1)
902	    response = client_nc.post(
903	        "/us-verify?include_auth_token", json=dict(passcode=code), headers=headers
904	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
909	    # should work now
910	    response = client_nc.get("/us-setup", headers=headers)
911	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
919	        "Authorization": "Basic %s"
920	        % base64.b64encode(b"matt@lp.com:password").decode("utf-8")
921	    }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:920
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
919	        "Authorization": "Basic %s"
920	        % base64.b64encode(b"matt@lp.com:password").decode("utf-8")
921	    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
921	    }
922	    response = client.get("/us-setup", headers=headers)
923	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
932	    # bogus state
933	    response = client.post(
934	        "/us-setup/not a token", json=dict(passcode=12345), headers=headers
935	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
941	    # same w/o json
942	    response = client.post(
943	        "/us-setup/not a token", data=dict(passcode=12345), follow_redirects=True
944	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
956	    app.security.us_setup_serializer = FakeSerializer(2.0)
957	    response = client.post(
958	        "us-setup",
959	        json=dict(chosen_method="sms", phone="650-555-1212"),
960	        headers=headers,
961	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
965	    code = sms_sender.messages[0].split()[-1].strip(".")
966	    response = client.post(
967	        "/us-setup/" + state, json=dict(passcode=code), headers=headers
968	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
984	    sms_sender = SmsSenderFactory.createSender("test")
985	    response = client.post(
986	        "us-setup",
987	        json=dict(chosen_method="sms", phone="650-555-1212"),
988	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
992	    code = sms_sender.messages[0].split()[-1].strip(".")
993	    response = client.post("/us-setup/" + state, json=dict(passcode=code))
994	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
999	    us_authenticate(client, identity="joe@lp.com")
1000	    response = client.post(
1001	        "us-setup",
1002	        json=dict(chosen_method="sms", phone="650-555-1212"),
1003	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1018
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1017	    us_authenticate(client)
1018	    response = client.get("us-setup", follow_redirects=False)
1019	    verify_url = response.location

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1024
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1023	
1024	    response = client.get("us-setup", follow_redirects=True)
1025	    form_response = response.data.decode("utf-8")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1029	    # Send unknown method
1030	    response = client.post(
1031	        send_code_url,
1032	        data=dict(identity="matt@lp.com", chosen_method="sms2"),
1033	        follow_redirects=True,
1034	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1040	    set_phone(app)
1041	    response = client.post(
1042	        send_code_url,
1043	        data=dict(identity="matt@lp.com", chosen_method="sms"),
1044	        follow_redirects=True,
1045	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1049	    code = sms_sender.messages[0].split()[-1].strip(".")
1050	    response = client.post(verify_url, data=dict(passcode=code), follow_redirects=False)
1051	    assert check_location(app, response.location, "/us-setup")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1062	    app.config["SECURITY_FRESHNESS"] = timedelta(minutes=0)
1063	    response = client.get("us-setup", headers=headers)
1064	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1067	    # figure out which methods are usable
1068	    response = client.get("us-verify", headers=headers)
1069	    assert response.json["response"]["available_methods"] == [

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1079	
1080	    response = client.post(
1081	        "us-verify/send-code",
1082	        json=dict(chosen_method="orb"),
1083	        headers=headers,
1084	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1090
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1089	    set_phone(app)
1090	    response = client.post(
1091	        "us-verify/send-code",
1092	        json=dict(chosen_method="sms"),
1093	        headers=headers,
1094	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1098
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1097	    # Try bad code
1098	    response = client.post("us-verify", json=dict(passcode=42), headers=headers)
1099	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1106	
1107	    response = client.post("us-verify", json=dict(passcode=None), headers=headers)
1108	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1113	    code = sms_sender.messages[0].split()[-1].strip(".")
1114	    response = client.post("us-verify", json=dict(passcode=code), headers=headers)
1115	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1117	    app.config["SECURITY_FRESHNESS"] = timedelta(minutes=60)
1118	    response = client.get("us-setup", headers=headers)
1119	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1125	    us_authenticate(client)
1126	    response = client.get("us-setup", follow_redirects=False)
1127	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1128	
1129	    response = client.get("us-verify")
1130	    assert response.status_code == 404

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1136	
1137	    response = client.get("/us-signin", headers=headers)
1138	    assert response.json["response"]["available_methods"] == ["sms"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1140	    # verify json error
1141	    response = client.post(
1142	        "/us-signin/send-code",
1143	        json=dict(identity="matt@lp.com", chosen_method="email"),
1144	        headers=headers,
1145	        follow_redirects=True,
1146	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1152	    # verify form error
1153	    response = client.post(
1154	        "/us-signin/send-code",
1155	        data=dict(identity="matt@lp.com", chosen_method="email"),
1156	        follow_redirects=True,
1157	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1167	
1168	    response = client.get("/us-setup", headers=headers)
1169	    assert response.json["response"]["available_methods"] == ["sms", "email"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1171	    # verify json error
1172	    response = client.post(
1173	        "/us-setup",
1174	        json=dict(email="matt@lp.com", chosen_method="authenticator"),
1175	        headers=headers,
1176	        follow_redirects=True,
1177	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1182	
1183	    response = client.post(
1184	        "/us-setup",
1185	        data=dict(email="matt@lp.com", chosen_method="authenticators"),
1186	        follow_redirects=True,
1187	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1200	    sms_sender = SmsSenderFactory.createSender("test")
1201	    response = client.post(
1202	        "us-setup",
1203	        json=dict(chosen_method="sms", phone="650-555-1212"),
1204	        headers=headers,
1205	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1212	    sms_sender2 = SmsSenderFactory.createSender("test")
1213	    response = client.post(
1214	        "us-setup",
1215	        json=dict(chosen_method="sms", phone="650-555-1212"),
1216	        headers=headers,
1217	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1220	    # Use old code
1221	    response = client.post(
1222	        "/us-setup/" + state, json=dict(passcode=code), headers=headers
1223	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1227	    code = sms_sender2.messages[0].split()[-1].strip(".")
1228	    response = client.post(
1229	        "/us-setup/" + state, json=dict(passcode=code), headers=headers
1230	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1240	    us_authenticate(client, identity="gal@lp.com")
1241	    response = client.post("us-setup", data=dict(chosen_method="authenticator"))
1242	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1257	
1258	    response = client.post(verify_url, data=dict(passcode=code), follow_redirects=True)
1259	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1265	    with capture_send_code_requests() as requests:
1266	        response = client.post(
1267	            "/us-signin/send-code",
1268	            data=dict(identity="matt@lp.com", chosen_method="email"),
1269	            follow_redirects=True,
1270	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1272	
1273	    response = client.post(
1274	        "/us-signin?next=/post_login",
1275	        data=dict(identity="matt@lp.com", passcode=requests[0]["token"]),
1276	        follow_redirects=False,
1277	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1281	    # Test form.next
1282	    response = client.post(
1283	        "/us-signin",
1284	        data=dict(
1285	            identity="matt@lp.com", passcode=requests[0]["token"], next="/post_login"
1286	        ),
1287	        follow_redirects=False,
1288	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1299	    )
1300	    response = client.post("/register", data=data, follow_redirects=True)
1301	    set_email(app, email="jyl@lp.com")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1302	
1303	    response = client.post(
1304	        "/us-signin/send-code",
1305	        data=dict(identity="jyl@lp.com", chosen_method="email"),
1306	        follow_redirects=False,
1307	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1309	
1310	    response = client.post(
1311	        "/us-signin",
1312	        data=dict(identity="jyl@lp.com", passcode="password"),
1313	        follow_redirects=False,
1314	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1324	    )
1325	    response = client.post("/register", data=data, follow_redirects=True)
1326	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1328	
1329	    response = client.post(
1330	        "/us-signin/send-code",
1331	        data=dict(identity="dude@lp.com", chosen_method="email"),
1332	        follow_redirects=True,
1333	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1347	    data = dict(email="trp@lp.com", password="")
1348	    response = client.post("/register", data=data, follow_redirects=True)
1349	    assert b"Welcome trp@lp.com" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1352	    with capture_reset_password_requests() as requests:
1353	        client.post("/reset", data=dict(email="trp@lp.com"), follow_redirects=True)
1354	    token = requests[0]["token"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1355	
1356	    response = client.post(
1357	        "/reset/" + token,
1358	        data={"password": "awesome sunset", "password_confirm": "awesome sunset"},
1359	        follow_redirects=True,
1360	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1371	    # authenticate with password and us-signin endpoint
1372	    response = client.post(
1373	        "/us-signin",
1374	        data=dict(identity="trp@lp.com", passcode="awesome sunset"),
1375	        follow_redirects=True,
1376	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1387	    data = dict(email="trp@lp.com", password="")
1388	    response = client.post("/register", data=data, follow_redirects=True)
1389	    # should have been logged in since no confirmation

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1398	
1399	    response = client.post("/change", json=data)
1400	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1402	
1403	    client.post(
1404	        "/us-verify/send-code",
1405	        json=dict(identity="trp@lp.com", chosen_method="email"),
1406	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1409	    code = matcher.group(1)
1410	    response = client.post("/us-verify", json=dict(passcode=code))
1411	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1412	
1413	    response = client.get("/change", headers=headers)
1414	    assert not response.json["response"]["active_password"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1414	    assert not response.json["response"]["active_password"]
1415	    response = client.get("/change")
1416	    assert b"You do not" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1418	    # now should be able to change
1419	    response = client.post("/change", json=data)
1420	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1422	
1423	    response = client.post(
1424	        "/login", json=dict(email="trp@lp.com", password="awesome sunset")
1425	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1433	    data = dict(email="trp@lp.com", password="")
1434	    response = client.post("/register", data=data, follow_redirects=True)
1435	    logout(client)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1436	
1437	    response = client.post("/us-signin", json=dict(identity="trp@lp.com", passcode=""))
1438	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1464	
1465	    response = client.post(
1466	        "/us-signin",
1467	        data=dict(identity="matt@lp.com", passcode="password", remember=True),
1468	        follow_redirects=True,
1469	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1480	    # If "password" not in methods - then should not be able to use password
1481	    response = client.post(
1482	        "/us-signin",
1483	        data=dict(identity="matt@lp.com", passcode="password", remember=True),
1484	        follow_redirects=True,
1485	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1492	    # Test basic two-factor - default for signing in with password.
1493	    response = client.post(
1494	        "/us-signin",
1495	        data=dict(identity="matt@lp.com", passcode="password", remember=True),
1496	        follow_redirects=True,
1497	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1504	    data = dict(setup="sms", phone="+442083661177")
1505	    response = client.post("/tf-setup", data=data, follow_redirects=True)
1506	    assert b"Enter code to complete setup" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1508	
1509	    response = client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1510	    assert get_message("TWO_FACTOR_LOGIN_SUCCESSFUL") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1517	    set_email(app)
1518	    response = client.post(
1519	        "/us-signin/send-code",
1520	        data=dict(identity="matt@lp.com", chosen_method="email"),
1521	        follow_redirects=True,
1522	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1527	    matcher = re.match(
1528	        r".*(http://[^\s*]*).*", outbox[0].body, re.IGNORECASE | re.DOTALL
1529	    )
1530	    magic_link = matcher.group(1)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1530	    magic_link = matcher.group(1)
1531	    response = client.get(magic_link, follow_redirects=True)
1532	    assert get_message("PASSWORDLESS_LOGIN_SUCCESSFUL") not in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1547	    set_email(app)
1548	    response = client.post(
1549	        "/us-signin/send-code",
1550	        data=dict(identity="matt@lp.com", chosen_method="email"),
1551	        follow_redirects=True,
1552	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1557	    matcher = re.match(
1558	        r".*(http://[^\s*]*).*", outbox[0].body, re.IGNORECASE | re.DOTALL
1559	    )
1560	    magic_link = matcher.group(1)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1560	    magic_link = matcher.group(1)
1561	    response = client.get(magic_link, follow_redirects=False)
1562	    split = urlsplit(response.location)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1576	    # 1. sign in and setup TFA
1577	    client.post(
1578	        "/us-signin",
1579	        data=dict(identity="matt@lp.com", passcode="password", remember=True),
1580	        follow_redirects=True,
1581	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1584	    data = dict(setup="sms", phone="+442083661177")
1585	    client.post("/tf-setup", data=data, follow_redirects=True)
1586	    code = sms_sender.messages[0].split()[-1]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1586	    code = sms_sender.messages[0].split()[-1]
1587	    client.post("/tf-validate", data=dict(code=code), follow_redirects=True)
1588	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1589	    # 2. setup unified sign in with SMS
1590	    response = client.post(
1591	        "us-setup", data=dict(chosen_method="sms", phone="650-555-1212")
1592	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1594	    code = sms_sender.messages[0].split()[-1].strip(".")
1595	    response = client.post(verify_url, data=dict(passcode=code), follow_redirects=True)
1596	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1602	    # 4. sign in with SMS - should not require TFA
1603	    client.post(
1604	        "/us-signin/send-code",
1605	        data=dict(identity="matt@lp.com", chosen_method="sms"),
1606	        follow_redirects=True,
1607	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1609	    code = sms_sender.messages[0].split()[-1].strip(".")
1610	    response = client.post(
1611	        "/us-signin",
1612	        data=dict(identity="6505551212", passcode=code),
1613	        follow_redirects=True,
1614	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1629	    data = dict(identity="matt@lp.com", chosen_method="sms")
1630	    response = client.post("/us-signin/send-code", data=data, follow_redirects=True)
1631	    assert get_message("FAILED_TO_SEND_CODE") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1632	
1633	    response = client.post("us-signin/send-code", json=data, headers=headers)
1634	    assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1642	    data = dict(chosen_method="sms", phone="650-555-1212")
1643	    response = client.post("us-setup", data=data)
1644	    assert get_message("FAILED_TO_SEND_CODE") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1645	
1646	    response = client.post("us-setup", json=data, headers=headers)
1647	    assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1653	    data = dict(chosen_method="sms")
1654	    response = client.post("/us-verify/send-code", data=data)
1655	    assert get_message("FAILED_TO_SEND_CODE") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1655	    assert get_message("FAILED_TO_SEND_CODE") in response.data
1656	    response = client.post("us-verify/send-code", json=data)
1657	    assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1694	    data = dict(email="trp@lp.com", password="password")
1695	    response = client.post("/register", data=data, follow_redirects=True)
1696	    assert b"Welcome trp@lp.com" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1700	    data = dict(identity="trp@lp.com", chosen_method="sms")
1701	    response = client.post("/us-signin/send-code", data=data, follow_redirects=True)
1702	    assert b"Code has been sent" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1710	    authenticate(client)
1711	    response = client.get("us-setup")
1712	    assert b"No method" in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1714	    headers = {"Accept": "application/json", "Content-Type": "application/json"}
1715	    response = client.get("us-setup", headers=headers)
1716	    assert response.json["response"]["available_methods"] == ["password"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1722	    authenticate(client)
1723	    response = client.get("us-setup")
1724	    assert b"authenticator app" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1726	    # Check that we get QRcode URL and no 'code sent'
1727	    response = client.post("us-setup", data=dict(chosen_method="authenticator"))
1728	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1734	    headers = {"Accept": "application/json", "Content-Type": "application/json"}
1735	    response = client.get("us-setup", headers=headers)
1736	    assert response.json["response"]["available_methods"] == [

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1754	
1755	    response = client.post(
1756	        "us-setup", json=dict(chosen_method="authenticator"), headers=headers
1757	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1769	
1770	    response = client.post(
1771	        "/us-setup/" + state, json=dict(passcode=code), headers=headers
1772	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1786	    sms_sender = SmsSenderFactory.createSender("test")
1787	    response = client.post(
1788	        "us-setup",
1789	        json=dict(chosen_method="sms", phone="650-555-1212"),
1790	        headers=headers,
1791	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1794	    state = response.json["response"]["state"]
1795	    response = client.post(
1796	        "/us-setup/" + state, json=dict(passcode=code), headers=headers
1797	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1811	    # Ok - setup again - but send invalid code - check totp in DB didn't change.
1812	    response = client.post(
1813	        "us-setup", json=dict(chosen_method="authenticator"), headers=headers
1814	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1819	    # validate with wrong code
1820	    response = client.post(
1821	        "/us-setup/" + state, json=dict(passcode=123345), headers=headers
1822	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1849	    data = dict(identity="gal@lp.com", passcode="password")
1850	    response = client.post("/us-signin", json=data)
1851	    assert response.json["meta"]["code"] == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1855	    data = dict(identity="gal2@lp.com", passcode="password")
1856	    response = client.post("/us-signin", data=data, follow_redirects=True)
1857	    assert b"Please enter your authentication code" in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1858	
1859	    response = client.post(
1860	        "/us-signin",
1861	        json=data,
1862	        follow_redirects=True,
1863	        headers={"Content-Type": "application/json"},
1864	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1879	    reset_fresh(client, app.config["SECURITY_FRESHNESS"])
1880	    response = client.get("us-setup", headers=headers)
1881	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1885	    # the us-verify form should have the webauthn verify form attached
1886	    response = client.get("us-verify")
1887	    assert b'action="/wan-verify"' in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1889	    app.config["SECURITY_WAN_ALLOW_AS_VERIFY"] = None
1890	    response = client.get("us-setup", headers=headers)
1891	    assert response.status_code == 401

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1895	    # the us-verify form should NOT have the webauthn verify form attached
1896	    response = client.get("us-verify")
1897	    assert b'action="/wan-verify"' not in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1902	    us_authenticate(client)
1903	    response = client.get("us-setup")
1904	    # Email should be in delete options since we just set that up.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1908	    )
1909	    response = client.post("us-setup", data=dict(delete_method="email"))
1910	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1910	
1911	    response = client.get("us-setup")
1912	    # All should be in possible setups.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1917	
1918	    response = client.post("us-setup", json=dict(delete_method="email"))
1919	    assert response.json["response"]["errors"][0].encode("utf-8") == get_message(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1939	    us_authenticate(client)
1940	    response = client.get("us-setup", headers=headers)
1941	    # Email should be in delete options since we just set that up.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1943	
1944	    response = client.post("us-setup", json=dict(delete_method="email"))
1945	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1946	
1947	    response = client.get("us-setup", headers=headers)
1948	    assert response.json["response"]["active_methods"] == ["password"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1950
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1949	
1950	    response = client.post("us-setup", json=dict(delete_method="email"))
1951	    assert response.json["response"]["errors"][0].encode("utf-8") == get_message(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1956	    sms_sender = SmsSenderFactory.createSender("test")
1957	    response = client.post(
1958	        "us-setup",
1959	        json=dict(chosen_method="sms", phone="650-555-1212"),
1960	        headers=headers,
1961	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1965	    code = sms_sender.messages[0].split()[-1].strip(".")
1966	    response = client.post(
1967	        "/us-setup/" + state, json=dict(passcode=code), headers=headers
1968	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1973	    # verify SMS in active methods
1974	    response = client.get("/us-setup", headers=headers)
1975	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1978	    # delete SMS
1979	    response = client.post("/us-setup", json=(dict(delete_method="sms")))
1980	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1980	    assert response.status_code == 200
1981	    response = client.get("/us-setup", headers=headers)
1982	    assert response.json["response"]["active_methods"] == ["password"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:1998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1997	    us_authenticate(client)
1998	    response = client.get("us-setup", headers=headers)
1999	    # Email and sms should be in delete options since we just set that up.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2005	
2006	    response = client.post("us-setup", json=dict(delete_method=["email", "sms"]))
2007	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2008	
2009	    response = client.get("us-setup", headers=headers)
2010	    assert response.json["response"]["active_methods"] == ["password"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2018	    data = dict(identity="matt@lp.com", chosen_method="email")
2019	    response = client.post("/us-signin/send-code", data=data, follow_redirects=True)
2020	    assert get_message("GENERIC_US_SIGNIN") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2022	    # for JSON still return 200 as if everything is fine and a code was sent.
2023	    response = client.post("/us-signin/send-code", json=data)
2024	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2029	    data = dict(identity="matt@lp.com", chosen_method="sms")
2030	    response = client.post("/us-signin/send-code", data=data, follow_redirects=True)
2031	    assert get_message("GENERIC_US_SIGNIN") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2033	    # for JSON still return 200 as if everything is fine and a code was sent.
2034	    response = client.post("/us-signin/send-code", json=data)
2035	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2041	    data = dict(identity="matt2@lp.com", chosen_method="email")
2042	    response = client.post("/us-signin/send-code", data=data, follow_redirects=True)
2043	    assert get_message("GENERIC_US_SIGNIN") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2046
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2045	    # for JSON still return 200 as if everything is fine and a code was sent.
2046	    response = client.post("/us-signin/send-code", json=data)
2047	    assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2055	    data = dict(identity="matt@lp.com", code="12345")
2056	    response = client.post("/us-signin", data=data)
2057	    assert get_message("GENERIC_AUTHN_FAILED") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2060
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2059	    data = dict(identity="matt@lp.com", code="12345")
2060	    response = client.post("/us-signin", json=data)
2061	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2072	    data = dict(identity="matt2@lp.com", code="12345")
2073	    response = client.post("/us-signin", data=data)
2074	    assert get_message("GENERIC_AUTHN_FAILED") in response.data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2076	    data = dict(identity="matt2@lp.com", code="12345")
2077	    response = client.post("/us-signin", json=data)
2078	    assert response.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2092	    with capture_send_code_requests() as requests:
2093	        response = client.post(
2094	            "/us-signin/send-code",
2095	            data=dict(identity="matt@lp.com", chosen_method="email"),
2096	            follow_redirects=True,
2097	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2102	    # Try bad/unknown id
2103	    response = client.get("us-verify-link?id=98765&code=12345", follow_redirects=True)
2104	    assert get_message("GENERIC_AUTHN_FAILED") in response.data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2106	    # Try bad code
2107	    response = client.get(
2108	        f"us-verify-link?id={uid}&code=12345",
2109	        follow_redirects=True,
2110	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2117	        app.security.datastore.commit()
2118	    response = client.get(
2119	        f"us-verify-link?id={uid}&code={code}",
2120	        follow_redirects=True,
2121	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2130	    with capture_send_code_requests() as codes:
2131	        response = client.get("profile", follow_redirects=True)
2132	        assert "?next=/profile" in response.request.url

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2134	        sendcode_url = get_form_action(response, 1)
2135	        response = client.post(
2136	            sendcode_url, data=dict(identity="matt@lp.com", chosen_method="sms")
2137	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2138	        data = dict(identity="matt@lp.com", passcode=codes[0]["login_token"])
2139	        response = client.post(signin_url, data=data, follow_redirects=False)
2140	        assert "/profile" in response.location

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2146	    # test next is propagated with a second factor
2147	    response = client.post(
2148	        "/auth/login", json=dict(identity="matt@lp.com", passcode="password")
2149	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2152	
2153	    response = client.get("/profile", follow_redirects=True)
2154	    assert "?next=/profile" in response.request.url

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2155	    signin_url = get_form_action(response, 0)
2156	    response = client.post(
2157	        signin_url,
2158	        data=dict(identity="matt@lp.com", passcode="password"),
2159	        follow_redirects=True,
2160	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2161	    sendcode_url = get_form_action(response, 0)
2162	    response = client.post(
2163	        sendcode_url,
2164	        data=dict(code=sms_sender.messages[0].split()[-1]),
2165	        follow_redirects=True,
2166	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2171	
2172	    response = client.post(
2173	        "/auth/us-signin",
2174	        data=dict(identity="matt@lp.com", passcode="password", next="/im-in"),
2175	        follow_redirects=True,
2176	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2177	    sendcode_url = get_form_action(response, 0)
2178	    response = client.post(
2179	        sendcode_url,
2180	        data=dict(code=sms_sender.messages[0].split()[-1]),
2181	        follow_redirects=False,
2182	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2193	    us_authenticate(client)
2194	    response = client.get("us-setup")
2195	    # note we test against REAL translations - don't use same code as view uses.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2215	    # register w/o password - this will automatically set up 'email'
2216	    client.post("/register", data=data, follow_redirects=True)
2217	    # will be auto-logged in since no confirmation

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2218	
2219	    response = client.get("us-setup")
2220	    with app.test_request_context():

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2228	    # white-box testing - there are 2 places in us-setup code that set active methods
2229	    response = client.post("us-setup", data=dict(delete_method="email"))
2230	    with app.test_request_context():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2237	
2238	    response = client.get("us-setup")
2239	    with app.test_request_context():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2253	    sms_sender = SmsSenderFactory.createSender("test")
2254	    response = client.get(
2255	        "/us-signin", data={}, headers={"Content-Type": "application/json"}
2256	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2261	    # verify requires CSRF
2262	    response = client.post(
2263	        "/us-signin",
2264	        json=dict(identity="gal@lp.com", passcode="password"),
2265	        headers={"Content-Type": "application/json"},
2266	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2269	
2270	    response = client.post(
2271	        "/us-signin",
2272	        json=dict(identity="gal@lp.com", passcode="password"),
2273	        headers={
2274	            "Content-Type": "application/json",
2275	            "X-CSRF-Token": client.get_cookie("XSRF-Token").value,
2276	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2284	
2285	    response = client.post(
2286	        "/tf-validate",
2287	        json=dict(code=code),
2288	        headers={
2289	            "Content-Type": "application/json",
2290	            "X-CSRF-Token": client.get_cookie("XSRF-Token").value,
2291	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2295	    # verify original session csrf_token still works.
2296	    response = client.post(
2297	        "/json_auth",
2298	        json=dict(label="label"),
2299	        headers={"Content-Type": "application/json", "X-CSRF-Token": csrf_token},
2300	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2303	    # use XSRF_Cookie to send in csrf_token
2304	    response = client.post(
2305	        "/json_auth",
2306	        json=dict(label="label"),
2307	        headers={
2308	            "Content-Type": "application/json",
2309	            "X-CSRF-Token": client.get_cookie("XSRF-Token").value,
2310	        },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2327	
2328	    client.get("/us-setup")
2329	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2344	
2345	    client.get("/us-setup")
2346	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2362	
2363	    client.get("/us-setup")
2364	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_unified_signin.py:2381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2380	
2381	    client.get("/us-setup")
2382	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_webauthn.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	        # This is from view_scaffold
185	        return "http://localhost:5001"
186	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_webauthn.py:1218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1217	        app.security.datastore.commit()
1218	        b64_user_handle = urlsafe_b64encode(
1219	            user.fs_webauthn_user_handle.encode()
1220	        ).decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/test_webauthn.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1246	        b64_user_handle = (
1247	            urlsafe_b64encode(user.fs_webauthn_user_handle.encode())
1248	            .decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/view_scaffold.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
81	            hb = html.encode()
82	            url = "data:text/html;base64," + base64.b64encode(hb).decode()
83	            webbrowser.open(url, new=1)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flask_security_too-5.6.1/flask_security_too-5.6.1/tests/view_scaffold.py:82
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
81	            hb = html.encode()
82	            url = "data:text/html;base64," + base64.b64encode(hb).decode()
83	            webbrowser.open(url, new=1)

--------------------------------------------------

Code scanned:
	Total lines of code: 26290
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 83.0
		High: 669.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 732.0
		High: 20.0
Files skipped (0):
