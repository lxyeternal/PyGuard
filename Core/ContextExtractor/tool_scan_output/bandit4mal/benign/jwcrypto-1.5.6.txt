Run started:2025-04-12 12:27:29.273407

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/common.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
15	        payload = payload.encode('utf-8')
16	    encode = urlsafe_b64encode(payload)
17	    return encode.decode('utf-8').rstrip('=')

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/common.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
27	        raise ValueError('Invalid base64 string')
28	    return urlsafe_b64decode(payload.encode('utf-8'))
29	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/jwe.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
431	                    'size' + f' ({default_max_compressed_size})')
432	            self.plaintext = zlib.decompress(data, -zlib.MAX_WBITS)
433	        elif compress is None:

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/jwe.py:432
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
431	                    'size' + f' ({default_max_compressed_size})')
432	            self.plaintext = zlib.decompress(data, -zlib.MAX_WBITS)
433	        elif compress is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1290	E_A4_protected = "eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0"
1291	E_A4_unprotected = {"jku": "https://server.example.com/keys.jwks"}
1292	E_A4_vector = \

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:1293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1292	E_A4_vector = \
1293	    '{"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0",' \
1294	    '"unprotected":{"jku":"https://server.example.com/keys.jwks"},' \
1295	    '"recipients":[' \
1296	    '{"header":{"alg":"RSA1_5","kid":"2011-04-29"},' \
1297	    '"encrypted_key":'\
1298	    '"UGhIOguC7IuEvf_NPVaXsGMoLOmwvc1GyqlIKOK1nN94nHPoltGRhWhw7Zx0-' \
1299	    'kFm1NJn8LE9XShH59_i8J0PH5ZZyNfGy2xGdULU7sHNF6Gp2vPLgNZ__deLKx' \
1300	    'GHZ7PcHALUzoOegEI-8E66jX2E4zyJKx-YxzZIItRzC5hlRirb6Y5Cl_p-ko3' \
1301	    'YvkkysZIFNPccxRU7qve1WYPxqbb2Yw8kZqa2rMWI5ng8OtvzlV7elprCbuPh' \
1302	    'cCdZ6XDP0_F8rkXds2vE4X-ncOIM8hAYHHi29NX0mcKiRaD0-D-ljQTP-cFPg' \
1303	    'wCp6X-nZZd9OHBv-B3oWh2TbqmScqXMR4gp_A"},' \
1304	    '{"header":{"alg":"A128KW","kid":"7"},' \
1305	    '"encrypted_key":' \
1306	    '"6KB707dM9YTIgHtLvtgWQ8mKwboJW3of9locizkDTHzBC2IlrT1oOQ"}],' \
1307	    '"iv":"AxY8DCtDaGlsbGljb3RoZQ",' \
1308	    '"ciphertext":"KDlTtXchhZTGufMYmOYGS4HffxPSUrfmqCHXaI9wOGY",' \
1309	    '"tag":"Mz-VPPyU4RlcuYv1IwIvzw"}'
1310	
1311	E_A4_ex = {'key1': jwk.JWK(**E_A2_key),
1312	           'header1': '{"alg":"RSA1_5","kid":"2011-04-29"}',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:1321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1320	E_A5_ex = \
1321	    '{"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0",' \
1322	    '"unprotected":{"jku":"https://server.example.com/keys.jwks"},' \
1323	    '"header":{"alg":"A128KW","kid":"7"},' \
1324	    '"encrypted_key":' \
1325	    '"6KB707dM9YTIgHtLvtgWQ8mKwboJW3of9locizkDTHzBC2IlrT1oOQ",' \
1326	    '"iv":"AxY8DCtDaGlsbGljb3RoZQ",' \
1327	    '"ciphertext":"KDlTtXchhZTGufMYmOYGS4HffxPSUrfmqCHXaI9wOGY",' \
1328	    '"tag":"Mz-VPPyU4RlcuYv1IwIvzw"}'
1329	
1330	customhdr_jwe_ex = \
1331	    '{"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0",' \

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:1331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1330	customhdr_jwe_ex = \
1331	    '{"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0",' \
1332	    '"unprotected":{"jku":"https://server.example.com/keys.jwks"},' \
1333	    '"header":{"alg":"A128KW","kid":"7", "custom1":"custom_val"},' \
1334	    '"encrypted_key":' \
1335	    '"6KB707dM9YTIgHtLvtgWQ8mKwboJW3of9locizkDTHzBC2IlrT1oOQ",' \
1336	    '"iv":"AxY8DCtDaGlsbGljb3RoZQ",' \
1337	    '"ciphertext":"KDlTtXchhZTGufMYmOYGS4HffxPSUrfmqCHXaI9wOGY",' \
1338	    '"tag":"Mz-VPPyU4RlcuYv1IwIvzw"}'
1339	
1340	Issue_136_Protected_Header_no_epk = {
1341	    "alg": "ECDH-ES+A256KW",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:1439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1438	            e = jwe.JWE(E_A1_ex['plaintext'], E_A1_ex['protected'],
1439	                        unprotected='{"jku":"https://example.com/keys.jwks"}',
1440	                        recipient=E_A1_ex['key'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:1515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1514	MMA_vector_ok_cek =  \
1515	    '{"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0",' \
1516	    '"unprotected":{"jku":"https://server.example.com/keys.jwks"},' \
1517	    '"recipients":[' \
1518	    '{"header":{"alg":"RSA1_5","kid":"2011-04-29"},' \
1519	    '"encrypted_key":'\
1520	    '"UGhIOguC7IuEvf_NPVaXsGMoLOmwvc1GyqlIKOK1nN94nHPoltGRhWhw7Zx0-' \
1521	    'kFm1NJn8LE9XShH59_i8J0PH5ZZyNfGy2xGdULU7sHNF6Gp2vPLgNZ__deLKx' \
1522	    'GHZ7PcHALUzoOegEI-8E66jX2E4zyJKx-YxzZIItRzC5hlRirb6Y5Cl_p-ko3' \
1523	    'YvkkysZIFNPccxRU7qve1WYPxqbb2Yw8kZqa2rMWI5ng8OtvzlV7elprCbuPh' \
1524	    'cCdZ6XDP0_F8rkXds2vE4X-ncOIM8hAYHHi29NX0mcKiRaD0-D-ljQTP-cFPg' \
1525	    'wCp6X-nZZd9OHBv-B3oWh2TbqmScqXMR4gp_A"}],' \
1526	    '"iv":"AxY8DCtDaGlsbGljb3RoZQ",' \
1527	    '"ciphertext":"PURPOSEFULLYBROKENYGS4HffxPSUrfmqCHXaI9wOGY",' \
1528	    '"tag":"Mz-VPPyU4RlcuYv1IwIvzw"}'
1529	MMA_vector_ko_cek = \
1530	    '{"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0",' \

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:1530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1529	MMA_vector_ko_cek = \
1530	    '{"protected":"eyJlbmMiOiJBMTI4Q0JDLUhTMjU2In0",' \
1531	    '"unprotected":{"jku":"https://server.example.com/keys.jwks"},' \
1532	    '"recipients":[' \
1533	    '{"header":{"alg":"RSA1_5","kid":"2011-04-29"},' \
1534	    '"encrypted_key":'\
1535	    '"UGhIOguC7IuEvf_NPVaYsGMoLOmwvc1GyqlIKOK1nN94nHPoltGRhWhw7Zx0-' \
1536	    'kFm1NJn8LE9XShH59_i8J0PH5ZZyNfGy2xGdULU7sHNF6Gp2vPLgNZ__deLKx' \
1537	    'GHZ7PcHALUzoOegEI-8E66jX2E4zyJKx-YxzZIItRzC5hlRirb6Y5Cl_p-ko3' \
1538	    'YvkkysZIFNPccxRU7qve1WYPxqbb2Yw8kZqa2rMWI5ng8OtvzlV7elprCbuPh' \
1539	    'cCdZ6XDP0_F8rkXds2vE4X-ncOIM8hAYHHi29NX0mcKiRaD0-D-ljQTP-cFPg' \
1540	    'wCp6X-nZZd9OHBv-B3oWh2TbqmScqXMR4gp_A"}],' \
1541	    '"iv":"AxY8DCtDaGlsbGljb3RoZQ",' \
1542	    '"ciphertext":"PURPOSEFULLYBROKENYGS4HffxPSUrfmqCHXaI9wOGY",' \
1543	    '"tag":"Mz-VPPyU4RlcuYv1IwIvzw"}'
1544	
1545	
1546	class TestMMA(unittest.TestCase):
1547	    @classmethod

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:1602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1601	    "exp": 1300819380,
1602	    "http://example.com/is_root": True}
1603	
1604	A1_token = \
1605	    "eyJhbGciOiJSU0ExXzUiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0." + \
1606	    "QR1Owv2ug2WyPBnbQrRARTeEk9kDO2w8qDcjiHnSJflSdv1iNqhWXaKH4MqAkQtM" + \

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/jwcrypto/tests.py:2056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2055	        self.assertEqual(json_decode(token.claims),
2056	                         {"iss": "joe", "http://example.com/is_root": True})
2057	        with self.assertRaises(KeyError):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
14	with open(os.path.join('jwcrypto', 'VERSION')) as verfile:
15	    version = verfile.read().strip()
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jwcrypto-1.5.6/jwcrypto-1.5.6/setup.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    maintainer_email = 'simo@redhat.com',
23	    url='https://github.com/latchset/jwcrypto',
24	    packages = ['jwcrypto'],

--------------------------------------------------

Code scanned:
	Total lines of code: 7038
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 4.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 1.0
Files skipped (0):
