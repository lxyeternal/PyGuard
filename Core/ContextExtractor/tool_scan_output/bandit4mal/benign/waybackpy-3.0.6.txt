Run started:2025-04-12 10:16:27.081466

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_availability_api.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	now = datetime.utcnow()
14	url = "https://example.com/"
15	user_agent = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_availability_api.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    """
31	    url = "https://example.com/"
32	    user_agent = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_availability_api.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    """
55	    url = "https://www.youtube.com/"
56	    user_agent = "Mozilla/5.0 (X11; Linux x86_64; rv:96.0) Gecko/20100101 Firefox/96.0"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_api.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    )
21	    url = "https://twitter.com/jack"
22	
23	    wayback = WaybackMachineCDXServerAPI(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_api.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    )
44	    url = "https://www.google.com"
45	
46	    wayback = WaybackMachineCDXServerAPI(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_api.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    )
66	    url = "https://www.google.com"
67	
68	    cdx = WaybackMachineCDXServerAPI(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_snapshot.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	    sample_input = (
8	        "org,archive)/ 20080126045828 http://github.com "
9	        "text/html 200 Q4YULN754FHV2U6Q5JUT6Q2P57WEWNNY 1415"
10	    )
11	    prop_values = sample_input.split(" ")
12	    properties = {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_snapshot.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    archive_url = (
37	        "https://web.archive.org/web/"
38	        + properties["timestamp"]
39	        + "/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	def test_full_url() -> None:
27	    endpoint = "https://web.archive.org/cdx/search/cdx"
28	    params: Dict[str, Any] = {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    params = {"a": "1"}
32	    assert full_url(endpoint, params) == "https://web.archive.org/cdx/search/cdx?a=1"
33	    assert (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_utils.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    assert (
34	        full_url(endpoint + "?", params) == "https://web.archive.org/cdx/search/cdx?a=1"
35	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	        full_url(endpoint + "?", params)
40	        == "https://web.archive.org/cdx/search/cdx?a=1&b=2"
41	    )
42	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        full_url(endpoint + "?", params)
46	        == "https://web.archive.org/cdx/search/cdx?a=1&b=2&c=foo%20bar"
47	    )
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_utils.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	def test_get_response() -> None:
51	    url = "https://github.com"
52	    user_agent = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cdx_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	
64	    filters = ["statuscode:200", "timestamp:20215678901234", "original:https://url.com"]
65	    check_filters(filters)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    runner = CliRunner()
10	    result = runner.invoke(main, ["--url", " https://github.com ", "--oldest"])
11	    assert result.exit_code == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        result.output
14	        == "Archive URL:\nhttps://web.archive.org/web/2008051421\
15	0148/http://github.com/\n"
16	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            "--url",
25	            " https://facebook.com ",
26	            "--near",
27	            "--year",
28	            "2010",
29	            "--month",
30	            "5",
31	            "--day",
32	            "10",
33	            "--hour",
34	            "6",
35	        ],
36	    )
37	    assert result.exit_code == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	        result.output
40	        == "Archive URL:\nhttps://web.archive.org/web/2010051008\
41	2647/http://www.facebook.com/\n"
42	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    runner = CliRunner()
47	    result = runner.invoke(main, ["--url", " https://microsoft.com ", "--newest"])
48	    assert result.exit_code == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	        main,
59	        "--url https://twitter.com/jack --cdx --user-agent some-user-agent \
60	--start-timestamp 2010 --end-timestamp 2012 --collapse urlkey \

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        main,
75	        "--url https://yahoo.com --user_agent my-unique-user-agent \
76	--save --headers".split(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	        result.output
102	        == requests.get(
103	            url="https://raw.githubusercontent.com/akamhy/waybackpy/master/LICENSE"
104	        ).text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	        == requests.get(
103	            url="https://raw.githubusercontent.com/akamhy/waybackpy/master/LICENSE"
104	        ).text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	    runner = CliRunner()
111	    result = runner.invoke(main, ["--url", "https://google.com"])
112	    assert result.exit_code == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	    result = runner.invoke(
124	        main, ["--url", "https://akamhy.github.io", "--known-urls", "--file"]
125	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_cli.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	    runner = CliRunner()
133	    result = runner.invoke(main, ["--url", "https://akamhy.github.io", "--known-urls"])
134	    assert result.exit_code == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	def test_save() -> None:
21	    url = "https://github.com/akamhy/waybackpy"
22	    user_agent = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    """
57	    url = "https://example.com"
58	    user_agent = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	def test_timestamp() -> None:
75	    url = "https://example.com"
76	    user_agent = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    now = datetime.utcnow().strftime("%Y%m%d%H%M%S")
82	    save_api._archive_url = f"https://web.archive.org/web/{now}/{url}/"
83	    save_api.timestamp()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	    now = "20100124063622"
86	    save_api._archive_url = f"https://web.archive.org/web/{now}/{url}/"
87	    save_api.timestamp()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	    """
95	    url = "https://example.com"
96	    user_agent = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	    h = (
103	        "\nSTART\nContent-Location: "
104	        "/web/20201126185327/https://www.scribbr.com/citing-sources/et-al"
105	        "\nEND\n"
106	    )
107	    save_api.headers = h  # type: ignore[assignment]
108	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	    expected_url = (
110	        "https://web.archive.org/web/20201126185327/"
111	        "https://www.scribbr.com/citing-sources/et-al"
112	    )
113	    assert save_api.archive_url_parser() == expected_url
114	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	        "Link": (
132	            '<https://www.scribbr.com/citing-sources/et-al/>; rel="original", '
133	            "<https://web.archive.org/web/timemap/link/https://www.scribbr.com/"
134	            'citing-sources/et-al/>; rel="timemap"; type="application/link-format", '
135	            "<https://web.archive.org/web/https://www.scribbr.com/citing-sources/"
136	            'et-al/>; rel="timegate", <https://web.archive.org/web/20200601082911/'
137	            'https://www.scribbr.com/citing-sources/et-al/>; rel="first memento"; '
138	            'datetime="Mon, 01 Jun 2020 08:29:11 GMT", <https://web.archive.org/web/'
139	            "20201126185327/https://www.scribbr.com/citing-sources/et-al/>; "
140	            'rel="prev memento"; datetime="Thu, 26 Nov 2020 18:53:27 GMT", '
141	            "<https://web.archive.org/web/20210102094009/https://www.scribbr.com/"
142	            'citing-sources/et-al/>; rel="memento"; datetime="Sat, 02 Jan 2021 '
143	            '09:40:09 GMT", <https://web.archive.org/web/20210102094009/'
144	            "https://www.scribbr.com/citing-sources/et-al/>; "
145	            'rel="last memento"; datetime="Sat, 02 Jan 2021 09:40:09 GMT"'
146	        ),
147	        "Content-Security-Policy": (
148	            "default-src 'self' 'unsafe-eval' 'unsafe-inline' "
149	            "data: blob: archive.org web.archive.org analytics.archive.org "
150	            "pragma.archivelab.org",
151	        ),
152	        "X-Archive-Src": "spn2-20210102092956-wwwb-spn20.us.archive.org-8001.warc.gz",
153	        "Server-Timing": (
154	            "captures_list;dur=112.646325, exclusion.robots;dur=0.172010, "
155	            "exclusion.robots.policy;dur=0.158205, RedisCDXSource;dur=2.205932, "
156	            "esindex;dur=0.014647, LoadShardBlock;dur=82.205012, "
157	            "PetaboxLoader3.datanode;dur=70.750239, CDXLines.iter;dur=24.306278, "
158	            "load_resource;dur=26.520179"
159	        ),
160	        "X-App-Server": "wwwb-app200",
161	        "X-ts": "200",
162	        "X-location": "All",
163	        "X-Cache-Key": (
164	            "httpsweb.archive.org/web/20210102094009/"
165	            "https://www.scribbr.com/citing-sources/et-al/IN",
166	        ),
167	        "X-RL": "0",
168	        "X-Page-Cache": "MISS",
169	        "X-Archive-Screenname": "0",
170	        "Content-Encoding": "gzip",
171	    }
172	
173	    save_api.headers = cast(CaseInsensitiveDict[str], headers)
174	
175	    expected_url2 = (
176	        "https://web.archive.org/web/20210102094009/"
177	        "https://www.scribbr.com/citing-sources/et-al/"
178	    )
179	    assert save_api.archive_url_parser() == expected_url2
180	
181	    expected_url_3 = (
182	        "https://web.archive.org/web/20171128185327/"
183	        "https://www.scribbr.com/citing-sources/et-al/US"
184	    )
185	    h = f"START\nX-Cache-Key: {expected_url_3}\nEND\n"
186	    save_api.headers = h  # type: ignore[assignment]
187	
188	    expected_url4 = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
163	        "X-Cache-Key": (
164	            "httpsweb.archive.org/web/20210102094009/"
165	            "https://www.scribbr.com/citing-sources/et-al/IN",
166	        ),
167	        "X-RL": "0",
168	        "X-Page-Cache": "MISS",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	    expected_url2 = (
176	        "https://web.archive.org/web/20210102094009/"
177	        "https://www.scribbr.com/citing-sources/et-al/"
178	    )
179	    assert save_api.archive_url_parser() == expected_url2
180	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
181	    expected_url_3 = (
182	        "https://web.archive.org/web/20171128185327/"
183	        "https://www.scribbr.com/citing-sources/et-al/US"
184	    )
185	    h = f"START\nX-Cache-Key: {expected_url_3}\nEND\n"
186	    save_api.headers = h  # type: ignore[assignment]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	    expected_url4 = (
189	        "https://web.archive.org/web/20171128185327/"
190	        "https://www.scribbr.com/citing-sources/et-al/"
191	    )
192	    assert save_api.archive_url_parser() == expected_url4
193	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
196	    save_api.response_url = (
197	        "https://web.archive.org/web/20171128185327/"
198	        "https://www.scribbr.com/citing-sources/et-al"
199	    )
200	    expected_url5 = (
201	        "https://web.archive.org/web/20171128185327/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	    expected_url5 = (
201	        "https://web.archive.org/web/20171128185327/"
202	        "https://www.scribbr.com/citing-sources/et-al"
203	    )
204	    assert save_api.archive_url_parser() == expected_url5
205	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	    """
213	    url = "https://example.com"
214	    user_agent = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_save_api.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	    save_api.saved_archive = (
220	        "https://web.archive.org/web/20220124063056/https://example.com/"
221	    )
222	    save_api._archive_url = save_api.saved_archive
223	    assert save_api.archive_url == save_api.saved_archive

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_utils.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	        DEFAULT_USER_AGENT
8	        == f"waybackpy {__version__} - https://github.com/akamhy/waybackpy"
9	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_wrapper.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	def test_oldest() -> None:
5	    url = "https://bing.com"
6	    oldest_archive = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_wrapper.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	    oldest_archive = (
7	        "https://web.archive.org/web/20030726111100/http://www.bing.com:80/"
8	    )
9	    wayback = Url(url).oldest()
10	    assert wayback.archive_url == oldest_archive

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_wrapper.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	def test_newest() -> None:
16	    url = "https://www.youtube.com/"
17	    wayback = Url(url).newest()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_wrapper.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	def test_near() -> None:
23	    url = "https://www.google.com"
24	    wayback = Url(url).near(year=2010, month=10, day=10, hour=10, minute=10)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_wrapper.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	def test_total_archives() -> None:
29	    wayback = Url("https://akamhy.github.io")
30	    assert wayback.total_archives() > 10

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_wrapper.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	
32	    wayback = Url("https://gaha.ef4i3n.m5iai3kifp6ied.cima/gahh2718gs/ahkst63t7gad8")
33	    assert wayback.total_archives() == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/tests/test_wrapper.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	def test_Save() -> None:
42	    wayback = Url("https://en.wikipedia.org/wiki/Asymptotic_equipartition_property")
43	    wayback.save()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/availability_api.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        self.payload: Dict[str, str] = {"url": self.url}
57	        self.endpoint: str = "https://archive.org/wayback/available"
58	        self.max_tries: int = max_tries

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/availability_api.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	
105	        self.response = requests.get(
106	            self.endpoint, params=self.payload, headers=self.headers
107	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/availability_api.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	            archive_url = archive_url.replace(
189	                "http://web.archive.org/web/", "https://web.archive.org/web/", 1
190	            )
191	        return archive_url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/availability_api.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	            archive_url = archive_url.replace(
189	                "http://web.archive.org/web/", "https://web.archive.org/web/", 1
190	            )
191	        return archive_url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/cdx_api.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        self.last_api_request_url: Optional[str] = None
80	        self.endpoint = "https://web.archive.org/cdx/search/cdx"
81	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/cdx_snapshot.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        self.archive_url: str = (
73	            f"https://web.archive.org/web/{self.timestamp}/{self.original}"
74	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/cdx_utils.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    """
26	    endpoint = "https://web.archive.org/cdx/search/cdx?"
27	    payload = {"showNumPages": "true", "url": str(url)}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/cdx_utils.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	    session.mount("https://", HTTPAdapter(max_retries=retries_))
103	    response = session.get(url, headers=headers)
104	    session.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/cli.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
152	        with open(file_path, "a", encoding="utf-8") as file:
153	            file.write(f"{url}\n")
154	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/cli.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
391	        click.echo(
392	            requests.get(
393	                url="https://raw.githubusercontent.com/akamhy/waybackpy/master/LICENSE"
394	            ).text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/cli.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
392	            requests.get(
393	                url="https://raw.githubusercontent.com/akamhy/waybackpy/master/LICENSE"
394	            ).text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/save_api.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	        self.url = str(url).strip().replace(" ", "%20")
36	        self.request_url = "https://web.archive.org/save/" + self.url
37	        self.user_agent = user_agent

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/save_api.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	        session.mount("https://", HTTPAdapter(max_retries=retries))
89	        self.response = session.get(self.request_url, headers=self.request_headers)
90	        # requests.response.headers is requests.structures.CaseInsensitiveDict

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/save_api.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	        if match:
124	            return "https://web.archive.org" + match.group(1)
125	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/waybackpy-3.0.6/waybackpy-3.0.6/waybackpy/utils.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	DEFAULT_USER_AGENT: str = (
10	    f"waybackpy {__version__} - https://github.com/akamhy/waybackpy"
11	)

--------------------------------------------------

Code scanned:
	Total lines of code: 2216
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 61.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 67.0
		High: 0.0
Files skipped (0):
