Run started:2025-04-13 07:03:56.010453

Test results:
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/mod_wsgi_tester.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
16	        try:
17	            urllib.request.urlopen(url)  # noqa: S310
18	            return

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/mod_wsgi_tester.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    write_env("APACHE_CONFIG", apache_config)
53	    uri1 = f"http://localhost:8080/interpreter1{project_directory}"
54	    write_env("TEST_URI1", uri1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/mod_wsgi_tester.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    write_env("TEST_URI1", uri1)
55	    uri2 = f"http://localhost:8080/interpreter2{project_directory}"
56	    write_env("TEST_URI2", uri2)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/run_tests.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
106	        target = ROOT / "test/lambda/mongodb" / dname
107	        shutil.rmtree(target, ignore_errors=True)
108	        shutil.copytree(ROOT / dname, target)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
65	    arch = platform.machine()
66	    with open("/etc/os-release") as fid:
67	        for line in fid.readlines():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	        if is_set("TEST_FLE_GCP_AUTO"):
81	            run_command('powershell.exe "Invoke-WebRequest -URI https://oauth2.googleapis.com/"')
82	        target = "windows-test"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	            raise ValueError("Cannot find libmongocrypt target for current platform!")
103	        url = f"https://s3.amazonaws.com/mciuploads/libmongocrypt/{target}/master/latest/libmongocrypt.tar.gz"
104	    else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
106	
107	    shutil.rmtree(HERE / "libmongocrypt", ignore_errors=True)
108	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
109	    LOGGER.info(f"Fetching {url}...")
110	    with request.urlopen(request.Request(url), timeout=15.0) as response:  # noqa: S310
111	        if response.status == 200:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
109	    LOGGER.info(f"Fetching {url}...")
110	    with request.urlopen(request.Request(url), timeout=15.0) as response:  # noqa: S310
111	        if response.status == 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	        if response.status == 200:
112	            fileobj = io.BytesIO(response.read())
113	        with tarfile.open("libmongocrypt.tar.gz", fileobj=fileobj) as fid:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
112	            fileobj = io.BytesIO(response.read())
113	        with tarfile.open("libmongocrypt.tar.gz", fileobj=fileobj) as fid:
114	            fid.extractall(Path.cwd() / "libmongocrypt")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
153	    # Create the test env file with the initial set of values.
154	    with ENV_FILE.open("w", newline="\n") as fid:
155	        fid.write("#!/usr/bin/env bash\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
154	    with ENV_FILE.open("w", newline="\n") as fid:
155	        fid.write("#!/usr/bin/env bash\n")
156	        fid.write("set +x\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	        fid.write("#!/usr/bin/env bash\n")
156	        fid.write("set +x\n")
157	    ENV_FILE.chmod(ENV_FILE.stat().st_mode | stat.S_IEXEC)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
156	        fid.write("set +x\n")
157	    ENV_FILE.chmod(ENV_FILE.stat().st_mode | stat.S_IEXEC)
158	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
270	            LOGGER.info("Writing keytab")
271	            keytab = base64.b64decode(config["KEYTAB_BASE64"])
272	            keytab_file = ROOT / ".evergreen/drivers.keytab"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:271
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
270	            LOGGER.info("Writing keytab")
271	            keytab = base64.b64decode(config["KEYTAB_BASE64"])
272	            keytab_file = ROOT / ".evergreen/drivers.keytab"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
272	            keytab_file = ROOT / ".evergreen/drivers.keytab"
273	            with keytab_file.open("wb") as fid:
274	                fid.write(keytab)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
273	            with keytab_file.open("wb") as fid:
274	                fid.write(keytab)
275	            principal = config["PRINCIPAL"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/setup_tests.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
433	        if not data_dir.exists():
434	            run_command("git clone --depth 1 https://github.com/mongodb/specifications.git")
435	            run_command("tar xf extended_bson.tgz", cwd=data_dir)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/teardown_tests.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
54	elif TEST_NAME == "perf":
55	    shutil.rmtree(ROOT / "specifications", ignore_errors=True)
56	    Path(os.environ["OUTPUT_FILE"]).unlink(missing_ok=True)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/teardown_tests.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
69	if os.environ.get("COVERAGE"):
70	    shutil.rmtree(".pytest_cache", ignore_errors=True)
71	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/.evergreen/scripts/utils.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	        value = str(value).replace('"', "")
165	        fid.write(f'export {name}="{value}"\n')
166	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/_setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	    warning_message = """
25	********************************************************************
26	WARNING: %s could not
27	be compiled. No C extensions are essential for PyMongo to run,
28	although they do result in significant speed improvements.
29	%s
30	
31	Please see the installation docs for solutions to build issues:
32	
33	https://pymongo.readthedocs.io/en/stable/installation.html
34	
35	Here are some hints for popular operating systems:
36	
37	If you are seeing this message on Linux you probably need to
38	install GCC and/or the Python development package for your
39	version of Python.
40	
41	Debian and Ubuntu users should issue the following command:
42	
43	    $ sudo apt-get install build-essential python-dev
44	
45	Users of Red Hat based distributions (RHEL, CentOS, Amazon Linux,
46	Oracle Linux, Fedora, etc.) should issue the following command:
47	
48	    $ sudo yum install gcc python-devel
49	
50	If you are seeing this message on Microsoft Windows please install
51	PyMongo using pip. Modern versions of pip will install PyMongo
52	from binary wheels available on pypi. If you must install from
53	source read the documentation here:
54	
55	https://pymongo.readthedocs.io/en/stable/installation.html#installing-from-source-on-windows
56	
57	If you are seeing this message on macOS / OSX please install PyMongo
58	using pip. Modern versions of pip will install PyMongo from binary
59	wheels available on pypi. If wheels are not available for your version
60	of macOS / OSX, or you must install from source read the documentation
61	here:
62	
63	https://pymongo.readthedocs.io/en/stable/installation.html#osx
64	********************************************************************
65	"""
66	
67	    def run(self):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/_setup.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	            e = sys.exc_info()[1]
74	            sys.stdout.write("%s\n" % str(e))
75	            warnings.warn(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/_setup.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	            e = sys.exc_info()[1]
97	            sys.stdout.write("%s\n" % str(e))
98	            warnings.warn(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/_setup.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
133	elif sys.platform.startswith("java") or sys.platform == "cli" or "PyPy" in sys.version:
134	    sys.stdout.write(
135	        """
136	*****************************************************\n

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/__init__.py:1369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1368	        # Read size of next object.
1369	        size_data: Any = file_obj.read(4)
1370	        if not size_data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/__init__.py:1375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1374	        obj_size = _UNPACK_INT_FROM(size_data, 0)[0] - 4
1375	        elements = size_data + file_obj.read(max(0, obj_size))
1376	        yield _bson_to_dict(elements, opts)  # type:ignore[arg-type, misc]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/datetime_ms.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	_DATETIME_ERROR_SUGGESTION = (
32	    "(Consider Using CodecOptions(datetime_conversion=DATETIME_AUTO)"
33	    " or MongoClient(datetime_conversion='DATETIME_AUTO'))."
34	    " See: https://www.mongodb.com/docs/languages/python/pymongo-driver/current/data-formats/dates-and-times/#handling-out-of-range-datetimes"
35	)
36	
37	
38	class DatetimeMS:
39	    """Represents a BSON UTC datetime."""

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/json_util.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
591	        subtype = int(doc["$type"][6:], 16)
592	    data = base64.b64decode(doc["$binary"].encode())
593	    return _binary_or_uuid(data, subtype, json_options)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/json_util.py:592
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
591	        subtype = int(doc["$type"][6:], 16)
592	    data = base64.b64decode(doc["$binary"].encode())
593	    return _binary_or_uuid(data, subtype, json_options)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/json_util.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
606	
607	    data = base64.b64decode(b64.encode())
608	    return _binary_or_uuid(data, int(subtype, 16), json_options)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/json_util.py:607
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
606	
607	    data = base64.b64decode(b64.encode())
608	    return _binary_or_uuid(data, int(subtype, 16), json_options)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/json_util.py:843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
842	    if json_options.json_mode == JSONMode.LEGACY:
843	        return {"$binary": base64.b64encode(data).decode(), "$type": "%02x" % subtype}
844	    return {"$binary": {"base64": base64.b64encode(data).decode(), "subType": "%02x" % subtype}}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/json_util.py:843
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
842	    if json_options.json_mode == JSONMode.LEGACY:
843	        return {"$binary": base64.b64encode(data).decode(), "$type": "%02x" % subtype}
844	    return {"$binary": {"base64": base64.b64encode(data).decode(), "subType": "%02x" % subtype}}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/json_util.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
843	        return {"$binary": base64.b64encode(data).decode(), "$type": "%02x" % subtype}
844	    return {"$binary": {"base64": base64.b64encode(data).decode(), "subType": "%02x" % subtype}}
845	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/bson/json_util.py:844
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
843	        return {"$binary": base64.b64encode(data).decode(), "$type": "%02x" % subtype}
844	    return {"$binary": {"base64": base64.b64encode(data).decode(), "subType": "%02x" % subtype}}
845	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/doc/conf.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	linkcheck_ignore = [
88	    "https://github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-monitoring.md#requesting-an-immediate-check",
89	    "https://github.com/mongodb/libmongocrypt/blob/master/bindings/python/README.rst#installing-from-source",
90	    r"https://wiki.centos.org/[\w/]*",
91	    r"https://sourceforge.net/",
92	]
93	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/doc/conf.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	    "https://github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-monitoring.md#requesting-an-immediate-check",
89	    "https://github.com/mongodb/libmongocrypt/blob/master/bindings/python/README.rst#installing-from-source",
90	    r"https://wiki.centos.org/[\w/]*",
91	    r"https://sourceforge.net/",
92	]
93	
94	# -- Options for extensions ----------------------------------------------------

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/doc/conf.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	    "https://github.com/mongodb/libmongocrypt/blob/master/bindings/python/README.rst#installing-from-source",
90	    r"https://wiki.centos.org/[\w/]*",
91	    r"https://sourceforge.net/",
92	]
93	
94	# -- Options for extensions ----------------------------------------------------
95	autoclass_content = "init"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/doc/conf.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	    r"https://wiki.centos.org/[\w/]*",
91	    r"https://sourceforge.net/",
92	]
93	
94	# -- Options for extensions ----------------------------------------------------
95	autoclass_content = "init"
96	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/doc/conf.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	intersphinx_mapping = {
201	    "gevent": ("https://www.gevent.org/", None),
202	    "py": ("https://docs.python.org/3/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/doc/conf.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
201	    "gevent": ("https://www.gevent.org/", None),
202	    "py": ("https://docs.python.org/3/", None),
203	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/_azure_helpers.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	
28	    url = "http://169.254.169.254/metadata/identity/oauth2/token"
29	    url += "?api-version=2018-02-01"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/_azure_helpers.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
35	    try:
36	        with urlopen(request, timeout=timeout) as response:  # noqa: S310
37	            status = response.status

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/_gcp_helpers.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	    url = "http://metadata/computeMetadata/v1/instance/service-accounts/default/identity"
25	    url += f"?audience={resource}"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/_gcp_helpers.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
28	    try:
29	        with urlopen(request, timeout=timeout) as response:  # noqa: S310
30	            status = response.status

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/auth.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
120	    if not client_key or salt != csalt or iterations != citerations:
121	        salted_pass = hashlib.pbkdf2_hmac(digest, data, standard_b64decode(salt), iterations)
122	        client_key = _hmac(salted_pass, b"Client Key", digestmod).digest()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/auth.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
127	    client_sig = _hmac(stored_key, auth_msg, digestmod).digest()
128	    client_proof = b"p=" + standard_b64encode(_xor(client_key, client_sig))
129	    client_final = b",".join((without_proof, client_proof))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/auth.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
130	
131	    server_sig = standard_b64encode(_hmac(server_key, auth_msg, digestmod).digest())
132	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/cursor.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	            warnings.warn(
155	                "use an explicit session with no_cursor_timeout=True "
156	                "otherwise the cursor may still timeout after "
157	                "30 minutes, for more info see "
158	                "https://mongodb.com/docs/v4.4/reference/method/"
159	                "cursor.noCursorTimeout/"
160	                "#session-idle-timeout-overrides-nocursortimeout",
161	                UserWarning,
162	                stacklevel=2,
163	            )
164	        if cursor_type not in (

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
198	            try:
199	                await async_socket_sendall(conn, message)
200	                while kms_context.bytes_needed > 0:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
201	                    # CSOT: update timeout.
202	                    conn.settimeout(max(_csot.clamp_remaining(_KMS_CONNECT_TIMEOUT), 0))
203	                    if _IS_SYNC:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
203	                    if _IS_SYNC:
204	                        data = conn.recv(kms_context.bytes_needed)
205	                    else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
228	            finally:
229	                conn.close()
230	        except MongoCryptError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
347	        if self.mongocryptd_client:
348	            await self.mongocryptd_client.close()
349	            self.mongocryptd_client = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
486	        self._closed = True
487	        await self._auto_encrypter.close()
488	        if self._internal_client:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
488	        if self._internal_client:
489	            await self._internal_client.close()
490	            self._internal_client = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1202	        assert self._key_vault_coll is not None
1203	        result = await self._key_vault_coll.bulk_write(replacements)
1204	        return RewrapManyDataKeyResult(result)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:1210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1209	    async def __aexit__(self, exc_type: Any, exc_val: Any, exc_tb: Any) -> None:
1210	        await self.close()
1211	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:1228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1227	        if self._io_callbacks:
1228	            await self._io_callbacks.close()
1229	            self._encryption.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/encryption.py:1229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1228	            await self._io_callbacks.close()
1229	            self._encryption.close()
1230	            self._io_callbacks = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/mongo_client.py:1902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1901	
1902	        return await self._retryable_read(
1903	            _cmd,
1904	            operation.read_preference,
1905	            operation.session,  # type: ignore[arg-type]
1906	            address=address,
1907	            retryable=isinstance(operation, _Query),
1908	            operation=operation.name,
1909	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/mongo_client.py:2716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2715	        if self._is_session_state_retryable() and self._retryable and not self._is_read:
2716	            self._session._start_retryable_write()  # type: ignore
2717	            if self._bulk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/mongo_client.py:2723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2722	            try:
2723	                return await self._read() if self._is_read else await self._write()
2724	            except ServerSelectionTimeoutError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/mongo_client.py:2723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2722	            try:
2723	                return await self._read() if self._is_read else await self._write()
2724	            except ServerSelectionTimeoutError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/mongo_client.py:2909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2908	                _CLIENT_LOGGER,
2909	                "You appear to be connected to a CosmosDB cluster. For more information regarding feature "
2910	                "compatibility and support please visit https://www.mongodb.com/supportability/cosmosdb",
2911	            )
2912	            return True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/mongo_client.py:2917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2916	                _CLIENT_LOGGER,
2917	                "You appear to be connected to a DocumentDB cluster. For more information regarding feature "
2918	                "compatibility and support please visit https://www.mongodb.com/supportability/documentdb",
2919	            )
2920	            return True

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/pool.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
196	        self.last_timeout = timeout
197	        self.conn.get_conn.settimeout(timeout)
198	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/pool.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
451	        try:
452	            await async_sendall(self.conn.get_conn, message)
453	        # Catch KeyboardInterrupt, CancelledError, etc. and cleanup.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/pool.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
581	        try:
582	            await self.conn.close()
583	        except Exception:  # noqa: S110

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/pool.py:961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
960	                    incremented = True
961	                conn = await self.connect()
962	                close_conn = False

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/pool.py:1170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1169	            _raise_connection_failure(
1170	                self.address, AutoReconnect("connection pool paused"), timeout_details=details
1171	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/pool.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1262	                    try:
1263	                        conn = await self.connect(handler=handler)
1264	                    finally:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/asynchronous/topology.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	            warnings.warn(  # type: ignore[call-overload] # noqa: B028
238	                "AsyncMongoClient opened before fork. May not be entirely fork-safe, "
239	                "proceed with caution. See PyMongo's documentation for details: "
240	                "https://dochub.mongodb.org/core/pymongo-fork-deadlock",
241	                **kwargs,
242	            )
243	            async with self._lock:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/auth_oidc_shared.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	        with open(token_file) as fid:
87	            return OIDCCallbackResult(access_token=fid.read().strip())
88	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/auth_oidc_shared.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
97	        with open(token_file) as fid:
98	            return OIDCCallbackResult(access_token=fid.read().strip())
99	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/auth_oidc_shared.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
131	    with open(fname) as fid:
132	        return fid.read()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/auth_shared.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
159	            "localhost",
160	            "127.0.0.1",
161	            "::1",
162	        ]
163	        allowed_hosts = properties.get("ALLOWED_HOSTS", default_allowed)
164	        if properties.get("ALLOWED_HOSTS", None) is not None and human_callback is None:
165	            raise ConfigurationError("ALLOWED_HOSTS is only valid with OIDC_HUMAN_CALLBACK")
166	        msg = (
167	            "authentication with MONGODB-OIDC requires providing either a callback or a environment"
168	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/auth_shared.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
243	    user = username.encode("utf-8").replace(b"=", b"=3D").replace(b",", b"=2C")
244	    nonce = standard_b64encode(os.urandom(32))
245	    first_bare = b"n=" + user + b",r=" + nonce

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/compression_support.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
166	
167	        return zlib.decompress(data)
168	    elif compressor_id == ZstdContext.compressor_id:

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/compression_support.py:167
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
166	
167	        return zlib.decompress(data)
168	    elif compressor_id == ZstdContext.compressor_id:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/compression_support.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
172	
173	        return zstandard.ZstdDecompressor().decompress(data)
174	    else:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/daemon.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
124	        if sys.executable:
125	            _spawn_daemon_double_popen(args)
126	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
784	    # Flags
785	    buf.write(flags)
786	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
787	    # Type 0 Section
788	    buf.write(b"\x00")
789	    buf.write(_dict_to_bson(command, False, opts))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
788	    buf.write(b"\x00")
789	    buf.write(_dict_to_bson(command, False, opts))
790	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:792
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
791	    # Type 1 Section
792	    buf.write(b"\x01")
793	    size_location = buf.tell()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
794	    # Save space for size
795	    buf.write(b"\x00\x00\x00\x00")
796	    try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
796	    try:
797	        buf.write(_OP_MSG_MAP[operation])
798	    except KeyError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
821	            break
822	        buf.write(value)
823	        to_send.append(doc)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
831	    buf.seek(size_location)
832	    buf.write(_pack_int(length - size_location))
833	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
887	    # Save space for message length and request id
888	    buf.write(_ZERO_64)
889	    # responseTo, opCode

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
889	    # responseTo, opCode
890	    buf.write(b"\x00\x00\x00\x00\xdd\x07\x00\x00")
891	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
896	    request_id = _randint()
897	    buf.write(_pack_int(request_id))
898	    buf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
898	    buf.seek(0)
899	    buf.write(_pack_int(length))
900	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1001	    flags = b"\x00\x00\x00\x00" if ack else b"\x02\x00\x00\x00"
1002	    buf.write(flags)
1003	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1004	    # Type 0 Section
1005	    buf.write(b"\x00")
1006	    buf.write(command_encoded)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1005	    buf.write(b"\x00")
1006	    buf.write(command_encoded)
1007	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1008	    # Type 1 Section for ops
1009	    buf.write(b"\x01")
1010	    size_location = buf.tell()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1011	    # Save space for size
1012	    buf.write(b"\x00\x00\x00\x00")
1013	    buf.write(b"ops\x00")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1012	    buf.write(b"\x00\x00\x00\x00")
1013	    buf.write(b"ops\x00")
1014	    # Write all the ops documents

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1015	    for op_encoded in to_send_ops_encoded:
1016	        buf.write(op_encoded)
1017	    resume_location = buf.tell()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1020	    buf.seek(size_location)
1021	    buf.write(_pack_int(length - size_location))
1022	    buf.seek(resume_location)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1024	    # Type 1 Section for nsInfo
1025	    buf.write(b"\x01")
1026	    size_location = buf.tell()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1027	    # Save space for size
1028	    buf.write(b"\x00\x00\x00\x00")
1029	    buf.write(b"nsInfo\x00")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1028	    buf.write(b"\x00\x00\x00\x00")
1029	    buf.write(b"nsInfo\x00")
1030	    # Write all the nsInfo documents

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1032
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1031	    for ns_encoded in to_send_ns_encoded:
1032	        buf.write(ns_encoded)
1033	    # Write type 1 section size

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1036
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1035	    buf.seek(size_location)
1036	    buf.write(_pack_int(length - size_location))
1037	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1209	    # Save space for message length and request id
1210	    buf.write(_ZERO_64)
1211	    # responseTo, opCode

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1211	    # responseTo, opCode
1212	    buf.write(b"\x00\x00\x00\x00\xdd\x07\x00\x00")
1213	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1220	    request_id = _randint()
1221	    buf.write(_pack_int(request_id))
1222	    buf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1222	    buf.seek(0)
1223	    buf.write(_pack_int(length))
1224	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1287	    # No options
1288	    buf.write(_ZERO_32)
1289	    # Namespace as C string

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1289	    # Namespace as C string
1290	    buf.write(namespace.encode("utf8"))
1291	    buf.write(_ZERO_8)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1290	    buf.write(namespace.encode("utf8"))
1291	    buf.write(_ZERO_8)
1292	    # Skip: 0, Limit: -1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1292	    # Skip: 0, Limit: -1
1293	    buf.write(_SKIPLIM)
1294	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1296	    command_start = buf.tell()
1297	    buf.write(bson.encode(command))
1298	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1303	    try:
1304	        buf.write(_OP_MAP[operation])
1305	    except KeyError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1325	            break
1326	        buf.write(_BSONOBJ)
1327	        buf.write(key)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1326	        buf.write(_BSONOBJ)
1327	        buf.write(key)
1328	        buf.write(_ZERO_8)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1327	        buf.write(key)
1328	        buf.write(_ZERO_8)
1329	        buf.write(value)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1328	        buf.write(_ZERO_8)
1329	        buf.write(value)
1330	        to_send.append(doc)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1334	    # Close list and command documents
1335	    buf.write(_ZERO_16)
1336	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1339	    buf.seek(list_start)
1340	    buf.write(_pack_int(length - list_start - 1))
1341	    buf.seek(command_start)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/message.py:1342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1341	    buf.seek(command_start)
1342	    buf.write(_pack_int(length - command_start))
1343	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
80	    timeout = sock.gettimeout()
81	    sock.settimeout(0.0)
82	    loop = asyncio.get_running_loop()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
86	        else:
87	            await asyncio.wait_for(loop.sock_sendall(sock, buf), timeout=timeout)  # type: ignore[arg-type]
88	    except asyncio.TimeoutError as exc:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
91	    finally:
92	        sock.settimeout(timeout)
93	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
109	            try:
110	                sent += sock.send(view[sent:])
111	            except BLOCKING_IO_ERRORS as exc:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
109	            try:
110	                sent += sock.send(view[sent:])
111	            except BLOCKING_IO_ERRORS as exc:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
204	            try:
205	                sent = sock.send(view[total_sent:])
206	            except BLOCKING_IO_ERRORS:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
204	            try:
205	                sent = sock.send(view[total_sent:])
206	            except BLOCKING_IO_ERRORS:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
242	def sendall(sock: Union[socket.socket, _sslConn], buf: bytes) -> None:
243	    sock.sendall(buf)
244	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
259	
260	    sock.settimeout(0.0)
261	    loop = asyncio.get_running_loop()

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
275	    finally:
276	        sock.settimeout(sock_timeout)
277	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
344	                if _PYPY:
345	                    wait_for_read(conn, deadline)
346	                    if _csot.get_timeout() and deadline is not None:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
418	    def settimeout(self, timeout: float | None) -> None:
419	        self.conn[1].settimeout(timeout)
420	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
421	    async def close(self) -> None:
422	        self.conn[1].close()
423	        await self.conn[1].wait_closed()

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
444	    def settimeout(self, timeout: float | None) -> None:
445	        self.conn.settimeout(timeout)
446	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
447	    def close(self) -> None:
448	        self.conn.close()
449	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
575	        if nbytes == 0:
576	            self.close(OSError("connection closed"))
577	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
591	                except ProtocolError as exc:
592	                    self.close(exc)
593	                    return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
613	            if result.done():
614	                self.close(None)
615	                return

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/network_layer.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
712	    cancellation_task = create_task(_poll_cancellation(conn))
713	    read_task = create_task(conn.conn.get_conn.read(request_id, max_message_size))
714	    tasks = [read_task, cancellation_task]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/ocsp_support.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	    with open(cafile, "rb") as f:
108	        data = f.read()
109	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/ocsp_support.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
107	    with open(cafile, "rb") as f:
108	        data = f.read()
109	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/ocsp_support.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
298	) -> Optional[OCSPResponse]:
299	    ocsp_request = _build_ocsp_request(cert, issuer)
300	    try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/ocsp_support.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
308	        try:
309	            response = _post(
310	                uri,
311	                data=ocsp_request.public_bytes(_Encoding.DER),
312	                headers={"Content-Type": "application/ocsp-request"},
313	                timeout=timeout,
314	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/ocsp_support.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
433	    # Cache the verified, stapled response.
434	    ocsp_response_cache[_build_ocsp_request(cert, issuer)] = response
435	    _LOGGER.debug("OCSP cert status: %r", response.certificate_status)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
54	    # DeprecationWarning: dist() and linux_distribution() functions are deprecated in Python 3.5
55	    _name = platform.system()
56	    _METADATA["os"] = {

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
54	    # DeprecationWarning: dist() and linux_distribution() functions are deprecated in Python 3.5
55	    _name = platform.system()
56	    _METADATA["os"] = {

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:55
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
54	    # DeprecationWarning: dist() and linux_distribution() functions are deprecated in Python 3.5
55	    _name = platform.system()
56	    _METADATA["os"] = {

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
64	    _METADATA["os"] = {
65	        "type": platform.system(),
66	        "name": platform.system(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
64	    _METADATA["os"] = {
65	        "type": platform.system(),
66	        "name": platform.system(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
64	    _METADATA["os"] = {
65	        "type": platform.system(),
66	        "name": platform.system(),

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
65	        "type": platform.system(),
66	        "name": platform.system(),
67	        "architecture": platform.machine(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
65	        "type": platform.system(),
66	        "name": platform.system(),
67	        "architecture": platform.machine(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
65	        "type": platform.system(),
66	        "name": platform.system(),
67	        "architecture": platform.machine(),

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
94	    # Get potential alias (e.g. SunOS 5.11 becomes Solaris 2.11)
95	    _aliased = platform.system_alias(platform.system(), platform.release(), platform.version())
96	    _METADATA["os"] = {

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
94	    # Get potential alias (e.g. SunOS 5.11 becomes Solaris 2.11)
95	    _aliased = platform.system_alias(platform.system(), platform.release(), platform.version())
96	    _METADATA["os"] = {

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:95
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
94	    # Get potential alias (e.g. SunOS 5.11 becomes Solaris 2.11)
95	    _aliased = platform.system_alias(platform.system(), platform.release(), platform.version())
96	    _METADATA["os"] = {

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
96	    _METADATA["os"] = {
97	        "type": platform.system(),
98	        "name": " ".join([part for part in _aliased[:2] if part]),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
96	    _METADATA["os"] = {
97	        "type": platform.system(),
98	        "name": " ".join([part for part in _aliased[:2] if part]),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:97
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
96	    _METADATA["os"] = {
97	        "type": platform.system(),
98	        "name": " ".join([part for part in _aliased[:2] if part]),

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
115	            ".".join(map(str, sys.version_info)),
116	            "(%s)" % " ".join((platform.system(), platform.release())),
117	        )

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
115	            ".".join(map(str, sys.version_info)),
116	            "(%s)" % " ".join((platform.system(), platform.release())),
117	        )

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_options.py:116
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
115	            ".".join(map(str, sys.version_info)),
116	            "(%s)" % " ".join((platform.system(), platform.release())),
117	        )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
147	    else:
148	        raise AutoReconnect(msg) from error
149	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:204
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
203	            raise ConnectionFailure("UNIX-sockets are not supported on this system")
204	        sock = socket.socket(socket.AF_UNIX)
205	        # SOCK_CLOEXEC not supported for Unix sockets.

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
207	        try:
208	            sock.connect(host)
209	            return sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
210	        except OSError:
211	            sock.close()
212	            raise

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:228
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
227	        try:
228	            sock = socket.socket(af, socktype | getattr(socket, "SOCK_CLOEXEC", 0), proto)
229	        except OSError:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:232
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
231	            # it?
232	            sock = socket.socket(af, socktype, proto)
233	        # Fallback when SOCK_CLOEXEC isn't available.

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
242	                raise socket.timeout("timed out")
243	            sock.settimeout(timeout)
244	            sock.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, True)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
245	            _set_keepalive_times(sock)
246	            sock.connect(sa)
247	            return sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
249	            err = e
250	            sock.close()
251	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
274	    if ssl_context is None:
275	        sock.settimeout(options.socket_timeout)
276	        return sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
291	    except _CertificateError:
292	        sock.close()
293	        # Raise _CertificateError directly like we do after match_hostname

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
296	    except (OSError, SSLError) as exc:
297	        sock.close()
298	        # We raise AutoReconnect for transient and permanent SSL handshake

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
310	        except _CertificateError:
311	            ssl_sock.close()
312	            raise

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
313	
314	    ssl_sock.settimeout(options.socket_timeout)
315	    return ssl_sock

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:387
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
386	            raise ConnectionFailure("UNIX-sockets are not supported on this system")
387	        sock = socket.socket(socket.AF_UNIX)
388	        # SOCK_CLOEXEC not supported for Unix sockets.

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
390	        try:
391	            sock.connect(host)
392	            return sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
393	        except OSError:
394	            sock.close()
395	            raise

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:411
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
410	        try:
411	            sock = socket.socket(af, socktype | getattr(socket, "SOCK_CLOEXEC", 0), proto)
412	        except OSError:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:415
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
414	            # it?
415	            sock = socket.socket(af, socktype, proto)
416	        # Fallback when SOCK_CLOEXEC isn't available.

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
425	                raise socket.timeout("timed out")
426	            sock.settimeout(timeout)
427	            sock.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, True)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
428	            _set_keepalive_times(sock)
429	            sock.connect(sa)
430	            return sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
432	            err = e
433	            sock.close()
434	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
455	    if ssl_context is None:
456	        sock.settimeout(options.socket_timeout)
457	        return sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
467	    except _CertificateError:
468	        sock.close()
469	        # Raise _CertificateError directly like we do after match_hostname

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
472	    except (OSError, SSLError) as exc:
473	        sock.close()
474	        # We raise AutoReconnect for transient and permanent SSL handshake

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
486	        except _CertificateError:
487	            ssl_sock.close()
488	            raise

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
489	
490	    ssl_sock.settimeout(options.socket_timeout)
491	    return ssl_sock

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
504	    if ssl_context is None:
505	        sock.settimeout(options.socket_timeout)
506	        return NetworkingInterface(sock)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
516	    except _CertificateError:
517	        sock.close()
518	        # Raise _CertificateError directly like we do after match_hostname

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
521	    except (OSError, SSLError) as exc:
522	        sock.close()
523	        # We raise AutoReconnect for transient and permanent SSL handshake

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
535	        except _CertificateError:
536	            ssl_sock.close()
537	            raise

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/pool_shared.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
538	
539	    ssl_sock.settimeout(options.socket_timeout)
540	    return NetworkingInterface(ssl_sock)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/auth.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
117	    if not client_key or salt != csalt or iterations != citerations:
118	        salted_pass = hashlib.pbkdf2_hmac(digest, data, standard_b64decode(salt), iterations)
119	        client_key = _hmac(salted_pass, b"Client Key", digestmod).digest()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/auth.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
124	    client_sig = _hmac(stored_key, auth_msg, digestmod).digest()
125	    client_proof = b"p=" + standard_b64encode(_xor(client_key, client_sig))
126	    client_final = b",".join((without_proof, client_proof))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/auth.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
127	
128	    server_sig = standard_b64encode(_hmac(server_key, auth_msg, digestmod).digest())
129	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/cursor.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	            warnings.warn(
155	                "use an explicit session with no_cursor_timeout=True "
156	                "otherwise the cursor may still timeout after "
157	                "30 minutes, for more info see "
158	                "https://mongodb.com/docs/v4.4/reference/method/"
159	                "cursor.noCursorTimeout/"
160	                "#session-idle-timeout-overrides-nocursortimeout",
161	                UserWarning,
162	                stacklevel=2,
163	            )
164	        if cursor_type not in (

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
197	            try:
198	                sendall(conn, message)
199	                while kms_context.bytes_needed > 0:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
200	                    # CSOT: update timeout.
201	                    conn.settimeout(max(_csot.clamp_remaining(_KMS_CONNECT_TIMEOUT), 0))
202	                    if _IS_SYNC:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
202	                    if _IS_SYNC:
203	                        data = conn.recv(kms_context.bytes_needed)
204	                    else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
227	            finally:
228	                conn.close()
229	        except MongoCryptError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
344	        if self.mongocryptd_client:
345	            self.mongocryptd_client.close()
346	            self.mongocryptd_client = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
483	        self._closed = True
484	        self._auto_encrypter.close()
485	        if self._internal_client:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
485	        if self._internal_client:
486	            self._internal_client.close()
487	            self._internal_client = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:1196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1195	        assert self._key_vault_coll is not None
1196	        result = self._key_vault_coll.bulk_write(replacements)
1197	        return RewrapManyDataKeyResult(result)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1202	    def __exit__(self, exc_type: Any, exc_val: Any, exc_tb: Any) -> None:
1203	        self.close()
1204	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:1221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1220	        if self._io_callbacks:
1221	            self._io_callbacks.close()
1222	            self._encryption.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/encryption.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1221	            self._io_callbacks.close()
1222	            self._encryption.close()
1223	            self._io_callbacks = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/mongo_client.py:1896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1895	
1896	        return self._retryable_read(
1897	            _cmd,
1898	            operation.read_preference,
1899	            operation.session,  # type: ignore[arg-type]
1900	            address=address,
1901	            retryable=isinstance(operation, _Query),
1902	            operation=operation.name,
1903	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/mongo_client.py:2702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2701	        if self._is_session_state_retryable() and self._retryable and not self._is_read:
2702	            self._session._start_retryable_write()  # type: ignore
2703	            if self._bulk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/mongo_client.py:2709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2708	            try:
2709	                return self._read() if self._is_read else self._write()
2710	            except ServerSelectionTimeoutError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/mongo_client.py:2709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2708	            try:
2709	                return self._read() if self._is_read else self._write()
2710	            except ServerSelectionTimeoutError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/mongo_client.py:2895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2894	                _CLIENT_LOGGER,
2895	                "You appear to be connected to a CosmosDB cluster. For more information regarding feature "
2896	                "compatibility and support please visit https://www.mongodb.com/supportability/cosmosdb",
2897	            )
2898	            return True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/mongo_client.py:2903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2902	                _CLIENT_LOGGER,
2903	                "You appear to be connected to a DocumentDB cluster. For more information regarding feature "
2904	                "compatibility and support please visit https://www.mongodb.com/supportability/documentdb",
2905	            )
2906	            return True

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/pool.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
196	        self.last_timeout = timeout
197	        self.conn.get_conn.settimeout(timeout)
198	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/pool.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
451	        try:
452	            sendall(self.conn.get_conn, message)
453	        # Catch KeyboardInterrupt, CancelledError, etc. and cleanup.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/pool.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
579	        try:
580	            self.conn.close()
581	        except Exception:  # noqa: S110

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/pool.py:957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
956	                    incremented = True
957	                conn = self.connect()
958	                close_conn = False

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/pool.py:1166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1165	            _raise_connection_failure(
1166	                self.address, AutoReconnect("connection pool paused"), timeout_details=details
1167	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/pool.py:1259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1258	                    try:
1259	                        conn = self.connect(handler=handler)
1260	                    finally:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/pymongo/synchronous/topology.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	            warnings.warn(  # type: ignore[call-overload] # noqa: B028
238	                "MongoClient opened before fork. May not be entirely fork-safe, "
239	                "proceed with caution. See PyMongo's documentation for details: "
240	                "https://dochub.mongodb.org/core/pymongo-fork-deadlock",
241	                **kwargs,
242	            )
243	            with self._lock:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
196	        finally:
197	            client.close()
198	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
201	        self.connection_attempts = []
202	        self.client = self._connect(host, port)
203	        if self.client is not None:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
208	                self.auth_enabled = True
209	                self.client = self._connect(host, port, username=db_user, password=db_pwd)
210	                self.connected = True

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
214	            # Is MongoDB configured for SSL?
215	            self.client = self._connect(host, port, **TLS_OPTIONS)
216	            if self.client:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
246	                if self.client:
247	                    self.client.close()
248	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
248	
249	                self.client = self._connect(
250	                    host,
251	                    port,
252	                    username=db_user,
253	                    password=db_pwd,
254	                    replicaSet=self.replica_set_name,
255	                    **self.default_client_options,
256	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
275	                if self.client:
276	                    self.client.close()
277	                if self.auth_enabled:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
333	                    next_address = address[0], address[1] + 1
334	                    mongos_client = self._connect(*next_address, **self.default_client_options)
335	                    if mongos_client:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
338	                            self.mongoses.append(next_address)
339	                        mongos_client.close()
340	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
418	        finally:
419	            client.close()
420	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:963
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
962	        def _target() -> None:
963	            signal.signal(signal.SIGUSR1, _print_threads)
964	            try:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:963
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
962	        def _target() -> None:
963	            signal.signal(signal.SIGUSR1, _print_threads)
964	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
966	            except Exception as exc:
967	                sys.stderr.write(f"Child process failed with: {exc}\n")
968	                _print_threads()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
973	        ctx = multiprocessing.get_context("fork")
974	        proc = ctx.Process(target=_target)
975	        proc.start()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1027	        if client._options.connect:
1028	            client._connect()
1029	        return client

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:1057
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1056	        if client._options.connect:
1057	            client._connect()
1058	        self.addCleanup(client.close)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/__init__.py:1260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1259	            c.drop_database("pymongo_test_bernie")
1260	        c.close()
1261	    print_running_clients()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
196	        finally:
197	            await client.close()
198	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
201	        self.connection_attempts = []
202	        self.client = await self._connect(host, port)
203	        if self.client is not None:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
208	                self.auth_enabled = True
209	                self.client = await self._connect(host, port, username=db_user, password=db_pwd)
210	                self.connected = True

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
214	            # Is MongoDB configured for SSL?
215	            self.client = await self._connect(host, port, **TLS_OPTIONS)
216	            if self.client:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
246	                if self.client:
247	                    await self.client.close()
248	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
248	
249	                self.client = await self._connect(
250	                    host,
251	                    port,
252	                    username=db_user,
253	                    password=db_pwd,
254	                    replicaSet=self.replica_set_name,
255	                    **self.default_client_options,
256	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
275	                if self.client:
276	                    await self.client.close()
277	                if self.auth_enabled:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
333	                    next_address = address[0], address[1] + 1
334	                    mongos_client = await self._connect(
335	                        *next_address, **self.default_client_options
336	                    )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
340	                            self.mongoses.append(next_address)
341	                        await mongos_client.close()
342	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
420	        finally:
421	            await client.close()
422	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
964	        def _target() -> None:
965	            signal.signal(signal.SIGUSR1, _print_threads)
966	            try:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:965
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
964	        def _target() -> None:
965	            signal.signal(signal.SIGUSR1, _print_threads)
966	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:969
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
968	            except Exception as exc:
969	                sys.stderr.write(f"Child process failed with: {exc}\n")
970	                _print_threads()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
975	        ctx = multiprocessing.get_context("fork")
976	        proc = ctx.Process(target=_target)
977	        proc.start()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:1030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1029	        if client._options.connect:
1030	            await client.aconnect()
1031	        return client

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1060	        if client._options.connect:
1061	            await client.aconnect()
1062	        self.addAsyncCleanup(client.close)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/__init__.py:1278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1277	            await c.drop_database("pymongo_test_bernie")
1278	        await c.close()
1279	    print_running_clients()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/helpers.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
105	# Shared KMS data.
106	LOCAL_MASTER_KEY = base64.b64decode(
107	    b"Mng0NCt4ZHVUYUJCa1kxNkVyNUR1QURhZ2h2UzR2d2RrZzh0cFBwM3R6NmdWMDFBMUN3YkQ"
108	    b"5aXRRMkhGRGdQV09wOGVNYUMxT2k3NjZKelhaQmRCZGJkTXVyZG9uSjFk"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/helpers.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
105	# Shared KMS data.
106	LOCAL_MASTER_KEY = base64.b64decode(
107	    b"Mng0NCt4ZHVUYUJCa1kxNkVyNUR1QURhZ2h2UzR2d2RrZzh0cFBwM3R6NmdWMDFBMUN3YkQ"
108	    b"5aXRRMkhGRGdQV09wOGVNYUMxT2k3NjZKelhaQmRCZGJkTXVyZG9uSjFk"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/helpers.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
284	    for thread_id, frame in sys._current_frames().items():
285	        sys.stderr.write(f"\n--- Traceback for thread {thread_id} ---\n")
286	        traceback.print_stack(frame, file=sys.stderr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/helpers.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
300	    except Exception as exc:
301	        sys.stderr.write(f"Could not print C-level thread stacks because {cmd[0]} failed: {exc}")
302	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/helpers.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
302	    else:
303	        sys.stderr.write(res.stdout)
304	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_auth.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
243	        for _ in range(4):
244	            threads.append(AutoAuthenticateThread(collection))
245	        for thread in threads:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_auth.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
267	            for _ in range(4):
268	                threads.append(AutoAuthenticateThread(collection))
269	            for thread in threads:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_auth.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
665	        for _ in range(4):
666	            threads.append(AutoAuthenticateThread(coll))
667	        for thread in threads:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_change_stream.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
320	        changes = []
321	        t = threading.Thread(target=lambda: changes.append(change_stream.next()))
322	        t.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_change_stream.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
367	
368	            t = threading.Thread(target=iterate_cursor)
369	            t.start()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
939	        self.assertIn("host='mongodb+srv://test1.test.build.10gen.cc'", repr(client))
940	        await client.aconnect()
941	        # after srv resolution

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
942	        self.assertIn("host=['localhost.test.build.10gen.cc:", repr(client))
943	        await client.close()
944	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1011	        coll = test_client.pymongo_test.bar
1012	        await test_client.close()
1013	        with self.assertRaises(InvalidOperation):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1044	        self.assertTrue(test_client._topology._opened)
1045	        await test_client.close()
1046	        self.assertFalse(test_client._topology._opened)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1058
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1057	        # Closing the client should stop the thread.
1058	        await client.close()
1059	        self.assertTrue(client._kill_cursors_executor._stopped)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1092	        self.assertEqual(topology._servers, {})
1093	        await client.close()
1094	        self.assertEqual(topology._servers, {})

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1099	        topology = client._topology
1100	        await client.close()
1101	        for server in topology._servers.values():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1109	        with self.assertRaises(InvalidURI):
1110	            AsyncMongoClient("http://localhost")
1111	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1290	        self.assertAlmostEqual(0.1, client.options.server_selection_timeout)
1291	        await client.close()
1292	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1303	        )
1304	        await client.close()
1305	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1309	        self.assertAlmostEqual(0.1, client.options.server_selection_timeout)
1310	        await client.close()
1311	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1313	        self.assertAlmostEqual(0, client.options.server_selection_timeout)
1314	        await client.close()
1315	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1318	        self.assertAlmostEqual(30, client.options.server_selection_timeout)
1319	        await client.close()
1320	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1442	
1443	                thread.start_new_thread(interrupter, ())
1444	            else:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1449	
1450	                old_signal_handler = signal.signal(signal.SIGALRM, sigalarm)
1451	                signal.alarm(1)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1450
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1449	
1450	                old_signal_handler = signal.signal(signal.SIGALRM, sigalarm)
1451	                signal.alarm(1)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1469	            if old_signal_handler:
1470	                signal.signal(signal.SIGALRM, old_signal_handler)
1471	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1470
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1469	            if old_signal_handler:
1470	                signal.signal(signal.SIGALRM, old_signal_handler)
1471	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1538	        conn = one(pool.conns)
1539	        await conn.conn.close()
1540	        cursor = collection.find(cursor_type=CursorType.EXHAUST)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1563	        conn = one(pool.conns)
1564	        await conn.conn.close()
1565	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1756	                while self.running:
1757	                    exc = AutoReconnect("mock pool error")
1758	                    ctx = _ErrorContext(exc, 0, pool.gen.get_overall(), False, None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1764	
1765	        t = ResetPoolThread(pool)
1766	        t.start()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1794	            await asyncio.sleep(2)
1795	            return await original_connect(*args, **kwargs)
1796	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1877	            final_count = server_description_count()
1878	            await client.close()
1879	            # If a bug like PYTHON-2433 is reintroduced then too many

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1904	        self.assertIsNotNone(c_id)
1905	        await client.close()
1906	        # Add cursor to kill cursors queue

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1921	        )
1922	        await client.aconnect()
1923	        self.assertEqual(client._topology_settings.srv_service_name, "customname")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1923	        self.assertEqual(client._topology_settings.srv_service_name, "customname")
1924	        await client.close()
1925	        client = AsyncMongoClient(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1931
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1930	        )
1931	        await client.aconnect()
1932	        self.assertEqual(client._topology_settings.srv_service_name, "customname")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1932	        self.assertEqual(client._topology_settings.srv_service_name, "customname")
1933	        await client.close()
1934	        client = AsyncMongoClient(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1938
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1937	        )
1938	        await client.aconnect()
1939	        self.assertEqual(client._topology_settings.srv_service_name, "customname")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1939	        self.assertEqual(client._topology_settings.srv_service_name, "customname")
1940	        await client.close()
1941	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1943	        client = self.simple_client("mongodb+srv://test1.test.build.10gen.cc/")
1944	        await client.aconnect()
1945	        self.assertGreater(len(client.topology_description.server_descriptions()), 1)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1946	        client = self.simple_client("mongodb+srv://test1.test.build.10gen.cc/", srvmaxhosts=1)
1947	        await client.aconnect()
1948	        self.assertEqual(len(client.topology_description.server_descriptions()), 1)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:1952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1951	        )
1952	        await client.aconnect()
1953	        self.assertEqual(len(client.topology_description.server_descriptions()), 2)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:2256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2255	        conn = one(pool.conns)
2256	        await conn.conn.close()
2257	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:2284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2283	        conn = cursor._sock_mgr.conn
2284	        await conn.conn.close()
2285	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client.py:2359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2358	            time.sleep(3)
2359	            return pool.__class__.connect(pool, *args, **kwargs)
2360	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	        with self.assertRaises(InvalidOperation) as context:
54	            await self.client.bulk_write(models=models)
55	        self.assertIn(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	            with self.assertRaises(ClientBulkWriteException) as context:
68	                await self.client.bulk_write(models=models)
69	            self.assertIsInstance(context.exception.error, TypeError)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	        with self.assertRaises(ClientBulkWriteException) as context:
81	            await self.client.bulk_write(models=models)
82	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	
107	        result = await client.bulk_write(models=models)
108	        self.assertEqual(result.inserted_count, self.max_write_batch_size + 1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	
139	        result = await client.bulk_write(models=models)
140	        self.assertEqual(result.inserted_count, num_models)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
182	            with self.assertRaises(ClientBulkWriteException) as context:
183	                await client.bulk_write(models=models)
184	            self.assertEqual(len(context.exception.write_concern_errors), 2)  # type: ignore[arg-type]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
216	        with self.assertRaises(ClientBulkWriteException) as context:
217	            await client.bulk_write(models=models, ordered=False)
218	        self.assertEqual(len(context.exception.write_errors), self.max_write_batch_size + 1)  # type: ignore[arg-type]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
246	        with self.assertRaises(ClientBulkWriteException) as context:
247	            await client.bulk_write(models=models, ordered=True)
248	        self.assertEqual(len(context.exception.write_errors), 1)  # type: ignore[arg-type]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
285	
286	        result = await client.bulk_write(models=models, verbose_results=True)
287	        self.assertEqual(result.upserted_count, 2)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
327	            )
328	            result = await client.bulk_write(models=models, session=session, verbose_results=True)
329	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
376	            with self.assertRaises(ClientBulkWriteException) as context:
377	                await client.bulk_write(models=models, verbose_results=True)
378	            self.assertIsNotNone(context.exception.error)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
404	        with self.assertRaises(DocumentTooLarge):
405	            await client.bulk_write(
406	                models=models_insert, ordered=False, write_concern=WriteConcern(w=0)
407	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
411	        with self.assertRaises(DocumentTooLarge):
412	            await client.bulk_write(
413	                models=models_replace, ordered=False, write_concern=WriteConcern(w=0)
414	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
469	        # No batch splitting required.
470	        result = await client.bulk_write(models=models)
471	        self.assertEqual(result.inserted_count, num_models + 1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
503	        # Batch splitting required.
504	        result = await client.bulk_write(models=models)
505	        self.assertEqual(result.inserted_count, num_models + 1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
531	        with self.assertRaises(DocumentTooLarge):
532	            await client.bulk_write(models=models)
533	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
538	        with self.assertRaises(DocumentTooLarge):
539	            await client.bulk_write(models=models)
540	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
552	        with self.assertRaises(InvalidOperation) as context:
553	            await client.bulk_write(models=models)
554	        self.assertIn(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
590	        )
591	        result = await client.bulk_write(models=models, verbose_results=True)
592	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
616	
617	        res = await client.bulk_write(models, ordered=False, write_concern=WriteConcern(w=0))
618	        self.assertEqual(False, res.acknowledged)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_client_bulk_write.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
687	            with self.assertRaises(ClientBulkWriteException) as context:
688	                await client.bulk_write(models=models)
689	            self.assertIsInstance(context.exception.error, NetworkTimeout)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_collection.py:1103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1102	        ]
1103	        await db.test.bulk_write(ops, bypass_document_validation=True)
1104	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_collection.py:1113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1112	            with self.assertRaises(BulkWriteError):
1113	                await db.test.bulk_write([op])
1114	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_collection.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1115	        with self.assertRaises(OperationFailure):
1116	            await db_w0.test.bulk_write(ops, bypass_document_validation=True)
1117	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_cursor.py:1160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1159	
1160	        t = threading.Thread(target=iterate_cursor)
1161	        t.start()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_custom_types.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
210	        fileobj = tempfile.TemporaryFile()
211	        fileobj.write(bson_data)
212	        fileobj.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_custom_types.py:776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
775	        )
776	        await one.write(b"hello world")
777	        await one.close()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
126	        elif error_type == "network":
127	            raise AutoReconnect("mock non-timeout network error")
128	        elif error_type == "timeout":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
253	            with open(os.path.join(dirpath, filename)) as scenario_stream:
254	                scenario_def = json_util.loads(scenario_stream.read())
255	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
312	            await async_barrier_wait(barrier, timeout=30)
313	            raise AutoReconnect("mock AsyncConnection.command error")
314	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
438	        self.server.events.append("client connected")
439	        if self.request.recv(1024).strip():
440	            self.server.events.append("client hello received")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
440	            self.server.events.append("client hello received")
441	        self.request.close()
442	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
448	        self.handle_request()
449	        self.server_close()
450	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
474	                events.append("client connected")
475	                if (await reader.read(1024)).strip():
476	                    events.append("client hello received")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
476	                    events.append("client hello received")
477	                writer.close()
478	                await writer.wait_closed()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
487	            )
488	            await _c.aconnect()
489	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
492	
493	            server.close()
494	            await server.wait_closed()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_discovery_and_monitoring.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
494	            await server.wait_closed()
495	            await _c.close()
496	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
280	    with open(os.path.join(BASE, *paths)) as fp:
281	        return fp.read()
282	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
280	    with open(os.path.join(BASE, *paths)) as fp:
281	        return fp.read()
282	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
284	def json_data(*paths):
285	    return json_util.loads(read(*paths), json_options=JSON_OPTS)
286	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
284	def json_data(*paths):
285	    return json_util.loads(read(*paths), json_options=JSON_OPTS)
286	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
377	        await client.admin.command("ping")
378	        await client.aclose()
379	        with self.assertRaisesRegex(InvalidOperation, "Cannot use AsyncMongoClient after close"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
413	        uuids = [uuid.uuid4() for _ in range(3)]
414	        result = await coll.bulk_write(
415	            [
416	                UpdateOne({"_id": uuids[0]}, {"$set": {"a": 0}}, upsert=True),
417	                ReplaceOne({"a": 1}, {"_id": uuids[1]}, upsert=True),
418	                # This is just here to make the counts right in all cases.
419	                ReplaceOne({"_id": uuids[2]}, {"_id": uuids[2]}, upsert=True),
420	            ]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
455	        with self.assertRaisesRegex(ConfigurationError, msg):
456	            await client.test.test.bulk_write([InsertOne({})])
457	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
599	        )
600	        await client_encryption.close()
601	        # Close can be called multiple times.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
601	        # Close can be called multiple times.
602	        await client_encryption.close()
603	        algo = Algorithm.AEAD_AES_256_CBC_HMAC_SHA_512_Deterministic

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
770	
771	LOCAL_KEY_ID = Binary(base64.b64decode(b"LOCALAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
772	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:771
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
770	
771	LOCAL_KEY_ID = Binary(base64.b64decode(b"LOCALAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
772	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
771	LOCAL_KEY_ID = Binary(base64.b64decode(b"LOCALAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
772	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
773	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:772
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
771	LOCAL_KEY_ID = Binary(base64.b64decode(b"LOCALAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
772	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
773	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
772	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
773	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
774	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:773
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
772	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
773	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
774	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
773	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
774	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
775	KMIP_KEY_ID = Binary(base64.b64decode(b"KMIPAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:774
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
773	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
774	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
775	KMIP_KEY_ID = Binary(base64.b64decode(b"KMIPAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
774	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
775	KMIP_KEY_ID = Binary(base64.b64decode(b"KMIPAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
776	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:775
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
774	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
775	KMIP_KEY_ID = Binary(base64.b64decode(b"KMIPAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
776	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:1229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1228	        doc["_id"] = "over_2mib_under_16mib_bulk"
1229	        await self.coll_encrypted.bulk_write([InsertOne(doc)])
1230	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:1238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1237	        doc["_id"] = "encryption_exceeds_2mib_bulk"
1238	        await self.coll_encrypted.bulk_write([InsertOne(doc)])
1239	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:1244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1243	        self.listener.reset()
1244	        await self.coll_encrypted.bulk_write([InsertOne(doc1), InsertOne(doc2)])
1245	        self.assertEqual(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:1256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1255	        self.listener.reset()
1256	        await self.coll_encrypted.bulk_write([InsertOne(doc1), InsertOne(doc2)])
1257	        self.assertEqual(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:1267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1266	        doc["_id"] = "under_16mib_bulk"
1267	        await self.coll_encrypted.bulk_write([InsertOne(doc)])
1268	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:1280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1279	        with self.assertRaises(BulkWriteError) as ctx:
1280	            await self.coll_encrypted.bulk_write([InsertOne(doc)])
1281	        err = ctx.exception.details["writeErrors"][0]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:1515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1514	
1515	        self.assertEqual(bytes(ciphertext), base64.b64decode(expectation))
1516	        self.assertEqual(await client_encryption.decrypt(ciphertext), "string0")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:1515
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1514	
1515	        self.assertEqual(bytes(ciphertext), base64.b64decode(expectation))
1516	        self.assertEqual(await client_encryption.decrypt(ciphertext), "string0")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:2001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2000	
2001	        listener_t = Thread(target=listener)
2002	        listener_t.start()

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:2001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
2000	
2001	        listener_t = Thread(target=listener)
2002	        listener_t.start()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:2475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2474	
2475	        await encrypted_client.close()
2476	        await unencrypted_client.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:2476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2475	        await encrypted_client.close()
2476	        await unencrypted_client.close()
2477	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:3202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3201	                body = None
3202	            conn.request("POST", path, body, headers)
3203	            res = conn.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:3203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
3202	            conn.request("POST", path, body, headers)
3203	            res = conn.getresponse()
3204	            res.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:3204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3203	            res = conn.getresponse()
3204	            res.read()
3205	        finally:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:3204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
3203	            res = conn.getresponse()
3204	            res.read()
3205	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_encryption.py:3206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3205	        finally:
3206	            conn.close()
3207	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
234	            # closed.
235	            await conn.conn.close()
236	            self.assertTrue(conn.conn_closed())

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:249
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
248	    async def test_socket_closed(self):
249	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
250	        s.connect((await async_client_context.host, await async_client_context.port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
249	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
250	        s.connect((await async_client_context.host, await async_client_context.port))
251	        socket_checker = SocketChecker()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
252	        self.assertFalse(socket_checker.socket_closed(s))
253	        s.close()
254	        self.assertTrue(socket_checker.socket_closed(s))

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:257
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
256	    async def test_socket_checker(self):
257	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
258	        s.connect((await async_client_context.host, await async_client_context.port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
257	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
258	        s.connect((await async_client_context.host, await async_client_context.port))
259	        socket_checker = SocketChecker()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
272	        )
273	        s.sendall(msg)
274	        # Block until the socket is readable.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
283	        self.assertTrue(socket_checker.select(s, write=True, timeout=0.05))
284	        s.close()
285	        self.assertTrue(socket_checker.socket_closed(s))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
308	            # closed.
309	            await conn.conn.close()
310	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
361	        await t.join()
362	        await pool.close()
363	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_pooling.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
393	            await asyncio.sleep(0.05)
394	        await pool.close()
395	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_read_write_concern_spec.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	            ("delete_many", lambda: collection.delete_many({})),
86	            ("bulk_write", lambda: collection.bulk_write([InsertOne({})])),
87	            ("rename_and_drop", rename_and_drop),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_read_write_concern_spec.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	            ("delete_many", lambda: coll.delete_many({})),
133	            ("bulk_write", lambda: coll.bulk_write([InsertOne({})])),
134	            ("command", insert_command),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_read_write_concern_spec.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
203	            with self.assertRaises(BulkWriteError) as ctx:
204	                await self.db.test.bulk_write([InsertOne({})])
205	            expected_details = {

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_retryable_reads.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
99	            cmd_listener.reset()
100	            threads = [FindThread(client.pymongo_test.test) for _ in range(2)]
101	            fail_command = {

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_ssl.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
279	            client = self.simple_client(
280	                "127.0.0.1",
281	                ssl=True,
282	                tlsCertificateKeyFile=CLIENT_PEM,
283	                tlsAllowInvalidCertificates=False,
284	                tlsCAFile=CA_PEM,
285	            )
286	            await self.assertClientWorks(client)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_ssl.py:504
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
503	            ctx = get_ssl_context(None, None, CA_PEM, None, False, False, False)
504	            ssl_sock = ctx.wrap_socket(socket.socket())
505	            self.assertEqual(ssl_sock.ca_certs, CA_PEM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_ssl.py:508
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
507	            ctx = get_ssl_context(None, None, None, None, False, False, False)
508	            ssl_sock = ctx.wrap_socket(socket.socket())
509	            self.assertEqual(ssl_sock.ca_certs, ssl_support.certifi.where())

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_ssl.py:525
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
524	        ctx = get_ssl_context(None, None, CA_PEM, None, False, False, False)
525	        ssl_sock = ctx.wrap_socket(socket.socket())
526	        self.assertEqual(ssl_sock.ca_certs, CA_PEM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/test_ssl.py:529
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
528	        ctx = get_ssl_context(None, None, None, None, False, False, False)
529	        ssl_sock = ctx.wrap_socket(socket.socket())
530	        self.assertEqual(ssl_sock.ca_certs, ssl_support._WINCERTS.name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/unified_format.py:888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
887	        async with await target.open_download_stream(*args, **kwargs) as gout:
888	            return await gout.read()
889	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/unified_format.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
893	        async with await target.open_download_stream_by_name(*args, **kwargs) as gout:
894	            return await gout.read()
895	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/unified_format.py:1544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1543	                opts = json_util.JSONOptions(tz_aware=False)
1544	                scenario_def = json_util.loads(scenario_stream.read(), json_options=opts)
1545	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/utils_selection_tests.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	            with open(os.path.join(dirpath, filename)) as scenario_stream:
195	                scenario_def = json_util.loads(scenario_stream.read())
196	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/utils_spec_runner.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
219	                    scenario_def = ScenarioDict(
220	                        json_util.loads(scenario_stream.read(), json_options=opts)
221	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/asynchronous/utils_spec_runner.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
483	        if "download" in name:
484	            result = Binary(result.read())
485	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/auth_oidc/test_auth_oidc.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	            with open(token_file) as fid:
90	                return fid.read()
91	        elif ENVIRON == "azure":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/auth_oidc/test_auth_oidc.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
609	            # Perform a bulk write operation.
610	            client.test.test.bulk_write([InsertOne({})])  # type:ignore[type-var]
611	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/auth_oidc/test_auth_oidc.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
623	        # Perform a bulk write operation.
624	        client.test.test.bulk_write([InsertOne({})])  # type:ignore[type-var]
625	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/auth_oidc/test_auth_oidc.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
800	        for _ in range(10):
801	            thread = threading.Thread(target=target)
802	            thread.start()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/helpers.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
105	# Shared KMS data.
106	LOCAL_MASTER_KEY = base64.b64decode(
107	    b"Mng0NCt4ZHVUYUJCa1kxNkVyNUR1QURhZ2h2UzR2d2RrZzh0cFBwM3R6NmdWMDFBMUN3YkQ"
108	    b"5aXRRMkhGRGdQV09wOGVNYUMxT2k3NjZKelhaQmRCZGJkTXVyZG9uSjFk"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/helpers.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
105	# Shared KMS data.
106	LOCAL_MASTER_KEY = base64.b64decode(
107	    b"Mng0NCt4ZHVUYUJCa1kxNkVyNUR1QURhZ2h2UzR2d2RrZzh0cFBwM3R6NmdWMDFBMUN3YkQ"
108	    b"5aXRRMkhGRGdQV09wOGVNYUMxT2k3NjZKelhaQmRCZGJkTXVyZG9uSjFk"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/helpers.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
284	    for thread_id, frame in sys._current_frames().items():
285	        sys.stderr.write(f"\n--- Traceback for thread {thread_id} ---\n")
286	        traceback.print_stack(frame, file=sys.stderr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/helpers.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
300	    except Exception as exc:
301	        sys.stderr.write(f"Could not print C-level thread stacks because {cmd[0]} failed: {exc}")
302	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/helpers.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
302	    else:
303	        sys.stderr.write(res.stdout)
304	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/mod_wsgi_test/test_client.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
87	    url = random.choice(urls)
88	    urlopen(url).read().strip()
89	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	        with open(OUTPUT_FILE, "w") as opf:
97	            opf.write(output)
98	    else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
96	        with open(OUTPUT_FILE, "w") as opf:
97	            opf.write(output)
98	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
236	        ) as data:
237	            self.document = json.loads(data.read())
238	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
372	    async def do_task(self):
373	        await self.corpus.bulk_write(self.models, ordered=True)
374	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
372	    async def do_task(self):
373	        await self.corpus.bulk_write(self.models, ordered=True)
374	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
385	    async def do_task(self):
386	        await self.client.bulk_write(self.models, ordered=True)
387	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
385	    async def do_task(self):
386	        await self.client.bulk_write(self.models, ordered=True)
387	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
398	    async def do_task(self):
399	        await self.corpus.bulk_write(self.models, ordered=True)
400	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
398	    async def do_task(self):
399	        await self.corpus.bulk_write(self.models, ordered=True)
400	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
417	    async def do_task(self):
418	        await self.client.bulk_write(self.models, ordered=True)
419	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
417	    async def do_task(self):
418	        await self.client.bulk_write(self.models, ordered=True)
419	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
433	    async def do_task(self):
434	        await self.corpus.bulk_write(self.models, ordered=True)
435	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
433	    async def do_task(self):
434	        await self.corpus.bulk_write(self.models, ordered=True)
435	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
446	    async def do_task(self):
447	        await self.client.bulk_write(self.models, ordered=True)
448	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
446	    async def do_task(self):
447	        await self.client.bulk_write(self.models, ordered=True)
448	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
459	        with open(gridfs_path, "rb") as data:  # noqa: ASYNC101
460	            self.document = data.read()
461	        self.data_size = len(self.document)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/async_perf_test.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
483	    async def do_task(self):
484	        await (await self.bucket.open_download_stream(self.uploaded_id)).read()
485	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	        with open(OUTPUT_FILE, "w") as opf:
99	            opf.write(output)
100	    else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
98	        with open(OUTPUT_FILE, "w") as opf:
99	            opf.write(output)
100	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	def threaded(n_threads, func):
115	    threads = [threading.Thread(target=func) for _ in range(n_threads)]
116	    for t in threads:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
205	    def mp_map(self, map_func, files):
206	        with mp.Pool(initializer=proc_init, initargs=(client_context.client_options,)) as pool:
207	            pool.map(map_func, files)

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:206
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
205	    def mp_map(self, map_func, files):
206	        with mp.Pool(initializer=proc_init, initargs=(client_context.client_options,)) as pool:
207	            pool.map(map_func, files)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
217	        with open(os.path.join(TEST_PATH, os.path.join("extended_bson", self.dataset))) as data:
218	            self.file_data = data.read()
219	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
343	        ) as data:
344	            self.document = json.loads(data.read())
345	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
453	    def do_task(self):
454	        self.corpus.bulk_write(self.models, ordered=True)
455	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
453	    def do_task(self):
454	        self.corpus.bulk_write(self.models, ordered=True)
455	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
466	    def do_task(self):
467	        self.client.bulk_write(self.models, ordered=True)
468	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
466	    def do_task(self):
467	        self.client.bulk_write(self.models, ordered=True)
468	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
479	    def do_task(self):
480	        self.corpus.bulk_write(self.models, ordered=True)
481	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
479	    def do_task(self):
480	        self.corpus.bulk_write(self.models, ordered=True)
481	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
498	    def do_task(self):
499	        self.client.bulk_write(self.models, ordered=True)
500	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
498	    def do_task(self):
499	        self.client.bulk_write(self.models, ordered=True)
500	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
514	    def do_task(self):
515	        self.corpus.bulk_write(self.models, ordered=True)
516	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
514	    def do_task(self):
515	        self.corpus.bulk_write(self.models, ordered=True)
516	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
527	    def do_task(self):
528	        self.client.bulk_write(self.models, ordered=True)
529	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
527	    def do_task(self):
528	        self.client.bulk_write(self.models, ordered=True)
529	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
540	        with open(gridfs_path, "rb") as data:
541	            self.document = data.read()
542	        self.data_size = len(self.document)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
564	    def do_task(self):
565	        self.bucket.open_download_stream(self.uploaded_id).read()
566	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
602	        for doc in coll.find({"file": filename}, {"_id": False}):
603	            temp.write(json.dumps(doc))
604	            temp.write("\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
602	        for doc in coll.find({"file": filename}, {"_id": False}):
603	            temp.write(json.dumps(doc))
604	            temp.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
603	            temp.write(json.dumps(doc))
604	            temp.write("\n")
605	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/performance/perf_test.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
603	            temp.write(json.dumps(doc))
604	            temp.write("\n")
605	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_auth.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
243	        for _ in range(4):
244	            threads.append(AutoAuthenticateThread(collection))
245	        for thread in threads:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_auth.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
267	            for _ in range(4):
268	                threads.append(AutoAuthenticateThread(collection))
269	            for thread in threads:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_auth.py:662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
661	        for _ in range(4):
662	            threads.append(AutoAuthenticateThread(coll))
663	        for thread in threads:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_binary.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
57	    )
58	    java_data = base64.b64decode(from_java)
59	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_binary.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
57	    )
58	    java_data = base64.b64decode(from_java)
59	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_binary.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
75	    )
76	    csharp_data = base64.b64decode(from_csharp)
77	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_binary.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
75	    )
76	    csharp_data = base64.b64decode(from_csharp)
77	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_bson.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
332	        with mmap.mmap(-1, len(bs)) as mm:
333	            mm.write(bs)
334	            mm.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_bson.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
332	        with mmap.mmap(-1, len(bs)) as mm:
333	            mm.write(bs)
334	            mm.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_bson.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
345	        with mmap.mmap(-1, len(bs)) as mm:
346	            mm.write(bs)
347	            mm.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_bson.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
345	        with mmap.mmap(-1, len(bs)) as mm:
346	            mm.write(bs)
347	            mm.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_bson.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
392	            with tempfile.TemporaryFile() as scratch:
393	                scratch.write(data)
394	                scratch.seek(0, os.SEEK_SET)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_bson.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
392	            with tempfile.TemporaryFile() as scratch:
393	                scratch.write(data)
394	                scratch.seek(0, os.SEEK_SET)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_bson.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
683	
684	    @unittest.skip("Disabled due to http://bugs.python.org/issue25222")
685	    def test_bad_encode(self):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_change_stream.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
316	        changes = []
317	        t = threading.Thread(target=lambda: changes.append(change_stream.next()))
318	        t.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_change_stream.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
363	
364	            t = threading.Thread(target=iterate_cursor)
365	            t.start()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
914	        self.assertIn("host='mongodb+srv://test1.test.build.10gen.cc'", repr(client))
915	        client._connect()
916	        # after srv resolution

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
917	        self.assertIn("host=['localhost.test.build.10gen.cc:", repr(client))
918	        client.close()
919	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
984	        coll = test_client.pymongo_test.bar
985	        test_client.close()
986	        with self.assertRaises(InvalidOperation):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1018
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1017	        self.assertTrue(test_client._topology._opened)
1018	        test_client.close()
1019	        self.assertFalse(test_client._topology._opened)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1031
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1030	        # Closing the client should stop the thread.
1031	        client.close()
1032	        self.assertTrue(client._kill_cursors_executor._stopped)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1065	        self.assertEqual(topology._servers, {})
1066	        client.close()
1067	        self.assertEqual(topology._servers, {})

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1072	        topology = client._topology
1073	        client.close()
1074	        for server in topology._servers.values():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1083
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1082	        with self.assertRaises(InvalidURI):
1083	            MongoClient("http://localhost")
1084	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1253	        self.assertAlmostEqual(0.1, client.options.server_selection_timeout)
1254	        client.close()
1255	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1264	        )
1265	        client.close()
1266	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1268	        self.assertAlmostEqual(0.1, client.options.server_selection_timeout)
1269	        client.close()
1270	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1272	        self.assertAlmostEqual(0, client.options.server_selection_timeout)
1273	        client.close()
1274	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1277	        self.assertAlmostEqual(30, client.options.server_selection_timeout)
1278	        client.close()
1279	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1401	
1402	                thread.start_new_thread(interrupter, ())
1403	            else:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1408	
1409	                old_signal_handler = signal.signal(signal.SIGALRM, sigalarm)
1410	                signal.alarm(1)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1409
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1408	
1409	                old_signal_handler = signal.signal(signal.SIGALRM, sigalarm)
1410	                signal.alarm(1)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1428	            if old_signal_handler:
1429	                signal.signal(signal.SIGALRM, old_signal_handler)
1430	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1429
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1428	            if old_signal_handler:
1429	                signal.signal(signal.SIGALRM, old_signal_handler)
1430	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1497	        conn = one(pool.conns)
1498	        conn.conn.close()
1499	        cursor = collection.find(cursor_type=CursorType.EXHAUST)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1520	        conn = one(pool.conns)
1521	        conn.conn.close()
1522	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1713	                while self.running:
1714	                    exc = AutoReconnect("mock pool error")
1715	                    ctx = _ErrorContext(exc, 0, pool.gen.get_overall(), False, None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1721	
1722	        t = ResetPoolThread(pool)
1723	        t.start()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1751	            time.sleep(2)
1752	            return original_connect(*args, **kwargs)
1753	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1834	            final_count = server_description_count()
1835	            client.close()
1836	            # If a bug like PYTHON-2433 is reintroduced then too many

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1861	        self.assertIsNotNone(c_id)
1862	        client.close()
1863	        # Add cursor to kill cursors queue

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1879
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1878	        )
1879	        client._connect()
1880	        self.assertEqual(client._topology_settings.srv_service_name, "customname")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1881
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1880	        self.assertEqual(client._topology_settings.srv_service_name, "customname")
1881	        client.close()
1882	        client = MongoClient(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1887	        )
1888	        client._connect()
1889	        self.assertEqual(client._topology_settings.srv_service_name, "customname")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1889	        self.assertEqual(client._topology_settings.srv_service_name, "customname")
1890	        client.close()
1891	        client = MongoClient(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1894	        )
1895	        client._connect()
1896	        self.assertEqual(client._topology_settings.srv_service_name, "customname")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1896	        self.assertEqual(client._topology_settings.srv_service_name, "customname")
1897	        client.close()
1898	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1901
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1900	        client = self.simple_client("mongodb+srv://test1.test.build.10gen.cc/")
1901	        client._connect()
1902	        self.assertGreater(len(client.topology_description.server_descriptions()), 1)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1903	        client = self.simple_client("mongodb+srv://test1.test.build.10gen.cc/", srvmaxhosts=1)
1904	        client._connect()
1905	        self.assertEqual(len(client.topology_description.server_descriptions()), 1)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:1909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1908	        )
1909	        client._connect()
1910	        self.assertEqual(len(client.topology_description.server_descriptions()), 2)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:2211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2210	        conn = one(pool.conns)
2211	        conn.conn.close()
2212	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:2239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2238	        conn = cursor._sock_mgr.conn
2239	        conn.conn.close()
2240	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client.py:2314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2313	            time.sleep(3)
2314	            return pool.__class__.connect(pool, *args, **kwargs)
2315	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	        with self.assertRaises(InvalidOperation) as context:
54	            self.client.bulk_write(models=models)
55	        self.assertIn(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	            with self.assertRaises(ClientBulkWriteException) as context:
68	                self.client.bulk_write(models=models)
69	            self.assertIsInstance(context.exception.error, TypeError)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	        with self.assertRaises(ClientBulkWriteException) as context:
81	            self.client.bulk_write(models=models)
82	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	
107	        result = client.bulk_write(models=models)
108	        self.assertEqual(result.inserted_count, self.max_write_batch_size + 1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	
139	        result = client.bulk_write(models=models)
140	        self.assertEqual(result.inserted_count, num_models)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
182	            with self.assertRaises(ClientBulkWriteException) as context:
183	                client.bulk_write(models=models)
184	            self.assertEqual(len(context.exception.write_concern_errors), 2)  # type: ignore[arg-type]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
216	        with self.assertRaises(ClientBulkWriteException) as context:
217	            client.bulk_write(models=models, ordered=False)
218	        self.assertEqual(len(context.exception.write_errors), self.max_write_batch_size + 1)  # type: ignore[arg-type]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
246	        with self.assertRaises(ClientBulkWriteException) as context:
247	            client.bulk_write(models=models, ordered=True)
248	        self.assertEqual(len(context.exception.write_errors), 1)  # type: ignore[arg-type]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
285	
286	        result = client.bulk_write(models=models, verbose_results=True)
287	        self.assertEqual(result.upserted_count, 2)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
327	            )
328	            result = client.bulk_write(models=models, session=session, verbose_results=True)
329	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
376	            with self.assertRaises(ClientBulkWriteException) as context:
377	                client.bulk_write(models=models, verbose_results=True)
378	            self.assertIsNotNone(context.exception.error)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
404	        with self.assertRaises(DocumentTooLarge):
405	            client.bulk_write(models=models_insert, ordered=False, write_concern=WriteConcern(w=0))
406	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
409	        with self.assertRaises(DocumentTooLarge):
410	            client.bulk_write(models=models_replace, ordered=False, write_concern=WriteConcern(w=0))
411	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
465	        # No batch splitting required.
466	        result = client.bulk_write(models=models)
467	        self.assertEqual(result.inserted_count, num_models + 1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
499	        # Batch splitting required.
500	        result = client.bulk_write(models=models)
501	        self.assertEqual(result.inserted_count, num_models + 1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
527	        with self.assertRaises(DocumentTooLarge):
528	            client.bulk_write(models=models)
529	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
534	        with self.assertRaises(DocumentTooLarge):
535	            client.bulk_write(models=models)
536	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
548	        with self.assertRaises(InvalidOperation) as context:
549	            client.bulk_write(models=models)
550	        self.assertIn(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
586	        )
587	        result = client.bulk_write(models=models, verbose_results=True)
588	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
612	
613	        res = client.bulk_write(models, ordered=False, write_concern=WriteConcern(w=0))
614	        self.assertEqual(False, res.acknowledged)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_client_bulk_write.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
683	            with self.assertRaises(ClientBulkWriteException) as context:
684	                client.bulk_write(models=models)
685	            self.assertIsInstance(context.exception.error, NetworkTimeout)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_collection.py:1091
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1090	        ]
1091	        db.test.bulk_write(ops, bypass_document_validation=True)
1092	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_collection.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1100	            with self.assertRaises(BulkWriteError):
1101	                db.test.bulk_write([op])
1102	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_collection.py:1104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1103	        with self.assertRaises(OperationFailure):
1104	            db_w0.test.bulk_write(ops, bypass_document_validation=True)
1105	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_connection_monitoring.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
95	        target = op["target"]
96	        thread = SpecRunnerThread(target)
97	        thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_cursor.py:1151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1150	
1151	        t = threading.Thread(target=iterate_cursor)
1152	        t.start()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_custom_types.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
210	        fileobj = tempfile.TemporaryFile()
211	        fileobj.write(bson_data)
212	        fileobj.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_custom_types.py:776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
775	        )
776	        one.write(b"hello world")
777	        one.close()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
126	        elif error_type == "network":
127	            raise AutoReconnect("mock non-timeout network error")
128	        elif error_type == "timeout":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
253	            with open(os.path.join(dirpath, filename)) as scenario_stream:
254	                scenario_def = json_util.loads(scenario_stream.read())
255	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
312	            barrier_wait(barrier, timeout=30)
313	            raise AutoReconnect("mock Connection.command error")
314	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
438	        self.server.events.append("client connected")
439	        if self.request.recv(1024).strip():
440	            self.server.events.append("client hello received")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
440	            self.server.events.append("client hello received")
441	        self.request.close()
442	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
448	        self.handle_request()
449	        self.server_close()
450	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
474	                events.append("client connected")
475	                if (reader.read(1024)).strip():
476	                    events.append("client hello received")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
476	                    events.append("client hello received")
477	                writer.close()
478	                writer.wait_closed()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
487	            )
488	            _c._connect()
489	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
492	
493	            server.close()
494	            server.wait_closed()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_discovery_and_monitoring.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
494	            server.wait_closed()
495	            _c.close()
496	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
280	    with open(os.path.join(BASE, *paths)) as fp:
281	        return fp.read()
282	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
280	    with open(os.path.join(BASE, *paths)) as fp:
281	        return fp.read()
282	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
284	def json_data(*paths):
285	    return json_util.loads(read(*paths), json_options=JSON_OPTS)
286	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
284	def json_data(*paths):
285	    return json_util.loads(read(*paths), json_options=JSON_OPTS)
286	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
377	        client.admin.command("ping")
378	        client.close()
379	        with self.assertRaisesRegex(InvalidOperation, "Cannot use MongoClient after close"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
413	        uuids = [uuid.uuid4() for _ in range(3)]
414	        result = coll.bulk_write(
415	            [
416	                UpdateOne({"_id": uuids[0]}, {"$set": {"a": 0}}, upsert=True),
417	                ReplaceOne({"a": 1}, {"_id": uuids[1]}, upsert=True),
418	                # This is just here to make the counts right in all cases.
419	                ReplaceOne({"_id": uuids[2]}, {"_id": uuids[2]}, upsert=True),
420	            ]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
455	        with self.assertRaisesRegex(ConfigurationError, msg):
456	            client.test.test.bulk_write([InsertOne({})])
457	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
597	        )
598	        client_encryption.close()
599	        # Close can be called multiple times.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
599	        # Close can be called multiple times.
600	        client_encryption.close()
601	        algo = Algorithm.AEAD_AES_256_CBC_HMAC_SHA_512_Deterministic

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
768	
769	LOCAL_KEY_ID = Binary(base64.b64decode(b"LOCALAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
770	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:769
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
768	
769	LOCAL_KEY_ID = Binary(base64.b64decode(b"LOCALAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
770	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
769	LOCAL_KEY_ID = Binary(base64.b64decode(b"LOCALAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
770	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
771	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:770
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
769	LOCAL_KEY_ID = Binary(base64.b64decode(b"LOCALAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
770	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
771	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
770	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
771	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
772	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:771
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
770	AWS_KEY_ID = Binary(base64.b64decode(b"AWSAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
771	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
772	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
771	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
772	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
773	KMIP_KEY_ID = Binary(base64.b64decode(b"KMIPAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:772
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
771	AZURE_KEY_ID = Binary(base64.b64decode(b"AZUREAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
772	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
773	KMIP_KEY_ID = Binary(base64.b64decode(b"KMIPAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
772	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
773	KMIP_KEY_ID = Binary(base64.b64decode(b"KMIPAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
774	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:773
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
772	GCP_KEY_ID = Binary(base64.b64decode(b"GCPAAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
773	KMIP_KEY_ID = Binary(base64.b64decode(b"KMIPAAAAAAAAAAAAAAAAAA=="), UUID_SUBTYPE)
774	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1224	        doc["_id"] = "over_2mib_under_16mib_bulk"
1225	        self.coll_encrypted.bulk_write([InsertOne(doc)])
1226	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1233	        doc["_id"] = "encryption_exceeds_2mib_bulk"
1234	        self.coll_encrypted.bulk_write([InsertOne(doc)])
1235	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1239	        self.listener.reset()
1240	        self.coll_encrypted.bulk_write([InsertOne(doc1), InsertOne(doc2)])
1241	        self.assertEqual(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1251	        self.listener.reset()
1252	        self.coll_encrypted.bulk_write([InsertOne(doc1), InsertOne(doc2)])
1253	        self.assertEqual(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1262	        doc["_id"] = "under_16mib_bulk"
1263	        self.coll_encrypted.bulk_write([InsertOne(doc)])
1264	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1275	        with self.assertRaises(BulkWriteError) as ctx:
1276	            self.coll_encrypted.bulk_write([InsertOne(doc)])
1277	        err = ctx.exception.details["writeErrors"][0]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1508	
1509	        self.assertEqual(bytes(ciphertext), base64.b64decode(expectation))
1510	        self.assertEqual(client_encryption.decrypt(ciphertext), "string0")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1509
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1508	
1509	        self.assertEqual(bytes(ciphertext), base64.b64decode(expectation))
1510	        self.assertEqual(client_encryption.decrypt(ciphertext), "string0")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1992	
1993	        listener_t = Thread(target=listener)
1994	        listener_t.start()

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:1993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1992	
1993	        listener_t = Thread(target=listener)
1994	        listener_t.start()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:2459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2458	
2459	        encrypted_client.close()
2460	        unencrypted_client.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:2460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2459	        encrypted_client.close()
2460	        unencrypted_client.close()
2461	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:3184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3183	                body = None
3184	            conn.request("POST", path, body, headers)
3185	            res = conn.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:3185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
3184	            conn.request("POST", path, body, headers)
3185	            res = conn.getresponse()
3186	            res.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:3186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3185	            res = conn.getresponse()
3186	            res.read()
3187	        finally:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:3186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
3185	            res = conn.getresponse()
3186	            res.read()
3187	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_encryption.py:3188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3187	        finally:
3188	            conn.close()
3189	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
234	            # closed.
235	            conn.conn.close()
236	            self.assertTrue(conn.conn_closed())

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:249
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
248	    def test_socket_closed(self):
249	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
250	        s.connect((client_context.host, client_context.port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
249	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
250	        s.connect((client_context.host, client_context.port))
251	        socket_checker = SocketChecker()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
252	        self.assertFalse(socket_checker.socket_closed(s))
253	        s.close()
254	        self.assertTrue(socket_checker.socket_closed(s))

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:257
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
256	    def test_socket_checker(self):
257	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
258	        s.connect((client_context.host, client_context.port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
257	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
258	        s.connect((client_context.host, client_context.port))
259	        socket_checker = SocketChecker()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
272	        )
273	        s.sendall(msg)
274	        # Block until the socket is readable.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
283	        self.assertTrue(socket_checker.select(s, write=True, timeout=0.05))
284	        s.close()
285	        self.assertTrue(socket_checker.socket_closed(s))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
308	            # closed.
309	            conn.conn.close()
310	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
361	        t.join()
362	        pool.close()
363	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_pooling.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
393	            time.sleep(0.05)
394	        pool.close()
395	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_read_write_concern_spec.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	            ("delete_many", lambda: collection.delete_many({})),
86	            ("bulk_write", lambda: collection.bulk_write([InsertOne({})])),
87	            ("rename_and_drop", rename_and_drop),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_read_write_concern_spec.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	            ("delete_many", lambda: coll.delete_many({})),
133	            ("bulk_write", lambda: coll.bulk_write([InsertOne({})])),
134	            ("command", insert_command),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_read_write_concern_spec.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
201	            with self.assertRaises(BulkWriteError) as ctx:
202	                self.db.test.bulk_write([InsertOne({})])
203	            expected_details = {

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_retryable_reads.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
99	            cmd_listener.reset()
100	            threads = [FindThread(client.pymongo_test.test) for _ in range(2)]
101	            fail_command = {

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_ssl.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
279	            client = self.simple_client(
280	                "127.0.0.1",
281	                ssl=True,
282	                tlsCertificateKeyFile=CLIENT_PEM,
283	                tlsAllowInvalidCertificates=False,
284	                tlsCAFile=CA_PEM,
285	            )
286	            self.assertClientWorks(client)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_ssl.py:504
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
503	            ctx = get_ssl_context(None, None, CA_PEM, None, False, False, False)
504	            ssl_sock = ctx.wrap_socket(socket.socket())
505	            self.assertEqual(ssl_sock.ca_certs, CA_PEM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_ssl.py:508
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
507	            ctx = get_ssl_context(None, None, None, None, False, False, False)
508	            ssl_sock = ctx.wrap_socket(socket.socket())
509	            self.assertEqual(ssl_sock.ca_certs, ssl_support.certifi.where())

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_ssl.py:525
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
524	        ctx = get_ssl_context(None, None, CA_PEM, None, False, False, False)
525	        ssl_sock = ctx.wrap_socket(socket.socket())
526	        self.assertEqual(ssl_sock.ca_certs, CA_PEM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_ssl.py:529
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
528	        ctx = get_ssl_context(None, None, None, None, False, False, False)
529	        ssl_sock = ctx.wrap_socket(socket.socket())
530	        self.assertEqual(ssl_sock.ca_certs, ssl_support._WINCERTS.name)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	        requests: List[InsertOne[Movie]] = [InsertOne(Movie(name="American Graffiti", year=1973))]
149	        self.assertTrue(coll.bulk_write(requests).acknowledged)
150	        new_requests: List[Union[InsertOne[Movie], ReplaceOne[Movie]]] = []

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	        requests: List[InsertOne[Movie]] = [InsertOne(Movie(name="American Graffiti", year=1973))]
149	        self.assertTrue(coll.bulk_write(requests).acknowledged)
150	        new_requests: List[Union[InsertOne[Movie], ReplaceOne[Movie]]] = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	            new_requests.append(i)
157	        self.assertTrue(coll.bulk_write(new_requests).acknowledged)
158	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
156	            new_requests.append(i)
157	        self.assertTrue(coll.bulk_write(new_requests).acknowledged)
158	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	        ]
168	        self.assertTrue(coll.bulk_write(requests).acknowledged)
169	        requests_two: List[Union[InsertOne[Movie], ReplaceOne[Movie], DeleteOne]] = [

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
167	        ]
168	        self.assertTrue(coll.bulk_write(requests).acknowledged)
169	        requests_two: List[Union[InsertOne[Movie], ReplaceOne[Movie], DeleteOne]] = [

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
176	        ]
177	        self.assertTrue(coll.bulk_write(requests_two).acknowledged)
178	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
176	        ]
177	        self.assertTrue(coll.bulk_write(requests_two).acknowledged)
178	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
339	        fileobj = tempfile.TemporaryFile()
340	        fileobj.write(content)
341	        fileobj.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
339	        fileobj = tempfile.TemporaryFile()
340	        fileobj.write(content)
341	        fileobj.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
430	        coll: Collection[MovieWithId] = client.test.test
431	        coll.bulk_write(
432	            [InsertOne(Movie({"name": "THX-1138", "year": 1971}))]  # type:ignore[arg-type]
433	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
430	        coll: Collection[MovieWithId] = client.test.test
431	        coll.bulk_write(
432	            [InsertOne(Movie({"name": "THX-1138", "year": 1971}))]  # type:ignore[arg-type]
433	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
434	        mov_dict = {"_id": ObjectId(), "name": "THX-1138", "year": 1971}
435	        coll.bulk_write(
436	            [InsertOne(mov_dict)]  # type:ignore[arg-type]
437	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
434	        mov_dict = {"_id": ObjectId(), "name": "THX-1138", "year": 1971}
435	        coll.bulk_write(
436	            [InsertOne(mov_dict)]  # type:ignore[arg-type]
437	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
437	        )
438	        coll.bulk_write(
439	            [
440	                InsertOne({"_id": ObjectId(), "name": "THX-1138", "year": 1971})  # pyright: ignore
441	            ]  # No error because it is in-line.

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
437	        )
438	        coll.bulk_write(
439	            [
440	                InsertOne({"_id": ObjectId(), "name": "THX-1138", "year": 1971})  # pyright: ignore
441	            ]  # No error because it is in-line.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
447	        coll: Collection[MovieWithId] = client.test.test
448	        coll.bulk_write(
449	            [ReplaceOne({}, Movie({"name": "THX-1138", "year": 1971}))]  # type:ignore[arg-type]
450	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
447	        coll: Collection[MovieWithId] = client.test.test
448	        coll.bulk_write(
449	            [ReplaceOne({}, Movie({"name": "THX-1138", "year": 1971}))]  # type:ignore[arg-type]
450	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
451	        mov_dict = {"_id": ObjectId(), "name": "THX-1138", "year": 1971}
452	        coll.bulk_write(
453	            [ReplaceOne({}, mov_dict)]  # type:ignore[arg-type]
454	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
451	        mov_dict = {"_id": ObjectId(), "name": "THX-1138", "year": 1971}
452	        coll.bulk_write(
453	            [ReplaceOne({}, mov_dict)]  # type:ignore[arg-type]
454	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
454	        )
455	        coll.bulk_write(
456	            [
457	                ReplaceOne({}, {"_id": ObjectId(), "name": "THX-1138", "year": 1971})  # pyright: ignore
458	            ]  # No error because it is in-line.

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_typing.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
454	        )
455	        coll.bulk_write(
456	            [
457	                ReplaceOne({}, {"_id": ObjectId(), "name": "THX-1138", "year": 1971})  # pyright: ignore
458	            ]  # No error because it is in-line.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_uri_parser.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	    def test_parse_uri(self):
159	        self.assertRaises(InvalidURI, parse_uri, "http://foobar.com")
160	        self.assertRaises(InvalidURI, parse_uri, "http://foo@foobar.com")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_uri_parser.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	        self.assertRaises(InvalidURI, parse_uri, "http://foobar.com")
160	        self.assertRaises(InvalidURI, parse_uri, "http://foo@foobar.com")
161	        self.assertRaises(ValueError, parse_uri, "mongodb://::1", 27017)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/test_uri_parser.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
267	            ("2001:0db8:85a3:0000:0000:8a2e:0370:7334", 27018),
268	            ("192.168.0.212", 27019),
269	            ("localhost", 27018),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/unified_format.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
383	            name = spec["id"]
384	            thread = SpecRunnerThread(name)
385	            thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/unified_format.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
882	        with target.open_download_stream(*args, **kwargs) as gout:
883	            return gout.read()
884	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/unified_format.py:889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
888	        with target.open_download_stream_by_name(*args, **kwargs) as gout:
889	            return gout.read()
890	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/unified_format.py:1529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1528	                opts = json_util.JSONOptions(tz_aware=False)
1529	                scenario_def = json_util.loads(scenario_stream.read(), json_options=opts)
1530	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/utils_selection_tests.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
190	            with open(os.path.join(dirpath, filename)) as scenario_stream:
191	                scenario_def = json_util.loads(scenario_stream.read())
192	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/utils_shared.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
474	        bound_target = partial(target, collection, i)
475	        threads.append(threading.Thread(target=bound_target))
476	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/utils_spec_runner.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
219	                    scenario_def = ScenarioDict(
220	                        json_util.loads(scenario_stream.read(), json_options=opts)
221	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/test/utils_spec_runner.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
483	        if "download" in name:
484	            result = Binary(result.read())
485	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/tools/ocsptest.py:43
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
42	
43	    s = socket.socket()
44	    s.connect((host, port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/tools/ocsptest.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
43	    s = socket.socket()
44	    s.connect((host, port))
45	    try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongo-4.12.0/pymongo-4.12.0/tools/ocsptest.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
47	    finally:
48	        s.close()
49	

--------------------------------------------------

Code scanned:
	Total lines of code: 124188
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 86.0
		High: 561.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 593.0
		High: 54.0
Files skipped (0):
