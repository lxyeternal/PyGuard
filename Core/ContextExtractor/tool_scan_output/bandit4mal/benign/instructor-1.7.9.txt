Run started:2025-04-12 18:58:16.133281

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/avail/run_mixtral.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    OpenAI(
11	        base_url="https://api.endpoints.anyscale.com/v1",
12	        api_key=os.environ["ANYSCALE_API_KEY"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/extract-table/run_vision.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	urls = [
111	    "https://a.storyblok.com/f/47007/2400x1260/f816b031cb/uk-ireland-in-three-charts_chart_a.png/m/2880x0",
112	    "https://a.storyblok.com/f/47007/2400x2000/bf383abc3c/231031_uk-ireland-in-three-charts_table_v01_b.png/m/2880x0",
113	]
114	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/extract-table/run_vision.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	    "https://a.storyblok.com/f/47007/2400x1260/f816b031cb/uk-ireland-in-three-charts_chart_a.png/m/2880x0",
112	    "https://a.storyblok.com/f/47007/2400x2000/bf383abc3c/231031_uk-ireland-in-three-charts_table_v01_b.png/m/2880x0",
113	]
114	
115	for url in urls:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/extract-table/run_vision_langsmith.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	urls = [
117	    "https://a.storyblok.com/f/47007/2400x1260/f816b031cb/uk-ireland-in-three-charts_chart_a.png/m/2880x0",
118	    "https://a.storyblok.com/f/47007/2400x2000/bf383abc3c/231031_uk-ireland-in-three-charts_table_v01_b.png/m/2880x0",
119	]
120	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/extract-table/run_vision_langsmith.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	    "https://a.storyblok.com/f/47007/2400x1260/f816b031cb/uk-ireland-in-three-charts_chart_a.png/m/2880x0",
118	    "https://a.storyblok.com/f/47007/2400x2000/bf383abc3c/231031_uk-ireland-in-three-charts_table_v01_b.png/m/2880x0",
119	]
120	
121	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/extract-table/run_vision_org.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	    extract(
68	        "https://www.mindmanager.com/static/mm/images/features/org-chart/hierarchical-chart.png"
69	    )
70	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/extract-table/run_vision_org_table.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	    extract(
96	        "https://www.mindmanager.com/static/mm/images/features/org-chart/hierarchical-chart.png"
97	    ).model_dump()["dataframe"]
98	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/extract-table/run_vision_receipt.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	urls = [
59	    "https://templates.mediamodifier.com/645124ff36ed2f5227cbf871/supermarket-receipt-template.jpg",
60	    "https://ocr.space/Content/Images/receipt-ocr-original.jpg",
61	]
62	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/extract-table/run_vision_receipt.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    "https://templates.mediamodifier.com/645124ff36ed2f5227cbf871/supermarket-receipt-template.jpg",
60	    "https://ocr.space/Content/Images/receipt-ocr-original.jpg",
61	]
62	
63	for url in urls:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/logfire-fastapi/test.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2	
3	response = requests.post(
4	    "http://127.0.0.1:3000/extract",
5	    json={
6	        "query": "Alice and Bob are best friends. They are currently 32 and 43 respectively. "
7	    },
8	    stream=True,
9	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/logfire-fastapi/test.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	response = requests.post(
4	    "http://127.0.0.1:3000/extract",
5	    json={
6	        "query": "Alice and Bob are best friends. They are currently 32 and 43 respectively. "
7	    },
8	    stream=True,
9	)
10	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/logfire/image.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	
75	url = "https://cdn.statcdn.com/Infographic/images/normal/16330.jpeg"
76	tables = extract_table_from_image(url)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/openai-audio/run.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
15	with open("./output.wav", "rb") as f:
16	    encoded_string = base64.b64encode(f.read()).decode("utf-8")
17	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/openai-audio/run.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
15	with open("./output.wav", "rb") as f:
16	    encoded_string = base64.b64encode(f.read()).decode("utf-8")
17	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/patching/anyscale.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    OpenAI(
11	        base_url="https://api.endpoints.anyscale.com/v1",
12	        api_key=os.environ["ANYSCALE_API_KEY"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/patching/together.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	client = openai.OpenAI(
7	    base_url="https://api.together.xyz/v1",
8	    api_key=os.environ["TOGETHER_API_KEY"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/proscons/run.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    OpenAI(
16	        base_url="http://localhost:11434/v1",
17	        api_key="ollama",  # required, but unused

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/vision/image_to_ad_copy.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
196	        try:
197	            image_list = file.read().splitlines()
198	            logger.info(f"{len(image_list)} images read from file: {image_file}")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/vision/run.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
16	    with open(image_path, "rb") as image_file:
17	        return base64.b64encode(image_file.read()).decode("utf-8")
18	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/vision/run.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
16	    with open(image_path, "rb") as image_file:
17	        return base64.b64encode(image_file.read()).decode("utf-8")
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/vision/run_raw.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	if __name__ == "__main__":
62	    url = "https://mensfashionpostingcom.files.wordpress.com/2020/03/fbe79-img_5052.jpg?w=768"
63	    products = extract_table(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/vision/run_table.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	if __name__ == "__main__":
84	    url = "https://a.storyblok.com/f/47007/2400x2000/bf383abc3c/231031_uk-ireland-in-three-charts_table_v01_b.png"
85	    tables = extract_table(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/examples/watsonx/watsonx.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	
12	os.environ["WATSONX_URL"] = "https://us-south.ml.cloud.ibm.com"
13	os.environ["WATSONX_API_KEY"] = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/cli/cli.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    if query:
29	        launch(f"https://python.useinstructor.com/?q={query}")
30	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/cli/cli.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    else:
31	        launch("https://python.useinstructor.com/")
32	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/cli/deprecated_hub.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    echo(
13	        "The instructor hub has been deprecated. Please refer to our cookbook examples at https://python.useinstructor.com/examples/"
14	    )
15	    raise Exit(1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/cli/usage.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    headers = {"Authorization": f"Bearer {api_key}"}
25	    url = f"https://api.openai.com/v1/usage?date={date}"
26	    async with aiohttp.ClientSession() as session:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	
132	        public_url = f"https://storage.googleapis.com/{data_uri[5:]}"
133	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	        try:
135	            response = requests.get(public_url)
136	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	            response.raise_for_status()
137	            media_type = response.headers.get("Content-Type")
138	            if media_type not in VALID_MIME_TYPES:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
140	
141	            data = base64.b64encode(response.content).decode("utf-8")
142	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:141
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
140	
141	            data = base64.b64encode(response.content).decode("utf-8")
142	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
149	        try:
150	            decoded = base64.b64decode(data)
151	            import imghdr

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:150
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
149	        try:
150	            decoded = base64.b64decode(data)
151	            import imghdr

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	                response = requests.head(url, allow_redirects=True)
178	                media_type = response.headers.get("Content-Type")
179	            except requests.RequestException as e:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
199	
200	        data = base64.b64encode(path.read_bytes()).decode("utf-8")
201	        return cls(source=path, media_type=media_type, data=data)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:200
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
199	
200	        data = base64.b64encode(path.read_bytes()).decode("utf-8")
201	        return cls(source=path, media_type=media_type, data=data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	        """Cachable helper method for getting image url and encoding to base64."""
207	        response = requests.get(url)
208	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
208	        response.raise_for_status()
209	        data = base64.b64encode(response.content).decode("utf-8")
210	        return data

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:209
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
208	        response.raise_for_status()
209	        data = base64.b64encode(response.content).decode("utf-8")
210	        return data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	            return types.Part.from_bytes(
263	                data=requests.get(self.source).content,
264	                mime_type=self.media_type,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
269	            return types.Part.from_bytes(
270	                data=base64.b64decode(data), mime_type=self.media_type
271	            )  # type: ignore

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:270
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
269	            return types.Part.from_bytes(
270	                data=base64.b64decode(data), mime_type=self.media_type
271	            )  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288	        """Create an Audio instance from a URL."""
289	        response = requests.get(url)
290	        content_type = response.headers.get("content-type")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	        response = requests.get(url)
290	        content_type = response.headers.get("content-type")
291	        assert (

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
294	
295	        data = base64.b64encode(response.content).decode("utf-8")
296	        return cls(source=url, data=data, media_type=content_type)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:295
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
294	
295	        data = base64.b64encode(response.content).decode("utf-8")
296	        return cls(source=url, data=data, media_type=content_type)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
312	
313	        data = base64.b64encode(path.read_bytes()).decode("utf-8")
314	        return cls(source=str(path), data=data, media_type=mime_type)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:313
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
312	
313	        data = base64.b64encode(path.read_bytes()).decode("utf-8")
314	        return cls(source=str(path), data=data, media_type=mime_type)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
332	        return types.Part.from_bytes(
333	            data=base64.b64decode(self.data),  # type: ignore
334	            mime_type=self.media_type,

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:333
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
332	        return types.Part.from_bytes(
333	            data=base64.b64decode(self.data),  # type: ignore
334	            mime_type=self.media_type,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
347	        source = image_params["source"]
348	        cache_control = image_params.get("cache_control")
349	        base_image = Image.autodetect(source)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
433	
434	        data = base64.b64encode(path.read_bytes()).decode("utf-8")
435	        return cls(source=path, media_type=media_type, data=data)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:434
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
433	
434	        data = base64.b64encode(path.read_bytes()).decode("utf-8")
435	        return cls(source=path, media_type=media_type, data=data)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
439	        try:
440	            decoded = base64.b64decode(data)
441	            # Check if it's a valid PDF by looking for the PDF header

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:440
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
439	        try:
440	            decoded = base64.b64decode(data)
441	            # Check if it's a valid PDF by looking for the PDF header

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
460	                response = requests.head(url, allow_redirects=True)
461	                media_type = response.headers.get("Content-Type")
462	            except requests.RequestException as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
488	            # Fetch the file from URL and convert to base64
489	            data = requests.get(self.source)
490	            data = base64.b64encode(data.content).decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
489	            data = requests.get(self.source)
490	            data = base64.b64encode(data.content).decode("utf-8")
491	            return {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:490
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
489	            data = requests.get(self.source)
490	            data = base64.b64encode(data.content).decode("utf-8")
491	            return {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
527	            if not self.data:
528	                self.data = requests.get(str(self.source)).content  # type: ignore
529	                self.data = base64.b64encode(self.data).decode("utf-8")  # type: ignore

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
528	                self.data = requests.get(str(self.source)).content  # type: ignore
529	                self.data = base64.b64encode(self.data).decode("utf-8")  # type: ignore
530	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:529
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
528	                self.data = requests.get(str(self.source)).content  # type: ignore
529	                self.data = base64.b64encode(self.data).decode("utf-8")  # type: ignore
530	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
548	            # Fetch the file from URL and convert to base64
549	            data = requests.get(self.source).content
550	            data = base64.b64encode(data).decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
549	            data = requests.get(self.source).content
550	            data = base64.b64encode(data).decode("utf-8")
551	            return types.Part.from_bytes(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:550
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
549	            data = requests.get(self.source).content
550	            data = base64.b64encode(data).decode("utf-8")
551	            return types.Part.from_bytes(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
551	            return types.Part.from_bytes(
552	                data=base64.b64decode(data),
553	                mime_type=self.media_type,

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:552
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
551	            return types.Part.from_bytes(
552	                data=base64.b64decode(data),
553	                mime_type=self.media_type,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
557	            return types.Part.from_bytes(
558	                data=base64.b64decode(self.data),
559	                mime_type=self.media_type,

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:558
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
557	            return types.Part.from_bytes(
558	                data=base64.b64decode(self.data),
559	                mime_type=self.media_type,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
588	            time.sleep(retry_delay)
589	            file = client.files.get(name=file.name)  # type: ignore
590	            if max_retries > 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
606	        client = Client()
607	        file = client.files.get(name=file_name)
608	        if file.source == types.FileSource.UPLOADED and file.state == FileState.ACTIVE:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
622	            and isinstance(self.source, str)
623	            and "https://generativelanguage.googleapis.com/v1beta/files/" in self.source
624	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/multimodal.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
695	    def is_image_params(x: Any) -> bool:
696	        return isinstance(x, dict) and x.get("type") == "image" and "source" in x  # type: ignore
697	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/instructor/process_response.py:669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
668	            raise ValueError(
669	                """system must be a list of SystemMessage refer 
670	                https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-runtime/client/converse.html
671	                """

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/make_desc.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	    with open(file_path, "w", encoding="utf-8") as file:
139	        file.write(frontmatter.dumps(post))
140	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/make_sitemap.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	                with open(file_path, encoding="utf-8") as f:
36	                    content = f.read()
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/conftest.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	                api_key=os.environ["BRAINTRUST_API_KEY"],
22	                base_url="https://braintrustproxy.com/v1",
23	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/conftest.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	                api_key=os.environ["BRAINTRUST_API_KEY"],
35	                base_url="https://braintrustproxy.com/v1",
36	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/test_multimodal.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	image_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/image.jpg"
18	
19	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/test_multimodal.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	
19	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"
20	
21	
22	curr_file = os.path.dirname(__file__)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/test_multimodal.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
23	pdf_path = os.path.join(curr_file, "../../assets/invoice.pdf")
24	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
25	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/test_multimodal.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
23	pdf_path = os.path.join(curr_file, "../../assets/invoice.pdf")
24	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
25	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/test_multimodal.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	pdf_path = os.path.join(curr_file, "../../assets/invoice.pdf")
24	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
25	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/test_multimodal.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
146	                        "type": "image",
147	                        "source": "https://assets.entrepreneur.com/content/3x2/2000/20200429211042-GettyImages-1164615296.jpeg",
148	                        "cache_control": {"type": "ephemeral"},
149	                    },
150	                    {
151	                        "type": "image",
152	                        "source": "https://www.bigbear.com/imager/s3_us-west-1_amazonaws_com/big-bear/images/Scenic-Snow/89xVzXp1_00588cdef1e3d54756582b576359604b.jpeg",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_anthropic/test_multimodal.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	                        "type": "image",
152	                        "source": "https://www.bigbear.com/imager/s3_us-west-1_amazonaws_com/big-bear/images/Scenic-Snow/89xVzXp1_00588cdef1e3d54756582b576359604b.jpeg",
153	                        "cache_control": {"type": "ephemeral"},
154	                    },
155	                ],
156	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_genai/test_multimodal.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	audio_file = os.path.join(curr_file, "../../assets/gettysburg.wav")
16	audio_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/gettysburg.wav"
17	
18	pdf_path = os.path.join(curr_file, "../../assets/invoice.pdf")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_genai/test_multimodal.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"
21	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_genai/test_multimodal.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
20	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"
21	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
22	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_genai/test_multimodal.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
20	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"
21	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
22	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_genai/test_multimodal.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"
21	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
22	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_genai/test_multimodal.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	    client = instructor.from_genai(client, mode=mode)
99	    image_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/image.jpg"
100	
101	    response = client.chat.completions.create(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_mistral/test_multimodal.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	
6	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"
7	
8	
9	class Invoice(BaseModel):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/conftest.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	                api_key=os.environ["BRAINTRUST_API_KEY"],
22	                base_url="https://braintrustproxy.com/v1",
23	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/conftest.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	                api_key=os.environ["BRAINTRUST_API_KEY"],
35	                base_url="https://braintrustproxy.com/v1",
36	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/test_multimodal.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	
12	audio_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/gettysburg.wav"
13	image_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/image.jpg"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/test_multimodal.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	audio_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/gettysburg.wav"
13	image_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/image.jpg"
14	
15	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/test_multimodal.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	pdf_url = "https://raw.githubusercontent.com/instructor-ai/instructor/main/tests/assets/invoice.pdf"
16	curr_file = os.path.dirname(__file__)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/test_multimodal.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
17	pdf_path = os.path.join(curr_file, "../../assets/invoice.pdf")
18	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
19	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/test_multimodal.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
17	pdf_path = os.path.join(curr_file, "../../assets/invoice.pdf")
18	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
19	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/test_multimodal.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	pdf_path = os.path.join(curr_file, "../../assets/invoice.pdf")
18	pdf_base64 = base64.b64encode(open(pdf_path, "rb").read()).decode("utf-8")
19	pdf_base64_string = f"data:application/pdf;base64,{pdf_base64}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/test_multimodal.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	    if not audio_file.exists():
36	        response = requests.get(audio_url)
37	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_openai/test_multimodal.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	        with open(audio_file, "wb") as f:
39	            f.write(response.content)
40	    return audio_file

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/llm/test_perplexity/conftest.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	            api_key=os.environ["PERPLEXITY_API_KEY"],
12	            base_url="https://api.perplexity.ai",
13	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_function_calls.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	        pytest.skip(
201	            "This test seems to fail on 3.11 but passes on 3.10 and 3.9. I suspect it's due to the ordering of tests - https://github.com/pydantic/pydantic-core/blob/e3eff5cb8a6dae8914e3831b00c690d9dee4b740/python/pydantic_core/_pydantic_core.pyi#L820C9-L829C12"
202	        )
203	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_function_calls.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
213	
214	    assert "https://errors.pydantic.dev" not in str(exc_info.value)
215	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	def test_image_from_url():
21	    url = "https://example.com/image.jpg"
22	    image = Image.from_url(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    image = Image(
41	        source="http://example.com/image.jpg", media_type="image/jpeg", data=None
42	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    image = Image(
51	        source="http://example.com/image.jpg", media_type="image/jpeg", data=None
52	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    assert openai_format["type"] == "image_url"
55	    assert openai_format["image_url"]["url"] == "http://example.com/image.jpg"
56	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	def test_convert_contents():
59	    contents = ["Hello", Image.from_url("http://example.com/image.jpg")]
60	    converted = list(convert_contents(contents, Mode.TOOLS))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    assert converted[1]["type"] == "image_url"
64	    assert converted[1]["image_url"]["url"] == "http://example.com/image.jpg"
65	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	            "role": "user",
71	            "content": ["Hello", Image.from_url("http://example.com/image.jpg")],
72	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	            "role": "user",
119	            "content": ["Hello", Image.from_url("http://example.com/image.jpg")],
120	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	def test_convert_contents_single_image():
161	    image = Image.from_url("http://example.com/image.jpg")
162	    converted = list(convert_contents(image, Mode.TOOLS))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	    assert converted == [
165	        {"type": "image_url", "image_url": {"url": "http://example.com/image.jpg"}}
166	    ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	        {"role": "assistant", "content": "Hi there!"},
173	        {"role": "user", "content": Image.from_url("http://example.com/image.jpg")},
174	    ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
216	def test_image_from_url_with_query_params():
217	    url = "https://example.com/image.jpg?param1=value1&param2=value2"
218	    image = Image.from_url(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
224	def test_image_from_url_with_unusual_extension():
225	    url = "https://example.com/image.webp"
226	    image = Image.from_url(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	    [
261	        "http://example.com/image.jpg",
262	        "https://example.com/image.png",
263	        "https://example.com/image.webp",
264	        "https://example.com/image.jpg?param=value",
265	        "base64_png",
266	    ],
267	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
261	        "http://example.com/image.jpg",
262	        "https://example.com/image.png",
263	        "https://example.com/image.webp",
264	        "https://example.com/image.jpg?param=value",
265	        "base64_png",
266	    ],
267	)
268	def test_image_from_various_urls(url, request):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
262	        "https://example.com/image.png",
263	        "https://example.com/image.webp",
264	        "https://example.com/image.jpg?param=value",
265	        "base64_png",
266	    ],
267	)
268	def test_image_from_various_urls(url, request):
269	    if url.startswith("base64"):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
263	        "https://example.com/image.webp",
264	        "https://example.com/image.jpg?param=value",
265	        "base64_png",
266	    ],
267	)
268	def test_image_from_various_urls(url, request):
269	    if url.startswith("base64"):
270	        url = request.getfixturevalue(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
291	        # URL tests
292	        ("http://example.com/image.jpg", "url", "image/jpeg"),
293	        ("https://example.com/image.png", "url", "image/png"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
292	        ("http://example.com/image.jpg", "url", "image/jpeg"),
293	        ("https://example.com/image.png", "url", "image/png"),
294	        ("https://example.com/image.webp", "url", "image/webp"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
293	        ("https://example.com/image.png", "url", "image/png"),
294	        ("https://example.com/image.webp", "url", "image/webp"),
295	        ("https://example.com/image.jpg?param=value", "url", "image/jpeg"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	        ("https://example.com/image.webp", "url", "image/webp"),
295	        ("https://example.com/image.jpg?param=value", "url", "image/jpeg"),
296	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instructor-1.7.9/instructor-1.7.9/tests/test_multimodal.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	        (
297	            "https://example.com/image",
298	            "url",
299	            "image/jpeg",
300	        ),  # Default to JPEG if no extension
301	        # Base64 data URI tests
302	        (
303	            "base64_png",

--------------------------------------------------

Code scanned:
	Total lines of code: 24099
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 84.0
		High: 44.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 108.0
		High: 20.0
Files skipped (0):
