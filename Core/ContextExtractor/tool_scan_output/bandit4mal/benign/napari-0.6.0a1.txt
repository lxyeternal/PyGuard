Run started:2025-04-12 15:43:34.153998

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/__main__.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
567	
568	                shutil.rmtree(tempdir)
569	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_check_numpy_version.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
28	    parse_version(np.__version__) < parse_version('2')
29	    and platform.system() == 'Darwin'
30	    and platform.machine() == 'arm64'

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_check_numpy_version.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
28	    parse_version(np.__version__) < parse_version('2')
29	    and platform.system() == 'Darwin'
30	    and platform.machine() == 'arm64'

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_check_numpy_version.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
28	    parse_version(np.__version__) < parse_version('2')
29	    and platform.system() == 'Darwin'
30	    and platform.machine() == 'arm64'

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_check_numpy_version.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
81	
82	    blas = ctypes.CDLL(str(blas_lib[0]), mode=os.RTLD_NOLOAD)
83	    for suffix in ('', '64_', '_64'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/__init__.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	            warn_message = trans._(
76	                "\n\nIMPORTANT:\nYou are using QT version {version}, but version {dversion} was also found in your environment.\nThis usually happens when you 'conda install' something that also depends on PyQt\n*after* you have pip installed napari (such as jupyter notebook).\nYou will likely run into problems and should create a fresh environment.\nIf you want to install conda packages into the same environment as napari,\nplease add conda-forge to your channels: https://conda-forge.org\n",
77	                deferred=True,
78	                version=QtCore.__version__,
79	                dversion=dist_info_version,
80	            )
81	    except ModuleNotFoundError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/__init__.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	        warn_message = trans._(
83	            '\n\nnapari was tested with QT library `>=5.12.3`.\nThe version installed is {version}. Please report any issues with\nthis specific QT version at https://github.com/Napari/napari/issues.',
84	            deferred=True,
85	            version=QtCore.__version__,
86	        )
87	    warn(message=warn_message, stacklevel=1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	HELP_URLS: dict[str, str] = {
25	    'getting_started': f'https://napari.org/{VERSION}/tutorials/start_index.html',
26	    'tutorials': f'https://napari.org/{VERSION}/tutorials/index.html',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    'getting_started': f'https://napari.org/{VERSION}/tutorials/start_index.html',
26	    'tutorials': f'https://napari.org/{VERSION}/tutorials/index.html',
27	    'layers_guide': f'https://napari.org/{VERSION}/howtos/layers/index.html',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    'tutorials': f'https://napari.org/{VERSION}/tutorials/index.html',
27	    'layers_guide': f'https://napari.org/{VERSION}/howtos/layers/index.html',
28	    'examples_gallery': f'https://napari.org/{VERSION}/gallery.html',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    'layers_guide': f'https://napari.org/{VERSION}/howtos/layers/index.html',
28	    'examples_gallery': f'https://napari.org/{VERSION}/gallery.html',
29	    'plugins': f'https://napari.org/{VERSION}/plugins/index.html',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    'examples_gallery': f'https://napari.org/{VERSION}/gallery.html',
29	    'plugins': f'https://napari.org/{VERSION}/plugins/index.html',
30	    'contribute': f'https://napari.org/{VERSION}/developers/index.html',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	    'plugins': f'https://napari.org/{VERSION}/plugins/index.html',
30	    'contribute': f'https://napari.org/{VERSION}/developers/index.html',
31	    'release_notes': f'https://napari.org/{VERSION}/release/release_{VERSION.replace(".", "_")}.html',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    'contribute': f'https://napari.org/{VERSION}/developers/index.html',
31	    'release_notes': f'https://napari.org/{VERSION}/release/release_{VERSION.replace(".", "_")}.html',
32	    'github_issue': 'https://github.com/napari/napari/issues',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    'release_notes': f'https://napari.org/{VERSION}/release/release_{VERSION.replace(".", "_")}.html',
32	    'github_issue': 'https://github.com/napari/napari/issues',
33	    'homepage': 'https://napari.org',
34	}
35	
36	Q_HELP_ACTIONS: list[Action] = [
37	    Action(
38	        id='napari.window.help.info',
39	        title=trans._('‎napari Info'),
40	        callback=_show_about,
41	        menus=[{'id': MenuId.MENUBAR_HELP, 'group': MenuGroup.RENDER}],
42	        status_tip=trans._('About napari'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_qapp_model/qactions/_help.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    'github_issue': 'https://github.com/napari/napari/issues',
33	    'homepage': 'https://napari.org',
34	}
35	
36	Q_HELP_ACTIONS: list[Action] = [
37	    Action(
38	        id='napari.window.help.info',
39	        title=trans._('‎napari Info'),
40	        callback=_show_about,
41	        menus=[{'id': MenuId.MENUBAR_HELP, 'group': MenuGroup.RENDER}],
42	        status_tip=trans._('About napari'),
43	        keybindings=[KeyBindingRule(primary=KeyMod.CtrlCmd | KeyCode.Slash)],

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_tests/test_qt_viewer.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
433	    assert os.path.exists(expected_filepath)
434	    output_data = imread(expected_filepath)
435	    expected_data = viewer.window._qt_viewer.screenshot(flash=False)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_tests/test_qt_viewer.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1020	
1021	    imageio.imwrite(tmp_path / 'canvas_screenshot_.png', canvas_screenshot_)
1022	    np.savez(tmp_path / 'canvas_screenshot_.npz', canvas_screenshot_)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_tests/test_qt_window.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
100	@pytest.mark.skipif(
101	    platform.system() == 'Darwin', reason='Cannot control menu bar on MacOS'
102	)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/_tests/test_qt_window.py:101
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
100	@pytest.mark.skipif(
101	    platform.system() == 'Darwin', reason='Cannot control menu bar on MacOS'
102	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/dialogs/_tests/test_qt_plugin_report.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        'standard_metadata',
20	        lambda x: {'url': 'https://github.com/example/example'},
21	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/perf/_tests/test_perf.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	        with script_path.open('w') as f:
56	            f.write(script)
57	        return '-m', 'coverage', 'run', str(script_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/qt_event_loop.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
392	
393	    if app.thread().loopLevel() >= max_loop_level:
394	        loops = app.thread().loopLevel()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/qt_event_loop.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
393	    if app.thread().loopLevel() >= max_loop_level:
394	        loops = app.thread().loopLevel()
395	        warn(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/qt_main_window.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
232	            settings.appearance.update_status_based_on_layer
233	            and QApplication.instance().thread().loopLevel()
234	        ):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/qt_resources/_tests/test_icons.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
8	    if (_themes := ICON_PATH / '_themes').exists():
9	        shutil.rmtree(_themes)
10	    dir_hash_result = dir_hash(ICON_PATH)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
296	    # if we don't, the widget will actually be black and white.
297	    widget._flash_animation.finished.connect(
298	        partial(remove_flash_animation, weakref.ref(widget))
299	    )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
351	    """
352	    old_sigint_handler = signal.getsignal(signal.SIGINT)
353	    handler_args = None

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
363	    # Clear the socket to re-arm the notifier.
364	    sn.activated.connect(lambda *args: rsock.recv(1))
365	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
363	    # Clear the socket to re-arm the notifier.
364	    sn.activated.connect(lambda *args: rsock.recv(1))
365	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
370	
371	    signal.signal(signal.SIGINT, handle)
372	    try:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:371
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
370	
371	    signal.signal(signal.SIGINT, handle)
372	    try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
374	    finally:
375	        wsock.close()
376	        rsock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
375	        wsock.close()
376	        rsock.close()
377	        sn.setEnabled(False)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
378	        signal.set_wakeup_fd(old_wakeup_fd)
379	        signal.signal(signal.SIGINT, old_sigint_handler)
380	        if handler_args is not None:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/utils.py:379
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
378	        signal.set_wakeup_fd(old_wakeup_fd)
379	        signal.signal(signal.SIGINT, old_sigint_handler)
380	        if handler_args is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_qt/widgets/qt_extension2reader.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	            trans._(
56	                'Enter a filename pattern to associate with a reader e.g. "*.tif" for all TIFF files.  Available readers will be filtered to those compatible with your pattern. Hover over a reader to see what patterns it accepts. \n\nYou can save a preference for a specific folder by listing the folder name with a "/" at the end (for example, "/test_images/"). \n\nFor documentation on valid filename patterns, see https://docs.python.org/3/library/fnmatch.html'
57	            )
58	        )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_vendor/darkdetect/_mac_detect.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
90	    import signal
91	    signal.signal(signal.SIGINT, signal.SIG_IGN)
92	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_vendor/darkdetect/_mac_detect.py:91
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
90	    import signal
91	    signal.signal(signal.SIGINT, signal.SIG_IGN)
92	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/_vispy/visuals/volume.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	
135	SMOOTH_GRADIENT_DEFINITION = """
136	vec3 calculateGradient(vec3 loc, vec3 step, float current_val) {
137	    // calculate gradient within the volume by finite differences
138	    // using a 3D sobel-feldman convolution kernel
139	
140	    // the kernel here is a 3x3 cube, centered on the sample at `loc`
141	    // the kernel for G.z looks like this:
142	
143	    // [ +1 +2 +1 ]
144	    // [ +2 +4 +2 ]    <-- "loc - step.z" is in the center
145	    // [ +1 +2 +1 ]
146	
147	    // [  0  0  0 ]
148	    // [  0  0  0 ]    <-- "loc" is in the center
149	    // [  0  0  0 ]
150	
151	    // [ -1 -2 -1 ]
152	    // [ -2 -4 -2 ]    <-- "loc + step.z" is in the center
153	    // [ -1 -2 -1 ]
154	
155	    // kernels for G.x and G.y similar, but transposed
156	    // see https://en.wikipedia.org/wiki/Sobel_operator#Extension_to_other_dimensions
157	
158	    vec3 G = vec3(0.0);
159	    // next and prev are the directly adjacent values along x, y, and z
160	    vec3 next = vec3(0.0);
161	    vec3 prev = vec3(0.0);
162	
163	    float val;
164	    bool is_on_border = false;
165	    for (int i=-1; i <= 1; i++) {
166	        for (int j=-1; j <= 1; j++) {
167	            for (int k=-1; k <= 1; k++) {
168	                if (is_on_border && (i != 0 && j != 0 && k != 0)) {
169	                    // we only care about on-axis values if we are on a border
170	                    continue;
171	                }
172	                vec3 sample_loc = loc + vec3(i, j, k) * step;
173	                bool is_in_bounds = all(greaterThanEqual(sample_loc, vec3(0.0)))
174	                    && all(lessThanEqual(sample_loc, vec3(1.0)));
175	
176	                if (is_in_bounds || u_clamp_at_border) {
177	                    val = colorToVal($get_data(sample_loc));
178	                } else {
179	                    val = categorical_bg_value;
180	                }
181	
182	                G.x += val * -float(i) *
183	                    (1 + float(j == 0 || k == 0) + 2 * float(j == 0 && k == 0));
184	                G.y += val * -float(j) *
185	                    (1 + float(i == 0 || k == 0) + 2 * float(i == 0 && k == 0));
186	                G.z += val * -float(k) *
187	                    (1 + float(i == 0 || j == 0) + 2 * float(i == 0 && j == 0));
188	
189	                next.x += int(i == 1 && j == 0 && k == 0) * val;
190	                next.y += int(i == 0 && j == 1 && k == 0) * val;
191	                next.z += int(i == 0 && j == 0 && k == 1) * val;
192	                prev.x += int(i == -1 && j == 0 && k == 0) * val;
193	                prev.y += int(i == 0 && j == -1 && k == 0) * val;
194	                prev.z += int(i == 0 && j == 0 && k == -1) * val;
195	
196	                is_on_border = is_on_border || (!is_in_bounds && (i == 0 || j == 0 || k == 0));
197	            }
198	        }
199	    }
200	
201	    if (is_on_border && u_clamp_at_border) {
202	        // fallback to simple gradient calculation if we are on the border
203	        // and clamping is enabled (old behavior with dark/hollow faces at the border)
204	        // this makes the faces in `fast` and `smooth` look the same in both clamping modes
205	        G = next - prev;
206	    } else {
207	        // add to the gradient where the adjacent voxels are both background
208	        // to fix dim pixels due to poor normal estimation
209	        G.x = G.x + (next.x - current_val) * 2.0 * detectAdjacentBackground(prev.x, next.x);
210	        G.y = G.y + (next.y - current_val) * 2.0 * detectAdjacentBackground(prev.y, next.y);
211	        G.z = G.z + (next.z - current_val) * 2.0 * detectAdjacentBackground(prev.z, next.z);
212	    }
213	
214	    return G;
215	}
216	"""
217	
218	ISO_CATEGORICAL_SNIPPETS = {

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/components/_layer_slicer.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
110	        self.events = EmitterGroup(source=self, ready=Event)
111	        self._executor: Executor = ThreadPoolExecutor(max_workers=1)
112	        self._force_sync = not get_settings().experimental.async_

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/components/_tests/test_add_layers.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
220	
221	@pytest.mark.xfail(reason='https://github.com/napari/napari/issues/6198')
222	def test_last_point_is_visible_in_viewport():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/components/_tests/test_add_layers.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
250	
251	@pytest.mark.xfail(reason='https://github.com/napari/napari/issues/6199')
252	def test_dimension_change_is_visible_in_viewport():

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/components/experimental/monitor/_api.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
132	        self._manager = SharedMemoryManager(
133	            address=('127.0.0.1', SERVER_PORT), authkey=str.encode(AUTH_KEY)
134	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/components/experimental/monitor/_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
43	    json_bytes = json_str.encode('ascii')
44	    message_bytes = base64.b64encode(json_bytes)
45	    return message_bytes.decode('ascii')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/components/experimental/monitor/_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
43	    json_bytes = json_str.encode('ascii')
44	    message_bytes = base64.b64encode(json_bytes)
45	    return message_bytes.decode('ascii')

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/conftest.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
539	def single_threaded_executor():
540	    executor = ThreadPoolExecutor(max_workers=1)
541	    yield executor

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/conftest.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1071	                if os.environ.get('CI', False):
1072	                    self.write(
1073	                        f' [{timedelta(seconds=int(perf_counter() - self._start_time))}]'
1074	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/conftest.py:1078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1077	            self._tw.line()
1078	            self.write(relfspath + ' ')
1079	        self.write(res, flush=True, **markup)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/conftest.py:1079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1078	            self.write(relfspath + ' ')
1079	        self.write(res, flush=True, **markup)
1080	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/layers/shapes/_tests/test_shapes_utils.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
37	    """
38	    exec(
39	        """
40	from napari.layers.shapes._tests.test_shapes_utils import (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/plugins/io.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
79	
80	    res = _npe2.read(paths, plugin, stack=stack)
81	    if res is not None:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/plugins/npe2api.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
46	        (platform.python_implementation(), platform.python_version()),
47	        (platform.system(), platform.release()),
48	    ]

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/plugins/npe2api.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
46	        (platform.python_implementation(), platform.python_version()),
47	        (platform.system(), platform.release()),
48	    ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/plugins/npe2api.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	    """Return PackageMetadata object for all known napari plugins."""
71	    url = 'https://npe2api.vercel.app/api/extended_summary'
72	    with urlopen(Request(url, headers={'User-Agent': _user_agent()})) as resp:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/plugins/npe2api.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
71	    url = 'https://npe2api.vercel.app/api/extended_summary'
72	    with urlopen(Request(url, headers={'User-Agent': _user_agent()})) as resp:
73	        return json.load(resp)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/plugins/npe2api.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	    """Return map of PyPI package name to conda_channel/package_name ()."""
79	    url = 'https://npe2api.vercel.app/api/conda'
80	    with urlopen(Request(url, headers={'User-Agent': _user_agent()})) as resp:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/plugins/npe2api.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
79	    url = 'https://npe2api.vercel.app/api/conda'
80	    with urlopen(Request(url, headers={'User-Agent': _user_agent()})) as resp:
81	        return json.load(resp)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/plugins/npe2api.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
86	    try:
87	        with ThreadPoolExecutor() as executor:
88	            data = executor.submit(plugin_summaries)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/settings/_base.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
206	        with open(path, 'w') as target:
207	            target.write(_data)
208	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/settings/_experimental.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        description=trans._(
80	            'When enabled, triangulation (breaking down polygons into '
81	            "triangles that can be displayed by napari's graphics engine) is "
82	            'sped up by using C++ code from the optional library '

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_proxies.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	            not in ('0', 'False')
117	        ) and not in_main_thread():
118	            raise RuntimeError(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_proxies.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	
209	    return threading.current_thread() == threading.main_thread()
210	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_proxies.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	
209	    return threading.current_thread() == threading.main_thread()
210	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_proxies.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
228	
229	        res = in_qt_main_thread()
230	        in_main_thread = in_qt_main_thread

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_register.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
14	with open(tmpl_path) as f:
15	    template = f.read()
16	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_register.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
86	    code = compile(src, filename=tmpl_path, mode='exec')
87	    exec(code, execdict)
88	    func = execdict[name]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_tests/test_misc.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	    assert abspath_or_url(sep + 'something') == abspath(sep + 'something')
172	    assert abspath_or_url('https://something') == 'https://something'
173	    assert abspath_or_url('http://something') == 'http://something'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_tests/test_misc.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	    assert abspath_or_url(sep + 'something') == abspath(sep + 'something')
172	    assert abspath_or_url('https://something') == 'https://something'
173	    assert abspath_or_url('http://something') == 'http://something'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_tests/test_misc.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	    assert abspath_or_url('https://something') == 'https://something'
173	    assert abspath_or_url('http://something') == 'http://something'
174	    assert abspath_or_url('ftp://something') == 'ftp://something'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/_tests/test_misc.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	    assert abspath_or_url('https://something') == 'https://something'
173	    assert abspath_or_url('http://something') == 'http://something'
174	    assert abspath_or_url('ftp://something') == 'ftp://something'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/io.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	
56	        iio.imwrite(filename, data)  # for all other file extensions
57	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/io.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	    pnginfo.add_text(
78	        'Software', f'napari version {__version__} https://napari.org/'
79	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/io.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	    )
80	    iio.imwrite(
81	        filename,
82	        data,
83	        extension='.png',
84	        plugin='pillow',
85	        pnginfo=pnginfo,
86	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/io.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	    if data.dtype == bool:
102	        tifffile.imwrite(filename, data)
103	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/io.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
104	        try:
105	            tifffile.imwrite(
106	                filename,
107	                data,
108	                # compression arg structure since tifffile 2022.7.28
109	                compression='zlib',
110	                compressionargs={'level': 1},
111	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/io.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	            # not as widely supported as normal tiffs.)
117	            tifffile.imwrite(
118	                filename,
119	                data,
120	                compression='zlib',
121	                compressionargs={'level': 1},
122	                bigtiff=True,
123	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/notebook_display.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
130	        png = self._repr_png_()
131	        url = 'data:image/png;base64,' + base64.b64encode(png).decode('utf-8')
132	        _alt = html.escape(self.alt_text) if self.alt_text is not None else ''

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari/utils/notebook_display.py:131
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
130	        png = self._repr_png_()
131	        url = 'data:image/png;base64,' + base64.b64encode(png).decode('utf-8')
132	        _alt = html.escape(self.alt_text) if self.alt_text is not None else ''

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
45	        if spec.ext == '.tif':
46	            tifffile.imwrite(str(fname), image)
47	        elif spec.ext == '.zarr':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	        else:
52	            imageio.imwrite(str(fname), image)
53	        return fname

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	    with pytest.raises(ValueError, match='No files found in'):
60	        magic_imread(tmp_path)
61	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	    z[:] = image
75	    image_in = magic_imread([data_path])
76	    np.testing.assert_array_equal(image, image_in)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
85	
86	    image_in = magic_imread([str(root_path / image_name)])
87	    np.testing.assert_array_equal(image, image_in)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
99	
100	    image_in = magic_imread([str(root_path)])
101	    np.testing.assert_array_equal(image, image_in[0])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	        z[:] = multiscale[i]
117	    multiscale_in = magic_imread([fout])
118	    assert len(multiscale) == len(multiscale_in)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
241	    fnames = [str(write_spec(spec)) for _ in range(stacks)]
242	    [(layer_data,)] = npe2.read(fnames, stack=stacks > 1)
243	    assert isinstance(layer_data, np.ndarray if stacks == 1 else da.Array)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
258	    )
259	    images = magic_imread(fnames, stack=stack, use_dask=use_dask)
260	    if isinstance(spec, ImageSpec):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
296	        ):
297	            magic_imread(fnames, use_dask=False, stack=stack)
298	        return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
299	
300	    images = magic_imread(fnames, use_dask=False, stack=stack)
301	    assert isinstance(images, list)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
309	def test_add_zarr(write_spec):
310	    [out] = npe2.read([str(write_spec(ZARR1))], stack=False)
311	    assert out[0].shape == ZARR1.shape  # type: ignore

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
321	    image_path = os.path.join(zarr_dir, '1d')
322	    assert npe2.read([image_path], stack=False) == [(None,)]
323	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_io.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
335	    for name in z.array_keys():
336	        [out] = npe2.read([os.path.join(zarr_dir, name)], stack=False)
337	        if name.endswith('1d'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/_tests/test_reader.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    layer_data = npe2.read(
57	        ['https://samples.fiji.sc/FakeTracks.tif'], stack=False
58	    )

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
57	            with tempfile.NamedTemporaryFile(delete=False, suffix=ext) as f:
58	                u = urllib.request.urlopen(resource_name)
59	                f.write(u.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
58	                u = urllib.request.urlopen(resource_name)
59	                f.write(u.read())
60	            # f must be closed before yielding

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
58	                u = urllib.request.urlopen(resource_name)
59	                f.write(u.read())
60	            # f must be closed before yielding

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
58	                u = urllib.request.urlopen(resource_name)
59	                f.write(u.read())
60	            # f must be closed before yielding

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
93	    if ext.lower() not in ['.tif', '.tiff', '.lsm']:
94	        return iio.imread(filename)
95	    import tifffile

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
98	    with file_or_url_context(filename) as filename:
99	        return tifffile.imread(str(filename))
100	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
239	            if shape is None:
240	                image = imread(filename)
241	                shape = image.shape

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
247	            elif len(images) > 0:  # not read by shape clause
248	                image = imread(filename)
249	        images.append(image)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_read.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
503	def _magic_imreader(path: str) -> list['LayerData']:
504	    return [(magic_imread(path),)]
505	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_write.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
311	                # or named plugin if provided
312	                npe2.write(
313	                    path=abspath_or_url(os.path.join(tmp, meta['name'])),
314	                    layer_data=[layer_data_tuple],
315	                    plugin_name='napari',
316	                )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_write.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
311	                # or named plugin if provided
312	                npe2.write(
313	                    path=abspath_or_url(os.path.join(tmp, meta['name'])),
314	                    layer_data=[layer_data_tuple],
315	                    plugin_name='napari',
316	                )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/napari-0.6.0a1/napari-0.6.0a1/napari_builtins/io/_write.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
321	        if not already_existed:
322	            shutil.rmtree(path, ignore_errors=True)
323	        raise

--------------------------------------------------

Code scanned:
	Total lines of code: 120864
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 70.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 96.0
		High: 10.0
Files skipped (0):
