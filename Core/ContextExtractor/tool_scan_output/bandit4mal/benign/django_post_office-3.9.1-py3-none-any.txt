Run started:2025-04-12 16:02:17.319098

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/__init__.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4	with open(join(dirname(__file__), 'version.txt')) as fh:
5	    VERSION = literal_eval(fh.read())
6	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/admin.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
192	            if isinstance(message, SafeMIMEText) and message.get_content_type() == 'text/plain':
193	                return format_html('<pre>{}</pre>', message.get_payload())
194	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/admin.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
202	            if isinstance(message, SafeMIMEText) and message.get_content_type() == 'text/html':
203	                payload = message.get_payload(decode=True).decode('utf-8')
204	                return clean_html(pattern.sub(url, payload))

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/admin.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
211	            if message.get_content_maintype() == 'image' and message.get('Content-Id')[1:33] == content_id:
212	                return HttpResponse(message.get_payload(decode=True), content_type=message.get_content_type())
213	        return HttpResponseNotFound()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/lockfile.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	        try:
44	            return int(open(self.lock_filename).read())
45	        except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/lockfile.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
121	        pid_file = os.open(self.pid_filename, os.O_CREAT | os.O_EXCL | os.O_RDWR)
122	        os.write(pid_file, str(os.getpid()).encode('utf-8'))
123	        os.close(pid_file)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/lockfile.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
121	        pid_file = os.open(self.pid_filename, os.O_CREAT | os.O_EXCL | os.O_RDWR)
122	        os.write(pid_file, str(os.getpid()).encode('utf-8'))
123	        os.close(pid_file)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/lockfile.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
124	
125	        if hasattr(os, 'symlink') and platform.system() != 'Windows':
126	            os.symlink(self.pid_filename, self.lock_filename)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/lockfile.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
124	
125	        if hasattr(os, 'symlink') and platform.system() != 'Windows':
126	            os.symlink(self.pid_filename, self.lock_filename)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/lockfile.py:125
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
124	
125	        if hasattr(os, 'symlink') and platform.system() != 'Windows':
126	            os.symlink(self.pid_filename, self.lock_filename)

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/mail.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
286	
287	            pool = Pool(processes)
288	

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/mail.py:287
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
286	
287	            pool = Pool(processes)
288	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/mail.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
363	    number_of_threads = min(get_threads_per_process(), email_count)
364	    pool = ThreadPool(number_of_threads)
365	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/models.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173	                mime_part = MIMENonMultipart(*attachment.mimetype.split('/'))
174	                mime_part.set_payload(attachment.file.read())
175	                for key, val in attachment.headers.items():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/models.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	            else:
182	                msg.attach(attachment.name, attachment.file.read(), mimetype=attachment.mimetype or None)
183	            attachment.file.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/templatetags/post_office.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	        fileobj = File(open(absfilename, 'rb'), name=file)
33	    raw_data = fileobj.read()
34	    image = MIMEImage(raw_data)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/test_settings.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
3	
4	if platform.system() in ['Darwin']:
5	    from multiprocessing import set_start_method

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/test_settings.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
3	
4	if platform.system() in ['Darwin']:
5	    from multiprocessing import set_start_method

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/test_settings.py:4
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
3	
4	if platform.system() in ['Darwin']:
5	    from multiprocessing import set_start_method

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/tests/test_backends.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
138	        self.assertEqual(email.attachments.all()[0].name, 'attachment.txt')
139	        self.assertEqual(email.attachments.all()[0].file.read(), b'attachment content')
140	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/tests/test_backends.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	        fileobj = File(open(filename, 'rb'), name='dummy.png')
147	        image = MIMEImage(fileobj.read())
148	        image.add_header('Content-Disposition', 'inline', filename='dummy.png')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/tests/test_backends.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
155	        self.assertEqual(email.attachments.all()[0].name, 'dummy.png')
156	        self.assertEqual(email.attachments.all()[0].file.read(), image.get_payload().encode())
157	        self.assertEqual(email.attachments.all()[0].headers.get('Content-ID'), '<{dummy.png}>')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/tests/test_lockfile.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
25	        with open(lockfile, 'w+') as f:
26	            f.write('9999999')
27	        assert os.path.exists(lockfile)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/tests/test_lockfile.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	        with open(lockfile, 'w+') as f:
37	            f.write(str(os.getpid()))
38	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/tests/test_lockfile.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	        with open(lockfile, 'w+') as f:
48	            f.write(str(os.getpid()))
49	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_post_office-3.9.1-py3-none-any/post_office/tests/test_lockfile.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	        with open(lockfile, 'w+') as f:
62	            f.write(str(os.getpid()))
63	

--------------------------------------------------

Code scanned:
	Total lines of code: 4169
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 3.0
Files skipped (0):
