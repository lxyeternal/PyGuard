Run started:2025-04-12 13:59:15.674405

Test results:
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mcap-1.2.2/mcap-1.2.2/mcap/stream_reader.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
72	    if chunk.compression == "zstd":
73	        data: bytes = zstandard.decompress(chunk.data, chunk.uncompressed_size)
74	    elif chunk.compression == "lz4":

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mcap-1.2.2/mcap-1.2.2/mcap/stream_reader.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
74	    elif chunk.compression == "lz4":
75	        data: bytes = lz4.frame.decompress(chunk.data)  # type: ignore
76	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mcap-1.2.2/mcap-1.2.2/tests/test_reader.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	        assert size is not None and size > 0
33	        return super().read(size)
34	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mcap-1.2.2/mcap-1.2.2/tests/test_reader.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
261	    with open(filepath, "w") as f:
262	        f.write("some bytes longer than the initial magic bytes")
263	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mcap-1.2.2/mcap-1.2.2/tests/test_reader.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
341	    writer.start("profile", "library")
342	    write_stream.write(b"\x80\x00\x00\x00\x00\x00\x00\x00\x00")
343	    writer.finish()

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mcap-1.2.2/mcap-1.2.2/tests/test_writer.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
71	        assert index.uncompressed_size == chunk.uncompressed_size
72	        uncompressed_data: bytes = lz4.frame.decompress(chunk.data)
73	        assert chunk.uncompressed_size == len(uncompressed_data)

--------------------------------------------------

Code scanned:
	Total lines of code: 2523
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 0.0
Files skipped (0):
