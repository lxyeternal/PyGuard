Run started:2025-04-12 16:22:22.311429

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/app/mask_renderer.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
220	    tool.prepare(det_size=(128,128))
221	    image = cv2.imread("Tom_Hanks_54745.png")
222	    params = tool.build_params(image)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/app/mask_renderer.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
229	
230	    cv2.imwrite('output_mask.jpg', mask_out)
231	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/data/image.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	    assert image_file is not None, '%s not found'%name
22	    img = cv2.imread(image_file)
23	    if to_rgb:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/data/rec_builder.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        with open(os.path.join(self.path, 'property'), 'w') as f:
69	            f.write("%d,%d,%d\n" % (self.max_label+1, self.image_size[0], self.image_size[1]))
70	            f.write("%d\n" % (self.widx))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/data/rec_builder.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	            f.write("%d,%d,%d\n" % (self.max_label+1, self.image_size[0], self.image_size[1]))
70	            f.write("%d\n" % (self.widx))
71	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/model_zoo/model_store.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	
25	base_repo_url = 'https://insightface.ai/files/'
26	_url_format = '{repo_url}models/{file_name}.zip'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/model_zoo/scrfd.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
324	    for img_path in img_paths:
325	        img = cv2.imread(img_path)
326	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/model_zoo/scrfd.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
346	        print('output:', filename)
347	        cv2.imwrite('./outputs/%s'%filename, img)
348	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	            s = 'v {} {} {} {} {} {}\n'.format(vertices[i, 0], vertices[i, 1], vertices[i, 2], colors[i, 0], colors[i, 1], colors[i, 2])
51	            f.write(s)
52	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
57	            s = 'f {} {} {}\n'.format(triangles[i, 2], triangles[i, 1], triangles[i, 0])
58	            f.write(s)
59	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	        s = "mtllib {}\n".format(os.path.abspath(mtl_name))
83	        f.write(s)
84	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	            s = 'v {} {} {}\n'.format(vertices[i, 0], vertices[i, 1], vertices[i, 2])
88	            f.write(s)
89	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	            s = 'vt {} {}\n'.format(uv_coords[i,0], 1 - uv_coords[i,1])
93	            f.write(s)
94	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
94	
95	        f.write("usemtl FaceTexture\n")
96	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	            s = 'f {}/{} {}/{} {}/{}\n'.format(triangles[i,2], triangles[i,2], triangles[i,1], triangles[i,1], triangles[i,0], triangles[i,0])
100	            f.write(s)
101	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
103	    with open(mtl_name, 'w') as f:
104	        f.write("newmtl FaceTexture\n")
105	        s = 'map_Kd {}\n'.format(os.path.abspath(texture_name)) # map to image

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	        s = 'map_Kd {}\n'.format(os.path.abspath(texture_name)) # map to image
106	        f.write(s)
107	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
136	    with open(mtl_name, 'w') as f:
137	        f.write("newmtl FaceTexture\n")
138	        s = 'map_Kd {}\n'.format(os.path.abspath(texture_name)) # map to image

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh/io.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	        s = 'map_Kd {}\n'.format(os.path.abspath(texture_name)) # map to image
139	        f.write(s)
140	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	            s = 'v {} {} {} {} {} {}\n'.format(vertices[i, 0], vertices[i, 1], vertices[i, 2], colors[i, 0], colors[i, 1], colors[i, 2])
57	            f.write(s)
58	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	            s = 'f {} {} {}\n'.format(triangles[i, 2], triangles[i, 1], triangles[i, 0])
64	            f.write(s)
65	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	        s = "mtllib {}\n".format(os.path.abspath(mtl_name))
89	        f.write(s)
90	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	            s = 'v {} {} {}\n'.format(vertices[i, 0], vertices[i, 1], vertices[i, 2])
94	            f.write(s)
95	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	            s = 'vt {} {}\n'.format(uv_coords[i,0], uv_coords[i,1])
100	            f.write(s)
101	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	
102	        f.write("usemtl FaceTexture\n")
103	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	            s = 'f {}/{} {}/{} {}/{}\n'.format(triangles[i,2], triangles[i,2], triangles[i,1], triangles[i,1], triangles[i,0], triangles[i,0])
107	            f.write(s)
108	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
110	    with open(mtl_name, 'w') as f:
111	        f.write("newmtl FaceTexture\n")
112	        s = 'map_Kd {}\n'.format(os.path.abspath(texture_name)) # map to image

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	        s = 'map_Kd {}\n'.format(os.path.abspath(texture_name)) # map to image
113	        f.write(s)
114	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	        s = "mtllib {}\n".format(os.path.abspath(mtl_name))
142	        f.write(s)
143	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	            s = 'v {} {} {} {} {} {}\n'.format(vertices[i, 0], vertices[i, 1], vertices[i, 2], colors[i, 0], colors[i, 1], colors[i, 2])
147	            f.write(s)
148	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
152	            s = 'vt {} {}\n'.format(uv_coords[i,0], uv_coords[i,1])
153	            f.write(s)
154	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
154	
155	        f.write("usemtl FaceTexture\n")
156	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	            s = 'f {}/{} {}/{} {}/{}\n'.format(triangles[i,2], triangles[i,2], triangles[i,1], triangles[i,1], triangles[i,0], triangles[i,0])
161	            f.write(s)
162	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	    with open(mtl_name, 'w') as f:
165	        f.write("newmtl FaceTexture\n")
166	        s = 'map_Kd {}\n'.format(os.path.abspath(texture_name)) # map to image

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/thirdparty/face3d/mesh_numpy/io.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
166	        s = 'map_Kd {}\n'.format(os.path.abspath(texture_name)) # map to image
167	        f.write(s)
168	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/utils/download.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	        while True:
26	            data = f.read(1048576)
27	            if not data:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/utils/download.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        print('Downloading %s from %s...' % (fname, url))
71	        r = requests.get(url, stream=True)
72	        if r.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/utils/download.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	            raise RuntimeError("Failed downloading url %s" % url)
74	        total_length = r.headers.get('content-length')
75	        with open(fname, 'wb') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/utils/download.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	                    if chunk:  # filter out keep-alive new chunks
79	                        f.write(chunk)
80	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/utils/download.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
86	                                  dynamic_ncols=True):
87	                    f.write(chunk)
88	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/insightface/utils/storage.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	
7	BASE_REPO_URL = 'https://github.com/deepinsight/insightface/releases/download/v0.7'
8	
9	def download(sub_dir, name, force=False, root='~/.insightface'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/setup.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
16	                 encoding=kwargs.get("encoding", "utf8")) as fp:
17	        return fp.read()
18	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	def find_version(*file_paths):
20	    version_file = read(*file_paths)
21	    version_match = re.search(r"^__version__ = ['\"]([^'\"]*)['\"]",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/setup.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	    print('WARNING: pandoc not enabled')
34	    long_description = open('README.md').read()
35	    pypandoc_enabled = False

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/insightface-0.7.3/insightface-0.7.3/setup.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    author_email='contact@insightface.ai',
82	    url='https://github.com/deepinsight/insightface',
83	    description='InsightFace Python Library',

--------------------------------------------------

Code scanned:
	Total lines of code: 3969
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 42.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 45.0
		High: 0.0
Files skipped (0):
