Run started:2025-04-12 11:42:54.593410

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/callbacks/wandb_callback.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
299	        if _default_persist_dir:
300	            shutil.rmtree(persist_dir, ignore_errors=True)
301	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/callbacks/wandb_callback.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
555	        self._wandb.termlog(
556	            f"Streaming LlamaIndex events to W&B at {run_url}\n"
557	            "`WandbCallbackHandler` is currently in beta.\n"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/chat_engine/condense_plus_context.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
306	        )
307	        thread = Thread(
308	            target=chat_response.write_response_to_history, args=(self._memory,)
309	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/chat_engine/condense_plus_context.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
346	        )
347	        thread = Thread(
348	            target=lambda x: asyncio.run(chat_response.awrite_response_to_history(x)),
349	            args=(self._memory,),
350	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/chat_engine/context.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
212	        )
213	        thread = Thread(
214	            target=chat_response.write_response_to_history, args=(self._memory,)
215	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/chat_engine/context.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
286	        )
287	        thread = Thread(
288	            target=lambda x: asyncio.run(chat_response.awrite_response_to_history(x)),
289	            args=(self._memory,),
290	        )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/command_line/rag.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
185	                    return
186	                os.system(f"rm -rf {self.persist_dir}")
187	            print(f"Successfully cleared {self.persist_dir}")

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/command_line/rag.py:186
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
185	                    return
186	                os.system(f"rm -rf {self.persist_dir}")
187	            print(f"Successfully cleared {self.persist_dir}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/command_line/rag.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
216	            with open(f"{self.persist_dir}/{RAG_HISTORY_FILE_NAME}", "a") as f:
217	                f.write(files + "\n")
218	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/command_line/rag.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
276	                            ]
277	                            os.system(" ".join(command_args))
278	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/command_line/rag.py:277
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
276	                            ]
277	                            os.system(" ".join(command_args))
278	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/dataset.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	LLAMA_DATASETS_LFS_URL = (
19	    f"https://media.githubusercontent.com/media/run-llama/llama-datasets/main"
20	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/dataset.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	LLAMA_DATASETS_SOURCE_FILES_GITHUB_TREE_URL = (
23	    "https://github.com/run-llama/llama-datasets/tree/main"
24	)
25	LLAMA_SOURCE_FILES_PATH = "source_files"
26	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/dataset.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    """Get the list of source files to download."""
50	    resp = requests.get(
51	        source_tree_url + path + "?recursive=1", headers={"Accept": "application/json"}
52	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/dataset.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	            dataset_id = library[dataset_class]["id"]
81	            source_files = library[dataset_class].get("source_files", [])
82	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/dataset.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	            with open(local_library_path, "w") as f:
115	                f.write(library_raw_content)
116	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/dataset.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	        with open(f"{module_path}/{base_file_name}", "w") as f:
158	            f.write(dataset_raw_content)
159	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/dataset.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
175	                    ) as f:
176	                        f.write(source_file_raw_content_bytes)
177	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/dataset.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
184	                    ) as f:
185	                        f.write(source_file_raw_content)
186	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	LLAMA_HUB_CONTENTS_URL = f"https://raw.githubusercontent.com/run-llama/llama-hub/main"
25	LLAMA_HUB_PATH = "/llama_hub"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	logger = logging.getLogger(__name__)
31	LLAMAHUB_ANALYTICS_PROXY_SERVER = "https://llamahub.ai/api/analytics/downloads"
32	
33	
34	class MODULE_TYPE(str, Enum):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	            module_id = library[module_class]["id"]
63	            extra_files = library[module_class].get("extra_files", [])
64	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	        module_id = library[module_class]["id"]
75	        extra_files = library[module_class].get("extra_files", [])
76	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	            with open(local_library_path, "w") as f:
85	                f.write(library_raw_content)
86	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
129	        with open(f"{module_path}/{base_file_name}", "w") as f:
130	            f.write(basepy_raw_content)
131	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	            with open(init_file_path, mode) as f:
147	                f.write(f"from .{module_id} import {', '.join(loader_exports)}")
148	                existing_exports = get_exports(f.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
147	                f.write(f"from .{module_id} import {', '.join(loader_exports)}")
148	                existing_exports = get_exports(f.read())
149	            rewrite_exports(existing_exports + loader_exports, str(local_dir_path))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
151	        with open(f"{module_path}/{extra_file}", "w") as f:
152	            f.write(extra_file_raw_content)
153	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
163	            with open(requirements_path, "w") as f:
164	                f.write(response_txt)
165	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/module.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
268	    try:
269	        requests.post(
270	            LLAMAHUB_ANALYTICS_PROXY_SERVER,
271	            json={"type": module_type, "plugin": module_class},
272	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/utils.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
9	    """Get the content of a file from the GitHub REST API."""
10	    resp = requests.get(url + path)
11	    return resp.text, resp.status_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/utils.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
15	    """Get the content of a file from the GitHub REST API."""
16	    resp = requests.get(url + path)
17	    return resp.content, resp.status_code

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/utils.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
65	                continue
66	            f.write(line + os.linesep)
67	        f.write(f"__all__ = {list(set(exports))}" + os.linesep)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/download/utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	            f.write(line + os.linesep)
67	        f.write(f"__all__ = {list(set(exports))}" + os.linesep)
68	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/anyscale.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	DEFAULT_API_BASE = "https://api.endpoints.anyscale.com/v1"
16	DEFAULT_MODEL = "thenlper/gte-large"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/azure_openai.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        if (
77	            values["api_base"] == "https://api.openai.com/v1"
78	            and values["azure_endpoint"] is None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/azure_openai.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	            raise ValueError(
81	                "You must set OPENAI_API_BASE to your Azure endpoint. "
82	                "It should look like https://YOUR_RESOURCE_NAME.openai.azure.com/"
83	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/bedrock.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
337	
338	        resp = json.loads(response.get("body").read().decode("utf-8"))
339	        identifiers = PROVIDER_SPECIFIC_IDENTIFIERS.get(provider, None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/clarifai.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	
11	EXAMPLE_URL = "https://clarifai.com/anthropic/completion/models/claude-v2"
12	
13	
14	class ClarifaiEmbedding(BaseEmbedding):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/clip.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	            raise ImportError(
79	                "ClipEmbedding requires `pip install git+https://github.com/openai/CLIP.git` and torch."
80	            )
81	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/clip.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	                raise ImportError(
115	                    "ClipEmbedding requires `pip install git+https://github.com/openai/CLIP.git` and torch."
116	                )
117	            text_embedding = self._model.encode_text(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/fastembed.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        "BAAI/bge-small-en-v1.5",
27	        description="Name of the FastEmbedding model to use.\n"
28	        "Defaults to 'BAAI/bge-small-en-v1.5'.\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/google.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	# Google Universal Sentence Encode v5
13	DEFAULT_HANDLE = "https://tfhub.dev/google/universal-sentence-encoder-large/5"
14	
15	
16	class GoogleUnivSentEncoderEmbedding(BaseEmbedding):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/huggingface_utils.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	    pooling_config_url = (
81	        f"https://huggingface.co/{model_name}/raw/main/1_Pooling/config.json"
82	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/huggingface_utils.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	    try:
85	        response = requests.get(pooling_config_url)
86	        config_data = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/huggingface_utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	
88	        cls_token = config_data.get("pooling_mode_cls_token", False)
89	        mean_tokens = config_data.get("pooling_mode_mean_tokens", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/huggingface_utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	        cls_token = config_data.get("pooling_mode_cls_token", False)
89	        mean_tokens = config_data.get("pooling_mode_mean_tokens", False)
90	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/jinaai.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	API_URL = "https://api.jina.ai/v1/embeddings"
18	
19	
20	class JinaEmbedding(BaseEmbedding):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/jinaai.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
81	        # Call Jina AI Embedding API
82	        resp = self._session.post(  # type: ignore
83	            API_URL, json={"input": texts, "model": self.model}
84	        ).json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/jinaai.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
104	            }
105	            async with session.post(
106	                f"{API_URL}",
107	                json={"input": texts, "model": self.model},
108	                headers=headers,
109	            ) as response:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/llm_rails.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	        session = requests.Session()
44	        session.mount("https://api.llmrails.com", HTTPAdapter(max_retries=retry))
45	        session.headers = {"X-API-KEY": api_key}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/llm_rails.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
58	        try:
59	            response = self.session.post(
60	                "https://api.llmrails.com/v1/embeddings",
61	                json={"input": [text], "model": self.model_id},
62	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/llm_rails.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	            response = self.session.post(
60	                "https://api.llmrails.com/v1/embeddings",
61	                json={"input": [text], "model": self.model_id},
62	            )
63	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/llm_rails.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
90	            async with httpx.AsyncClient() as client:
91	                response = await client.post(
92	                    "https://api.llmrails.com/v1/embeddings",
93	                    headers={"X-API-KEY": self.api_key},
94	                    json={"input": [text], "model": self.model_id},
95	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/llm_rails.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	                response = await client.post(
92	                    "https://api.llmrails.com/v1/embeddings",
93	                    headers={"X-API-KEY": self.api_key},
94	                    json={"input": [text], "model": self.model_id},
95	                )
96	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/ollama_embedding.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        model_name: str,
27	        base_url: str = "http://localhost:11434",
28	        embed_batch_size: int = DEFAULT_EMBED_BATCH_SIZE,
29	        ollama_additional_kwargs: Optional[Dict[str, Any]] = None,
30	        callback_manager: Optional[CallbackManager] = None,
31	    ) -> None:
32	        super().__init__(
33	            model_name=model_name,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/ollama_embedding.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
88	
89	        response = requests.post(
90	            url=f"{self.base_url}/api/embeddings",
91	            headers={"Content-Type": "application/json"},
92	            json=ollama_request_body,
93	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/ollama_embedding.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	        if response.status_code != 200:
96	            optional_detail = response.json().get("error")
97	            raise ValueError(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/text_embeddings_inference.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	
12	DEFAULT_URL = "http://127.0.0.1:8080"
13	
14	
15	class TextEmbeddingsInference(BaseEmbedding):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/together.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    api_base: str = Field(
14	        default="https://api.together.xyz/v1",
15	        description="The base URL for the Together API.",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/together.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        api_key: Optional[str] = None,
26	        api_base: str = "https://api.together.xyz/v1",
27	        **kwargs: Any,
28	    ) -> None:
29	        api_key = api_key or os.environ.get("TOGETHER_API_KEY", None)
30	        super().__init__(
31	            model_name=model_name,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/together.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	    ) -> None:
29	        api_key = api_key or os.environ.get("TOGETHER_API_KEY", None)
30	        super().__init__(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/together.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
53	        session = requests.Session()
54	        response = session.post(
55	            self.api_base.strip("/") + "/embeddings",
56	            headers=headers,
57	            json={"input": text, "model": model_api_string},
58	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/together.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
82	        async with httpx.AsyncClient() as client:
83	            response = await client.post(
84	                self.api_base.strip("/") + "/embeddings",
85	                headers=headers,
86	                json={"input": text, "model": model_api_string},
87	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
26	    with open(file_path, "w") as f:
27	        f.write(",".join([str(x) for x in embedding]))
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/embeddings/utils.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	            raise ValueError(
52	                "\n******\n"
53	                "Could not load OpenAI embedding model. "
54	                "If you intended to use OpenAI, please check your OPENAI_API_KEY.\n"
55	                "Original error:\n"
56	                f"{e!s}"
57	                "\nConsider using embed_model='local'.\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/evaluation/benchmarks/beir.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	            if not os.path.exists(dataset_full_path):
36	                url = f"""https://public.ukp.informatik.tu-darmstadt.de/thakur\
37	/BEIR/datasets/{dataset}.zip"""
38	                try:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/evaluation/benchmarks/beir.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
43	                    )
44	                    rmtree(dataset_full_path)
45	                    raise ValueError(f"invalid BEIR dataset: {dataset}") from e

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/evaluation/benchmarks/hotpotqa.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	DEV_DISTRACTOR_URL = """http://curtis.ml.cmu.edu/datasets/\
19	hotpot/hotpot_dev_distractor_v1.json"""
20	
21	
22	class HotpotQAEvaluator:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/evaluation/benchmarks/hotpotqa.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	                )
40	                response = requests.get(url, stream=True)
41	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/evaluation/benchmarks/hotpotqa.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	                    if chunk:
48	                        save_file.write(chunk)
49	            except Exception as e:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/evaluation/benchmarks/hotpotqa.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
53	                    )
54	                    rmtree(dataset_full_path)
55	                raise ValueError(f"could not download {dataset} dataset") from e

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/evaluation/benchmarks/hotpotqa.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	        f = open(dataset_path)
74	        query_objects = json.loads(f.read())
75	        if queries_fraction:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/exec_utils.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
151	    _verify_source_safety(__source)
152	    return exec(__source, _get_restricted_globals(__globals), __locals)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/finetuning/cross_encoders/cross_encoder.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	                raise ValueError(
114	                    "HuggingFace CLI/Hub login not "
115	                    "completed provide token to login using"
116	                    "huggingface_hub.login() see this "

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/graph_stores/simple.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
89	        self._data = data or SimpleGraphStoreData()
90	        self._fs = fs or fsspec.filesystem("file")
91	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/graph_stores/simple.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
160	        """Create a SimpleGraphStore from a persist directory."""
161	        fs = fs or fsspec.filesystem("file")
162	        if not fs.exists(persist_path):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/img_utils.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
12	    image.save(buff, format=format)
13	    return cast(str, base64.b64encode(buff.getvalue()))
14	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/img_utils.py:13
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
12	    image.save(buff, format=format)
13	    return cast(str, base64.b64encode(buff.getvalue()))
14	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/img_utils.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
17	    """Convert base64 encoded image str to a PIL.Image."""
18	    buff = BytesIO(base64.b64decode(data))
19	    return Image.open(buff)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/img_utils.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
17	    """Convert base64 encoded image str to a PIL.Image."""
18	    buff = BytesIO(base64.b64decode(data))
19	    return Image.open(buff)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/colbert_index/base.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	                "Please install colbert to use this feature from the repo:",
79	                "https://github.com/stanford-futuredata/ColBERT",
80	            ) from exc
81	        super().__init__(
82	            nodes=nodes,

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/colbert_index/base.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
148	            # Remove the existing destination directory
149	            shutil.rmtree(persist_dir)
150	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	        self._vectara_customer_id = vectara_customer_id or str(
79	            os.environ.get("VECTARA_CUSTOMER_ID")
80	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	        self._vectara_corpus_id = vectara_corpus_id or str(
82	            os.environ.get("VECTARA_CORPUS_ID")
83	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	        )
84	        self._vectara_api_key = vectara_api_key or os.environ.get("VECTARA_API_KEY")
85	        if (

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
150	        }
151	        response = self._session.post(
152	            "https://api.vectara.io/v1/delete-doc",
153	            data=json.dumps(body),
154	            verify=True,
155	            headers=self._get_post_headers(),
156	            timeout=self.vectara_api_timeout,
157	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	        response = self._session.post(
152	            "https://api.vectara.io/v1/delete-doc",
153	            data=json.dumps(body),
154	            verify=True,
155	            headers=self._get_post_headers(),
156	            timeout=self.vectara_api_timeout,
157	        )
158	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	        if "parts" in doc:
175	            api_url = "https://api.vectara.io/v1/core/index"
176	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	        else:
177	            api_url = "https://api.vectara.io/v1/index"
178	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
178	
179	        response = self._session.post(
180	            headers=self._get_post_headers(),
181	            url=api_url,
182	            data=json.dumps(request),
183	            timeout=self.vectara_api_timeout,
184	            verify=True,
185	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
228	        if self.parallelize_ingest:
229	            with ThreadPoolExecutor() as executor:
230	                futures = [executor.submit(self._index_doc, doc) for doc in docs]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
291	        headers.pop("Content-Type")
292	        response = self._session.post(
293	            f"https://api.vectara.io/upload?c={self._vectara_customer_id}&o={self._vectara_corpus_id}&d=True",
294	            files=files,
295	            verify=True,
296	            headers=headers,
297	            timeout=self.vectara_api_timeout,
298	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
292	        response = self._session.post(
293	            f"https://api.vectara.io/upload?c={self._vectara_customer_id}&o={self._vectara_corpus_id}&d=True",
294	            files=files,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/base.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
333	    def as_query_engine(self, **kwargs: Any) -> BaseQueryEngine:
334	        if kwargs.get("summary_enabled", True):
335	            from llama_index.legacy.indices.managed.vectara.query import (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/vectara/retriever.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	            headers=self._get_post_headers(),
184	            url="https://api.vectara.io/v1/query",
185	            data=json.dumps(data),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/base.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	        self.domain = (
81	            f"https://controller.api.{cloud_region}.zillizcloud.com/v1/pipelines"
82	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/base.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	        """
123	        ingest_pipe_id = self.pipeline_ids.get("INGESTION")
124	        ingestion_url = f"{self.domain}/{ingest_pipe_id}/run"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/base.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
129	        params["data"].update(metadata)
130	        response = requests.post(ingestion_url, headers=self.headers, json=params)
131	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/base.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	    def delete_by_doc_name(self, doc_name: str) -> int:
139	        deletion_pipe_id = self.pipeline_ids.get("DELETION")
140	        deletion_url = f"{self.domain}/{deletion_pipe_id}/run"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/base.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
142	        params = {"data": {"doc_name": doc_name}}
143	        response = requests.post(deletion_url, headers=self.headers, json=params)
144	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/base.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	        # Get pipelines
167	        response = requests.get(url, headers=self.headers)
168	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/base.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
291	        for k, v in params_dict.items():
292	            response = requests.post(self.domain, headers=self.headers, json=v)
293	            if response.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/retriever.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	
40	        search_pipe_id = index.pipeline_ids.get("SEARCH")
41	        self.search_pipeline_url = f"{index.domain}/{search_pipe_id}/run"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/indices/managed/zilliz/retriever.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	
57	        response = requests.post(
58	            self.search_pipeline_url, headers=self.headers, json=params
59	        )

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/ingestion/pipeline.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
456	
457	            with multiprocessing.get_context("spawn").Pool(num_workers) as p:
458	                node_batches = self._node_batcher(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/ingestion/pipeline.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
615	            loop = asyncio.get_event_loop()
616	            with ProcessPoolExecutor(max_workers=num_workers) as p:
617	                node_batches = self._node_batcher(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llm_predictor/vellum/types.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	        return f"https://app.vellum.ai/deployments/{self.deployment_id}"
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llm_predictor/vellum/types.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	
27	        url = f"https://app.vellum.ai/playground/sandbox/{self.sandbox_id}"
28	        if not self.sandbox_snapshot_id:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/anyscale.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	DEFAULT_API_BASE = "https://api.endpoints.anyscale.com/v1"
14	DEFAULT_MODEL = "meta-llama/Llama-2-70b-chat-hf"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/anyscale_utils.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	
6	DEFAULT_ANYSCALE_API_BASE = "https://api.endpoints.anyscale.com/v1"
7	DEFAULT_ANYSCALE_API_VERSION = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/azure_openai.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	        if (
128	            values["api_base"] == "https://api.openai.com/v1"
129	            and values["azure_endpoint"] is None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/azure_openai.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	            raise ValueError(
132	                "You must set OPENAI_API_BASE to your Azure endpoint. "
133	                "It should look like https://YOUR_RESOURCE_NAME.openai.azure.com/"
134	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/clarifai.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	
22	EXAMPLE_URL = "https://clarifai.com/anthropic/completion/models/claude-v2"
23	
24	
25	class Clarifai(LLM):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/everlyai.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	
11	EVERLYAI_API_BASE = "https://everlyai.xyz/hosted"
12	DEFAULT_MODEL = "meta-llama/Llama-2-7b-chat-hf"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/konko_utils.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	DEFAULT_KONKO_API_TYPE = "open_ai"
21	DEFAULT_KONKO_API_BASE = "https://api.konko.ai/v1"
22	DEFAULT_KONKO_API_VERSION = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/konko_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	DEFAULT_KONKO_API_VERSION = ""
23	MISSING_API_KEY_ERROR_MESSAGE = """No Konko API key found for LLM.
24	E.g. to use konko Please set the KONKO_API_KEY environment variable or \
25	konko.api_key prior to initialization.
26	API keys can be found or created at \
27	https://www.konko.ai/
28	"""
29	
30	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/litellm.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        description=(
46	            "The LiteLLM model to use. "
47	            "For complete list of providers https://docs.litellm.ai/docs/providers"
48	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/litellm_utils.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	
16	MISSING_API_KEY_ERROR_MESSAGE = """No API key found for LLM.
17	E.g. to use openai Please set the OPENAI_API_KEY environment variable or \
18	openai.api_key prior to initialization.
19	API keys can be found or created at \
20	https://platform.openai.com/account/api-keys
21	"""
22	INVALID_API_KEY_ERROR_MESSAGE = """Invalid LLM API key."""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/llama_cpp.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	DEFAULT_LLAMA_CPP_GGML_MODEL = (
32	    "https://huggingface.co/TheBloke/Llama-2-13B-chat-GGML/resolve"
33	    "/main/llama-2-13b-chat.ggmlv3.q4_0.bin"
34	)
35	DEFAULT_LLAMA_CPP_GGUF_MODEL = (
36	    "https://huggingface.co/TheBloke/Llama-2-13B-chat-GGUF/resolve"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/llama_cpp.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	DEFAULT_LLAMA_CPP_GGUF_MODEL = (
36	    "https://huggingface.co/TheBloke/Llama-2-13B-chat-GGUF/resolve"
37	    "/main/llama-2-13b-chat.Q4_0.gguf"
38	)
39	DEFAULT_LLAMA_CPP_MODEL_VERBOSITY = True
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/llama_cpp.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	            raise ImportError(
99	                "Could not import llama_cpp library."
100	                "Please install llama_cpp with `pip install llama-cpp-python`."
101	                "See the full installation guide for GPU support at "

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/llama_cpp.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
183	            print("Downloading url", model_url, "to path", model_path)
184	            with requests.get(model_url, stream=True) as r:
185	                with open(model_path, "wb") as file:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/llama_cpp.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	                with open(model_path, "wb") as file:
186	                    total_size = int(r.headers.get("Content-Length") or "0")
187	                    if total_size < 1000 * 1000:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/llama_cpp.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	                            "Content should be at least 1 MB, but is only",
190	                            r.headers.get("Content-Length"),
191	                            "bytes",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/llama_cpp.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
198	                    ):
199	                        file.write(chunk)
200	            completed = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/localai.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        "api_type": "localai_fake",
27	        "api_base": f"http://localhost:{DEFAULT_LOCALAI_PORT}/v1",
28	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/mistral.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	DEFAULT_MISTRALAI_MODEL = "mistral-tiny"
37	DEFAULT_MISTRALAI_ENDPOINT = "https://api.mistral.ai"
38	DEFAULT_MISTRALAI_MAX_TOKENS = 512

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/monsterapi.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        model: str,
45	        base_url: str = "https://api.monsterapi.ai/v1",
46	        monster_api_key: Optional[str] = None,
47	        max_new_tokens: int = DEFAULT_NUM_OUTPUTS,
48	        temperature: float = DEFAULT_MONSTER_TEMP,
49	        context_window: int = DEFAULT_CONTEXT_WINDOW,
50	        callback_manager: Optional[CallbackManager] = None,
51	        system_prompt: Optional[str] = None,
52	        messages_to_prompt: Optional[Callable[[Sequence[ChatMessage]], str]] = None,
53	        completion_to_prompt: Optional[Callable[[str], str]] = None,
54	        pydantic_program_mode: PydanticProgramMode = PydanticProgramMode.DEFAULT,
55	        output_parser: Optional[BaseOutputParser] = None,
56	    ) -> None:
57	        self._client, available_llms = self.initialize_client(monster_api_key, base_url)
58	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/neutrino.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	
12	DEFAULT_API_BASE = "https://router.neutrinoapp.com/api/llm-router"
13	DEFAULT_ROUTER = "default"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/neutrino.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    model: str = Field(
19	        description="The Neutrino router to use. See https://docs.neutrinoapp.com/router for details."
20	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/nvidia_tensorrt.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	            print(
87	                "Unable to import `tensorrt_llm` module. Please ensure you have\
88	                  `tensorrt_llm` installed in your environment. You can run\
89	                  `pip3 install tensorrt_llm -U --extra-index-url https://pypi.nvidia.com` to install."

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/nvidia_tensorrt.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
171	                with open(serialize_path, "rb") as f:
172	                    engine_buffer = f.read()
173	                decoder = tensorrt_llm.runtime.GenerationSession(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/ollama.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    base_url: str = Field(
32	        default="http://localhost:11434",
33	        description="Base url the model is hosted under.",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/openai_utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	DEFAULT_OPENAI_API_TYPE = "open_ai"
27	DEFAULT_OPENAI_API_BASE = "https://api.openai.com/v1"
28	DEFAULT_OPENAI_API_VERSION = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/openai_utils.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	
122	MISSING_API_KEY_ERROR_MESSAGE = """No API key found for OpenAI.
123	Please set either the OPENAI_API_KEY environment variable or \
124	openai.api_key prior to initialization.
125	API keys can be found or created at \
126	https://platform.openai.com/account/api-keys
127	"""
128	
129	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/openai_utils.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	            azure_ad_token = credential.get_token(
362	                "https://cognitiveservices.azure.com/.default"
363	            )
364	        except ClientAuthenticationError as err:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/openrouter.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	DEFAULT_API_BASE = "https://openrouter.ai/api/v1"
14	DEFAULT_MODEL = "gryphe/mythomax-l2-13b"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/openrouter.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    model: str = Field(
19	        description="The OpenRouter model to use. See https://openrouter.ai/models for options."
20	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/openrouter.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        default=DEFAULT_CONTEXT_WINDOW,
23	        description="The maximum number of context tokens for the model. See https://openrouter.ai/models for options.",
24	        gt=0,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    api_base: str = Field(
39	        default="https://api.perplexity.ai",
40	        description="The base URL for Perplexity API.",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	        api_key: Optional[str] = None,
58	        api_base: Optional[str] = "https://api.perplexity.ai",
59	        additional_kwargs: Optional[Dict[str, Any]] = None,
60	        max_retries: int = 10,
61	        context_window: Optional[int] = None,
62	        callback_manager: Optional[CallbackManager] = None,
63	        system_prompt: Optional[str] = None,
64	        messages_to_prompt: Optional[Callable[[Sequence[ChatMessage]], str]] = None,
65	        completion_to_prompt: Optional[Callable[[str], str]] = None,
66	        pydantic_program_mode: PydanticProgramMode = PydanticProgramMode.DEFAULT,
67	        output_parser: Optional[BaseOutputParser] = None,
68	        **kwargs: Any,
69	    ) -> None:
70	        additional_kwargs = additional_kwargs or {}
71	        headers = {
72	            "accept": "application/json",
73	            "content-type": "application/json",
74	            "authorization": f"Bearer {api_key}",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	        }
124	        return model_context_windows.get(
125	            self.model, 4096
126	        )  # Default to 4096 if model not found

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
163	        }
164	        response = requests.post(url, json=payload, headers=self.headers)
165	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
185	        }
186	        response = requests.post(url, json=payload, headers=self.headers)
187	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
205	        async with httpx.AsyncClient() as client:
206	            response = await client.post(url, json=payload, headers=self.headers)
207	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
230	        async with httpx.AsyncClient() as client:
231	            response = await client.post(url, json=payload, headers=self.headers)
232	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
255	            with requests.Session() as session:
256	                with session.post(
257	                    url, json=payload, headers=self.headers, stream=True
258	                ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
295	            async with aiohttp.ClientSession() as session:
296	                async with session.post(
297	                    url, json=payload, headers=self.headers
298	                ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
334	            with requests.Session() as session:
335	                with session.post(
336	                    url, json=payload, headers=self.headers, stream=True
337	                ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/perplexity.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
375	            async with aiohttp.ClientSession() as session:
376	                async with session.post(
377	                    url, json=payload, headers=self.headers
378	                ) as response:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/rungpt.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
114	            )
115	        response_gpt = requests.post(
116	            self.base_url + "/generate",
117	            json=self._request_pack("complete", prompt, **kwargs),
118	            stream=False,
119	        ).json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/rungpt.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
137	            )
138	        response_gpt = requests.post(
139	            self.base_url + "/generate_stream",
140	            json=self._request_pack("complete", prompt, **kwargs),
141	            stream=True,
142	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/rungpt.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
178	            )
179	        response_gpt = requests.post(
180	            self.base_url + "/chat",
181	            json=self._request_pack("chat", message_list, **kwargs),
182	            stream=False,
183	        ).json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/rungpt.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
198	            )
199	        response_gpt = requests.post(
200	            self.base_url + "/chat_stream",
201	            json=self._request_pack("chat", message_list, **kwargs),
202	            stream=True,
203	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/together.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        api_key: Optional[str] = None,
12	        api_base: str = "https://api.together.xyz/v1",
13	        is_chat_model: bool = True,
14	        **kwargs: Any,
15	    ) -> None:
16	        api_key = api_key or os.environ.get("TOGETHER_API_KEY", None)
17	        super().__init__(
18	            model=model,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/vertex_gemini_utils.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
38	            elif path.startswith("data:image/jpeg;base64,"):
39	                image = Image.from_bytes(base64.b64decode(path[23:]))
40	            else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/vertex_gemini_utils.py:39
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
38	            elif path.startswith("data:image/jpeg;base64,"):
39	                image = Image.from_bytes(base64.b64decode(path[23:]))
40	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/vllm.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
284	        model: str = "facebook/opt-125m",
285	        api_url: str = "http://localhost:8000",
286	        temperature: float = 1.0,
287	        tensor_parallel_size: Optional[int] = 1,
288	        trust_remote_code: Optional[bool] = True,
289	        n: int = 1,
290	        best_of: Optional[int] = None,
291	        presence_penalty: float = 0.0,
292	        frequency_penalty: float = 0.0,
293	        top_p: float = 1.0,
294	        top_k: int = -1,
295	        use_beam_search: bool = False,
296	        stop: Optional[List[str]] = None,
297	        ignore_eos: bool = False,
298	        max_new_tokens: int = 512,
299	        logprobs: Optional[int] = None,
300	        dtype: str = "auto",
301	        download_dir: Optional[str] = None,
302	        messages_to_prompt: Optional[Callable] = None,
303	        completion_to_prompt: Optional[Callable] = None,
304	        vllm_kwargs: Dict[str, Any] = {},
305	        callback_manager: Optional[CallbackManager] = None,
306	        output_parser: Optional[BaseOutputParser] = None,
307	    ) -> None:
308	        self._client = None
309	        messages_to_prompt = messages_to_prompt or generic_messages_to_prompt

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/vllm.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
353	        sampling_params["prompt"] = prompt
354	        response = post_http_request(self.api_url, sampling_params, stream=False)
355	        output = get_response(response)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/vllm.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
370	        sampling_params["prompt"] = prompt
371	        response = post_http_request(self.api_url, sampling_params, stream=True)
372	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/llms/vllm_utils.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
17	
18	    return requests.post(api_url, headers=headers, json=sampling_params, stream=True)
19	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/multi_modal_llms/generic_utils.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
23	    with open(image_path, "rb") as image_file:
24	        return base64.b64encode(image_file.read()).decode("utf-8")
25	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/multi_modal_llms/generic_utils.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
23	    with open(image_path, "rb") as image_file:
24	        return base64.b64encode(image_file.read()).decode("utf-8")
25	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/multi_modal_llms/generic_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	        elif image_document.image_url:
44	            response = requests.get(image_document.image_url)
45	            try:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/multi_modal_llms/generic_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
46	                image_encodings.append(
47	                    base64.b64encode(response.content).decode("utf-8")
48	                )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/multi_modal_llms/generic_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
46	                image_encodings.append(
47	                    base64.b64encode(response.content).decode("utf-8")
48	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/multi_modal_llms/openai_utils.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	DEFAULT_OPENAI_API_TYPE = "open_ai"
9	DEFAULT_OPENAI_API_BASE = "https://api.openai.com/v1"
10	
11	
12	GPT4V_MODELS = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/multi_modal_llms/openai_utils.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	MISSING_API_KEY_ERROR_MESSAGE = """No API key found for OpenAI.
18	Please set either the OPENAI_API_KEY environment variable or \
19	openai.api_key prior to initialization.
20	API keys can be found or created at \
21	https://platform.openai.com/account/api-keys
22	"""
23	
24	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/node_parser/text/code.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	                print(
71	                    f"Could not get parser for language {language}. Check "
72	                    "https://github.com/grantjenks/py-tree-sitter-languages#license "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/postprocessor/flag_embedding_reranker.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	                "Cannot import FlagReranker package, please install it: ",
28	                "pip install git+https://github.com/FlagOpen/FlagEmbedding.git",
29	            )
30	        self._model = FlagReranker(
31	            model,

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/program/predefined/evaporate/extractor.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
34	
35	    signal.signal(signal.SIGALRM, signal_handler)
36	    signal.alarm(seconds)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/program/predefined/evaporate/extractor.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
34	
35	    signal.signal(signal.SIGALRM, signal_handler)
36	    signal.alarm(seconds)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/program/predefined/evaporate/extractor.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
230	                with time_limit(1):
231	                    exec(fn_str, globals())
232	                    exec(f"result = get_{function_field}_field(node_text)", globals())

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/program/predefined/evaporate/extractor.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
231	                    exec(fn_str, globals())
232	                    exec(f"result = get_{function_field}_field(node_text)", globals())
233	            except TimeoutException:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/query_engine/cogniswitch_query_engine.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        self.knowledge_request_endpoint = (
23	            "https://api.cogniswitch.ai:8243/cs-api/0.0.1/cs/knowledgeRequest"
24	        )
25	        self.headers = {
26	            "apiKey": self.apiKey,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/query_engine/cogniswitch_query_engine.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
41	        data = {"query": query}
42	        response = requests.post(
43	            self.knowledge_request_endpoint,
44	            headers=self.headers,
45	            verify=False,
46	            data=data,
47	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/awadb.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        """Initialize with parameters."""
24	        import_err_msg = """
25	            `faiss` package not found. For instructions on
26	            how to install `faiss` please visit
27	            https://github.com/facebookresearch/faiss/wiki/Installing-Faiss
28	        """
29	        try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/chatgpt_plugin/base.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
41	        queries = [{"query": query, "top_k": top_k}]
42	        res = requests.post(
43	            f"{self._endpoint_url}/query", headers=headers, json={"queries": queries}
44	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/faiss.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        """Initialize with parameters."""
27	        import_err_msg = """
28	            `faiss` package not found. For instructions on
29	            how to install `faiss` please visit
30	            https://github.com/facebookresearch/faiss/wiki/Installing-Faiss
31	        """
32	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/file/base.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
333	            with open(input_file, errors=errors, encoding=encoding) as f:
334	                data = f.read()
335	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/file/base.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
367	
368	            with multiprocessing.get_context("spawn").Pool(num_workers) as p:
369	                results = p.starmap(

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/file/docs_reader.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
174	        unpacked_data = (
175	            zlib.decompress(data, -15) if self.is_compressed(load_file) else data
176	        )

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/file/docs_reader.py:175
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
174	        unpacked_data = (
175	            zlib.decompress(data, -15) if self.is_compressed(load_file) else data
176	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/file/slides_reader.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	                    with open(image_filename, "wb") as f:
106	                        f.write(image_bytes)
107	                    result += f"\n Image: {self.caption_image(image_filename)}\n\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/file/video_audio_reader.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	            raise ImportError(
30	                "Please install OpenAI whisper model "
31	                "'pip install git+https://github.com/openai/whisper.git' "
32	                "to use the model"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_api_client.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	
158	    DEFAULT_BASE_URL = "https://api.github.com"
159	    DEFAULT_API_VERSION = "2022-11-28"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_api_client.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
257	            try:
258	                response = await _client.request(
259	                    method, url=self._endpoints[endpoint].format(**kwargs)
260	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_api_client.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
285	            (
286	                await self.request(
287	                    "getBranch", "GET", owner=owner, repo=repo, branch=branch
288	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_api_client.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
310	            (
311	                await self.request(
312	                    "getTree", "GET", owner=owner, repo=repo, tree_sha=tree_sha
313	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_api_client.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
335	            (
336	                await self.request(
337	                    "getBlob", "GET", owner=owner, repo=repo, file_sha=file_sha
338	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_api_client.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
360	            (
361	                await self.request(
362	                    "getCommit", "GET", owner=owner, repo=repo, commit_sha=commit_sha
363	                )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_repository_reader.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
278	            try:
279	                decoded_bytes = base64.b64decode(blob_data.content)
280	                del blob_data.content

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_repository_reader.py:279
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
278	            try:
279	                decoded_bytes = base64.b64decode(blob_data.content)
280	                del blob_data.content

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_repository_reader.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
360	            )
361	            tmpfile.write(file_content)
362	            tmpfile.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/github_readers/github_repository_reader.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
360	            )
361	            tmpfile.write(file_content)
362	            tmpfile.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	SCOPES = ["https://www.googleapis.com/auth/documents.readonly"]
11	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
119	            with open("token.json", "w") as token:
120	                token.write(creds.to_json())
121	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	        """
130	        text_run = element.get("textRun")
131	        if not text_run:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	            return ""
133	        return text_run.get("content")
134	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	            if "paragraph" in value:
146	                elements = value.get("paragraph").get("elements")
147	                for elem in elements:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	            if "paragraph" in value:
146	                elements = value.get("paragraph").get("elements")
147	                for elem in elements:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
151	                # and tables may be nested.
152	                table = value.get("table")
153	                for row in table.get("tableRows"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	                table = value.get("table")
153	                for row in table.get("tableRows"):
154	                    cells = row.get("tableCells")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
153	                for row in table.get("tableRows"):
154	                    cells = row.get("tableCells")
155	                    for cell in cells:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
155	                    for cell in cells:
156	                        text += self._read_structural_elements(cell.get("content"))
157	            elif "tableOfContents" in value:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158	                # The text in the TOC is also in a Structural Element.
159	                toc = value.get("tableOfContents")
160	                text += self._read_structural_elements(toc.get("content"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gdocs.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	                toc = value.get("tableOfContents")
160	                text += self._read_structural_elements(toc.get("content"))
161	        return text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gsheets.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	SCOPES = ["https://www.googleapis.com/auth/spreadsheets.readonly"]
11	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/google_readers/gsheets.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142	            with open("token.json", "w") as token:
143	                token.write(creds.to_json())
144	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/make_com/wrapper.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
44	        }
45	        r = requests.post(webhook_url, json=json_dict)
46	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/make_com/wrapper.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    wrapper.pass_response_to_webhook(
56	        "https://hook.us1.make.com/asdfadsfasdfasdfd",
57	        test_response,
58	        "Test query",
59	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/notion.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	INTEGRATION_TOKEN_NAME = "NOTION_INTEGRATION_TOKEN"
13	BLOCK_CHILD_URL_TMPL = "https://api.notion.com/v1/blocks/{block_id}/children"
14	DATABASE_URL_TMPL = "https://api.notion.com/v1/databases/{database_id}/query"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/notion.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	BLOCK_CHILD_URL_TMPL = "https://api.notion.com/v1/blocks/{block_id}/children"
14	DATABASE_URL_TMPL = "https://api.notion.com/v1/databases/{database_id}/query"
15	SEARCH_URL = "https://api.notion.com/v1/search"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/notion.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	DATABASE_URL_TMPL = "https://api.notion.com/v1/databases/{database_id}/query"
15	SEARCH_URL = "https://api.notion.com/v1/search"
16	
17	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/notion.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
66	
67	            res = requests.request(
68	                "GET", block_url, headers=self.headers, json=query_dict
69	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/notion.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
111	        """Get all the pages from a Notion database."""
112	        res = requests.post(
113	            DATABASE_URL_TMPL.format(database_id=database_id),
114	            headers=self.headers,
115	            json=query_dict,
116	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/notion.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
135	                query_dict["start_cursor"] = next_cursor
136	            res = requests.post(SEARCH_URL, headers=self.headers, json=query_dict)
137	            data = res.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/redis/utils.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	    error_message = (
59	        "You must add the RediSearch (>= 2.4) module from Redis Stack. "
60	        "Please refer to Redis Stack docs: https://redis.io/docs/stack/"
61	    )
62	    _logger.error(error_message)
63	    raise ValueError(error_message)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/txtai.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        """Initialize with parameters."""
27	        import_err_msg = """
28	            `txtai` package not found. For instructions on
29	            how to install `txtai` please visit
30	            https://neuml.github.io/txtai/install/
31	        """
32	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/web.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	        for url in urls:
66	            response = requests.get(url, headers=None).text
67	            if self.html_to_text:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/web.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	            try:
217	                page = requests.get(url)
218	            except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/readers/web.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
314	    reader = SimpleWebPageReader()
315	    logger.info(reader.load_data(["http://www.google.com"]))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/response/notebook_utils.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	        if img_node.image_url:
129	            img_response = requests.get(img_node.image_url)
130	            image = Image.open(BytesIO(img_response.content))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/retrievers/you_retriever.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	        headers = {"X-API-Key": self._api_key}
32	        results = requests.get(
33	            f"https://api.ydc-index.io/search?query={query_bundle.query_str}",
34	            headers=headers,
35	        ).json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/retrievers/you_retriever.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	        results = requests.get(
33	            f"https://api.ydc-index.io/search?query={query_bundle.query_str}",
34	            headers=headers,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/schema.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
480	
481	            return BytesIO(base64.b64decode(self.image))
482	        elif self.image_path is not None:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/schema.py:481
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
480	
481	            return BytesIO(base64.b64decode(self.image))
482	        elif self.image_path is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/schema.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
487	
488	            response = requests.get(self.image_url)
489	            return BytesIO(response.content)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/schema.py:706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
705	        with tempfile.NamedTemporaryFile() as f:
706	            f.write(self.text.encode("utf-8"))
707	            f.flush()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/chat_store/simple_chat_store.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
68	        """Persist the docstore to a file."""
69	        fs = fs or fsspec.filesystem("file")
70	        dirpath = os.path.dirname(persist_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/chat_store/simple_chat_store.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
74	        with fs.open(persist_path, "w") as f:
75	            f.write(json.dumps(self.json()))
76	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/chat_store/simple_chat_store.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
83	        """Create a SimpleChatStore from a persist path."""
84	        fs = fs or fsspec.filesystem("file")
85	        if not fs.exists(persist_path):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/index_store/simple_index_store.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
52	        """Create a SimpleIndexStore from a persist path."""
53	        fs = fs or fsspec.filesystem("file")
54	        simple_kvstore = SimpleKVStore.from_persist_path(persist_path, fs=fs)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/kvstore/s3_kvstore.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
112	            return None
113	        body = obj.get()["Body"].read()
114	        return json.loads(body)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/kvstore/s3_kvstore.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	        for obj in self._bucket.objects.filter(Prefix=collection_path):
138	            body = obj.get()["Body"].read()
139	            json_filename = os.path.split(obj.key)[-1]

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/kvstore/simple_kvstore.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
82	        """Persist the store."""
83	        fs = fs or fsspec.filesystem("file")
84	        dirpath = os.path.dirname(persist_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/kvstore/simple_kvstore.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	        with fs.open(persist_path, "w") as f:
89	            f.write(json.dumps(self._data))
90	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/storage/kvstore/simple_kvstore.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
95	        """Load a SimpleKVStore from a persist path and filesystem."""
96	        fs = fs or fsspec.filesystem("file")
97	        logger.debug(f"Loading {__name__} from {persist_path}.")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/tools/tool_spec/notion/base.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	
11	SEARCH_URL = "https://api.notion.com/v1/search"
12	
13	
14	class NotionLoadDataSchema(BaseModel):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/tools/tool_spec/notion/base.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
100	
101	        response = requests.post(SEARCH_URL, json=payload, headers=self.reader.headers)
102	        response_json = response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/tts/bark.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	        """
51	        import_err_msg = "`bark` package not found, \
52	            please run `pip install git+https://github.com/suno-ai/bark.git`"
53	        try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/vector_stores/chatgpt_plugin.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
109	            i_end = min(i + self._batch_size, len(docs_to_upload))
110	            self._s.post(
111	                f"{self._endpoint_url}/upsert",
112	                headers=headers,
113	                json={"documents": docs_to_upload[i:i_end]},
114	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/vector_stores/chatgpt_plugin.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
126	        headers = {"Authorization": f"Bearer {self._bearer_token}"}
127	        self._s.post(
128	            f"{self._endpoint_url}/delete",
129	            headers=headers,
130	            json={"ids": [ref_doc_id]},
131	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/vector_stores/chatgpt_plugin.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
146	        queries = [{"query": query.query_str, "top_k": query.similarity_top_k}]
147	        res = requests.post(
148	            f"{self._endpoint_url}/query", headers=headers, json={"queries": queries}
149	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/vector_stores/faiss.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        """Initialize params."""
55	        import_err_msg = """
56	            `faiss` package not found. For instructions on
57	            how to install `faiss` please visit
58	            https://github.com/facebookresearch/faiss/wiki/Installing-Faiss
59	        """
60	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/vector_stores/milvus.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	        self,
91	        uri: str = "http://localhost:19530",
92	        token: str = "",
93	        collection_name: str = "llamalection",
94	        dim: Optional[int] = None,
95	        embedding_field: str = DEFAULT_EMBEDDING_KEY,
96	        doc_id_field: str = DEFAULT_DOC_ID_KEY,
97	        similarity_metric: str = "IP",
98	        consistency_level: str = "Strong",
99	        overwrite: bool = False,
100	        text_key: Optional[str] = None,
101	        index_config: Optional[dict] = None,
102	        search_config: Optional[dict] = None,
103	        **kwargs: Any,
104	    ) -> None:
105	        """Init params."""

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/vector_stores/simple.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
106	        self._data = data or SimpleVectorStoreData()
107	        self._fs = fs or fsspec.filesystem("file")
108	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/vector_stores/simple.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
303	        """Create a SimpleKVStore from a persist directory."""
304	        fs = fs or fsspec.filesystem("file")
305	        if not fs.exists(persist_path):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_legacy-0.9.48.post4/llama_index_legacy-0.9.48.post4/llama_index/legacy/vector_stores/txtai.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	)
34	IMPORT_ERROR_MSG = """
35	    `txtai` package not found. For instructions on
36	    how to install `txtai` please visit
37	    https://neuml.github.io/txtai/install/
38	"""
39	
40	
41	class TxtaiVectorStore(BasePydanticVectorStore):

--------------------------------------------------

Code scanned:
	Total lines of code: 91726
	Total lines skipped (#nosec): 2

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 103.0
		High: 147.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 236.0
		High: 14.0
Files skipped (0):
