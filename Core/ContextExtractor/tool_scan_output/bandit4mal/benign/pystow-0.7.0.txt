Run started:2025-04-12 12:27:21.196588

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/cli.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
55	    click.secho(f"[pystow] {command}", fg="cyan", bold=True)
56	    os.system(command)  # noqa:S605
57	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/cli.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
55	    click.secho(f"[pystow] {command}", fg="cyan", bold=True)
56	    os.system(command)  # noqa:S605
57	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/config_api.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        return dedent(
41	            f"""\
42	        Could not look up {self.module}/{self.key} and no default given.
43	
44	        This can be solved with one of the following:
45	
46	        1. Set the {self.module.upper()}_{self.key.upper()} environment variable
47	
48	           - Windows, via GUI: https://www.computerhope.com/issues/ch000549.htm
49	           - Windows, via CLI: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/set_1
50	           - Mac OS: https://apple.stackexchange.com/questions/106778/how-do-i-set-environment-variables-on-os-x
51	           - Linux: https://www.freecodecamp.org/news/how-to-set-an-environment-variable-in-linux/
52	
53	        2. Use the PyStow CLI from the command line to
54	           set the configuration like so:
55	
56	           $ pystow set {self.module} {self.key} <value>
57	
58	           This creates an INI file in {path}
59	           with the configuration in the right place.
60	
61	        3. Create/edit an INI file in {path} and manually
62	           fill it in by 1) creating a section inside it called [{self.module}]
63	           and 2) setting a value for {self.key} = <value> that looks like:
64	
65	           # {path}
66	           [{self.module}]
67	           {self.key} = <value>
68	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/config_api.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        return dedent(
41	            f"""\
42	        Could not look up {self.module}/{self.key} and no default given.
43	
44	        This can be solved with one of the following:
45	
46	        1. Set the {self.module.upper()}_{self.key.upper()} environment variable
47	
48	           - Windows, via GUI: https://www.computerhope.com/issues/ch000549.htm
49	           - Windows, via CLI: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/set_1
50	           - Mac OS: https://apple.stackexchange.com/questions/106778/how-do-i-set-environment-variables-on-os-x
51	           - Linux: https://www.freecodecamp.org/news/how-to-set-an-environment-variable-in-linux/
52	
53	        2. Use the PyStow CLI from the command line to
54	           set the configuration like so:
55	
56	           $ pystow set {self.module} {self.key} <value>
57	
58	           This creates an INI file in {path}
59	           with the configuration in the right place.
60	
61	        3. Create/edit an INI file in {path} and manually
62	           fill it in by 1) creating a section inside it called [{self.module}]
63	           and 2) setting a value for {self.key} = <value> that looks like:
64	
65	           # {path}
66	           [{self.module}]
67	           {self.key} = <value>
68	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/config_api.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	    ]
122	    cfp.read(filenames)
123	    return cfp

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/config_api.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
193	    path = get_home().joinpath(fname).with_suffix(".ini")
194	    cfp.read(path)
195	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/config_api.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
204	    with path.open("w") as file:
205	        cfp.write(file)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/constants.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	README_TEXT = dedent(
26	    """\
27	# PyStow Data Directory
28	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
343	        unzipped_path.mkdir(exist_ok=True, parents=True)
344	        with tarfile.open(path) as tar_file:
345	            tar_file.extractall(unzipped_path, **(extract_kwargs or {}))  # noqa:S202

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
457	        open_kwargs.setdefault("mode", mode)
458	        with path.open(**open_kwargs) as file:
459	            yield file

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
539	        open_kwargs.setdefault("mode", mode)
540	        with path.open(**open_kwargs) as file:
541	            yield file

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
591	        open_kwargs.setdefault("mode", mode)
592	        with gzip.open(path, **open_kwargs) as file:
593	            yield file

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
657	        open_kwargs.setdefault("mode", mode)
658	        with lzma.open(path, **open_kwargs) as file:
659	            yield file

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
698	        open_kwargs.setdefault("mode", mode)
699	        with tarfile.open(path, **open_kwargs) as tar_file:
700	            with tar_file.extractfile(inner_path) as file:  # type:ignore

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
741	        with zipfile.ZipFile(file=path) as zip_file:
742	            with zip_file.open(inner_path) as file:
743	                yield file

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
810	        open_kwargs.setdefault("mode", mode)
811	        with gzip.open(path, **open_kwargs) as file:
812	            yield file

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
848	        open_kwargs.setdefault("mode", mode)
849	        with bz2.open(path, **open_kwargs) as file:
850	            yield file

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
903	
904	        with self.open(*subkeys, name=name, mode="r", ensure_exists=False) as file:
905	            return pd.read_csv(file, **_clean_csv_kwargs(read_csv_kwargs))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
963	        """
964	        with self.ensure_open(
965	            *subkeys,
966	            url=url,
967	            name=name,
968	            force=force,
969	            download_kwargs=download_kwargs,
970	            open_kwargs=open_kwargs,
971	        ) as file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1028	        """
1029	        with self.open(
1030	            *subkeys, name=name, mode="r", open_kwargs=open_kwargs, ensure_exists=False
1031	        ) as file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1052
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1051	        """
1052	        with self.open(
1053	            *subkeys, name=name, mode="w", open_kwargs=open_kwargs, ensure_exists=True
1054	        ) as file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1087
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1086	        """
1087	        with self.ensure_open(
1088	            *subkeys,
1089	            url=url,
1090	            name=name,
1091	            force=force,
1092	            download_kwargs=download_kwargs,
1093	            mode=mode,
1094	            open_kwargs=open_kwargs,
1095	        ) as file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1116	        """
1117	        with self.open(
1118	            *subkeys,
1119	            name=name,
1120	            mode=mode,
1121	            open_kwargs=open_kwargs,
1122	            ensure_exists=False,
1123	        ) as file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1145	        """
1146	        with self.open(
1147	            *subkeys,
1148	            name=name,
1149	            mode=mode,
1150	            open_kwargs=open_kwargs,
1151	            ensure_exists=True,
1152	        ) as file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1357	
1358	        with self.open(*subkeys, mode="r", name=name, ensure_exists=False) as file:
1359	            return etree.parse(file, **(parse_kwargs or {}))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1380	        """
1381	        with self.open(
1382	            *subkeys, name=name, mode="wb", open_kwargs=open_kwargs, ensure_exists=True
1383	        ) as file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1383	        ) as file:
1384	            obj.write(file, **(write_kwargs or {}))
1385	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1538	
1539	            with gzip.open(cache_path, "rb") as file:
1540	                return cast(rdflib.Graph, pickle.load(file))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/impl.py:1543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1542	        rv = read_rdf(path=path, **(parse_kwargs or {}))
1543	        with gzip.open(cache_path, "wb") as file:
1544	            pickle.dump(rv, file, protocol=pickle.HIGHEST_PROTOCOL)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	    for key, url in (hexdigests_remote or {}).items():
172	        text = requests.get(url, timeout=15).text
173	        if not hexdigests_strict and "=" in text:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
254	    buffer = memoryview(bytearray(chunk_size))
255	    with path.open("rb", buffering=0) as file:
256	        for this_chunk_size in iter(lambda: file.readinto(buffer), 0):

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
388	                try:
389	                    urlretrieve(url, path, reporthook=t.update_to, **kwargs)  # noqa:S310
390	                except urllib.error.URLError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
396	                # pattern from https://stackoverflow.com/a/39217788/5775947
397	                with requests.get(url, **kwargs) as response, path.open("wb") as file:  # noqa:S113
398	                    logger.info(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
396	                # pattern from https://stackoverflow.com/a/39217788/5775947
397	                with requests.get(url, **kwargs) as response, path.open("wb") as file:  # noqa:S113
398	                    logger.info(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
404	                    # Solution for progress bar from https://stackoverflow.com/a/63831344/5775947
405	                    total_size = int(response.headers.get("Content-Length", 0))
406	                    # Decompress if needed

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
511	    """
512	    original_value = os.environ.get(envvar)
513	    os.environ[envvar] = value

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
566	    sio.seek(0)
567	    bio = BytesIO(sio.read().encode("utf-8"))
568	    return bio

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
597	    """
598	    with gzip.open(path, mode="wb") as file:
599	        pickle.dump(obj, file, **kwargs)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
619	    bytes_io = get_df_io(df, sep=sep, index=index, **kwargs)
620	    with lzma.open(path, "wb") as file:
621	        file.write(bytes_io.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
620	    with lzma.open(path, "wb") as file:
621	        file.write(bytes_io.read())
622	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
620	    with lzma.open(path, "wb") as file:
621	        file.write(bytes_io.read())
622	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
620	    with lzma.open(path, "wb") as file:
621	        file.write(bytes_io.read())
622	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
644	    with zipfile.ZipFile(file=path, mode="w") as zip_file:
645	        with zip_file.open(inner_path, mode="w") as file:
646	            file.write(bytes_io.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
645	        with zip_file.open(inner_path, mode="w") as file:
646	            file.write(bytes_io.read())
647	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
645	        with zip_file.open(inner_path, mode="w") as file:
646	            file.write(bytes_io.read())
647	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
645	        with zip_file.open(inner_path, mode="w") as file:
646	            file.write(bytes_io.read())
647	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
662	    with zipfile.ZipFile(file=path) as zip_file:
663	        with zip_file.open(inner_path) as file:
664	            return pd.read_csv(file, sep=sep, **kwargs)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
683	    with zipfile.ZipFile(file=path, mode="w") as zip_file:
684	        with zip_file.open(inner_path, mode="w") as file:
685	            file.write(etree.tostring(element_tree, **kwargs))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
684	        with zip_file.open(inner_path, mode="w") as file:
685	            file.write(etree.tostring(element_tree, **kwargs))
686	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
684	        with zip_file.open(inner_path, mode="w") as file:
685	            file.write(etree.tostring(element_tree, **kwargs))
686	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
698	    with zipfile.ZipFile(file=path) as zip_file:
699	        with zip_file.open(inner_path) as file:
700	            return etree.parse(file, **kwargs)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
719	    with zipfile.ZipFile(file=path, mode="w") as zip_file:
720	        with zip_file.open(inner_path, mode="w") as file:
721	            file.write(bytes_io.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
720	        with zip_file.open(inner_path, mode="w") as file:
721	            file.write(bytes_io.read())
722	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
720	        with zip_file.open(inner_path, mode="w") as file:
721	            file.write(bytes_io.read())
722	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
720	        with zip_file.open(inner_path, mode="w") as file:
721	            file.write(bytes_io.read())
722	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
734	    with zipfile.ZipFile(file=path) as zip_file:
735	        with zip_file.open(inner_path) as file:
736	            return cast(np.typing.ArrayLike, np.load(file, **kwargs))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
750	    with zipfile.ZipFile(file=path) as zip_file:
751	        with zip_file.open(inner_path) as file:
752	            graph.parse(file, **kwargs)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
794	
795	    with tarfile.open(path) as tar_file:
796	        with tar_file.extractfile(inner_path) as file:  # type: ignore

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
809	
810	    with tarfile.open(path) as tar_file:
811	        with tar_file.extractfile(inner_path) as file:  # type: ignore

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
827	    with (
828	        gzip.open(path, "rb") if isinstance(path, Path) and path.suffix == ".gz" else open(path)
829	    ) as file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
827	    with (
828	        gzip.open(path, "rb") if isinstance(path, Path) and path.suffix == ".gz" else open(path)
829	    ) as file:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
857	    if provider == "git":
858	        output = check_output(["git", "ls-remote", f"https://github.com/{org}/{repo}"])  # noqa
859	        lines = (line.strip().split("\t") for line in output.decode("utf8").splitlines())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
861	    elif provider == "github":
862	        res = requests.get(f"https://api.github.com/repos/{org}/{repo}/branches/master", timeout=15)
863	        res_json = res.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
861	    elif provider == "github":
862	        res = requests.get(f"https://api.github.com/repos/{org}/{repo}/branches/master", timeout=15)
863	        res_json = res.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
870	CHUNK_SIZE = 32768
871	DOWNLOAD_URL = "https://docs.google.com/uc?export=download"
872	TOKEN_KEY = "download_warning"  # noqa:S105

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:908
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
907	        with requests.Session() as sess:
908	            res = sess.get(DOWNLOAD_URL, params={"id": file_id}, stream=True)
909	            token = _get_confirm_token(res)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
909	            token = _get_confirm_token(res)
910	            res = sess.get(DOWNLOAD_URL, params={"id": file_id, "confirm": token}, stream=True)
911	            with path.open("wb") as file:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
910	            res = sess.get(DOWNLOAD_URL, params={"id": file_id, "confirm": token}, stream=True)
911	            with path.open("wb") as file:
912	                for chunk in tqdm(res.iter_content(CHUNK_SIZE), desc="writing", unit="chunk"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
913	                    if chunk:  # filter out keep-alive new chunks
914	                        file.write(chunk)
915	    except (Exception, KeyboardInterrupt):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
913	                    if chunk:  # filter out keep-alive new chunks
914	                        file.write(chunk)
915	    except (Exception, KeyboardInterrupt):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1072	        raise PermissionError(
1073	            "PyStow was not able to create its home directory in due to a lack of "
1074	            "permissions. This can happen, e.g., if you're working on a server where you don't "
1075	            "have full rights. See https://pystow.readthedocs.io/en/latest/installation.html#"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:1081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1080	        return
1081	    with readme_path.open("w", encoding="utf8") as file:
1082	        print(README_TEXT, file=file)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1100	    """
1101	    with gzip.open(source, "rb") as in_file, open(target, "wb") as out_file:
1102	        shutil.copyfileobj(in_file, out_file)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pystow-0.7.0/pystow-0.7.0/src/pystow/utils.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1100	    """
1101	    with gzip.open(source, "rb") as in_file, open(target, "wb") as out_file:
1102	        shutil.copyfileobj(in_file, out_file)

--------------------------------------------------

Code scanned:
	Total lines of code: 4670
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 66.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 73.0
		High: 1.0
Files skipped (0):
