Run started:2025-04-12 15:28:24.549814

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	    """Write to a stream and return the number of bytes written."""
116	    stream.write(data)
117	    return len(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
169	
170	    pos += _write(ostream, mandatory_header)
171	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
172	    if opt_header_len:
173	        pos += _write(ostream, opt_header_crypt)
174	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	        # read the next block from input
180	        ichunk = istream.read(BLOCK_SIZE)
181	        if not ichunk:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
191	            ciphered_chunk = cipher.encrypt(maybe_zchunk)
192	            pos += _write(ostream, ciphered_chunk)
193	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
197	        cipher_chunk = cipher.encrypt(maybe_zchunk)
198	        pos += _write(ostream, cipher_chunk)
199	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
213	        opt_footer_len = len(ciphered_footer)
214	        pos += _write(ostream, ciphered_footer)
215	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
219	
220	    pos += _write(ostream, mandatory_footer)
221	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	    mandatory_header_len = struct.calcsize(MANDATORY_HEADER_FMT)
234	    mandatory_header = istream.read(mandatory_header_len)
235	    pos += mandatory_header_len

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
252	        cipher = ARC4.new(arc4_key)
253	        optional_header_crypt = istream.read(opt_header_len)
254	        pos += opt_header_len

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
283	    while True:
284	        crypt_chunk = istream.read(BLOCK_SIZE)
285	        pos += len(crypt_chunk)

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
290	        try:
291	            maybe_ochunk = bz.decompress(zchunk)
292	        except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
294	        if maybe_ochunk:
295	            ostream.write(maybe_ochunk)
296	            last_chunk = crypt_chunk

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
397	        fin.seek(-1 * mandatory_footer_size, os.SEEK_END)
398	        mandatory_footer_raw = fin.read(mandatory_footer_size)
399	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
410	            fin.seek(opt_footer_pos)
411	            opt_footer_raw = fin.read(opt_footer_len)
412	            cipher = ARC4.new(arc4_key)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
467	    mandatory_header_len = struct.calcsize(MANDATORY_HEADER_FMT)
468	    mandatory_header = await async_reader.read(mandatory_header_len)
469	    pos += mandatory_header_len

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
486	        cipher = ARC4.new(arc4_key)  # nosec B304
487	        optional_header_crypt = await async_reader.read(opt_header_len)
488	        pos += opt_header_len

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
520	        while True:
521	            crypt_chunk = await inner_async_reader.read(BLOCK_SIZE)
522	            if not crypt_chunk:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
526	            try:
527	                maybe_ochunk = bz.decompress(zchunk)
528	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
600	    while True:
601	        ichunk = await async_reader.read(BLOCK_SIZE)
602	        if not ichunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
661	    config = configparser.ConfigParser()
662	    config.read([os.path.expanduser("~/.cart/cart.cfg")])
663	    for section in config.sections():

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
674	            if "rc4_key" in config.options("global"):
675	                rc4_override = base64.b64decode(config.get("global", "rc4_key"))
676	        else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:675
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
674	            if "rc4_key" in config.options("global"):
675	                rc4_override = base64.b64decode(config.get("global", "rc4_key"))
676	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
767	    if options.key:
768	        rc4_override = base64.b64decode(options.key)
769	    if rc4_override:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:768
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
767	    if options.key:
768	        rc4_override = base64.b64decode(options.key)
769	    if rc4_override:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
817	            file_in = open(cur_file, "rb")
818	            first_bytes = file_in.read(struct.calcsize(MANDATORY_HEADER_FMT))
819	            file_in.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
874	                            output_meta_file = open(output_file + ".cartmeta", "wb")
875	                            output_meta_file.write(
876	                                json.dumps(outmeta, sort_keys=True, indent=4).encode(
877	                                    "utf-8"
878	                                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
901	                        cur_metadata.update(
902	                            json.loads(open(meta_file_path, "rb").read())
903	                        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/cart.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
917	                    if os.path.exists(meta_file_path):
918	                        cur_header.update(json.loads(open(meta_file_path, "rb").read()))
919	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/peeker.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
13	        self.buf.seek(0, os.SEEK_END)
14	        self.buf.write(contents)
15	        self.buf.seek(oldpos)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/peeker.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	    def peek(self, size: int) -> bytes:
18	        contents = self.fileobj.read(size)
19	        self._append_to_buf(contents)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/peeker.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	        if size is None:
24	            return self.buf.read() + self.fileobj.read()
25	        contents = self.buf.read(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/peeker.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	        if size is None:
24	            return self.buf.read() + self.fileobj.read()
25	        contents = self.buf.read(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/peeker.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	            return self.buf.read() + self.fileobj.read()
25	        contents = self.buf.read(size)
26	        if len(contents) < size:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cart-1.2.3-py2.py3-none-any/cart/peeker.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	        if len(contents) < size:
27	            contents += self.fileobj.read(size - len(contents))
28	        return contents

--------------------------------------------------

Code scanned:
	Total lines of code: 794
	Total lines skipped (#nosec): 5

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 2.0
Files skipped (0):
