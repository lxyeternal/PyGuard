Run started:2025-04-12 12:28:02.237690

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	        with open(lzma_file, 'rb') as raw:
40	            md5sum_text = hashlib.md5(raw.read()).hexdigest()
41	        if isfile(lzma_md5_file):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	            with open(lzma_md5_file, 'r', encoding='utf-8') as lzma_md5_fp:
43	                md5sum_text_pre = lzma_md5_fp.read().strip()
44	            if md5sum_text == md5sum_text_pre:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	            with open(orig_file, 'wb') as raw:
48	                raw.write(lzma_fp.read())
49	                os.chmod(orig_file, 0o755)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	            with open(orig_file, 'wb') as raw:
48	                raw.write(lzma_fp.read())
49	                os.chmod(orig_file, 0o755)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
48	                raw.write(lzma_fp.read())
49	                os.chmod(orig_file, 0o755)
50	            with open(lzma_md5_file, 'w', encoding='utf-8') as lzma_md5_fp:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:49
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
48	                raw.write(lzma_fp.read())
49	                os.chmod(orig_file, 0o755)
50	            with open(lzma_md5_file, 'w', encoding='utf-8') as lzma_md5_fp:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	            with open(lzma_md5_file, 'w', encoding='utf-8') as lzma_md5_fp:
51	                lzma_md5_fp.write(md5sum_text)
52	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
109	        with open(self.template_file, 'r', encoding='utf-8') as template:
110	            self.template_text = template.read()
111	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:198
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
197	        """
198	        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
199	        try:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
199	        try:
200	            sock.bind(('127.0.0.1', port))
201	            sock.listen()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
268	            if data[1]:
269	                data[1].close()
270	        self.listen_ports.clear()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
282	        with open(config_file, 'w', encoding='utf-8') as config:
283	            config.write(content)
284	        shutil.copy(self.glog_conf_file, glog_conf)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
364	            raise RuntimeError('Server is running')
365	        shutil.rmtree(self.config.base_data_dir, ignore_errors=True)
366	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
379	        start_time = datetime.datetime.now()
380	        health_url = f'http://127.0.0.1:{self.webservice_port}/healthz'
381	        while (datetime.datetime.now() - start_time).total_seconds() < (timeout / 1000) and self.running:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
382	            try:
383	                with urllib.request.urlopen(health_url, timeout=100) as resp:
384	                    content = resp.read().decode('utf-8')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
383	                with urllib.request.urlopen(health_url, timeout=100) as resp:
384	                    content = resp.read().decode('utf-8')
385	                    if 'OK' in content:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
408	        self.webservice_port, sock = self.config.resolve_port(self.webservice_port)
409	        sock.close()
410	        envs.update({

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
463	        for fd in self.proc_fds.values():
464	            fd.close()
465	        self.proc_fds.clear()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
476	    def server_address(self) -> str:
477	        return '127.0.0.1'
478	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
564	
565	    signal.signal(signal.SIGINT, lambda sig, h: server.stop())
566	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/milvus-2.3.9-py3-none-macosx_12_0_arm64/milvus/__init__.py:565
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
564	
565	    signal.signal(signal.SIGINT, lambda sig, h: server.stop())
566	

--------------------------------------------------

Code scanned:
	Total lines of code: 483
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 3.0
Files skipped (0):
