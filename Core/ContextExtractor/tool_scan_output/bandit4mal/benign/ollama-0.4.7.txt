Run started:2025-04-12 15:37:10.121315

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
101	          'Accept': 'application/json',
102	          'User-Agent': f'ollama-python/{__version__} ({platform.machine()} {platform.system().lower()}) Python/{platform.python_version()}',
103	        }.items()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
101	          'Accept': 'application/json',
102	          'User-Agent': f'ollama-python/{__version__} ({platform.machine()} {platform.system().lower()}) Python/{platform.python_version()}',
103	        }.items()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:102
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
101	          'Accept': 'application/json',
102	          'User-Agent': f'ollama-python/{__version__} ({platform.machine()} {platform.system().lower()}) Python/{platform.python_version()}',
103	        }.items()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	
109	CONNECTION_ERROR_MESSAGE = 'Failed to connect to Ollama. Please check that Ollama is downloaded, running and accessible. https://ollama.com/download'
110	
111	
112	class Client(BaseClient):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
117	    try:
118	      r = self._client.request(*args, **kwargs)
119	      r.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
166	          except httpx.HTTPStatusError as e:
167	            e.response.read()
168	            raise ResponseError(e.response.text, e.response.status_code) from None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
241	
242	    return self._request(
243	      GenerateResponse,
244	      'POST',
245	      '/api/generate',
246	      json=GenerateRequest(
247	        model=model,
248	        prompt=prompt,
249	        suffix=suffix,
250	        system=system,
251	        template=template,
252	        context=context,
253	        stream=stream,
254	        raw=raw,
255	        format=format,
256	        images=[image for image in _copy_images(images)] if images else None,
257	        options=options,
258	        keep_alive=keep_alive,
259	      ).model_dump(exclude_none=True),
260	      stream=stream,
261	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
332	    """
333	    return self._request(
334	      ChatResponse,
335	      'POST',
336	      '/api/chat',
337	      json=ChatRequest(
338	        model=model,
339	        messages=[message for message in _copy_messages(messages)],
340	        tools=[tool for tool in _copy_tools(tools)],
341	        stream=stream,
342	        format=format,
343	        options=options,
344	        keep_alive=keep_alive,
345	      ).model_dump(exclude_none=True),
346	      stream=stream,
347	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
356	  ) -> EmbedResponse:
357	    return self._request(
358	      EmbedResponse,
359	      'POST',
360	      '/api/embed',
361	      json=EmbedRequest(
362	        model=model,
363	        input=input,
364	        truncate=truncate,
365	        options=options,
366	        keep_alive=keep_alive,
367	      ).model_dump(exclude_none=True),
368	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
379	    """
380	    return self._request(
381	      EmbeddingsResponse,
382	      'POST',
383	      '/api/embeddings',
384	      json=EmbeddingsRequest(
385	        model=model,
386	        prompt=prompt,
387	        options=options,
388	        keep_alive=keep_alive,
389	      ).model_dump(exclude_none=True),
390	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
421	    """
422	    return self._request(
423	      ProgressResponse,
424	      'POST',
425	      '/api/pull',
426	      json=PullRequest(
427	        model=model,
428	        insecure=insecure,
429	        stream=stream,
430	      ).model_dump(exclude_none=True),
431	      stream=stream,
432	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
463	    """
464	    return self._request(
465	      ProgressResponse,
466	      'POST',
467	      '/api/push',
468	      json=PushRequest(
469	        model=model,
470	        insecure=insecure,
471	        stream=stream,
472	      ).model_dump(exclude_none=True),
473	      stream=stream,
474	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
529	    """
530	    return self._request(
531	      ProgressResponse,
532	      'POST',
533	      '/api/create',
534	      json=CreateRequest(
535	        model=model,
536	        stream=stream,
537	        quantize=quantize,
538	        from_=from_,
539	        files=files,
540	        adapters=adapters,
541	        license=license,
542	        template=template,
543	        system=system,
544	        parameters=parameters,
545	        messages=messages,
546	      ).model_dump(exclude_none=True),
547	      stream=stream,
548	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
553	      while True:
554	        chunk = r.read(32 * 1024)
555	        if not chunk:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
566	  def list(self) -> ListResponse:
567	    return self._request(
568	      ListResponse,
569	      'GET',
570	      '/api/tags',
571	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
598	  def show(self, model: str) -> ShowResponse:
599	    return self._request(
600	      ShowResponse,
601	      'POST',
602	      '/api/show',
603	      json=ShowRequest(
604	        model=model,
605	      ).model_dump(exclude_none=True),
606	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
608	  def ps(self) -> ProcessResponse:
609	    return self._request(
610	      ProcessResponse,
611	      'GET',
612	      '/api/ps',
613	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
621	    try:
622	      r = await self._client.request(*args, **kwargs)
623	      r.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
670	          except httpx.HTTPStatusError as e:
671	            await e.response.aread()
672	            raise ResponseError(e.response.text, e.response.status_code) from None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
744	    """
745	    return await self._request(
746	      GenerateResponse,
747	      'POST',
748	      '/api/generate',
749	      json=GenerateRequest(
750	        model=model,
751	        prompt=prompt,
752	        suffix=suffix,
753	        system=system,
754	        template=template,
755	        context=context,
756	        stream=stream,
757	        raw=raw,
758	        format=format,
759	        images=[image for image in _copy_images(images)] if images else None,
760	        options=options,
761	        keep_alive=keep_alive,
762	      ).model_dump(exclude_none=True),
763	      stream=stream,
764	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
836	
837	    return await self._request(
838	      ChatResponse,
839	      'POST',
840	      '/api/chat',
841	      json=ChatRequest(
842	        model=model,
843	        messages=[message for message in _copy_messages(messages)],
844	        tools=[tool for tool in _copy_tools(tools)],
845	        stream=stream,
846	        format=format,
847	        options=options,
848	        keep_alive=keep_alive,
849	      ).model_dump(exclude_none=True),
850	      stream=stream,
851	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:861
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
860	  ) -> EmbedResponse:
861	    return await self._request(
862	      EmbedResponse,
863	      'POST',
864	      '/api/embed',
865	      json=EmbedRequest(
866	        model=model,
867	        input=input,
868	        truncate=truncate,
869	        options=options,
870	        keep_alive=keep_alive,
871	      ).model_dump(exclude_none=True),
872	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
883	    """
884	    return await self._request(
885	      EmbeddingsResponse,
886	      'POST',
887	      '/api/embeddings',
888	      json=EmbeddingsRequest(
889	        model=model,
890	        prompt=prompt,
891	        options=options,
892	        keep_alive=keep_alive,
893	      ).model_dump(exclude_none=True),
894	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
925	    """
926	    return await self._request(
927	      ProgressResponse,
928	      'POST',
929	      '/api/pull',
930	      json=PullRequest(
931	        model=model,
932	        insecure=insecure,
933	        stream=stream,
934	      ).model_dump(exclude_none=True),
935	      stream=stream,
936	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
967	    """
968	    return await self._request(
969	      ProgressResponse,
970	      'POST',
971	      '/api/push',
972	      json=PushRequest(
973	        model=model,
974	        insecure=insecure,
975	        stream=stream,
976	      ).model_dump(exclude_none=True),
977	      stream=stream,
978	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:1035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1034	
1035	    return await self._request(
1036	      ProgressResponse,
1037	      'POST',
1038	      '/api/create',
1039	      json=CreateRequest(
1040	        model=model,
1041	        stream=stream,
1042	        quantize=quantize,
1043	        from_=from_,
1044	        files=files,
1045	        adapters=adapters,
1046	        license=license,
1047	        template=template,
1048	        system=system,
1049	        parameters=parameters,
1050	        messages=messages,
1051	      ).model_dump(exclude_none=True),
1052	      stream=stream,
1053	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:1059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1058	      while True:
1059	        chunk = r.read(32 * 1024)
1060	        if not chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:1069
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1068	        while True:
1069	          chunk = r.read(32 * 1024)
1070	          if not chunk:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:1079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1078	  async def list(self) -> ListResponse:
1079	    return await self._request(
1080	      ListResponse,
1081	      'GET',
1082	      '/api/tags',
1083	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1110	  async def show(self, model: str) -> ShowResponse:
1111	    return await self._request(
1112	      ShowResponse,
1113	      'POST',
1114	      '/api/show',
1115	      json=ShowRequest(
1116	        model=model,
1117	      ).model_dump(exclude_none=True),
1118	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:1121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1120	  async def ps(self) -> ProcessResponse:
1121	    return await self._request(
1122	      ProcessResponse,
1123	      'GET',
1124	      '/api/ps',
1125	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_client.py:1229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1228	  split = urllib.parse.urlsplit('://'.join([scheme, hostport]))
1229	  host = split.hostname or '127.0.0.1'
1230	  port = split.port or port

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_types.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
165	    if isinstance(self.value, (Path, bytes)):
166	      return b64encode(self.value.read_bytes() if isinstance(self.value, Path) else self.value).decode()
167	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_types.py:166
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
165	    if isinstance(self.value, (Path, bytes)):
166	      return b64encode(self.value.read_bytes() if isinstance(self.value, Path) else self.value).decode()
167	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_types.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
170	        if Path(self.value).exists():
171	          return b64encode(Path(self.value).read_bytes()).decode()
172	      except Exception:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_types.py:171
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
170	        if Path(self.value).exists():
171	          return b64encode(Path(self.value).read_bytes()).decode()
172	      except Exception:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_types.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
181	        # Try to decode to check if it's already base64
182	        b64decode(self.value)
183	        return self.value

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ollama-0.4.7/ollama-0.4.7/ollama/_types.py:182
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
181	        # Try to decode to check if it's already base64
182	        b64decode(self.value)
183	        return self.value

--------------------------------------------------

Code scanned:
	Total lines of code: 1613
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 32.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 4.0
Files skipped (0):
