Run started:2025-04-12 18:38:04.425840

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/__main__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	            ui.display_warning(
150	                f"A new version of ggshield (v{latest_version}) has been released "
151	                f"(https://github.com/GitGuardian/ggshield)."

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/auth/login.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	    """
147	    config = ContextObj.get(ctx).config
148	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/auth/login.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	    try:
198	        response = client.get(endpoint="token")
199	    except requests.exceptions.ConnectionError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/auth/logout.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	    """
54	    config = ContextObj.get(ctx).config
55	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/auth/logout.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
101	    try:
102	        response = client.post(endpoint="token/revoke")
103	    except ConnectionError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/hmsl/hmsl_utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	    ui.display_info("Querying HasMySecretLeaked...")
25	    ctx_obj = ContextObj.get(ctx)
26	    client = get_client(ctx_obj.config, hmsl_command_path=ctx.command_path)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/hmsl/query.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	    # Get our client
43	    config = ContextObj.get(ctx).config
44	    client = get_client(config, ctx.command_path)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/honeytoken/create.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        raise UnexpectedError(
89	            """ggshield does not have permissions to create honeytokens on your workspace. Make sure that:
90	
91	- the honeytoken module is enabled for your GitGuardian workspace,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/honeytoken/create_with_context.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	        raise UnexpectedError(
126	            """ggshield does not have permissions to create honeytokens on your workspace. Make sure that:
127	
128	- the honeytoken module is enabled for your GitGuardian workspace,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/install.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	        if not append:
142	            f.write("#!/bin/sh\n")
143	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/install.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
144	        if local_hook_support:
145	            f.write(LOCAL_HOOK_SNIPPET.format(hook_type=hook_type))
146	            f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/install.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
145	            f.write(LOCAL_HOOK_SNIPPET.format(hook_type=hook_type))
146	            f.write("\n")
147	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/install.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	
148	        f.write(f'ggshield secret scan {hook_type} "$@"\n')
149	        os.chmod(hook_path, 0o700)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/install.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
148	        f.write(f'ggshield secret scan {hook_type} "$@"\n')
149	        os.chmod(hook_path, 0o700)
150	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/install.py:149
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
148	        f.write(f'ggshield secret scan {hook_type} "$@"\n')
149	        os.chmod(hook_path, 0o700)
150	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/cmd/secret/scan/prereceive.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
121	
122	    process = multiprocessing.Process(
123	        target=_execute_prereceive,
124	        kwargs={
125	            "config": config,
126	            "output_handler": output_handler,
127	            "commit_list": commit_list,
128	            "command_path": ctx.command_path,
129	            "client": ctx_obj.client,
130	            "exclusion_regexes": ctx_obj.exclusion_regexes,
131	        },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/check_updates.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	    try:
69	        resp = requests.get(
70	            "https://api.github.com/repos/GitGuardian/GGShield/releases/latest",
71	            headers={
72	                "Accept": "application/vnd.github+json",
73	                "User-Agent": f"GGShield {__version__}",
74	                "X-Github-Api-Version": "2022-11-28",
75	            },
76	            timeout=CHECK_TIMEOUT,
77	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/check_updates.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	        resp = requests.get(
70	            "https://api.github.com/repos/GitGuardian/GGShield/releases/latest",
71	            headers={
72	                "Accept": "application/vnd.github+json",
73	                "User-Agent": f"GGShield {__version__}",
74	                "X-Github-Api-Version": "2022-11-28",
75	            },
76	            timeout=CHECK_TIMEOUT,
77	        )
78	    except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/check_updates.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	        # https://docs.github.com/en/rest/overview/resources-in-the-rest-api?apiVersion=2022-11-28#rate-limiting
85	        if int(resp.headers.get("X-RateLimit-Remaining", -1)) == 0:
86	            logger.warning("GitHub rate limit exceeded - rescheduling update check")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/check_updates.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	            # Reset the next update check based on when the GH API quota resets
89	            check_at = int(resp.headers.get("X-RateLimit-Reset", -1)) - 24 * 60 * 60
90	            if check_at < 0:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/client.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	                e.instance,
35	                """A GitGuardian API key is needed to use ggshield.
36	To get one, authenticate to your dashboard by running:
37	
38	    ggshield auth login

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/constants.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	USER_CONFIG_FILENAMES = [".gitguardian", ".gitguardian.yml", DEFAULT_CONFIG_FILENAME]
20	DEFAULT_INSTANCE_URL = "https://dashboard.gitguardian.com"
21	DEFAULT_HMSL_URL = "https://api.hasmysecretleaked.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/constants.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	DEFAULT_INSTANCE_URL = "https://dashboard.gitguardian.com"
21	DEFAULT_HMSL_URL = "https://api.hasmysecretleaked.com"
22	AUTH_CONFIG_FILENAME = "auth_config.yaml"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/errors.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
188	    ui.display_error(str(exc))
189	    if isinstance(exc, UnicodeEncodeError) and platform.system() == "Windows":
190	        ui.display_info(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/errors.py:189
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
188	    ui.display_error(str(exc))
189	    if isinstance(exc, UnicodeEncodeError) and platform.system() == "Windows":
190	        ui.display_info(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/git_hooks/prepush.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	    """
62	    prepush_input = sys.stdin.read().strip()
63	    logger.debug("input=%s", prepush_input)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/git_hooks/prereceive.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	    """
66	    prereceive_input = sys.stdin.read().strip()
67	    if not prereceive_input:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/tar_utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
41	
42	    with tarfile.open(fileobj=tar_stream, mode="w:gz") as tar:
43	        for path in filepaths:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/tar_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
63	    bytes = BytesIO()
64	    file = tarfile.open(fileobj=bytes, mode="w:gz")
65	    file.close()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/core/url_utils.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
33	        parsed_url.netloc.startswith("localhost")
34	        or parsed_url.netloc.startswith("127.0.0.1")
35	    ):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/utils/archive.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
123	
124	    with tarfile.open(archive) as tf:
125	        for info in tf:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/utils/archive.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
144	        return None
145	    target = zip.open(info).read().decode()
146	    return Path(target)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/utils/git_shell.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
211	                    ["-c", "core.longpaths=true"]
212	                    if platform.system() == "Windows"
213	                    else []

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/utils/git_shell.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
211	                    ["-c", "core.longpaths=true"]
212	                    if platform.system() == "Windows"
213	                    else []

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/utils/git_shell.py:212
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
211	                    ["-c", "core.longpaths=true"]
212	                    if platform.system() == "Windows"
213	                    else []

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/utils/os.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
23	    else:
24	        return platform.system().lower(), platform.version()
25	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/utils/os.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
23	    else:
24	        return platform.system().lower(), platform.version()
25	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/utils/os.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
23	    else:
24	        return platform.system().lower(), platform.version()
25	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/auth/oauth.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
133	        self.code_challenge = (
134	            urlsafe_b64encode(sha256(self.code_verifier.encode()).digest())
135	            .decode()

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/auth/oauth.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
167	            try:
168	                self.server = HTTPServer(
169	                    # only consider requests from localhost on the predetermined port
170	                    ("127.0.0.1", port),
171	                    functools.partial(RequestHandler, self),
172	                )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/auth/oauth.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
169	                    # only consider requests from localhost on the predetermined port
170	                    ("127.0.0.1", port),
171	                    functools.partial(RequestHandler, self),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/auth/oauth.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
191	                # the `process_callback` function
192	                self.server.handle_request()  # type: ignore
193	        except KeyboardInterrupt:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/auth/oauth.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
298	    def redirect_uri(self) -> str:
299	        return f"http://localhost:{self._port}"
300	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/auth/oauth.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
449	        content = f"<html><body><h1>Error</h1>{message}</body></html>"
450	        self.wfile.write(content.encode())
451	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
36	        key = bytes.fromhex(hash)
37	        payload = base64.b64decode(self.payload)
38	        decrypted = json.loads(decrypt(payload, key))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
36	        key = bytes.fromhex(hash)
37	        payload = base64.b64decode(self.payload)
38	        decrypted = json.loads(decrypt(payload, key))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/client.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	        decrypted = json.loads(decrypt(payload, key))
39	        if decrypted.get("l"):
40	            url = decrypted.get("l", {}).get("u")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/client.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        if decrypted.get("l"):
40	            url = decrypted.get("l", {}).get("u")
41	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/client.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        if decrypted.get("l"):
40	            url = decrypted.get("l", {}).get("u")
41	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/client.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	        try:
100	            response = self.session.get(f"{self.url}/healthz")
101	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/client.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
171	            headers = {}
172	        response = self.session.post(
173	            self.url + endpoint,
174	            json=body,
175	            headers=headers,
176	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/output.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	            {
65	                "name": names.get(secret.hash) or secret.hash,
66	                "hash": secret.hash,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/output.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	            template = TEMPLATE
79	            if secret.get("url"):
80	                template = template.rstrip() + URL_DISPLAY_TEMPLATE

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/output.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        error_message = "These are partial results: Quota exceeded"
95	        if error.response.headers.get("RateLimit-Query") is not None:
96	            error_message += (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/output.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	            error_message += (
97	                f" required {error.response.headers.get('RateLimit-Query')} credits."
98	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/secret_manager/hashicorp_vault/api_client.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
43	        """
44	        api_res = self.session.request(
45	            method, f"{self.vault_url}/{api_version}/{endpoint}"
46	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/secret_manager/hashicorp_vault/api_client.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
59	        try:
60	            api_res = self._make_request("sys/mounts")["data"]
61	        except requests.HTTPError:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/secret_manager/hashicorp_vault/api_client.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
61	        except requests.HTTPError:
62	            api_res = self._make_request("sys/internal/ui/mounts")["data"]["secret"]
63	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/secret_manager/hashicorp_vault/api_client.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
82	        try:
83	            api_res = self._make_request(api_endpoint, method="LIST")
84	        except requests.HTTPError as exc:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/hmsl/secret_manager/hashicorp_vault/api_client.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
112	        try:
113	            api_res = self._make_request(api_endpoint)
114	        except requests.HTTPError as exc:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/secret/docker.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
155	        """ContextManager to create a DockerImage instance."""
156	        with tarfile.open(archive_path) as tar_file:
157	            yield DockerImage(archive_path, tar_file)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/secret/docker.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
357	
358	    with DockerImage.open(archive_path) as docker_image:
359	        ui.display_heading("Scanning Docker config")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/secret/output/secret_sarif_output_handler.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	SCHEMA_URL = "https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/schemas/sarif-schema-2.1.0.json"
16	
17	
18	class SecretSARIFOutputHandler(SecretOutputHandler):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/secret/output/secret_sarif_output_handler.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	                            "name": "ggshield",
35	                            "informationUri": "https://github.com/GitGuardian/ggshield",
36	                            "version": ggshield_version,
37	                        },
38	                        "extensions": [
39	                            {
40	                                "name": "secret",
41	                                "version": VERSIONS.secrets_engine_version,

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/secret/repo.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
205	
206	        with ThreadPoolExecutor(max_workers=MAX_WORKERS) as executor:
207	            futures = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/ggshield/verticals/secret/secret_scanner.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
88	
89	        with concurrent.futures.ThreadPoolExecutor(
90	            max_workers=scan_threads, thread_name_prefix="content_scan"
91	        ) as executor:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/conftest.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
30	def is_windows():
31	    return platform.system() == "Windows"
32	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/conftest.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
30	def is_windows():
31	    return platform.system() == "Windows"
32	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/conftest.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
30	def is_windows():
31	    return platform.system() == "Windows"
32	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/conftest.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	
52	        response = requests.get(url, headers=headers)
53	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/conftest.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	
64	        self.wfile.write(response.content)
65	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/conftest.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	            time.sleep(60)
80	            self.wfile.write(content)
81	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/conftest.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
91	        self.end_headers()
92	        self.wfile.write(content)
93	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/conftest.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
112	    host, port = "localhost", 8123
113	    server_process = Process(target=_start_slow_gitguardian_api, args=(host, port))
114	    server_process.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/conftest.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
125	    host, port = "localhost", 8124
126	    server_process = Process(target=_start_no_quota_gitguardian_api, args=(host, port))
127	    server_process.start()

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/conftest.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
148	    hook_path.write_text(hook_content)
149	    hook_path.chmod(0o700)
150	    return local_repo

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_archive.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
12	
13	    with tarfile.open(archive_path, "w:gz") as tar:
14	        for path in CURRENT_DIR.rglob("*"):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docker.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
24	def clear_layer_cache():
25	    shutil.rmtree(get_cache_dir() / "docker", ignore_errors=True)
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    test_file.write_text(
10	        '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/2", "documents": ['
11	        + '{"id": "https://github.com/foo/bar/issues/2", "content": "issue", "authors": [{"id": "ghost"}]}]}\n'
12	        + '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/1", "documents": ['

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/2", "documents": ['
11	        + '{"id": "https://github.com/foo/bar/issues/2", "content": "issue", "authors": [{"id": "ghost"}]}]}\n'
12	        + '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/1", "documents": ['
13	        + '{"id": "https://github.com/foo/bar/issues/1", "content": "Token in comment", "authors": [{"id": "ghost"}]},'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        + '{"id": "https://github.com/foo/bar/issues/2", "content": "issue", "authors": [{"id": "ghost"}]}]}\n'
12	        + '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/1", "documents": ['
13	        + '{"id": "https://github.com/foo/bar/issues/1", "content": "Token in comment", "authors": [{"id": "ghost"}]},'
14	        + '{"id": "https://github.com/foo/bar/issues/1#issuecomment-42",'
15	        + f'"content": "apikey = {GG_VALID_TOKEN}",'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	        + '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/1", "documents": ['
13	        + '{"id": "https://github.com/foo/bar/issues/1", "content": "Token in comment", "authors": [{"id": "ghost"}]},'
14	        + '{"id": "https://github.com/foo/bar/issues/1#issuecomment-42",'
15	        + f'"content": "apikey = {GG_VALID_TOKEN}",'
16	        + ' "authors": [{"id": "ghost2"}]}'
17	        + "]}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        + '{"id": "https://github.com/foo/bar/issues/1", "content": "Token in comment", "authors": [{"id": "ghost"}]},'
14	        + '{"id": "https://github.com/foo/bar/issues/1#issuecomment-42",'
15	        + f'"content": "apikey = {GG_VALID_TOKEN}",'
16	        + ' "authors": [{"id": "ghost2"}]}'
17	        + "]}"
18	    )
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    assert (
23	        "https://github.com/foo/bar/issues/1#issuecomment-42: 1 secret detected"
24	        in result.stdout
25	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    test_file.write_text(
31	        '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/2", "documents": ['
32	        + '{"id": "https://github.com/foo/bar/issues/2", "content": "issue", "authors": [{"id": "ghost"}]}]}\n'
33	        + '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/1", "documents": ['

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/2", "documents": ['
32	        + '{"id": "https://github.com/foo/bar/issues/2", "content": "issue", "authors": [{"id": "ghost"}]}]}\n'
33	        + '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/1", "documents": ['
34	        + '{"id": "https://github.com/foo/bar/issues/1", "content": "No token", "authors": [{"id": "ghost"}]},'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	        + '{"id": "https://github.com/foo/bar/issues/2", "content": "issue", "authors": [{"id": "ghost"}]}]}\n'
33	        + '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/1", "documents": ['
34	        + '{"id": "https://github.com/foo/bar/issues/1", "content": "No token", "authors": [{"id": "ghost"}]},'
35	        + '{"id": "https://github.com/foo/bar/issues/1#issuecomment-42",'
36	        + '"content": "Nothing to see, move along",'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	        + '{"type": "github_issue", "id": "https://github.com/foo/bar/issues/1", "documents": ['
34	        + '{"id": "https://github.com/foo/bar/issues/1", "content": "No token", "authors": [{"id": "ghost"}]},'
35	        + '{"id": "https://github.com/foo/bar/issues/1#issuecomment-42",'
36	        + '"content": "Nothing to see, move along",'
37	        + ' "authors": [{"id": "ghost2"}]}'
38	        + "]}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_docset.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	        + '{"id": "https://github.com/foo/bar/issues/1", "content": "No token", "authors": [{"id": "ghost"}]},'
35	        + '{"id": "https://github.com/foo/bar/issues/1#issuecomment-42",'
36	        + '"content": "Nothing to see, move along",'
37	        + ' "authors": [{"id": "ghost2"}]}'
38	        + "]}"
39	    )
40	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_prereceive.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
27	    hook_path.write_text(HOOK_CONTENT)
28	    hook_path.chmod(0o755)
29	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_prereceive.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
61	    hook_path.write_text(HOOK_CONTENT)
62	    hook_path.chmod(0o755)
63	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_prereceive.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
91	    hook_path.write_text(HOOK_CONTENT)
92	    hook_path.chmod(0o755)
93	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/secret/test_scan_prereceive.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
117	    hook_path.write_text(HOOK_CONTENT)
118	    hook_path.chmod(0o755)
119	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/test_docker_image.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	            "clone",
86	            "https://github.com/gitguardian/ggshield",
87	            "--depth",
88	            3,
89	            work_dir,
90	        )
91	
92	        # Run the scan
93	        docker_exec(
94	            "-e",
95	            "GITGUARDIAN_API_KEY",
96	            "-w",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/utils_create_merge_repo.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
185	        with open(hook_path, "r") as f:
186	            hook = f.read()
187	        hook = hook.replace(r"pre-commit", r"pre-commit --scan-all-merge-files")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/functional/utils_create_merge_repo.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
188	        with open(hook_path, "w") as f:
189	            f.write(hook)
190	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	        token = "mysupertoken"
87	        instance = "https://dashboard.gitguardian.com"
88	        cmd = ["auth", "login", "--method=token", f"--instance={instance}"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	        [
152	            ("https://api.gitguardian.com/v1", "https://dashboard.gitguardian.com"),
153	            ("https://api.gitguardian.com", "https://dashboard.gitguardian.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	        [
152	            ("https://api.gitguardian.com/v1", "https://dashboard.gitguardian.com"),
153	            ("https://api.gitguardian.com", "https://dashboard.gitguardian.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	            ("https://api.gitguardian.com/v1", "https://dashboard.gitguardian.com"),
153	            ("https://api.gitguardian.com", "https://dashboard.gitguardian.com"),
154	            (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	            ("https://api.gitguardian.com/v1", "https://dashboard.gitguardian.com"),
153	            ("https://api.gitguardian.com", "https://dashboard.gitguardian.com"),
154	            (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	            (
155	                "https://api.eu1.gitguardian.com/v1",
156	                "https://dashboard.eu1.gitguardian.com",
157	            ),
158	            (
159	                "https://gitguardian.mycorp.local/exposed/",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	                "https://api.eu1.gitguardian.com/v1",
156	                "https://dashboard.eu1.gitguardian.com",
157	            ),
158	            (
159	                "https://gitguardian.mycorp.local/exposed/",
160	                "https://gitguardian.mycorp.local",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	            (
159	                "https://gitguardian.mycorp.local/exposed/",
160	                "https://gitguardian.mycorp.local",
161	            ),
162	            (
163	                "https://gitguardian.mycorp.local/exposed",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	                "https://gitguardian.mycorp.local/exposed/",
160	                "https://gitguardian.mycorp.local",
161	            ),
162	            (
163	                "https://gitguardian.mycorp.local/exposed",
164	                "https://gitguardian.mycorp.local",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	            (
163	                "https://gitguardian.mycorp.local/exposed",
164	                "https://gitguardian.mycorp.local",
165	            ),
166	        ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
163	                "https://gitguardian.mycorp.local/exposed",
164	                "https://gitguardian.mycorp.local",
165	            ),
166	        ],
167	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	            ("", False),
192	            ("https://custom.example.com", True),
193	            (DEFAULT_INSTANCE_URL, False),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	
232	        instance = "https://dashboard.gitguardian.com"
233	        cmd = ["auth", "login", "--method=token", f"--instance={instance}"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
250	        second_instance_token = "mythirdsupertoken"
251	        second_instance = "https://dashboard.other.gitguardian.com"
252	        cmd = ["auth", "login", "--method=token", f"--instance={second_instance}"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	    @pytest.mark.parametrize(
349	        "instance_url", [DEFAULT_INSTANCE_URL, "https://some_instance.com"]
350	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
366	    @pytest.mark.parametrize(
367	        "instance_url", [DEFAULT_INSTANCE_URL, "https://some_instance.com"]
368	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
571	            # add a dummy unrelated config
572	            add_instance_config(instance_url="http://some-gg-instance.com")
573	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
670	
671	        callback_url = "http://localhost:1234/?" + urlparse.urlencode(url_params)
672	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
832	        assert redirect_uri.startswith(
833	            f"http://localhost:{expected_port}"
834	        ), redirect_uri

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
896	                "web",
897	                "https://dashboard.gitguardian.com",
898	                "https://onprem.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
899	                "Error: instance and SSO URL params do not match\n",
900	            ],
901	            [
902	                "web",
903	                "https://dashboard.gitguardian.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:898
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
897	                "https://dashboard.gitguardian.com",
898	                "https://onprem.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
899	                "Error: instance and SSO URL params do not match\n",
900	            ],
901	            [
902	                "web",
903	                "https://dashboard.gitguardian.com",
904	                "https://dashboard.gitguardian.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
902	                "web",
903	                "https://dashboard.gitguardian.com",
904	                "https://dashboard.gitguardian.com",
905	                "Error: Invalid value for sso-url: Please provide a valid SSO URL.\n",
906	            ],
907	            [
908	                "token",
909	                "https://dashboard.gitguardian.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
903	                "https://dashboard.gitguardian.com",
904	                "https://dashboard.gitguardian.com",
905	                "Error: Invalid value for sso-url: Please provide a valid SSO URL.\n",
906	            ],
907	            [
908	                "token",
909	                "https://dashboard.gitguardian.com",
910	                "https://dashboard.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
908	                "token",
909	                "https://dashboard.gitguardian.com",
910	                "https://dashboard.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
911	                "Error: Invalid value for sso-url: --sso-url is reserved for the web login method.\n",
912	            ],
913	        ],
914	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
909	                "https://dashboard.gitguardian.com",
910	                "https://dashboard.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
911	                "Error: Invalid value for sso-url: --sso-url is reserved for the web login method.\n",
912	            ],
913	        ],
914	    )
915	    def test_bad_sso_url(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
934	            [
935	                "https://dashboard.gitguardian.com",
936	                "https://dashboard.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
937	                "dashboard.gitguardian.com",
938	            ],
939	            [
940	                "https://some-gg-instance.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:936
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
935	                "https://dashboard.gitguardian.com",
936	                "https://dashboard.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
937	                "dashboard.gitguardian.com",
938	            ],
939	            [
940	                "https://some-gg-instance.com",
941	                "https://some-gg-instance.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
939	            [
940	                "https://some-gg-instance.com",
941	                "https://some-gg-instance.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
942	                "some-gg-instance.com",
943	            ],
944	            [
945	                None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:941
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
940	                "https://some-gg-instance.com",
941	                "https://some-gg-instance.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
942	                "some-gg-instance.com",
943	            ],
944	            [
945	                None,
946	                "https://custom.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
945	                None,
946	                "https://custom.gitguardian.com/auth/sso/1e0f7890-2293-4b2d-8aa8-f6f0e8e92274",
947	                "custom.gitguardian.com",
948	            ],
949	            [
950	                None,
951	                None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
975	        [
976	            "https://dashboard.gitguardian.com/abc",
977	        ],
978	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:995
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
994	        [
995	            "https://api.gitguardian.com/v1",
996	            "https://api.eu1.gitguardian.com/v1",
997	            "https://gitguardian.mycorp.local/exposed/",
998	        ],
999	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
995	            "https://api.gitguardian.com/v1",
996	            "https://api.eu1.gitguardian.com/v1",
997	            "https://gitguardian.mycorp.local/exposed/",
998	        ],
999	    )
1000	    def test_api_instance_url(self, instance_url, cli_fs_runner, monkeypatch):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_login.py:997
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
996	            "https://api.eu1.gitguardian.com/v1",
997	            "https://gitguardian.mycorp.local/exposed/",
998	        ],
999	    )
1000	    def test_api_instance_url(self, instance_url, cli_fs_runner, monkeypatch):
1001	        """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_logout.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        """
22	        instance_url = "https://dashboard.gitguardian.com"
23	        add_instance_config(with_account=False)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_logout.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	        """
44	        unrelated_url = "https://some-unrelated-gg-instance.com"
45	
46	        post_mock = Mock(return_value=Mock(status_code=204, ok=True))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_logout.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	        assert exit_code == ExitCode.SUCCESS, output
69	        instance_url = instance_url or "https://dashboard.gitguardian.com"
70	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_logout.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    @pytest.mark.parametrize(
34	        "instance_url", (DEFAULT_INSTANCE_URL, "https://some-gg-instance.com")
35	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_logout.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	            DEFAULT_INSTANCE_URL,
149	            "https://some-gg-instance.com",
150	            "https://some-other-gg-instance.com",
151	        ]:
152	            add_instance_config(instance_url)
153	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/auth/test_logout.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	            "https://some-gg-instance.com",
150	            "https://some-other-gg-instance.com",
151	        ]:
152	            add_instance_config(instance_url)
153	
154	        exit_code, output = self.run_cmd(cli_fs_runner, all_tokens=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/hmsl/check_secret_manager/test_hashicorp_vault.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	        "--url",
122	        "http://127.0.0.1:6789",
123	        "secret",
124	    ]
125	    if recursive:
126	        args.append("--recursive")
127	    if use_cli_token:
128	        args.append("--use-cli-token")
129	    if verbose:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/hmsl/check_secret_manager/test_hashicorp_vault.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	    vault_api_client_cls_mock.assert_called_once_with(
158	        "http://127.0.0.1:6789", "vault_token"
159	    )
160	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/hmsl/test_decrypt.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	RESULTS_CLEARTEXT_CONTENT = (
40	    '{"hash": "743d9fde380b7064cc6a8d3071184fc47905cf7440e5615cd46c7b6cbfb46d47", '
41	    '"count": 14, "url": "https://github.com/edly-io/devstack/commit/ccfc9c2d63c29'
42	    '17be60a9fd2a4c36ff3a8b9bb8c#diff-e45e45baeda1c1e73482975a664062aa56f20c03dd9d64a827aba57775bed0d3L158"}'
43	)
44	
45	
46	@pytest.fixture
47	def mapping_path(cli_fs_runner, tmp_path: Path):
48	    """Prepare a mapping file"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/honeytoken/test_honeytoken.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	                "created_at": "2023-05-15T14:09:09.210845Z",
77	                "gitguardian_url": "https://dashboard.gitguardian.com/workspace/1/honeytokens/858a3a76-f6f2-4c2e-b0bc-123456789012",  # noqa: E501
78	                "revoked_at": None,
79	                "triggered_at": None,
80	                "open_events_count": 0,
81	                "creator_id": 265476,
82	                "creator_api_token_id": "8219e02d-f44c-4802-8418-210987654321",
83	                "revoker_id": None,
84	                "revoker_api_token_id": None,
85	                "token": {
86	                    "access_token_id": "ABCQFRJEIGOERJ5TRMP",
87	                    "secret_key": "9ImlMcdJrfjkriegj3454566C0YgLEgregerZEaa",  # ggignore
88	                },
89	                "tags": [],
90	                "name": name,
91	                "description": description,
92	            },
93	            201,
94	        ),
95	        json_checker=payload_checker,
96	    )
97	
98	    result = cli_fs_runner.invoke(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_ci.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	        (
117	            {"CI": "true", "JENKINS_URL": "https://ci.example.com"},
118	            "ci/JENKINS HOME",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	            assert re.search(
72	                """>> Secret detected: GitGuardian Development Secret
73	   Validity: No Checker
74	   Occurrences: 1
75	   Known by GitGuardian dashboard: (YES|NO)
76	   Incident URL: (https://.*|N/A)
77	   Secret SHA: 4f307a4cae8f14cc276398c666559a6d4f959640616ed733b168a9ee7ab08fd4
78	""",
79	                result.output,
80	            )
81	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        assert re.search(
93	            """>> Secret detected: GitGuardian Test Token Checked
94	   Validity: Valid
95	   Occurrences: 1
96	   Known by GitGuardian dashboard: (YES|NO)
97	   Incident URL: (https://.*|N/A)
98	   Secret SHA: 56c126cef75e3d17c3de32dac60bab688ecc384a054c2c85b688c1dd7ac4eefd
99	""",
100	            result.output,
101	        )
102	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	
229	        uri = "https://dashboard.my-instance.com"
230	
231	        with patch("ggshield.core.client.GGClient") as client_mock:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
235	            _, kwargs = client_mock.call_args
236	            assert kwargs["base_uri"] == "https://dashboard.my-instance.com/exposed"
237	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
384	        )
385	        os.system("git init")
386	        os.system("git add .")

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:385
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
384	        )
385	        os.system("git init")
386	        os.system("git add .")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
385	        os.system("git init")
386	        os.system("git add .")
387	        os.system("git commit -m 'initial commit'")

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:386
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
385	        os.system("git init")
386	        os.system("git add .")
387	        os.system("git commit -m 'initial commit'")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
386	        os.system("git add .")
387	        os.system("git commit -m 'initial commit'")
388	        Path("git_repo/not_committed.js").write_text(

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:387
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
386	        os.system("git add .")
387	        os.system("git commit -m 'initial commit'")
388	        Path("git_repo/not_committed.js").write_text(

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
440	        # Scan with --use-gitignore
441	        with cli_runner.isolated_filesystem(temp_dir=tmp_path):
442	            result = cli_runner.invoke(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_path.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
526	        local_repo = Repository.create(tmp_path)
527	        remote_url = "https://github.com/owner/repository.git"
528	        local_repo.git("remote", "add", "origin", remote_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_prepush.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	                    "origin",
155	                    "https://example.com/remote",
156	                ],
157	                env=env,
158	            )
159	
160	        scan_commit_range_mock.assert_called_once_with(
161	            client=ANY,
162	            cache=ANY,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_prepush.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	                "origin",
209	                "https://example.com/remote",
210	            ],
211	            input="",
212	        )
213	        assert_invoke_ok(result)
214	        assert "Deletion event or nothing to scan.\n" in result.output
215	
216	    @patch("ggshield.cmd.secret.scan.prepush.get_list_commit_SHA")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_prepush.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
298	                    "origin",
299	                    "https://example.com/remote",
300	                ],
301	                input=f"refs/heads/main {shas[-1]} refs/heads/main {remote_sha}",
302	            )
303	        assert_invoke_ok(result)
304	        scan_commit_range_mock.assert_called_once()
305	        assert "Commits to scan: 20" in result.output
306	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_prepush.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
422	                    "origin",
423	                    "https://example.com/remote",
424	                ],
425	                input=f"refs/heads/main {shas[-1]} refs/heads/main {remote_sha}",
426	            )
427	        assert_invoke_exited_with(result, ExitCode.SCAN_FOUND_PROBLEMS)
428	        scan_commit_range_mock.assert_called_once()
429	        assert "Commits to scan: 20" in result.output
430	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_prepush.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
431	        assert (
432	            """
433	> How to remediate
434	
435	  Since the secret was detected before the push BUT after the commit, you need to:
436	  1. rewrite the git history making sure to replace the secret with its reference (e.g. environment variable).
437	  2. push again.
438	
439	  To prevent having to rewrite git history in the future, setup ggshield as a pre-commit hook:
440	    https://docs.gitguardian.com/ggshield-docs/integrations/git-hooks/pre-commit
441	
442	> [To apply with caution] If you want to bypass ggshield (false positive or other reason), run:
443	  - if you use the pre-commit framework:
444	
445	    SKIP=ggshield-push git push"""
446	            in result.output
447	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_prereceive.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	        assert (
117	            """> How to remediate
118	
119	  A pre-receive hook set server side prevented you from pushing secrets.
120	
121	  Since the secret was detected during the push BUT after the commit, you need to:
122	  1. rewrite the git history making sure to replace the secret with its reference (e.g. environment variable).
123	  2. push again.
124	
125	  To prevent having to rewrite git history in the future, setup ggshield as a pre-commit hook:
126	    https://docs.gitguardian.com/ggshield-docs/integrations/git-hooks/pre-commit
127	
128	> [To apply with caution] If you want to bypass ggshield (false positive or other reason), run:
129	
130	    git push -o breakglass"""
131	            in result.output
132	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_repo.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        result = cli_fs_runner.invoke(
18	            cli, ["secret", "scan", "repo", "https://github.com/gitguardian/ggshield"]
19	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_repo.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        assert (
22	            "Error: https://github.com/gitguardian/ggshield doesn't seem to "
23	            "be a valid git URL.\nDid you mean "
24	            "https://github.com/gitguardian/ggshield.git?" in result.output
25	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/scan/test_repo.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	            cli,
55	            ["secret", "scan", "repo", "https://github.com/gitguardian/ggshield.git"],
56	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	DEFAULT_INSTANCE_URL = "https://dashboard.gitguardian.com"
22	
23	EXPECTED_OUTPUT = """instance: None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	
23	EXPECTED_OUTPUT = """instance: None
24	default_token_lifetime: None
25	
26	[https://dashboard.gitguardian.com]
27	default_token_lifetime: None
28	workspace_id: 1
29	url: https://dashboard.gitguardian.com
30	token: some token
31	token_name: some token name
32	expiry: 2022-05-04T17:00:00Z
33	
34	[https://some-gg-instance.com]
35	default_token_lifetime: None
36	workspace_id: 1
37	url: https://some-gg-instance.com
38	token: some token
39	token_name: first token
40	expiry: 2022-05-04T17:00:00Z
41	
42	[https://some-gg-instance.com]
43	default_token_lifetime: None
44	workspace_id: not set
45	url: https://some-gg-instance.com
46	token: not set
47	token_name: not set
48	expiry: not set
49	"""
50	
51	
52	def _check_expected_output(output: str, expected_output: str):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        add_instance_config(
68	            instance_url="https://some-gg-instance.com",
69	            token_name="first token",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        add_instance_config(
73	            instance_url="https://some-gg-instance.com",
74	            with_account=False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	                                "workspace_id": In([1, "not set"]),
110	                                "url": Match(r"https://[^\s]+\.com"),
111	                                "token": str,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	
169	        unrelated_instance = "https://some-unreleted-gg-instance.com"
170	
171	        add_instance_config(default_token_lifetime=value)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
236	        """
237	        instance_url = "https://some-invalid-gg-instance.com"
238	
239	        default_value = Config().auth_config.default_token_lifetime

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	        """
259	        instance = "https://example.com"
260	
261	        assert find_global_config_path() is None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
305	
306	        unrelated_instance = "https://some-unreleted-gg-instance.com"
307	
308	        add_instance_config(default_token_lifetime=unset_value)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
358	        """
359	        second_instance = "https://some-gg-instance.com"
360	        add_instance_config(default_token_lifetime=30)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
385	        """
386	        instance_url = "https://some-invalid-gg-instance.com"
387	
388	        default_value = Config().auth_config.default_token_lifetime

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
409	        config = UserConfig()
410	        config.instance = "https://example.com"
411	        config.save(config_path)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
462	        # add some noise
463	        unrelated_instance_url = "https://some-unrelated-gg-instance.com"
464	        add_instance_config(unrelated_instance_url, default_token_lifetime=43)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
489	        """
490	        instance_url = "https://some-gg-instance.com"
491	        unrelated_instance_url = "https://some-unrelated-gg-instance.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
490	        instance_url = "https://some-gg-instance.com"
491	        unrelated_instance_url = "https://some-unrelated-gg-instance.com"
492	
493	        # update default config
494	        config = Config()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
513	        """
514	        instance_url = "https://some-invalid-gg-instance.com"
515	        exit_code, output = self.run_cmd(cli_fs_runner, instance_url=instance_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
532	            (None, "not set"),
533	            ("https://example.com", "https://example.com"),
534	        ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_config.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
532	            (None, "not set"),
533	            ("https://example.com", "https://example.com"),
534	        ],

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_install.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
24	    def test_local_exist_is_dir(self, cli_fs_runner):
25	        os.system("git init")
26	        hook_path = Path(".git/hooks/pre-commit")

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_install.py:25
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
24	    def test_local_exist_is_dir(self, cli_fs_runner):
25	        os.system("git init")
26	        hook_path = Path(".git/hooks/pre-commit")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_install.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
34	    def test_local_exist_not_force(self, cli_fs_runner):
35	        os.system("git init")
36	        hook_path = Path(".git/hooks/pre-commit")

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_install.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
34	    def test_local_exist_not_force(self, cli_fs_runner):
35	        os.system("git init")
36	        hook_path = Path(".git/hooks/pre-commit")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_install.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
44	    def test_local_exist_force(self, cli_fs_runner):
45	        os.system("git init")
46	        hook_path = Path(".git/hooks/pre-commit")

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_install.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
44	    def test_local_exist_force(self, cli_fs_runner):
45	        os.system("git init")
46	        hook_path = Path(".git/hooks/pre-commit")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_status.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	                    "detail": "Valid API key.",
44	                    "instance": Match(r"https://[^\s]+"),
45	                    "status_code": 200,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_status.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	    (tmp_path / ".gitguardian.yaml").write_text(
97	        "version: 2\ninstance: https://dashboard.gitguardian.com\n"
98	    )
99	    instance_source, api_key_source = get_api_status(env)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_status.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	
103	    env["GITGUARDIAN_INSTANCE"] = "https://dashboard.gitguardian.com"
104	    env["GITGUARDIAN_API_KEY"] = "token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_status.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	    (tmp_path / ".env").write_text(
110	        "GITGUARDIAN_INSTANCE=https://dashboard.gitguardian.com\n"
111	        "GITGUARDIAN_API_KEY=token"
112	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_status.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	    assert (
118	        get_api_status(env, instance="https://dashboard.gitguardian.com")[0]
119	        == ConfigSource.CMD_OPTION.name

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_status.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
140	
141	    uri = "https://dashboard.my-instance.com"
142	
143	    with mock.patch("ggshield.core.client.GGClient") as client_mock:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/cmd/test_status.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        _, kwargs = client_mock.call_args
146	        assert kwargs["base_uri"] == "https://dashboard.my-instance.com/exposed"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/conftest.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
29	def is_macos():
30	    return platform.system() == "Darwin"
31	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/conftest.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
29	def is_macos():
30	    return platform.system() == "Darwin"
31	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/conftest.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
29	def is_macos():
30	    return platform.system() == "Darwin"
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/conftest.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
665	        instance_url = os.getenv(
666	            "GITGUARDIAN_INSTANCE", "https://dashboard.gitguardian.com"
667	        )
668	        base_uri = dashboard_to_api_url(instance_url)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/conftest.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
692	def cli_fs_runner(cli_runner):
693	    with cli_runner.isolated_filesystem():
694	        yield cli_runner

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/conftest.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
692	def cli_fs_runner(cli_runner):
693	    with cli_runner.isolated_filesystem():
694	        yield cli_runner

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/conftest.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
751	    # See <https://pytest-pyfakefs.readthedocs.io/en/latest/usage.html#set-file-as-inaccessible-under-windows>
752	    fs.chmod(path, 0o0000, force_unix_mode=True)
753	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/conftest.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
784	        "hmsl_hash": "0483663d03dc4ea2c2bfb73d0a4a8bc6f2035d911f3a7d210a16e8314413c29e",
785	        "gitguardian_url": "https://dashboard.staging.gitguardian.tech/workspace/1/incidents/42",
786	        "regression": False,
787	        "status": "TRIGGERED",
788	        "assignee_id": None,
789	        "assignee_email": None,
790	        "occurrences_count": 1,
791	        "secret_presence": {
792	            "files_requiring_code_fix": 1,
793	            "files_pending_merge": 0,
794	            "files_fixed": 0,
795	            "outside_vcs": 0,
796	            "removed_outside_vcs": 0,
797	            "in_vcs": 1,
798	            "removed_in_vcs": 0,
799	        },
800	        "ignore_reason": None,
801	        "triggered_at": "2024-09-04T16:00:48.956235+00:00",
802	        "ignored_at": None,
803	        "ignorer_id": None,
804	        "ignorer_api_token_id": None,
805	        "resolver_id": None,
806	        "resolver_api_token_id": None,
807	        "secret_revoked": False,
808	        "severity": "high",
809	        "validity": "invalid",
810	        "resolved_at": None,
811	        "share_url": None,
812	        "tags": [],
813	        "feedback_list": [],
814	        "occurrences": [],
815	    }
816	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/conftest.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	            "name": "default",
11	            "url": "https://dashboard.gitguardian.com",
12	            "default_token_lifetime": 1,
13	            "accounts": [
14	                {
15	                    "workspace_id": 23,
16	                    "token": "62890f237c703c92fbda8236ec2a055ac21332a46115005c976d68b900535fb5",  # ggignore
17	                    "type": "pat",
18	                    "token_name": "my_token",
19	                    "expire_at": "2022-02-23T12:34:56+00:00",
20	                }
21	            ],
22	        },
23	        {
24	            "name": None,
25	            "url": "https://dashboard.onprem.example.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/conftest.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            "name": None,
25	            "url": "https://dashboard.onprem.example.com",
26	            "default_token_lifetime": 0,  # no expiry
27	            "accounts": [
28	                {
29	                    "workspace_id": 1,
30	                    "token": "8ecffbaeedcd2f090546efeed3bc48a5f4a04a1196637aef6b3f6bbcfd58a96b",  # ggignore
31	                    "type": "sat",
32	                    "token_name": "my_other_token",
33	                    "expire_at": "2022-02-24T12:34:56+00:00",
34	                }
35	            ],
36	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_auth_config.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	def env_vars(monkeypatch):
21	    monkeypatch.setenv("GITGUARDIAN_API_URL", "https://api.gitguardian.com")
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_auth_config.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	
119	        assert config.instance_name == "https://dashboard.gitguardian.com"
120	        assert config.auth_config.instances == []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	                "api_key_env",
130	                "https://instance1.com",
131	                "https://instance2.com",
132	                "https://instance3.com",
133	                "api_key_env",
134	            ],
135	            [
136	                None,
137	                "https://instance1.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	                "https://instance1.com",
131	                "https://instance2.com",
132	                "https://instance3.com",
133	                "api_key_env",
134	            ],
135	            [
136	                None,
137	                "https://instance1.com",
138	                "https://instance2.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	                "https://instance2.com",
132	                "https://instance3.com",
133	                "api_key_env",
134	            ],
135	            [
136	                None,
137	                "https://instance1.com",
138	                "https://instance2.com",
139	                "https://instance3.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	                None,
137	                "https://instance1.com",
138	                "https://instance2.com",
139	                "https://instance3.com",
140	                "api_key_instance1.com",
141	            ],
142	            [
143	                None,
144	                None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	                "https://instance1.com",
138	                "https://instance2.com",
139	                "https://instance3.com",
140	                "api_key_instance1.com",
141	            ],
142	            [
143	                None,
144	                None,
145	                "https://instance2.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
138	                "https://instance2.com",
139	                "https://instance3.com",
140	                "api_key_instance1.com",
141	            ],
142	            [
143	                None,
144	                None,
145	                "https://instance2.com",
146	                "https://instance3.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	                None,
145	                "https://instance2.com",
146	                "https://instance3.com",
147	                "api_key_instance2.com",
148	            ],
149	            [
150	                None,
151	                None,
152	                None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	                "https://instance2.com",
146	                "https://instance3.com",
147	                "api_key_instance2.com",
148	            ],
149	            [
150	                None,
151	                None,
152	                None,
153	                "https://instance3.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	                None,
153	                "https://instance3.com",
154	                "api_key_instance3.com",
155	            ],
156	        ],
157	    )
158	    def test_api_key_priority(
159	        self,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
223	        # from the default test env vars:
224	        assert config.api_url == "https://api.gitguardian.com"
225	        assert config.dashboard_url == "https://dashboard.gitguardian.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
224	        assert config.api_url == "https://api.gitguardian.com"
225	        assert config.dashboard_url == "https://dashboard.gitguardian.com"
226	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	        monkeypatch.setitem(
234	            os.environ, "GITGUARDIAN_API_URL", "https://api.gitguardian.com/v1"
235	        )
236	        config = Config()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
238	        out, err = capsys.readouterr()
239	        sys.stdout.write(out)
240	        sys.stderr.write(err)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
239	        sys.stdout.write(out)
240	        sys.stderr.write(err)
241	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	
242	        assert api_url == "https://api.gitguardian.com"
243	        assert "Unexpected /v1 path in your URL configuration" in err

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
255	                "show_secrets": True,
256	                "api_url": "https://api.gitguardian.com/v1",
257	            },
258	        )
259	
260	        config = Config()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
262	        out, err = capsys.readouterr()
263	        sys.stdout.write(out)
264	        sys.stderr.write(err)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	        sys.stdout.write(out)
264	        sys.stderr.write(err)
265	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	
266	        assert api_url == "https://api.gitguardian.com"
267	        assert "Unexpected /v1 path in your URL configuration" in err

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
279	                "show_secrets": True,
280	                "api_url": "https://api.gitguardian.com/v1",
281	            },
282	        )
283	
284	        Config()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
285	        out, err = capsys.readouterr()
286	        sys.stdout.write(out)
287	        sys.stderr.write(err)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
286	        sys.stdout.write(out)
287	        sys.stderr.write(err)
288	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
303	            {
304	                "instance": "https://before.com",
305	            },
306	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
308	        config = Config()
309	        config.user_config.instance = "https://after.com"
310	        config.save()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
314	        dct = load_yaml_dict(local_config_path)
315	        assert dct["instance"] == "https://after.com"
316	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
318	        "instance_url",
319	        ["", "http://api.gitguardian.com/", "https://api.gitguardian.com/abc"],
320	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_config.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
318	        "instance_url",
319	        ["", "http://api.gitguardian.com/", "https://api.gitguardian.com/abc"],
320	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_user_config.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	                "show_secrets": False,
40	                "api_url": "https://api.gitguardian.com",
41	            },
42	        )
43	        write_yaml(
44	            global_config_path,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_user_config.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	                "show_secrets": True,
48	                "api_url": "https://api.gitguardian.com2",
49	            },
50	        )
51	
52	        config = Config()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_user_config.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        assert config.user_config.secret.show_secrets is False
55	        assert config.api_url == "https://api.gitguardian.com"
56	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_user_config.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	        """
303	        write_yaml(global_config_path, {"instance": "https://test.gitguardian.com/"})
304	        write_yaml(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_user_config.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
304	        write_yaml(
305	            local_config_path, {"instance": ["https://dashboard.gitguardian.com/"]}
306	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_utils.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	def test_remove_url_trailing_slash():
126	    result = remove_url_trailing_slash("https://dashboard.gitguardian.com/")
127	    assert result == "https://dashboard.gitguardian.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/config/test_utils.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	    result = remove_url_trailing_slash("https://dashboard.gitguardian.com/")
127	    assert result == "https://dashboard.gitguardian.com"
128	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/scan/test_commit.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	    with path.open("a") as f:
139	        f.write(content)
140	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/scan/test_commit.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
191	    repo.create_commit()
192	    path.chmod(0o755)
193	    repo.add(path)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/scan/test_commit.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
206	    # chmod
207	    new_path.chmod(0o755)
208	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/scan/test_scan_context.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	DOMAIN = "https://github.com"
14	SLUG = "from-env/repository"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/scan/test_scan_context.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	REMOTE_URL = "https://github.com/from-remote/repository"
19	FULL_REMOTE_URL = "https://user:password@github.com:84/from-remote/repository.git"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/scan/test_scan_context.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	REMOTE_URL = "https://github.com/from-remote/repository"
19	FULL_REMOTE_URL = "https://user:password@github.com:84/from-remote/repository.git"
20	EXPECTED_HEADER_REMOTE = "github.com/from-remote/repository"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_cache.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	        with open(".gitguardian.yml", "w") as file:
85	            file.write(yaml.dump({"max-commits-for-hook": 75}))
86	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_client.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    client_mock = Mock(spec=GGClient)
36	    client_mock.base_uri = "http://localhost"
37	    client_mock.read_metadata.return_value = response

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_client.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	        UnknownInstanceError,
108	        match="Unknown instance: 'https://example.com'",
109	    ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_client.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	            config = Config()
112	            config.cmdline_instance_name = "https://example.com"
113	            create_client_from_config(config)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    [
10	        ["https://api.gitguardian.com", "https://dashboard.gitguardian.com"],
11	        ["https://api.gitguardian.com/", "https://dashboard.gitguardian.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    [
10	        ["https://api.gitguardian.com", "https://dashboard.gitguardian.com"],
11	        ["https://api.gitguardian.com/", "https://dashboard.gitguardian.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        ["https://api.gitguardian.com", "https://dashboard.gitguardian.com"],
11	        ["https://api.gitguardian.com/", "https://dashboard.gitguardian.com"],
12	        ["https://api.gitguardian.com/v1", "https://dashboard.gitguardian.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        ["https://api.gitguardian.com", "https://dashboard.gitguardian.com"],
11	        ["https://api.gitguardian.com/", "https://dashboard.gitguardian.com"],
12	        ["https://api.gitguardian.com/v1", "https://dashboard.gitguardian.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        ["https://api.gitguardian.com/", "https://dashboard.gitguardian.com"],
12	        ["https://api.gitguardian.com/v1", "https://dashboard.gitguardian.com"],
13	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        ["https://api.gitguardian.com/", "https://dashboard.gitguardian.com"],
12	        ["https://api.gitguardian.com/v1", "https://dashboard.gitguardian.com"],
13	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        [
14	            "https://api.gitguardian.com/?foo=bar",
15	            "https://dashboard.gitguardian.com?foo=bar",
16	        ],
17	        ["https://example.com/exposed", "https://example.com"],
18	        ["https://example.com/exposed/", "https://example.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	            "https://api.gitguardian.com/?foo=bar",
15	            "https://dashboard.gitguardian.com?foo=bar",
16	        ],
17	        ["https://example.com/exposed", "https://example.com"],
18	        ["https://example.com/exposed/", "https://example.com"],
19	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        ],
17	        ["https://example.com/exposed", "https://example.com"],
18	        ["https://example.com/exposed/", "https://example.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        ],
17	        ["https://example.com/exposed", "https://example.com"],
18	        ["https://example.com/exposed/", "https://example.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        ["https://example.com/exposed", "https://example.com"],
18	        ["https://example.com/exposed/", "https://example.com"],
19	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        ["https://example.com/exposed", "https://example.com"],
18	        ["https://example.com/exposed/", "https://example.com"],
19	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        [
20	            "https://example.com/exposed/?foo=bar",
21	            "https://example.com?foo=bar",
22	        ],
23	        [
24	            "https://example.com/toto/exposed/?foo=bar",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	            "https://example.com/exposed/?foo=bar",
21	            "https://example.com?foo=bar",
22	        ],
23	        [
24	            "https://example.com/toto/exposed/?foo=bar",
25	            "https://example.com/toto?foo=bar",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        [
24	            "https://example.com/toto/exposed/?foo=bar",
25	            "https://example.com/toto?foo=bar",
26	        ],
27	        [
28	            "https://example.com/exposed/v1/?foo=bar",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            "https://example.com/toto/exposed/?foo=bar",
25	            "https://example.com/toto?foo=bar",
26	        ],
27	        [
28	            "https://example.com/exposed/v1/?foo=bar",
29	            "https://example.com?foo=bar",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        [
28	            "https://example.com/exposed/v1/?foo=bar",
29	            "https://example.com?foo=bar",
30	        ],
31	    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	            "https://example.com/exposed/v1/?foo=bar",
29	            "https://example.com?foo=bar",
30	        ],
31	    ],
32	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    [
40	        ["https://dashboard.gitguardian.com", "https://api.gitguardian.com"],
41	        ["https://dashboard.gitguardian.com/", "https://api.gitguardian.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    [
40	        ["https://dashboard.gitguardian.com", "https://api.gitguardian.com"],
41	        ["https://dashboard.gitguardian.com/", "https://api.gitguardian.com"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        ["https://dashboard.gitguardian.com", "https://api.gitguardian.com"],
41	        ["https://dashboard.gitguardian.com/", "https://api.gitguardian.com"],
42	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        ["https://dashboard.gitguardian.com", "https://api.gitguardian.com"],
41	        ["https://dashboard.gitguardian.com/", "https://api.gitguardian.com"],
42	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	        [
43	            "https://dashboard.gitguardian.com/?foo=bar",
44	            "https://api.gitguardian.com?foo=bar",
45	        ],
46	        ["https://example.com/", "https://example.com/exposed"],
47	        ["https://example.com/", "https://example.com/exposed"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	            "https://dashboard.gitguardian.com/?foo=bar",
44	            "https://api.gitguardian.com?foo=bar",
45	        ],
46	        ["https://example.com/", "https://example.com/exposed"],
47	        ["https://example.com/", "https://example.com/exposed"],
48	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        ],
46	        ["https://example.com/", "https://example.com/exposed"],
47	        ["https://example.com/", "https://example.com/exposed"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        ],
46	        ["https://example.com/", "https://example.com/exposed"],
47	        ["https://example.com/", "https://example.com/exposed"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        ["https://example.com/", "https://example.com/exposed"],
47	        ["https://example.com/", "https://example.com/exposed"],
48	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        ["https://example.com/", "https://example.com/exposed"],
47	        ["https://example.com/", "https://example.com/exposed"],
48	        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	        [
49	            "https://example.com/?foo=bar",
50	            "https://example.com/exposed?foo=bar",
51	        ],
52	        [
53	            "https://example.com/toto?foo=bar",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	            "https://example.com/?foo=bar",
50	            "https://example.com/exposed?foo=bar",
51	        ],
52	        [
53	            "https://example.com/toto?foo=bar",
54	            "https://example.com/toto/exposed?foo=bar",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        [
53	            "https://example.com/toto?foo=bar",
54	            "https://example.com/toto/exposed?foo=bar",
55	        ],
56	    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	            "https://example.com/toto?foo=bar",
54	            "https://example.com/toto/exposed?foo=bar",
55	        ],
56	    ],
57	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    "api_url",
64	    ["https://api.gitguardian.com/exposed", "https://api.gitguardian.com/toto"],
65	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    "api_url",
64	    ["https://api.gitguardian.com/exposed", "https://api.gitguardian.com/toto"],
65	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	    [
74	        "https://dashboard.gitguardian.com/exposed",
75	        "https://dashboard.gitguardian.com/toto",
76	    ],
77	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/core/test_url_utils.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        "https://dashboard.gitguardian.com/exposed",
75	        "https://dashboard.gitguardian.com/toto",
76	    ],
77	)
78	def test_unexpected_path_dashboard_url(dashboard_url):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/request_mock.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
92	    ):
93	        self.add_request(ExpectedRequest("GET", endpoint, response))
94	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/request_mock.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
101	    ):
102	        self.add_request(
103	            ExpectedRequest("POST", endpoint, response, data_checker, json_checker)
104	        )

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_files.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
28	    # AND it contains no file
29	    with tarfile.open(fileobj=tar_stream, mode="w:gz") as tar:
30	        assert len(tar.getmembers()) == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	):
36	    remote_url = f"https://github.com/owner/{repository_name}.git"
37	    repository.git("remote", "add", remote_name, remote_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	        (
165	            "https://user:password@github.com:84/GitGuardian/ggshield.git",
166	            "github.com/GitGuardian/ggshield",
167	        ),
168	        (
169	            "https://github.com/GitGuardian/ggshield.git",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	        (
169	            "https://github.com/GitGuardian/ggshield.git",
170	            "github.com/GitGuardian/ggshield",
171	        ),
172	        (
173	            "git@github.com:GitGuardian/ggshield.git",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	        (
177	            "https://github.com/Git.Guar-di_an/gg.sh-ie_ld.git",
178	            "github.com/Git.Guar-di_an/gg.sh-ie_ld",
179	        ),
180	        (
181	            "https://gitlab.instance.ovh/owner/project/repository.git",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	        (
181	            "https://gitlab.instance.ovh/owner/project/repository.git",
182	            "gitlab.instance.ovh/owner/project/repository",
183	        ),
184	        (
185	            "https://username@dev.azure.com/username/project/_git/repository",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	        (
185	            "https://username@dev.azure.com/username/project/_git/repository",
186	            "dev.azure.com/username/project/repository",
187	        ),
188	        (
189	            "https://username@bitbucket.org/owner/repository.git",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	        (
189	            "https://username@bitbucket.org/owner/repository.git",
190	            "bitbucket.org/owner/repository",
191	        ),
192	    ],

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
378	    tar_stream = BytesIO(tarbytes)
379	    with tarfile.open(fileobj=tar_stream, mode="r:gz") as tar:
380	        filenames = tar.getnames()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
387	    repo = Repository.create(tmp_path)
388	    repo.git("remote", "add", "origin", "https://a_remote_repo")
389	    repo.git("remote", "add", "upstream", "https://another_remote_repo")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
388	    repo.git("remote", "add", "origin", "https://a_remote_repo")
389	    repo.git("remote", "add", "upstream", "https://another_remote_repo")
390	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
457	    longpaths_included = any(param == "core.longpaths=true" for param in command)
458	    if platform.system() == "Windows":
459	        assert (

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
457	    longpaths_included = any(param == "core.longpaths=true" for param in command)
458	    if platform.system() == "Windows":
459	        assert (

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_git_shell.py:458
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
457	    longpaths_included = any(param == "core.longpaths=true" for param in command)
458	    if platform.system() == "Windows":
459	        assert (

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/utils/test_os.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
36	    file.write_text(file_contents)
37	    file.chmod(file_permissions)
38	    assert parse_os_release(file) == expected_tuple

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/auth/test_oauth.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    [
13	        ("http://localhost:3455", None),
14	        ("http://localhost:3455?", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/auth/test_oauth.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        ("http://localhost:3455", None),
14	        ("http://localhost:3455?", None),
15	        ("http://localhost:3455?auth=ggshield", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/auth/test_oauth.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	        ("http://localhost:3455?", None),
15	        ("http://localhost:3455?auth=ggshield", None),
16	        ("http://localhost:3455?error=some+error", "some error"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/auth/test_oauth.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	        ("http://localhost:3455?auth=ggshield", None),
16	        ("http://localhost:3455?error=some+error", "some error"),
17	        ("http://localhost/?error=some+error", "some error"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/auth/test_oauth.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        ("http://localhost:3455?error=some+error", "some error"),
17	        ("http://localhost/?error=some+error", "some error"),
18	        ("http://localhost:3455/?auth=ggshield&error=some+error", "some error"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/auth/test_oauth.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        ("http://localhost/?error=some+error", "some error"),
18	        ("http://localhost:3455/?auth=ggshield&error=some+error", "some error"),
19	    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/auth/test_oauth.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	    """
63	    oauth_client = OAuthClient(Config(), "https://dashboard.gitguardian.com")
64	    error_message = oauth_client.get_server_error_message(error_code)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/auth/test_oauth.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	            (
37	                "Maximum number of personal access tokens reached. "
38	                "Could not provision a new personal access token.\n"
39	                "Go to your workspace to manage your tokens: "
40	                "https://dashboard.gitguardian.com/api/personal-access-tokens"
41	            ),
42	        ),
43	        (
44	            "invalid_saml",
45	            "The given SSO URL is invalid.",
46	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/secret_manager/hashicorp_vault/test_api_client.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    return VaultAPIClient(
26	        vault_url="http://localhost:8200",
27	        api_token="my_vault_token",  # as defined in scripts/hmsl/hashicorp_vault.py

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/secret_manager/hashicorp_vault/test_api_client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    return VaultAPIClient(
37	        vault_url="http://localhost:8200",
38	        api_token="restricted_token",  # as defined in scripts/hmsl/hashicorp_vault.py

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    config = Config()
41	    assert config.hmsl_url == "https://api.hasmysecretleaked.com"
42	    assert config.hmsl_audience == "https://api.hasmysecretleaked.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    assert config.hmsl_url == "https://api.hasmysecretleaked.com"
42	    assert config.hmsl_audience == "https://api.hasmysecretleaked.com"
43	    assert config.saas_api_url == "https://api.gitguardian.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    assert config.hmsl_audience == "https://api.hasmysecretleaked.com"
43	    assert config.saas_api_url == "https://api.gitguardian.com"
44	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    monkeypatch.setenv(
54	        "GITGUARDIAN_HMSL_URL", "https://hasmysecretleaked.env.gitguardian.com"
55	    )
56	    # They are also expected to set a corresponding GitGuardian instance

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    # They are also expected to set a corresponding GitGuardian instance
57	    monkeypatch.setenv("GITGUARDIAN_INSTANCE", "https://dashboard.env.gitguardian.com")
58	    config = Config()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	    config = Config()
59	    assert config.hmsl_url == "https://hasmysecretleaked.env.gitguardian.com"
60	    assert config.hmsl_audience == "https://hasmysecretleaked.env.gitguardian.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    assert config.hmsl_url == "https://hasmysecretleaked.env.gitguardian.com"
60	    assert config.hmsl_audience == "https://hasmysecretleaked.env.gitguardian.com"
61	    assert config.saas_api_url == "https://api.env.gitguardian.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	    assert config.hmsl_audience == "https://hasmysecretleaked.env.gitguardian.com"
61	    assert config.saas_api_url == "https://api.env.gitguardian.com"
62	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	    monkeypatch.setenv(
71	        "GITGUARDIAN_INSTANCE", "https://dashboard.region3.gitguardian.com"
72	    )
73	    config = Config()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	    config = Config()
74	    assert config.hmsl_url == "https://api.hasmysecretleaked.com"
75	    assert config.hmsl_audience == "https://api.hasmysecretleaked.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    assert config.hmsl_url == "https://api.hasmysecretleaked.com"
75	    assert config.hmsl_audience == "https://api.hasmysecretleaked.com"
76	    assert config.saas_api_url == "https://api.region3.gitguardian.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    assert config.hmsl_audience == "https://api.hasmysecretleaked.com"
76	    assert config.saas_api_url == "https://api.region3.gitguardian.com"
77	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	    monkeypatch.setattr(time, "time", lambda: 1680000001)
151	    assert is_token_valid(token, "https://hasmysecretleaked.gitguardian.com") is False
152	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/hmsl/test_hmsl_utils.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	    monkeypatch.setattr(time, "time", lambda: 1680000001)
171	    assert is_token_valid(token, "https://hasmysecretleaked.gitguardian.com")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/output/test_json_output.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	                                    Required("incident_url"): validators.Match(
106	                                        r"^($|https://)"
107	                                    ),
108	                                    "occurrences": validators.All(
109	                                        [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/output/test_json_output.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
483	        secret.incident_url = (
484	            f"https://dashboard.gitguardian.com/workspace/1/incidents/{index}"
485	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/output/test_json_output.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
513	        assert incident_for_secret_type[secret.detector]["incident_url"].startswith(
514	            "https://dashboard.gitguardian.com/workspace/1/incidents/"
515	        )
516	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/output/test_json_output.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
567	        secret.incident_url = (
568	            f"https://dashboard.gitguardian.com/workspace/1/incidents/{index}"
569	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/output/test_sarif_output.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	            policy_break.incident_url = (
190	                f"https://dashboard.gitguardian.com/workspace/1/incidents/{index}"
191	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/output/test_text_output.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	                assert (
168	                    "https://dashboard.gitguardian.com/workspace/1/incidents/" in output
169	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	        assert {f.filename for f in files} == {
13	            "https://github.com/owner/repo/issues/1",
14	            "https://github.com/owner/repo/issues/3",
15	            "https://github.com/owner/repo/issues/4",
16	            "https://github.com/owner/repo/issues/4#issuecomment-10069",
17	            "https://github.com/owner/repo/issues/4#issuecomment-10070",
18	            "https://github.com/owner/repo/issues/5",
19	            "https://github.com/owner/repo/issues/6",
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	            "https://github.com/owner/repo/issues/1",
14	            "https://github.com/owner/repo/issues/3",
15	            "https://github.com/owner/repo/issues/4",
16	            "https://github.com/owner/repo/issues/4#issuecomment-10069",
17	            "https://github.com/owner/repo/issues/4#issuecomment-10070",
18	            "https://github.com/owner/repo/issues/5",
19	            "https://github.com/owner/repo/issues/6",
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	            "https://github.com/owner/repo/issues/3",
15	            "https://github.com/owner/repo/issues/4",
16	            "https://github.com/owner/repo/issues/4#issuecomment-10069",
17	            "https://github.com/owner/repo/issues/4#issuecomment-10070",
18	            "https://github.com/owner/repo/issues/5",
19	            "https://github.com/owner/repo/issues/6",
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	            "https://github.com/owner/repo/issues/4",
16	            "https://github.com/owner/repo/issues/4#issuecomment-10069",
17	            "https://github.com/owner/repo/issues/4#issuecomment-10070",
18	            "https://github.com/owner/repo/issues/5",
19	            "https://github.com/owner/repo/issues/6",
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	            "https://github.com/owner/repo/issues/4#issuecomment-10069",
17	            "https://github.com/owner/repo/issues/4#issuecomment-10070",
18	            "https://github.com/owner/repo/issues/5",
19	            "https://github.com/owner/repo/issues/6",
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	            "https://github.com/owner/repo/issues/4#issuecomment-10070",
18	            "https://github.com/owner/repo/issues/5",
19	            "https://github.com/owner/repo/issues/6",
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	            "https://github.com/owner/repo/issues/5",
19	            "https://github.com/owner/repo/issues/6",
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	            "https://github.com/owner/repo/issues/6",
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	            "https://github.com/owner/repo/issues/7",
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ggshield-1.38.1/ggshield-1.38.1/tests/unit/verticals/secret/test_scan_docset.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            "https://github.com/owner/repo/issues/8",
22	            "https://github.com/owner/repo/issues/8#issuecomment-10071",
23	        }

--------------------------------------------------

Code scanned:
	Total lines of code: 25354
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 247.0
		High: 95.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 328.0
		High: 14.0
Files skipped (0):
