Run started:2025-04-12 15:10:07.620847

Test results:
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/_internal_auth.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
92	        session.auth = (self.username, self.password)
93	        session.post(self.endpoint, data={"grant_type": "client_credentials"},)
94	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/_internal_auth.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
120	    def client_credentials(self) -> OAuthClientCredentials:
121	        credentials = base64.b64encode(
122	            f"{self.client_id}:{self.client_secret}".encode('utf-8')).decode('utf-8')
123	        headers = {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/_internal_auth.py:121
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
120	    def client_credentials(self) -> OAuthClientCredentials:
121	        credentials = base64.b64encode(
122	            f"{self.client_id}:{self.client_secret}".encode('utf-8')).decode('utf-8')
123	        headers = {

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/_internal_auth.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
128	        body = f"grant_type=client_credentials{f'&scope={self.scope}' if self.scope else ''}"
129	        response = requests.post(self.token_endpoint, headers=headers, data=body)
130	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/fake_checkpoint.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
202	    if __fake_checkpoint_byte_array_cache is None:
203	        __fake_checkpoint_byte_array_cache = base64.b64decode(
204	            FAKE_CHECKPOINT_B64_ENCODED.encode("ascii")
205	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/fake_checkpoint.py:203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
202	    if __fake_checkpoint_byte_array_cache is None:
203	        __fake_checkpoint_byte_array_cache = base64.b64decode(
204	            FAKE_CHECKPOINT_B64_ENCODED.encode("ascii")
205	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
222	        dump(deltaProtocol, json_file)
223	        json_file.write("\n")
224	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
222	        dump(deltaProtocol, json_file)
223	        json_file.write("\n")
224	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228	        dump(deltaMetadata, json_file)
229	        json_file.write("\n")
230	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
228	        dump(deltaMetadata, json_file)
229	        json_file.write("\n")
230	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
234	            dump(line_json["file"]["deltaSingleAction"], json_file)
235	            json_file.write("\n")
236	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
234	            dump(line_json["file"]["deltaSingleAction"], json_file)
235	            json_file.write("\n")
236	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
254	            dump(delta_protocol, min_version_file)
255	            min_version_file.write("\n")
256	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
254	            dump(delta_protocol, min_version_file)
255	            min_version_file.write("\n")
256	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	                    dump(version_to_metadata[version], log_file)
264	                    log_file.write("\n")
265	                for action in version_to_actions[version]:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
263	                    dump(version_to_metadata[version], log_file)
264	                    log_file.write("\n")
265	                for action in version_to_actions[version]:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
266	                    dump(action, log_file)
267	                    log_file.write("\n")
268	            # Ensure log file modification time matches the version timestamp

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
266	                    dump(action, log_file)
267	                    log_file.write("\n")
268	            # Ensure log file modification time matches the version timestamp

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
278	            with open(os.path.join(log_dir, checkpoint_file_name), 'w+b') as checkpoint_file:
279	                checkpoint_file.write(get_fake_checkpoint_byte_array())
280	                checkpoint_file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
278	            with open(os.path.join(log_dir, checkpoint_file_name), 'w+b') as checkpoint_file:
279	                checkpoint_file.write(get_fake_checkpoint_byte_array())
280	                checkpoint_file.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
286	            with open(last_checkpoint_path, 'w+') as last_checkpoint_file:
287	                last_checkpoint_file.write(last_checkpoint_content)
288	                last_checkpoint_file.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
286	            with open(last_checkpoint_path, 'w+') as last_checkpoint_file:
287	                last_checkpoint_file.write(last_checkpoint_content)
288	                last_checkpoint_file.close()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
430	        if len(proxy) != 0:
431	            filesystem = fsspec.filesystem(protocol, client_kwargs={"trust_env":True})
432	        else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/reader.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
432	        else:
433	            filesystem = fsspec.filesystem(protocol)
434	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	            return ListSharesResponse(
219	                shares=[Share.from_json(share_json) for share_json in shares_json.get("items", [])],
220	                next_page_token=shares_json.get("nextPageToken", None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	                shares=[Share.from_json(share_json) for share_json in shares_json.get("items", [])],
220	                next_page_token=shares_json.get("nextPageToken", None),
221	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	                schemas=[
237	                    Schema.from_json(schema_json) for schema_json in schemas_json.get("items", [])
238	                ],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	                ],
239	                next_page_token=schemas_json.get("nextPageToken", None),
240	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	            return ListTablesResponse(
257	                tables=[Table.from_json(table_json) for table_json in tables_json.get("items", [])],
258	                next_page_token=tables_json.get("nextPageToken", None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	                tables=[Table.from_json(table_json) for table_json in tables_json.get("items", [])],
258	                next_page_token=tables_json.get("nextPageToken", None),
259	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
273	            return ListAllTablesResponse(
274	                tables=[Table.from_json(table_json) for table_json in tables_json.get("items", [])],
275	                next_page_token=tables_json.get("nextPageToken", None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
274	                tables=[Table.from_json(table_json) for table_json in tables_json.get("items", [])],
275	                next_page_token=tables_json.get("nextPageToken", None),
276	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	            return QueryTableMetadataResponse(
292	                delta_table_version=int(headers.get(
293	                    DataSharingRestClient.DELTA_TABLE_VERSION_HEADER)),
294	                protocol=Protocol.from_json(protocol_json["protocol"]),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
348	
349	            table_version = int(headers.get(DataSharingRestClient.DELTA_TABLE_VERSION_HEADER))
350	            return QueryTableVersionResponse(delta_table_version=table_version)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
389	                return ListFilesInTableResponse(
390	                    delta_table_version=int(headers.get(
391	                        DataSharingRestClient.DELTA_TABLE_VERSION_HEADER)),
392	                    protocol=None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
401	                return ListFilesInTableResponse(
402	                    delta_table_version=int(headers.get("delta-table-version")),
403	                    protocol=Protocol.from_json(protocol_json["protocol"]),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/delta_sharing/rest_client.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
484	        self._auth_credential_provider.add_auth_header(self._session)
485	        response = request(f"{self._profile.endpoint}{target}", **kwargs)
486	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/setup.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	with open(path.join(this_directory, 'README.md'), encoding='utf-8') as f:
27	    LONG_DESCRIPTION = f.read()
28	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
29	try:
30	    exec(open('delta_sharing/version.py').read())
31	except IOError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	try:
30	    exec(open('delta_sharing/version.py').read())
31	except IOError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/setup.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    long_description_content_type='text/markdown',
67	    url="https://github.com/delta-io/delta-sharing/",
68	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/setup.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	    project_urls={
69	        'Source': 'https://github.com/delta-io/delta-sharing',
70	        'Documentation': 'https://github.com/delta-io/delta-sharing',
71	        'Issues': 'https://github.com/delta-io/delta-sharing/issues'
72	    },
73	    classifiers=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/setup.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	        'Source': 'https://github.com/delta-io/delta-sharing',
70	        'Documentation': 'https://github.com/delta-io/delta-sharing',
71	        'Issues': 'https://github.com/delta-io/delta-sharing/issues'
72	    },
73	    classifiers=[
74	        "Development Status :: 5 - Production/Stable",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/delta_sharing-1.3.2/delta_sharing-1.3.2/setup.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        'Documentation': 'https://github.com/delta-io/delta-sharing',
71	        'Issues': 'https://github.com/delta-io/delta-sharing/issues'
72	    },
73	    classifiers=[
74	        "Development Status :: 5 - Production/Stable",
75	        "Intended Audience :: Developers",

--------------------------------------------------

Code scanned:
	Total lines of code: 1933
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 37.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 3.0
Files skipped (0):
