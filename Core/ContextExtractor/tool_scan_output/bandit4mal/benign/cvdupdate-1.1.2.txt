Run started:2025-04-12 14:22:58.000538

Test results:
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/__main__.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
216	    # TODO(danvk): pick a random, available port
217	    httpd = HTTPServer(('', port), RangeRequestHandler)
218	    httpd.serve_forever()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	            "main.cvd" : {
68	                "url" : "https://database.clamav.net/main.cvd",
69	                "retry after" : 0,
70	                "last modified" : 0,
71	                "last checked" : 0,
72	                "DNS field" : 1,     # only for CVDs
73	                "local version" : 0, # only for CVDs
74	                "CDIFFs" : []        # only for CVDs
75	            },
76	            "daily.cvd" : {
77	                "url" : "https://database.clamav.net/daily.cvd",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	            "daily.cvd" : {
77	                "url" : "https://database.clamav.net/daily.cvd",
78	                "retry after" : 0,
79	                "last modified" : 0,
80	                "last checked" : 0,
81	                "DNS field" : 2,
82	                "local version" : 0,
83	                "CDIFFs" : []
84	            },
85	            "bytecode.cvd" : {
86	                "url" : "https://database.clamav.net/bytecode.cvd",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	            "bytecode.cvd" : {
86	                "url" : "https://database.clamav.net/bytecode.cvd",
87	                "retry after" : 0,
88	                "last modified" : 0,
89	                "last checked" : 0,
90	                "DNS field" : 7,
91	                "local version" : 0,
92	                "CDIFFs" : []
93	            },
94	        },

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
190	            with self.config_path.open('r') as config_file:
191	                self.config = json.load(config_file)
192	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
239	            with state_file.open('r') as st_fi:
240	                self.state = json.load(st_fi)
241	        elif self.state == {} or 'dbs' not in self.state:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
520	            # Try OpenDNS nameservers on Windows if not overridden by the user, because leaving it empty seems to fail.
521	            nameservers = ['208.67.222.222', '208.67.220.220']
522	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
520	            # Try OpenDNS nameservers on Windows if not overridden by the user, because leaving it empty seems to fail.
521	            nameservers = ['208.67.222.222', '208.67.220.220']
522	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
529	        config_nameserver = self.config['nameserver']
530	        env_nameserver = os.environ.get("CVDUPDATE_NAMESERVER")
531	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
596	        while retry < self.config['max retry']:
597	            response = requests.get(url, headers = {
598	                'User-Agent': f'CVDUPDATE/{self.version} ({self.state["uuid"]})',
599	                'Range': 'bytes=0-95',
600	                'If-Modified-Since': ims,
601	            })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
664	        while retry < self.config['max retry']:
665	            response = requests.get(url, headers = {
666	                'User-Agent': f'CVDUPDATE/{self.version} ({self.state["uuid"]})',
667	                'If-Modified-Since': ims,
668	            })

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
693	                with (self.db_dir / db).open('wb') as new_db:
694	                    new_db.write(response.content)
695	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
776	            while retry < self.config['max retry']:
777	                response = requests.get(url, headers = {
778	                    'User-Agent': f'CVDUPDATE/{self.version} ({self.state["uuid"]})',
779	                })

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
800	                    with (self.db_dir / f"{cdiff_filename}").open('wb') as new_db:
801	                        new_db.write(response.content)
802	                except Exception as exc:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
877	            with path.open('rb') as cvd_fd:
878	                cvd_header = cvd_fd.read(96)
879	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/cvdupdate/cvdupdate.py:1051
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1050	            with (self.db_dir / 'dns.txt').open('w') as dns_file:
1051	                dns_file.write(':'.join(self.dns_version_tokens))
1052	            self.logger.debug(f"Updated {self.db_dir / 'dns.txt'}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cvdupdate-1.1.2/cvdupdate-1.1.2/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    long_description_content_type="text/markdown",
15	    url="https://github.com/Cisco-Talos/cvdupdate",
16	    packages=setuptools.find_packages(),

--------------------------------------------------

Code scanned:
	Total lines of code: 1204
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 0.0
Files skipped (0):
