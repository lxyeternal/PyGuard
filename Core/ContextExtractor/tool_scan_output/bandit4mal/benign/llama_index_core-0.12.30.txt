Run started:2025-04-12 16:31:02.708933

Test results:
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/base/llms/types.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
98	            # pass verify=True to make sure it's not a false positive
99	            decoded_img = base64.b64decode(self.image, validate=True)
100	        except BinasciiError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/base/llms/types.py:99
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
98	            # pass verify=True to make sure it's not a false positive
99	            decoded_img = base64.b64decode(self.image, validate=True)
100	        except BinasciiError:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/base/llms/types.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
101	            decoded_img = self.image
102	            self.image = base64.b64encode(self.image)
103	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/base/llms/types.py:102
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
101	            decoded_img = self.image
102	            self.image = base64.b64encode(self.image)
103	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/base/llms/types.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
153	            # Check if audio is already base64 encoded
154	            decoded_audio = base64.b64decode(self.audio)
155	        except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/base/llms/types.py:154
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
153	            # Check if audio is already base64 encoded
154	            decoded_audio = base64.b64decode(self.audio)
155	        except Exception:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/base/llms/types.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
157	            # Not base64 - encode it
158	            self.audio = base64.b64encode(self.audio)
159	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/base/llms/types.py:158
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
157	            # Not base64 - encode it
158	            self.audio = base64.b64encode(self.audio)
159	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/command_line/upgrade.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
258	    with open(file_path, "w") as f:
259	        f.write("".join(new_lines))
260	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/constants.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	DEFAULT_PROJECT_NAME = "Default"
35	DEFAULT_BASE_URL = "https://api.cloud.llamaindex.ai"
36	DEFAULT_APP_URL = "https://cloud.llamaindex.ai"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/constants.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	DEFAULT_BASE_URL = "https://api.cloud.llamaindex.ai"
36	DEFAULT_APP_URL = "https://cloud.llamaindex.ai"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/dataset.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	LLAMA_INDEX_CONTENTS_URL = (
17	    f"https://raw.githubusercontent.com/run-llama/llama_index/main"
18	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/dataset.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	LLAMA_DATASETS_LFS_URL = (
23	    f"https://media.githubusercontent.com/media/run-llama/llama-datasets/main"
24	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/dataset.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	LLAMA_DATASETS_SOURCE_FILES_GITHUB_TREE_URL = (
27	    "https://github.com/run-llama/llama-datasets/tree/main"
28	)
29	LLAMA_SOURCE_FILES_PATH = "source_files"
30	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/dataset.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
110	            with open(local_library_path, "w") as f:
111	                f.write(library_raw_content)
112	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/dataset.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	        with open(f"{module_path}/{base_file_name}", "w") as f:
154	            f.write(dataset_raw_content)
155	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/dataset.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
171	                    ) as f:
172	                        f.write(source_file_raw_content_bytes)
173	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/dataset.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
180	                    ) as f:
181	                        f.write(source_file_raw_content)
182	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	LLAMA_HUB_CONTENTS_URL = f"https://raw.githubusercontent.com/run-llama/llama-hub/main"
22	LLAMA_HUB_PATH = "/llama_hub"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	logger = logging.getLogger(__name__)
28	LLAMAHUB_ANALYTICS_PROXY_SERVER = "https://llamahub.ai/api/analytics/downloads"
29	
30	
31	class MODULE_TYPE(str, Enum):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	            module_id = library[module_class]["id"]
60	            extra_files = library[module_class].get("extra_files", [])
61	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        module_id = library[module_class]["id"]
72	        extra_files = library[module_class].get("extra_files", [])
73	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	            with open(local_library_path, "w") as f:
82	                f.write(library_raw_content)
83	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
126	        with open(f"{module_path}/{base_file_name}", "w") as f:
127	            f.write(basepy_raw_content)
128	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
143	            with open(init_file_path, mode) as f:
144	                f.write(f"from .{module_id} import {', '.join(loader_exports)}")
145	                existing_exports = get_exports(f.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
144	                f.write(f"from .{module_id} import {', '.join(loader_exports)}")
145	                existing_exports = get_exports(f.read())
146	            rewrite_exports(existing_exports + loader_exports, str(local_dir_path))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	        with open(f"{module_path}/{extra_file}", "w") as f:
149	            f.write(extra_file_raw_content)
150	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	            with open(requirements_path, "w") as f:
161	                f.write(response_txt)
162	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/module.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
268	    try:
269	        requests.post(
270	            LLAMAHUB_ANALYTICS_PROXY_SERVER,
271	            json={"type": module_type, "plugin": module_class},
272	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/pack.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	LLAMA_PACKS_CONTENTS_URL = (
21	    "https://raw.githubusercontent.com/run-llama/llama_index/main/llama-index-packs"
22	)
23	LLAMA_PACKS_SOURCE_FILES_GITHUB_TREE_URL = (
24	    "https://github.com/run-llama/llama_index/tree/main"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/pack.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	LLAMA_PACKS_SOURCE_FILES_GITHUB_TREE_URL = (
24	    "https://github.com/run-llama/llama_index/tree/main"
25	)
26	PY_NAMESPACE = "llama_index/packs"
27	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/pack.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	PATH_TYPE = Union[str, Path]
29	LLAMAHUB_ANALYTICS_PROXY_SERVER = "https://llamahub.ai/api/analytics/downloads"
30	
31	logger = logging.getLogger(__name__)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/pack.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	            with open(local_source_file_path, "w") as f:
70	                f.write(source_file_raw_content)
71	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/pack.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	            with open(pyproject_toml_path, "w") as f:
85	                f.write(response_txt)
86	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/pack.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	        with open(readme_path, "w") as f:
89	            f.write(
90	                "DO NOT DELETE\nThis readme file is needed to install from pyproject.toml."
91	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/pack.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
143	    try:
144	        requests.post(
145	            LLAMAHUB_ANALYTICS_PROXY_SERVER,
146	            json={"type": module_type, "plugin": module_class},
147	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/utils.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
9	    """Get the content of a file from the GitHub REST API."""
10	    resp = requests.get(url + path)
11	    return resp.text, resp.status_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/utils.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
15	    """Get the content of a file from the GitHub REST API."""
16	    resp = requests.get(url + path)
17	    return resp.content, resp.status_code

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/utils.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
65	                continue
66	            f.write(line + os.linesep)
67	        f.write(f"__all__ = {list(set(exports))}" + os.linesep)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	            f.write(line + os.linesep)
67	        f.write(f"__all__ = {list(set(exports))}" + os.linesep)
68	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/utils.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	    """Get the list of source files to download."""
93	    resp = requests.get(
94	        source_tree_url + path + "?recursive=1", headers={"Accept": "application/json"}
95	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/download/utils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	        try:
110	            res = requests.get(url, headers={"Accept": "application/json"})
111	            tree_elements = res.json()["payload"]["tree"]["items"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/embeddings/utils.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
18	    with open(file_path, "w") as f:
19	        f.write(",".join([str(x) for x in embedding]))
20	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/embeddings/utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	            raise ValueError(
67	                "\n******\n"
68	                "Could not load OpenAI embedding model. "
69	                "If you intended to use OpenAI, please check your OPENAI_API_KEY.\n"
70	                "Original error:\n"
71	                f"{e!s}"
72	                "\nConsider using embed_model='local'.\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/embeddings/utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	            raise ImportError(
89	                "`llama-index-embeddings-clip` package not found, "
90	                "please run `pip install llama-index-embeddings-clip` and `pip install git+https://github.com/openai/CLIP.git`"
91	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/evaluation/benchmarks/beir.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	            if not os.path.exists(dataset_full_path):
35	                url = f"""https://public.ukp.informatik.tu-darmstadt.de/thakur\
36	/BEIR/datasets/{dataset}.zip"""
37	                try:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/evaluation/benchmarks/beir.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
42	                    )
43	                    rmtree(dataset_full_path)
44	                    raise ValueError(f"invalid BEIR dataset: {dataset}") from e

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/evaluation/benchmarks/hotpotqa.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	
19	DEV_DISTRACTOR_URL = """http://curtis.ml.cmu.edu/datasets/\
20	hotpot/hotpot_dev_distractor_v1.json"""
21	
22	
23	class HotpotQAEvaluator:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/evaluation/benchmarks/hotpotqa.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	                )
41	                response = requests.get(url, stream=True)
42	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/evaluation/benchmarks/hotpotqa.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	                    if chunk:
49	                        save_file.write(chunk)
50	            except Exception as e:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/evaluation/benchmarks/hotpotqa.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
54	                    )
55	                    rmtree(dataset_full_path)
56	                raise ValueError(f"could not download {dataset} dataset") from e

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/evaluation/benchmarks/hotpotqa.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        f = open(dataset_path)
75	        query_objects = json.loads(f.read())
76	        if queries_fraction:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/exec_utils.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
241	    _verify_source_safety(__source)
242	    return exec(__source, _get_restricted_globals(__globals), __locals)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/graph_stores/simple.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
88	        self._data = data or SimpleGraphStoreData()
89	        self._fs = fs or fsspec.filesystem("file")
90	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/graph_stores/simple.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
159	        """Create a SimpleGraphStore from a persist directory."""
160	        fs = fs or fsspec.filesystem("file")
161	        if not fs.exists(persist_path):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/graph_stores/simple_labelled.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
166	        if fs is None:
167	            fs = fsspec.filesystem("file")
168	        with fs.open(persist_path, "w") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/graph_stores/simple_labelled.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	        with fs.open(persist_path, "w") as f:
169	            f.write(self.graph.model_dump_json())
170	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/graph_stores/simple_labelled.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
178	        if fs is None:
179	            fs = fsspec.filesystem("file")
180	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/graph_stores/simple_labelled.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	        with fs.open(persist_path, "r") as f:
182	            data = json.loads(f.read())
183	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/img_utils.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
21	    image.save(buff, format=format)
22	    return cast(str, base64.b64encode(buff.getvalue()))
23	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/img_utils.py:22
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
21	    image.save(buff, format=format)
22	    return cast(str, base64.b64encode(buff.getvalue()))
23	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/img_utils.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
33	    """
34	    buff = BytesIO(base64.b64decode(data))
35	    return cast(ImageFile, Image.open(buff))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/img_utils.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
33	    """
34	    buff = BytesIO(base64.b64decode(data))
35	    return cast(ImageFile, Image.open(buff))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/ingestion/pipeline.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
371	            for reader in self.readers:
372	                input_nodes += reader.read()  # type: ignore
373	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/ingestion/pipeline.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
528	
529	            with multiprocessing.get_context("spawn").Pool(num_workers) as p:
530	                node_batches = self._node_batcher(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/ingestion/pipeline.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
709	            loop = asyncio.get_event_loop()
710	            with ProcessPoolExecutor(max_workers=num_workers) as p:
711	                node_batches = self._node_batcher(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/multi_modal_llms/generic_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	    with open(image_path, "rb") as image_file:
41	        return base64.b64encode(image_file.read()).decode("utf-8")
42	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/multi_modal_llms/generic_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
40	    with open(image_path, "rb") as image_file:
41	        return base64.b64encode(image_file.read()).decode("utf-8")
42	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/multi_modal_llms/generic_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
40	    with open(image_path, "rb") as image_file:
41	        return base64.b64encode(image_file.read()).decode("utf-8")
42	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/multi_modal_llms/generic_utils.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	        elif image_document.image_url:  # Image can also be pulled from the URL.
73	            response = requests.get(image_document.image_url)
74	            try:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/multi_modal_llms/generic_utils.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
75	                image_encodings.append(
76	                    base64.b64encode(response.content).decode("utf-8")
77	                )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/multi_modal_llms/generic_utils.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
75	                image_encodings.append(
76	                    base64.b64encode(response.content).decode("utf-8")
77	                )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/multi_modal_llms/generic_utils.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
126	    # Decode the base64 string
127	    decoded_data = base64.b64decode(base64_string)
128	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/multi_modal_llms/generic_utils.py:127
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
126	    # Decode the base64 string
127	    decoded_data = base64.b64decode(base64_string)
128	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/node_parser/text/code.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	                print(
85	                    f"Could not get parser for language {language}. Check "
86	                    "https://github.com/Goldziher/tree-sitter-language-pack?tab=readme-ov-file#available-languages "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/query_engine/cogniswitch_query_engine.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        self.knowledge_request_endpoint = (
22	            "https://api.cogniswitch.ai:8243/cs-api/0.0.1/cs/knowledgeRequest"
23	        )
24	        self.headers = {
25	            "apiKey": self.apiKey,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/query_engine/cogniswitch_query_engine.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
40	        data = {"query": query}
41	        response = requests.post(
42	            self.knowledge_request_endpoint,
43	            headers=self.headers,
44	            data=data,
45	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/readers/file/base.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
503	            # default mode is 'rb', we can cast the return value of f.read()
504	            return cast(bytes, f.read())
505	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/readers/file/base.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
596	            with fs.open(input_file, errors=errors, encoding=encoding) as f:
597	                data = cast(bytes, f.read()).decode(encoding, errors=errors)
598	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/readers/file/base.py:667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
666	            with fs.open(input_file, errors=errors, encoding=encoding) as f:
667	                data = cast(bytes, f.read()).decode(encoding, errors=errors)
668	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/readers/file/base.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
708	
709	            with multiprocessing.get_context("spawn").Pool(num_workers) as p:
710	                results = p.starmap(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/response/notebook_utils.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	        if img_node.image_url:
127	            img_response = requests.get(img_node.image_url)
128	            image = Image.open(BytesIO(img_response.content)).convert("RGB")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
137	        keys_to_remove = []
138	        private_attrs = state.get("__pydantic_private__", None)
139	        if private_attrs:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
536	            # pass verify=True to make sure it's not a false positive
537	            decoded = base64.b64decode(v, validate=True)
538	        except BinasciiError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:537
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
536	            # pass verify=True to make sure it's not a false positive
537	            decoded = base64.b64decode(v, validate=True)
538	        except BinasciiError:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
539	            # b64decode failed, return encoded
540	            return base64.b64encode(v)
541	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:540
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
539	            # b64decode failed, return encoded
540	            return base64.b64encode(v)
541	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
552	        # then the contents of `data` should be encoded already
553	        b64_data = info.data.get("data")
554	        if b64_data:  # encoded bytes

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
554	        if b64_data:  # encoded bytes
555	            decoded_data = base64.b64decode(b64_data)
556	            if guess := filetype.guess(decoded_data):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:555
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
554	        if b64_data:  # encoded bytes
555	            decoded_data = base64.b64decode(b64_data)
556	            if guess := filetype.guess(decoded_data):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
799	            else:
800	                kwargs["image_path"] = ir.get("path", None)
801	                kwargs["image_url"] = ir.get("url", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
800	                kwargs["image_path"] = ir.get("path", None)
801	                kwargs["image_url"] = ir.get("url", None)
802	                kwargs["image_mimetype"] = ir.get("mimetype", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
801	                kwargs["image_url"] = ir.get("url", None)
802	                kwargs["image_mimetype"] = ir.get("mimetype", None)
803	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
803	
804	        mimetype = kwargs.get("image_mimetype")
805	        if not mimetype and kwargs.get("image_path") is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
804	        mimetype = kwargs.get("image_mimetype")
805	        if not mimetype and kwargs.get("image_path") is not None:
806	            # guess mimetype from image_path

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
825	
826	            return BytesIO(base64.b64decode(self.image))
827	        elif self.image_path is not None:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:826
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
825	
826	            return BytesIO(base64.b64decode(self.image))
827	        elif self.image_path is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
832	
833	            response = requests.get(self.image_url)
834	            return BytesIO(response.content)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
899	
900	        obj = data.get("obj")
901	        parsed_obj = None

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1156	        with tempfile.NamedTemporaryFile() as f:
1157	            f.write(self.text.encode("utf-8"))
1158	            f.flush()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1267	        if self.text_resource and self.text_resource.embeddings:
1268	            return self.text_resource.embeddings.get("dense")
1269	        return None

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1293	                return BytesIO(self.image_resource.data)
1294	            return BytesIO(base64.b64decode(self.image_resource.data))
1295	        elif self.image_resource.path is not None:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1294
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1293	                return BytesIO(self.image_resource.data)
1294	            return BytesIO(base64.b64decode(self.image_resource.data))
1295	        elif self.image_resource.path is not None:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1297	            if as_base64:
1298	                return BytesIO(base64.b64encode(img_bytes))
1299	            return BytesIO(img_bytes)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1297	            if as_base64:
1298	                return BytesIO(base64.b64encode(img_bytes))
1299	            return BytesIO(img_bytes)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1301	            # load image from URL
1302	            response = requests.get(str(self.image_resource.url))
1303	            img_bytes = response.content

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1304	            if as_base64:
1305	                return BytesIO(base64.b64encode(img_bytes))
1306	            return BytesIO(img_bytes)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/schema.py:1305
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1304	            if as_base64:
1305	                return BytesIO(base64.b64encode(img_bytes))
1306	            return BytesIO(img_bytes)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/service_context.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        raise ValueError(
14	            "ServiceContext is deprecated. Use llama_index.settings.Settings instead, "
15	            "or pass in modules to local functions/methods/interfaces.\n"
16	            "See the docs for updated usage/migration: \n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/service_context.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        raise ValueError(
32	            "ServiceContext is deprecated. Use llama_index.settings.Settings instead, "
33	            "or pass in modules to local functions/methods/interfaces.\n"
34	            "See the docs for updated usage/migration: \n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/service_context.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    raise ValueError(
42	        "ServiceContext is deprecated. Use llama_index.settings.Settings instead, "
43	        "or pass in modules to local functions/methods/interfaces.\n"
44	        "See the docs for updated usage/migration: \n"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/storage/chat_store/simple_chat_store.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
87	        """Persist the docstore to a file."""
88	        fs = fs or fsspec.filesystem("file")
89	        dirpath = os.path.dirname(persist_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/storage/chat_store/simple_chat_store.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	        with fs.open(persist_path, "w") as f:
94	            f.write(self.json())
95	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/storage/chat_store/simple_chat_store.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
102	        """Create a SimpleChatStore from a persist path."""
103	        fs = fs or fsspec.filesystem("file")
104	        if not fs.exists(persist_path):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/storage/index_store/simple_index_store.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
51	        """Create a SimpleIndexStore from a persist path."""
52	        fs = fs or fsspec.filesystem("file")
53	        simple_kvstore = SimpleKVStore.from_persist_path(persist_path, fs=fs)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/storage/kvstore/simple_kvstore.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
81	        """Persist the store."""
82	        fs = fs or fsspec.filesystem("file")
83	        dirpath = os.path.dirname(persist_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/storage/kvstore/simple_kvstore.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	        with fs.open(persist_path, "w") as f:
88	            f.write(json.dumps(self._data))
89	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/storage/kvstore/simple_kvstore.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
94	        """Load a SimpleKVStore from a persist path and filesystem."""
95	        fs = fs or fsspec.filesystem("file")
96	        logger.debug(f"Loading {__name__} from {persist_path}.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	        # Set up NLTK data directory
52	        self._nltk_data_dir = os.environ.get(
53	            "NLTK_DATA",
54	            os.path.join(
55	                os.path.dirname(os.path.abspath(__file__)),
56	                "_static/nltk_cache",
57	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
264	                raise
265	            check_fn = error_checks.get(e.__class__)
266	            if check_fn and not check_fn(e):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
311	                raise
312	            check_fn = error_checks.get(e.__class__)
313	            if check_fn and not check_fn(e):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
431	    else:
432	        local = os.environ.get("LOCALAPPDATA", None) or os.path.expanduser(
433	            "~\\AppData\\Local"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
630	        try:
631	            decoded_bytes = base64.b64decode(raw_bytes)
632	        except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:631
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
630	        try:
631	            decoded_bytes = base64.b64decode(raw_bytes)
632	        except Exception:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
638	            # pass verify=True to make sure it's not a false positive
639	            decoded_bytes = base64.b64decode(raw_bytes, validate=True)
640	        except BinasciiError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:639
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
638	            # pass verify=True to make sure it's not a false positive
639	            decoded_bytes = base64.b64decode(raw_bytes, validate=True)
640	        except BinasciiError:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
644	        if as_base64:
645	            return BytesIO(base64.b64encode(decoded_bytes))
646	        return BytesIO(decoded_bytes)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:645
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
644	        if as_base64:
645	            return BytesIO(base64.b64encode(decoded_bytes))
646	        return BytesIO(decoded_bytes)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
651	        if as_base64:
652	            return BytesIO(base64.b64encode(data))
653	        return BytesIO(data)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:652
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
651	        if as_base64:
652	            return BytesIO(base64.b64encode(data))
653	        return BytesIO(data)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
656	        headers = {
657	            "User-Agent": "LlamaIndex/0.0 (https://llamaindex.ai; info@llamaindex.ai) llama-index-core/0.0"
658	        }
659	        response = requests.get(url, headers=headers)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
658	        }
659	        response = requests.get(url, headers=headers)
660	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
661	        if as_base64:
662	            return BytesIO(base64.b64encode(response.content))
663	        return BytesIO(response.content)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/utils.py:662
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
661	        if as_base64:
662	            return BytesIO(base64.b64encode(response.content))
663	        return BytesIO(response.content)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/vector_stores/simple.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
162	        super().__init__(data=data or SimpleVectorStoreData())  # type: ignore[call-arg]
163	        self._fs = fs or fsspec.filesystem("file")
164	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/vector_stores/simple.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
405	        """Create a SimpleKVStore from a persist directory."""
406	        fs = fs or fsspec.filesystem("file")
407	        if not fs.exists(persist_path):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/workflow/context_serializers.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
74	        except Exception:
75	            return base64.b64encode(pickle.dumps(value)).decode("utf-8")
76	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/workflow/context_serializers.py:75
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
74	        except Exception:
75	            return base64.b64encode(pickle.dumps(value)).decode("utf-8")
76	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/workflow/context_serializers.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
79	        try:
80	            return pickle.loads(base64.b64decode(value))
81	        except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/llama_index_core-0.12.30/llama_index_core-0.12.30/llama_index/core/workflow/context_serializers.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
79	        try:
80	            return pickle.loads(base64.b64decode(value))
81	        except Exception:

--------------------------------------------------

Code scanned:
	Total lines of code: 64263
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 44.0
		High: 96.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 116.0
		High: 24.0
Files skipped (0):
