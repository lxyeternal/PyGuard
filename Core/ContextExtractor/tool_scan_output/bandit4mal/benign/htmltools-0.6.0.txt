Run started:2025-04-12 19:46:02.169793

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/htmltools/_core.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1129	        with open(file, "w") as f:
1130	            f.write(rendered["html"])
1131	        return file

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/htmltools/_core.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1129	        with open(file, "w") as f:
1130	            f.write(rendered["html"])
1131	        return file

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/htmltools/_core.py:1773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1772	        if os.path.exists(target_dir):
1773	            shutil.rmtree(target_dir)
1774	        target_dir.mkdir(parents=True, exist_ok=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/htmltools/_core.py:1981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1980	        port = ensure_http_server(tmpdir)
1981	        webbrowser.open(f"http://localhost:{port}/{key_}/index.html")
1982	        return file

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/htmltools/_util.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
176	    port: int = get_open_port()
177	    th: Thread = Thread(target=http_server, args=(port, path), daemon=True)
178	    th.start()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/htmltools/_util.py:197
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
196	def get_open_port() -> int:
197	    with closing(socket()) as sock:
198	        sock.bind(("", 0))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    a1_2 = HTMLDependency(
25	        "a", "1.2", source={"href": "http://a.test.com"}, script={"src": "a2.js"}
26	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    b1_10 = HTMLDependency(
32	        "b", "1.10", source={"href": "http://b.test.com"}, script={"src": "b2.js"}
33	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    assert HTMLDocument(test).render(lib_prefix=None)["html"] == textwrap.dedent(
37	        """\
38	        <!DOCTYPE html>
39	        <html>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    assert HTMLDocument(test).render(lib_prefix="libfoo")["html"] == textwrap.dedent(
52	        """\
53	        <!DOCTYPE html>
54	        <html>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	    a1_2 = HTMLDependency(
87	        "a", "1.2", source={"href": "http://foo.com"}, script={"src": "a2.js"}
88	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	    expected_result = textwrap.dedent(
92	        """\
93	        <!DOCTYPE html>
94	        <html>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	        "1.1",
268	        source={"href": "https://example.com"},
269	        script={"src": "u1.js"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
275	        "version": "1.1",
276	        "script": [{"src": "https://example.com/u1.js"}],
277	        "stylesheet": [{"href": "https://example.com/u1.css", "rel": "stylesheet"}],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	        "script": [{"src": "https://example.com/u1.js"}],
277	        "stylesheet": [{"href": "https://example.com/u1.css", "rel": "stylesheet"}],
278	        "meta": [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
286	        "2.1",
287	        source={"href": "https://test.com/subdir/trailing/slash/"},
288	        stylesheet=[{"href": "v1.css"}, {"href": "v2.css"}],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	            {
297	                "href": "https://test.com/subdir/trailing/slash/v1.css",
298	                "rel": "stylesheet",
299	            },
300	            {
301	                "href": "https://test.com/subdir/trailing/slash/v2.css",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_deps.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
300	            {
301	                "href": "https://test.com/subdir/trailing/slash/v2.css",
302	                "rel": "stylesheet",
303	            },
304	        ],

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_html_document.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	        x.save_html(f)
23	        return open(f, "r").read()
24	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_html_document.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
241	
242	        html = open(f, "r").read()
243	        assert html.find('<script src="lib/testdep-1.0/testdep.js">') != -1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_html_document.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
257	
258	        html = open(f, "r").read()
259	        assert html.find('<script src="mylib/testdep/testdep.js">') != -1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/htmltools-0.6.0/htmltools-0.6.0/tests/test_tags.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
40	        x.save_html(f, **kwargs)
41	        return open(f, "r").read()
42	

--------------------------------------------------

Code scanned:
	Total lines of code: 7485
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 1.0
Files skipped (0):
