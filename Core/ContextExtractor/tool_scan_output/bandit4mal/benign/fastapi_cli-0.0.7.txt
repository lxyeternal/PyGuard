Run started:2025-04-12 17:18:16.571331

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/src/fastapi_cli/cli.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
80	    *,
81	    host: str = "127.0.0.1",
82	    port: int = 8000,
83	    reload: bool = True,
84	    workers: Union[int, None] = None,
85	    root_path: str = "",
86	    command: str,
87	    app: Union[str, None] = None,
88	    proxy_headers: bool = False,
89	) -> None:
90	    with get_rich_toolkit() as toolkit:
91	        server_type = "development" if command == "dev" else "production"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/src/fastapi_cli/cli.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
187	        ),
188	    ] = "127.0.0.1",
189	    port: Annotated[
190	        int,
191	        typer.Option(
192	            help="The port to serve on. You would normally have a termination proxy on top (another program) handling HTTPS on port [blue]443[/blue] and HTTP on port [blue]80[/blue], transferring the communication to your app."
193	        ),
194	    ] = 8000,
195	    reload: Annotated[
196	        bool,
197	        typer.Option(
198	            help="Enable auto-reload of the server when (code) files change. This is [bold]resource intensive[/bold], use it only during development."
199	        ),
200	    ] = True,
201	    root_path: Annotated[
202	        str,
203	        typer.Option(
204	            help="The root path is used to tell your app that it is being served to the outside world with some [bold]path prefix[/bold] set up in some termination proxy or similar."
205	        ),
206	    ] = "",
207	    app: Annotated[
208	        Union[str, None],
209	        typer.Option(
210	            help="The name of the variable that contains the [bold]FastAPI[/bold] app in the imported module or package. If not provided, it is detected automatically."
211	        ),
212	    ] = None,
213	    proxy_headers: Annotated[
214	        bool,
215	        typer.Option(
216	            help="Enable/Disable X-Forwarded-Proto, X-Forwarded-For, X-Forwarded-Port to populate remote address info."
217	        ),
218	    ] = True,
219	) -> Any:
220	    """
221	    Run a [bold]FastAPI[/bold] app in [yellow]development[/yellow] mode. ðŸ§ª
222	
223	    This is equivalent to [bold]fastapi run[/bold] but with [bold]reload[/bold] enabled and listening on the [blue]127.0.0.1[/blue] address.
224	
225	    It automatically detects the Python module or package that needs to be imported based on the file or directory path passed.
226	
227	    If no path is passed, it tries with:
228	
229	    - [blue]main.py[/blue]
230	    - [blue]app.py[/blue]
231	    - [blue]api.py[/blue]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/src/fastapi_cli/cli.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
270	        ),
271	    ] = "0.0.0.0",
272	    port: Annotated[
273	        int,
274	        typer.Option(
275	            help="The port to serve on. You would normally have a termination proxy on top (another program) handling HTTPS on port [blue]443[/blue] and HTTP on port [blue]80[/blue], transferring the communication to your app."
276	        ),
277	    ] = 8000,
278	    reload: Annotated[
279	        bool,
280	        typer.Option(
281	            help="Enable auto-reload of the server when (code) files change. This is [bold]resource intensive[/bold], use it only during development."
282	        ),
283	    ] = False,
284	    workers: Annotated[
285	        Union[int, None],
286	        typer.Option(
287	            help="Use multiple worker processes. Mutually exclusive with the --reload flag."
288	        ),
289	    ] = None,
290	    root_path: Annotated[
291	        str,
292	        typer.Option(
293	            help="The root path is used to tell your app that it is being served to the outside world with some [bold]path prefix[/bold] set up in some termination proxy or similar."
294	        ),
295	    ] = "",
296	    app: Annotated[
297	        Union[str, None],
298	        typer.Option(
299	            help="The name of the variable that contains the [bold]FastAPI[/bold] app in the imported module or package. If not provided, it is detected automatically."
300	        ),
301	    ] = None,
302	    proxy_headers: Annotated[
303	        bool,
304	        typer.Option(
305	            help="Enable/Disable X-Forwarded-Proto, X-Forwarded-For, X-Forwarded-Port to populate remote address info."
306	        ),
307	    ] = True,
308	) -> Any:
309	    """
310	    Run a [bold]FastAPI[/bold] app in [green]production[/green] mode. ðŸš€
311	
312	    This is equivalent to [bold]fastapi dev[/bold] but with [bold]reload[/bold] disabled and listening on the [blue]0.0.0.0[/blue] address.
313	
314	    It automatically detects the Python module or package that needs to be imported based on the file or directory path passed.
315	
316	    If no path is passed, it tries with:
317	
318	    - [blue]main.py[/blue]
319	    - [blue]app.py[/blue]
320	    - [blue]api.py[/blue]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
26	                "app": "single_file_app:app",
27	                "host": "127.0.0.1",
28	                "port": 8000,
29	                "reload": True,
30	                "workers": None,
31	                "root_path": "",
32	                "proxy_headers": True,
33	                "log_config": get_uvicorn_log_config(),
34	            }
35	        assert "Using import string: single_file_app:app" in result.output
36	        assert "Starting development server ðŸš€" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        assert "Starting development server ðŸš€" in result.output
37	        assert "Server started at http://127.0.0.1:8000" in result.output
38	        assert "Documentation at http://127.0.0.1:8000/docs" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        assert "Server started at http://127.0.0.1:8000" in result.output
38	        assert "Documentation at http://127.0.0.1:8000/docs" in result.output
39	        assert (

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
55	                "app": "nested_package.package:app",
56	                "host": "127.0.0.1",
57	                "port": 8000,
58	                "reload": True,
59	                "workers": None,
60	                "root_path": "",
61	                "proxy_headers": True,
62	                "log_config": get_uvicorn_log_config(),
63	            }
64	        assert "Using import string: nested_package.package:app" in result.output
65	        assert "Starting development server ðŸš€" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        assert "Starting development server ðŸš€" in result.output
66	        assert "Server started at http://127.0.0.1:8000" in result.output
67	        assert "Documentation at http://127.0.0.1:8000/docs" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	        assert "Server started at http://127.0.0.1:8000" in result.output
67	        assert "Documentation at http://127.0.0.1:8000/docs" in result.output
68	        assert (

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
87	                    "--host",
88	                    "192.168.0.2",
89	                    "--port",
90	                    "8080",
91	                    "--no-reload",
92	                    "--root-path",
93	                    "/api",
94	                    "--app",
95	                    "api",
96	                    "--no-proxy-headers",
97	                ],
98	            )
99	            assert result.exit_code == 0, result.output
100	            assert mock_run.called
101	            assert mock_run.call_args

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
103	                "app": "single_file_app:api",
104	                "host": "192.168.0.2",
105	                "port": 8080,
106	                "reload": False,
107	                "workers": None,
108	                "root_path": "/api",
109	                "proxy_headers": False,
110	                "log_config": get_uvicorn_log_config(),
111	            }
112	        assert "Using import string: single_file_app:api" in result.output
113	        assert "Starting development server ðŸš€" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	        assert "Starting development server ðŸš€" in result.output
114	        assert "Server started at http://192.168.0.2:8080" in result.output
115	        assert "Documentation at http://192.168.0.2:8080/docs" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	        assert "Server started at http://192.168.0.2:8080" in result.output
115	        assert "Documentation at http://192.168.0.2:8080/docs" in result.output
116	        assert (

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
130	                "app": "single_file_app:app",
131	                "host": "0.0.0.0",
132	                "port": 8000,
133	                "reload": False,
134	                "workers": None,
135	                "root_path": "",
136	                "proxy_headers": True,
137	                "log_config": get_uvicorn_log_config(),
138	            }
139	        assert "Using import string: single_file_app:app" in result.output
140	        assert "Starting production server ðŸš€" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
140	        assert "Starting production server ðŸš€" in result.output
141	        assert "Server started at http://0.0.0.0:8000" in result.output
142	        assert "Documentation at http://0.0.0.0:8000/docs" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	        assert "Server started at http://0.0.0.0:8000" in result.output
142	        assert "Documentation at http://0.0.0.0:8000/docs" in result.output
143	        assert (

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
157	                    "--host",
158	                    "192.168.0.2",
159	                    "--port",
160	                    "8080",
161	                    "--no-reload",
162	                    "--workers",
163	                    "2",
164	                    "--root-path",
165	                    "/api",
166	                    "--app",
167	                    "api",
168	                    "--no-proxy-headers",
169	                ],
170	            )
171	            assert result.exit_code == 0, result.output
172	            assert mock_run.called
173	            assert mock_run.call_args

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
175	                "app": "single_file_app:api",
176	                "host": "192.168.0.2",
177	                "port": 8080,
178	                "reload": False,
179	                "workers": 2,
180	                "root_path": "/api",
181	                "proxy_headers": False,
182	                "log_config": get_uvicorn_log_config(),
183	            }
184	
185	        assert "Using import string: single_file_app:api" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	        assert "Starting production server ðŸš€" in result.output
187	        assert "Server started at http://192.168.0.2:8080" in result.output
188	        assert "Documentation at http://192.168.0.2:8080/docs" in result.output

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_cli.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
187	        assert "Server started at http://192.168.0.2:8080" in result.output
188	        assert "Documentation at http://192.168.0.2:8080/docs" in result.output
189	        assert (

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_utils_cli.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	        args={
25	            "client_addr": "127.0.0.1",
26	            "request_line": "GET / HTTP/1.1",
27	            "status_code": 200,
28	        },
29	        exc_info=None,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cli-0.0.7/fastapi_cli-0.0.7/tests/test_utils_cli.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
34	    assert "INFO" in formatted
35	    assert "127.0.0.1" in formatted
36	    assert "GET / HTTP/1.1" in formatted

--------------------------------------------------

Code scanned:
	Total lines of code: 1296
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 0.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 0.0
Files skipped (0):
