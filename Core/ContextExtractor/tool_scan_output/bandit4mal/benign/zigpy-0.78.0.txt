Run started:2025-04-12 11:53:07.246439

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/tests/test_backups.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	                manufacturer="Coordinator Manufacturer",
25	                version="1.2.3.4",
26	            ),

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/tests/test_config.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
204	
205	    path.rmdir()
206	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/tests/test_serial.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
91	        assert len(loop.create_connection.mock_calls) == 2
92	        assert loop.create_connection.mock_calls[0].kwargs["host"] == "1.2.3.4"
93	        assert loop.create_connection.mock_calls[0].kwargs["port"] == 5678

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/tests/test_serial.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
93	        assert loop.create_connection.mock_calls[0].kwargs["port"] == 5678
94	        assert loop.create_connection.mock_calls[1].kwargs["host"] == "1.2.3.4"
95	        assert loop.create_connection.mock_calls[1].kwargs["port"] == 6638

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/config/__init__.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
322	        cv_deprecated(
323	            "The `remote_providers` key is deprecated, migrate your configuration"
324	            " to the `extra_providers` list instead: `extra_providers: [{'type': 'remote',"
325	            " 'url': 'https://example.com'}]`"
326	        ),
327	        [SCHEMA_OTA_PROVIDER_REMOTE],
328	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/json_schemas.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
274	REMOTE_PROVIDER_SCHEMA = {
275	    "$schema": "http://json-schema.org/draft-07/schema#",
276	    "type": "object",
277	    "properties": {
278	        "firmwares": {
279	            "type": "array",
280	            "items": {
281	                "type": "object",
282	                "properties": {
283	                    "binary_url": {"type": "string", "format": "uri"},
284	                    "path": {"type": "string"},
285	                    "file_version": {"type": "integer"},
286	                    "file_size": {"type": "integer"},
287	                    "image_type": {"type": "integer"},
288	                    "manufacturer_names": {
289	                        "type": "array",
290	                        "items": {"type": "string"},
291	                    },
292	                    "model_names": {"type": "array", "items": {"type": "string"}},
293	                    "manufacturer_id": {"type": "integer"},
294	                    "changelog": {"type": "string"},
295	                    "release_notes": {"type": "string"},
296	                    "checksum": {
297	                        "type": "string",
298	                        "pattern": "^sha3-256:[a-f0-9]{64}$",
299	                    },
300	                    "min_hardware_version": {"type": "integer"},
301	                    "max_hardware_version": {"type": "integer"},
302	                    "min_current_file_version": {"type": "integer"},
303	                    "max_current_file_version": {"type": "integer"},
304	                    "specificity": {"type": "integer"},
305	                },
306	                "required": [
307	                    # "binary_url",
308	                    # "path",
309	                    "file_version",
310	                    "file_size",
311	                    "image_type",
312	                    # "manufacturer_names",
313	                    # "model_names",
314	                    "manufacturer_id",
315	                    # "changelog",
316	                    "checksum",
317	                    # "min_hardware_version",
318	                    # "max_hardware_version",
319	                    # "min_current_file_version",
320	                    # "max_current_file_version",
321	                    # "release_notes",
322	                    # "specificity",
323	                ],
324	            },
325	        }
326	    },
327	    "required": ["firmwares"],
328	}
329	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
100	            async with req.get(self.url, ssl=self.ssl_ctx) as rsp:
101	                return await rsp.read()
102	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
120	            async with req.get(self.url, ssl=Tradfri.SSL_CTX) as rsp:
121	                return await rsp.read()
122	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
229	    MANUFACTURER_IDS = (4476,)
230	    DEFAULT_URL = "https://fw.ota.homesmart.ikea.com/DIRIGERA/version_info.json"
231	    VOL_SCHEMA = zigpy.config.SCHEMA_OTA_PROVIDER_URL

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
314	    MANUFACTURER_IDS = (4489, 4364)
315	    DEFAULT_URL = "https://api.update.ledvance.com/v1/zigbee/firmwares"
316	    JSON_SCHEMA = json_schemas.LEDVANCE_SCHEMA

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
338	                url=(
339	                    "https://api.update.ledvance.com/v1/zigbee/firmwares/download?"
340	                    + urllib.parse.urlencode(
341	                        {
342	                            "Company": identity["company"],
343	                            "Product": identity["product"],
344	                            "Version": (
345	                                f"{version['major']}.{version['minor']}"
346	                                f".{version['build']}.{version['revision']}"
347	                            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
382	        async with session.get(
383	            "https://zigbee-ota.sonoff.tech/releases/upgrade.json"
384	        ) as rsp:
385	            fw_lst = await rsp.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
412	        async with session.get(
413	            "https://files.inovelli.com/firmware/firmware-zha-v2.json"
414	        ) as rsp:
415	            fw_lst = await rsp.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
447	    ) -> typing.AsyncIterator[BaseOtaImageMetadata]:
448	        async with session.get("https://tr-zha.s3.amazonaws.com/firmware.json") as rsp:
449	            fw_lst = await rsp.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zigpy-0.78.0/zigpy-0.78.0/zigpy/ota/providers.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
630	    DEFAULT_URL = (
631	        "https://raw.githubusercontent.com/Koenkk/zigbee-OTA/master/index.json"
632	    )
633	    VOL_SCHEMA = zigpy.config.SCHEMA_OTA_PROVIDER_URL
634	

--------------------------------------------------

Code scanned:
	Total lines of code: 33598
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 3.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 0.0
Files skipped (0):
