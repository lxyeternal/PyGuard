Run started:2025-04-12 17:16:38.481903

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/__init__.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	        "name": "Monte Carlo",
7	        "description": "`Monte Carlo <https://www.montecarlodata.com/>`__\n",
8	        "connection-types": [
9	            {
10	                "hook-class-name": "airflow_mcd.hooks.SessionHook",
11	                "connection-type": "mcd",
12	            },
13	            {
14	                "hook-class-name": "airflow_mcd.hooks.GatewaySessionHook",
15	                "connection-type": "mcd_gateway",
16	            },
17	        ],
18	        "hook-class-names": [
19	            "airflow_mcd.hooks.SessionHook",
20	            "airflow_mcd.hooks.GatewaySessionHook",
21	        ],
22	        "package-name": "airflow-mcd",
23	    }
24	
25	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/callbacks/client.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	    for env_var in _ENV_MAPPINGS[key]:
47	        value = os.environ.get(env_var)
48	        if value:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/callbacks/client.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
266	            logger.info(f"Sending MC Callback information to Gateway, operation={operation_name}")
267	            mc_client.make_request(path=_INTEGRATION_GATEWAY_PATH, body=body, timeout_in_seconds=self.mcd_call_timeout,
268	                                   should_retry=self._should_retry)
269	        except HTTPError as exc:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/callbacks/client.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
271	                logger.warning(
272	                    "MCD Gateway authentication failed, please check you created an "
273	                    "Airflow Integration Key following the docs at "
274	                    "https://docs.getmontecarlo.com/docs/airflow-incidents-dags-and-tasks"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/hooks/gateway_session_hook.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
32	            }
33	            json_response = mc_client.make_request(path=_INTEGRATION_GATEWAY_PATH, body=body)
34	            success = json_response.get("success", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/hooks/gateway_session_hook.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	            json_response = mc_client.make_request(path=_INTEGRATION_GATEWAY_PATH, body=body)
34	            success = json_response.get("success", False)
35	            resource_ids = json_response.get("resource_ids", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/hooks/gateway_session_hook.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	            success = json_response.get("success", False)
35	            resource_ids = json_response.get("resource_ids", [])
36	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/hooks/gateway_session_hook.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	                return False, (
45	                    "Authentication failed, please check you created an Airflow Integration Key following "
46	                    "the docs at https://docs.getmontecarlo.com/docs/airflow-incidents-dags-and-tasks"
47	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/airflow_mcd/operators/dbt.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
319	            if log_file:
320	                log_file.write(line)
321	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    author_email='info@montecarlodata.com',
26	    url='https://www.montecarlodata.com/',
27	    packages=find_packages(exclude=['tests*', 'examples*']),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/tests/callbacks/test_callbacks.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
404	            "state": state,
405	            "log_url": f"http://airflow.com/{dag.dag_id}/{task_instance.task_id}/log",
406	            "execution_date": task_instance.execution_date.isoformat() if set_dates else now_isoformat,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/tests/callbacks/test_callbacks.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
454	        task_instance.state = state
455	        task_instance.log_url = f"http://airflow.com/{dag_id}/{task_instance.task_id}/log"
456	        task_instance.prev_attempted_tries = 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/tests/hooks/test_session_hook.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    def test_get_conn_with_non_default_host(self, get_connection_mock, session_mock):
51	        host = 'http://localhost:8080'
52	        get_connection_mock.return_value = Connection(host=host, login=SAMPLE_ID, password=SAMPLE_TOKEN)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/tests/hooks/test_session_hook.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    def test_get_conn_with_non_default_host_including_path(self, get_connection_mock, session_mock):
67	        host = 'http://localhost:8080/graphql'
68	        get_connection_mock.return_value = Connection(host=host, login=SAMPLE_ID, password=SAMPLE_TOKEN)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/tests/hooks/test_session_hook.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	    def test_get_gw_conn(self, mock_request, get_connection_mock, session_mock):
92	        host = "https://integrations.getmontecarlo.com"
93	        # when path is not specified, we initialize the session with /graphql, but that's ignored
94	        # later in make_request
95	        self._test_gw_conn(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/tests/hooks/test_session_hook.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	            session_mock,
111	            "https://integrations.getmontecarlo.com/"
112	        )
113	
114	    @patch("airflow_mcd.hooks.session_hook.Session")
115	    @patch.object(SessionHook, "get_connection")
116	    @patch("requests.request")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/tests/hooks/test_session_hook.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	            session_mock,
122	            "https://integrations.getmontecarlo.com/ignored/path"
123	        )
124	
125	    def _test_gw_conn(
126	        self,
127	        mock_request: Mock,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_mcd-0.3.7/airflow_mcd-0.3.7/tests/hooks/test_session_hook.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	        mock_request.assert_called_once_with(
149	            url='https://integrations.getmontecarlo.com/airflow/callbacks',
150	            method='POST',

--------------------------------------------------

Code scanned:
	Total lines of code: 2574
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 0.0
Files skipped (0):
