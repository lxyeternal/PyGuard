Run started:2025-04-12 13:04:03.942984

Test results:
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/deps/horovod/distributed_utils_horovod.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
29	def find_free_port():
30	    with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
31	        s.bind(("", 0))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/deps/neural_compressor/tensorflow/quantization.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	            invalidInputError(model.inputs is not None and model.outputs is not None,
69	                              "A keras.Model for quantization must include Input layers. "
70	                              "Please create the model by functional API"
71	                              " keras.Model(inputs=.., outputs=..).\n"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/deps/ray/ray_envbase.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
56	        """The main address through which all processes connect and communicate."""
57	        return os.environ.get("MASTER_ADDR", "127.0.0.1")
58	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/diffusion/common/optimize.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
409	            print(f"Deleting the deprecated unet...")
410	            shutil.rmtree(unet_cache_path)
411	        shutil.move(cache_path, unet_cache_path)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/k8s/bigdl_submit.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        default=[],
64	        help="pass environment variable to be set in all pods, "
65	             "such as --env http_proxy http://host:port"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/__init__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
37	# reset the num of threads
38	if platform.system() == "Linux":
39	    # only UNIX-like system applied

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/__init__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
37	# reset the num of threads
38	if platform.system() == "Linux":
39	    # only UNIX-like system applied

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/__init__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
37	# reset the num of threads
38	if platform.system() == "Linux":
39	    # only UNIX-like system applied

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/amp/bfloat16.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
99	        with open(dnnl_log_file, "r") as f:
100	            dnnl_log = f.read()
101	        if os.path.exists(dnnl_log_file):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/encryption/encryption.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	        encrypted_content = self.secret_key.encrypt(content)
42	        encrypted_buffer.write(encrypted_content)
43	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/encryption/encryption.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
45	        decrypted_content = self.secret_key.decrypt(buffer.getvalue())
46	        decrypted_buffer.write(decrypted_content)
47	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/encryption/encryption.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	    with _open_file_or_buffer(f, 'wb') as opened_file:
113	        opened_file.write(encrypted_buffer.getvalue())
114	    buffer.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/encryption/encryption.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
136	        if _is_path(f):
137	            buf = io.BytesIO(opened_file.read())
138	            decryptor.decrypt_buffer(buf, decrypted_buf)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/inference/optimizer.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
575	            with open(output_filename, "w") as f:
576	                f.write(self._optimize_result)
577	        print(self._optimize_result)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/inference/optimizer.py:1383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
1382	            with EnvContext(envs[i]):
1383	                p = mp.Process(target=_multi_instance_helper,
1384	                               args=(model, send_queue, recv_queue, next_idx), daemon=True)
1385	                p.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/inference/pipeline.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
119	            with EnvContext(env=subprocess_env):
120	                p = mp.Process(target=self._stage_wrapper,
121	                               args=(func, recv_, send_),
122	                               daemon=True)
123	                p.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/strategies/ddp_spawn.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
118	                error_queue = mp.SimpleQueue()
119	                process = mp.Process(   # type: ignore
120	                    target=self._wrap,
121	                    args=(self._wrapping_function, i, args, error_queue, patch_status),
122	                    daemon=False,
123	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/vision/datasets/datasets.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	        with open(path, 'rb') as fd:
66	            img_str = fd.read()
67	        return img_str

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/vision/datasets/datasets.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        else:
81	            img = cv2.imread(path)
82	        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/vision/datasets/datasets.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
141	            with open(img_path, 'rb') as fd:
142	                img = self.jpeg.decode(fd.read())
143	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/vision/datasets/datasets.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
143	        else:
144	            img = cv2.imread(img_path)
145	        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/vision/datasets/datasets.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	            with open(mask_path, 'rb') as fd:
149	                mask = self.jpeg.decode(fd.read(), pixel_format=TJPF_GRAY)
150	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/vision/datasets/datasets.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	        else:
151	            mask = cv2.imread(mask_path, cv2.IMREAD_GRAYSCALE)
152	        mask = np.array(mask)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/vision/datasets/oxfordpet_datasets.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
85	        fd = open(path, 'rb')
86	        img_str = fd.read()
87	        fd.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/pytorch/vision/datasets/oxfordpet_datasets.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	            else:
119	                img = cv2.imread(path)
120	            img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/__init__.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
23	# reset the num of threads
24	if platform.system() == "Linux":
25	    # only UNIX-like system applied

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/__init__.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
23	# reset the num of threads
24	if platform.system() == "Linux":
25	    # only UNIX-like system applied

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/__init__.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
23	# reset the num of threads
24	if platform.system() == "Linux":
25	    # only UNIX-like system applied

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/__init__.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
35	
36	if platform.system() != "Darwin":
37	    # set tf settings

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/__init__.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
35	
36	if platform.system() != "Darwin":
37	    # set tf settings

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/__init__.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
35	
36	if platform.system() != "Darwin":
37	    # set tf settings

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/keras/customized_training_utils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	                if isinstance(arg, tf.data.Dataset):
110	                    warnings.warn('If dataset is created by `from_generator`, please initiate '
111	                                  '`_GeneratorState` of the dataset first, that is '

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/keras/distributed_utils.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
28	def _find_free_port():
29	    with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
30	        s.bind(("", 0))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/keras/inference/optimizer.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
346	            with open(output_filename, "w") as f:
347	                f.write(self._optimize_result)
348	        print(self._optimize_result)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/tf/keras/inference/optimizer.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
346	            with open(output_filename, "w") as f:
347	                f.write(self._optimize_result)
348	        print(self._optimize_result)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/utils/common/schedule.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
48	    get_socket = {}
49	    if platform.system() == "Windows":
50	        get_physical_core_args = ["wmic", "CPU",

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/utils/common/schedule.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
48	    get_socket = {}
49	    if platform.system() == "Windows":
50	        get_physical_core_args = ["wmic", "CPU",

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/utils/common/schedule.py:49
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
48	    get_socket = {}
49	    if platform.system() == "Windows":
50	        get_physical_core_args = ["wmic", "CPU",

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/utils/common/schedule.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
62	            get_socket[i] = 0
63	    elif platform.system() == "Darwin":
64	        # We cannot query which cores are physical cores on MacOS,

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/utils/common/schedule.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
62	            get_socket[i] = 0
63	    elif platform.system() == "Darwin":
64	        # We cannot query which cores are physical cores on MacOS,

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/utils/common/schedule.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
62	            get_socket[i] = 0
63	    elif platform.system() == "Darwin":
64	        # We cannot query which cores are physical cores on MacOS,

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/utils/common/subprocess.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
85	            new_func = _append_return_to_pipe(self.func)
86	            p = Process(target=new_func, args=(q,) + args, kwargs=kwargs)
87	            p.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigdl_nano-2.5.0b20240324-py3-none-win_amd64/bigdl/nano/utils/pytorch/check_deps.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	            invalidInputError(False,
43	                              f"Failed to import {pkg_name}, "
44	                              "maybe you should install it first: "

--------------------------------------------------

Code scanned:
	Total lines of code: 17123
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 31.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 7.0
Files skipped (0):
