Run started:2025-04-12 13:23:47.197822

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/__init__.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	
27	BASE_URL_DEFAULT = "https://api.evervault.com/"
28	RELAY_URL_DEFAULT = "https://relay.evervault.com:443"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/__init__.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	BASE_URL_DEFAULT = "https://api.evervault.com/"
28	RELAY_URL_DEFAULT = "https://relay.evervault.com:443"
29	CA_HOST_DEFAULT = "https://ca.evervault.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/__init__.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	RELAY_URL_DEFAULT = "https://relay.evervault.com:443"
29	CA_HOST_DEFAULT = "https://ca.evervault.com"
30	CAGES_HOST_DEFAULT = "cage.evervault.com"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	
45	        pcrs_from_manager = self.pcr_manager.get(cage_name)
46	        expected_pcrs = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	                    evervault_attestation_bindings.PCRs(
52	                        pcrs.get("pcr_0"),
53	                        pcrs.get("pcr_1"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	                        pcrs.get("pcr_0"),
53	                        pcrs.get("pcr_1"),
54	                        pcrs.get("pcr_2"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	                        pcrs.get("pcr_1"),
54	                        pcrs.get("pcr_2"),
55	                        pcrs.get("pcr_8"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	                        pcrs.get("pcr_2"),
55	                        pcrs.get("pcr_8"),
56	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	        def attest_cage(cage_name, cache, cert, expected_pcrs):
64	            attestation_doc = cache.get(cage_name)
65	            attestation_doc_bytes = base64.b64decode(attestation_doc)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
64	            attestation_doc = cache.get(cage_name)
65	            attestation_doc_bytes = base64.b64decode(attestation_doc)
66	            evervault_attestation_bindings.attest_cage(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
64	            attestation_doc = cache.get(cage_name)
65	            attestation_doc_bytes = base64.b64decode(attestation_doc)
66	            evervault_attestation_bindings.attest_cage(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
92	    def request(self, *args, headers={}, **kwargs):
93	        return super().request(*args, headers=headers, **kwargs)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/cages_v2.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
92	    def request(self, *args, headers={}, **kwargs):
93	        return super().request(*args, headers=headers, **kwargs)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/client.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        request_timeout=30,
22	        base_url="https://api.evervault.com/",
23	        relay_url="https://relay.evervault.com:443",
24	        ca_host="https://ca.evervault.com",
25	        retry=False,
26	        curve="SECP256K1",
27	        max_file_size_in_mb=25,
28	    ):
29	        self.app_uuid = app_uuid
30	        self.api_key = api_key
31	        self.base_url = base_url
32	        self.relay_url = relay_url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/client.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        base_url="https://api.evervault.com/",
23	        relay_url="https://relay.evervault.com:443",
24	        ca_host="https://ca.evervault.com",
25	        retry=False,
26	        curve="SECP256K1",
27	        max_file_size_in_mb=25,
28	    ):
29	        self.app_uuid = app_uuid
30	        self.api_key = api_key
31	        self.base_url = base_url
32	        self.relay_url = relay_url
33	        self.ca_host = ca_host

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/client.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        relay_url="https://relay.evervault.com:443",
24	        ca_host="https://ca.evervault.com",
25	        retry=False,
26	        curve="SECP256K1",
27	        max_file_size_in_mb=25,
28	    ):
29	        self.app_uuid = app_uuid
30	        self.api_key = api_key
31	        self.base_url = base_url
32	        self.relay_url = relay_url
33	        self.ca_host = ca_host
34	        request = Request(self.app_uuid, self.api_key, request_timeout, retry)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/crypto/client.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
153	            header_type,
154	            base64.b64encode(iv).decode("utf"),
155	            base64.b64encode(self.compressed_public_key).decode("utf"),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/crypto/client.py:154
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
153	            header_type,
154	            base64.b64encode(iv).decode("utf"),
155	            base64.b64encode(self.compressed_public_key).decode("utf"),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/crypto/client.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
154	            base64.b64encode(iv).decode("utf"),
155	            base64.b64encode(self.compressed_public_key).decode("utf"),
156	            base64.b64encode(encrypted_bytes).decode("utf"),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/crypto/client.py:155
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
154	            base64.b64encode(iv).decode("utf"),
155	            base64.b64encode(self.compressed_public_key).decode("utf"),
156	            base64.b64encode(encrypted_bytes).decode("utf"),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/crypto/client.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
155	            base64.b64encode(self.compressed_public_key).decode("utf"),
156	            base64.b64encode(encrypted_bytes).decode("utf"),
157	            has_role,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/crypto/client.py:156
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
155	            base64.b64encode(self.compressed_public_key).decode("utf"),
156	            base64.b64encode(encrypted_bytes).decode("utf"),
157	            has_role,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/crypto/client.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
266	            key_name = "ecdhKey" if self.curve == "SECP256K1" else "ecdhP256Key"
267	            self.decoded_team_cage_key = base64.b64decode(resp[key_name])
268	            self.team_ecdh_key = EllipticCurvePublicKey.from_encoded_point(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/crypto/client.py:267
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
266	            key_name = "ecdhKey" if self.curve == "SECP256K1" else "ecdhP256Key"
267	            self.decoded_team_cage_key = base64.b64decode(resp[key_name])
268	            self.team_ecdh_key = EllipticCurvePublicKey.from_encoded_point(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	
43	        pcrs_from_manager = self.pcr_manager.get(enclave_name)
44	        expected_pcrs = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	                    evervault_attestation_bindings.PCRs(
50	                        pcrs.get("pcr_0"),
51	                        pcrs.get("pcr_1"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	                        pcrs.get("pcr_0"),
51	                        pcrs.get("pcr_1"),
52	                        pcrs.get("pcr_2"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	                        pcrs.get("pcr_1"),
52	                        pcrs.get("pcr_2"),
53	                        pcrs.get("pcr_8"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	                        pcrs.get("pcr_2"),
53	                        pcrs.get("pcr_8"),
54	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	        def attest_enclave(enclave_name, cache, cert, expected_pcrs):
62	            attestation_doc = cache.get(enclave_name)
63	            attestation_doc_bytes = base64.b64decode(attestation_doc)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
62	            attestation_doc = cache.get(enclave_name)
63	            attestation_doc_bytes = base64.b64decode(attestation_doc)
64	            evervault_attestation_bindings.attest_enclave(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
62	            attestation_doc = cache.get(enclave_name)
63	            attestation_doc_bytes = base64.b64decode(attestation_doc)
64	            evervault_attestation_bindings.attest_enclave(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
90	    def request(self, *args, headers={}, **kwargs):
91	        return super().request(*args, headers=headers, **kwargs)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/enclaves.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
90	    def request(self, *args, headers={}, **kwargs):
91	        return super().request(*args, headers=headers, **kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/attestationdoc.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	            url = self.__get_url(name, self.host)
66	            res = requests.get(url)
67	            body = res.json()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/request.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
60	            request_object.mount("http://", adapter)
61	        resp = self.__execute_request(request_object, method, url, req_params)
62	        if _is_ca:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/request.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
87	            auth_value = f"{self.app_uuid}:{self.api_key}"
88	            encoded_auth_value_bytes = base64.b64encode(auth_value.encode("ascii"))
89	            basic_auth_str = f"Basic {encoded_auth_value_bytes.decode('utf-8')}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/request.py:88
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
87	            auth_value = f"{self.app_uuid}:{self.api_key}"
88	            encoded_auth_value_bytes = base64.b64encode(auth_value.encode("ascii"))
89	            basic_auth_str = f"Basic {encoded_auth_value_bytes.decode('utf-8')}"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/request.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
107	    def __execute_request(self, request_object, method, url, req_params):
108	        return request_object.request(
109	            method,
110	            url,
111	            timeout=self.timeout,
112	            verify=certifi.where(),
113	            allow_redirects=False,
114	            **req_params,
115	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/requestintercept.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
116	
117	            return old_request(method, str_or_url, **kwargs)
118	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/requestintercept.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
116	
117	            return old_request(method, str_or_url, **kwargs)
118	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/requestintercept.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
207	            try:
208	                ca_content = self.request.make_request(
209	                    "GET", self.ca_host, {}, _is_ca=True
210	                ).content

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/requestintercept.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
207	            try:
208	                ca_content = self.request.make_request(
209	                    "GET", self.ca_host, {}, _is_ca=True
210	                ).content

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/evervault-4.4.2/evervault-4.4.2/evervault/http/requestintercept.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
222	            with tempfile.NamedTemporaryFile(delete=False) as cert_file:
223	                cert_file.write(bytes(certifi.contents(), "ascii") + ca_content)
224	                self.cert_path = cert_file.name

--------------------------------------------------

Code scanned:
	Total lines of code: 1494
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 31.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 7.0
Files skipped (0):
