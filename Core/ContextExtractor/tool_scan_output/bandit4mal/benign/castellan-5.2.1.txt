Run started:2025-04-12 13:14:13.282464

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/barbican_key_manager.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    cfg.StrOpt('barbican_endpoint',
47	               help='Use this endpoint to connect to Barbican, for example: '
48	                    '"http://localhost:9311/"'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/barbican_key_manager.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    cfg.StrOpt('auth_endpoint',
52	               default='http://localhost/identity/v3',
53	               deprecated_name='auth_url',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/vault_key_manager.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	
41	_DEFAULT_VAULT_URL = "http://127.0.0.1:8200"
42	_DEFAULT_MOUNTPOINT = "secret"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/vault_key_manager.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
170	            try:
171	                resp = self._session.post(url=approle_login_url,
172	                                          json=params,
173	                                          headers=headers,
174	                                          verify=self._verify_server,
175	                                          timeout=self._timeout)
176	            except requests.exceptions.Timeout as ex:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/vault_key_manager.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	
269	        type_value = self._secret_type_dict.get(type(value))
270	        if type_value is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/vault_key_manager.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
286	
287	        self._do_http_request(self._session.post,
288	                              self._get_resource_url(key_id),
289	                              json=record)
290	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/vault_key_manager.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
321	
322	        resp = self._do_http_request(self._session.get,
323	                                     self._get_resource_url(key_id))
324	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/vault_key_manager.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
365	
366	        resp = self._do_http_request(self._session.delete,
367	                                     self._get_resource_url(key_id))
368	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/vault_key_manager.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
388	
389	        resp = self._do_http_request(self._session.get,
390	                                     self._get_resource_url())
391	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/key_manager/vault_key_manager.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	            try:
400	                obj = self.get(context, obj_id, metadata_only=metadata_only)
401	                if object_type is None or isinstance(obj, object_type):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/functional/config.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    cfg.StrOpt('auth_url',
25	               default='http://localhost/identity/v3',
26	               help='Keystone endpoint'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/functional/key_manager/test_vault_key_manager.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	    def _mount_kv(self, vault_mountpoint):
119	        backends = self.session.get(
120	            '{}/v1/sys/mounts'.format(self.vault_url)).json()
121	        if vault_mountpoint not in backends:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/functional/key_manager/test_vault_key_manager.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
127	            }
128	            self.session.post(
129	                '{}/v1/sys/mounts/{}'.format(self.vault_url,
130	                                             vault_mountpoint),
131	                json=params)
132	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/functional/key_manager/test_vault_key_manager.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
136	        }
137	        self.session.post(
138	            '{}/{}'.format(
139	                self.vault_url,
140	                AUTH_ENDPOINT.format(auth_type='approle')
141	            ),
142	            json=params,
143	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/functional/key_manager/test_vault_key_manager.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
164	        }
165	        self.session.post(
166	            '{}/{}'.format(
167	                self.vault_url,
168	                APPROLE_ENDPOINT.format(role_name=vault_approle)
169	            ),
170	            json=params,
171	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/functional/key_manager/test_vault_key_manager.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	        approle_role_id = (
175	            self.session.get(
176	                '{}/v1/auth/approle/role/{}/role-id'.format(
177	                    self.vault_url,
178	                    vault_approle
179	                )).json()['data']['role_id']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/functional/key_manager/test_vault_key_manager.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
181	        approle_secret_id = (
182	            self.session.post(
183	                '{}/v1/auth/approle/role/{}/secret-id'.format(
184	                    self.vault_url,
185	                    vault_approle
186	                )).json()['data']['secret_id']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        self.key_id = "d152fa13-2b41-42ca-a934-6c21566c0f40"
54	        self.secret_ref = ("http://host:9311/v1/secrets/" + self.key_id)
55	        self.pre_hex = "AIDxQp2++uAbKaTVDMXFYIu8PIugJGqkK0JLqkU0rhY="

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	                    "534ae16")
58	        self.key_mgr._base_url = "http://host:9311/v1/"
59	
60	        self.key_mgr.conf.barbican.number_of_retries = 3

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        endpoint_data = mock.Mock()
92	        endpoint_data.url = 'http://localhost:9311'
93	
94	        auth = mock.Mock(spec=['service_catalog'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	        endpoint = self.key_mgr._get_barbican_endpoint(auth, mock.Mock())
98	        self.assertEqual(endpoint, 'http://localhost:9311')
99	        auth.service_catalog.endpoint_data_for.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	        endpoint_data = mock.Mock()
107	        endpoint_data.url = 'http://localhost:9311'
108	
109	        auth = mock.Mock(spec=['service_catalog'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	        endpoint = self.key_mgr._get_barbican_endpoint(auth, mock.Mock())
113	        self.assertEqual(endpoint, 'http://localhost:9311')
114	        auth.service_catalog.endpoint_data_for.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	        endpoint_data = mock.Mock()
122	        endpoint_data.url = 'http://localhost:9311'
123	
124	        auth = mock.Mock(spec=['service_catalog'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	        endpoint = self.key_mgr._get_barbican_endpoint(auth, mock.Mock())
128	        self.assertEqual(endpoint, 'http://localhost:9311')
129	        auth.service_catalog.endpoint_data_for.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	    def test_barbican_endpoint_from_config(self):
134	        self.key_mgr.conf.barbican.barbican_endpoint = 'http://localhost:9311'
135	
136	        endpoint = self.key_mgr._get_barbican_endpoint(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	            mock.Mock(), mock.Mock())
138	        self.assertEqual(endpoint, 'http://localhost:9311')
139	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	        sess = mock.Mock()
143	        auth.get_endpoint = mock.Mock(return_value='http://localhost:9311')
144	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        endpoint = self.key_mgr._get_barbican_endpoint(auth, sess)
146	        self.assertEqual(endpoint, 'http://localhost:9311')
147	        auth.get_endpoint.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	        sess = mock.Mock()
156	        auth.get_endpoint = mock.Mock(return_value='http://localhost:9311')
157	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	        endpoint = self.key_mgr._get_barbican_endpoint(auth, sess)
159	        self.assertEqual(endpoint, 'http://localhost:9311')
160	        auth.get_endpoint.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	        sess = mock.Mock()
169	        auth.get_endpoint = mock.Mock(return_value='http://localhost:9311')
170	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	        endpoint = self.key_mgr._get_barbican_endpoint(auth, sess)
172	        self.assertEqual(endpoint, 'http://localhost:9311')
173	        auth.get_endpoint.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	        self.key_mgr.conf.barbican.barbican_api_version = version
189	        endpoint = "http://localhost:9311"
190	        base_url = self.key_mgr._create_base_url(mock.Mock(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	        self.key_mgr.conf.barbican.barbican_api_version = version
198	        endpoint = "http://localhost/key_manager"
199	        base_url = self.key_mgr._create_base_url(mock.Mock(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	
211	        endpoint = "http://localhost/key_manager"
212	
213	        base_url = self.key_mgr._create_base_url(auth,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
229	
230	        endpoint = "http://localhost/key_manager"
231	
232	        base_url = self.key_mgr._create_base_url(auth,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
248	
249	        endpoint = "http://localhost/key_manager"
250	
251	        base_url = self.key_mgr._create_base_url(auth,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	
266	        endpoint = "http://localhost/key_manager"
267	
268	        self.assertRaises(exception.KeyManagerError,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	
282	        endpoint = "http://localhost/key_manager"
283	
284	        base_url = self.key_mgr._create_base_url(auth,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
292	        # Create order_ref_url and assign return value
293	        order_ref_url = ("http://localhost:9311/v1/orders/"
294	                         "4fe939b7-72bc-49aa-bd1e-e979589858af")
295	        key_order = mock.Mock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
327	        # Create order_ref_url and assign return value
328	        order_ref_url = ("http://localhost:9311/v1/orders/"
329	                         "f45bf211-a917-4ead-9aec-1c91e52609df")
330	        asym_order = mock.Mock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	        container_id = "16caa8f4-dd34-4fb3-bf67-6c20533a30e4"
337	        container_ref = ("http://localhost:9311/v1/containers/" + container_id)
338	        order.container_ref = container_ref

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
344	        public_key_id = "43ed09c3-e551-4c24-b612-e619abe9b534"
345	        pub_key_ref = ("http://localhost:9311/v1/secrets/" + public_key_id)
346	        private_key_id = "32a0bc60-4e10-4269-9f17-f49767e99586"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
346	        private_key_id = "32a0bc60-4e10-4269-9f17-f49767e99586"
347	        priv_key_ref = ("http://localhost:9311/v1/secrets/" + private_key_id)
348	        container.secret_refs = {'public_key': pub_key_ref,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
427	        key_id = "43ed09c3-e551-4c24-b612-e619abe9b534"
428	        key_ref = ("http://localhost:9311/v1/secrets/" + key_id)
429	        original_secret_metadata.secret_ref = key_ref

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
530	    def test_get_active_order(self):
531	        order_ref_url = ("http://localhost:9311/v1/orders/"
532	                         "4fe939b7-72bc-49aa-bd1e-e979589858af")
533	
534	        pending_order = mock.Mock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
553	    def test_get_active_order_timeout(self):
554	        order_ref_url = ("http://localhost:9311/v1/orders/"
555	                         "4fe939b7-72bc-49aa-bd1e-e979589858af")
556	
557	        number_of_retries = self.key_mgr.conf.barbican.number_of_retries

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
573	    def test_get_active_order_error(self):
574	        order_ref_url = ("http://localhost:9311/v1/orders/"
575	                         "4fe939b7-72bc-49aa-bd1e-e979589858af")
576	
577	        error_order = mock.Mock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_barbican_key_manager.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
603	        key_id = "43ed09c3-e551-4c24-b612-e619abe9b534"
604	        key_ref = ("http://localhost:9311/v1/secrets/" + key_id)
605	        original_secret_metadata.secret_ref = key_ref

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_vault_key_manager.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	        self.key_mgr._approle_secret_id = "secret"
48	        m.post(
49	            "http://127.0.0.1:8200/v1/auth/approle/login",
50	            json={"auth": {"client_token": "token", "lease_duration": 3600}}
51	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_vault_key_manager.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	        m.post(
49	            "http://127.0.0.1:8200/v1/auth/approle/login",
50	            json={"auth": {"client_token": "token", "lease_duration": 3600}}
51	        )
52	        expected_headers = {"X-Vault-Token": "token"}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_vault_key_manager.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
59	        self.key_mgr._namespace = "ham"
60	        m.post(
61	            "http://127.0.0.1:8200/v1/auth/approle/login",
62	            json={"auth": {"client_token": "token", "lease_duration": 3600}}
63	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/key_manager/test_vault_key_manager.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        m.post(
61	            "http://127.0.0.1:8200/v1/auth/approle/login",
62	            json={"auth": {"client_token": "token", "lease_duration": 3600}}
63	        )
64	        expected_headers = {"X-Vault-Token": "token",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/test_config_driver.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	        with tempfile.NamedTemporaryFile() as config_file:
81	            config_file.write(config.encode("utf-8"))
82	            config_file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/test_config_driver.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
80	        with tempfile.NamedTemporaryFile() as config_file:
81	            config_file.write(config.encode("utf-8"))
82	            config_file.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/test_config_driver.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	            with tempfile.NamedTemporaryFile() as mapping_file:
85	                mapping_file.write(mapping.encode("utf-8"))
86	                mapping_file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/test_config_driver.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
84	            with tempfile.NamedTemporaryFile() as mapping_file:
85	                mapping_file.write(mapping.encode("utf-8"))
86	                mapping_file.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/test_options.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	
40	        barbican_endpoint = 'http://test-server.org:9311/'
41	        options.set_defaults(conf, barbican_endpoint=barbican_endpoint)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/castellan-5.2.1/castellan-5.2.1/castellan/tests/unit/test_options.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	
50	        auth_endpoint = 'http://test-server.org/identity'
51	        options.set_defaults(conf, auth_endpoint=auth_endpoint)

--------------------------------------------------

Code scanned:
	Total lines of code: 6076
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 60.0
		High: 0.0
Files skipped (0):
