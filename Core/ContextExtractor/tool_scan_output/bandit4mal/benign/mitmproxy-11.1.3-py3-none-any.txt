Run started:2025-04-12 12:12:29.669591

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addonmanager.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	                    logger.warning(
181	                        f"{msg}. For more details, see https://docs.mitmproxy.org/dev/addons-api-changelog/."
182	                    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/browser.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
88	                    "--proxy-server={}:{}".format(
89	                        ctx.options.listen_host or "127.0.0.1",
90	                        ctx.options.listen_port or "8080",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/browser.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
121	
122	        host = ctx.options.listen_host or "127.0.0.1"
123	        port = ctx.options.listen_port or 8080

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/command_history.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
58	                with self.history_file.open("a") as f:
59	                    f.write(f"{command}\n")
60	            except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/cut.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	                        # We're appending to a file that already exists and has content
128	                        fp.write(b"\n")
129	                    v = extract(cuts[0], flows[0])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/cut.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
130	                    if isinstance(v, bytes):
131	                        fp.write(v)
132	                    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/cut.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	                    else:
133	                        fp.write(v.encode("utf8"))
134	                logger.log(ALERT, "Saved single cut.")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/cut.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	            v = extract_str(cuts[0], flows[0])
165	            fp.write(v)
166	            logger.log(ALERT, "Clipped single cut.")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/dns_resolver.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
107	                    isinstance(flow.client_conn.proxy_mode, mode_specs.WireGuardMode)
108	                    and flow.server_conn.address == ("10.0.0.53", 53)
109	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/export.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
63	def curl_command(f: flow.Flow) -> str:
64	    request = cleanup_request(f)
65	    request = pop_headers(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/export.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
96	def httpie_command(f: flow.Flow) -> str:
97	    request = cleanup_request(f)
98	    request = pop_headers(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/export.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
114	def raw_request(f: flow.Flow) -> bytes:
115	    request = cleanup_request(f)
116	    if request.raw_content is None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/export.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
117	        raise exceptions.CommandError("Request content missing.")
118	    return assemble.assemble_request(request)
119	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/export.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
139	    if request_present and response_present:
140	        parts = [raw_request(f), raw_response(f)]
141	        if isinstance(f, http.HTTPFlow) and f.websocket:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/export.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
144	    elif request_present:
145	        return raw_request(f)
146	    elif response_present:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/next_layer.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
216	            context.client.proxy_mode, mode_specs.WireGuardMode
217	        ) and context.server.address == ("10.0.0.53", 53):
218	            return False

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/onboardingapp/__init__.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
44	    with open(p, "rb") as f:
45	        cert = f.read()
46	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/onboardingapp/__init__.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	    with open(p, "rb") as f:
58	        cert = f.read()
59	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/proxyserver.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
85	            # Notify listeners about the new not-yet-started servers.
86	            await self.changed.send()
87	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/proxyserver.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
97	
98	        await self.changed.send()
99	        return all_ok

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/proxyserver.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
272	                (host, port, _) = collections.Counter(listen_addrs).most_common(1)[0][0]
273	                dup_addr = human.format_address((host or "0.0.0.0", port))
274	                raise exceptions.OptionsError(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/proxyserver.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
373	                    connect_port == listen_port
374	                    and connect_host in ("localhost", "127.0.0.1", "::1", listen_host)
375	                    and server.mode.transport_protocol == data.server.transport_protocol

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/readfile.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
78	            self._read_task = asyncio_utils.create_task(
79	                self.doread(ctx.options.rfile),
80	                name="readfile",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/save.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	            # No normal logging here, that would not be triggered anymore.
117	            sys.stderr.write(f"Error while writing to {self.current_path}: {e}")
118	            sys.exit(1)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/savehar.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
205	            if content and strutils.is_mostly_bin(content):
206	                response["content"]["text"] = base64.b64encode(content).decode()
207	                response["content"]["encoding"] = "base64"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/savehar.py:206
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
205	            if content and strutils.is_mostly_bin(content):
206	                response["content"]["text"] = base64.b64encode(content).decode()
207	                response["content"]["encoding"] = "base64"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/savehar.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
272	                else:
273	                    data = base64.b64encode(message.content).decode()
274	                websocket_message = {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/savehar.py:273
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
272	                else:
273	                    data = base64.b64encode(message.content).decode()
274	                websocket_message = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/script.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	            e.msg += (
44	                f".\n"
45	                f"Note that mitmproxy's binaries include their own Python environment. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/server_side_events.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	            logging.warning(
21	                "mitmproxy currently does not support server side events. As a workaround, you can enable response "
22	                "streaming for such flows: https://github.com/mitmproxy/mitmproxy/issues/4469"
23	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/tlsconfig.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
489	                logger.warning(
490	                    "The mitmproxy certificate authority has expired!\n"
491	                    "Please delete all CA-related files in your ~/.mitmproxy folder.\n"
492	                    "The CA will be regenerated automatically after restarting mitmproxy.\n"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/upstream_auth.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
15	        raise exceptions.OptionsError("Invalid upstream auth specification: %s" % auth)
16	    return b"Basic" + b" " + base64.b64encode(strutils.always_bytes(auth))
17	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/addons/upstream_auth.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
15	        raise exceptions.OptionsError("Invalid upstream auth specification: %s" % auth)
16	    return b"Basic" + b" " + base64.b64encode(strutils.always_bytes(auth))
17	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/certs.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
555	            logger.warning(
556	                f'"{path.absolute()}" is a certificate authority and not a leaf certificate. '
557	                f"This indicates a misconfiguration, see https://docs.mitmproxy.org/stable/concepts-certificates/."

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/contentviews/__init__.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
76	    views.append(view)
77	    on_add.send(view)
78	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/contentviews/__init__.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
81	    views.remove(view)
82	    on_remove.send(view)
83	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/contrib/imghdr.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
27	                f = open(file, 'rb')
28	                h = f.read(32)
29	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/contrib/imghdr.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	                location = file.tell()
31	                h = file.read(32)
32	                file.seek(location)

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/contrib/kaitaistruct/png.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
298	            self._raw_text_datastream = self._io.read_bytes_full()
299	            self.text_datastream = zlib.decompress(self._raw_text_datastream)
300	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/contrib/kaitaistruct/png.py:299
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
298	            self._raw_text_datastream = self._io.read_bytes_full()
299	            self.text_datastream = zlib.decompress(self._raw_text_datastream)
300	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/contrib/wbxml/ASCommandResponse.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66			with open(samplesDir + os.sep + filename, "rb") as f:
67				byteWBXML = f.read()
68	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/dns.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
139	        if ech_bytes is not None:
140	            return base64.b64encode(ech_bytes).decode("utf-8")
141	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/dns.py:140
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
139	        if ech_bytes is not None:
140	            return base64.b64encode(ech_bytes).decode("utf-8")
141	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/dns.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
149	        else:
150	            ech_bytes = base64.b64decode(ech.encode("utf-8"))
151	            record.params[SVCParamKeys.ECH.value] = ech_bytes

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/dns.py:150
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
149	        else:
150	            ech_bytes = base64.b64decode(ech.encode("utf-8"))
151	            record.params[SVCParamKeys.ECH.value] = ech_bytes

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/io/har.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	    client_conn = connection.Client(
65	        peername=("127.0.0.1", 0),
66	        sockname=("127.0.0.1", 0),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/io/har.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
65	        peername=("127.0.0.1", 0),
66	        sockname=("127.0.0.1", 0),
67	        # TODO Get time info from HAR File

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/io/har.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
92	    if content_encoding == "base64":
93	        response_content = base64.b64decode(response_content)
94	    elif isinstance(response_content, str):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/io/har.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
92	    if content_encoding == "base64":
93	        response_content = base64.b64decode(response_content)
94	    elif isinstance(response_content, str):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/io/io.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	            pos = self.fo.tell()
39	            ret = self.fo.read(n)
40	            self.fo.seek(pos)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/io/io.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	        ):  # skip BOM, usually added by Fiddler
51	            self.fo.read(3)
52	        if self.peek(1).startswith(b"{"):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/io/io.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
53	            try:
54	                har_file = json.loads(self.fo.read().decode("utf-8"))
55	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/encoding.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
164	        return b""
165	    return brotli.decompress(content)
166	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/encoding.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
195	    try:
196	        return zlib.decompress(content)
197	    except zlib.error:

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/encoding.py:196
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
195	    try:
196	        return zlib.decompress(content)
197	    except zlib.error:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/encoding.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
197	    except zlib.error:
198	        return zlib.decompress(content, -15)
199	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/encoding.py:198
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
197	    except zlib.error:
198	        return zlib.decompress(content, -15)
199	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/http/user_agents.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        "b",
22	        "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)",
23	    ),
24	    (
25	        "chrome",
26	        "c",
27	        "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/22.0.1207.1 Safari/537.1",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/http/user_agents.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    ),
34	    ("googlebot", "g", "Googlebot/2.1 (+http://www.googlebot.com/bot.html)"),
35	    ("ie9", "i", "Mozilla/5.0 (Windows; U; MSIE 9.0; WIndows NT 9.0; en-US)"),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/local_ip.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
5	
6	def get_local_ip(reachable: str = "8.8.8.8") -> str | None:
7	    """

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/local_ip.py:15
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
14	    try:
15	        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
16	        s.connect((reachable, 80))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/local_ip.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
15	        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
16	        s.connect((reachable, 80))
17	        return s.getsockname()[0]  # pragma: no cover

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/local_ip.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
21	        if s is not None:
22	            s.close()
23	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/local_ip.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
32	    try:
33	        s = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)
34	        s.connect((reachable, 80))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/local_ip.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
33	        s = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)
34	        s.connect((reachable, 80))
35	        return s.getsockname()[0]  # pragma: no cover

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/local_ip.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
39	        if s is not None:
40	            s.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/tls.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	                self.f = self.filename.open("ab")
103	                self.f.write(b"\n")
104	            self.f.write(keymaterial + b"\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/net/tls.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
103	                self.f.write(b"\n")
104	            self.f.write(keymaterial + b"\n")
105	            self.f.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/osx.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	        raise RuntimeError(
36	            "Insufficient privileges to access pfctl. "
37	            "See https://mitmproxy.org/docs/latest/howto-transparent/#macos for details."
38	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	
25	REDIRECT_API_HOST = "127.0.0.1"
26	REDIRECT_API_PORT = 8085

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
43	def write(data, wfile: BufferedIOBase) -> None:
44	    wfile.write(json.dumps(data).encode() + b"\n")
45	    wfile.flush()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
58	            TransparentProxy.setup()
59	            self._connect()
60	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
62	        if self.sock:
63	            self.sock.close()
64	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:64
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
63	            self.sock.close()
64	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
65	        self.sock.connect((REDIRECT_API_HOST, REDIRECT_API_PORT))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
64	        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
65	        self.sock.connect((REDIRECT_API_HOST, REDIRECT_API_PORT))
66	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        self.rfile = self.sock.makefile("rb")
69	        write(os.getpid(), self.wfile)
70	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
76	            try:
77	                write((ip, port), self.wfile)
78	                addr = read(self.rfile)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	                write((ip, port), self.wfile)
78	                addr = read(self.rfile)
79	                if addr is None:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
82	            except (EOFError, OSError, AttributeError):
83	                self._connect()
84	                return self.original_addr(csock)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
97	        try:
98	            pid: int = read(self.rfile)
99	            if pid is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	                while True:
103	                    c = read(self.rfile)
104	                    if c is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	                        server = None
112	                    write(server, self.wfile)
113	        except (EOFError, OSError):

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
287	            try:
288	                packet = self.windivert.recv()
289	            except OSError as e:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
297	    def shutdown(self):
298	        self.windivert.close()
299	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
305	        try:
306	            return self.windivert.recv()
307	        except OSError as e:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
339	            # but this was identified as necessary in https://github.com/mitmproxy/mitmproxy/pull/3174.
340	            self.windivert.send(packet, recalculate_checksum=True)
341	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
439	        )
440	        self.api_thread = threading.Thread(target=self.api.serve_forever)
441	        self.api_thread.daemon = True

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:471
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
470	        )
471	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
472	        server_unavailable = s.connect_ex((REDIRECT_API_HOST, REDIRECT_API_PORT))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
517	        # so we use the response handle.
518	        self.response.windivert.send(packet)
519	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/platform/windows.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
533	
534	        self.response.windivert.send(packet, recalculate_checksum=False)
535	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/layers/http/__init__.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
221	        if self.flow.request.method == "CONNECT":
222	            return (yield from self.handle_connect())
223	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/layers/http/__init__.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
638	        if request:
639	            err = validate_request(
640	                self.mode,
641	                self.flow.request,
642	                self.context.options.validate_inbound_headers,
643	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/layers/http/_upstream_proxy.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
73	        yield HttpConnectUpstreamHook(flow)
74	        raw = http1.assemble_request(flow.request)
75	        yield commands.SendData(self.tunnel_connection, raw)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/layers/quic/_client_hello_parser.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
89	        for dgm in datagrams:
90	            quic.receive_datagram(dgm, ("0.0.0.0", 0), now=time.time())
91	    except QuicClientHello as hello:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/layers/websocket.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
77	    def send2(self, event: wsproto.events.Event) -> commands.SendData:
78	        data = self.send(event)
79	        return commands.SendData(self.conn, data)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_servers.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
203	                logger.error(f"Transparent mode failure: {e!r}")
204	                writer.close()
205	                return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_servers.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
264	            for s in self._servers:
265	                s.close()
266	            # https://github.com/python/cpython/issues/104344

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_servers.py:286
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
285	                try:
286	                    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
287	                    s.bind(("", 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_servers.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
288	                    port = s.getsockname()[1]
289	                    s.close()
290	                    servers.append(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_servers.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
309	                ipv4 = await mitmproxy_rs.udp.start_udp_server(
310	                    "0.0.0.0",
311	                    port,
312	                    self.handle_stream,
313	                )
314	                servers.append(ipv4)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_servers.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
391	        self._server = await mitmproxy_rs.wireguard.start_wireguard_server(
392	            host or "0.0.0.0",
393	            port,

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_servers.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
432	        try:
433	            self._server.close()
434	            await self._server.wait_closed()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_servers.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
556	        try:
557	            self._server.close()
558	            await self._server.wait_closed()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_specs.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
316	            # The Rust side is Linux only for the moment, but eventually we may need this.
317	            platform.system() == "Darwin" and not re.match(r"^utun\d+$", self.data)
318	        )

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/mode_specs.py:317
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
316	            # The Rust side is Linux only for the moment, but eventually we may need this.
317	            platform.system() == "Darwin" and not re.match(r"^utun\d+$", self.data)
318	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/server.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
581	            opts,
582	            mode_specs.ProxyMode.parse("reverse:http://127.0.0.1:3000/"),
583	            {

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/proxy/server.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
590	
591	    coro = asyncio.start_server(handle, "127.0.0.1", 8080, loop=loop)
592	    server = loop.run_until_complete(coro)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/test/tflow.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
218	        id=str(uuid.uuid4()),
219	        peername=("127.0.0.1", 22),
220	        sockname=("", 0),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/test/tflow.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
243	        address=("address", 22),
244	        peername=("192.168.0.1", 22),
245	        sockname=("address", 22),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/defaultkeys.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	        "n",
110	        "console.command view.flows.create get https://example.com/",
111	        ["flowlist"],
112	        "Create a new flow",
113	    )
114	    km.add(
115	        "o",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/grideditor/base.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	        with open(filename, "r" if escaped else "rb") as f:
35	            d = f.read()
36	    except OSError as v:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/keymap.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
212	                try:
213	                    txt = f.read()
214	                except UnicodeDecodeError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/master.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	        with open(fd, "w" if text else "wb") as f:
139	            f.write(data)
140	        if with_hexeditor:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/master.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
138	        with open(fd, "w" if text else "wb") as f:
139	            f.write(data)
140	        if with_hexeditor:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/master.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
152	                with open(name, "r" if text else "rb") as f:
153	                    data = f.read()
154	        os.unlink(name)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/master.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
163	        fd, name = tempfile.mkstemp(ext, "mproxy")
164	        os.write(fd, data)
165	        os.close(fd)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/master.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
163	        fd, name = tempfile.mkstemp(ext, "mproxy")
164	        os.write(fd, data)
165	        os.close(fd)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/master.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
167	        # read-only to remind the user that this is a view function
168	        os.chmod(name, stat.S_IREAD)
169	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/console/master.py:168
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
167	        # read-only to remind the user that this is a view function
168	        os.chmod(name, stat.S_IREAD)
169	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/main.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
125	            # Fall back to `signal.signal` for platforms where that is not available (Windows' Proactorloop)
126	            signal.signal(signal.SIGINT, _sigint)
127	            signal.signal(signal.SIGTERM, _sigterm)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/main.py:126
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
125	            # Fall back to `signal.signal` for platforms where that is not available (Windows' Proactorloop)
126	            signal.signal(signal.SIGINT, _sigint)
127	            signal.signal(signal.SIGTERM, _sigterm)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/main.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
126	            signal.signal(signal.SIGINT, _sigint)
127	            signal.signal(signal.SIGTERM, _sigterm)
128	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/main.py:127
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
126	            signal.signal(signal.SIGINT, _sigint)
127	            signal.signal(signal.SIGTERM, _sigterm)
128	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/main.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
131	        if hasattr(signal, "SIGPIPE"):
132	            signal.signal(signal.SIGPIPE, signal.SIG_IGN)
133	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/main.py:132
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
131	        if hasattr(signal, "SIGPIPE"):
132	            signal.signal(signal.SIGPIPE, signal.SIG_IGN)
133	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/web/master.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
106	        # Add our web app.
107	        http_server = tornado.httpserver.HTTPServer(
108	            self.app, max_buffer_size=2**32
109	        )  # 4GB

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/web/static_viewer.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
27	    if (path / "static").exists():
28	        shutil.rmtree(str(path / "static"))
29	    shutil.copytree(str(web_dir / "static"), str(path / "static"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/web/static_viewer.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
32	    with open(str(path / "static" / "static.js"), "w") as f:
33	        f.write("MITMWEB_STATIC = true;")
34	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/web/static_viewer.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	                if message:
62	                    content_file.write(message.content)
63	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/web/static_viewer.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	                else:
64	                    content_file.write(b"No content.")
65	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/web/webaddons.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
83	        loader.add_option("web_port", int, 8081, "Web UI port.")
84	        loader.add_option("web_host", str, "127.0.0.1", "Web UI host.")
85	        loader.add_option(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/web/webaddons.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	                logger.info(
102	                    f"You can configure a fixed authentication token by setting the `web_password` option "
103	                    f"(https://docs.mitmproxy.org/stable/concepts-options/#web_password).",

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/utils/debug.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
129	    if os.name != "nt":  # pragma: windows no cover
130	        signal.signal(signal.SIGUSR1, dump_info)
131	        signal.signal(signal.SIGUSR2, dump_stacks)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/utils/debug.py:130
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
129	    if os.name != "nt":  # pragma: windows no cover
130	        signal.signal(signal.SIGUSR1, dump_info)
131	        signal.signal(signal.SIGUSR2, dump_stacks)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/utils/debug.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
130	        signal.signal(signal.SIGUSR1, dump_info)
131	        signal.signal(signal.SIGUSR2, dump_stacks)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/utils/debug.py:131
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
130	        signal.signal(signal.SIGUSR1, dump_info)
131	        signal.signal(signal.SIGUSR2, dump_stacks)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/utils/emoji.py:1870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1869	
1870	    r = requests.get("https://api.github.com/emojis")
1871	    for name, url in r.json().items():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/utils/emoji.py:1870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1869	
1870	    r = requests.get("https://api.github.com/emojis")
1871	    for name, url in r.json().items():

--------------------------------------------------

Code scanned:
	Total lines of code: 39077
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 50.0
		High: 88.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 117.0
		High: 21.0
Files skipped (1):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mitmproxy-11.1.3-py3-none-any/mitmproxy/tools/web/app.py (syntax error while parsing AST from file)
