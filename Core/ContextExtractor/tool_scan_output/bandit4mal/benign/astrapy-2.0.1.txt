Run started:2025-04-12 16:21:06.939189

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/__init__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	                # Load the pyproject.toml file as a dictionary
38	                file_contents = pyproject.read()
39	                pyproject_data = toml.loads(file_contents)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/admin/endpoints.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	api_endpoint_parser = re.compile(
29	    r"https://"
30	    r"([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})"
31	    r"-"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/admin/endpoints.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	api_endpoint_description = (
38	    "https://<db uuid, 8-4-4-4-12 hex format>-<db region>.apps.astra.datastax.com"
39	)
40	
41	generic_api_url_matcher = re.compile(r"^https?:\/\/[a-zA-Z0-9\-.]+(\:[0-9]{1,6}){0,1}$")
42	generic_api_url_descriptor = "http[s]://<domain name or IP>[:port]"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/authentication.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
245	    def _b64(cleartext: str) -> str:
246	        return base64.b64encode(cleartext.encode()).decode()
247	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/authentication.py:246
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
245	    def _b64(cleartext: str) -> str:
246	        return base64.b64encode(cleartext.encode()).decode()
247	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/data/collection.py:881
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
880	            if _concurrency > 1:
881	                with ThreadPoolExecutor(max_workers=_concurrency) as executor:
882	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/data/table.py:1524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1523	            if _concurrency > 1:
1524	                with ThreadPoolExecutor(max_workers=_concurrency) as executor:
1525	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/data/utils/extended_json_converters.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
39	def convert_to_ejson_bytes(bytes_value: bytes) -> dict[str, str]:
40	    return {"$binary": base64.b64encode(bytes_value).decode()}
41	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/data/utils/extended_json_converters.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
39	def convert_to_ejson_bytes(bytes_value: bytes) -> dict[str, str]:
40	    return {"$binary": base64.b64encode(bytes_value).decode()}
41	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/data/utils/extended_json_converters.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
65	) -> bytes:
66	    return base64.b64decode(binary_object["$binary"])
67	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/data/utils/extended_json_converters.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
65	) -> bytes:
66	    return base64.b64decode(binary_object["$binary"])
67	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/settings/defaults.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	API_ENDPOINT_TEMPLATE_ENV_MAP = {
36	    DATA_API_ENVIRONMENT_PROD: "https://{database_id}-{region}.apps.astra.datastax.com",
37	    DATA_API_ENVIRONMENT_DEV: "https://{database_id}-{region}.apps.astra-dev.datastax.com",
38	    DATA_API_ENVIRONMENT_TEST: "https://{database_id}-{region}.apps.astra-test.datastax.com",
39	}
40	API_PATH_ENV_MAP = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/settings/defaults.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    DATA_API_ENVIRONMENT_PROD: "https://{database_id}-{region}.apps.astra.datastax.com",
37	    DATA_API_ENVIRONMENT_DEV: "https://{database_id}-{region}.apps.astra-dev.datastax.com",
38	    DATA_API_ENVIRONMENT_TEST: "https://{database_id}-{region}.apps.astra-test.datastax.com",
39	}
40	API_PATH_ENV_MAP = {
41	    DATA_API_ENVIRONMENT_PROD: "/api/json",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/settings/defaults.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    DATA_API_ENVIRONMENT_DEV: "https://{database_id}-{region}.apps.astra-dev.datastax.com",
38	    DATA_API_ENVIRONMENT_TEST: "https://{database_id}-{region}.apps.astra-test.datastax.com",
39	}
40	API_PATH_ENV_MAP = {
41	    DATA_API_ENVIRONMENT_PROD: "/api/json",
42	    DATA_API_ENVIRONMENT_DEV: "/api/json",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/settings/defaults.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	DEV_OPS_URL_ENV_MAP = {
97	    DATA_API_ENVIRONMENT_PROD: "https://api.astra.datastax.com",
98	    DATA_API_ENVIRONMENT_DEV: "https://api.dev.cloud.datastax.com",
99	    DATA_API_ENVIRONMENT_TEST: "https://api.test.cloud.datastax.com",
100	}
101	DEV_OPS_VERSION_ENV_MAP = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/settings/defaults.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	    DATA_API_ENVIRONMENT_PROD: "https://api.astra.datastax.com",
98	    DATA_API_ENVIRONMENT_DEV: "https://api.dev.cloud.datastax.com",
99	    DATA_API_ENVIRONMENT_TEST: "https://api.test.cloud.datastax.com",
100	}
101	DEV_OPS_VERSION_ENV_MAP = {
102	    DATA_API_ENVIRONMENT_PROD: "v2",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/settings/defaults.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	    DATA_API_ENVIRONMENT_DEV: "https://api.dev.cloud.datastax.com",
99	    DATA_API_ENVIRONMENT_TEST: "https://api.test.cloud.datastax.com",
100	}
101	DEV_OPS_VERSION_ENV_MAP = {
102	    DATA_API_ENVIRONMENT_PROD: "v2",
103	    DATA_API_ENVIRONMENT_DEV: "v2",

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
362	        encoded_payload = (
363	            self._decimal_aware_encode_payload(payload)
364	            if self.handle_decimals_writes

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
364	            if self.handle_decimals_writes
365	            else self._decimal_unaware_encode_payload(payload)
366	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
366	        )
367	        log_httpx_request(
368	            http_method=http_method,
369	            full_url=request_url,
370	            request_params=request_params,
371	            redacted_request_headers=self._loggable_headers,
372	            encoded_payload=encoded_payload,
373	            timeout_context=_timeout_context,
374	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
377	        try:
378	            raw_response = self.client.request(
379	                method=http_method,
380	                url=request_url,
381	                content=encoded_payload.encode()
382	                if encoded_payload is not None
383	                else None,
384	                params=request_params,
385	                timeout=httpx_timeout_s,
386	                headers=self.full_headers,
387	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
417	        encoded_payload = (
418	            self._decimal_aware_encode_payload(payload)
419	            if self.handle_decimals_writes

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
419	            if self.handle_decimals_writes
420	            else self._decimal_unaware_encode_payload(payload)
421	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
421	        )
422	        log_httpx_request(
423	            http_method=http_method,
424	            full_url=request_url,
425	            request_params=request_params,
426	            redacted_request_headers=self._loggable_headers,
427	            encoded_payload=encoded_payload,
428	            timeout_context=_timeout_context,
429	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
432	        try:
433	            raw_response = await self.async_client.request(
434	                method=http_method,
435	                url=request_url,
436	                content=encoded_payload.encode()
437	                if encoded_payload is not None
438	                else None,
439	                params=request_params,
440	                timeout=httpx_timeout_s,
441	                headers=self.full_headers,
442	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
469	    ) -> dict[str, Any]:
470	        raw_response = self.raw_request(
471	            http_method=http_method,
472	            payload=payload,
473	            additional_path=additional_path,
474	            request_params=request_params,
475	            raise_api_errors=raise_api_errors,
476	            timeout_context=timeout_context,
477	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astrapy-2.0.1/astrapy-2.0.1/astrapy/utils/api_commander.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
491	    ) -> dict[str, Any]:
492	        raw_response = await self.async_raw_request(
493	            http_method=http_method,
494	            payload=payload,
495	            additional_path=additional_path,
496	            request_params=request_params,
497	            raise_api_errors=raise_api_errors,
498	            timeout_context=timeout_context,
499	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 33695
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 3.0
Files skipped (0):
