Run started:2025-04-12 10:20:21.913973

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        # urls should not contain trailing /
53	        self.endpoint: str = "https://api.yandex-query.cloud.yandex.net"
54	        self.web_base_url: str = "https://yq.cloud.yandex.ru"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        self.endpoint: str = "https://api.yandex-query.cloud.yandex.net"
54	        self.web_base_url: str = "https://yq.cloud.yandex.ru"
55	        self.token_prefix = "Bearer "

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	        if response.status_code != expected_code:
118	            if response.headers.get("Content-Type", "").startswith("application/json"):
119	                body = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	                body = response.json()
120	                status = body.get("status")
121	                msg = body.get("message")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	                status = body.get("status")
121	                msg = body.get("message")
122	                details = body.get("details")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	                msg = body.get("message")
122	                details = body.get("details")
123	                raise YQHttpClientException(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
154	
155	        response = self.session.post(
156	            self._compose_api_url("/api/fq/v1/queries"),
157	            headers=self._build_headers(idempotency_key=idempotency_key, request_id=request_id),
158	            params=self._build_params(),
159	            json=body,
160	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	    def get_query_status(self, query_id, request_id=None, expected_code=200) -> Any:
166	        response = self.session.get(
167	            self._compose_api_url(f"/api/fq/v1/queries/{query_id}/status"),
168	            headers=self._build_headers(request_id=request_id),
169	            params=self._build_params(),
170	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	    def get_query(self, query_id, request_id=None, expected_code=200) -> Any:
176	        response = self.session.get(
177	            self._compose_api_url(f"/api/fq/v1/queries/{query_id}"),
178	            headers=self._build_headers(request_id=request_id),
179	            params=self._build_params(),
180	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
192	        headers = self._build_headers(idempotency_key=idempotency_key, request_id=request_id)
193	        response = self.session.post(
194	            self._compose_api_url(f"/api/fq/v1/queries/{query_id}/stop"),
195	            headers=headers,
196	            params=self._build_params(),
197	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	
252	        response = self.session.get(
253	            self._compose_api_url(f"/api/fq/v1/queries/{query_id}/results/{result_set_index}"),
254	            headers=self._build_headers(request_id=request_id),
255	            params=params,
256	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/http_client.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
300	    def get_openapi_spec(self) -> str:
301	        response = self.session.get(self._compose_api_url("/resources/v1/openapi.yaml"))
302	        self._validate_http_error(response)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/query_results.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
47	    def _convert_from_base64(value: str) -> str | bytes:
48	        b = base64.b64decode(value)
49	        try:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/src/yandex_query_client/query_results.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
47	    def _convert_from_base64(value: str) -> str | bytes:
48	        b = base64.b64decode(value)
49	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/tests/test_http_client.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	        responses.post(
19	            "https://api.yandex-query.cloud.yandex.net/api/fq/v1/queries",
20	            match=[
21	                matchers.header_matcher(
22	                    {"Content-Type": "application/json", "Authorization": f"Bearer {IAM_TOKEN}"}
23	                ),
24	                matchers.query_param_matcher({"project": PROJECT}),
25	                matchers.json_params_matcher({"name": "my query", "text": "select 777"}),
26	            ],
27	            json={"id": "query1"},
28	            status=200,
29	        )
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/tests/test_http_client.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        responses.get(
32	            "https://api.yandex-query.cloud.yandex.net/api/fq/v1/queries/query1/status",
33	            json={"status": "RUNNING"},
34	            status=200,
35	        )
36	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/tests/test_http_client.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        responses.get(
38	            "https://api.yandex-query.cloud.yandex.net/api/fq/v1/queries/query1/status",
39	            json={"status": "COMPLETED"},
40	            status=200,
41	        )
42	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/tests/test_http_client.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        responses.get(
45	            "https://api.yandex-query.cloud.yandex.net/api/fq/v1/queries/query1",
46	            json={
47	                "id": "query1",
48	                "result_sets": [{"rows_count": 1, "truncated": False} for _ in range(result_set_count)],
49	            },
50	            status=200,
51	        )
52	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/tests/test_http_client.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	            responses.get(
55	                f"https://api.yandex-query.cloud.yandex.net/api/fq/v1/queries/query1/results/{i}",
56	                json=query_results_json_list[i],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/tests/test_http_client.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        responses.post(
79	            "https://api.yandex-query.cloud.yandex.net/api/fq/v1/queries/query1/stop",
80	            match=[
81	                matchers.header_matcher({"Authorization": f"Bearer {IAM_TOKEN}"}),
82	                matchers.query_param_matcher({"project": PROJECT}),
83	            ],
84	            status=204,
85	        )
86	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandex_query_client-0.1.4/yandex_query_client-0.1.4/tests/test_http_client.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	            self.client.compose_query_web_link(query_id)
96	            == f"https://yq.cloud.yandex.ru/folders/{PROJECT}/ide/queries/query1"
97	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 811
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 1.0
Files skipped (0):
