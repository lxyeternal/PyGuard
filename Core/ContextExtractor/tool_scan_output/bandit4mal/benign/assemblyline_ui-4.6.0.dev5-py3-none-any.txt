Run started:2025-04-12 15:58:53.512608

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	    user = kwargs['user']
89	    user_data = STORAGE.user.get(user['uname'], as_obj=False)
90	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	    roles = [r for r in load_roles_form_acls(priv_map, roles)
120	             if r in load_roles(user_data['type'], user_data.get('roles', None))]
121	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	    try:
128	        expiry_ts = request.json.get("expiry_ts", None)
129	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
202	    uname = kwargs['user']['uname']
203	    user_data = STORAGE.user.get(uname, as_obj=False)
204	    if token_id not in user_data.get('apps', {}):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	    user_data = STORAGE.user.get(uname, as_obj=False)
204	    if token_id not in user_data.get('apps', {}):
205	        return make_api_response({"success": False}, "Token ID does not exist", 404)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	    uname = kwargs['user']['uname']
233	    user_data = STORAGE.user.get(uname, as_obj=False)
234	    user_data['otp_sk'] = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	    params = request.values
266	    client_id = params.get('client_id', None)
267	    redirect_url = params.get('redirect_url', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
266	    client_id = params.get('client_id', None)
267	    redirect_url = params.get('redirect_url', None)
268	    scope = params.get('scope', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
267	    redirect_url = params.get('redirect_url', None)
268	    scope = params.get('scope', None)
269	    roles = params.get('roles', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	    scope = params.get('scope', None)
269	    roles = params.get('roles', None)
270	    server = params.get('server', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
269	    roles = params.get('roles', None)
270	    server = params.get('server', None)
271	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
301	    uname = kwargs['user']['uname']
302	    user_data = STORAGE.user.get(uname, as_obj=False)
303	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
310	    token_id = None
311	    for k, v in user_data.get('apps', {}).items():
312	        if v == token_data:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
355	
356	    email = data.get('email', None)
357	    if email and STORAGE.user.search(f"email:{email.lower()}").get('total', 0) == 1:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
356	    email = data.get('email', None)
357	    if email and STORAGE.user.search(f"email:{email.lower()}").get('total', 0) == 1:
358	        key = hashlib.sha256(get_random_password(length=512).encode('utf-8')).hexdigest()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
406	
407	    user = data.get('user', None)
408	    password = data.get('password', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	    user = data.get('user', None)
408	    password = data.get('password', None)
409	    apikey = data.get('apikey', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
408	    password = data.get('password', None)
409	    apikey = data.get('apikey', None)
410	    webauthn_auth_resp = data.get('webauthn_auth_resp', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
409	    apikey = data.get('apikey', None)
410	    webauthn_auth_resp = data.get('webauthn_auth_resp', None)
411	    oauth_provider = data.get('oauth_provider', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
410	    webauthn_auth_resp = data.get('webauthn_auth_resp', None)
411	    oauth_provider = data.get('oauth_provider', None)
412	    oauth_token_id = data.get('oauth_token_id', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
411	    oauth_provider = data.get('oauth_provider', None)
412	    oauth_token_id = data.get('oauth_token_id', None)
413	    oauth_token = data.get('oauth_token', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
412	    oauth_token_id = data.get('oauth_token_id', None)
413	    oauth_token = data.get('oauth_token', None)
414	    saml_token_id = data.get('saml_token_id', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
413	    oauth_token = data.get('oauth_token', None)
414	    saml_token_id = data.get('saml_token_id', None)
415	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
416	    if config.auth.oauth.enabled and oauth_provider and oauth_token is None:
417	        oauth = current_app.extensions.get('authlib.integrations.flask_client')
418	        provider = oauth.create_client(oauth_provider)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
419	
420	        redirect_uri = config.auth.oauth.providers.get(oauth_provider).redirect_uri
421	        if provider:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
425	    try:
426	        otp = int(data.get('otp', 0) or 0)
427	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	        logged_in_uname = None
448	        ip = request.headers.get("X-Forwarded-For", request.remote_addr)
449	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
458	                'time': int(cur_time) - (int(cur_time) % session_duration),
459	                'user_agent': request.headers.get("User-Agent", None),
460	                'username': logged_in_uname,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
468	            for k, v in KV_SESSION.items().items():
469	                expire_at = v.get('expire_at', 0)
470	                if expire_at < cur_time:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
472	                    LOGGER.info(f"The following session ID was removed because of a timeout. "
473	                                f"[User: {v.get('username', 'unknown')}, SessionID: {k[:16]}...]")
474	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
481	        except AuthenticationException as wpe:
482	            uname = auth.get('username', '(None)')
483	            login_logger = AUDIT_LOG if AUDIT_LOGIN else LOGGER

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
514	    try:
515	        session_id = flsk_session.get('session_id', None)
516	        if session_id:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
575	        return make_api_response({"err_code": 0}, err="SAML disabled on the server", status_code=401)
576	    request_data: Dict[str, Any] = _prepare_flask_request(request)
577	    auth: OneLogin_Saml2_Auth = _make_saml_auth(request_data)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
575	        return make_api_response({"err_code": 0}, err="SAML disabled on the server", status_code=401)
576	    request_data: Dict[str, Any] = _prepare_flask_request(request)
577	    auth: OneLogin_Saml2_Auth = _make_saml_auth(request_data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
582	        msg = "Invalid SAML token"
583	        data = base64.b64encode(json.dumps({'error': msg}).encode('utf-8')).decode()
584	        return redirect(f"https://{config.ui.fqdn}/saml/?data={data}")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:583
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
582	        msg = "Invalid SAML token"
583	        data = base64.b64encode(json.dumps({'error': msg}).encode('utf-8')).decode()
584	        return redirect(f"https://{config.ui.fqdn}/saml/?data={data}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
605	        # Get user if exists
606	        cur_user = STORAGE.user.get(username, as_obj=False) or {}
607	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
644	            msg = "User does not exists"
645	            data = base64.b64encode(json.dumps({'error': msg}).encode('utf-8')).decode()
646	            return redirect(f"https://{config.ui.fqdn}/saml/?data={data}")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:645
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
644	            msg = "User does not exists"
645	            data = base64.b64encode(json.dumps({'error': msg}).encode('utf-8')).decode()
646	            return redirect(f"https://{config.ui.fqdn}/saml/?data={data}")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
653	            msg = "Invalid SAML token"
654	            data = base64.b64encode(json.dumps({'error': msg}).encode('utf-8')).decode()
655	            return redirect(f"https://{config.ui.fqdn}/saml/?data={data}")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:654
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
653	            msg = "Invalid SAML token"
654	            data = base64.b64encode(json.dumps({'error': msg}).encode('utf-8')).decode()
655	            return redirect(f"https://{config.ui.fqdn}/saml/?data={data}")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
665	        }
666	        data = base64.b64encode(json.dumps(data).encode('utf-8')).decode()
667	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:666
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
665	        }
666	        data = base64.b64encode(json.dumps(data).encode('utf-8')).decode()
667	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
673	        LOGGER.error(f"SAML ACS request failed: {auth.get_last_error_reason()}\n{errors}")
674	        data = base64.b64encode(json.dumps({'error': errors}).encode('utf-8')).decode()
675	        return redirect(f"https://{config.ui.fqdn}/saml/?data={data}")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:674
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
673	        LOGGER.error(f"SAML ACS request failed: {auth.get_last_error_reason()}\n{errors}")
674	        data = base64.b64encode(json.dumps({'error': errors}).encode('utf-8')).decode()
675	        return redirect(f"https://{config.ui.fqdn}/saml/?data={data}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
700	    """
701	    oauth_provider = request.values.get('provider', None)
702	    avatar = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
707	    if config.auth.oauth.enabled:
708	        oauth: OAuth = current_app.extensions.get('authlib.integrations.flask_client')
709	        provider: FlaskOAuth2App = oauth.create_client(oauth_provider)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
720	                    client_assertion = None
721	                    token_file = os.environ.get("AZURE_FEDERATED_TOKEN_FILE")
722	                    if os.path.exists(token_file):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
722	                    if os.path.exists(token_file):
723	                        client_assertion = open(token_file).read()
724	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
764	                    url = oauth_provider_config.app_provider.user_get
765	                    uid = user_data.get('id', None)
766	                    if not uid and user_data and oauth_provider_config.uid_field:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
766	                    if not uid and user_data and oauth_provider_config.uid_field:
767	                        uid = user_data.get(oauth_provider_config.uid_field, None)
768	                    if uid:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
769	                        url = url.format(id=uid)
770	                    resp = app_provider.get(url)
771	                    if resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
774	                elif oauth_provider_config.user_get:
775	                    resp = provider.get(oauth_provider_config.user_get)
776	                    if resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
782	                    url = oauth_provider_config.app_provider.group_get
783	                    uid = user_data.get('id', None)
784	                    if not uid and user_data and oauth_provider_config.uid_field:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
784	                    if not uid and user_data and oauth_provider_config.uid_field:
785	                        uid = user_data.get(oauth_provider_config.uid_field, None)
786	                    if uid:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
787	                        url = url.format(id=uid)
788	                    resp_grp = app_provider.get(url)
789	                    if resp_grp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
792	                elif oauth_provider_config.user_groups:
793	                    resp_grp = provider.get(oauth_provider_config.user_groups)
794	                    if resp_grp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
825	                        # Do not update username and password from the current user
826	                        data['uname'] = cur_user.get('uname', data['uname'])
827	                        data['password'] = cur_user.get('password', data['password'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
826	                        data['uname'] = cur_user.get('uname', data['uname'])
827	                        data['password'] = cur_user.get('password', data['password'])
828	                    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
865	                        if avatar is None:
866	                            avatar = STORAGE.user_avatar.get(username) or "/static/images/user_default.png"
867	                        oauth_token_id = hashlib.sha256(str(token).encode("utf-8", errors='replace')).hexdigest()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
927	
928	    reset_id = data.get('reset_id', None)
929	    password = data.get('password', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
928	    reset_id = data.get('reset_id', None)
929	    password = data.get('password', None)
930	    password_confirm = data.get('password_confirm', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:930
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
929	    password = data.get('password', None)
930	    password_confirm = data.get('password_confirm', None)
931	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
947	                res = STORAGE.user.search(f"email:{email}", fl="*")
948	                if res.get('total', 0) == 1:
949	                    user = res['items'][0]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
988	
989	    user_data = STORAGE.user.get(uname, as_obj=False)
990	    if user_data['otp_sk'] is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1042	
1043	    uname = data.get('user', None)
1044	    password = data.get('password', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1043	    uname = data.get('user', None)
1044	    password = data.get('password', None)
1045	    password_confirm = data.get('password_confirm', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1044	    password = data.get('password', None)
1045	    password_confirm = data.get('password_confirm', None)
1046	    email = data.get('email', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1046
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1045	    password_confirm = data.get('password_confirm', None)
1046	    email = data.get('email', None)
1047	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1070
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1069	
1070	    if STORAGE.user.search(f"email:{email.lower()}").get('total', 0) != 0:
1071	        return make_api_response({"success": False}, "There is already a user registered with this email address", 466)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1135	
1136	    registration_key = data.get('registration_key', None)
1137	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1147	                user_info['classification'] = get_dynamic_classification(
1148	                    user_info.get('classification', Classification.UNRESTRICTED), user_info)
1149	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1184	    uname = kwargs['user']['uname']
1185	    user_data = STORAGE.user.get(uname, as_obj=False)
1186	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1217	def _make_saml_auth(request_data: Dict[str, Any] = None) -> OneLogin_Saml2_Auth:
1218	    request_data: Dict[str, Any] = request_data or _prepare_flask_request(request)
1219	    return OneLogin_Saml2_Auth(request_data, config.auth.saml.settings.as_camel_case())

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/authentication.py:1218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1217	def _make_saml_auth(request_data: Dict[str, Any] = None) -> OneLogin_Saml2_Auth:
1218	    request_data: Dict[str, Any] = request_data or _prepare_flask_request(request)
1219	    return OneLogin_Saml2_Auth(request_data, config.auth.saml.settings.as_camel_case())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/bundle.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
108	        if request.data[:3] == BUNDLE_MAGIC or is_cart(request.data[:256]):
109	            fh.write(request.data)
110	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/bundle.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	            try:
112	                fh.write(base64.b64decode(request.data))
113	            except binascii.Error:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/bundle.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
111	            try:
112	                fh.write(base64.b64decode(request.data))
113	            except binascii.Error:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/bundle.py:112
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
111	            try:
112	                fh.write(base64.b64decode(request.data))
113	            except binascii.Error:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/bundle.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	            except binascii.Error:
114	                fh.write(request.data)
115	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	                try:
61	                    rsp = self.session.get(url, headers=headers, timeout=3.0)
62	                except exceptions.ConnectionError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        available_tags[source.name] = [
95	            tname for tname, classification in all_supported_tags.get(source.name, {}).items()
96	            if user and Classification.is_accessible(user["classification"], classification)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	    """Parse the standard query params."""
103	    query_sources = request.args.get("sources")
104	    if query_sources:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	
107	    max_timeout = request.args.get("max_timeout", timeout)
108	    limit = request.args.get("limit", limit, type=int)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	    max_timeout = request.args.get("max_timeout", timeout)
108	    limit = request.args.get("limit", limit, type=int)
109	    # noinspection PyBroadException

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	
115	    tag_classification = request.args.get("classification", Classification.UNRESTRICTED)
116	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
148	    """Query the external source for details."""
149	    if tag_name not in all_supported_tags.get(source.name, {}):
150	        return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	    url = f"{source.url}/{query_type}/{tag_name}/{tag}/"
178	    rsp = session.get(url, params=params, headers=headers)
179	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/federated_lookup.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
301	
302	    with APMAwareThreadPoolExecutor(min(len(available_sources) + 1, os.cpu_count() + 4)) as executor:
303	        # create searches for external sources

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/file.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
529	
530	        return make_api_response(f"data:{file_obj['type']};base64,{base64.b64encode(data).decode()}")
531	    else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/file.py:530
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
529	
530	        return make_api_response(f"data:{file_obj['type']};base64,{base64.b64encode(data).decode()}")
531	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	                            raise SkipDatasource()
67	                    cfg = cfg.get(point)
68	            cls = load_module_by_path(classpath)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	    result = {"error": None, "items": []}
107	    if hash_type not in all_supported_tags.get(source.name, {}):
108	        result["error"] = NOT_SUPPORTED

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	    url = f"{source.url}/details/{hash_type}/{encoded}/"
134	    rsp = session.get(url, params=params, headers=headers)
135	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	    # but also allowing classification to be optional for when classification engine is disabled.
220	    hash_classification = request.args.get("classification", user["classification"])
221	    limit = request.args.get("limit", "500")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	    hash_classification = request.args.get("classification", user["classification"])
221	    limit = request.args.get("limit", "500")
222	    max_timeout = request.args.get('max_timeout', "3")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
221	    limit = request.args.get("limit", "500")
222	    max_timeout = request.args.get('max_timeout', "3")
223	    # noinspection PyBroadException

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
230	    ext_list = []
231	    db = request.args.get('db', None)
232	    if db:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
252	    total_sources = len(ext) + len(db_list)
253	    with APMAwareThreadPoolExecutor(min(total_sources + 1, os.cpu_count() + 4)) as executor:
254	        # create searches for external sources

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/hash_search.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	    res = results.values()
285	    if results and any({len(s.get("items", [])) for s in res}):
286	        # remove error message for Hash Not Found

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/ingest.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
238	            data = request.json
239	            binary = data.get('plaintext', '').encode() or base64.b64decode(data.get('base64', ''))
240	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/ingest.py:239
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
238	            data = request.json
239	            binary = data.get('plaintext', '').encode() or base64.b64decode(data.get('base64', ''))
240	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/ingest.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
496	            if os.path.exists(out_dir):
497	                shutil.rmtree(out_dir, ignore_errors=True)
498	        except Exception:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/proxy.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
67	        req_kwargs['data'] = request.data
68	    resp = requests.request(request.method, url, **req_kwargs)
69	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/submit.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
399	            data = request.json
400	            binary = data.get('plaintext', '').encode() or base64.b64decode(data.get('base64', ''))
401	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/submit.py:400
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
399	            data = request.json
400	            binary = data.get('plaintext', '').encode() or base64.b64decode(data.get('base64', ''))
401	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/submit.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
539	        try:
540	            shutil.rmtree(out_dir, ignore_errors=True)
541	        except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/system.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
209	            with open(constants.MAGIC_RULE_PATH) as mfh:
210	                return make_api_response(mfh.read())
211	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/system.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
294	            with open(constants.YARA_RULE_PATH) as mfh:
295	                return make_api_response(mfh.read())
296	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/system.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
518	            magic_file = tmp.name
519	            tmp.write(data)
520	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/system.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
518	            magic_file = tmp.name
519	            tmp.write(data)
520	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/system.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
660	            yara_file = tmp.name
661	            tmp.write(data)
662	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/system.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
660	            yara_file = tmp.name
661	            tmp.write(data)
662	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/ui.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
143	        file_obj = request.files['file']
144	        cache.save(filename, file_obj.stream.read())
145	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/ui.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
169	                with open(target_file, "ab") as t:
170	                    t.write(cache.get(chunk_name))
171	                cache.delete(chunk_name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/ui.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
174	            with open(target_file, "rb") as t:
175	                cache.save(ui_sid, t.read())
176	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/api/v4/ui.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
245	            with open(submitted_file, 'rb') as fh:
246	                if is_cart(fh.read(256)):
247	                    meta = get_metadata_only(submitted_file)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/app.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
190	    app.jinja_env.cache = {}
191	    app.run(host="0.0.0.0", debug=False, ssl_context=ssl_context, threaded=THREADED)
192	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/config.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	ALLOW_RAW_DOWNLOADS = config.ui.allow_raw_downloads
34	APP_ID = "https://%s" % config.ui.fqdn
35	APP_NAME = "Assemblyline"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/ai/cohere.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
38	            # Call API
39	            resp = self.session.post(self.config.chat_url, json=data)
40	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/ai/cohere.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	            msg_data = resp.json()
48	            msg = msg_data.get('message', None) or msg_data
49	            message = f"The AI model {self.config.model_name} denied the request " \

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/ai/cohere.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	                     for message in response_data['chat_history']]
68	            preamble = data.get('preamble', None)
69	            if preamble:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/ai/openai.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	                credentials = DefaultAzureCredential()
21	                aad_token = credentials.get_token('https://cognitiveservices.azure.com/.default').token
22	                self.config.headers['Authorization'] = f"Bearer {aad_token}"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/ai/openai.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
35	            # Call API
36	            resp = self.session.post(self.config.chat_url, json=data)
37	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/ai/openai.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	            msg_data = resp.json()
45	            msg = msg_data.get('error', {}).get('message', None) or msg_data
46	            message = f"The AI model {self.config.model_name} denied the request to " \

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/ai/openai.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	            msg_data = resp.json()
45	            msg = msg_data.get('error', {}).get('message', None) or msg_data
46	            message = f"The AI model {self.config.model_name} denied the request to " \

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/discover.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
12	        try:
13	            resp = requests.get(config.ui.discover_url, headers={'accept': 'application/json'}, timeout=5)
14	            if resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	    for email_key in provider.email_fields:
25	        email_adr = profile.get(email_key, None)
26	        if email_adr:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	    # Find identity ID
38	    identity_id = profile.get(provider.identity_id_field, None)
39	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    # Find the name of the user
50	    name = reorder_name(profile.get('name', profile.get('displayName', None)))
51	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    # Find the name of the user
50	    name = reorder_name(profile.get('name', profile.get('displayName', None)))
51	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	        # Generate it from email address
58	        uname = profile.get(provider.username_field, email_adr)
59	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        email_hash = hashlib.md5(email_adr.encode('utf-8')).hexdigest()
85	        alternate = f"https://www.gravatar.com/avatar/{email_hash}?s=256&d=404&r=pg"
86	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	            # Get values for field
106	            field_data = profile.get(auto_prop.field, None)
107	            if not isinstance(field_data, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
208	        password="__NO_PASSWORD__",
209	        avatar=profile.get('picture', alternate),
210	        **quotas

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	    if url.startswith(provider_config.api_base_url):
216	        resp = provider.get(url[len(provider_config.api_base_url):])
217	        if resp.ok and resp.headers.get("content-type") is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	        resp = provider.get(url[len(provider_config.api_base_url):])
217	        if resp.ok and resp.headers.get("content-type") is not None:
218	            b64_img = base64.b64encode(resp.content).decode()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
217	        if resp.ok and resp.headers.get("content-type") is not None:
218	            b64_img = base64.b64encode(resp.content).decode()
219	            avatar = f'data:{resp.headers.get("content-type")};base64,{b64_img}'

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:218
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
217	        if resp.ok and resp.headers.get("content-type") is not None:
218	            b64_img = base64.b64encode(resp.content).decode()
219	            avatar = f'data:{resp.headers.get("content-type")};base64,{b64_img}'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	            b64_img = base64.b64encode(resp.content).decode()
219	            avatar = f'data:{resp.headers.get("content-type")};base64,{b64_img}'
220	            return avatar

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	    elif url.startswith('https://') or url.startswith('http://'):
223	        resp = requests.get(url)
224	        if resp.ok and resp.headers.get("content-type") is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	        resp = requests.get(url)
224	        if resp.ok and resp.headers.get("content-type") is not None:
225	            b64_img = base64.b64encode(resp.content).decode()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
224	        if resp.ok and resp.headers.get("content-type") is not None:
225	            b64_img = base64.b64encode(resp.content).decode()
226	            avatar = f'data:{resp.headers.get("content-type")};base64,{b64_img}'

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:225
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
224	        if resp.ok and resp.headers.get("content-type") is not None:
225	            b64_img = base64.b64encode(resp.content).decode()
226	            avatar = f'data:{resp.headers.get("content-type")};base64,{b64_img}'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/oauth.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	            b64_img = base64.b64encode(resp.content).decode()
226	            avatar = f'data:{resp.headers.get("content-type")};base64,{b64_img}'
227	            return avatar

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
48	except socket.gaierror:
49	    MYIP = '127.0.0.1'
50	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	    updates['services']['excluded'] = updates['services']['excluded'] + \
75	        list(validated_profile.get("services", {}).get("excluded", []))
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	    updates['services']['excluded'] = updates['services']['excluded'] + \
75	        list(validated_profile.get("services", {}).get("excluded", []))
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	            else:
90	                service_spec = updates.get('service_spec', {}).get(param_type, {})
91	                requested_params = set(list_of_params) & set(service_spec)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	            else:
90	                service_spec = updates.get('service_spec', {}).get(param_type, {})
91	                requested_params = set(list_of_params) & set(service_spec)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	                    # Set a description if one hasn't been already set
155	                    s_params['description']= s_params.get('description',
156	                                                          f"Inspection of URL: {fileinfo['uri_info']['uri']}")
157	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	                                                failure_pattern=failure_pattern,
204	                                                ignore_size=s_params.get('ignore_size', False))
205	                    if dl_from is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	def update_submission_parameters(s_params: dict, data: dict, user: dict) -> dict:
246	    s_profile = SUBMISSION_PROFILES.get(data.get('submission_profile'))
247	    submission_customize = ROLES.submission_customize in user['roles']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	def update_submission_parameters(s_params: dict, data: dict, user: dict) -> dict:
246	    s_profile = SUBMISSION_PROFILES.get(data.get('submission_profile'))
247	    submission_customize = ROLES.submission_customize in user['roles']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	    # Ensure classification is set based on the user before applying updates
250	    classification = s_params.get("classification", user['classification'])
251	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	    if submission_customize:
254	        s_params.update(data.get("params", {}))
255	    elif not s_profile:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	        # Apply the profile (but allow the user to change some properties)
264	        s_params = recursive_update(s_params, data.get("params", {}))
265	        s_params = get_recursive_delta(DEFAULT_USER_PROFILE_SETTINGS, s_params)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
347	    if r.ok:
348	        if int(r.headers.get('content-length', 0)) > config.submission.max_file_size and not ignore_size:
349	            raise FileTooBigException("File too big to be scanned "

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
357	                    if failure_pattern and failure_pattern in chunk:
358	                        f.close()
359	                        os.unlink(target)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
363	                    if written > config.submission.max_file_size and not ignore_size:
364	                        f.close()
365	                        os.unlink(target)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
366	                        raise FileTooBigException("File too big to be scanned.")
367	                    f.write(chunk)
368	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/helper/submission.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
366	                        raise FileTooBigException("File too big to be scanned.")
367	                    f.write(chunk)
368	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/authenticator.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
100	
101	                    decoded = zlib.decompress(base64.urlsafe_b64decode(data)).decode('utf-8')
102	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/authenticator.py:101
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
100	
101	                    decoded = zlib.decompress(base64.urlsafe_b64decode(data)).decode('utf-8')
102	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/authenticator.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
100	
101	                    decoded = zlib.decompress(base64.urlsafe_b64decode(data)).decode('utf-8')
102	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/authenticator.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
106	                        expiry += '=' * (4 - missing_padding)
107	                    expiry_time = int.from_bytes(base64.urlsafe_b64decode(expiry), 'big')
108	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/ldap_auth.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
329	                if img_data:
330	                    b64_img = base64.b64encode(img_data).decode()
331	                    avatar = f'data:image/{config.auth.ldap.image_format};base64,{b64_img}'

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/ldap_auth.py:330
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
329	                if img_data:
330	                    b64_img = base64.b64encode(img_data).decode()
331	                    avatar = f'data:image/{config.auth.ldap.image_format};base64,{b64_img}'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/oauth_auth.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
15	    cache_key = CACHE.create_key("jwks", url)
16	    jwks = CACHE.get(cache_key, reset=False)
17	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/oauth_auth.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	    if not jwks:
20	        jwks = requests.get(url).json()
21	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/security/oauth_auth.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    if config.auth.oauth.enabled and oauth_token and oauth_provider:
50	        oauth_provider_config = config.auth.oauth.providers.get(oauth_provider, None)
51	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/sio/base.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
31	        if not user_info:
32	            disconnect()
33	        else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/socketsrv.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
63	        # If all files required are present, start up encrypted comms
64	        socketio.run(app, host="0.0.0.0", port=5002, keyfile=CERT_BUNDLE[1], certfile=CERT_BUNDLE[0])
65	    else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/assemblyline_ui-4.6.0.dev5-py3-none-any/assemblyline_ui/socketsrv.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
65	    else:
66	        socketio.run(app, host="0.0.0.0", port=5002)

--------------------------------------------------

Code scanned:
	Total lines of code: 15920
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 154.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 161.0
		High: 13.0
Files skipped (0):
