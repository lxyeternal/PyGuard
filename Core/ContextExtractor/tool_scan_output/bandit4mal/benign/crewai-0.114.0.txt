Run started:2025-04-12 12:26:26.321128

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/authentication/constants.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	AUTH0_CLIENT_ID = "DEVC5Fw6NlRoSzmDCcOhVq85EfLBjKa8"
4	AUTH0_AUDIENCE = "https://crewai.us.auth0.com/api/v2/"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/authentication/main.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
38	        }
39	        response = requests.post(
40	            url=self.DEVICE_CODE_URL, data=device_code_payload, timeout=20
41	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/authentication/main.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
60	        while True and attempts < 5:
61	            response = requests.post(self.TOKEN_URL, data=token_payload, timeout=30)
62	            token_data = response.json()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/authentication/utils.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124	        with open(file_path, "wb") as f:
125	            f.write(content)
126	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/authentication/utils.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
127	        # Set appropriate permissions (read/write for owner only)
128	        os.chmod(file_path, 0o600)
129	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/authentication/utils.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
127	        # Set appropriate permissions (read/write for owner only)
128	        os.chmod(file_path, 0o600)
129	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/authentication/utils.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
143	        with open(file_path, "rb") as f:
144	            return f.read()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/command.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	            details = (
67	                json_response.get("error")
68	                or json_response.get("message")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/command.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	                json_response.get("error")
68	                or json_response.get("message")
69	                or response.content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/constants.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	            "default": True,
49	            "API_BASE": "http://localhost:11434",
50	        }
51	    ],
52	    "bedrock": [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/constants.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
289	
290	JSON_URL = "https://raw.githubusercontent.com/BerriAI/litellm/main/model_prices_and_context_window.json"
291	
292	
293	LITELLM_PARAMS = ["api_key", "api_base", "api_version"]

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/create_crew.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
31	        click.secho(f"Overriding folder {folder_name}...", fg="green", bold=True)
32	        shutil.rmtree(folder_path)  # Delete the existing folder and its contents
33	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/crew_chat.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
170	    """Flush any pending input from the user."""
171	    if platform.system() == "Windows":
172	        # Windows platform

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/crew_chat.py:171
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
170	    """Flush any pending input from the user."""
171	    if platform.system() == "Windows":
172	        # Windows platform

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        }
26	        self.base_url = getenv("CREWAI_BASE_URL", "https://app.crewai.com")
27	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
31	        session.trust_env = False
32	        return session.request(method, url, headers=self.headers, **kwargs)
33	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
34	    def login_to_tool_repository(self):
35	        return self._make_request("POST", f"{self.TOOLS_RESOURCE}/login")
36	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
37	    def get_tool(self, handle: str):
38	        return self._make_request("GET", f"{self.TOOLS_RESOURCE}/{handle}")
39	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
54	        }
55	        return self._make_request("POST", f"{self.TOOLS_RESOURCE}", json=params)
56	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
57	    def deploy_by_name(self, project_name: str) -> requests.Response:
58	        return self._make_request(
59	            "POST", f"{self.CREWS_RESOURCE}/by-name/{project_name}/deploy"
60	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
62	    def deploy_by_uuid(self, uuid: str) -> requests.Response:
63	        return self._make_request("POST", f"{self.CREWS_RESOURCE}/{uuid}/deploy")
64	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
65	    def crew_status_by_name(self, project_name: str) -> requests.Response:
66	        return self._make_request(
67	            "GET", f"{self.CREWS_RESOURCE}/by-name/{project_name}/status"
68	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
70	    def crew_status_by_uuid(self, uuid: str) -> requests.Response:
71	        return self._make_request("GET", f"{self.CREWS_RESOURCE}/{uuid}/status")
72	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
75	    ) -> requests.Response:
76	        return self._make_request(
77	            "GET", f"{self.CREWS_RESOURCE}/by-name/{project_name}/logs/{log_type}"
78	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
82	    ) -> requests.Response:
83	        return self._make_request(
84	            "GET", f"{self.CREWS_RESOURCE}/{uuid}/logs/{log_type}"
85	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
87	    def delete_crew_by_name(self, project_name: str) -> requests.Response:
88	        return self._make_request(
89	            "DELETE", f"{self.CREWS_RESOURCE}/by-name/{project_name}"
90	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
92	    def delete_crew_by_uuid(self, uuid: str) -> requests.Response:
93	        return self._make_request("DELETE", f"{self.CREWS_RESOURCE}/{uuid}")
94	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
95	    def list_crews(self) -> requests.Response:
96	        return self._make_request("GET", self.CREWS_RESOURCE)
97	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/plus_api.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
98	    def create_crew(self, payload) -> requests.Response:
99	        return self._make_request("POST", self.CREWS_RESOURCE, json=payload)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/provider.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	    if provider in predefined_providers:
95	        available_models = MODELS.get(provider, [])
96	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/provider.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	    else:
97	        available_models = provider_models.get(provider, [])
98	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/provider.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	    try:
167	        response = requests.get(JSON_URL, stream=True, timeout=60)
168	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/provider.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	    """
190	    total_size = int(response.headers.get("content-length", 0))
191	    block_size = 8192

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/provider.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
221	    for model_name, properties in data.items():
222	        provider = properties.get("litellm_provider", "").strip().lower()
223	        if "http" in provider or provider == "other":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/tools/main.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
103	            with open(tarball_path, "rb") as file:
104	                tarball_contents = file.read()
105	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/tools/main.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
105	
106	            encoded_tarball = base64.b64encode(tarball_contents).decode("utf-8")
107	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/tools/main.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
105	
106	            encoded_tarball = base64.b64encode(tarball_contents).decode("utf-8")
107	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	    with open(src, "r") as file:
23	        content = file.read()
24	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
31	    with open(dst, "w") as file:
32	        file.write(content)
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/utils.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	        with open(pyproject_path, "r") as f:
83	            pyproject_content = parse_toml(f.read())
84	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/utils.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
123	        with open(env_file_path, "r") as f:
124	            env_content = f.read()
125	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/utils.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
162	            with open(filepath, "r") as file:
163	                contents = file.read()
164	            with open(filepath, "w") as file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/utils.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	            with open(filepath, "w") as file:
165	                file.write(contents.replace(find, replace))
166	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/utils.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
249	        for key, value in env_vars.items():
250	            file.write(f"{key}={value}\n")
251	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/flow/flow_visualizer.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
128	                with open(f"{filename}.html", "w", encoding="utf-8") as f:
129	                    f.write(final_html_content)
130	                print(f"Plot saved as {filename}.html")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/flow/flow_visualizer.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
199	                import shutil
200	                shutil.rmtree(lib_folder)
201	        except ValueError as e:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/flow/html_template_handler.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
41	            logo_svg_data = logo_file.read()
42	            return base64.b64encode(logo_svg_data).decode("utf-8")
43	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/flow/html_template_handler.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
41	            logo_svg_data = logo_file.read()
42	            return base64.b64encode(logo_svg_data).decode("utf-8")
43	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/knowledge/storage/knowledge_storage.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
119	        self.app.reset()
120	        shutil.rmtree(base_path)
121	        self.app = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/llm.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	            if (
61	                "Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new"
62	                in s
63	                or "LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True`"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/llm.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	                return 0
67	            return self._original_stream.write(s)
68	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/memory/storage/rag_storage.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
154	                self.app.reset()
155	                shutil.rmtree(f"{db_storage_path()}/{self.type}")
156	                self.app = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/telemetry/telemetry.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        try:
55	            telemetry_endpoint = "https://telemetry.crewai.com:4319"
56	            self.resource = Resource(

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/telemetry/telemetry.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
239	                self._add_attribute(span, "platform_release", platform.release())
240	                self._add_attribute(span, "platform_system", platform.system())
241	                self._add_attribute(span, "platform_version", platform.version())

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/telemetry/telemetry.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
239	                self._add_attribute(span, "platform_release", platform.release())
240	                self._add_attribute(span, "platform_system", platform.system())
241	                self._add_attribute(span, "platform_version", platform.version())

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/telemetry/telemetry.py:240
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
239	                self._add_attribute(span, "platform_release", platform.release())
240	                self._add_attribute(span, "platform_system", platform.system())
241	                self._add_attribute(span, "platform_version", platform.version())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/utilities/embedding_configurator.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	        return OllamaEmbeddingFunction(
101	            url=config.get("url", "http://localhost:11434/api/embeddings"),
102	            model_name=model_name,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/utilities/file_handler.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	                        json.dump(existing_data, write_file, indent=4)
51	                        write_file.write("\n")
52	            

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/utilities/file_handler.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	                with open(self._path, "a", encoding="utf-8") as file:
57	                    file.write(message)
58	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    os.environ["OPENAI_API_KEY"] = "test_api_key"
32	    os.environ["OPENAI_API_BASE"] = "https://test-api-base.com"
33	    os.environ["OPENAI_MODEL_NAME"] = "gpt-4-turbo"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    assert agent.llm.api_key == "test_api_key"
42	    assert agent.llm.base_url == "https://test-api-base.com"
43	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    assert agent.llm.api_key != "test_api_key"
56	    assert agent.llm.base_url != "https://test-api-base.com"
57	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:1388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1387	            top_logprobs=5,
1388	            base_url="https://api.openai.com/v1",
1389	            api_version="2023-05-15",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:1410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1409	    assert agent.llm.top_logprobs == 5
1410	    assert agent.llm.base_url == "https://api.openai.com/v1"
1411	    assert agent.llm.api_version == "2023-05-15"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:1438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1437	        backstory="test backstory",
1438	        llm=LLM(model="ollama/llama3.2:3b", base_url="http://localhost:11434"),
1439	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:1443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1442	    assert agent.llm.model == "ollama/llama3.2:3b"
1443	    assert agent.llm.base_url == "http://localhost:11434"
1444	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:1457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1456	        model="ollama/llama3.2:3b",
1457	        base_url="http://localhost:11434",
1458	        temperature=0.7,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/agent_test.py:1565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1564	        backstory="test backstory",
1565	        llm=LLM(model="ollama/llama3.2:3b", base_url="http://localhost:11434"),
1566	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/authentication/test_auth_main.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	            "user_code": "ABCDEF",
19	            "verification_uri_complete": "https://example.com",
20	            "interval": 5,
21	        }
22	        mock_post.return_value = mock_response
23	
24	        device_code_data = self.auth_command._get_device_code()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/authentication/test_auth_main.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	        self.assertEqual(
29	            device_code_data["verification_uri_complete"], "https://example.com"
30	        )
31	        self.assertEqual(device_code_data["interval"], 5)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/authentication/test_auth_main.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        device_code_data = {
37	            "verification_uri_complete": "https://example.com",
38	            "user_code": "ABCDEF",
39	        }
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/authentication/test_auth_main.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	
43	        mock_print.assert_any_call("1. Navigate to: ", "https://example.com")
44	        mock_print.assert_any_call("2. Enter the following code: ", "ABCDEF")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/authentication/test_auth_main.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        mock_print.assert_any_call("2. Enter the following code: ", "ABCDEF")
45	        mock_open.assert_called_once_with("https://example.com")
46	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/authentication/test_utils.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        mock_asymmetric_verifier.assert_called_once_with(
21	            "https://crewai.us.auth0.com/.well-known/jwks.json"
22	        )
23	        mock_token_verifier.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/authentication/test_utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            signature_verifier=mock_asymmetric_verifier.return_value,
25	            issuer="https://crewai.us.auth0.com/",
26	            audience="DEVC5Fw6NlRoSzmDCcOhVq85EfLBjKa8",

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/config_test.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
15	    def tearDown(self):
16	        shutil.rmtree(self.test_dir)
17	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/config_test.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
93	        with self.config_path.open("w") as f:
94	            f.write("invalid json")
95	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/deploy/test_deploy_main.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	        mock_fetch_env.return_value = {"ENV_VAR": "value"}
150	        mock_git_origin_url.return_value = "https://github.com/test/repo.git"
151	        mock_input.return_value = ""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_git.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	        ["git", "remote", "get-url", "origin"],
100	        stdout="https://github.com/user/repo.git\n",
101	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_git.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	    )
102	    assert repository.origin_url() == "https://github.com/user/repo.git"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_plus_api.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	            custom_api.base_url,
196	            "https://custom-url.com/api",
197	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_plus_api.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	
191	    @patch.dict(os.environ, {"CREWAI_BASE_URL": "https://custom-url.com/api"})
192	    def test_custom_base_url(self):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
22	
23	    shutil.rmtree(root_dir)
24	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
27	    with open(path, "w") as f:
28	        f.write(content)
29	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
27	    with open(path, "w") as f:
28	        f.write(content)
29	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	    with open(os.path.join(temp_tree, "file1.txt"), "r") as f:
34	        assert f.read() == "Hello, universe!"
35	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	    with open(os.path.join(temp_tree, "nested_dir", "nested_file.txt"), "r") as f:
55	        assert f.read() == "Updated content"
56	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
78	    finally:
79	        shutil.rmtree(dest_dir)
80	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	        with open(os.path.join(dest_dir, "file1.txt"), "r") as f:
87	            assert f.read() == "Hello, world!"
88	        with open(os.path.join(dest_dir, "nested_dir", "nested_file.txt"), "r") as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
88	        with open(os.path.join(dest_dir, "nested_dir", "nested_file.txt"), "r") as f:
89	            assert f.read() == "Nested content"
90	    finally:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
90	    finally:
91	        shutil.rmtree(dest_dir)
92	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/test_utils.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
101	    finally:
102	        shutil.rmtree(dest_dir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/tools/test_main.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	        with open(os.path.join("test_tool", "src", "test_tool", "tool.py"), "r") as f:
47	            content = f.read()
48	            assert "class TestTool" in content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/tools/test_main.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        "handle": "sample-tool",
63	        "repository": {"handle": "sample-repo", "url": "https://example.com/repo"},
64	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/cli/tools/test_main.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	            "--index",
80	            "sample-repo=https://example.com/repo",
81	            "sample-tool",
82	        ],
83	        capture_output=False,
84	        text=True,
85	        check=True,
86	        env=unittest.mock.ANY,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/crew_test.py:3699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3698	                "image_url": {
3699	                    "url": "https://example.com/test-image.jpg",
3700	                },
3701	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/crew_test.py:3730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3729	        result = image_tool._run(
3730	            image_url="https://example.com/test-image.jpg",
3731	            action="Please analyze this image",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/crew_test.py:3761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3760	    inspection_task = Task(
3761	        description="""
3762	        Analyze the product image at https://www.us.maguireshoes.com/cdn/shop/files/FW24-Edito-Lucena-Distressed-01_1920x.jpg?v=1736371244 with focus on:
3763	        1. Quality of materials
3764	        2. Manufacturing defects
3765	        3. Compliance with standards
3766	        Provide a detailed report highlighting any issues found.
3767	        """,
3768	        expected_output="A detailed report highlighting any issues found",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/crew_test.py:3813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3812	        inputs={
3813	            "image_url": "https://media.istockphoto.com/id/946087016/photo/aerial-view-of-lower-manhattan-new-york.jpg?s=612x612&w=0&k=20&c=viLiMRznQ8v5LzKTt_LvtfPFUVl1oiyiemVdSlm29_k="
3814	        }
3815	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/knowledge/knowledge_test.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
552	        file_paths=[
553	            "https://lilianweng.github.io/posts/2024-11-28-reward-hacking/",
554	        ],
555	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/knowledge/knowledge_test.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
571	    urls: List[Union[Path, str]] = [
572	        "https://lilianweng.github.io/posts/2024-11-28-reward-hacking/",
573	        "https://lilianweng.github.io/posts/2024-07-07-hallucination/",
574	    ]
575	    docling_source = CrewDoclingSource(file_paths=urls)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/knowledge/knowledge_test.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
572	        "https://lilianweng.github.io/posts/2024-11-28-reward-hacking/",
573	        "https://lilianweng.github.io/posts/2024-07-07-hallucination/",
574	    ]
575	    docling_source = CrewDoclingSource(file_paths=urls)
576	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/llm_test.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
391	        model="openrouter/deepseek/deepseek-r1",
392	        base_url="https://openrouter.ai/api/v1",
393	        api_key=os.getenv("OPEN_ROUTER_API_KEY"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/project_test.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	            api_key="None",
48	            base_url="http://xxx.xxx.xxx.xxx:8000/v1")
49	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/task_test.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
601	    assert output_file_exists
602	    assert {"score": 4} == json.loads(open("score.json").read())
603	    if output_file_exists:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/task_test.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
631	    assert output_file_exists
632	    assert {"score": 4} == json.loads(open("score.json").read())
633	    if output_file_exists:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/test_multimodal_validation.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    inspection_task = Task(
35	        description="""
36	        Analyze the product image at https://www.us.maguireshoes.com/collections/spring-25/products/lucena-black-boot with focus on:
37	        1. Quality of materials
38	        2. Manufacturing defects
39	        3. Compliance with standards
40	        Provide a detailed report highlighting any issues found.
41	        """,
42	        expected_output="A detailed report highlighting any issues found",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/utilities/test_chromadb_utils.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
53	        """Test sanitizing an IPv4 address."""
54	        ipv4 = "192.168.1.1"
55	        sanitized = sanitize_collection_name(ipv4)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/utilities/test_chromadb_utils.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
62	        """Test IPv4 pattern detection."""
63	        self.assertTrue(is_ipv4_pattern("192.168.1.1"))
64	        self.assertFalse(is_ipv4_pattern("not.an.ip.address"))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/utilities/test_chromadb_utils.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
72	            "contains@special#characters",
73	            "192.168.1.1",  # IPv4 address
74	            "a" * 2,  # Too short
75	        ]
76	        for test_case in test_cases:
77	            sanitized = sanitize_collection_name(test_case)
78	            self.assertGreaterEqual(len(sanitized), MIN_COLLECTION_LENGTH)
79	            self.assertLessEqual(len(sanitized), MAX_COLLECTION_LENGTH)
80	            self.assertTrue(sanitized[0].isalnum())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/utilities/test_converter.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	def test_get_conversion_instructions_non_gpt():
234	    llm = LLM(model="ollama/llama3.1", base_url="http://localhost:11434")
235	    with patch.object(LLM, "supports_function_calling", return_value=False):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/utilities/test_converter.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	def test_converter_with_llama3_2_model():
362	    llm = LLM(model="ollama/llama3.2:3b", base_url="http://localhost:11434")
363	    sample_text = "Name: Alice Llama, Age: 30"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/utilities/test_converter.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
379	def test_converter_with_llama3_1_model():
380	    llm = LLM(model="ollama/llama3.1", base_url="http://localhost:11434")
381	    sample_text = "Name: Alice Llama, Age: 30"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/tests/utilities/test_file_handler.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	        with open(self.file_path, "wb") as file:
39	            file.write(b"corrupted data")
40	

--------------------------------------------------

Code scanned:
	Total lines of code: 32515
	Total lines skipped (#nosec): 2

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 51.0
		High: 63.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 109.0
		High: 5.0
Files skipped (4):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/templates/crew/crew.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/templates/crew/main.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/templates/flow/main.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/crewai-0.114.0/crewai-0.114.0/src/crewai/cli/templates/tool/src/{{folder_name}}/tool.py (syntax error while parsing AST from file)
