Run started:2025-04-12 13:17:41.403322

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	TEMPLATE: Final[str] = """# -*- coding: utf-8 -*-
18	\"""
19	Auto-generated file {datetime} UTC (v3)
20	Resource: https://github.com/google/libphonenumber {version}
21	\"""
22	
23	
24	PATTERNS = {patterns}
25	
26	"""
27	XML_FILE: Final[str] = "PhoneNumberMetadata.xml"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	ARCHIVE_PATH: Final[str] = "libphonenumber-{version}/resources/{file}"
29	SOURCE_TAG: Final[str] = "https://github.com/google/libphonenumber/archive/{tag}.tar.gz"
30	DATETIME_FORMAT: Final[str] = "%Y-%m-%d %H:%M:%S"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	            attrs = territory.attrib
53	            if (code := attrs.get("id", "1")).isdigit():
54	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	                continue
55	            value = {"code": attrs.get("countryCode", "")}
56	            for fixed_line in territory.iter(self.line_tag):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	def get_latest() -> str:
67	    response = requests.get("https://github.com/google/libphonenumber/releases/latest")
68	    return response.url.split("/")[-1]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	def get_latest() -> str:
67	    response = requests.get("https://github.com/google/libphonenumber/releases/latest")
68	    return response.url.split("/")[-1]

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
71	def parsing_xml(file: Path) -> Dict[str, Dict[str, str]]:
72	    with file.open("rb") as _file:
73	        parser = Parser(_file.read().decode())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	        with tempfile.TemporaryDirectory() as tmpdir:
87	            response = requests.get(SOURCE_TAG.format(tag=tag), stream=True)
88	            if not response.ok:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
89	                raise ValueError(f"Invalid tag: {tag}")
90	            with tarfile.open(fileobj=io.BytesIO(response.content)) as tar_file:
91	                archive_path = ARCHIVE_PATH.format(version=version, file=XML_FILE)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
97	            patterns_path = root / "phone_gen" / "patterns.py"
98	            with patterns_path.open("wb") as _file:
99	                temp = TEMPLATE.format(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/patterns_generator.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
103	                )
104	                _file.write(temp.encode())
105	        return version

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/update.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	def check_phonenumbers_libs(version: str) -> bool:
46	    response = requests.get("https://pypi.org/pypi/phonenumbers/json")
47	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/dev_tools/update.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	def check_phonenumbers_libs(version: str) -> bool:
46	    response = requests.get("https://pypi.org/pypi/phonenumbers/json")
47	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/setup.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    packages=find_packages(exclude=("tests", "dev_tools")),
12	    url="https://github.com/tolstislon/phone-gen",
13	    license="MIT License",

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
13	def test_get_country(capfd: pytest.CaptureFixture, country: str, arg: str):
14	    os.system(f"phone-gen {arg}{country}")
15	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
13	def test_get_country(capfd: pytest.CaptureFixture, country: str, arg: str):
14	    os.system(f"phone-gen {arg}{country}")
15	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
23	def test_get_without_country_code(capfd: pytest.CaptureFixture, country: str, arg: str):
24	    os.system(f"phone-gen -f{arg} {country}")
25	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
23	def test_get_without_country_code(capfd: pytest.CaptureFixture, country: str, arg: str):
24	    os.system(f"phone-gen -f{arg} {country}")
25	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
31	def test_invalid_country(capfd: pytest.CaptureFixture):
32	    os.system("phone-gen qwe")
33	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
31	def test_invalid_country(capfd: pytest.CaptureFixture):
32	    os.system("phone-gen qwe")
33	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
42	def test_find_country_name(capfd: pytest.CaptureFixture, country_name: str, code: str, arg: str):
43	    os.system(f"phone-gen {arg}{country_name}")
44	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:43
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
42	def test_find_country_name(capfd: pytest.CaptureFixture, country_name: str, code: str, arg: str):
43	    os.system(f"phone-gen {arg}{country_name}")
44	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
52	def test_find_iso3(capfd: pytest.CaptureFixture, iso: str, code: str, arg: str):
53	    os.system(f"phone-gen {arg}{iso}")
54	    captured = capfd.readouterr()

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/phone_gen-3.0.16/phone_gen-3.0.16/tests/test_cli.py:53
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
52	def test_find_iso3(capfd: pytest.CaptureFixture, iso: str, code: str, arg: str):
53	    os.system(f"phone-gen {arg}{iso}")
54	    captured = capfd.readouterr()

--------------------------------------------------

Code scanned:
	Total lines of code: 2096
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 5.0
Files skipped (0):
