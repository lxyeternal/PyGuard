Run started:2025-04-12 15:55:21.928957

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/config.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
10	def config_location():
11	    if platform.system() == 'Windows':
12	        return os.getenv('LOCALAPPDATA') + '\\dbcli\\mssqlcli\\'

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/config.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
10	def config_location():
11	    if platform.system() == 'Windows':
12	        return os.getenv('LOCALAPPDATA') + '\\dbcli\\mssqlcli\\'

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/config.py:11
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
10	def config_location():
11	    if platform.system() == 'Windows':
12	        return os.getenv('LOCALAPPDATA') + '\\dbcli\\mssqlcli\\'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/config.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	    cfg = load_config(config, def_config)
47	    cfg.write()
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/main.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	
19	MSSQLCLI_TELEMETRY_PROMPT = """
20	Telemetry
21	---------
22	By default, mssql-cli collects usage data in order to improve your experience.
23	The data is anonymous and does not include commandline argument values.
24	The data is collected by Microsoft.
25	
26	Disable telemetry collection by setting environment variable MSSQL_CLI_TELEMETRY_OPTOUT to 'True' or '1'.
27	
28	Microsoft Privacy statement: https://go.microsoft.com/fwlink/?LinkId=521839
29	"""
30	
31	
32	def run_cli_with(options):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/main.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
63	                        with io.open(options.input_file, 'r', encoding='utf-8') as f:
64	                            text = f.read()
65	                    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/main.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	                        with open(options.input_file, 'r', encoding='utf-8') as f:
67	                            text = f.read()
68	                except OSError as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/mssql_cli.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
420	            print('Mail: sqlcli@microsoft.com')
421	            print('Home: http://github.com/dbcli/mssql-cli')
422	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/mssqltoolsservice/__init__.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
24	    mssqltoolsservice_name = u'MicrosoftSqlToolsServiceLayer{}'.format(
25	        u'.exe' if (platform.system() == u'Windows') else u'')
26	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/mssqltoolsservice/__init__.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
24	    mssqltoolsservice_name = u'MicrosoftSqlToolsServiceLayer{}'.format(
25	        u'.exe' if (platform.system() == u'Windows') else u'')
26	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/mssqltoolsservice/__init__.py:25
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
24	    mssqltoolsservice_name = u'MicrosoftSqlToolsServiceLayer{}'.format(
25	        u'.exe' if (platform.system() == u'Windows') else u'')
26	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/mssqltoolsservice/externals.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
45	    if copy_file_path.endswith('tar.gz'):
46	        compressed_file = tarfile.open(name=copy_file_path, mode='r:gz')
47	    elif copy_file_path.endswith('.zip'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/packages/special/commands.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
360	    with io.open(expanduser(path), encoding='utf-8') as f:
361	        contents = f.read()
362	    return contents

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
89	            'Context.Default.SQLTools.ExeVersion': _get_mssql_cli_version(),
90	            'Context.Default.SQLTools.OS.Type': platform.system().lower(),
91	            'Context.Default.SQLTools.OS.Version': platform.release().lower(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
89	            'Context.Default.SQLTools.ExeVersion': _get_mssql_cli_version(),
90	            'Context.Default.SQLTools.OS.Type': platform.system().lower(),
91	            'Context.Default.SQLTools.OS.Version': platform.release().lower(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
89	            'Context.Default.SQLTools.ExeVersion': _get_mssql_cli_version(),
90	            'Context.Default.SQLTools.OS.Type': platform.system().lower(),
91	            'Context.Default.SQLTools.OS.Version': platform.release().lower(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	@decorators.suppress_all_exceptions(raise_in_diagnostics=True)
122	def conclude(service_endpoint_uri='https://vortex.data.microsoft.com/collect/v1',
123	             separate_process=True):
124	    _session.end_time = datetime.now()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
179	            user_id = _generate_user_id()
180	            file.write(user_id)
181	            return user_id

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	        with open(full_path, 'r') as file:
184	            user_id = file.read()
185	            return user_id

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry_upload.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    """
38	    def __init__(self, service_endpoint_uri='https://vortex.data.microsoft.com/collect/v1'):
39	        SynchronousSender.__init__(self, service_endpoint_uri)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry_upload.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
45	        """
46	        request_payload = json.dumps([a.write() for a in data_to_send]).strip('[').strip(']')
47	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry_upload.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
52	        try:
53	            response = HTTPClient.urlopen(request, timeout=self._timeout)
54	            status_code = response.getcode()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry_upload.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	    if in_diagnostic_mode():
136	        sys.stdout.write('Telemetry upload begins\n')
137	        sys.stdout.write('Got data {}\n'.format(json.dumps(json.loads(data_to_save), indent=2)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry_upload.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
136	        sys.stdout.write('Telemetry upload begins\n')
137	        sys.stdout.write('Got data {}\n'.format(json.dumps(json.loads(data_to_save), indent=2)))
138	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry_upload.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142	        if in_diagnostic_mode():
143	            sys.stdout.write('{}/n'.format(str(err)))
144	            sys.stdout.write('Raw [{}]/n'.format(data_to_save))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry_upload.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
143	            sys.stdout.write('{}/n'.format(str(err)))
144	            sys.stdout.write('Raw [{}]/n'.format(data_to_save))
145	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mssql_cli-1.0.0-py2.py3-none-win_amd64/mssqlcli/telemetry_upload.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	        if in_diagnostic_mode():
165	            sys.stdout.write('\nTelemetry upload completes\n')
166	

--------------------------------------------------

Code scanned:
	Total lines of code: 4903
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 3.0
Files skipped (0):
