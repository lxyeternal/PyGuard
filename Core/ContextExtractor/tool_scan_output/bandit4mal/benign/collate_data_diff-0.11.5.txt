Run started:2025-04-12 15:23:10.440937

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/__main__.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
108	    def write_usage(self, prog: str, args: str = "", prefix: Optional[str] = None) -> None:
109	        self.write(f"data-diff v{__version__} - efficiently diff rows across database tables.\n\n")
110	        self.write("Usage:\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/__main__.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
109	        self.write(f"data-diff v{__version__} - efficiently diff rows across database tables.\n\n")
110	        self.write("Usage:\n")
111	        self.write(f"  * In-db diff:    {prog} <database_a> <table_a> <table_b> [OPTIONS]\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/__main__.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
110	        self.write("Usage:\n")
111	        self.write(f"  * In-db diff:    {prog} <database_a> <table_a> <table_b> [OPTIONS]\n")
112	        self.write(f"  * Cross-db diff: {prog} <database_a> <table_a> <database_b> <table_b> [OPTIONS]\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/__main__.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	        self.write(f"  * In-db diff:    {prog} <database_a> <table_a> <table_b> [OPTIONS]\n")
112	        self.write(f"  * Cross-db diff: {prog} <database_a> <table_a> <database_b> <table_b> [OPTIONS]\n")
113	        self.write(f"  * Using config:  {prog} --conf PATH [--run NAME] [OPTIONS]\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/__main__.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	        self.write(f"  * Cross-db diff: {prog} <database_a> <table_a> <database_b> <table_b> [OPTIONS]\n")
113	        self.write(f"  * Using config:  {prog} --conf PATH [--run NAME] [OPTIONS]\n")
114	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/data_source.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	            rich.print(
128	                f'[red]Cannot extract bigquery credentials from dbt_project.yml for "{method}" type. '
129	                f"If you want to provide credentials via dbt_project.yml, "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	    headers: str = ""
189	    host: str = "https://app.datafold.com"
190	    timeout: int = 30

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
199	    def make_get_request(self, url: str) -> Any:
200	        rv = requests.get(url=f"{self.host}/{url}", headers=self.headers, timeout=self.timeout)
201	        rv.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
204	    def make_post_request(self, url: str, payload: Any) -> Any:
205	        rv = requests.post(url=f"{self.host}/{url}", headers=self.headers, json=payload, timeout=self.timeout)
206	        rv.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
209	    def get_data_sources(self) -> List[TCloudApiDataSource]:
210	        rv = self.make_get_request(url="api/v1/data_sources")
211	        rv.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
214	    def get_data_source(self, data_source_id: int) -> TCloudApiDataSource:
215	        rv = self.make_get_request(url=f"api/v1/data_sources")
216	        rv.raise_for_status()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
228	            json_string = payload["options"]["jsonKeyFile"].encode("utf-8")
229	            payload["options"]["jsonKeyFile"] = base64.b64encode(json_string).decode("utf-8")
230	        rv = self.make_post_request(url="api/v1/data_sources", payload=payload)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:229
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
228	            json_string = payload["options"]["jsonKeyFile"].encode("utf-8")
229	            payload["options"]["jsonKeyFile"] = base64.b64encode(json_string).decode("utf-8")
230	        rv = self.make_post_request(url="api/v1/data_sources", payload=payload)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
229	            payload["options"]["jsonKeyFile"] = base64.b64encode(json_string).decode("utf-8")
230	        rv = self.make_post_request(url="api/v1/data_sources", payload=payload)
231	        return TCloudApiDataSource(**rv.json())

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
236	    ) -> List[TCloudApiDataSourceConfigSchema]:
237	        rv = self.make_get_request(url="api/v1/data_sources/types")
238	        return [

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
247	    def create_data_diff(self, payload: TCloudApiDataDiff) -> int:
248	        rv = self.make_post_request(url="api/v1/datadiffs", payload=payload.dict())
249	        return rv.json()["id"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
260	            logger.debug("Polling Datafold for results...")
261	            response = self.make_get_request(url=f"api/v1/datadiffs/{diff_id}/summary_results")
262	            response_json = response.json()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
278	    def test_data_source(self, data_source_id: int) -> int:
279	        rv = self.make_post_request(f"api/v1/data_sources/{data_source_id}/test", {})
280	        return rv.json()["job_id"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
282	    def check_data_source_test_results(self, job_id: int) -> List[TCloudApiDataSourceTestResult]:
283	        rv = self.make_get_request(f"api/v1/data_sources/test/{job_id}")
284	        return [

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/cloud/datafold_api.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
299	    def get_org_meta(self) -> TCloudApiOrgMeta:
300	        response = self.make_get_request(f"api/v1/organization/meta")
301	        response_json = response.json()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/databases/base.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1235	    def __attrs_post_init__(self) -> None:
1236	        self._queue = ThreadPoolExecutor(self.thread_count, initializer=self.set_conn)
1237	        logger.info(f"[{self.name}] Starting a threadpool, size={self.thread_count}.")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/databases/bigquery.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	                keyfile,
245	                scopes=["https://www.googleapis.com/auth/cloud-platform"],
246	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/databases/bigquery.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
251	                target_principal=impersonate_service_account,
252	                target_scopes=["https://www.googleapis.com/auth/cloud-platform"],
253	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/dbt.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	logger = getLogger(__name__)
53	CLOUD_DOC_URL = "https://docs.datafold.com/development_testing/cloud"
54	DATAFOLD_TRIAL_URL = "https://app.datafold.com/org-signup"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/dbt.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	CLOUD_DOC_URL = "https://docs.datafold.com/development_testing/cloud"
54	DATAFOLD_TRIAL_URL = "https://app.datafold.com/org-signup"
55	DATAFOLD_INSTRUCTIONS_URL = "https://docs.datafold.com/development_testing/datafold_cloud"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/dbt.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	DATAFOLD_TRIAL_URL = "https://app.datafold.com/org-signup"
55	DATAFOLD_INSTRUCTIONS_URL = "https://docs.datafold.com/development_testing/datafold_cloud"
56	
57	
58	class TDiffVars(pydantic.BaseModel):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/dbt.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	    if not state and not (config.prod_database or config.prod_schema):
93	        doc_url = "https://docs.datafold.com/development_testing/open_source#configure-your-dbt-project"
94	        raise DataDiffDbtProjectVarsNotFoundError(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/dbt.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
118	
119	    with log_status_handler.status if log_status_handler else nullcontext(), ThreadPoolExecutor(
120	        max_workers=dbt_parser.threads
121	    ) as executor:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/dbt.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
252	                    f"Found a custom schema on model {model.name}, but no value for\nvars:\n  data_diff:\n    prod_custom_schema:\nPlease set a value or utilize the `--state` flag!\n\n"
253	                    + "For more details see: https://docs.datafold.com/development_testing/open_source"
254	                )
255	            prod_schema = config.prod_custom_schema.replace("<custom_schema>", custom_schema)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/dbt.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
404	    if datafold_host is None:
405	        datafold_host = "https://app.datafold.com"
406	    datafold_host = datafold_host.rstrip("/")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/dbt_parser.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	            logger.warning(
265	                f"{dbt_version} is a recent version of dbt and may not be fully tested with data-diff! \nPlease report any issues to https://github.com/datafold/data-diff/issues"
266	            )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/diff_tables.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
45	
46	        with ThreadPoolExecutor(max_workers=self.max_threadpool_size) as task_pool:
47	            return task_pool.map(func, iterable)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/diff_tables.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
57	
58	        with ThreadPoolExecutor(max_workers=self.max_threadpool_size) as task_pool:
59	            futures = [task_pool.submit(func, item) for item in iterable]

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/diff_tables.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
68	    def _run_in_background(self, *funcs):
69	        with ThreadPoolExecutor(max_workers=self.max_threadpool_size) as task_pool:
70	            futures = [task_pool.submit(f) for f in funcs if f is not None]

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/thread_utils.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
62	        super().__init__()
63	        self._pool = PriorityThreadPoolExecutor(max_workers)
64	        self._futures = deque()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/tracking.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	TRACK_URL = "https://hosted.rudderlabs.com/v1/track"
19	START_EVENT = "os_diff_run_start"

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/tracking.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
231	        req = urllib.request.Request(TRACK_URL, data=data, headers=headers)
232	        with urllib.request.urlopen(req, timeout=TIMEOUT) as f:
233	            res = f.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/tracking.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
232	        with urllib.request.urlopen(req, timeout=TIMEOUT) as f:
233	            res = f.read()
234	            if f.code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/utils.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
410	        raise exception
411	    result = dictionary.get(key)
412	    if result is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/utils.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
562	    try:
563	        response = requests.get(url="https://pypi.org/pypi/data-diff/json", timeout=3)
564	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/collate_data_diff-0.11.5/collate_data_diff-0.11.5/data_diff/utils.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
562	    try:
563	        response = requests.get(url="https://pypi.org/pypi/data-diff/json", timeout=3)
564	        response.raise_for_status()

--------------------------------------------------

Code scanned:
	Total lines of code: 8913
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 1.0
Files skipped (0):
