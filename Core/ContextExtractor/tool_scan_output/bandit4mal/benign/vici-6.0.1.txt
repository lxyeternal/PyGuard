Run started:2025-04-12 11:34:47.175298

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    author_email="info@strongswan.org",
13	    url="https://docs.strongswan.org/docs/latest/plugins/vici.html",
14	    license="MIT",

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_protocol.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
154	    def test_sendrecv(self):
155	        c, s = self.interconnect()
156	        c.send(b"foo")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_protocol.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
155	        c, s = self.interconnect()
156	        c.send(b"foo")
157	        assert s.receive() == b"foo"

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_protocol.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
157	        assert s.receive() == b"foo"
158	        s.send(b"foobarbaz")
159	        s.send(b"")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_protocol.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
158	        s.send(b"foobarbaz")
159	        s.send(b"")
160	        assert c.receive() == b"foobarbaz"

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_protocol.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
163	    def test_timeout(self):
164	        c, s = self.interconnect()
165	        c.send(b"foo")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_protocol.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
164	        c, s = self.interconnect()
165	        c.send(b"foo")
166	        assert s.receive(timeout=1) == b"foo"

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
23	            payload += Message.serialize(message)
24	        self.transport.send(payload)
25	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
48	    def test_request(self):
49	        c, s = self.interconnect()
50	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
50	
51	        s.send(Packet.CMD_RESPONSE)
52	        assert c.request("doit") == {}

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
52	        assert c.request("doit") == {}
53	        assert s.recv() == (Packet.CMD_REQUEST, b"doit")
54	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
54	
55	        s.send(Packet.CMD_RESPONSE, message={"hey": b"hou"})
56	        assert c.request("heyhou") == {"hey": b"hou"}

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
56	        assert c.request("heyhou") == {"hey": b"hou"}
57	        assert s.recv() == (Packet.CMD_REQUEST, b"heyhou")
58	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
59	    def test_streamed(self):
60	        c, s = self.interconnect()
61	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
61	
62	        s.send(Packet.EVENT_CONFIRM)
63	        for e in self.events:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
63	        for e in self.events:
64	            s.send(Packet.EVENT, name="stream", message=e)
65	        s.send(Packet.CMD_RESPONSE)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
64	            s.send(Packet.EVENT, name="stream", message=e)
65	        s.send(Packet.CMD_RESPONSE)
66	        s.send(Packet.EVENT_CONFIRM)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
65	        s.send(Packet.CMD_RESPONSE)
66	        s.send(Packet.EVENT_CONFIRM)
67	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
68	        assert list(c.streamed_request("streamit", "stream")) == self.events
69	        assert s.recv() == (Packet.EVENT_REGISTER, b"stream")
70	        assert s.recv() == (Packet.CMD_REQUEST, b"streamit")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
69	        assert s.recv() == (Packet.EVENT_REGISTER, b"stream")
70	        assert s.recv() == (Packet.CMD_REQUEST, b"streamit")
71	        assert s.recv() == (Packet.EVENT_UNREGISTER, b"stream")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
70	        assert s.recv() == (Packet.CMD_REQUEST, b"streamit")
71	        assert s.recv() == (Packet.EVENT_UNREGISTER, b"stream")
72	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
73	    def test_timeout(self):
74	        c, s = self.interconnect()
75	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
75	
76	        s.send(Packet.EVENT_CONFIRM)
77	        s.send(Packet.EVENT_CONFIRM)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
76	        s.send(Packet.EVENT_CONFIRM)
77	        s.send(Packet.EVENT_CONFIRM)
78	        for e in self.events:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
78	        for e in self.events:
79	            s.send(Packet.EVENT, name="event", message=e)
80	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
86	                if i > 2:
87	                    s.send(Packet.EVENT, name="event", message={"late": b'1'})
88	                    s.send(Packet.EVENT_CONFIRM)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
87	                    s.send(Packet.EVENT, name="event", message={"late": b'1'})
88	                    s.send(Packet.EVENT_CONFIRM)
89	                    s.send(Packet.EVENT_CONFIRM)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
88	                    s.send(Packet.EVENT_CONFIRM)
89	                    s.send(Packet.EVENT_CONFIRM)
90	                    break

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
94	
95	        assert s.recv() == (Packet.EVENT_REGISTER, b"xyz")
96	        assert s.recv() == (Packet.EVENT_REGISTER, b"event")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
95	        assert s.recv() == (Packet.EVENT_REGISTER, b"xyz")
96	        assert s.recv() == (Packet.EVENT_REGISTER, b"event")
97	        assert s.recv() == (Packet.EVENT_UNREGISTER, b"xyz")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
96	        assert s.recv() == (Packet.EVENT_REGISTER, b"event")
97	        assert s.recv() == (Packet.EVENT_UNREGISTER, b"xyz")
98	        assert s.recv() == (Packet.EVENT_UNREGISTER, b"event")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/test/test_session.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
97	        assert s.recv() == (Packet.EVENT_UNREGISTER, b"xyz")
98	        assert s.recv() == (Packet.EVENT_UNREGISTER, b"event")
99	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/protocol.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
21	    def send(self, packet):
22	        self.socket.sendall(struct.pack("!I", len(packet)) + packet)
23	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/protocol.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
31	        self.socket.shutdown(socket.SHUT_RDWR)
32	        self.socket.close()
33	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/protocol.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
38	        if timeout is not RECV_TIMEOUT_DEFAULT:
39	            self.socket.settimeout(timeout)
40	        try:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/protocol.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
41	            while len(data) < count:
42	                buf = self.socket.recv(count - len(data))
43	                self.socket.settimeout(None)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/protocol.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
42	                buf = self.socket.recv(count - len(data))
43	                self.socket.settimeout(None)
44	                if not buf:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/protocol.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
47	        finally:
48	            self.socket.settimeout(old_timeout)
49	        return data

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
29	        if sock is None:
30	            if platform.system() == "Windows":
31	                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
29	        if sock is None:
30	            if platform.system() == "Windows":
31	                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
30	            if platform.system() == "Windows":
31	                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
32	                sock.connect(('127.0.0.1', 4502))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
31	                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
32	                sock.connect(('127.0.0.1', 4502))
33	            else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
31	                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
32	                sock.connect(('127.0.0.1', 4502))
33	            else:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
33	            else:
34	                sock = socket.socket(socket.AF_UNIX)
35	                sock.connect("/var/run/charon.vici")

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
34	                sock = socket.socket(socket.AF_UNIX)
35	                sock.connect("/var/run/charon.vici")
36	        self.transport = Transport(sock)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
45	        """
46	        self.transport.send(packet)
47	        return Packet.parse(self.transport.receive())

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/vici-6.0.1/vici-6.0.1/vici/session.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
130	            packet = Packet.request(command, message)
131	            self.transport.send(packet)
132	            exited = False

--------------------------------------------------

Code scanned:
	Total lines of code: 853
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 42.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 44.0
		High: 3.0
Files skipped (0):
