Run started:2025-04-12 14:56:36.295176

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/api.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	        self.key = key
15	        self.url = url or 'https://{host}'.format(host=region.api_host)
16	        ClientBase.__init__(self, retries=retries,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/api.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
97	            if isinstance(content, str):
98	                content = base64.b64encode(content.encode('utf-8')).decode()
99	            else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/api.py:98
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
97	            if isinstance(content, str):
98	                content = base64.b64encode(content.encode('utf-8')).decode()
99	            else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/api.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
99	            else:
100	                content = base64.b64encode(content).decode()
101	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/api.py:100
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
99	            else:
100	                content = base64.b64encode(content).decode()
101	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/client_base.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
36	        try:
37	            response = self.http.request(
38	                method, url=url, json=self._sanitize(data), timeout=self.timeout)
39	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/client_base.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	            # experiencing an outage and refer them to system status page.
48	            message = '''Failed to receive valid response after {count} retries.
49	Check system status at http://status.customer.io.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/track.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    def setup_base_url(self):
39	        template = 'https://{host}:{port}/{prefix}'
40	        if self.port == 443:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/customerio/track.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        if self.port == 443:
41	            template = 'https://{host}/{prefix}'
42	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/setup.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
6	with open(os.path.join(here, 'customerio', '__version__.py')) as f:
7	        exec(f.read(), version)
8	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/setup.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6	with open(os.path.join(here, 'customerio', '__version__.py')) as f:
7	        exec(f.read(), version)
8	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    description="Customer.io Python bindings.",
16	    url="https://github.com/customerio/customerio-python",
17	    packages=find_packages(),

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/server.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
45	        content_len = int(self.headers.get('content-length', 0))
46	        params = json.loads(self.rfile.read(content_len).decode('utf-8'))
47	        fail_count = params.get('fail_count', 0)

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/server.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
76	        # create a server
77	        cls.server = HTTPServer(("localhost", 0), Handler)
78	        # hack needed to setup ssl server

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/server.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
84	        # start server instance in new thread
85	        cls.server_thread = threading.Thread(target=cls.server.serve_forever)
86	        cls.server_thread.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_api.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            key='app_api_key',
25	            url="https://{addr}:{port}".format(
26	                addr=self.server.server_address[0], port=self.server.server_port))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_api.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        client = APIClient(key='app_api_key')
45	        self.assertEqual(client.url, 'https://{host}'.format(host=Regions.US.api_host))
46	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_api.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        client = APIClient(key='app_api_key', region=Regions.US)
48	        self.assertEqual(client.url, 'https://{host}'.format(host=Regions.US.api_host))
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_api.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	        client = APIClient(key='app_api_key', region=Regions.EU)
51	        self.assertEqual(client.url, 'https://{host}'.format(host=Regions.EU.api_host))
52	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_api.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
60	        data = "1,2,3"
61	        expected = base64.b64encode(bytes(data,"utf-8")).decode()
62	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_api.py:61
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
60	        data = "1,2,3"
61	        expected = base64.b64encode(bytes(data,"utf-8")).decode()
62	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	        body = request.body.decode('utf-8') if isinstance(request.body, bytes) else request.body
34	        if rq.get('method', None):
35	            self.assertEqual(request.method, rq['method'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	            self.assertEqual(request.method, rq['method'])
36	        if rq.get('body', None):
37	            self.assertEqual(json.loads(body), rq['body'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	            self.assertEqual(json.loads(body), rq['body'])
38	        if rq.get('authorization', None):
39	            self.assertEqual(request.headers['Authorization'], rq['authorization'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	            self.assertEqual(request.headers['Authorization'], rq['authorization'])
40	        if rq.get('content_type', None):
41	            self.assertEqual(request.headers['Content-Type'], rq['content_type'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
41	            self.assertEqual(request.headers['Content-Type'], rq['content_type'])
42	        if rq.get('body', None):
43	            self.assertEqual(int(request.headers['Content-Length']), len(json.dumps(rq['body'])))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	            self.assertEqual(int(request.headers['Content-Length']), len(json.dumps(rq['body'])))
44	        if rq.get('url_suffix', None):
45	            self.assertTrue(request.url.endswith(rq['url_suffix']),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	            # host, port, prefix, result
163	            (None, None, None, 'https://track.customer.io/api/v1'),
164	            (None, None, 'v2', 'https://track.customer.io/v2'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
163	            (None, None, None, 'https://track.customer.io/api/v1'),
164	            (None, None, 'v2', 'https://track.customer.io/v2'),
165	            (None, None, '/v2/', 'https://track.customer.io/v2'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	            (None, None, 'v2', 'https://track.customer.io/v2'),
165	            (None, None, '/v2/', 'https://track.customer.io/v2'),
166	            ('sub.domain.com', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	            (None, None, '/v2/', 'https://track.customer.io/v2'),
166	            ('sub.domain.com', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),
167	            ('/sub.domain.com/', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	            ('sub.domain.com', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),
167	            ('/sub.domain.com/', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),
168	            ('http://sub.domain.com/', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	            ('/sub.domain.com/', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),
168	            ('http://sub.domain.com/', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),
169	        ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/customerio-2.1/customerio-2.1/tests/test_customerio.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	            ('/sub.domain.com/', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),
168	            ('http://sub.domain.com/', 1337, '/v2/', 'https://sub.domain.com:1337/v2'),
169	        ]

--------------------------------------------------

Code scanned:
	Total lines of code: 920
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 4.0
Files skipped (0):
