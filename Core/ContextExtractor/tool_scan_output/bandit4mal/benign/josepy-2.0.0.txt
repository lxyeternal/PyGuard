Run started:2025-04-13 07:03:04.896075

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/docs/conf.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
187	intersphinx_mapping = {
188	    "python": ("https://docs.python.org/", None),
189	    "cryptography": ("https://cryptography.io/en/latest/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/docs/conf.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	    "python": ("https://docs.python.org/", None),
189	    "cryptography": ("https://cryptography.io/en/latest/", None),
190	}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/b64.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
31	        raise TypeError("argument should be bytes")
32	    return base64.urlsafe_b64encode(data).rstrip(b"=")
33	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/b64.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
56	
57	    return base64.urlsafe_b64decode(data + b"=" * (4 - (len(data) % 4)))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
146	        """
147	        return [base64.b64encode(cert.public_bytes(Encoding.DER)) for cert in value]
148	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:147
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
146	        """
147	        return [base64.b64encode(cert.public_bytes(Encoding.DER)) for cert in value]
148	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
157	        try:
158	            return tuple(x509.load_der_x509_certificate(base64.b64decode(cert)) for cert in value)
159	        except ValueError as error:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:158
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
157	        try:
158	            return tuple(x509.load_der_x509_certificate(base64.b64decode(cert)) for cert in value)
159	        except ValueError as error:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
216	    def _msg(cls, protected: str, payload: bytes) -> bytes:
217	        return b64.b64encode(protected.encode("utf-8")) + b"." + b64.b64encode(payload)
218	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
216	    def _msg(cls, protected: str, payload: bytes) -> bytes:
217	        return b64.b64encode(protected.encode("utf-8")) + b"." + b64.b64encode(payload)
218	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
335	        return (
336	            b64.b64encode(self.signature.protected.encode("utf-8"))
337	            + b"."

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
337	            + b"."
338	            + b64.b64encode(self.payload)
339	            + b"."

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
339	            + b"."
340	            + b64.b64encode(self.signature.signature)
341	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
357	        sig = cls.signature_cls(
358	            protected=b64.b64decode(protected).decode("utf-8"), signature=b64.b64decode(signature)
359	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
357	        sig = cls.signature_cls(
358	            protected=b64.b64decode(protected).decode("utf-8"), signature=b64.b64decode(signature)
359	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
359	        )
360	        return cls(payload=b64.b64decode(payload), signatures=(sig,))
361	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
398	        """Sign."""
399	        key = args.alg.kty.load(args.key.read())
400	        args.key.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	        sig = JWS.sign(
407	            payload=sys.stdin.read().encode(), key=key, alg=args.alg, protect=set(args.protect)
408	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
418	        if args.compact:
419	            sig = JWS.from_compact(sys.stdin.read().encode())
420	        else:  # JSON

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
421	            try:
422	                sig = cast(JWS, JWS.json_loads(sys.stdin.read()))
423	            except errors.Error as error:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
428	            assert args.kty is not None
429	            key = args.kty.load(args.key.read()).public_key()
430	            args.key.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/src/josepy/jws.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
433	
434	        sys.stdout.write(sig.payload.decode())
435	        return not sig.verify(key=key)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/tests/jws_test.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
77	        cert_asn1 = CERT.public_bytes(Encoding.DER)
78	        cert_b64 = base64.b64encode(cert_asn1)
79	        assert jobj == {"x5c": [cert_b64, cert_b64]}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/tests/jws_test.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
77	        cert_asn1 = CERT.public_bytes(Encoding.DER)
78	        cert_b64 = base64.b64encode(cert_asn1)
79	        assert jobj == {"x5c": [cert_b64, cert_b64]}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/tests/jws_test.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
80	        assert header == Header.from_json(jobj)
81	        jobj["x5c"][0] = base64.b64encode(b"xxx" + cert_asn1)
82	        with pytest.raises(errors.DeserializationError):

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/josepy-2.0.0/josepy-2.0.0/tests/jws_test.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
80	        assert header == Header.from_json(jobj)
81	        jobj["x5c"][0] = base64.b64encode(b"xxx" + cert_asn1)
82	        with pytest.raises(errors.DeserializationError):

--------------------------------------------------

Code scanned:
	Total lines of code: 3100
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 4.0
Files skipped (0):
