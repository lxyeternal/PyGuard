Run started:2025-04-12 12:21:14.787515

Test results:
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:191
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
190	                )
191	            sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
192	            sock.settimeout(timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
191	            sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
192	            sock.settimeout(timeout)
193	            sock.connect(unix_sock)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
192	            sock.settimeout(timeout)
193	            sock.connect(unix_sock)
194	            if tcp_keepalive:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
197	            if sock is not None:
198	                sock.close()
199	            raise InterfaceError("communication error") from e

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
232	            # Int32(80877103) - The SSL request code.
233	            sock.sendall(ii_pack(8, 80877103))
234	            resp = sock.recv(1).decode("ascii")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
233	            sock.sendall(ii_pack(8, 80877103))
234	            resp = sock.recv(1).decode("ascii")
235	            if resp == "S":

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
241	                if sock is not None:
242	                    sock.close()
243	                raise InterfaceError("Server refuses SSL")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
257	    def __exit__(self, exc_type, exc_value, traceback):
258	        self.close()
259	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
380	            while code not in (READY_FOR_QUERY, ERROR_RESPONSE):
381	                code, data_len = ci_unpack(_read(self._sock, 5))
382	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
382	
383	                self.message_types[code](_read(self._sock, data_len - 4), context)
384	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
388	        except BaseException as e:
389	            self.close()
390	            raise e

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
488	                        bffr.extend(
489	                            context.stream.read(4096).encode(self._client_encoding)
490	                        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
551	            try:
552	                self._usock.close()
553	            except socket.error as e:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
829	        while code != READY_FOR_QUERY:
830	            code, data_len = ci_unpack(_read(self._sock, 5))
831	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/src/pg8000/core.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
831	
832	            self.message_types[code](_read(self._sock, data_len - 4), context)
833	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
13	    with pytest.raises(InterfaceError):
14	        with connect(**conn_params):
15	            pass

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
25	    ):
26	        with connect(**conn_params):
27	            pass

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
40	
41	        with connect(**conn_params) as con:
42	            cur = con.cursor()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
51	    with pytest.raises(DatabaseError):
52	        with connect(**db_kwargs):
53	            pass

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
60	    with pytest.raises(DatabaseError, match="3D000"):
61	        with connect(**db_kwargs):
62	            pass

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
69	    with pytest.raises(DatabaseError, match="3D000"):
70	        with connect(**db_kwargs):
71	            pass

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
85	    with pytest.raises(DatabaseError, match="3D000"):
86	        with connect(**db_kwargs):
87	            pass

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
95	    db_kwargs["application_name"] = app_name
96	    with connect(**db_kwargs) as db:
97	        cur = db.cursor()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
112	    ):
113	        with connect(**db_kwargs):
114	            pass

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
118	    db_kwargs["application_name"] = bytearray(b"Philby")
119	    with connect(**db_kwargs):
120	        pass

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
151	def test_broken_pipe_read(con, db_kwargs):
152	    db1 = connect(**db_kwargs)
153	    cur1 = db1.cursor()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
162	    try:
163	        db1.close()
164	    except InterfaceError:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
168	def test_broken_pipe_flush(con, db_kwargs):
169	    db1 = connect(**db_kwargs)
170	    cur1 = db1.cursor()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
182	    try:
183	        db1.close()
184	    except InterfaceError as e:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
232	
233	    my_db = connect(**db_kwargs)
234	    cursor = my_db.cursor()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_connection.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
234	    cursor = my_db.cursor()
235	    my_db.close()
236	    with pytest.raises(my_db.InterfaceError, match="connection is closed"):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_query.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
196	    cursor.executemany(
197	        "INSERT INTO t1 (f1, f2) VALUES (%s, %s)", ((1, ["1.1.1.1"]), (2, ["0.0.0.0"]))
198	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_query.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
196	    cursor.executemany(
197	        "INSERT INTO t1 (f1, f2) VALUES (%s, %s)", ((1, ["1.1.1.1"]), (2, ["0.0.0.0"]))
198	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/dbapi/test_typeconversion.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
314	def test_inet_roundtrip_address(cursor):
315	    v = ipaddress.ip_address("192.168.0.1")
316	    cursor.execute("select cast(%s as inet)", (v,))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/legacy/test_query.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
209	    cursor.executemany(
210	        "INSERT INTO t1 (f1, f2) VALUES (%s, %s)", ((1, ["1.1.1.1"]), (2, ["0.0.0.0"]))
211	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/legacy/test_query.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
209	    cursor.executemany(
210	        "INSERT INTO t1 (f1, f2) VALUES (%s, %s)", ((1, ["1.1.1.1"]), (2, ["0.0.0.0"]))
211	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/legacy/test_typeconversion.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
313	def test_inet_roundtrip_address(con):
314	    v = ipaddress.ip_address("192.168.0.1")
315	    retval = con.run("select cast(:v as inet)", v=v)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/native/test_connection.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
136	    try:
137	        db1.close()
138	    except InterfaceError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/native/test_connection.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
162	    try:
163	        db1.close()
164	    except InterfaceError as e:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/native/test_connection.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
227	def test_closed_connection(con):
228	    con.close()
229	    with pytest.raises(InterfaceError, match="connection is closed"):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/native/test_typeconversion.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
542	        [IPv4Network("192.168.0.0/28"), INET],  # inet
543	        [IPv4Address("192.168.0.1"), INET],  # inet
544	        [86722, XID],  # xid

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/native/test_typeconversion.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
571	        ['"a"=>"1"', "hstore", None],
572	        [[IPv4Address("192.168.0.1")], "inet[]", None],
573	        [[Range(3, 7), Range(8, 9)], "int4multirange", 14],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/native/test_typeconversion.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
657	        [IPv4Network("192.168.0.0/28"), "inet", None],
658	        [IPv4Address("192.168.0.1"), "inet", None],
659	    ],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pg8000-1.31.2/pg8000-1.31.2/test/test_converters.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
61	        [[True, False, None], "{true,false,NULL}"],  # bool[]
62	        [[IPv4Address("192.168.0.1")], "{192.168.0.1}"],  # inet[]
63	        [[Date(2021, 3, 1)], "{2021-03-01}"],  # date[]

--------------------------------------------------

Code scanned:
	Total lines of code: 8972
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 1.0
Files skipped (0):
