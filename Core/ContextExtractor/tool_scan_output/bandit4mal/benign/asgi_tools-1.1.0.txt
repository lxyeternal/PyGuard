Run started:2025-04-12 16:20:55.299610

Test results:
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/forms.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
36	    async for chunk in request.stream():
37	        parser.write(chunk)
38	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/forms.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	    def on_part_data(self, data: bytes, start: int, end: int):
149	        self.partdata.write(data[start:end])
150	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
58	        for cookie in self.headers.getall("set-cookie", []):
59	            self.cookies.load(cookie)
60	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
94	    def connect(self) -> Coroutine[TASGIMessage, Any, Any]:
95	        return self.send({"type": "websocket.connect"})
96	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
97	    async def disconnect(self):
98	        await self.send({"type": "websocket.disconnect", "code": 1005})
99	        self.state = self.STATES.DISCONNECTED

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
102	        """Send a message to a client."""
103	        return super().send(msg, msg_type=msg_type)
104	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	
140	    def __init__(self, app: TASGIApp, base_url: str = "http://localhost"):
141	        self.app = app

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
240	        ):
241	            await ws.connect()
242	            yield ws

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
242	            yield ws
243	            await ws.disconnect()
244	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
274	        # Setup client
275	        scope.setdefault("client", ("127.0.0.1", random.randint(1024, 65535)))  # noqa: S311
276	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
289	                ],
290	                "server": ("127.0.0.1", self.base_url.port),
291	            },

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
307	                headers = f"{ headers }\r\nContent-Type: { content_type }"
308	            value = value.read()
309	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
309	
310	        body.write(b"--%b\r\n" % boundary)
311	        body.write(headers.encode("utf-8"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
310	        body.write(b"--%b\r\n" % boundary)
311	        body.write(headers.encode("utf-8"))
312	        body.write(b"\r\n\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
311	        body.write(headers.encode("utf-8"))
312	        body.write(b"\r\n\r\n")
313	        if isinstance(value, str):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
314	            value = value.encode("utf-8")
315	        body.write(value)
316	        body.write(b"\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
315	        body.write(value)
316	        body.write(b"\r\n")
317	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/asgi_tools/tests.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
317	
318	    body.write(b"--%b--\r\n" % boundary)
319	    return body.getvalue(), (b"multipart/form-data; boundary=%s" % boundary).decode()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_client.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
29	        "scheme": "ws",
30	        "server": ("127.0.0.1", 80),
31	        "client": ("127.0.0.1", scope["client"][1]),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_client.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
30	        "server": ("127.0.0.1", 80),
31	        "client": ("127.0.0.1", scope["client"][1]),
32	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_examples.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    data = await res.json()
43	    assert data["url"] == "http://localhost/test?var=42"
44	    assert data["query"] == {"var": "42"}

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_formdata.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
131	    for n in range(0, len(data), 5):
132	        parser.write(data[n : n + 5])
133	    parser.finalize()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_request.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
35	        "server": ("testserver", 8000),
36	        "client": ("127.0.0.1", 123),
37	        "root_path": "",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_request.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    assert request.url
48	    assert str(request.url) == "http://testserver:8000/testurl?a=1%202"
49	    assert request.client == ("127.0.0.1", 123)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_request.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
48	    assert str(request.url) == "http://testserver:8000/testurl?a=1%202"
49	    assert request.client == ("127.0.0.1", 123)
50	    assert request.cookies

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_responses.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	
297	    response = parse_response((302, {"location": "https://google.com"}, "go away"))
298	    assert response.status_code == 302

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_tools-1.1.0/asgi_tools-1.1.0/tests/test_responses.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
299	    assert response.content == b"go away"
300	    assert response.headers["location"] == "https://google.com"
301	

--------------------------------------------------

Code scanned:
	Total lines of code: 4022
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 0.0
Files skipped (0):
