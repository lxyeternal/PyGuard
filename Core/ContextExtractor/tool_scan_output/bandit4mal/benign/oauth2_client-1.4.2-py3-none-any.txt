Run started:2025-04-12 14:00:21.153382

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	    def authorization_header(self):
41	        return 'Basic %s' % base64.b64encode(bytes('%s:%s' % (self.client_id, self.client_secret), 'UTF-8'))\
42	            .decode('UTF-8')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
40	    def authorization_header(self):
41	        return 'Basic %s' % base64.b64encode(bytes('%s:%s' % (self.client_id, self.client_secret), 'UTF-8'))\
42	            .decode('UTF-8')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	            error = response.json()
87	            raise OAuthError(HTTPStatus(response.status_code), error.get('error'), error.get('error_description'))
88	        except BaseException as ex:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	            error = response.json()
87	            raise OAuthError(HTTPStatus(response.status_code), error.get('error'), error.get('error_description'))
88	        except BaseException as ex:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
114	            port = int(uri_parsed.port)
115	        if uri_parsed.hostname != 'localhost' and uri_parsed.hostname != '127.0.0.1':
116	            _logger.warning(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	                self.authorization_code_context.results.wait(timeout)
127	                error = self.authorization_code_context.results.get('error', None)
128	                error_description = self.authorization_code_context.results.get('error_description', '')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	                error = self.authorization_code_context.results.get('error', None)
128	                error_description = self.authorization_code_context.results.get('error_description', '')
129	                code = self.authorization_code_context.results.get('code', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	                error_description = self.authorization_code_context.results.get('error_description', '')
129	                code = self.authorization_code_context.results.get('code', None)
130	                state = self.authorization_code_context.results.get('state', None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	                code = self.authorization_code_context.results.get('code', None)
130	                state = self.authorization_code_context.results.get('state', None)
131	                if error is not None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
146	    def init_with_authorize_code(self, redirect_uri: str, code: str, **kwargs):
147	        self._token_request(self._grant_code_request(code, redirect_uri, **kwargs),
148	                            "offline_access" in self.service_information.scopes)
149	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
146	    def init_with_authorize_code(self, redirect_uri: str, code: str, **kwargs):
147	        self._token_request(self._grant_code_request(code, redirect_uri, **kwargs),
148	                            "offline_access" in self.service_information.scopes)
149	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
146	    def init_with_authorize_code(self, redirect_uri: str, code: str, **kwargs):
147	        self._token_request(self._grant_code_request(code, redirect_uri, **kwargs),
148	                            "offline_access" in self.service_information.scopes)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
146	    def init_with_authorize_code(self, redirect_uri: str, code: str, **kwargs):
147	        self._token_request(self._grant_code_request(code, redirect_uri, **kwargs),
148	                            "offline_access" in self.service_information.scopes)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
150	    def init_with_user_credentials(self, login: str, password: str):
151	        self._token_request(self._grant_password_request(login, password), True)
152	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
150	    def init_with_user_credentials(self, login: str, password: str):
151	        self._token_request(self._grant_password_request(login, password), True)
152	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
150	    def init_with_user_credentials(self, login: str, password: str):
151	        self._token_request(self._grant_password_request(login, password), True)
152	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
150	    def init_with_user_credentials(self, login: str, password: str):
151	        self._token_request(self._grant_password_request(login, password), True)
152	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
153	    def init_with_client_credentials(self):
154	        self._token_request(self._grant_client_credentials_request(), False)
155	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
153	    def init_with_client_credentials(self):
154	        self._token_request(self._grant_client_credentials_request(), False)
155	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
153	    def init_with_client_credentials(self):
154	        self._token_request(self._grant_client_credentials_request(), False)
155	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
153	    def init_with_client_credentials(self):
154	        self._token_request(self._grant_client_credentials_request(), False)
155	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
156	    def init_with_token(self, refresh_token: str):
157	        self._token_request(self._grant_refresh_token_request(refresh_token), False)
158	        if self.refresh_token is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
156	    def init_with_token(self, refresh_token: str):
157	        self._token_request(self._grant_refresh_token_request(refresh_token), False)
158	        if self.refresh_token is None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
156	    def init_with_token(self, refresh_token: str):
157	        self._token_request(self._grant_refresh_token_request(refresh_token), False)
158	        if self.refresh_token is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
156	    def init_with_token(self, refresh_token: str):
157	        self._token_request(self._grant_refresh_token_request(refresh_token), False)
158	        if self.refresh_token is None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
182	    def _refresh_token(self):
183	        payload = self._grant_refresh_token_request(self.refresh_token)
184	        try:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
182	    def _refresh_token(self):
183	        payload = self._grant_refresh_token_request(self.refresh_token)
184	        try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
184	        try:
185	            self._token_request(payload, False)
186	        except OAuthError as err:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
184	        try:
185	            self._token_request(payload, False)
186	        except OAuthError as err:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
198	            headers['Authorization'] = self.service_information.authorization_header
199	        response = requests.post(self.service_information.token_service,
200	                                 data=request_parameters,
201	                                 headers=headers,
202	                                 proxies=self.proxies,
203	                                 verify=self.service_information.verify)
204	        if response.status_code != HTTPStatus.OK.value:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	        self.refresh_token = token_response['refresh_token'] if refresh_token_mandatory \
212	            else token_response.get('refresh_token')
213	        self._access_token = token_response['access_token']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	    def _access_token(self) -> Optional[str]:
217	        authorization_header = self._session.headers.get('Authorization') if self._session is not None else None
218	        if authorization_header is not None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
236	        kwargs['params'] = params
237	        return self._bearer_request(self._get_session().get, url, **kwargs)
238	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
236	        kwargs['params'] = params
237	        return self._bearer_request(self._get_session().get, url, **kwargs)
238	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
241	        kwargs['json'] = json
242	        return self._bearer_request(self._get_session().post, url, **kwargs)
243	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
241	        kwargs['json'] = json
242	        return self._bearer_request(self._get_session().post, url, **kwargs)
243	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
246	        kwargs['json'] = json
247	        return self._bearer_request(self._get_session().put, url, **kwargs)
248	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
246	        kwargs['json'] = json
247	        return self._bearer_request(self._get_session().put, url, **kwargs)
248	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
251	        kwargs['json'] = json
252	        return self._bearer_request(self._get_session().patch, url, **kwargs)
253	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
251	        kwargs['json'] = json
252	        return self._bearer_request(self._get_session().patch, url, **kwargs)
253	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
254	    def delete(self, url: str, **kwargs) -> Response:
255	        return self._bearer_request(self._get_session().delete, url, **kwargs)
256	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
254	    def delete(self, url: str, **kwargs) -> Response:
255	        return self._bearer_request(self._get_session().delete, url, **kwargs)
256	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	    def _bearer_request(self, method: Callable[[Any], Response], url: str, **kwargs) -> Response:
263	        headers = kwargs.get('headers', None)
264	        if headers is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/oauth2_client-1.4.2-py3-none-any/oauth2_client/credentials_manager.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
283	                json_data = response.json()
284	                return json_data.get('error') == 'invalid_token'
285	            except ValueError:

--------------------------------------------------

Code scanned:
	Total lines of code: 295
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 42.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 1.0
Files skipped (0):
