Run started:2025-04-12 17:33:43.818298

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/extension_utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	            res = 0
33	            meminfo_content = meminfo.read()
34	            found_mem_available = re.search(MEM_AVAILABLE_PATTERN, meminfo_content)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/extension_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	        with open("/proc/net/netstat", "r") as stats:
47	            last = stats.read().splitlines()[-1]
48	            parts = last.split()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/extension_utils.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	    headers = {"Lambda-Extension-Identifier": extension_id}
55	    return json.loads(urllib.request.urlopen(urllib.request.Request(url, headers=headers)).read())  # type: ignore[no-any-return]
56	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/extension_utils.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
54	    headers = {"Lambda-Extension-Identifier": extension_id}
55	    return json.loads(urllib.request.urlopen(urllib.request.Request(url, headers=headers)).read())  # type: ignore[no-any-return]
56	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/lambda_service.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
11	        self.extension_id: str = extension_id
12	        self.thread: ThreadPoolExecutor = ThreadPoolExecutor()
13	        self.next_event_future = None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/main.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
26	    conn = http.client.HTTPConnection(os.environ["AWS_LAMBDA_RUNTIME_API"])
27	    conn.request("POST", "/2020-01-01/extension/register", body, headers=headers)
28	    response = conn.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/main.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
27	    conn.request("POST", "/2020-01-01/extension/register", body, headers=headers)
28	    response = conn.getresponse()
29	    response.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/main.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	    response = conn.getresponse()
29	    response.read()
30	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/sampler.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
50	        self.sample()
51	        signal.signal(signal.SIGALRM, self.sample)
52	        signal.setitimer(signal.ITIMER_REAL, interval_ms / 1000, interval_ms / 1000)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/sampler.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
50	        self.sample()
51	        signal.signal(signal.SIGALRM, self.sample)
52	        signal.setitimer(signal.ITIMER_REAL, interval_ms / 1000, interval_ms / 1000)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/sampler.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
55	        signal.alarm(0)
56	        signal.signal(signal.SIGALRM, signal.SIG_DFL)
57	        self.sample()

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/extension/sampler.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
55	        signal.alarm(0)
56	        signal.signal(signal.SIGALRM, signal.SIG_DFL)
57	        self.sample()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
89	            if edge_connection:
90	                edge_connection.connect()
91	    except socket.timeout:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
178	        for span_data in to_send:
179	            send_single_request(host, span_data)
180	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
199	    try:
200	        edge_connection.request(
201	            "POST",
202	            EDGE_PATH,
203	            data,
204	            headers={
205	                "Content-Type": "application/json",
206	                "Authorization": Configuration.token or "",
207	            },

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
208	        )
209	        response = edge_connection.getresponse()
210	        response.read()  # We must read the response to keep the connection available

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
209	        response = edge_connection.getresponse()
210	        response.read()  # We must read the response to keep the connection available
211	        get_logger().info(f"Successful reporting, code: {getattr(response, 'code', 'unknown')}")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
219	            edge_connection = establish_connection(host)  # Re-establish connection safely
220	            send_single_request(host, data, retry=False)
221	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
485	    with open(file_path, "wb") as span_file:
486	        span_file.write(to_send)
487	        get_logger().info(f"Wrote span to file to [{file_path}][{len(to_send)}]")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
575	        bulk = spans[start_index:end_index]
576	        zipped_spans = b64encode(gzip_compress(aws_dump(bulk).encode("utf-8"))).decode("utf-8")
577	        spans_bulks.append(aws_dump(zipped_spans))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:576
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
575	        bulk = spans[start_index:end_index]
576	        zipped_spans = b64encode(gzip_compress(aws_dump(bulk).encode("utf-8"))).decode("utf-8")
577	        spans_bulks.append(aws_dump(zipped_spans))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
589	def get_event_base64_size(event: Union[Dict[Any, Any], List[Dict[Any, Any]]]) -> int:
590	    return len(b64encode(aws_dump(event).encode()))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/lambda_reporter.py:590
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
589	def get_event_base64_size(event: Union[Dict[Any, Any], List[Dict[Any, Any]]]) -> int:
590	    return len(b64encode(aws_dump(event).encode()))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/spans_container.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	    ):
74	        version = open(_VERSION_PATH, "r").read() if os.path.exists(_VERSION_PATH) else "unknown"
75	        version = version.strip()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/spans_container.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
412	        if Configuration.timeout_timer:
413	            signal.signal(signal.SIGALRM, to_exec)
414	            signal.setitimer(signal.ITIMER_REAL, seconds)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/spans_container.py:413
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
412	        if Configuration.timeout_timer:
413	            signal.signal(signal.SIGALRM, to_exec)
414	            signal.setitimer(signal.ITIMER_REAL, seconds)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/spans_container.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
419	            signal.alarm(0)
420	            signal.signal(signal.SIGALRM, signal.SIG_DFL)
421	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/spans_container.py:420
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
419	            signal.alarm(0)
420	            signal.signal(signal.SIGALRM, signal.SIG_DFL)
421	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lambda_tracer/spans_container.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
423	    def is_activated():  # type: ignore[no-untyped-def]
424	        return Configuration.timeout_timer and signal.getsignal(signal.SIGALRM) != signal.SIG_DFL
425	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lumigo_utils.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
301	        if force or not InternalState.internal_error_already_logged:
302	            b64_message = base64.b64encode(msg.encode()).decode()
303	            print(f"{INTERNAL_ANALYTICS_PREFIX}: {b64_message}")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/lumigo_utils.py:302
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
301	        if force or not InternalState.internal_error_already_logged:
302	            b64_message = base64.b64encode(msg.encode()).decode()
303	            print(f"{INTERNAL_ANALYTICS_PREFIX}: {b64_message}")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/http_parser.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
192	            },
193	            super().parse_request(parse_params),
194	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/http_parser.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
212	            },
213	            super().parse_request(parse_params),
214	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/http_parser.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
240	            },
241	            super().parse_request(parse_params),
242	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/http_parser.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
248	            {"info": {"resourceName": safe_key_from_json(parse_params.body, "StreamName")}},
249	            super().parse_request(parse_params),
250	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/http_parser.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
274	            {"info": {"resourceName": self._extract_queue_url(parse_params.body)}},
275	            super().parse_request(parse_params),
276	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/http_parser.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
310	            {"info": {"resourceName": self._extract_queue_url(parse_params.body)}},
311	            super().parse_request(parse_params),
312	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/http_parser.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
361	            {"info": {"resourceName": resource_name}},
362	            super().parse_request(parse_params),
363	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/http_parser.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
389	            {"info": {"resourceNames": list(resource_names) or None}},
390	            super().parse_request(parse_params),
391	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/sync_http_wrappers.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
53	    parser = get_parser(parse_params.host, parse_params.headers)()
54	    msg = parser.parse_request(parse_params)
55	    if span_id:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/sync_http_wrappers.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
180	                current_pos = data.tell()
181	                data = data.read(get_size_upper_bound())
182	                args[0].seek(current_pos)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lumigo_tracer-1.1.248-py3-none-any/lumigo_tracer/wrappers/http/sync_http_wrappers.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
229	        else:
230	            span = add_unparsed_request(  # type: ignore
231	                HttpState.request_id_to_span_id.get(get_lumigo_connection_id(instance)),  # type: ignore[arg-type]
232	                HttpRequest(host=host, method=method, uri=uri, body=data, instance_id=id(instance)),
233	            )

--------------------------------------------------

Code scanned:
	Total lines of code: 4047
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 35.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 7.0
Files skipped (0):
