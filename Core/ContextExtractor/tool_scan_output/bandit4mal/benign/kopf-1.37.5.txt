Run started:2025-04-12 12:18:16.102586

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/_importlinter_conditional.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	        with open(path, encoding='utf-8') as f:
85	            text = f.read()
86	            xtree = astpath.file_contents_to_xml_ast(text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/docs/conf.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	extlinks = {
43	    'issue': ('https://github.com/nolar/kopf/issues/%s', 'issue '),
44	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/docs/conf.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	intersphinx_mapping = {
47	    'python': ('https://docs.python.org/3', None),
48	    'mypy': ('https://mypy.readthedocs.io/en/latest/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/docs/conf.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    'python': ('https://docs.python.org/3', None),
48	    'mypy': ('https://mypy.readthedocs.io/en/latest/', None),
49	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/docs/conf.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    filename = info['module'].replace('.', '/')
58	    return "https://github.com/nolar/kopf/blob/main/%s.py" % filename
59	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/api.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
77	
78	            response = await context.session.request(
79	                method=method,
80	                url=url,
81	                json=payload,
82	                headers=headers,
83	                timeout=timeout,
84	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
111	) -> Any:
112	    response = await request(
113	        method='get',
114	        url=url,
115	        payload=payload,
116	        headers=headers,
117	        timeout=timeout,
118	        settings=settings,
119	        logger=logger,
120	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/api.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
133	) -> Any:
134	    response = await request(
135	        method='post',
136	        url=url,
137	        payload=payload,
138	        headers=headers,
139	        timeout=timeout,
140	        settings=settings,
141	        logger=logger,
142	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/api.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
155	) -> Any:
156	    response = await request(
157	        method='patch',
158	        url=url,
159	        payload=payload,
160	        headers=headers,
161	        timeout=timeout,
162	        settings=settings,
163	        logger=logger,
164	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/api.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
177	) -> Any:
178	    response = await request(
179	        method='delete',
180	        url=url,
181	        payload=payload,
182	        headers=headers,
183	        timeout=timeout,
184	        settings=settings,
185	        logger=logger,
186	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/api.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
200	) -> AsyncIterator[Any]:
201	    response = await request(
202	        method='get',
203	        url=url,
204	        payload=payload,
205	        headers=headers,
206	        timeout=timeout,
207	        settings=settings,
208	        logger=logger,
209	    )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/auth.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
108	        elif info.ca_data:
109	            ca_path = tempfiles[base64.b64decode(info.ca_data)]
110	        else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/auth.py:109
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
108	        elif info.ca_data:
109	            ca_path = tempfiles[base64.b64decode(info.ca_data)]
110	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/auth.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
117	        elif info.certificate_data:
118	            certificate_path = tempfiles[base64.b64decode(info.certificate_data)]
119	        else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/auth.py:118
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
117	        elif info.certificate_data:
118	            certificate_path = tempfiles[base64.b64decode(info.certificate_data)]
119	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/auth.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
126	        elif info.private_key_data:
127	            private_key_path = tempfiles[base64.b64decode(info.private_key_data)]
128	        else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/auth.py:127
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
126	        elif info.private_key_data:
127	            private_key_path = tempfiles[base64.b64decode(info.private_key_data)]
128	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/auth.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
240	            with tempfile.NamedTemporaryFile(delete=False) as f:
241	                f.write(item)
242	            self._paths[item] = f.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/clients/auth.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
240	            with tempfile.NamedTemporaryFile(delete=False) as f:
241	                f.write(item)
242	            self._paths[item] = f.name

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/configs/conventions.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
184	        digest = hashlib.blake2b(key.encode('utf-8'), digest_size=4).digest()
185	        alnums = base64.b64encode(digest, altchars=b'-.').decode('ascii')
186	        return f'-{alnums}'.rstrip('=-.')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/configs/conventions.py:185
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
184	        digest = hashlib.blake2b(key.encode('utf-8'), digest_size=4).digest()
185	        alnums = base64.b64encode(digest, altchars=b'-.').decode('ascii')
186	        return f'-{alnums}'.rstrip('=-.')

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/helpers/hostnames.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
16	    try:
17	        hostname, aliases, ipaddrs = socket.gethostbyaddr(socket.gethostname())
18	    except OSError:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/helpers/hostnames.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
16	    try:
17	        hostname, aliases, ipaddrs = socket.gethostbyaddr(socket.gethostname())
18	    except OSError:

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/helpers/hostnames.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
45	
46	    return remove_useless_suffixes(socket.gethostname())
47	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/helpers/hostnames.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
45	
46	    return remove_useless_suffixes(socket.gethostname())
47	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/structs/credentials.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
213	        if not self._current:
214	            raise LoginError("Ran out of valid credentials. Consider installing "
215	                             "an API client library or adding a login handler. See more: "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_cogs/structs/credentials.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	                if exc is not None:
297	                    raise LoginError("Ran out of valid credentials. Consider installing "
298	                                     "an API client library or adding a login handler. See more: "

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/engines/admission.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
220	    if jsonpatch:
221	        encoded_patch: str = base64.b64encode(json.dumps(jsonpatch).encode('utf-8')).decode('ascii')
222	        response['response']['patch'] = encoded_patch

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/engines/admission.py:221
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
220	    if jsonpatch:
221	        encoded_patch: str = base64.b64encode(json.dumps(jsonpatch).encode('utf-8')).decode('ascii')
222	        response['response']['patch'] = encoded_patch

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/engines/admission.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	        raise Exception(
254	            "Admission handlers exist, but no admission server/tunnel is configured "
255	            "in `settings.admission.server`. "
256	            "More: https://kopf.readthedocs.io/en/stable/admission/")

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/engines/peering.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
278	
279	    user = getpass.getuser()
280	    host = hostnames.get_descriptive_hostname()

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/engines/peering.py:279
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
278	
279	    user = getpass.getuser()
280	    host = hostnames.get_descriptive_hostname()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/intents/piggybacking.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
176	        with open(token_path, encoding='utf-8') as f:
177	            token = f.read().strip()
178	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/intents/piggybacking.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	            with open(ns_path, encoding='utf-8') as f:
182	                namespace = f.read().strip()
183	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/intents/piggybacking.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	        return credentials.ConnectionInfo(
185	            server='https://kubernetes.default.svc',
186	            ca_path=ca_path if os.path.exists(ca_path) else None,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/intents/piggybacking.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
229	        with open(path, encoding='utf-8') as f:
230	            config = yaml.safe_load(f.read()) or {}
231	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/reactor/running.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
348	    # On Ctrl+C or pod termination, cancel all tasks gracefully.
349	    if threading.current_thread() is threading.main_thread():
350	        # Handle NotImplementedError when ran on Windows since asyncio only supports Unix signals

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_core/reactor/running.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
348	    # On Ctrl+C or pod termination, cancel all tasks gracefully.
349	    if threading.current_thread() is threading.main_thread():
350	        # Handle NotImplementedError when ran on Windows since asyncio only supports Unix signals

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
180	            if cadata is not None:
181	                client_config['caBundle'] = base64.b64encode(cadata).decode('ascii')
182	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:181
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
180	            if cadata is not None:
181	                client_config['caBundle'] = base64.b64encode(cadata).decode('ascii')
182	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:227
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
226	    def _allocate_free_port() -> int:
227	        with contextlib.closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
228	            s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
250	        else:
251	            return '127.0.0.1' if ipv4.is_unspecified else addr
252	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
327	                with tempfile.NamedTemporaryFile() as certf, tempfile.NamedTemporaryFile() as pkeyf:
328	                    certf.write(certdata)
329	                    pkeyf.write(pkeydata)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
327	                with tempfile.NamedTemporaryFile() as certf, tempfile.NamedTemporaryFile() as pkeyf:
328	                    certf.write(certdata)
329	                    pkeyf.write(pkeydata)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
328	                    certf.write(certdata)
329	                    pkeyf.write(pkeydata)
330	                    certf.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
328	                    certf.write(certdata)
329	                    pkeyf.write(pkeydata)
330	                    certf.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
373	            raise MissingDependencyError(
374	                "Using self-signed certificates requires an extra dependency: "
375	                "run `pip install certbuilder` or `pip install kopf[dev]`. "
376	                "Or pass `insecure=True` to a webhook server to use only HTTP. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
525	            raise MissingDependencyError(
526	                "Using ngrok webhook tunnel requires an extra dependency: "
527	                "run `pip install pyngrok` or `pip install kopf[dev]`. "
528	                "More: https://kopf.readthedocs.io/en/stable/admission/")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/kopf/_kits/webhooks.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
584	            raise MissingDependencyError(
585	                "Auto-guessing cluster types requires an extra dependency: "
586	                "run `pip install certvalidator` or `pip install kopf[dev]`. "
587	                "More: https://kopf.readthedocs.io/en/stable/admission/")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/setup.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5	with open(os.path.join(os.path.dirname(__file__), 'README.md')) as f:
6	    LONG_DESCRIPTION = f.read()
7	    DESCRIPTION = LONG_DESCRIPTION.splitlines()[0].lstrip('#').strip()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/setup.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	PROJECT_URLS = {
10	    'Documentation': 'https://kopf.readthedocs.io',
11	    'Bug Tracker': 'https://github.com/nolar/kopf/issues',
12	    'Source Code': 'https://github.com/nolar/kopf',
13	}
14	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    'Documentation': 'https://kopf.readthedocs.io',
11	    'Bug Tracker': 'https://github.com/nolar/kopf/issues',
12	    'Source Code': 'https://github.com/nolar/kopf',
13	}
14	
15	setup(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/setup.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    'Bug Tracker': 'https://github.com/nolar/kopf/issues',
12	    'Source Code': 'https://github.com/nolar/kopf',
13	}
14	
15	setup(
16	    name='kopf',

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/conftest.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
59	def certpkey():
60	    cert, pkey = WebhookServer.build_certificate(['localhost', '127.0.0.1'])
61	    return cert, pkey

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/conftest.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	    mocker.patch.object(pyngrok.ngrok, 'disconnect')
140	    pyngrok.ngrok.connect.return_value.public_url = 'https://nowhere'
141	    return pyngrok

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_manager.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	    mocker.patch.object(container, 'as_changed', return_value=aiter([
126	        {'url': 'https://hostname1/'},
127	        {'url': 'https://hostname2/'},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_manager.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	        {'url': 'https://hostname1/'},
127	        {'url': 'https://hostname2/'},
128	    ]))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_manager.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	    assert patch['webhooks']
150	    assert patch['webhooks'][0]['clientConfig']['url'].startswith('https://hostname1/')
151	    assert patch['webhooks'][0]['rules']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_manager.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	    assert patch['webhooks']
156	    assert patch['webhooks'][0]['clientConfig']['url'].startswith('https://hostname2/')
157	    assert patch['webhooks'][0]['rules']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_manager.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	    mocker.patch.object(container, 'as_changed', return_value=aiter([
174	        {'url': 'https://hostname/'},
175	    ]))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_manager.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
204	    mocker.patch.object(container, 'as_changed', return_value=aiter([
205	        {'url': 'https://hostname/'},
206	    ]))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_manager.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	    patch = k8s_mocked.patch.call_args_list[-1][1]['payload']
220	    assert patch['webhooks'][0]['clientConfig']['url'].startswith('https://hostname/')
221	    assert patch['webhooks'][0]['rules']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_server.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    async def server(_):
42	        yield {'url': 'https://hostname/'}
43	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_server.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	
54	    assert container.get_nowait() == {'url': 'https://hostname/'}
55	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_server.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        async def __call__(self, _):
73	            yield {'url': 'https://hostname/'}
74	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_server.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	    assert aexit_mock.call_count == 1
86	    assert container.get_nowait() == {'url': 'https://hostname/'}
87	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_server.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	    async def server(_):
97	        yield {'url': 'https://hostname/'}
98	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_admission_server.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	    assert aexit_mock.call_count == 1
118	    assert container.get_nowait() == {'url': 'https://hostname/'}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_certificates.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
19	def test_certificate_generation():
20	    names = ['hostname1', 'hostname2', '1.2.3.4', '0:0:0:0:0:0:0:1']
21	    cert, pkey = WebhookServer.build_certificate(names)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_certificates.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
27	    assert path.first.self_issued
28	    assert set(path.first.valid_domains) == {'hostname1', 'hostname2', '1.2.3.4', '::1'}
29	    assert set(path.first.valid_ips) == {'1.2.3.4', '::1'}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_certificates.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
28	    assert set(path.first.valid_domains) == {'hostname1', 'hostname2', '1.2.3.4', '::1'}
29	    assert set(path.first.valid_ips) == {'1.2.3.4', '::1'}
30	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_certificates.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
34	    (['hostname2', 'hostname1'], 'hostname2'),
35	    (['1.2.3.4', 'hostname1'], 'hostname1'),
36	    (['1.2.3.4', '2.3.4.5'], '1.2.3.4'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_certificates.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
35	    (['1.2.3.4', 'hostname1'], 'hostname1'),
36	    (['1.2.3.4', '2.3.4.5'], '1.2.3.4'),
37	])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_certificates.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
35	    (['1.2.3.4', 'hostname1'], 'hostname1'),
36	    (['1.2.3.4', '2.3.4.5'], '1.2.3.4'),
37	])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_certificates.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
35	    (['1.2.3.4', 'hostname1'], 'hostname1'),
36	    (['1.2.3.4', '2.3.4.5'], '1.2.3.4'),
37	])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	        name_suffix='sfx',
70	        client_config={'url': 'https://hostname/p1/p2'})
71	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	@pytest.mark.parametrize('id, field, exp_url', [
50	    ('id', None, 'https://hostname/p1/p2/id'),
51	    ('id.', None, 'https://hostname/p1/p2/id.'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    ('id', None, 'https://hostname/p1/p2/id'),
51	    ('id.', None, 'https://hostname/p1/p2/id.'),
52	    ('id-', None, 'https://hostname/p1/p2/id-'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    ('id.', None, 'https://hostname/p1/p2/id.'),
52	    ('id-', None, 'https://hostname/p1/p2/id-'),
53	    ('id_', None, 'https://hostname/p1/p2/id_'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    ('id-', None, 'https://hostname/p1/p2/id-'),
53	    ('id_', None, 'https://hostname/p1/p2/id_'),
54	    ('id!', None, 'https://hostname/p1/p2/id%21'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    ('id_', None, 'https://hostname/p1/p2/id_'),
54	    ('id!', None, 'https://hostname/p1/p2/id%21'),
55	    ('id%', None, 'https://hostname/p1/p2/id%25'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    ('id!', None, 'https://hostname/p1/p2/id%21'),
55	    ('id%', None, 'https://hostname/p1/p2/id%25'),
56	    ('id/sub', None, 'https://hostname/p1/p2/id/sub'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    ('id%', None, 'https://hostname/p1/p2/id%25'),
56	    ('id/sub', None, 'https://hostname/p1/p2/id/sub'),
57	    ('id', 'fld1.fld2', 'https://hostname/p1/p2/id/fld1.fld2'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_managed_webhooks.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    ('id/sub', None, 'https://hostname/p1/p2/id/sub'),
57	    ('id', 'fld1.fld2', 'https://hostname/p1/p2/id/fld1.fld2'),
58	])

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_serving_responses.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
167	    assert response['response']['patchType'] == 'JSONPatch'
168	    assert json.loads(base64.b64decode(response['response']['patch'])) == [
169	        {'op': 'add', 'path': '/xyz', 'value': 'added'},

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_serving_responses.py:168
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
167	    assert response['response']['patchType'] == 'JSONPatch'
168	    assert json.loads(base64.b64decode(response['response']['patch'])) == [
169	        {'op': 'add', 'path': '/xyz', 'value': 'added'},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_ngrok.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	            assert 'caBundle' not in client_config  # trust the default CA
26	            assert client_config['url'] == 'https://nowhere/p1/p2'
27	            break  # do not sleep

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
14	async def test_starts_as_http_ipv4(responder):
15	    server = WebhookServer(addr='127.0.0.1', port=22533, path='/p1/p2', insecure=True)
16	    async with server:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        async for client_config in server(responder.fn):
18	            assert client_config['url'] == 'http://127.0.0.1:22533/p1/p2'
19	            assert 'caBundle' not in client_config

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        async for client_config in server(responder.fn):
27	            assert client_config['url'] == 'http://[::1]:22533/p1/p2'
28	            assert 'caBundle' not in client_config

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
32	async def test_unspecified_port_allocates_a_random_port(responder):
33	    server1 = WebhookServer(addr='127.0.0.1', path='/p1/p2', insecure=True)
34	    server2 = WebhookServer(addr='127.0.0.1', path='/p1/p2', insecure=True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
33	    server1 = WebhookServer(addr='127.0.0.1', path='/p1/p2', insecure=True)
34	    server2 = WebhookServer(addr='127.0.0.1', path='/p1/p2', insecure=True)
35	    async with server1, server2:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        async for client_config in server(responder.fn):
48	            assert client_config['url'] == 'http://localhost:22533/p1/p2'
49	            break  # do not sleep

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	            break  # do not sleep
50	    assert_logs([r"Listening for webhooks at http://\*:22533/p1/p2"])
51	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
54	        responder):
55	    server = WebhookServer(addr='127.0.0.1', port=22533, path='/p1/p2', host='somehost')
56	    async with server:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	        async for client_config in server(responder.fn):
58	            assert client_config['url'] == 'https://somehost:22533/p1/p2'
59	            assert 'caBundle' in client_config  # regardless of the value

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        async for client_config in server(responder.fn):
68	            assert client_config['url'] == 'https://localhost:22533'
69	            assert base64.b64decode(client_config['caBundle']) == certpkey[0]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
68	            assert client_config['url'] == 'https://localhost:22533'
69	            assert base64.b64decode(client_config['caBundle']) == certpkey[0]
70	            break  # do not sleep

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
68	            assert client_config['url'] == 'https://localhost:22533'
69	            assert base64.b64decode(client_config['caBundle']) == certpkey[0]
70	            break  # do not sleep

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	@pytest.mark.parametrize('cls, url', [
74	    (WebhookK3dServer, 'https://host.k3d.internal:22533/p1/p2'),
75	    (WebhookMinikubeServer, 'https://host.minikube.internal:22533/p1/p2'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    (WebhookK3dServer, 'https://host.k3d.internal:22533/p1/p2'),
75	    (WebhookMinikubeServer, 'https://host.minikube.internal:22533/p1/p2'),
76	    (WebhookDockerDesktopServer, 'https://host.docker.internal:22533/p1/p2'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    (WebhookMinikubeServer, 'https://host.minikube.internal:22533/p1/p2'),
76	    (WebhookDockerDesktopServer, 'https://host.docker.internal:22533/p1/p2'),
77	])

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
93	        async for client_config in server(responder.fn):
94	            cadata = base64.b64decode(client_config['caBundle']).decode('ascii')
95	            sslctx = ssl.create_default_context(cadata=cadata)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:94
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
93	        async for client_config in server(responder.fn):
94	            cadata = base64.b64decode(client_config['caBundle']).decode('ascii')
95	            sslctx = ssl.create_default_context(cadata=cadata)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
119	        async for client_config in server(responder.fn):
120	            cadata = base64.b64decode(client_config['caBundle']).decode('ascii')
121	            sslctx = ssl.create_default_context(cadata=cadata)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/admission/test_webhook_server.py:120
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
119	        async for client_config in server(responder.fn):
120	            cadata = base64.b64decode(client_config['caBundle']).decode('ascii')
121	            sslctx = ssl.create_default_context(cadata=cadata)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
16	    aresponses.add(hostname, '/url', method, mock)
17	    response = await request(
18	        method=method,
19	        url='/url',
20	        payload={'fake': 'payload'},
21	        headers={'fake': 'headers'},
22	        settings=settings,
23	        logger=logger,
24	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
39	    aresponses.add(hostname, '/url', method, mock)
40	    response = await request(method, '/url', settings=settings, logger=logger)
41	    assert isinstance(response, aiohttp.ClientResponse)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
50	    with pytest.raises(APIError) as err:
51	        await request(method, '/url', settings=settings, logger=logger)
52	    assert err.value.status == 666

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	    aresponses.add(hostname, '/url', method, mock)
61	    await request(method, '/url', settings=settings, logger=logger)
62	    assert isinstance(mock.call_args[0][0], aiohttp.web.BaseRequest)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
72	    aresponses.add('fakehost.localdomain', '/url', method, mock)
73	    await request(method, 'http://fakehost.localdomain/url', settings=settings, logger=logger)
74	    assert isinstance(mock.call_args[0][0], aiohttp.web.BaseRequest)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	    aresponses.add('fakehost.localdomain', '/url', method, mock)
73	    await request(method, 'http://fakehost.localdomain/url', settings=settings, logger=logger)
74	    assert isinstance(mock.call_args[0][0], aiohttp.web.BaseRequest)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    assert isinstance(mock.call_args[0][0], aiohttp.web.BaseRequest)
75	    assert str(mock.call_args[0][0].url) == 'http://fakehost.localdomain/url'
76	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
259	            await asyncio.sleep(0.05)
260	            await response.write(b'{"fake": "result1"}\n')
261	            await asyncio.sleep(0.15)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_api_requests.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
261	            await asyncio.sleep(0.15)
262	            await response.write(b'{"fake": "result2"}\n')
263	            await response.write_eof()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
28	    with pytest.raises(Exception) as err:
29	        await request('get', '/url', settings=settings, logger=logger)
30	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
49	    with pytest.raises(APIError) as err:
50	        await request('get', '/url', settings=settings, logger=logger)
51	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
70	    with pytest.raises(APIError) as err:
71	        await request('get', '/url', settings=settings, logger=logger)
72	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
90	    with pytest.raises(aiohttp.ClientConnectionError):
91	        await request('get', '/url', settings=settings, logger=logger)
92	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
109	    with pytest.raises(asyncio.TimeoutError):
110	        await request('get', '/url', settings=settings, logger=logger)
111	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
135	    settings.networking.error_backoffs = [0, 0, 0]
136	    await request('get', '/url', settings=settings, logger=logger)
137	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
168	    with pytest.raises(APIError):
169	        await request('get', '/url', settings=settings, logger=logger)
170	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
186	    with pytest.raises(APIError):
187	        await request('get', '/url', settings=settings, logger=logger)
188	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
214	    with pytest.raises(APIError):
215	        await request('get', '/url', settings=settings, logger=logger)
216	    with pytest.raises(APIError):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/apis/test_error_retries.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
216	    with pytest.raises(APIError):
217	        await request('get', '/url', settings=settings, logger=logger)
218	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_authentication.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	async def test_single_credentials_provided_to_vault(settings):
58	    info = ConnectionInfo(server='https://expected/')
59	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_connectioninfo.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    info = ConnectionInfo(
14	        server='https://localhost',
15	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_connectioninfo.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    )
16	    assert info.server == 'https://localhost'
17	    assert info.ca_path is None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_connectioninfo.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    info = ConnectionInfo(
34	        server='https://localhost',
35	        ca_path='/ca/path',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_connectioninfo.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	    )
49	    assert info.server == 'https://localhost'
50	    assert info.ca_path == '/ca/path'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	        'id': ConnectionInfo(
137	            server='http://localhost',
138	            username='username',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	        'id': ConnectionInfo(
153	            server='http://localhost',
154	            token='token',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	        'id': ConnectionInfo(
167	            server='http://localhost',
168	            scheme='Digest xyz',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	        'id': ConnectionInfo(
181	            server='http://localhost',
182	            scheme='Digest',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	        'id': ConnectionInfo(
196	            server='http://localhost',
197	            insecure=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	        'id': ConnectionInfo(
210	            server='http://localhost',
211	            ca_path=cafile,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
225	        'id': ConnectionInfo(
226	            server='http://localhost',
227	            ca_data=cabase64,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
243	        'id': ConnectionInfo(
244	            server='http://localhost',
245	            ca_path=cafile,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_credentials.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	        'id': ConnectionInfo(
259	            server='http://localhost',
260	            ca_path=cafile,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	    kubeconfig = tmpdir.join('config')
90	    kubeconfig.write("""!!acb!.-//:""")  # invalid yaml
91	    mocker.patch.dict(os.environ, clear=True, KUBECONFIG=str(kubeconfig))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	    kubeconfig = tmpdir.join('config')
98	    kubeconfig.write('')
99	    mocker.patch.dict(os.environ, clear=True, KUBECONFIG=str(kubeconfig))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	    kubeconfig = tmpdir.join('config')
107	    kubeconfig.write(MINICONFIG)
108	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
129	    kubeconfig = tmpdir.join('config')
130	    kubeconfig.write('''
131	        kind: Config

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	    kubeconfig = tmpdir.join('config')
130	    kubeconfig.write('''
131	        kind: Config

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	    assert credentials is not None
165	    assert credentials.server == 'https://hostname:1234/'
166	    assert credentials.insecure == True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
181	    kubeconfig = tmpdir.join('config')
182	    kubeconfig.write('''
183	        kind: Config

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
208	    kubeconfig1 = tmpdir.join('config1')
209	    kubeconfig1.write('''
210	        kind: Config

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
213	    kubeconfig2 = tmpdir.join('config2')
214	    kubeconfig2.write('''
215	        kind: Config

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
242	    kubeconfig1 = tmpdir.join('config1')
243	    kubeconfig1.write('''
244	        kind: Config

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
253	    kubeconfig2 = tmpdir.join('config2')
254	    kubeconfig2.write('''
255	        kind: Config

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
276	    kubeconfig1 = tmpdir.join('config1')
277	    kubeconfig1.write('''
278	        kind: Config

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_kubeconfig.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
295	    kubeconfig2 = tmpdir.join('config2')
296	    kubeconfig2.write('''
297	        kind: Config

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_serviceaccount.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    assert credentials is not None
42	    assert credentials.server == 'https://kubernetes.default.svc'
43	    assert credentials.default_namespace == 'ns'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_login_serviceaccount.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	    assert credentials is not None
63	    assert credentials.server == 'https://kubernetes.default.svc'
64	    assert credentials.default_namespace is None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_reauthentication.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	
39	    explicit_context = APIContext(ConnectionInfo(server='http://irrelevant/'))
40	    context, result = await fn(1, context=explicit_context)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_tempfiles.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
11	    with open(path, 'rb') as f:
12	        assert f.read() == b'hello'
13	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    key1 = VaultKey('some-key')
23	    info1 = ConnectionInfo(server='https://expected/')
24	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    key1 = VaultKey('some-key')
42	    info1 = ConnectionInfo(server='https://expected/')
43	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	    key1 = VaultKey('some-key')
61	    info1 = ConnectionInfo(server='https://expected/', expiration=future)
62	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    key2 = VaultKey('other-key')
82	    info1 = ConnectionInfo(server='https://expected/', expiration=past)
83	    info2 = ConnectionInfo(server='https://expected/', expiration=future)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	    info1 = ConnectionInfo(server='https://expected/', expiration=past)
83	    info2 = ConnectionInfo(server='https://expected/', expiration=future)
84	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	    key1 = VaultKey('some-key')
102	    info1 = ConnectionInfo(server='https://expected/', expiration=past)
103	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	    key1 = VaultKey('some-key')
115	    info1 = ConnectionInfo(server='https://expected/')
116	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	    key1 = VaultKey('some-key')
130	    info1 = ConnectionInfo(server='https://expected/')
131	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	    key2 = VaultKey('key2')
144	    info1 = ConnectionInfo(server='https://server1/')
145	    info2 = ConnectionInfo(server='https://server2/')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	    info1 = ConnectionInfo(server='https://server1/')
145	    info2 = ConnectionInfo(server='https://server2/')
146	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	    key1 = VaultKey('some-key')
163	    info1 = ConnectionInfo(server='https://expected/')
164	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	    key1 = VaultKey('some-key')
177	    info1 = ConnectionInfo(server='https://expected/')
178	    info2 = ConnectionInfo(server='https://expected/')  # another instance, same fields

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
177	    info1 = ConnectionInfo(server='https://expected/')
178	    info2 = ConnectionInfo(server='https://expected/')  # another instance, same fields
179	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	    obj1 = object()
195	    info1 = ConnectionInfo(server='https://expected/')
196	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	    obj1 = object()
219	    info1 = ConnectionInfo(server='https://expected/')
220	    vault = Vault()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/authentication/test_vault.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	    obj1 = object()
240	    info1 = ConnectionInfo(server='https://expected/')
241	    vault = Vault()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/peering/test_id_generation.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
15	    ('some-host.example.com', 'some-host'),
16	    ('some-host.example.com', '1.2.3.4'),
17	    ('some-host.example.com', '::1'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/peering/test_id_generation.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
19	    ('some-host.example.com', '4.3.2.1.in-addr.arpa'),
20	    ('some-host.example.com', '1.2.3.4'),
21	    ('some-host', '1.2.3.4'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/peering/test_id_generation.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
20	    ('some-host.example.com', '1.2.3.4'),
21	    ('some-host', '1.2.3.4'),
22	    ('some-host', '::1'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/peering/test_id_generation.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	    ('some-host', '4.3.2.1.in-addr.arpa'),
25	    ('some-host', '1.2.3.4'),
26	]

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/settings/test_executor.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
37	    settings = kopf.OperatorSettings()
38	    executor = CatchyExecutor()
39	    settings.execution.executor = executor

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/test_liveness.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        health_reporter(
28	            endpoint=f'http://:{port}/xyz',
29	            registry=liveness_registry,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kopf-1.37.5/kopf-1.37.5/tests/test_liveness.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        await asyncio.wait_for(ready_flag.wait(), timeout=1)
41	        yield f'http://localhost:{port}/xyz'
42	    finally:

--------------------------------------------------

Code scanned:
	Total lines of code: 32591
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 117.0
		High: 62.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 165.0
		High: 14.0
Files skipped (0):
