Run started:2025-04-12 16:14:23.623148

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/docs/src/conf.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	extlinks = {
33	    "issue": ("https://github.com/johnwmillr/LyricsGenius/issues/%s", "%s"),
34	    "commit": ("https://github.com/johnwmillr/LyricsGenius/commit/%s", "%s"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/docs/src/conf.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    "issue": ("https://github.com/johnwmillr/LyricsGenius/issues/%s", "%s"),
34	    "commit": ("https://github.com/johnwmillr/LyricsGenius/commit/%s", "%s"),
35	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    # Create a persistent requests connection
14	    API_ROOT = "https://api.genius.com/"
15	    PUBLIC_API_ROOT = "https://genius.com/api/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    API_ROOT = "https://api.genius.com/"
15	    PUBLIC_API_ROOT = "https://genius.com/api/"
16	    WEB_ROOT = "https://genius.com/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    PUBLIC_API_ROOT = "https://genius.com/api/"
16	    WEB_ROOT = "https://genius.com/"
17	
18	    def __init__(

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
29	        self._session = requests.Session()
30	        user_agent_root = f"{platform.system()} {platform.release()}; Python {platform.python_version()}"
31	        self._session.headers = {

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
29	        self._session = requests.Session()
30	        user_agent_root = f"{platform.system()} {platform.release()}; Python {platform.python_version()}"
31	        self._session.headers = {

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
29	        self._session = requests.Session()
30	        user_agent_root = f"{platform.system()} {platform.release()}; Python {platform.python_version()}"
31	        self._session.headers = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        if access_token is None:
40	            access_token = os.environ.get("GENIUS_ACCESS_TOKEN")
41	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
77	            try:
78	                response = self._session.request(
79	                    method,
80	                    uri,
81	                    timeout=self.timeout,
82	                    params=params_,
83	                    headers=header,
84	                    **kwargs,
85	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	            res = response.json()
103	            return res.get("response", res)
104	        elif response.status_code == 204:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	    description = (
121	        res["meta"]["message"] if res.get("meta") else res.get("error_description")
122	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/api/base.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	    description = (
121	        res["meta"]["message"] if res.get("meta") else res.get("error_description")
122	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/auth.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	
30	    auth_url = "https://api.genius.com/oauth/authorize"
31	    token_url = "https://api.genius.com/oauth/token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/auth.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    auth_url = "https://api.genius.com/oauth/authorize"
31	    token_url = "https://api.genius.com/oauth/token"
32	
33	    def __init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/auth.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	            }
119	            url = OAuth2.token_url.replace("https://api.genius.com/", "")
120	            res = self._make_request(url, "POST", data=payload, **kwargs)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/genius.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        if song_url:
146	            path = song_url.replace("https://genius.com/", "")
147	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/genius.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
161	                print(
162	                    "Couldn't find the lyrics section. "
163	                    "Please report this if the song has lyrics.\n"

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/genius.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
690	        # Delete the temporary directory
691	        shutil.rmtree(tmp_dir)
692	        elapsed = (time.time() - start) / 60 / 60

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/lyricsgenius/types/base.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	        with open(filename, "w", encoding="utf-8") as ff:
147	            ff.write(data)
148	        return None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/tests/test_api.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	        new_annotation = genius.create_annotation(
30	            example_text, "https://example.com", "illustrative examples", title="test"
31	        )["annotation"]
32	        msg = "Annotation text did not match the one that was passed."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/tests/test_api.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	                example_text_two,
40	                "https://example.com",
41	                "illustrative examples",
42	                title="test",
43	            )["annotation"]
44	            msg = "Updated annotation text did not match the one that was passed."
45	            self.assertEqual(r["body"]["plain"], example_text_two, msg)
46	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/tests/test_api.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	        msg = "Returned web page API path is different than expected."
83	        url = "https://docs.genius.com"
84	        r = genius.web_page(raw_annotatable_url=url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/tests/test_auth.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	
113	        input_ = MagicMock(return_value="http://example.com?code=some_code")
114	        with (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/tests/test_genius.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        )
65	        url = "https://genius.com/Luis-fonsi-and-daddy-yankee-despacito-remix-lyrics"
66	
67	        first_song = self.tag["hits"][0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/tests/test_genius.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	
81	        cls.song_url = "https://genius.com/Andy-shauf-begin-again-lyrics"
82	        cls.song_id = 2885745

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/tests/test_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    def test_parse_redirected_url(self):
23	        redirected = "https://example.com/callback?code=test"
24	        flow = "code"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lyricsgenius-3.5.1/lyricsgenius-3.5.1/tests/test_utils.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	        redirected = "https://example.com/callback#access_token=test"
30	        flow = "token"

--------------------------------------------------

Code scanned:
	Total lines of code: 4132
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 1.0
Files skipped (0):
