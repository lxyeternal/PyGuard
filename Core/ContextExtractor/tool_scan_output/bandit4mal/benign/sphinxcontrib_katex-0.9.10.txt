Run started:2025-04-12 19:36:01.070113

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
195	    # Delete temporary dir used for _static file
196	    shutil.rmtree(app._katex_static_path)
197	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
204	    with open(filename, 'w') as file:
205	        file.write(content)
206	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
204	    with open(filename, 'w') as file:
205	        file.write(content)
206	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
286	    # Include KaTex CSS and JS files
287	    katex_url = 'https://cdn.jsdelivr.net/npm/katex@{version}/dist/'.format(
288	        version=katex_version

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
300	    app.add_config_value('katex_prerender', False, 'html')
301	    app.connect('builder-inited', builder_inited)
302	    app.connect('build-finished', builder_finished)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
301	    app.connect('builder-inited', builder_inited)
302	    app.connect('build-finished', builder_finished)
303	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
329	    try:
330	        sock.settimeout(timeout)
331	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
333	    finally:
334	        sock.settimeout(original)
335	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:339
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
338	    """Select a random port on local host."""
339	    with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as sock:
340	        # reuse sockets

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
343	        # choose port=0 for random port
344	        sock.bind(("127.0.0.1", 0))
345	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:429
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
428	        try:
429	            sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
430	            remaining = startup_start + timeout - time.monotonic()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
431	            with socket_timeout(sock, remaining):
432	                sock.connect(str(socket_path))
433	        except socket.timeout:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
442	        # The port may become unavailable in between the check and usage.
443	        host = "127.0.0.1"
444	        port = random_free_port()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:459
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
458	            try:
459	                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
460	                remaining = startup_start + timeout - time.monotonic()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
464	                with socket_timeout(sock, remaining):
465	                    sock.connect((host, port))
466	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
513	        """Terminate the render server and clean up."""
514	        self.sock.close()
515	        try:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
519	            self.process.kill()
520	        shutil.rmtree(self.rundir)
521	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
526	            start_time = time.monotonic()
527	            self.sock.settimeout(timeout)
528	        else:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
528	        else:
529	            self.sock.settimeout(None)
530	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
533	        length = len(request_bytes)
534	        self.sock.sendall(self.LENGTH_STRUCT.pack(length))
535	        self.sock.sendall(request_bytes)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
534	        self.sock.sendall(self.LENGTH_STRUCT.pack(length))
535	        self.sock.sendall(request_bytes)
536	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
537	        # Read the amount of bytes we are about to receive
538	        size = self.sock.recv(self.LENGTH_STRUCT.size)
539	        length = self.LENGTH_STRUCT.unpack(size)[0]

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sphinxcontrib_katex-0.9.10/sphinxcontrib_katex-0.9.10/sphinxcontrib/katex.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
557	                        # of the whole timeout again
558	                        self.sock.settimeout(timeout - elapsed)
559	

--------------------------------------------------

Code scanned:
	Total lines of code: 568
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 3.0
Files skipped (0):
