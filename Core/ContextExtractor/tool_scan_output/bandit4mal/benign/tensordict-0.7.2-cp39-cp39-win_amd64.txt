Run started:2025-04-12 19:01:35.414541

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/_lazy.py:2587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2586	                with open(prefix / "meta.json", "wb") as f:
2587	                    f.write(
2588	                        json.dumps(
2589	                            {"_type": str(type(self)), "stack_dim": self.stack_dim}
2590	                        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/_lazy.py:3729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3728	            with open(filepath, "wb") as json_metadata:
3729	                json_metadata.write(json.dumps(metadata))
3730	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/_td.py:4171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4170	                with open(prefix / "meta.json", "wb") as f:
4171	                    f.write(
4172	                        json.dumps(
4173	                            {
4174	                                "_type": str(type(self)),
4175	                                "index": _index_to_str(self.idx),
4176	                            }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/_td.py:4683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4682	    with open(filepath, "wb") as json_metadata:
4683	        json_metadata.write(json.dumps(metadata))
4684	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:4580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4579	                    raise RuntimeError(
4580	                        "NTs that are not jagged are not supported by the bytes method. Please use the jagged layout instead "
4581	                        "or raise and issue on https://github.com/pytorch/tensordict/issues instead."
4582	                    )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:5357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
5356	            if num_threads > 1:
5357	                executor = ThreadPoolExecutor(num_threads)
5358	                r = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:5500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
5499	                with open(filename, "w+b") as f:
5500	                    f.write(total_storage._handler.buffer)
5501	            # with open(Path(filename).with_suffix(".json"), "wb") as f:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:5583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
5582	            with (
5583	                ThreadPoolExecutor(max_workers=num_threads)
5584	                if not return_early

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:5588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
5587	                if return_early:
5588	                    executor = ThreadPoolExecutor(max_workers=num_threads)
5589	                futures = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:5785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
5784	            with (
5785	                ThreadPoolExecutor(max_workers=num_threads)
5786	                if not return_early

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:5790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
5789	                if return_early:
5790	                    executor = ThreadPoolExecutor(max_workers=num_threads)
5791	                futures = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:5880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
5879	            with (
5880	                ThreadPoolExecutor(max_workers=num_threads)
5881	                if not return_early

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:5885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
5884	                if return_early:
5885	                    executor = ThreadPoolExecutor(max_workers=num_threads)
5886	                futures = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:8510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
8509	        local_futures = []
8510	        executor = ThreadPoolExecutor(max_workers=num_threads)
8511	        self._multithread_apply_flat(

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:8784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
8783	                queue.put(i)
8784	            with ctx.Pool(
8785	                processes=num_workers,
8786	                initializer=_proc_init,
8787	                initargs=(seed, queue, worker_threads),
8788	                maxtasksperchild=max_tasks_per_child,
8789	            ) as pool:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:8975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
8974	                queue.put(i)
8975	            pool = ctx.Pool(
8976	                processes=num_workers,
8977	                initializer=_proc_init,
8978	                initargs=(seed, queue, worker_threads),
8979	                maxtasksperchild=max_tasks_per_child,
8980	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:12896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12895	        for _ in range(min(num_threads, lkeys)):
12896	            thread = Thread(target=_pin_mem, args=(q_in, q_out))
12897	            thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/base.py:13462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13461	    with open(filepath, "rb") as json_metadata:
13462	        metadata = json.loads(json_metadata.read())
13463	    return metadata

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/persistent.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
766	            with open(filepath, "wb") as json_metadata:
767	                json_metadata.write(json.dumps(metadata))
768	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/persistent.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
766	            with open(filepath, "wb") as json_metadata:
767	                json_metadata.write(json.dumps(metadata))
768	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/persistent.py:897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
896	                queue.put(i)
897	            with ctx.Pool(
898	                processes=num_workers,
899	                initializer=_proc_init,
900	                initargs=(seed, queue, worker_threads),
901	                maxtasksperchild=max_tasks_per_child,
902	            ) as pool:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/tensorclass.py:1368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1367	                        to_pickle[key] = value
1368	                f.write(json.dumps(metadata))
1369	                if to_pickle:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/tensorclass.py:3560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3559	                with open(prefix / "meta.json", "wb") as f:
3560	                    f.write(json.dumps(jsondict))
3561	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tensordict-0.7.2-cp39-cp39-win_amd64/tensordict/tensorclass.py:3708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
3707	            if self._path_to_memmap.exists():
3708	                shutil.rmtree(self._path_to_memmap)
3709	            memmap = True

--------------------------------------------------

Code scanned:
	Total lines of code: 36397
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 0.0
Files skipped (0):
