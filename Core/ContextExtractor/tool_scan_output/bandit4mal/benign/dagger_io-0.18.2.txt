Run started:2025-04-12 10:49:18.818476

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/docs/conf.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	
34	intersphinx_mapping = {"python": ("https://docs.python.org/3/", None)}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/src/dagger/_engine/download.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	        """Read everything in stream while discarding chunks."""
103	        while self.read(self.bufsize):
104	            ...

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/src/dagger/_engine/download.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	
122	    CLI_BASE_URL: ClassVar[str] = "https://dl.dagger.io"
123	    CLI_BIN_PREFIX: ClassVar[str] = "dagger-"

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/src/dagger/_engine/download.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
179	        if not cli_bin_path.exists():
180	            cli_bin_path = self._download(cli_bin_path)
181	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/src/dagger/_engine/download.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
212	        tmp_bin_path = Path(tmp_bin.name)
213	        tmp_bin_path.chmod(0o700)
214	        return tmp_bin_path.rename(path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/src/dagger/_engine/download.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
253	    def _extract_from_tar(self, reader: StreamReader) -> Iterator[IO[bytes]]:
254	        with tarfile.open(mode="|gz", fileobj=reader) as tar:
255	            for member in tar:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/src/dagger/_engine/download.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
269	            try:
270	                with zar.open("dagger.exe") as file:
271	                    yield file

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/src/dagger/client/_session.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	            raise ValueError(msg)
40	        self.url = httpx.URL(f"http://127.0.0.1:{self.port}/query")
41	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/src/dagger/client/_session.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	        propagate.inject(request.headers)
61	        return await super().handle_async_request(request)
62	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/tests/client/test_integration.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	async def test_git_repository():
30	    repo = dag.git("https://github.com/dagger/dagger").tag("v0.3.0").tree()
31	    readme = await repo.file("README.md").contents()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/tests/client/test_integration.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	async def test_container_build():
37	    repo = dag.git("https://github.com/dagger/dagger").tag("v0.3.0").tree()
38	    dagger_img = dag.container().build(repo)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/tests/engine/test_cli.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    with session.start_cli_session_sync(dagger.Config(), "dagger") as conn:
17	        assert conn.url == httpx.URL("http://127.0.0.1:50004/query")
18	        assert conn.port == 50004

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/tests/engine/test_download.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
93	
94	    with cli_path.open("rb") as f:
95	        # .zip is used in Windows.

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/tests/engine/test_download.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
98	                zipfile.ZipFile(archive_path, mode="w") as zar,
99	                zar.open("dagger.exe", mode="w") as zf,
100	            ):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dagger_io-0.18.2/dagger_io-0.18.2/tests/engine/test_download.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
102	        else:
103	            with tarfile.open(archive_path, mode="w:gz") as tar:
104	                tarinfo = tar.gettarinfo(arcname="dagger", fileobj=f)

--------------------------------------------------

Code scanned:
	Total lines of code: 12688
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 0.0
Files skipped (0):
