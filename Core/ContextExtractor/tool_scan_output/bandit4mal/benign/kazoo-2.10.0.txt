Run started:2025-04-12 11:02:18.130867

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/handlers/utils.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
167	    try:
168	        client_sock.connect(("localhost", port))
169	    except module.error as err:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/handlers/utils.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
261	                conn = context.wrap_socket(module.socket(addrs[0][0]))
262	                conn.settimeout(timeout_at)
263	                conn.connect(address)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/handlers/utils.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
262	                conn.settimeout(timeout_at)
263	                conn.connect(address)
264	                sock = conn

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/handlers/utils.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
390	    finally:
391	        selector.close()
392	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
127	                    sock = self.connection((host, port))
128	                    sock.sendall(b"isro")
129	                    result = sock.recv(8192)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
128	                    sock.sendall(b"isro")
129	                    result = sock.recv(8192)
130	                    sock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
129	                    result = sock.recv(8192)
130	                    sock.close()
131	                    if result == b"rw":

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
217	        if ws is not None:
218	            ws.close()
219	        if rs is not None:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
219	        if rs is not None:
220	            rs.close()
221	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
231	    def _read_header(self, timeout):
232	        b = self._read(4, timeout)
233	        length = int_struct.unpack(b)[0]

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
231	    def _read_header(self, timeout):
232	        b = self._read(4, timeout)
233	        length = int_struct.unpack(b)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	        length = int_struct.unpack(b)[0]
234	        b = self._read(length, timeout)
235	        header, offset = ReplyHeader.deserialize(b, 0)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
233	        length = int_struct.unpack(b)[0]
234	        b = self._read(length, timeout)
235	        header, offset = ReplyHeader.deserialize(b, 0)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
261	                try:
262	                    chunk = self._socket.recv(remaining)
263	                except ssl.SSLError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
299	
300	        msg = self._read(4, timeout)
301	        length = int_struct.unpack(msg)[0]

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
299	
300	        msg = self._read(4, timeout)
301	        length = int_struct.unpack(msg)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
301	        length = int_struct.unpack(msg)[0]
302	        msg = self._read(length, timeout)
303	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
301	        length = int_struct.unpack(msg)[0]
302	        msg = self._read(length, timeout)
303	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
335	        )
336	        self._write(int_struct.pack(len(b)) + b, timeout)
337	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
352	                try:
353	                    bytes_sent = self._socket.send(msg_slice)
354	                except ssl.SSLError as e:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
352	                try:
353	                    bytes_sent = self._socket.send(msg_slice)
354	                except ssl.SSLError as e:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
498	                # but have data in the read socket), which causes cpu to spin.
499	                self._read_sock.recv(1)
500	            except OSError:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
519	        client._queue.popleft()
520	        self._read_sock.recv(1)
521	        client._pending.append((request, async_object, xid))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
614	            self._xid = 0
615	            read_timeout, connect_timeout = self._connect(host, hostip, port)
616	            read_timeout = read_timeout / 1000.0

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/protocol/connection.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
683	            if self._socket is not None:
684	                self._socket.close()
685	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/recipe/lease.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
69	        """
70	        ident = identifier or socket.gethostname()
71	        self.obtained = False

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/recipe/lease.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
69	        """
70	        ident = identifier or socket.gethostname()
71	        self.obtained = False

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/security.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
77	    credential = username.encode("utf-8") + b":" + password.encode("utf-8")
78	    cred_hash = b64encode(hashlib.sha1(credential).digest()).strip()
79	    return username + ":" + cred_hash.decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/security.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
77	    credential = username.encode("utf-8") + b":" + password.encode("utf-8")
78	    cred_hash = b64encode(hashlib.sha1(credential).digest()).strip()
79	    return username + ":" + cred_hash.decode("utf-8")

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
58	    if os.name != "nt":  # SIGUSR1 is not supported on Windows
59	        signal.signal(signal.SIGUSR1, debug)  # Register handler
60	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
58	    if os.name != "nt":  # SIGUSR1 is not supported on Windows
59	        signal.signal(signal.SIGUSR1, debug)  # Register handler
60	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
104	        self.server_info = server_info
105	        self.host = "127.0.0.1"
106	        self.peers = peers

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	        with open(config_path, "w") as config:
149	            config.write(
150	                """
151	tickTime=2000
152	dataDir=%s
153	clientPort=%s
154	secureClientPort=%s
155	maxClientCnxns=0
156	admin.serverPort=%s
157	serverCnxnFactory=org.apache.zookeeper.server.NettyServerCnxnFactory
158	authProvider.1=org.apache.zookeeper.server.auth.SASLAuthenticationProvider
159	ssl.keyStore.location=%s
160	ssl.keyStore.password=apassword
161	ssl.trustStore.location=%s
162	ssl.trustStore.password=apassword
163	%s
164	"""
165	                % (
166	                    to_java_compatible_path(data_path),
167	                    self.server_info.client_port,
168	                    self.server_info.secure_client_port,
169	                    self.server_info.admin_port,
170	                    to_java_compatible_path(keystore_path),
171	                    to_java_compatible_path(truststore_path),
172	                    "\n".join(self.configuration_entries),
173	                )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	        with open(config_path, "w") as config:
149	            config.write(
150	                """
151	tickTime=2000
152	dataDir=%s
153	clientPort=%s
154	secureClientPort=%s
155	maxClientCnxns=0
156	admin.serverPort=%s
157	serverCnxnFactory=org.apache.zookeeper.server.NettyServerCnxnFactory
158	authProvider.1=org.apache.zookeeper.server.auth.SASLAuthenticationProvider
159	ssl.keyStore.location=%s
160	ssl.keyStore.password=apassword
161	ssl.trustStore.location=%s
162	ssl.trustStore.password=apassword
163	%s
164	"""
165	                % (
166	                    to_java_compatible_path(data_path),
167	                    self.server_info.client_port,
168	                    self.server_info.secure_client_port,
169	                    self.server_info.admin_port,
170	                    to_java_compatible_path(keystore_path),
171	                    to_java_compatible_path(truststore_path),
172	                    "\n".join(self.configuration_entries),
173	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
190	            with open(config_path, "a") as config:
191	                config.write(
192	                    """
193	initLimit=4
194	syncLimit=2
195	%s
196	peerType=%s
197	"""
198	                    % ("\n".join(servers_cfg), self.server_info.peer_type)
199	                )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
190	            with open(config_path, "a") as config:
191	                config.write(
192	                    """
193	initLimit=4
194	syncLimit=2
195	%s
196	peerType=%s
197	"""
198	                    % ("\n".join(servers_cfg), self.server_info.peer_type)
199	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
202	        with open(os.path.join(data_path, "myid"), "w") as myid_file:
203	            myid_file.write(str(self.server_info.server_id))
204	        # Write JAAS configuration

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
202	        with open(os.path.join(data_path, "myid"), "w") as myid_file:
203	            myid_file.write(str(self.server_info.server_id))
204	        # Write JAAS configuration

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
205	        with open(jaas_config_path, "w") as jaas_file:
206	            jaas_file.write(self.jaas_config or "")
207	        with open(log4j_path, "w") as log4j:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
205	        with open(jaas_config_path, "w") as jaas_file:
206	            jaas_file.write(self.jaas_config or "")
207	        with open(log4j_path, "w") as log4j:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
207	        with open(log4j_path, "w") as log4j:
208	            log4j.write(
209	                """
210	# DEFAULT: console appender only
211	log4j.rootLogger=INFO, ROLLINGFILE
212	log4j.appender.ROLLINGFILE.layout=org.apache.log4j.PatternLayout
213	log4j.appender.ROLLINGFILE.layout.ConversionPattern=%d{ISO8601} \
214	[myid:%X{myid}] - %-5p [%t:%C{1}@%L] - %m%n
215	log4j.appender.ROLLINGFILE=org.apache.log4j.RollingFileAppender
216	log4j.appender.ROLLINGFILE.Threshold=DEBUG
217	log4j.appender.ROLLINGFILE.File="""
218	                + to_java_compatible_path(  # NOQA
219	                    self.working_path + os.sep + "zookeeper.log\n"
220	                )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
207	        with open(log4j_path, "w") as log4j:
208	            log4j.write(
209	                """
210	# DEFAULT: console appender only
211	log4j.rootLogger=INFO, ROLLINGFILE
212	log4j.appender.ROLLINGFILE.layout=org.apache.log4j.PatternLayout
213	log4j.appender.ROLLINGFILE.layout.ConversionPattern=%d{ISO8601} \
214	[myid:%X{myid}] - %-5p [%t:%C{1}@%L] - %m%n
215	log4j.appender.ROLLINGFILE=org.apache.log4j.RollingFileAppender
216	log4j.appender.ROLLINGFILE.Threshold=DEBUG
217	log4j.appender.ROLLINGFILE.File="""
218	                + to_java_compatible_path(  # NOQA
219	                    self.working_path + os.sep + "zookeeper.log\n"
220	                )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
316	        self.stop()
317	        shutil.rmtree(os.path.join(self.working_path, "data"), True)
318	        os.mkdir(os.path.join(self.working_path, "data"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
319	        with open(os.path.join(self.working_path, "data", "myid"), "w") as fh:
320	            fh.write(str(self.server_info.server_id))
321	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
319	        with open(os.path.join(self.working_path, "data", "myid"), "w") as fh:
320	            fh.write(str(self.server_info.server_id))
321	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/testing/common.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
342	
343	        shutil.rmtree(self.working_path, True)
344	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
110	        hosts = [h for h in client.hosts]
111	        assert hosts == [("127.0.0.1", 9), ("127.0.0.2", 9)]
112	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
110	        hosts = [h for h in client.hosts]
111	        assert hosts == [("127.0.0.1", 9), ("127.0.0.2", 9)]
112	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
174	            eve.stop()
175	            eve.close()
176	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
196	            client.stop()
197	            client.close()
198	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
229	            eve.stop()
230	            eve.close()
231	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
424	        # close the connection to free the socket
425	        client.close()
426	        assert client._connection._write_sock is None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
528	        client.stop()
529	        client.close()
530	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:1173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1172	        with open(key_path, "wb") as key_file:
1173	            key_file.write(
1174	                self.cluster.get_ssl_client_configuration()["client_key"]
1175	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:1173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1172	        with open(key_path, "wb") as key_file:
1173	            key_file.write(
1174	                self.cluster.get_ssl_client_configuration()["client_key"]
1175	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1176	        with open(cert_path, "wb") as cert_file:
1177	            cert_file.write(
1178	                self.cluster.get_ssl_client_configuration()["client_cert"]
1179	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1176	        with open(cert_path, "wb") as cert_file:
1177	            cert_file.write(
1178	                self.cluster.get_ssl_client_configuration()["client_cert"]
1179	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1180	        with open(cacert_path, "wb") as cacert_file:
1181	            cacert_file.write(
1182	                self.cluster.get_ssl_client_configuration()["ca_cert"]
1183	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1180	        with open(cacert_path, "wb") as cacert_file:
1181	            cacert_file.write(
1182	                self.cluster.get_ssl_client_configuration()["ca_cert"]
1183	            )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_client.py:1440
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1439	        def free_sock_port():
1440	            s = socket.socket()
1441	            s.bind(("", 0))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_connection.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
304	            zk_stop_threads.append(
305	                threading.Thread(target=self.cluster[1].stop, daemon=True)
306	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_connection.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
307	            zk_stop_threads.append(
308	                threading.Thread(target=self.cluster[2].stop, daemon=True)
309	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_eventlet_handler.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
155	        for sock in socks:
156	            sock.close()
157	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_gevent_handler.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
167	        for sock in socks:
168	            sock.close()
169	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_hosts.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
12	        assert hosts == [
13	            ("127.0.0.1", 2181),
14	            ("192.168.1.2", 2181),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_hosts.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
13	            ("127.0.0.1", 2181),
14	            ("192.168.1.2", 2181),
15	            ("132.254.111.10", 2181),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_hosts.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
14	            ("192.168.1.2", 2181),
15	            ("132.254.111.10", 2181),
16	        ]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_hosts.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
22	        assert hosts == [
23	            ("127.0.0.1", 2181),
24	            ("192.168.1.2", 2181),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_hosts.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
23	            ("127.0.0.1", 2181),
24	            ("192.168.1.2", 2181),
25	            ("132.254.111.10", 2181),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_hosts.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	            ("192.168.1.2", 2181),
25	            ("132.254.111.10", 2181),
26	        ]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_selectors_select.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
41	            fd = fp.fileno()
42	            fp.close()
43	            self.assertRaises(ValueError, select, [fd], [], [], 0)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_selectors_select.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
53	        cmd = "for i in 0 1 2 3 4 5 6 7 8 9; do echo testing...; sleep 1; done"
54	        p = os.popen(cmd, "r")
55	        for tout in (0, 1, 2, 4, 8, 16) + (None,) * 10:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_selectors_select.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
64	            self.fail("Unexpected return values from select():", rfd, wfd, xfd)
65	        p.close()
66	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_selectors_select.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
68	    def test_select_mutated(self):
69	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
70	            a = []

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_threading_handler.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
69	        for sock in socks:
70	            sock.close()
71	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_utils.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
25	                    create_tcp_connection(
26	                        socket, ("127.0.0.1", 2181), timeout=1.5
27	                    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
46	                    create_tcp_connection(
47	                        socket, ("127.0.0.1", 2181), timeout=1.5
48	                    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
63	            with pytest.raises(socket.error):
64	                create_tcp_connection(socket, ("127.0.0.1", 2181), timeout=0.5)
65	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
69	        with pytest.raises(socket.error):
70	            create_tcp_connection(socket, ("127.0.0.1", 2181), timeout=-1)
71	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/kazoo-2.10.0/kazoo-2.10.0/kazoo/tests/test_utils.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
81	            with pytest.raises(socket.error):
82	                create_tcp_connection(socket, ("127.0.0.1", 2181), timeout=0)

--------------------------------------------------

Code scanned:
	Total lines of code: 12128
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 61.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 75.0
		High: 5.0
Files skipped (0):
